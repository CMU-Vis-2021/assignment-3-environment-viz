import*as e from"https://unpkg.com/d3?module";const G=function(){const f=document.createElement("link").relList;if(f&&f.supports&&f.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))p(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const m of i.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&p(m)}).observe(document,{childList:!0,subtree:!0});function E(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function p(o){if(o.ep)return;o.ep=!0;const i=E(o);fetch(o.href,i)}};G();var N=650,T=400,W=450,x=250,g={top:20,right:30,bottom:100,left:130},h="2000",P=["#7c0202","#b64d24","#b86213","#e18820","#de9b10","#f3c523","#7c5201","#fac45a","#fd860b","#ffdc6c","#ff4901","#a43407"],K=["0","1","2","3","4","5","6","7","8","9","10","11"],w={Alabama:"AL",Alaska:"AK",Arizona:"AZ",Arkansas:"AR",California:"CA",Colorado:"CO",Connecticut:"CT",Delaware:"DE",Florida:"FL",Georgia:"GA",Hawaii:"HI",Idaho:"ID",Illinois:"IL",Indiana:"IN",Iowa:"IA",Kansas:"KS",Kentucky:"KY",Louisiana:"LA",Maine:"ME",Maryland:"MD",Massachusetts:"MA",Michigan:"MI",Minnesota:"MN",Mississippi:"MS",Missouri:"MO",Montana:"MT",Nebraska:"NE",Nevada:"NV","New Hampshire":"NH","New Jersey":"NJ","New Mexico":"NM","New York":"NY","North Carolina":"NC","North Dakota":"ND",Ohio:"OH",Oklahoma:"OK",Oregon:"OR",Pennsylvania:"PA","Rhode Island":"RI","South Carolina":"SC","South Dakota":"SD",Tennessee:"TN",Texas:"TX",Utah:"UT",Vermont:"VT",Virgina:"VA",Washington:"WA","West Virginia":"WV",Wisconsin:"WI",Wyoming:"WY"},Z=["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"],A={Alabama:[-82,30,1e3],Alaska:[-147,60,400],Arizona:[-107,30,1e3],Arkansas:[-87,31,1e3],California:[-113,34,1e3],Colorado:[-100,35,1e3],Connecticut:[-70,40,2e3],Delaware:[-74,38,3e3],Florida:[-80,26,1300],Georgia:[-79,30,1e3],Hawaii:[-155,19,2e3],Idaho:[-111,43,1e3],Illinois:[-84,38,1300],Indiana:[-84,38,1300],Iowa:[-91,40,1300],Kansas:[-96,37,1300],Kentucky:[-82,35,1300],Louisiana:[-89,30,1300],Maine:[-66,44,1300],Maryland:[-74,37,1500],Massachusetts:[-69,41,1900],Michigan:[-83,43,1300],Minnesota:[-92,45,1300],Mississippi:[-86,30,1300],Missouri:[-90,37,1400],Montana:[-108,46,1300],Nebraska:[-98,40,1300],Nevada:[-115,35,1e3],"New Hampshire":[-69,43,1700],"New Jersey":[-72,38,1900],"New Mexico":[-103,30,1e3],"New York":[-73,41,1400],"North Carolina":[-77,33,1300],"North Dakota":[-99,46,1300],Ohio:[-81,39,1700],Oklahoma:[-95,34,1400],Oregon:[-119,43,1300],Pennsylvania:[-76,40,1600],"Rhode Island":[-70,41,3500],"South Carolina":[-79,32,1600],"South Dakota":[-99,43,1400],Tennessee:[-82,34,1700],Texas:[-95,30,1e3],Utah:[-110,37,1400],Vermont:[-71,43,1800],Virginia:[-78,36,1500],Washington:[-118,46,1300],"West Virginia":[-79,37,1500],Wisconsin:[-88,43,1400],Wyoming:[-106,42,1300]},Y=1,L=26e4,R=e.geoMercator().center([-96,37]).scale(588).translate([N/2,T/2]),v=e.select("#my_dataviz").append("div").attr("class","tooltip").style("opacity",0).style("background-color","white").style("border","solid").style("border-width","2px").style("border-radius","5px").style("padding","5px"),u=e.select("#my_dataviz").append("svg").attr("width",N).attr("height",T),d=e.scaleOrdinal().domain(K).range(P),c=e.scaleLinear().domain([Y,L]).range([2,25]);e.csv("assets/firesfinaldata.csv").then(I=>{e.json("assets/geojson/USA.geojson").then(function(f){u.append("g").selectAll("path").data(f.features).enter().append("path").attr("fill","#b8b8b8").attr("d",e.geoPath().projection(R)).style("stroke","black").style("opacity",.3),u.selectAll("myCircles").data(I).enter().append("circle").attr("class",t=>"year"+t.FIRE_YEAR+" dataCircles val"+t.VALUE+""+t.FIRE_YEAR).attr("cx",function(t){return R([t.LONGITUDE,t.LATITUDE])[0]}).attr("cy",function(t){return R([t.LONGITUDE,t.LATITUDE])[1]}).attr("r",function(t){return c(t.FIRE_SIZE)}).style("fill",function(t){return d(t.VALUE)}).attr("stroke",function(t){return d(t.VALUE)}).attr("stroke-width",3).attr("fill-opacity",.4).on("mouseover",function(t,a){v.style("opacity",1),v.style("display","block")}).on("mousemove",function(t,a){v.html("Fire year: "+a.FIRE_YEAR+"<br>Acres burned: "+a.FIRE_SIZE+"<br>Cause of fire: "+a.NWCG_GENERAL_CAUSE+"<br>State: "+a.STATE+"<br>County: "+a.FIPS_NAME).style("left",t.x+30+"px").style("top",t.y-30+"px")}).on("mouseleave",function(t,a){v.style("opacity",0),v.style("display","none")});var E=e.select("#my_dataviz").append("svg").attr("width",W+g.left+g.right).attr("height",x+g.top+g.bottom).append("g").attr("transform","translate("+g.left+","+g.top+")"),p=e.scaleLinear().range([0,W]);const o=E.append("g").attr("transform","translate(0,"+x+")");var i=e.scaleBand().range([0,x]).padding(.1);const m=E.append("g");function F(t){let a=I.filter(function(n){return n.FIRE_YEAR==t});i.domain(a.map(function(n){return n.NWCG_GENERAL_CAUSE})),m.transition().duration(1e3).call(e.axisLeft(i)),p.domain([0,e.max(a,function(n){return n.FIRE_SIZE})]),o.transition().duration(1e3).call(e.axisBottom(p));var s=E.selectAll("rect").data(a);s.join("rect").transition().duration(1e3).attr("class",function(n){return"fire"+n.FIRE_SIZE}).attr("x",p(0)).attr("y",n=>i(n.NWCG_GENERAL_CAUSE)).attr("width",n=>p(n.FIRE_SIZE)).attr("height",i.bandwidth()).style("fill",function(n){return d(n.VALUE)}).attr("stroke",function(n){return d(n.VALUE)}).attr("stroke-width",3).attr("fill-opacity",.4)}F(2e3);function U(){e.selectAll(".slider").each(function(t){let s=e.select(this).property("value"),n="year"+s;h=s,F(h);let l=document.getElementsByClassName("button");for(let r=0;r<=l.length-1;r++)l[r].classList.remove("active");u.selectAll(".dataCircles").transition().duration(1e3).style("opacity",0).attr("r",0),u.selectAll("."+n).transition().duration(1e3).style("opacity",1).attr("r",function(r){return c(r.FIRE_SIZE)})})}function B(t){e.selectAll(".checkbox").each(function(a){let s=e.select(this);console.log(s);let n=s.property("value"),l="val"+n;console.log("group"),console.log(l),console.log("map year"),console.log(h),s.property("checked")?(console.log("SELECTED","."+l+""+h),u.selectAll("."+l+""+h).transition().duration(1e3).style("opacity",1).attr("r",function(r){return c(r.FIRE_SIZE)})):(console.log("NOT SELECTED"),u.selectAll("."+l+""+h).transition().duration(1e3).style("opacity",0).attr("r",0))})}e.selectAll(".slider").on("change",U),e.selectAll(".checkbox").on("change",B),U();var S=[Y,L/2,L],D=50,_=100,b=380;u.selectAll("legend").data(S).enter().append("circle").attr("cx",D).attr("cy",function(t){return b-c(t)}).attr("r",function(t){return c(t)}).style("fill","none").attr("stroke","black"),u.selectAll("legend").data(S).enter().append("line").attr("x1",function(t){return D+c(t)}).attr("x2",_).attr("y1",function(t){return b-c(t)*1.5}).attr("y2",function(t){return b-c(t)*1.5}).attr("stroke","black").style("stroke-dasharray","2,2"),u.selectAll("legend").data(S).enter().append("text").attr("x",_).attr("y",function(t){return b-c(t)*1.5}).text(function(t){return t==L?t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" acres":t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}).style("font-size",12).attr("alignment-baseline","middle");var y=e.select("#state").append("svg").attr("width",400).attr("height",300);e.select("#stateSelect").selectAll("myStates").data(Z).enter().append("option").text(function(t){return t}).attr("value",function(t){return t});let j=document.getElementById("stateSelect");j.value="Texas";var k=e.geoMercator().center([A.Texas[0],A.Texas[1]]).scale(A.Texas[2]).translate([N/2,T/2]);console.log(f.features),state.features=f.features.filter(function(t){return t.properties.NAME=="Texas"}),console.log(state.features),y.selectAll("path").data(state.features).join("path").transition().duration(1e3).attr("fill","#b8b8b8").attr("d",e.geoPath().projection(k)).style("stroke","black").style("opacity",.3);let M=document.querySelector("#hover_Text");M.innerHTML="Year of Fire: <br> Cause of Fire: <br> Number of acres burned: <br>Location of Fire:";function H(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function O(t){if(!t){M.innerHTML="Year of Fire: <br> Cause of Fire: <br> Number of acres burned: <br>Location of Fire:";return}M.innerHTML=`Year of Fire: ${t.year} <br>
    Cause of Fire: ${t.cause} <br> 
    Number of acres burned: ${H(t.acres)} 
    <br>
    Location of Fire: ${t.county}, ${t.state}`}y.selectAll("myCircles").data(I).join("circle").attr("class",t=>"state"+t.STATE).attr("cx",function(t){return k([t.LONGITUDE,t.LATITUDE])[0]}).attr("cy",function(t){return k([t.LONGITUDE,t.LATITUDE])[1]}).attr("r",0).style("fill",function(t){return d(t.VALUE)}).attr("stroke",function(t){return d(t.VALUE)}).attr("stroke-width",3).attr("fill-opacity",.4).on("mouseover",function(t,a){O({acres:a.FIRE_SIZE,state:a.STATE,year:a.FIRE_YEAR,county:a.FIPS_NAME,cause:a.NWCG_GENERAL_CAUSE})}).on("mouseout",function(t){O()});var C="Texas";function V(t){state.features=f.features.filter(function(r){return r.properties.NAME==t});var a=e.geoMercator().center([A[t][0],A[t][1]]).scale(A[t][2]).translate([N/2,T/2]);y.selectAll("path").data(state.features).join("path").transition().duration(1e3).attr("fill","#b8b8b8").attr("d",e.geoPath().projection(a)).style("stroke","black").style("opacity",.3),console.log(t);var s=document.getElementById("stateSelect"),n=s.value;console.log(n);let l=w[t];y.selectAll("myCircles").attr("class",r=>"state"+r.STATE).attr("r",0).style("fill",function(r){return d(r.VALUE)}).attr("stroke",function(r){return d(r.VALUE)}).attr("stroke-width",3).attr("fill-opacity",.4),console.log("group"),console.log(l),y.selectAll(".state"+l).attr("cx",function(r){return a([r.LONGITUDE,r.LATITUDE])[0]}).attr("cy",function(r){return a([r.LONGITUDE,r.LATITUDE])[1]}).transition().duration(1e3).style("opacity",1).attr("r",function(r){return c(r.FIRE_SIZE)})}V("Texas"),e.select("#stateSelect").on("change",function(t,a){console.log("In on change"),console.log("currentselection is"),console.log(w[C]),y.selectAll(".state"+w[C]).transition().duration(1e3).style("opacity",0).attr("r",0);const s=e.select(this).property("value");console.log(a),console.log(t),console.log("leaving on change"),C=s,V(s)})})});var z=document.getElementById("yearShown");myRange.oninput=function(){z.innerHTML=this.value};
