function nb(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function q3(e){let t=e,n=e,r=e;e.length===1&&(t=(s,u)=>e(s)-u,n=nb,r=(s,u)=>nb(e(s),u));function i(s,u,l=0,c=s.length){if(l<c){if(n(u,u)!==0)return c;do{const f=l+c>>>1;r(s[f],u)<0?l=f+1:c=f}while(l<c)}return l}function o(s,u,l=0,c=s.length){if(l<c){if(n(u,u)!==0)return c;do{const f=l+c>>>1;r(s[f],u)<=0?l=f+1:c=f}while(l<c)}return l}function a(s,u,l=0,c=s.length){const f=i(s,u,l,c-1);return f>l&&t(s[f-1],u)>-t(s[f],u)?f-1:f}return{left:i,center:a,right:o}}function aH(e){return e===null?NaN:+e}const sH=q3(nb),uH=sH.right;q3(aH).center;var lH=uH;class Ss{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const o=n[i],a=t+o,s=Math.abs(t)<Math.abs(o)?t-(a-o):o-(a-t);s&&(n[r++]=s),t=a}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,o,a=0;if(n>0){for(a=t[--n];n>0&&(r=a,i=t[--n],a=r+i,o=i-(a-r),!o););n>0&&(o<0&&t[n-1]<0||o>0&&t[n-1]>0)&&(i=o*2,r=a+i,i==r-a&&(a=r))}return a}}var rb=Math.sqrt(50),ib=Math.sqrt(10),ob=Math.sqrt(2);function cH(e,t,n){var r,i=-1,o,a,s;if(t=+t,e=+e,n=+n,e===t&&n>0)return[e];if((r=t<e)&&(o=e,e=t,t=o),(s=H3(e,t,n))===0||!isFinite(s))return[];if(s>0){let u=Math.round(e/s),l=Math.round(t/s);for(u*s<e&&++u,l*s>t&&--l,a=new Array(o=l-u+1);++i<o;)a[i]=(u+i)*s}else{s=-s;let u=Math.round(e*s),l=Math.round(t*s);for(u/s<e&&++u,l/s>t&&--l,a=new Array(o=l-u+1);++i<o;)a[i]=(u+i)/s}return r&&a.reverse(),a}function H3(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=rb?10:o>=ib?5:o>=ob?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=rb?10:o>=ib?5:o>=ob?2:1)}function fH(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=rb?i*=10:o>=ib?i*=5:o>=ob&&(i*=2),t<e?-i:i}function*dH(e){for(const t of e)yield*t}function W3(e){return Array.from(dH(e))}var hH={value:()=>{}};function G3(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new X0(n)}function X0(e){this._=e}function gH(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}X0.prototype=G3.prototype={constructor:X0,on:function(e,t){var n=this._,r=gH(e+"",n),i,o=-1,a=r.length;if(arguments.length<2){for(;++o<a;)if((i=(e=r[o]).type)&&(i=pH(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<a;)if(i=(e=r[o]).type)n[i]=Y3(n[i],e.name,t);else if(t==null)for(i in n)n[i]=Y3(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new X0(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],r=0,i=o.length;r<i;++r)o[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};function pH(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function Y3(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=hH,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var ab="http://www.w3.org/1999/xhtml",V3={svg:"http://www.w3.org/2000/svg",xhtml:ab,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function K0(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),V3.hasOwnProperty(t)?{space:V3[t],local:e}:e}function mH(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===ab&&t.documentElement.namespaceURI===ab?t.createElement(e):t.createElementNS(n,e)}}function yH(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function X3(e){var t=K0(e);return(t.local?yH:mH)(t)}function vH(){}function sb(e){return e==null?vH:function(){return this.querySelector(e)}}function bH(e){typeof e!="function"&&(e=sb(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],a=o.length,s=r[i]=new Array(a),u,l,c=0;c<a;++c)(u=o[c])&&(l=e.call(u,u.__data__,c,o))&&("__data__"in u&&(l.__data__=u.__data__),s[c]=l);return new cr(r,this._parents)}function xH(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function wH(){return[]}function K3(e){return e==null?wH:function(){return this.querySelectorAll(e)}}function _H(e){return function(){return xH(e.apply(this,arguments))}}function EH(e){typeof e=="function"?e=_H(e):e=K3(e);for(var t=this._groups,n=t.length,r=[],i=[],o=0;o<n;++o)for(var a=t[o],s=a.length,u,l=0;l<s;++l)(u=a[l])&&(r.push(e.call(u,u.__data__,l,a)),i.push(u));return new cr(r,i)}function Z3(e){return function(){return this.matches(e)}}function J3(e){return function(t){return t.matches(e)}}var $H=Array.prototype.find;function AH(e){return function(){return $H.call(this.children,e)}}function SH(){return this.firstElementChild}function CH(e){return this.select(e==null?SH:AH(typeof e=="function"?e:J3(e)))}var OH=Array.prototype.filter;function FH(){return Array.from(this.children)}function kH(e){return function(){return OH.call(this.children,e)}}function MH(e){return this.selectAll(e==null?FH:kH(typeof e=="function"?e:J3(e)))}function DH(e){typeof e!="function"&&(e=Z3(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],a=o.length,s=r[i]=[],u,l=0;l<a;++l)(u=o[l])&&e.call(u,u.__data__,l,o)&&s.push(u);return new cr(r,this._parents)}function Q3(e){return new Array(e.length)}function NH(){return new cr(this._enter||this._groups.map(Q3),this._parents)}function Z0(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Z0.prototype={constructor:Z0,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function TH(e){return function(){return e}}function RH(e,t,n,r,i,o){for(var a=0,s,u=t.length,l=o.length;a<l;++a)(s=t[a])?(s.__data__=o[a],r[a]=s):n[a]=new Z0(e,o[a]);for(;a<u;++a)(s=t[a])&&(i[a]=s)}function PH(e,t,n,r,i,o,a){var s,u,l=new Map,c=t.length,f=o.length,d=new Array(c),h;for(s=0;s<c;++s)(u=t[s])&&(d[s]=h=a.call(u,u.__data__,s,t)+"",l.has(h)?i[s]=u:l.set(h,u));for(s=0;s<f;++s)h=a.call(e,o[s],s,o)+"",(u=l.get(h))?(r[s]=u,u.__data__=o[s],l.delete(h)):n[s]=new Z0(e,o[s]);for(s=0;s<c;++s)(u=t[s])&&l.get(d[s])===u&&(i[s]=u)}function LH(e){return e.__data__}function jH(e,t){if(!arguments.length)return Array.from(this,LH);var n=t?PH:RH,r=this._parents,i=this._groups;typeof e!="function"&&(e=TH(e));for(var o=i.length,a=new Array(o),s=new Array(o),u=new Array(o),l=0;l<o;++l){var c=r[l],f=i[l],d=f.length,h=IH(e.call(c,c&&c.__data__,l,r)),g=h.length,p=s[l]=new Array(g),m=a[l]=new Array(g),y=u[l]=new Array(d);n(c,f,p,m,y,h,t);for(var v=0,b=0,x,w;v<g;++v)if(x=p[v]){for(v>=b&&(b=v+1);!(w=m[b])&&++b<g;);x._next=w||null}}return a=new cr(a,r),a._enter=s,a._exit=u,a}function IH(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function BH(){return new cr(this._exit||this._groups.map(Q3),this._parents)}function zH(e,t,n){var r=this.enter(),i=this,o=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?o.remove():n(o),r&&i?r.merge(i).order():i}function UH(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,o=r.length,a=Math.min(i,o),s=new Array(i),u=0;u<a;++u)for(var l=n[u],c=r[u],f=l.length,d=s[u]=new Array(f),h,g=0;g<f;++g)(h=l[g]||c[g])&&(d[g]=h);for(;u<i;++u)s[u]=n[u];return new cr(s,this._parents)}function qH(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,o=r[i],a;--i>=0;)(a=r[i])&&(o&&a.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(a,o),o=a);return this}function HH(e){e||(e=WH);function t(f,d){return f&&d?e(f.__data__,d.__data__):!f-!d}for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a=n[o],s=a.length,u=i[o]=new Array(s),l,c=0;c<s;++c)(l=a[c])&&(u[c]=l);u.sort(t)}return new cr(i,this._parents).order()}function WH(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function GH(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function YH(){return Array.from(this)}function VH(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null}function XH(){let e=0;for(const t of this)++e;return e}function KH(){return!this.node()}function ZH(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],o=0,a=i.length,s;o<a;++o)(s=i[o])&&e.call(s,s.__data__,o,i);return this}function JH(e){return function(){this.removeAttribute(e)}}function QH(e){return function(){this.removeAttributeNS(e.space,e.local)}}function eW(e,t){return function(){this.setAttribute(e,t)}}function tW(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function nW(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function rW(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function iW(e,t){var n=K0(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?QH:JH:typeof t=="function"?n.local?rW:nW:n.local?tW:eW)(n,t))}function eF(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function oW(e){return function(){this.style.removeProperty(e)}}function aW(e,t,n){return function(){this.style.setProperty(e,t,n)}}function sW(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function uW(e,t,n){return arguments.length>1?this.each((t==null?oW:typeof t=="function"?sW:aW)(e,t,n==null?"":n)):al(this.node(),e)}function al(e,t){return e.style.getPropertyValue(t)||eF(e).getComputedStyle(e,null).getPropertyValue(t)}function lW(e){return function(){delete this[e]}}function cW(e,t){return function(){this[e]=t}}function fW(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function dW(e,t){return arguments.length>1?this.each((t==null?lW:typeof t=="function"?fW:cW)(e,t)):this.node()[e]}function tF(e){return e.trim().split(/^|\s+/)}function ub(e){return e.classList||new nF(e)}function nF(e){this._node=e,this._names=tF(e.getAttribute("class")||"")}nF.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function rF(e,t){for(var n=ub(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function iF(e,t){for(var n=ub(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function hW(e){return function(){rF(this,e)}}function gW(e){return function(){iF(this,e)}}function pW(e,t){return function(){(t.apply(this,arguments)?rF:iF)(this,e)}}function mW(e,t){var n=tF(e+"");if(arguments.length<2){for(var r=ub(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?pW:t?hW:gW)(n,t))}function yW(){this.textContent=""}function vW(e){return function(){this.textContent=e}}function bW(e){return function(){var t=e.apply(this,arguments);this.textContent=t==null?"":t}}function xW(e){return arguments.length?this.each(e==null?yW:(typeof e=="function"?bW:vW)(e)):this.node().textContent}function wW(){this.innerHTML=""}function _W(e){return function(){this.innerHTML=e}}function EW(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t==null?"":t}}function $W(e){return arguments.length?this.each(e==null?wW:(typeof e=="function"?EW:_W)(e)):this.node().innerHTML}function AW(){this.nextSibling&&this.parentNode.appendChild(this)}function SW(){return this.each(AW)}function CW(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function OW(){return this.each(CW)}function FW(e){var t=typeof e=="function"?e:X3(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function kW(){return null}function MW(e,t){var n=typeof e=="function"?e:X3(e),r=t==null?kW:typeof t=="function"?t:sb(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function DW(){var e=this.parentNode;e&&e.removeChild(this)}function NW(){return this.each(DW)}function TW(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function RW(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function PW(e){return this.select(e?RW:TW)}function LW(e){return arguments.length?this.property("__data__",e):this.node().__data__}function jW(e){return function(t){e.call(this,t,this.__data__)}}function IW(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function BW(e){return function(){var t=this.__on;if(!!t){for(var n=0,r=-1,i=t.length,o;n<i;++n)o=t[n],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):t[++r]=o;++r?t.length=r:delete this.__on}}}function zW(e,t,n){return function(){var r=this.__on,i,o=jW(t);if(r){for(var a=0,s=r.length;a<s;++a)if((i=r[a]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),i.value=t;return}}this.addEventListener(e.type,o,n),i={type:e.type,name:e.name,value:t,listener:o,options:n},r?r.push(i):this.__on=[i]}}function UW(e,t,n){var r=IW(e+""),i,o=r.length,a;if(arguments.length<2){var s=this.node().__on;if(s){for(var u=0,l=s.length,c;u<l;++u)for(i=0,c=s[u];i<o;++i)if((a=r[i]).type===c.type&&a.name===c.name)return c.value}return}for(s=t?zW:BW,i=0;i<o;++i)this.each(s(r[i],t,n));return this}function oF(e,t,n){var r=eF(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function qW(e,t){return function(){return oF(this,e,t)}}function HW(e,t){return function(){return oF(this,e,t.apply(this,arguments))}}function WW(e,t){return this.each((typeof t=="function"?HW:qW)(e,t))}function*GW(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length,a;i<o;++i)(a=r[i])&&(yield a)}var aF=[null];function cr(e,t){this._groups=e,this._parents=t}function uf(){return new cr([[document.documentElement]],aF)}function YW(){return this}cr.prototype=uf.prototype={constructor:cr,select:bH,selectAll:EH,selectChild:CH,selectChildren:MH,filter:DH,data:jH,enter:NH,exit:BH,join:zH,merge:UH,selection:YW,order:qH,sort:HH,call:GH,nodes:YH,node:VH,size:XH,empty:KH,each:ZH,attr:iW,style:uW,property:dW,classed:mW,text:xW,html:$W,raise:SW,lower:OW,append:FW,insert:MW,remove:NW,clone:PW,datum:LW,on:UW,dispatch:WW,[Symbol.iterator]:GW};function sDe(e){return typeof e=="string"?new cr([[document.querySelector(e)]],[document.documentElement]):new cr([[e]],aF)}function lb(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function sF(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function lf(){}var cf=.7,J0=1/cf,sl="\\s*([+-]?\\d+)\\s*",ff="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ni="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",VW=/^#([0-9a-f]{3,8})$/,XW=new RegExp("^rgb\\("+[sl,sl,sl]+"\\)$"),KW=new RegExp("^rgb\\("+[Ni,Ni,Ni]+"\\)$"),ZW=new RegExp("^rgba\\("+[sl,sl,sl,ff]+"\\)$"),JW=new RegExp("^rgba\\("+[Ni,Ni,Ni,ff]+"\\)$"),QW=new RegExp("^hsl\\("+[ff,Ni,Ni]+"\\)$"),eG=new RegExp("^hsla\\("+[ff,Ni,Ni,ff]+"\\)$"),uF={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};lb(lf,Cs,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:lF,formatHex:lF,formatHsl:tG,formatRgb:cF,toString:cF});function lF(){return this.rgb().formatHex()}function tG(){return pF(this).formatHsl()}function cF(){return this.rgb().formatRgb()}function Cs(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=VW.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?fF(t):n===3?new fr(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Q0(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Q0(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=XW.exec(e))?new fr(t[1],t[2],t[3],1):(t=KW.exec(e))?new fr(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=ZW.exec(e))?Q0(t[1],t[2],t[3],t[4]):(t=JW.exec(e))?Q0(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=QW.exec(e))?gF(t[1],t[2]/100,t[3]/100,1):(t=eG.exec(e))?gF(t[1],t[2]/100,t[3]/100,t[4]):uF.hasOwnProperty(e)?fF(uF[e]):e==="transparent"?new fr(NaN,NaN,NaN,0):null}function fF(e){return new fr(e>>16&255,e>>8&255,e&255,1)}function Q0(e,t,n,r){return r<=0&&(e=t=n=NaN),new fr(e,t,n,r)}function nG(e){return e instanceof lf||(e=Cs(e)),e?(e=e.rgb(),new fr(e.r,e.g,e.b,e.opacity)):new fr}function cb(e,t,n,r){return arguments.length===1?nG(e):new fr(e,t,n,r==null?1:r)}function fr(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}lb(fr,cb,sF(lf,{brighter:function(e){return e=e==null?J0:Math.pow(J0,e),new fr(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?cf:Math.pow(cf,e),new fr(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:dF,formatHex:dF,formatRgb:hF,toString:hF}));function dF(){return"#"+fb(this.r)+fb(this.g)+fb(this.b)}function hF(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function fb(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function gF(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Ti(e,t,n,r)}function pF(e){if(e instanceof Ti)return new Ti(e.h,e.s,e.l,e.opacity);if(e instanceof lf||(e=Cs(e)),!e)return new Ti;if(e instanceof Ti)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(t===o?a=(n-r)/s+(n<r)*6:n===o?a=(r-t)/s+2:a=(t-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new Ti(a,s,u,e.opacity)}function rG(e,t,n,r){return arguments.length===1?pF(e):new Ti(e,t,n,r==null?1:r)}function Ti(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}lb(Ti,rG,sF(lf,{brighter:function(e){return e=e==null?J0:Math.pow(J0,e),new Ti(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?cf:Math.pow(cf,e),new Ti(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new fr(db(e>=240?e-240:e+120,i,r),db(e,i,r),db(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function db(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}var hb=e=>()=>e;function iG(e,t){return function(n){return e+n*t}}function oG(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function aG(e){return(e=+e)==1?mF:function(t,n){return n-t?oG(t,n,e):hb(isNaN(t)?n:t)}}function mF(e,t){var n=t-e;return n?iG(e,n):hb(isNaN(e)?t:e)}var eg=function e(t){var n=aG(t);function r(i,o){var a=n((i=cb(i)).r,(o=cb(o)).r),s=n(i.g,o.g),u=n(i.b,o.b),l=mF(i.opacity,o.opacity);return function(c){return i.r=a(c),i.g=s(c),i.b=u(c),i.opacity=l(c),i+""}}return r.gamma=e,r}(1);function sG(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(o){for(i=0;i<n;++i)r[i]=e[i]*(1-o)+t[i]*o;return r}}function uG(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function lG(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),o=new Array(n),a;for(a=0;a<r;++a)i[a]=mb(e[a],t[a]);for(;a<n;++a)o[a]=t[a];return function(s){for(a=0;a<r;++a)o[a]=i[a](s);return o}}function cG(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Jr(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function fG(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=mb(e[i],t[i]):r[i]=t[i];return function(o){for(i in n)r[i]=n[i](o);return r}}var gb=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,pb=new RegExp(gb.source,"g");function dG(e){return function(){return e}}function hG(e){return function(t){return e(t)+""}}function yF(e,t){var n=gb.lastIndex=pb.lastIndex=0,r,i,o,a=-1,s=[],u=[];for(e=e+"",t=t+"";(r=gb.exec(e))&&(i=pb.exec(t));)(o=i.index)>n&&(o=t.slice(n,o),s[a]?s[a]+=o:s[++a]=o),(r=r[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,u.push({i:a,x:Jr(r,i)})),n=pb.lastIndex;return n<t.length&&(o=t.slice(n),s[a]?s[a]+=o:s[++a]=o),s.length<2?u[0]?hG(u[0].x):dG(t):(t=u.length,function(l){for(var c=0,f;c<t;++c)s[(f=u[c]).i]=f.x(l);return s.join("")})}function mb(e,t){var n=typeof t,r;return t==null||n==="boolean"?hb(t):(n==="number"?Jr:n==="string"?(r=Cs(t))?(t=r,eg):yF:t instanceof Cs?eg:t instanceof Date?cG:uG(t)?sG:Array.isArray(t)?lG:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?fG:Jr)(e,t)}function gG(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var vF=180/Math.PI,yb={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function bF(e,t,n,r,i,o){var a,s,u;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),e*r<t*n&&(e=-e,t=-t,u=-u,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*vF,skewX:Math.atan(u)*vF,scaleX:a,scaleY:s}}var tg;function pG(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?yb:bF(t.a,t.b,t.c,t.d,t.e,t.f)}function mG(e){return e==null||(tg||(tg=document.createElementNS("http://www.w3.org/2000/svg","g")),tg.setAttribute("transform",e),!(e=tg.transform.baseVal.consolidate()))?yb:(e=e.matrix,bF(e.a,e.b,e.c,e.d,e.e,e.f))}function xF(e,t,n,r){function i(l){return l.length?l.pop()+" ":""}function o(l,c,f,d,h,g){if(l!==f||c!==d){var p=h.push("translate(",null,t,null,n);g.push({i:p-4,x:Jr(l,f)},{i:p-2,x:Jr(c,d)})}else(f||d)&&h.push("translate("+f+t+d+n)}function a(l,c,f,d){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),d.push({i:f.push(i(f)+"rotate(",null,r)-2,x:Jr(l,c)})):c&&f.push(i(f)+"rotate("+c+r)}function s(l,c,f,d){l!==c?d.push({i:f.push(i(f)+"skewX(",null,r)-2,x:Jr(l,c)}):c&&f.push(i(f)+"skewX("+c+r)}function u(l,c,f,d,h,g){if(l!==f||c!==d){var p=h.push(i(h)+"scale(",null,",",null,")");g.push({i:p-4,x:Jr(l,f)},{i:p-2,x:Jr(c,d)})}else(f!==1||d!==1)&&h.push(i(h)+"scale("+f+","+d+")")}return function(l,c){var f=[],d=[];return l=e(l),c=e(c),o(l.translateX,l.translateY,c.translateX,c.translateY,f,d),a(l.rotate,c.rotate,f,d),s(l.skewX,c.skewX,f,d),u(l.scaleX,l.scaleY,c.scaleX,c.scaleY,f,d),l=c=null,function(h){for(var g=-1,p=d.length,m;++g<p;)f[(m=d[g]).i]=m.x(h);return f.join("")}}}var yG=xF(pG,"px, ","px)","deg)"),vG=xF(mG,", ",")",")"),ul=0,df=0,hf=0,wF=1e3,ng,gf,rg=0,Os=0,ig=0,pf=typeof performance=="object"&&performance.now?performance:Date,_F=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function vb(){return Os||(_F(bG),Os=pf.now()+ig)}function bG(){Os=0}function og(){this._call=this._time=this._next=null}og.prototype=EF.prototype={constructor:og,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?vb():+n)+(t==null?0:+t),!this._next&&gf!==this&&(gf?gf._next=this:ng=this,gf=this),this._call=e,this._time=n,bb()},stop:function(){this._call&&(this._call=null,this._time=1/0,bb())}};function EF(e,t,n){var r=new og;return r.restart(e,t,n),r}function xG(){vb(),++ul;for(var e=ng,t;e;)(t=Os-e._time)>=0&&e._call.call(void 0,t),e=e._next;--ul}function $F(){Os=(rg=pf.now())+ig,ul=df=0;try{xG()}finally{ul=0,_G(),Os=0}}function wG(){var e=pf.now(),t=e-rg;t>wF&&(ig-=t,rg=e)}function _G(){for(var e,t=ng,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:ng=n);gf=e,bb(r)}function bb(e){if(!ul){df&&(df=clearTimeout(df));var t=e-Os;t>24?(e<1/0&&(df=setTimeout($F,e-pf.now()-ig)),hf&&(hf=clearInterval(hf))):(hf||(rg=pf.now(),hf=setInterval(wG,wF)),ul=1,_F($F))}}function AF(e,t,n){var r=new og;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var EG=G3("start","end","cancel","interrupt"),$G=[],SF=0,CF=1,xb=2,ag=3,OF=4,wb=5,sg=6;function ug(e,t,n,r,i,o){var a=e.__transition;if(!a)e.__transition={};else if(n in a)return;AG(e,n,{name:t,index:r,group:i,on:EG,tween:$G,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:SF})}function _b(e,t){var n=Qr(e,t);if(n.state>SF)throw new Error("too late; already scheduled");return n}function Ri(e,t){var n=Qr(e,t);if(n.state>ag)throw new Error("too late; already running");return n}function Qr(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function AG(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=EF(o,0,n.time);function o(l){n.state=CF,n.timer.restart(a,n.delay,n.time),n.delay<=l&&a(l-n.delay)}function a(l){var c,f,d,h;if(n.state!==CF)return u();for(c in r)if(h=r[c],h.name===n.name){if(h.state===ag)return AF(a);h.state===OF?(h.state=sg,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete r[c]):+c<t&&(h.state=sg,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete r[c])}if(AF(function(){n.state===ag&&(n.state=OF,n.timer.restart(s,n.delay,n.time),s(l))}),n.state=xb,n.on.call("start",e,e.__data__,n.index,n.group),n.state===xb){for(n.state=ag,i=new Array(d=n.tween.length),c=0,f=-1;c<d;++c)(h=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(i[++f]=h);i.length=f+1}}function s(l){for(var c=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(u),n.state=wb,1),f=-1,d=i.length;++f<d;)i[f].call(e,c);n.state===wb&&(n.on.call("end",e,e.__data__,n.index,n.group),u())}function u(){n.state=sg,n.timer.stop(),delete r[t];for(var l in r)return;delete e.__transition}}function SG(e,t){var n=e.__transition,r,i,o=!0,a;if(!!n){t=t==null?null:t+"";for(a in n){if((r=n[a]).name!==t){o=!1;continue}i=r.state>xb&&r.state<wb,r.state=sg,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[a]}o&&delete e.__transition}}function CG(e){return this.each(function(){SG(this,e)})}function OG(e,t){var n,r;return function(){var i=Ri(this,e),o=i.tween;if(o!==n){r=n=o;for(var a=0,s=r.length;a<s;++a)if(r[a].name===t){r=r.slice(),r.splice(a,1);break}}i.tween=r}}function FG(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var o=Ri(this,e),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:t,value:n},u=0,l=i.length;u<l;++u)if(i[u].name===t){i[u]=s;break}u===l&&i.push(s)}o.tween=i}}function kG(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=Qr(this.node(),n).tween,i=0,o=r.length,a;i<o;++i)if((a=r[i]).name===e)return a.value;return null}return this.each((t==null?OG:FG)(n,e,t))}function Eb(e,t,n){var r=e._id;return e.each(function(){var i=Ri(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return Qr(i,r).value[t]}}function FF(e,t){var n;return(typeof t=="number"?Jr:t instanceof Cs?eg:(n=Cs(t))?(t=n,eg):yF)(e,t)}function MG(e){return function(){this.removeAttribute(e)}}function DG(e){return function(){this.removeAttributeNS(e.space,e.local)}}function NG(e,t,n){var r,i=n+"",o;return function(){var a=this.getAttribute(e);return a===i?null:a===r?o:o=t(r=a,n)}}function TG(e,t,n){var r,i=n+"",o;return function(){var a=this.getAttributeNS(e.space,e.local);return a===i?null:a===r?o:o=t(r=a,n)}}function RG(e,t,n){var r,i,o;return function(){var a,s=n(this),u;return s==null?void this.removeAttribute(e):(a=this.getAttribute(e),u=s+"",a===u?null:a===r&&u===i?o:(i=u,o=t(r=a,s)))}}function PG(e,t,n){var r,i,o;return function(){var a,s=n(this),u;return s==null?void this.removeAttributeNS(e.space,e.local):(a=this.getAttributeNS(e.space,e.local),u=s+"",a===u?null:a===r&&u===i?o:(i=u,o=t(r=a,s)))}}function LG(e,t){var n=K0(e),r=n==="transform"?vG:FF;return this.attrTween(e,typeof t=="function"?(n.local?PG:RG)(n,r,Eb(this,"attr."+e,t)):t==null?(n.local?DG:MG)(n):(n.local?TG:NG)(n,r,t))}function jG(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function IG(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function BG(e,t){var n,r;function i(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&IG(e,o)),n}return i._value=t,i}function zG(e,t){var n,r;function i(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&jG(e,o)),n}return i._value=t,i}function UG(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=K0(e);return this.tween(n,(r.local?BG:zG)(r,t))}function qG(e,t){return function(){_b(this,e).delay=+t.apply(this,arguments)}}function HG(e,t){return t=+t,function(){_b(this,e).delay=t}}function WG(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?qG:HG)(t,e)):Qr(this.node(),t).delay}function GG(e,t){return function(){Ri(this,e).duration=+t.apply(this,arguments)}}function YG(e,t){return t=+t,function(){Ri(this,e).duration=t}}function VG(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?GG:YG)(t,e)):Qr(this.node(),t).duration}function XG(e,t){if(typeof t!="function")throw new Error;return function(){Ri(this,e).ease=t}}function KG(e){var t=this._id;return arguments.length?this.each(XG(t,e)):Qr(this.node(),t).ease}function ZG(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Ri(this,e).ease=n}}function JG(e){if(typeof e!="function")throw new Error;return this.each(ZG(this._id,e))}function QG(e){typeof e!="function"&&(e=Z3(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],a=o.length,s=r[i]=[],u,l=0;l<a;++l)(u=o[l])&&e.call(u,u.__data__,l,o)&&s.push(u);return new Mo(r,this._parents,this._name,this._id)}function eY(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var u=t[s],l=n[s],c=u.length,f=a[s]=new Array(c),d,h=0;h<c;++h)(d=u[h]||l[h])&&(f[h]=d);for(;s<r;++s)a[s]=t[s];return new Mo(a,this._parents,this._name,this._id)}function tY(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function nY(e,t,n){var r,i,o=tY(t)?_b:Ri;return function(){var a=o(this,e),s=a.on;s!==r&&(i=(r=s).copy()).on(t,n),a.on=i}}function rY(e,t){var n=this._id;return arguments.length<2?Qr(this.node(),n).on.on(e):this.each(nY(n,e,t))}function iY(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function oY(){return this.on("end.remove",iY(this._id))}function aY(e){var t=this._name,n=this._id;typeof e!="function"&&(e=sb(e));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var s=r[a],u=s.length,l=o[a]=new Array(u),c,f,d=0;d<u;++d)(c=s[d])&&(f=e.call(c,c.__data__,d,s))&&("__data__"in c&&(f.__data__=c.__data__),l[d]=f,ug(l[d],t,n,d,l,Qr(c,n)));return new Mo(o,this._parents,t,n)}function sY(e){var t=this._name,n=this._id;typeof e!="function"&&(e=K3(e));for(var r=this._groups,i=r.length,o=[],a=[],s=0;s<i;++s)for(var u=r[s],l=u.length,c,f=0;f<l;++f)if(c=u[f]){for(var d=e.call(c,c.__data__,f,u),h,g=Qr(c,n),p=0,m=d.length;p<m;++p)(h=d[p])&&ug(h,t,n,p,d,g);o.push(d),a.push(c)}return new Mo(o,a,t,n)}var uY=uf.prototype.constructor;function lY(){return new uY(this._groups,this._parents)}function cY(e,t){var n,r,i;return function(){var o=al(this,e),a=(this.style.removeProperty(e),al(this,e));return o===a?null:o===n&&a===r?i:i=t(n=o,r=a)}}function kF(e){return function(){this.style.removeProperty(e)}}function fY(e,t,n){var r,i=n+"",o;return function(){var a=al(this,e);return a===i?null:a===r?o:o=t(r=a,n)}}function dY(e,t,n){var r,i,o;return function(){var a=al(this,e),s=n(this),u=s+"";return s==null&&(u=s=(this.style.removeProperty(e),al(this,e))),a===u?null:a===r&&u===i?o:(i=u,o=t(r=a,s))}}function hY(e,t){var n,r,i,o="style."+t,a="end."+o,s;return function(){var u=Ri(this,e),l=u.on,c=u.value[o]==null?s||(s=kF(t)):void 0;(l!==n||i!==c)&&(r=(n=l).copy()).on(a,i=c),u.on=r}}function gY(e,t,n){var r=(e+="")==="transform"?yG:FF;return t==null?this.styleTween(e,cY(e,r)).on("end.style."+e,kF(e)):typeof t=="function"?this.styleTween(e,dY(e,r,Eb(this,"style."+e,t))).each(hY(this._id,e)):this.styleTween(e,fY(e,r,t),n).on("end.style."+e,null)}function pY(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function mY(e,t,n){var r,i;function o(){var a=t.apply(this,arguments);return a!==i&&(r=(i=a)&&pY(e,a,n)),r}return o._value=t,o}function yY(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,mY(e,t,n==null?"":n))}function vY(e){return function(){this.textContent=e}}function bY(e){return function(){var t=e(this);this.textContent=t==null?"":t}}function xY(e){return this.tween("text",typeof e=="function"?bY(Eb(this,"text",e)):vY(e==null?"":e+""))}function wY(e){return function(t){this.textContent=e.call(this,t)}}function _Y(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&wY(i)),t}return r._value=e,r}function EY(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,_Y(e))}function $Y(){for(var e=this._name,t=this._id,n=MF(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],s=a.length,u,l=0;l<s;++l)if(u=a[l]){var c=Qr(u,t);ug(u,e,n,l,a,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new Mo(r,this._parents,e,n)}function AY(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(o,a){var s={value:a},u={value:function(){--i==0&&o()}};n.each(function(){var l=Ri(this,r),c=l.on;c!==e&&(t=(e=c).copy(),t._.cancel.push(s),t._.interrupt.push(s),t._.end.push(u)),l.on=t}),i===0&&o()})}var SY=0;function Mo(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function MF(){return++SY}var Do=uf.prototype;Mo.prototype={constructor:Mo,select:aY,selectAll:sY,selectChild:Do.selectChild,selectChildren:Do.selectChildren,filter:QG,merge:eY,selection:lY,transition:$Y,call:Do.call,nodes:Do.nodes,node:Do.node,size:Do.size,empty:Do.empty,each:Do.each,on:rY,attr:LG,attrTween:UG,style:gY,styleTween:yY,text:xY,textTween:EY,remove:oY,tween:kG,delay:WG,duration:VG,ease:KG,easeVarying:JG,end:AY,[Symbol.iterator]:Do[Symbol.iterator]};function CY(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var OY={time:null,delay:0,duration:250,ease:CY};function FY(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function kY(e){var t,n;e instanceof Mo?(t=e._id,e=e._name):(t=MF(),(n=OY).time=vb(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],s=a.length,u,l=0;l<s;++l)(u=a[l])&&ug(u,e,t,l,a,n||FY(u,t));return new Mo(r,this._parents,e,t)}uf.prototype.interrupt=CG;uf.prototype.transition=kY;function MY(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);if(!(e.status===204||e.status===205))return e.json()}function uDe(e,t){return fetch(e,t).then(MY)}function DY(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function lg(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function ll(e){return e=lg(Math.abs(e)),e?e[1]:NaN}function NY(e,t){return function(n,r){for(var i=n.length,o=[],a=0,s=e[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),o.push(n.substring(i-=s,i+s)),!((u+=s+1)>r));)s=e[a=(a+1)%e.length];return o.reverse().join(t)}}function TY(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var RY=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function cg(e){if(!(t=RY.exec(e)))throw new Error("invalid format: "+e);var t;return new $b({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}cg.prototype=$b.prototype;function $b(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}$b.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function PY(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var DF;function LY(e,t){var n=lg(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(DF=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+lg(e,Math.max(0,t+o-1))[0]}function NF(e,t){var n=lg(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var TF={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:DY,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>NF(e*100,t),r:NF,s:LY,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function RF(e){return e}var PF=Array.prototype.map,LF=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function jY(e){var t=e.grouping===void 0||e.thousands===void 0?RF:NY(PF.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?RF:TY(PF.call(e.numerals,String)),a=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"\u2212":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function l(f){f=cg(f);var d=f.fill,h=f.align,g=f.sign,p=f.symbol,m=f.zero,y=f.width,v=f.comma,b=f.precision,x=f.trim,w=f.type;w==="n"?(v=!0,w="g"):TF[w]||(b===void 0&&(b=12),x=!0,w="g"),(m||d==="0"&&h==="=")&&(m=!0,d="0",h="=");var E=p==="$"?n:p==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",_=p==="$"?r:/[%p]/.test(w)?a:"",S=TF[w],C=/[defgprs%]/.test(w);b=b===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function O($){var M=E,F=_,N,A,k;if(w==="c")F=S($)+F,$="";else{$=+$;var T=$<0||1/$<0;if($=isNaN($)?u:S(Math.abs($),b),x&&($=PY($)),T&&+$==0&&g!=="+"&&(T=!1),M=(T?g==="("?g:s:g==="-"||g==="("?"":g)+M,F=(w==="s"?LF[8+DF/3]:"")+F+(T&&g==="("?")":""),C){for(N=-1,A=$.length;++N<A;)if(k=$.charCodeAt(N),48>k||k>57){F=(k===46?i+$.slice(N+1):$.slice(N))+F,$=$.slice(0,N);break}}}v&&!m&&($=t($,1/0));var L=M.length+$.length+F.length,z=L<y?new Array(y-L+1).join(d):"";switch(v&&m&&($=t(z+$,z.length?y-F.length:1/0),z=""),h){case"<":$=M+$+F+z;break;case"=":$=M+z+$+F;break;case"^":$=z.slice(0,L=z.length>>1)+M+$+F+z.slice(L);break;default:$=z+M+$+F;break}return o($)}return O.toString=function(){return f+""},O}function c(f,d){var h=l((f=cg(f),f.type="f",f)),g=Math.max(-8,Math.min(8,Math.floor(ll(d)/3)))*3,p=Math.pow(10,-g),m=LF[8+g/3];return function(y){return h(p*y)+m}}return{format:l,formatPrefix:c}}var fg,jF,IF;IY({thousands:",",grouping:[3],currency:["$",""]});function IY(e){return fg=jY(e),jF=fg.format,IF=fg.formatPrefix,fg}function BY(e){return Math.max(0,-ll(Math.abs(e)))}function zY(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(ll(t)/3)))*3-ll(Math.abs(e)))}function UY(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,ll(t)-ll(e))+1}var Ke=1e-6,qY=1e-12,Ae=Math.PI,Un=Ae/2,BF=Ae/4,dr=Ae*2,hr=180/Ae,wt=Ae/180,lt=Math.abs,zF=Math.atan,mf=Math.atan2,pt=Math.cos,HY=Math.exp,WY=Math.log,mt=Math.sin,GY=Math.sign||function(e){return e>0?1:e<0?-1:0},Fs=Math.sqrt,YY=Math.tan;function VY(e){return e>1?0:e<-1?Ae:Math.acos(e)}function yf(e){return e>1?Un:e<-1?-Un:Math.asin(e)}function Mr(){}function dg(e,t){e&&qF.hasOwnProperty(e.type)&&qF[e.type](e,t)}var UF={Feature:function(e,t){dg(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)dg(n[r].geometry,t)}},qF={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){Ab(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)Ab(n[r],t,0)},Polygon:function(e,t){HF(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)HF(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)dg(n[r],t)}};function Ab(e,t,n){var r=-1,i=e.length-n,o;for(t.lineStart();++r<i;)o=e[r],t.point(o[0],o[1],o[2]);t.lineEnd()}function HF(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)Ab(e[n],t,1);t.polygonEnd()}function cl(e,t){e&&UF.hasOwnProperty(e.type)?UF[e.type](e,t):dg(e,t)}function Sb(e){return[mf(e[1],e[0]),yf(e[2])]}function fl(e){var t=e[0],n=e[1],r=pt(n);return[r*pt(t),r*mt(t),mt(n)]}function hg(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function gg(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Cb(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function pg(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Ob(e){var t=Fs(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function Fb(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function kb(e,t){return[lt(e)>Ae?e+Math.round(-e/dr)*dr:e,t]}kb.invert=kb;function WF(e,t,n){return(e%=dr)?t||n?Fb(YF(e),VF(t,n)):YF(e):t||n?VF(t,n):kb}function GF(e){return function(t,n){return t+=e,[t>Ae?t-dr:t<-Ae?t+dr:t,n]}}function YF(e){var t=GF(e);return t.invert=GF(-e),t}function VF(e,t){var n=pt(e),r=mt(e),i=pt(t),o=mt(t);function a(s,u){var l=pt(u),c=pt(s)*l,f=mt(s)*l,d=mt(u),h=d*n+c*r;return[mf(f*i-h*o,c*n-d*r),yf(h*i+f*o)]}return a.invert=function(s,u){var l=pt(u),c=pt(s)*l,f=mt(s)*l,d=mt(u),h=d*i-f*o;return[mf(f*i+d*o,c*n+h*r),yf(h*n-c*r)]},a}function XY(e){e=WF(e[0]*wt,e[1]*wt,e.length>2?e[2]*wt:0);function t(n){return n=e(n[0]*wt,n[1]*wt),n[0]*=hr,n[1]*=hr,n}return t.invert=function(n){return n=e.invert(n[0]*wt,n[1]*wt),n[0]*=hr,n[1]*=hr,n},t}function KY(e,t,n,r,i,o){if(!!n){var a=pt(t),s=mt(t),u=r*n;i==null?(i=t+r*dr,o=t-u/2):(i=XF(a,i),o=XF(a,o),(r>0?i<o:i>o)&&(i+=r*dr));for(var l,c=i;r>0?c>o:c<o;c-=u)l=Sb([a,-s*pt(c),-s*mt(c)]),e.point(l[0],l[1])}}function XF(e,t){t=fl(t),t[0]-=e,Ob(t);var n=VY(-t[1]);return((-t[2]<0?-n:n)+dr-Ke)%dr}function KF(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:Mr,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function mg(e,t){return lt(e[0]-t[0])<Ke&&lt(e[1]-t[1])<Ke}function yg(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function ZF(e,t,n,r,i){var o=[],a=[],s,u;if(e.forEach(function(g){if(!((p=g.length-1)<=0)){var p,m=g[0],y=g[p],v;if(mg(m,y)){if(!m[2]&&!y[2]){for(i.lineStart(),s=0;s<p;++s)i.point((m=g[s])[0],m[1]);i.lineEnd();return}y[0]+=2*Ke}o.push(v=new yg(m,g,null,!0)),a.push(v.o=new yg(m,null,v,!1)),o.push(v=new yg(y,g,null,!1)),a.push(v.o=new yg(y,null,v,!0))}}),!!o.length){for(a.sort(t),JF(o),JF(a),s=0,u=a.length;s<u;++s)a[s].e=n=!n;for(var l=o[0],c,f;;){for(var d=l,h=!0;d.v;)if((d=d.n)===l)return;c=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(s=0,u=c.length;s<u;++s)i.point((f=c[s])[0],f[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(h)for(c=d.p.z,s=c.length-1;s>=0;--s)i.point((f=c[s])[0],f[1]);else r(d.x,d.p.x,-1,i);d=d.p}d=d.o,c=d.z,h=!h}while(!d.v);i.lineEnd()}}}function JF(e){if(!!(t=e.length)){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function Mb(e){return lt(e[0])<=Ae?e[0]:GY(e[0])*((lt(e[0])+Ae)%dr-Ae)}function ZY(e,t){var n=Mb(t),r=t[1],i=mt(r),o=[mt(n),-pt(n),0],a=0,s=0,u=new Ss;i===1?r=Un+Ke:i===-1&&(r=-Un-Ke);for(var l=0,c=e.length;l<c;++l)if(!!(d=(f=e[l]).length))for(var f,d,h=f[d-1],g=Mb(h),p=h[1]/2+BF,m=mt(p),y=pt(p),v=0;v<d;++v,g=x,m=E,y=_,h=b){var b=f[v],x=Mb(b),w=b[1]/2+BF,E=mt(w),_=pt(w),S=x-g,C=S>=0?1:-1,O=C*S,$=O>Ae,M=m*E;if(u.add(mf(M*C*mt(O),y*_+M*pt(O))),a+=$?S+C*dr:S,$^g>=n^x>=n){var F=gg(fl(h),fl(b));Ob(F);var N=gg(o,F);Ob(N);var A=($^S>=0?-1:1)*yf(N[2]);(r>A||r===A&&(F[0]||F[1]))&&(s+=$^S>=0?1:-1)}}return(a<-Ke||a<Ke&&u<-qY)^s&1}function QF(e,t,n,r){return function(i){var o=t(i),a=KF(),s=t(a),u=!1,l,c,f,d={point:h,lineStart:p,lineEnd:m,polygonStart:function(){d.point=y,d.lineStart=v,d.lineEnd=b,c=[],l=[]},polygonEnd:function(){d.point=h,d.lineStart=p,d.lineEnd=m,c=W3(c);var x=ZY(l,r);c.length?(u||(i.polygonStart(),u=!0),ZF(c,QY,x,n,i)):x&&(u||(i.polygonStart(),u=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),u&&(i.polygonEnd(),u=!1),c=l=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(x,w){e(x,w)&&i.point(x,w)}function g(x,w){o.point(x,w)}function p(){d.point=g,o.lineStart()}function m(){d.point=h,o.lineEnd()}function y(x,w){f.push([x,w]),s.point(x,w)}function v(){s.lineStart(),f=[]}function b(){y(f[0][0],f[0][1]),s.lineEnd();var x=s.clean(),w=a.result(),E,_=w.length,S,C,O;if(f.pop(),l.push(f),f=null,!!_){if(x&1){if(C=w[0],(S=C.length-1)>0){for(u||(i.polygonStart(),u=!0),i.lineStart(),E=0;E<S;++E)i.point((O=C[E])[0],O[1]);i.lineEnd()}return}_>1&&x&2&&w.push(w.pop().concat(w.shift())),c.push(w.filter(JY))}}return d}}function JY(e){return e.length>1}function QY(e,t){return((e=e.x)[0]<0?e[1]-Un-Ke:Un-e[1])-((t=t.x)[0]<0?t[1]-Un-Ke:Un-t[1])}var ek=QF(function(){return!0},eV,nV,[-Ae,-Un]);function eV(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(o,a){var s=o>0?Ae:-Ae,u=lt(o-t);lt(u-Ae)<Ke?(e.point(t,n=(n+a)/2>0?Un:-Un),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(s,n),e.point(o,n),i=0):r!==s&&u>=Ae&&(lt(t-r)<Ke&&(t-=r*Ke),lt(o-s)<Ke&&(o-=s*Ke),n=tV(t,n,o,a),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(s,n),i=0),e.point(t=o,n=a),r=s},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function tV(e,t,n,r){var i,o,a=mt(e-n);return lt(a)>Ke?zF((mt(t)*(o=pt(r))*mt(n)-mt(r)*(i=pt(t))*mt(e))/(i*o*a)):(t+r)/2}function nV(e,t,n,r){var i;if(e==null)i=n*Un,r.point(-Ae,i),r.point(0,i),r.point(Ae,i),r.point(Ae,0),r.point(Ae,-i),r.point(0,-i),r.point(-Ae,-i),r.point(-Ae,0),r.point(-Ae,i);else if(lt(e[0]-t[0])>Ke){var o=e[0]<t[0]?Ae:-Ae;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(t[0],t[1])}function rV(e){var t=pt(e),n=6*wt,r=t>0,i=lt(t)>Ke;function o(c,f,d,h){KY(h,e,n,d,c,f)}function a(c,f){return pt(c)*pt(f)>t}function s(c){var f,d,h,g,p;return{lineStart:function(){g=h=!1,p=1},point:function(m,y){var v=[m,y],b,x=a(m,y),w=r?x?0:l(m,y):x?l(m+(m<0?Ae:-Ae),y):0;if(!f&&(g=h=x)&&c.lineStart(),x!==h&&(b=u(f,v),(!b||mg(f,b)||mg(v,b))&&(v[2]=1)),x!==h)p=0,x?(c.lineStart(),b=u(v,f),c.point(b[0],b[1])):(b=u(f,v),c.point(b[0],b[1],2),c.lineEnd()),f=b;else if(i&&f&&r^x){var E;!(w&d)&&(E=u(v,f,!0))&&(p=0,r?(c.lineStart(),c.point(E[0][0],E[0][1]),c.point(E[1][0],E[1][1]),c.lineEnd()):(c.point(E[1][0],E[1][1]),c.lineEnd(),c.lineStart(),c.point(E[0][0],E[0][1],3)))}x&&(!f||!mg(f,v))&&c.point(v[0],v[1]),f=v,h=x,d=w},lineEnd:function(){h&&c.lineEnd(),f=null},clean:function(){return p|(g&&h)<<1}}}function u(c,f,d){var h=fl(c),g=fl(f),p=[1,0,0],m=gg(h,g),y=hg(m,m),v=m[0],b=y-v*v;if(!b)return!d&&c;var x=t*y/b,w=-t*v/b,E=gg(p,m),_=pg(p,x),S=pg(m,w);Cb(_,S);var C=E,O=hg(_,C),$=hg(C,C),M=O*O-$*(hg(_,_)-1);if(!(M<0)){var F=Fs(M),N=pg(C,(-O-F)/$);if(Cb(N,_),N=Sb(N),!d)return N;var A=c[0],k=f[0],T=c[1],L=f[1],z;k<A&&(z=A,A=k,k=z);var Q=k-A,oe=lt(Q-Ae)<Ke,ue=oe||Q<Ke;if(!oe&&L<T&&(z=T,T=L,L=z),ue?oe?T+L>0^N[1]<(lt(N[0]-A)<Ke?T:L):T<=N[1]&&N[1]<=L:Q>Ae^(A<=N[0]&&N[0]<=k)){var ce=pg(C,(-O+F)/$);return Cb(ce,_),[N,Sb(ce)]}}}function l(c,f){var d=r?e:Ae-e,h=0;return c<-d?h|=1:c>d&&(h|=2),f<-d?h|=4:f>d&&(h|=8),h}return QF(a,s,o,r?[0,-e]:[-Ae,e-Ae])}function iV(e,t,n,r,i,o){var a=e[0],s=e[1],u=t[0],l=t[1],c=0,f=1,d=u-a,h=l-s,g;if(g=n-a,!(!d&&g>0)){if(g/=d,d<0){if(g<c)return;g<f&&(f=g)}else if(d>0){if(g>f)return;g>c&&(c=g)}if(g=i-a,!(!d&&g<0)){if(g/=d,d<0){if(g>f)return;g>c&&(c=g)}else if(d>0){if(g<c)return;g<f&&(f=g)}if(g=r-s,!(!h&&g>0)){if(g/=h,h<0){if(g<c)return;g<f&&(f=g)}else if(h>0){if(g>f)return;g>c&&(c=g)}if(g=o-s,!(!h&&g<0)){if(g/=h,h<0){if(g>f)return;g>c&&(c=g)}else if(h>0){if(g<c)return;g<f&&(f=g)}return c>0&&(e[0]=a+c*d,e[1]=s+c*h),f<1&&(t[0]=a+f*d,t[1]=s+f*h),!0}}}}}var vf=1e9,vg=-vf;function oV(e,t,n,r){function i(l,c){return e<=l&&l<=n&&t<=c&&c<=r}function o(l,c,f,d){var h=0,g=0;if(l==null||(h=a(l,f))!==(g=a(c,f))||u(l,c)<0^f>0)do d.point(h===0||h===3?e:n,h>1?r:t);while((h=(h+f+4)%4)!==g);else d.point(c[0],c[1])}function a(l,c){return lt(l[0]-e)<Ke?c>0?0:3:lt(l[0]-n)<Ke?c>0?2:1:lt(l[1]-t)<Ke?c>0?1:0:c>0?3:2}function s(l,c){return u(l.x,c.x)}function u(l,c){var f=a(l,1),d=a(c,1);return f!==d?f-d:f===0?c[1]-l[1]:f===1?l[0]-c[0]:f===2?l[1]-c[1]:c[0]-l[0]}return function(l){var c=l,f=KF(),d,h,g,p,m,y,v,b,x,w,E,_={point:S,lineStart:M,lineEnd:F,polygonStart:O,polygonEnd:$};function S(A,k){i(A,k)&&c.point(A,k)}function C(){for(var A=0,k=0,T=h.length;k<T;++k)for(var L=h[k],z=1,Q=L.length,oe=L[0],ue,ce,xe=oe[0],_e=oe[1];z<Q;++z)ue=xe,ce=_e,oe=L[z],xe=oe[0],_e=oe[1],ce<=r?_e>r&&(xe-ue)*(r-ce)>(_e-ce)*(e-ue)&&++A:_e<=r&&(xe-ue)*(r-ce)<(_e-ce)*(e-ue)&&--A;return A}function O(){c=f,d=[],h=[],E=!0}function $(){var A=C(),k=E&&A,T=(d=W3(d)).length;(k||T)&&(l.polygonStart(),k&&(l.lineStart(),o(null,null,1,l),l.lineEnd()),T&&ZF(d,s,A,o,l),l.polygonEnd()),c=l,d=h=g=null}function M(){_.point=N,h&&h.push(g=[]),w=!0,x=!1,v=b=NaN}function F(){d&&(N(p,m),y&&x&&f.rejoin(),d.push(f.result())),_.point=S,x&&c.lineEnd()}function N(A,k){var T=i(A,k);if(h&&g.push([A,k]),w)p=A,m=k,y=T,w=!1,T&&(c.lineStart(),c.point(A,k));else if(T&&x)c.point(A,k);else{var L=[v=Math.max(vg,Math.min(vf,v)),b=Math.max(vg,Math.min(vf,b))],z=[A=Math.max(vg,Math.min(vf,A)),k=Math.max(vg,Math.min(vf,k))];iV(L,z,e,t,n,r)?(x||(c.lineStart(),c.point(L[0],L[1])),c.point(z[0],z[1]),T||c.lineEnd(),E=!1):T&&(c.lineStart(),c.point(A,k),E=!1)}v=A,b=k,x=T}return _}}var Db=e=>e,Nb=new Ss,Tb=new Ss,tk,nk,Rb,Pb,ya={point:Mr,lineStart:Mr,lineEnd:Mr,polygonStart:function(){ya.lineStart=aV,ya.lineEnd=uV},polygonEnd:function(){ya.lineStart=ya.lineEnd=ya.point=Mr,Nb.add(lt(Tb)),Tb=new Ss},result:function(){var e=Nb/2;return Nb=new Ss,e}};function aV(){ya.point=sV}function sV(e,t){ya.point=rk,tk=Rb=e,nk=Pb=t}function rk(e,t){Tb.add(Pb*e-Rb*t),Rb=e,Pb=t}function uV(){rk(tk,nk)}var ik=ya,dl=1/0,bg=dl,bf=-dl,xg=bf,lV={point:cV,lineStart:Mr,lineEnd:Mr,polygonStart:Mr,polygonEnd:Mr,result:function(){var e=[[dl,bg],[bf,xg]];return bf=xg=-(bg=dl=1/0),e}};function cV(e,t){e<dl&&(dl=e),e>bf&&(bf=e),t<bg&&(bg=t),t>xg&&(xg=t)}var wg=lV,Lb=0,jb=0,xf=0,_g=0,Eg=0,hl=0,Ib=0,Bb=0,wf=0,ok,ak,Pi,Li,ei={point:ks,lineStart:sk,lineEnd:uk,polygonStart:function(){ei.lineStart=hV,ei.lineEnd=gV},polygonEnd:function(){ei.point=ks,ei.lineStart=sk,ei.lineEnd=uk},result:function(){var e=wf?[Ib/wf,Bb/wf]:hl?[_g/hl,Eg/hl]:xf?[Lb/xf,jb/xf]:[NaN,NaN];return Lb=jb=xf=_g=Eg=hl=Ib=Bb=wf=0,e}};function ks(e,t){Lb+=e,jb+=t,++xf}function sk(){ei.point=fV}function fV(e,t){ei.point=dV,ks(Pi=e,Li=t)}function dV(e,t){var n=e-Pi,r=t-Li,i=Fs(n*n+r*r);_g+=i*(Pi+e)/2,Eg+=i*(Li+t)/2,hl+=i,ks(Pi=e,Li=t)}function uk(){ei.point=ks}function hV(){ei.point=pV}function gV(){lk(ok,ak)}function pV(e,t){ei.point=lk,ks(ok=Pi=e,ak=Li=t)}function lk(e,t){var n=e-Pi,r=t-Li,i=Fs(n*n+r*r);_g+=i*(Pi+e)/2,Eg+=i*(Li+t)/2,hl+=i,i=Li*e-Pi*t,Ib+=i*(Pi+e),Bb+=i*(Li+t),wf+=i*3,ks(Pi=e,Li=t)}var ck=ei;function fk(e){this._context=e}fk.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,dr);break}}},result:Mr};var zb=new Ss,Ub,dk,hk,_f,Ef,$g={point:Mr,lineStart:function(){$g.point=mV},lineEnd:function(){Ub&&gk(dk,hk),$g.point=Mr},polygonStart:function(){Ub=!0},polygonEnd:function(){Ub=null},result:function(){var e=+zb;return zb=new Ss,e}};function mV(e,t){$g.point=gk,dk=_f=e,hk=Ef=t}function gk(e,t){_f-=e,Ef-=t,zb.add(Fs(_f*_f+Ef*Ef)),_f=e,Ef=t}var pk=$g;function mk(){this._string=[]}mk.prototype={_radius:4.5,_circle:yk(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._string.push("M",e,",",t),this._point=1;break}case 1:{this._string.push("L",e,",",t);break}default:{this._circle==null&&(this._circle=yk(this._radius)),this._string.push("M",e,",",t,this._circle);break}}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}else return null}};function yk(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function lDe(e,t){var n=4.5,r,i;function o(a){return a&&(typeof n=="function"&&i.pointRadius(+n.apply(this,arguments)),cl(a,r(i))),i.result()}return o.area=function(a){return cl(a,r(ik)),ik.result()},o.measure=function(a){return cl(a,r(pk)),pk.result()},o.bounds=function(a){return cl(a,r(wg)),wg.result()},o.centroid=function(a){return cl(a,r(ck)),ck.result()},o.projection=function(a){return arguments.length?(r=a==null?(e=null,Db):(e=a).stream,o):e},o.context=function(a){return arguments.length?(i=a==null?(t=null,new mk):new fk(t=a),typeof n!="function"&&i.pointRadius(n),o):t},o.pointRadius=function(a){return arguments.length?(n=typeof a=="function"?a:(i.pointRadius(+a),+a),o):n},o.projection(e).context(t)}function qb(e){return function(t){var n=new Hb;for(var r in e)n[r]=e[r];return n.stream=t,n}}function Hb(){}Hb.prototype={constructor:Hb,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Wb(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),cl(n,e.stream(wg)),t(wg.result()),r!=null&&e.clipExtent(r),e}function vk(e,t,n){return Wb(e,function(r){var i=t[1][0]-t[0][0],o=t[1][1]-t[0][1],a=Math.min(i/(r[1][0]-r[0][0]),o/(r[1][1]-r[0][1])),s=+t[0][0]+(i-a*(r[1][0]+r[0][0]))/2,u=+t[0][1]+(o-a*(r[1][1]+r[0][1]))/2;e.scale(150*a).translate([s,u])},n)}function yV(e,t,n){return vk(e,[[0,0],t],n)}function vV(e,t,n){return Wb(e,function(r){var i=+t,o=i/(r[1][0]-r[0][0]),a=(i-o*(r[1][0]+r[0][0]))/2,s=-o*r[0][1];e.scale(150*o).translate([a,s])},n)}function bV(e,t,n){return Wb(e,function(r){var i=+t,o=i/(r[1][1]-r[0][1]),a=-o*r[0][0],s=(i-o*(r[1][1]+r[0][1]))/2;e.scale(150*o).translate([a,s])},n)}var bk=16,xV=pt(30*wt);function xk(e,t){return+t?_V(e,t):wV(e)}function wV(e){return qb({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function _V(e,t){function n(r,i,o,a,s,u,l,c,f,d,h,g,p,m){var y=l-r,v=c-i,b=y*y+v*v;if(b>4*t&&p--){var x=a+d,w=s+h,E=u+g,_=Fs(x*x+w*w+E*E),S=yf(E/=_),C=lt(lt(E)-1)<Ke||lt(o-f)<Ke?(o+f)/2:mf(w,x),O=e(C,S),$=O[0],M=O[1],F=$-r,N=M-i,A=v*F-y*N;(A*A/b>t||lt((y*F+v*N)/b-.5)>.3||a*d+s*h+u*g<xV)&&(n(r,i,o,a,s,u,$,M,C,x/=_,w/=_,E,p,m),m.point($,M),n($,M,C,x,w,E,l,c,f,d,h,g,p,m))}}return function(r){var i,o,a,s,u,l,c,f,d,h,g,p,m={point:y,lineStart:v,lineEnd:x,polygonStart:function(){r.polygonStart(),m.lineStart=w},polygonEnd:function(){r.polygonEnd(),m.lineStart=v}};function y(S,C){S=e(S,C),r.point(S[0],S[1])}function v(){f=NaN,m.point=b,r.lineStart()}function b(S,C){var O=fl([S,C]),$=e(S,C);n(f,d,c,h,g,p,f=$[0],d=$[1],c=S,h=O[0],g=O[1],p=O[2],bk,r),r.point(f,d)}function x(){m.point=y,r.lineEnd()}function w(){v(),m.point=E,m.lineEnd=_}function E(S,C){b(i=S,C),o=f,a=d,s=h,u=g,l=p,m.point=b}function _(){n(f,d,c,h,g,p,o,a,i,s,u,l,bk,r),m.lineEnd=x,x()}return m}}var EV=qb({point:function(e,t){this.stream.point(e*wt,t*wt)}});function $V(e){return qb({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function AV(e,t,n,r,i){function o(a,s){return a*=r,s*=i,[t+e*a,n-e*s]}return o.invert=function(a,s){return[(a-t)/e*r,(n-s)/e*i]},o}function wk(e,t,n,r,i,o){if(!o)return AV(e,t,n,r,i);var a=pt(o),s=mt(o),u=a*e,l=s*e,c=a/e,f=s/e,d=(s*n-a*t)/e,h=(s*t+a*n)/e;function g(p,m){return p*=r,m*=i,[u*p-l*m+t,n-l*p-u*m]}return g.invert=function(p,m){return[r*(c*p-f*m+d),i*(h-f*p-c*m)]},g}function SV(e){return CV(function(){return e})()}function CV(e){var t,n=150,r=480,i=250,o=0,a=0,s=0,u=0,l=0,c,f=0,d=1,h=1,g=null,p=ek,m=null,y,v,b,x=Db,w=.5,E,_,S,C,O;function $(A){return S(A[0]*wt,A[1]*wt)}function M(A){return A=S.invert(A[0],A[1]),A&&[A[0]*hr,A[1]*hr]}$.stream=function(A){return C&&O===A?C:C=EV($V(c)(p(E(x(O=A)))))},$.preclip=function(A){return arguments.length?(p=A,g=void 0,N()):p},$.postclip=function(A){return arguments.length?(x=A,m=y=v=b=null,N()):x},$.clipAngle=function(A){return arguments.length?(p=+A?rV(g=A*wt):(g=null,ek),N()):g*hr},$.clipExtent=function(A){return arguments.length?(x=A==null?(m=y=v=b=null,Db):oV(m=+A[0][0],y=+A[0][1],v=+A[1][0],b=+A[1][1]),N()):m==null?null:[[m,y],[v,b]]},$.scale=function(A){return arguments.length?(n=+A,F()):n},$.translate=function(A){return arguments.length?(r=+A[0],i=+A[1],F()):[r,i]},$.center=function(A){return arguments.length?(o=A[0]%360*wt,a=A[1]%360*wt,F()):[o*hr,a*hr]},$.rotate=function(A){return arguments.length?(s=A[0]%360*wt,u=A[1]%360*wt,l=A.length>2?A[2]%360*wt:0,F()):[s*hr,u*hr,l*hr]},$.angle=function(A){return arguments.length?(f=A%360*wt,F()):f*hr},$.reflectX=function(A){return arguments.length?(d=A?-1:1,F()):d<0},$.reflectY=function(A){return arguments.length?(h=A?-1:1,F()):h<0},$.precision=function(A){return arguments.length?(E=xk(_,w=A*A),N()):Fs(w)},$.fitExtent=function(A,k){return vk($,A,k)},$.fitSize=function(A,k){return yV($,A,k)},$.fitWidth=function(A,k){return vV($,A,k)},$.fitHeight=function(A,k){return bV($,A,k)};function F(){var A=wk(n,0,0,d,h,f).apply(null,t(o,a)),k=wk(n,r-A[0],i-A[1],d,h,f);return c=WF(s,u,l),_=Fb(t,k),S=Fb(c,_),E=xk(_,w),N()}function N(){return C=O=null,$}return function(){return t=e.apply(this,arguments),$.invert=t.invert&&M,F()}}function Gb(e,t){return[e,WY(YY((Un+t)/2))]}Gb.invert=function(e,t){return[e,2*zF(HY(t))-Un]};function cDe(){return OV(Gb).scale(961/dr)}function OV(e){var t=SV(e),n=t.center,r=t.scale,i=t.translate,o=t.clipExtent,a=null,s,u,l;t.scale=function(f){return arguments.length?(r(f),c()):r()},t.translate=function(f){return arguments.length?(i(f),c()):i()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(f==null?a=s=u=l=null:(a=+f[0][0],s=+f[0][1],u=+f[1][0],l=+f[1][1]),c()):a==null?null:[[a,s],[u,l]]};function c(){var f=Ae*r(),d=t(XY(t.rotate()).invert([0,0]));return o(a==null?[[d[0]-f,d[1]-f],[d[0]+f,d[1]+f]]:e===Gb?[[Math.max(d[0]-f,a),s],[Math.min(d[0]+f,u),l]]:[[a,Math.max(d[1]-f,s)],[u,Math.min(d[1]+f,l)]])}return c()}function FV(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function kV(e){return function(){return e}}function MV(e){return+e}var _k=[0,1];function gl(e){return e}function Yb(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:kV(isNaN(t)?NaN:.5)}function DV(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function NV(e,t,n){var r=e[0],i=e[1],o=t[0],a=t[1];return i<r?(r=Yb(i,r),o=n(a,o)):(r=Yb(r,i),o=n(o,a)),function(s){return o(r(s))}}function TV(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),o=new Array(r),a=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<r;)i[a]=Yb(e[a],e[a+1]),o[a]=n(t[a],t[a+1]);return function(s){var u=lH(e,s,1,r)-1;return o[u](i[u](s))}}function RV(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function PV(){var e=_k,t=_k,n=mb,r,i,o,a=gl,s,u,l;function c(){var d=Math.min(e.length,t.length);return a!==gl&&(a=DV(e[0],e[d-1])),s=d>2?TV:NV,u=l=null,f}function f(d){return d==null||isNaN(d=+d)?o:(u||(u=s(e.map(r),t,n)))(r(a(d)))}return f.invert=function(d){return a(i((l||(l=s(t,e.map(r),Jr)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,MV),c()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),c()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),n=gG,c()},f.clamp=function(d){return arguments.length?(a=d?!0:gl,c()):a!==gl},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(o=d,f):o},function(d,h){return r=d,i=h,c()}}function LV(){return PV()(gl,gl)}function jV(e,t,n,r){var i=fH(e,t,n),o;switch(r=cg(r==null?",f":r),r.type){case"s":{var a=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(o=zY(i,a))&&(r.precision=o),IF(r,a)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=UY(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=BY(i))&&(r.precision=o-(r.type==="%")*2);break}}return jF(r)}function IV(e){var t=e.domain;return e.ticks=function(n){var r=t();return cH(r[0],r[r.length-1],n==null?10:n)},e.tickFormat=function(n,r){var i=t();return jV(i[0],i[i.length-1],n==null?10:n,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,o=r.length-1,a=r[i],s=r[o],u,l,c=10;for(s<a&&(l=a,a=s,s=l,l=i,i=o,o=l);c-- >0;){if(l=H3(a,s,n),l===u)return r[i]=a,r[o]=s,t(r);if(l>0)a=Math.floor(a/l)*l,s=Math.ceil(s/l)*l;else if(l<0)a=Math.ceil(a*l)/l,s=Math.floor(s*l)/l;else break;u=l}return e},e}function BV(){var e=LV();return e.copy=function(){return RV(e,BV())},FV.apply(e,arguments),IV(e)}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var zV=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),UV=Object.prototype.hasOwnProperty;function Vb(e,t){return UV.call(e,t)}function Xb(e){if(Array.isArray(e)){for(var n=new Array(e.length),t=0;t<n.length;t++)n[t]=""+t;return n}if(Object.keys)return Object.keys(e);var n=[];for(var r in e)Vb(e,r)&&n.push(r);return n}function gr(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function Kb(e){for(var t=0,n=e.length,r;t<n;){if(r=e.charCodeAt(t),r>=48&&r<=57){t++;continue}return!1}return!0}function Ms(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function Ek(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function Zb(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(Zb(e[t]))return!0}else if(typeof e=="object"){for(var r=Xb(e),i=r.length,t=0;t<i;t++)if(Zb(e[r[t]]))return!0}}return!1}function $k(e,t){var n=[e];for(var r in t){var i=typeof t[r]=="object"?JSON.stringify(t[r],null,2):t[r];typeof i!="undefined"&&n.push(r+": "+i)}return n.join(`
`)}var Ak=function(e){zV(t,e);function t(n,r,i,o,a){var s=this.constructor,u=e.call(this,$k(n,{name:r,index:i,operation:o,tree:a}))||this;return u.name=r,u.index=i,u.operation=o,u.tree=a,Object.setPrototypeOf(u,s.prototype),u.message=$k(n,{name:r,index:i,operation:o,tree:a}),u}return t}(Error),ct=Ak,qV=gr,pl={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=Ag(n,this.path);r&&(r=gr(r));var i=Ds(n,{op:"remove",path:this.from}).removed;return Ds(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=Ag(n,this.from);return Ds(n,{op:"add",path:this.path,value:gr(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:$f(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},HV={add:function(e,t,n){return Kb(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var r=e.splice(t,1);return{newDocument:n,removed:r[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:pl.move,copy:pl.copy,test:pl.test,_get:pl._get};function Ag(e,t){if(t=="")return e;var n={op:"_get",path:t};return Ds(e,n),n.value}function Ds(e,t,n,r,i,o){if(n===void 0&&(n=!1),r===void 0&&(r=!0),i===void 0&&(i=!0),o===void 0&&(o=0),n&&(typeof n=="function"?n(t,0,e,t.path):Cg(t,0)),t.path===""){var a={newDocument:e};if(t.op==="add")return a.newDocument=t.value,a;if(t.op==="replace")return a.newDocument=t.value,a.removed=e,a;if(t.op==="move"||t.op==="copy")return a.newDocument=Ag(e,t.from),t.op==="move"&&(a.removed=e),a;if(t.op==="test"){if(a.test=$f(e,t.value),a.test===!1)throw new ct("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a.newDocument=e,a}else{if(t.op==="remove")return a.removed=e,a.newDocument=null,a;if(t.op==="_get")return t.value=e,a;if(n)throw new ct("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",o,t,e);return a}}else{r||(e=gr(e));var s=t.path||"",u=s.split("/"),l=e,c=1,f=u.length,d=void 0,h=void 0,g=void 0;for(typeof n=="function"?g=n:g=Cg;;){if(h=u[c],h&&h.indexOf("~")!=-1&&(h=Ek(h)),i&&h=="__proto__")throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&d===void 0&&(l[h]===void 0?d=u.slice(0,c).join("/"):c==f-1&&(d=t.path),d!==void 0&&g(t,0,e,d)),c++,Array.isArray(l)){if(h==="-")h=l.length;else{if(n&&!Kb(h))throw new ct("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",o,t,e);Kb(h)&&(h=~~h)}if(c>=f){if(n&&t.op==="add"&&h>l.length)throw new ct("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",o,t,e);var a=HV[t.op].call(t,l,h,e);if(a.test===!1)throw new ct("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a}}else if(c>=f){var a=pl[t.op].call(t,l,h,e);if(a.test===!1)throw new ct("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a}if(l=l[h],n&&c<f&&(!l||typeof l!="object"))throw new ct("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",o,t,e)}}}function Sg(e,t,n,r,i){if(r===void 0&&(r=!0),i===void 0&&(i=!0),n&&!Array.isArray(t))throw new ct("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=gr(e));for(var o=new Array(t.length),a=0,s=t.length;a<s;a++)o[a]=Ds(e,t[a],n,!0,i,a),e=o[a].newDocument;return o.newDocument=e,o}function WV(e,t,n){var r=Ds(e,t);if(r.test===!1)throw new ct("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function Cg(e,t,n,r){if(typeof e!="object"||e===null||Array.isArray(e))throw new ct("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(pl[e.op]){if(typeof e.path!="string")throw new ct("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new ct('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new ct("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new ct("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&Zb(e.value))throw new ct("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var i=e.path.split("/").length,o=r.split("/").length;if(i!==o+1&&i!==o)throw new ct("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==r)throw new ct("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var a={op:"_get",path:e.from,value:void 0},s=Sk([a],n);if(s&&s.name==="OPERATION_PATH_UNRESOLVABLE")throw new ct("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new ct("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function Sk(e,t,n){try{if(!Array.isArray(e))throw new ct("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)Sg(gr(t),gr(e),n||!0);else{n=n||Cg;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(i){if(i instanceof ct)return i;throw i}}function $f(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),r=Array.isArray(t),i,o,a;if(n&&r){if(o=e.length,o!=t.length)return!1;for(i=o;i--!=0;)if(!$f(e[i],t[i]))return!1;return!0}if(n!=r)return!1;var s=Object.keys(e);if(o=s.length,o!==Object.keys(t).length)return!1;for(i=o;i--!=0;)if(!t.hasOwnProperty(s[i]))return!1;for(i=o;i--!=0;)if(a=s[i],!$f(e[a],t[a]))return!1;return!0}return e!==e&&t!==t}var GV=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",JsonPatchError:ct,deepClone:qV,getValueByPointer:Ag,applyOperation:Ds,applyPatch:Sg,applyReducer:WV,validator:Cg,validate:Sk,_areEquals:$f});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var Jb=new WeakMap,YV=function(){function e(t){this.observers=new Map,this.obj=t}return e}(),VV=function(){function e(t,n){this.callback=t,this.observer=n}return e}();function XV(e){return Jb.get(e)}function KV(e,t){return e.observers.get(t)}function ZV(e,t){e.observers.delete(t.callback)}function JV(e,t){t.unobserve()}function QV(e,t){var n=[],r,i=XV(e);if(!i)i=new YV(e),Jb.set(e,i);else{var o=KV(i,t);r=o&&o.observer}if(r)return r;if(r={},i.value=gr(e),t){r.callback=t,r.next=null;var a=function(){Qb(r)},s=function(){clearTimeout(r.next),r.next=setTimeout(a)};typeof window!="undefined"&&(window.addEventListener("mouseup",s),window.addEventListener("keyup",s),window.addEventListener("mousedown",s),window.addEventListener("keydown",s),window.addEventListener("change",s))}return r.patches=n,r.object=e,r.unobserve=function(){Qb(r),clearTimeout(r.next),ZV(i,r),typeof window!="undefined"&&(window.removeEventListener("mouseup",s),window.removeEventListener("keyup",s),window.removeEventListener("mousedown",s),window.removeEventListener("keydown",s),window.removeEventListener("change",s))},i.observers.set(t,new VV(t,r)),r}function Qb(e,t){t===void 0&&(t=!1);var n=Jb.get(e.object);ex(n.value,e.object,e.patches,"",t),e.patches.length&&Sg(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function ex(e,t,n,r,i){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var o=Xb(t),a=Xb(e),s=!1,u=a.length-1;u>=0;u--){var l=a[u],c=e[l];if(Vb(t,l)&&!(t[l]===void 0&&c!==void 0&&Array.isArray(t)===!1)){var f=t[l];typeof c=="object"&&c!=null&&typeof f=="object"&&f!=null&&Array.isArray(c)===Array.isArray(f)?ex(c,f,n,r+"/"+Ms(l),i):c!==f&&(i&&n.push({op:"test",path:r+"/"+Ms(l),value:gr(c)}),n.push({op:"replace",path:r+"/"+Ms(l),value:gr(f)}))}else Array.isArray(e)===Array.isArray(t)?(i&&n.push({op:"test",path:r+"/"+Ms(l),value:gr(c)}),n.push({op:"remove",path:r+"/"+Ms(l)}),s=!0):(i&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}))}if(!(!s&&o.length==a.length))for(var u=0;u<o.length;u++){var l=o[u];!Vb(e,l)&&t[l]!==void 0&&n.push({op:"add",path:r+"/"+Ms(l),value:gr(t[l])})}}}function eX(e,t,n){n===void 0&&(n=!1);var r=[];return ex(e,t,r,"",n),r}var tX=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",unobserve:JV,observe:QV,generate:Qb,compare:eX});Object.assign({},GV,tX,{JsonPatchError:Ak,deepClone:gr,escapePathComponent:Ms,unescapePathComponent:Ek});var nX=/("(?:[^\\"]|\\.)*")|[:,]/g,tx=function(t,n){var r,i,o;return n=n||{},r=JSON.stringify([1],void 0,n.indent===void 0?2:n.indent).slice(2,-3),i=r===""?1/0:n.maxLength===void 0?80:n.maxLength,o=n.replacer,function a(s,u,l){var c,f,d,h,g,p,m,y,v,b,x,w;if(s&&typeof s.toJSON=="function"&&(s=s.toJSON()),x=JSON.stringify(s,o),x===void 0)return x;if(m=i-u.length-l,x.length<=m&&(v=x.replace(nX,function(E,_){return _||E+" "}),v.length<=m))return v;if(o!=null&&(s=JSON.parse(x),o=void 0),typeof s=="object"&&s!==null){if(y=u+r,d=[],f=0,Array.isArray(s))for(b="[",c="]",m=s.length;f<m;f++)d.push(a(s[f],y,f===m-1?0:1)||"null");else for(b="{",c="}",p=Object.keys(s),m=p.length;f<m;f++)h=p[f],g=JSON.stringify(h)+": ",w=a(s[h],y,g.length+(f===m-1?0:1)),w!==void 0&&d.push(g+w);if(d.length>0)return[b,r+d.join(`,
`+y),c].join(`
`+u)}return x}(t,"",0)},va={exports:{}};const rX="2.0.0",iX=256,oX=Number.MAX_SAFE_INTEGER||9007199254740991,aX=16;var Og={SEMVER_SPEC_VERSION:rX,MAX_LENGTH:iX,MAX_SAFE_INTEGER:oX,MAX_SAFE_COMPONENT_LENGTH:aX};const sX=typeof process=="object"&&process.env&&{}.NODE_DEBUG&&/\bsemver\b/i.test({}.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};var Fg=sX;(function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n}=Og,r=Fg;t=e.exports={};const i=t.re=[],o=t.src=[],a=t.t={};let s=0;const u=(l,c,f)=>{const d=s++;r(d,c),a[l]=d,o[d]=c,i[d]=new RegExp(c,f?"g":void 0)};u("NUMERICIDENTIFIER","0|[1-9]\\d*"),u("NUMERICIDENTIFIERLOOSE","[0-9]+"),u("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),u("MAINVERSION",`(${o[a.NUMERICIDENTIFIER]})\\.(${o[a.NUMERICIDENTIFIER]})\\.(${o[a.NUMERICIDENTIFIER]})`),u("MAINVERSIONLOOSE",`(${o[a.NUMERICIDENTIFIERLOOSE]})\\.(${o[a.NUMERICIDENTIFIERLOOSE]})\\.(${o[a.NUMERICIDENTIFIERLOOSE]})`),u("PRERELEASEIDENTIFIER",`(?:${o[a.NUMERICIDENTIFIER]}|${o[a.NONNUMERICIDENTIFIER]})`),u("PRERELEASEIDENTIFIERLOOSE",`(?:${o[a.NUMERICIDENTIFIERLOOSE]}|${o[a.NONNUMERICIDENTIFIER]})`),u("PRERELEASE",`(?:-(${o[a.PRERELEASEIDENTIFIER]}(?:\\.${o[a.PRERELEASEIDENTIFIER]})*))`),u("PRERELEASELOOSE",`(?:-?(${o[a.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${o[a.PRERELEASEIDENTIFIERLOOSE]})*))`),u("BUILDIDENTIFIER","[0-9A-Za-z-]+"),u("BUILD",`(?:\\+(${o[a.BUILDIDENTIFIER]}(?:\\.${o[a.BUILDIDENTIFIER]})*))`),u("FULLPLAIN",`v?${o[a.MAINVERSION]}${o[a.PRERELEASE]}?${o[a.BUILD]}?`),u("FULL",`^${o[a.FULLPLAIN]}$`),u("LOOSEPLAIN",`[v=\\s]*${o[a.MAINVERSIONLOOSE]}${o[a.PRERELEASELOOSE]}?${o[a.BUILD]}?`),u("LOOSE",`^${o[a.LOOSEPLAIN]}$`),u("GTLT","((?:<|>)?=?)"),u("XRANGEIDENTIFIERLOOSE",`${o[a.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),u("XRANGEIDENTIFIER",`${o[a.NUMERICIDENTIFIER]}|x|X|\\*`),u("XRANGEPLAIN",`[v=\\s]*(${o[a.XRANGEIDENTIFIER]})(?:\\.(${o[a.XRANGEIDENTIFIER]})(?:\\.(${o[a.XRANGEIDENTIFIER]})(?:${o[a.PRERELEASE]})?${o[a.BUILD]}?)?)?`),u("XRANGEPLAINLOOSE",`[v=\\s]*(${o[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[a.XRANGEIDENTIFIERLOOSE]})(?:${o[a.PRERELEASELOOSE]})?${o[a.BUILD]}?)?)?`),u("XRANGE",`^${o[a.GTLT]}\\s*${o[a.XRANGEPLAIN]}$`),u("XRANGELOOSE",`^${o[a.GTLT]}\\s*${o[a.XRANGEPLAINLOOSE]}$`),u("COERCE",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?(?:$|[^\\d])`),u("COERCERTL",o[a.COERCE],!0),u("LONETILDE","(?:~>?)"),u("TILDETRIM",`(\\s*)${o[a.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",u("TILDE",`^${o[a.LONETILDE]}${o[a.XRANGEPLAIN]}$`),u("TILDELOOSE",`^${o[a.LONETILDE]}${o[a.XRANGEPLAINLOOSE]}$`),u("LONECARET","(?:\\^)"),u("CARETTRIM",`(\\s*)${o[a.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",u("CARET",`^${o[a.LONECARET]}${o[a.XRANGEPLAIN]}$`),u("CARETLOOSE",`^${o[a.LONECARET]}${o[a.XRANGEPLAINLOOSE]}$`),u("COMPARATORLOOSE",`^${o[a.GTLT]}\\s*(${o[a.LOOSEPLAIN]})$|^$`),u("COMPARATOR",`^${o[a.GTLT]}\\s*(${o[a.FULLPLAIN]})$|^$`),u("COMPARATORTRIM",`(\\s*)${o[a.GTLT]}\\s*(${o[a.LOOSEPLAIN]}|${o[a.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",u("HYPHENRANGE",`^\\s*(${o[a.XRANGEPLAIN]})\\s+-\\s+(${o[a.XRANGEPLAIN]})\\s*$`),u("HYPHENRANGELOOSE",`^\\s*(${o[a.XRANGEPLAINLOOSE]})\\s+-\\s+(${o[a.XRANGEPLAINLOOSE]})\\s*$`),u("STAR","(<|>)?=?\\s*\\*"),u("GTE0","^\\s*>=\\s*0.0.0\\s*$"),u("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")})(va,va.exports);const uX=["includePrerelease","loose","rtl"],lX=e=>e?typeof e!="object"?{loose:!0}:uX.filter(t=>e[t]).reduce((t,n)=>(t[n]=!0,t),{}):{};var kg=lX;const Ck=/^[0-9]+$/,Ok=(e,t)=>{const n=Ck.test(e),r=Ck.test(t);return n&&r&&(e=+e,t=+t),e===t?0:n&&!r?-1:r&&!n?1:e<t?-1:1},cX=(e,t)=>Ok(t,e);var nx={compareIdentifiers:Ok,rcompareIdentifiers:cX};const Mg=Fg,{MAX_LENGTH:Fk,MAX_SAFE_INTEGER:Dg}=Og,{re:kk,t:Mk}=va.exports,fX=kg,{compareIdentifiers:Af}=nx;class ti{constructor(t,n){if(n=fX(n),t instanceof ti){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid Version: ${t}`);if(t.length>Fk)throw new TypeError(`version is longer than ${Fk} characters`);Mg("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;const r=t.trim().match(n.loose?kk[Mk.LOOSE]:kk[Mk.FULL]);if(!r)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>Dg||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Dg||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Dg||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){const o=+i;if(o>=0&&o<Dg)return o}return i}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(Mg("SemVer.compare",this.version,this.options,t),!(t instanceof ti)){if(typeof t=="string"&&t===this.version)return 0;t=new ti(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof ti||(t=new ti(t,this.options)),Af(this.major,t.major)||Af(this.minor,t.minor)||Af(this.patch,t.patch)}comparePre(t){if(t instanceof ti||(t=new ti(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let n=0;do{const r=this.prerelease[n],i=t.prerelease[n];if(Mg("prerelease compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return Af(r,i)}while(++n)}compareBuild(t){t instanceof ti||(t=new ti(t,this.options));let n=0;do{const r=this.build[n],i=t.build[n];if(Mg("prerelease compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return Af(r,i)}while(++n)}inc(t,n){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n),this.inc("pre",n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",n),this.inc("pre",n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{let r=this.prerelease.length;for(;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}n&&(this.prerelease[0]===n?isNaN(this.prerelease[1])&&(this.prerelease=[n,0]):this.prerelease=[n,0]);break;default:throw new Error(`invalid increment argument: ${t}`)}return this.format(),this.raw=this.version,this}}var wn=ti;const{MAX_LENGTH:dX}=Og,{re:Dk,t:Nk}=va.exports,Tk=wn,hX=kg,gX=(e,t)=>{if(t=hX(t),e instanceof Tk)return e;if(typeof e!="string"||e.length>dX||!(t.loose?Dk[Nk.LOOSE]:Dk[Nk.FULL]).test(e))return null;try{return new Tk(e,t)}catch(r){return null}};var ml=gX;const pX=ml,mX=(e,t)=>{const n=pX(e,t);return n?n.version:null};var yX=mX;const vX=ml,bX=(e,t)=>{const n=vX(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null};var xX=bX;const wX=wn,_X=(e,t,n,r)=>{typeof n=="string"&&(r=n,n=void 0);try{return new wX(e,n).inc(t,r).version}catch(i){return null}};var EX=_X;const Rk=wn,$X=(e,t,n)=>new Rk(e,n).compare(new Rk(t,n));var ni=$X;const AX=ni,SX=(e,t,n)=>AX(e,t,n)===0;var rx=SX;const Pk=ml,CX=rx,OX=(e,t)=>{if(CX(e,t))return null;{const n=Pk(e),r=Pk(t),i=n.prerelease.length||r.prerelease.length,o=i?"pre":"",a=i?"prerelease":"";for(const s in n)if((s==="major"||s==="minor"||s==="patch")&&n[s]!==r[s])return o+s;return a}};var FX=OX;const kX=wn,MX=(e,t)=>new kX(e,t).major;var DX=MX;const NX=wn,TX=(e,t)=>new NX(e,t).minor;var RX=TX;const PX=wn,LX=(e,t)=>new PX(e,t).patch;var jX=LX;const IX=ml,BX=(e,t)=>{const n=IX(e,t);return n&&n.prerelease.length?n.prerelease:null};var zX=BX;const UX=ni,qX=(e,t,n)=>UX(t,e,n);var HX=qX;const WX=ni,GX=(e,t)=>WX(e,t,!0);var YX=GX;const Lk=wn,VX=(e,t,n)=>{const r=new Lk(e,n),i=new Lk(t,n);return r.compare(i)||r.compareBuild(i)};var ix=VX;const XX=ix,KX=(e,t)=>e.sort((n,r)=>XX(n,r,t));var ZX=KX;const JX=ix,QX=(e,t)=>e.sort((n,r)=>JX(r,n,t));var eK=QX;const tK=ni,nK=(e,t,n)=>tK(e,t,n)>0;var Ng=nK;const rK=ni,iK=(e,t,n)=>rK(e,t,n)<0;var ox=iK;const oK=ni,aK=(e,t,n)=>oK(e,t,n)!==0;var jk=aK;const sK=ni,uK=(e,t,n)=>sK(e,t,n)>=0;var ax=uK;const lK=ni,cK=(e,t,n)=>lK(e,t,n)<=0;var sx=cK;const fK=rx,dK=jk,hK=Ng,gK=ax,pK=ox,mK=sx,yK=(e,t,n,r)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e===n;case"!==":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e!==n;case"":case"=":case"==":return fK(e,n,r);case"!=":return dK(e,n,r);case">":return hK(e,n,r);case">=":return gK(e,n,r);case"<":return pK(e,n,r);case"<=":return mK(e,n,r);default:throw new TypeError(`Invalid operator: ${t}`)}};var Ik=yK;const vK=wn,bK=ml,{re:Tg,t:Rg}=va.exports,xK=(e,t)=>{if(e instanceof vK)return e;if(typeof e=="number"&&(e=String(e)),typeof e!="string")return null;t=t||{};let n=null;if(!t.rtl)n=e.match(Tg[Rg.COERCE]);else{let r;for(;(r=Tg[Rg.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length);)(!n||r.index+r[0].length!==n.index+n[0].length)&&(n=r),Tg[Rg.COERCERTL].lastIndex=r.index+r[1].length+r[2].length;Tg[Rg.COERCERTL].lastIndex=-1}return n===null?null:bK(`${n[2]}.${n[3]||"0"}.${n[4]||"0"}`,t)};var wK=xK,_K=function(e){e.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}},EK=Ne;Ne.Node=Ns;Ne.create=Ne;function Ne(e){var t=this;if(t instanceof Ne||(t=new Ne),t.tail=null,t.head=null,t.length=0,e&&typeof e.forEach=="function")e.forEach(function(i){t.push(i)});else if(arguments.length>0)for(var n=0,r=arguments.length;n<r;n++)t.push(arguments[n]);return t}Ne.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t};Ne.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}};Ne.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}};Ne.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)AK(this,arguments[e]);return this.length};Ne.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)SK(this,arguments[e]);return this.length};Ne.prototype.pop=function(){if(!!this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}};Ne.prototype.shift=function(){if(!!this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}};Ne.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,r=0;n!==null;r++)e.call(t,n.value,r,this),n=n.next};Ne.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,r=this.length-1;n!==null;r--)e.call(t,n.value,r,this),n=n.prev};Ne.prototype.get=function(e){for(var t=0,n=this.head;n!==null&&t<e;t++)n=n.next;if(t===e&&n!==null)return n.value};Ne.prototype.getReverse=function(e){for(var t=0,n=this.tail;n!==null&&t<e;t++)n=n.prev;if(t===e&&n!==null)return n.value};Ne.prototype.map=function(e,t){t=t||this;for(var n=new Ne,r=this.head;r!==null;)n.push(e.call(t,r.value,this)),r=r.next;return n};Ne.prototype.mapReverse=function(e,t){t=t||this;for(var n=new Ne,r=this.tail;r!==null;)n.push(e.call(t,r.value,this)),r=r.prev;return n};Ne.prototype.reduce=function(e,t){var n,r=this.head;if(arguments.length>1)n=t;else if(this.head)r=this.head.next,n=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=0;r!==null;i++)n=e(n,r.value,i),r=r.next;return n};Ne.prototype.reduceReverse=function(e,t){var n,r=this.tail;if(arguments.length>1)n=t;else if(this.tail)r=this.tail.prev,n=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;r!==null;i--)n=e(n,r.value,i),r=r.prev;return n};Ne.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;n!==null;t++)e[t]=n.value,n=n.next;return e};Ne.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;n!==null;t++)e[t]=n.value,n=n.prev;return e};Ne.prototype.slice=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new Ne;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=0,i=this.head;i!==null&&r<e;r++)i=i.next;for(;i!==null&&r<t;r++,i=i.next)n.push(i.value);return n};Ne.prototype.sliceReverse=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new Ne;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=this.length,i=this.tail;i!==null&&r>t;r--)i=i.prev;for(;i!==null&&r>e;r--,i=i.prev)n.push(i.value);return n};Ne.prototype.splice=function(e,t,...n){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var r=0,i=this.head;i!==null&&r<e;r++)i=i.next;for(var o=[],r=0;i&&r<t;r++)o.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var r=0;r<n.length;r++)i=$K(this,i,n[r]);return o};Ne.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;n!==null;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=t,this.tail=e,this};function $K(e,t,n){var r=t===e.head?new Ns(n,null,t,e):new Ns(n,t,t.next,e);return r.next===null&&(e.tail=r),r.prev===null&&(e.head=r),e.length++,r}function AK(e,t){e.tail=new Ns(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function SK(e,t){e.head=new Ns(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function Ns(e,t,n,r){if(!(this instanceof Ns))return new Ns(e,t,n,r);this.list=r,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}try{_K(Ne)}catch(e){}const CK=EK,Ts=Symbol("max"),No=Symbol("length"),yl=Symbol("lengthCalculator"),Sf=Symbol("allowStale"),Rs=Symbol("maxAge"),To=Symbol("dispose"),Bk=Symbol("noDisposeOnSet"),Tt=Symbol("lruList"),ri=Symbol("cache"),zk=Symbol("updateAgeOnGet"),ux=()=>1;class OK{constructor(t){if(typeof t=="number"&&(t={max:t}),t||(t={}),t.max&&(typeof t.max!="number"||t.max<0))throw new TypeError("max must be a non-negative number");this[Ts]=t.max||1/0;const n=t.length||ux;if(this[yl]=typeof n!="function"?ux:n,this[Sf]=t.stale||!1,t.maxAge&&typeof t.maxAge!="number")throw new TypeError("maxAge must be a number");this[Rs]=t.maxAge||0,this[To]=t.dispose,this[Bk]=t.noDisposeOnSet||!1,this[zk]=t.updateAgeOnGet||!1,this.reset()}set max(t){if(typeof t!="number"||t<0)throw new TypeError("max must be a non-negative number");this[Ts]=t||1/0,Cf(this)}get max(){return this[Ts]}set allowStale(t){this[Sf]=!!t}get allowStale(){return this[Sf]}set maxAge(t){if(typeof t!="number")throw new TypeError("maxAge must be a non-negative number");this[Rs]=t,Cf(this)}get maxAge(){return this[Rs]}set lengthCalculator(t){typeof t!="function"&&(t=ux),t!==this[yl]&&(this[yl]=t,this[No]=0,this[Tt].forEach(n=>{n.length=this[yl](n.value,n.key),this[No]+=n.length})),Cf(this)}get lengthCalculator(){return this[yl]}get length(){return this[No]}get itemCount(){return this[Tt].length}rforEach(t,n){n=n||this;for(let r=this[Tt].tail;r!==null;){const i=r.prev;Uk(this,t,r,n),r=i}}forEach(t,n){n=n||this;for(let r=this[Tt].head;r!==null;){const i=r.next;Uk(this,t,r,n),r=i}}keys(){return this[Tt].toArray().map(t=>t.key)}values(){return this[Tt].toArray().map(t=>t.value)}reset(){this[To]&&this[Tt]&&this[Tt].length&&this[Tt].forEach(t=>this[To](t.key,t.value)),this[ri]=new Map,this[Tt]=new CK,this[No]=0}dump(){return this[Tt].map(t=>Pg(this,t)?!1:{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[Tt]}set(t,n,r){if(r=r||this[Rs],r&&typeof r!="number")throw new TypeError("maxAge must be a number");const i=r?Date.now():0,o=this[yl](n,t);if(this[ri].has(t)){if(o>this[Ts])return vl(this,this[ri].get(t)),!1;const u=this[ri].get(t).value;return this[To]&&(this[Bk]||this[To](t,u.value)),u.now=i,u.maxAge=r,u.value=n,this[No]+=o-u.length,u.length=o,this.get(t),Cf(this),!0}const a=new FK(t,n,o,i,r);return a.length>this[Ts]?(this[To]&&this[To](t,n),!1):(this[No]+=a.length,this[Tt].unshift(a),this[ri].set(t,this[Tt].head),Cf(this),!0)}has(t){if(!this[ri].has(t))return!1;const n=this[ri].get(t).value;return!Pg(this,n)}get(t){return lx(this,t,!0)}peek(t){return lx(this,t,!1)}pop(){const t=this[Tt].tail;return t?(vl(this,t),t.value):null}del(t){vl(this,this[ri].get(t))}load(t){this.reset();const n=Date.now();for(let r=t.length-1;r>=0;r--){const i=t[r],o=i.e||0;if(o===0)this.set(i.k,i.v);else{const a=o-n;a>0&&this.set(i.k,i.v,a)}}}prune(){this[ri].forEach((t,n)=>lx(this,n,!1))}}const lx=(e,t,n)=>{const r=e[ri].get(t);if(r){const i=r.value;if(Pg(e,i)){if(vl(e,r),!e[Sf])return}else n&&(e[zk]&&(r.value.now=Date.now()),e[Tt].unshiftNode(r));return i.value}},Pg=(e,t)=>{if(!t||!t.maxAge&&!e[Rs])return!1;const n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[Rs]&&n>e[Rs]},Cf=e=>{if(e[No]>e[Ts])for(let t=e[Tt].tail;e[No]>e[Ts]&&t!==null;){const n=t.prev;vl(e,t),t=n}},vl=(e,t)=>{if(t){const n=t.value;e[To]&&e[To](n.key,n.value),e[No]-=n.length,e[ri].delete(n.key),e[Tt].removeNode(t)}};class FK{constructor(t,n,r,i,o){this.key=t,this.value=n,this.length=r,this.now=i,this.maxAge=o||0}}const Uk=(e,t,n,r)=>{let i=n.value;Pg(e,i)&&(vl(e,n),e[Sf]||(i=void 0)),i&&t.call(r,i.value,i.key,e)};var kK=OK;class Of{constructor(t,n){if(n=DK(n),t instanceof Of)return t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease?t:new Of(t.raw,n);if(t instanceof cx)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease,this.raw=t,this.set=t.split(/\s*\|\|\s*/).map(r=>this.parseRange(r.trim())).filter(r=>r.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${t}`);if(this.set.length>1){const r=this.set[0];if(this.set=this.set.filter(i=>!Hk(i[0])),this.set.length===0)this.set=[r];else if(this.set.length>1){for(const i of this.set)if(i.length===1&&LK(i[0])){this.set=[i];break}}}this.format()}format(){return this.range=this.set.map(t=>t.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(t){t=t.trim();const r=`parseRange:${Object.keys(this.options).join(",")}:${t}`,i=qk.get(r);if(i)return i;const o=this.options.loose,a=o?en[Gt.HYPHENRANGELOOSE]:en[Gt.HYPHENRANGE];t=t.replace(a,YK(this.options.includePrerelease)),yt("hyphen replace",t),t=t.replace(en[Gt.COMPARATORTRIM],TK),yt("comparator trim",t,en[Gt.COMPARATORTRIM]),t=t.replace(en[Gt.TILDETRIM],RK),t=t.replace(en[Gt.CARETTRIM],PK),t=t.split(/\s+/).join(" ");const s=o?en[Gt.COMPARATORLOOSE]:en[Gt.COMPARATOR],u=t.split(" ").map(f=>jK(f,this.options)).join(" ").split(/\s+/).map(f=>GK(f,this.options)).filter(this.options.loose?f=>!!f.match(s):()=>!0).map(f=>new cx(f,this.options));u.length;const l=new Map;for(const f of u){if(Hk(f))return[f];l.set(f.value,f)}l.size>1&&l.has("")&&l.delete("");const c=[...l.values()];return qk.set(r,c),c}intersects(t,n){if(!(t instanceof Of))throw new TypeError("a Range is required");return this.set.some(r=>Wk(r,n)&&t.set.some(i=>Wk(i,n)&&r.every(o=>i.every(a=>o.intersects(a,n)))))}test(t){if(!t)return!1;if(typeof t=="string")try{t=new NK(t,this.options)}catch(n){return!1}for(let n=0;n<this.set.length;n++)if(VK(this.set[n],t,this.options))return!0;return!1}}var ii=Of;const MK=kK,qk=new MK({max:1e3}),DK=kg,cx=jg,yt=Fg,NK=wn,{re:en,t:Gt,comparatorTrimReplace:TK,tildeTrimReplace:RK,caretTrimReplace:PK}=va.exports,Hk=e=>e.value==="<0.0.0-0",LK=e=>e.value==="",Wk=(e,t)=>{let n=!0;const r=e.slice();let i=r.pop();for(;n&&r.length;)n=r.every(o=>i.intersects(o,t)),i=r.pop();return n},jK=(e,t)=>(yt("comp",e,t),e=zK(e,t),yt("caret",e),e=IK(e,t),yt("tildes",e),e=qK(e,t),yt("xrange",e),e=WK(e,t),yt("stars",e),e),_n=e=>!e||e.toLowerCase()==="x"||e==="*",IK=(e,t)=>e.trim().split(/\s+/).map(n=>BK(n,t)).join(" "),BK=(e,t)=>{const n=t.loose?en[Gt.TILDELOOSE]:en[Gt.TILDE];return e.replace(n,(r,i,o,a,s)=>{yt("tilde",e,r,i,o,a,s);let u;return _n(i)?u="":_n(o)?u=`>=${i}.0.0 <${+i+1}.0.0-0`:_n(a)?u=`>=${i}.${o}.0 <${i}.${+o+1}.0-0`:s?(yt("replaceTilde pr",s),u=`>=${i}.${o}.${a}-${s} <${i}.${+o+1}.0-0`):u=`>=${i}.${o}.${a} <${i}.${+o+1}.0-0`,yt("tilde return",u),u})},zK=(e,t)=>e.trim().split(/\s+/).map(n=>UK(n,t)).join(" "),UK=(e,t)=>{yt("caret",e,t);const n=t.loose?en[Gt.CARETLOOSE]:en[Gt.CARET],r=t.includePrerelease?"-0":"";return e.replace(n,(i,o,a,s,u)=>{yt("caret",e,i,o,a,s,u);let l;return _n(o)?l="":_n(a)?l=`>=${o}.0.0${r} <${+o+1}.0.0-0`:_n(s)?o==="0"?l=`>=${o}.${a}.0${r} <${o}.${+a+1}.0-0`:l=`>=${o}.${a}.0${r} <${+o+1}.0.0-0`:u?(yt("replaceCaret pr",u),o==="0"?a==="0"?l=`>=${o}.${a}.${s}-${u} <${o}.${a}.${+s+1}-0`:l=`>=${o}.${a}.${s}-${u} <${o}.${+a+1}.0-0`:l=`>=${o}.${a}.${s}-${u} <${+o+1}.0.0-0`):(yt("no pr"),o==="0"?a==="0"?l=`>=${o}.${a}.${s}${r} <${o}.${a}.${+s+1}-0`:l=`>=${o}.${a}.${s}${r} <${o}.${+a+1}.0-0`:l=`>=${o}.${a}.${s} <${+o+1}.0.0-0`),yt("caret return",l),l})},qK=(e,t)=>(yt("replaceXRanges",e,t),e.split(/\s+/).map(n=>HK(n,t)).join(" ")),HK=(e,t)=>{e=e.trim();const n=t.loose?en[Gt.XRANGELOOSE]:en[Gt.XRANGE];return e.replace(n,(r,i,o,a,s,u)=>{yt("xRange",e,r,i,o,a,s,u);const l=_n(o),c=l||_n(a),f=c||_n(s),d=f;return i==="="&&d&&(i=""),u=t.includePrerelease?"-0":"",l?i===">"||i==="<"?r="<0.0.0-0":r="*":i&&d?(c&&(a=0),s=0,i===">"?(i=">=",c?(o=+o+1,a=0,s=0):(a=+a+1,s=0)):i==="<="&&(i="<",c?o=+o+1:a=+a+1),i==="<"&&(u="-0"),r=`${i+o}.${a}.${s}${u}`):c?r=`>=${o}.0.0${u} <${+o+1}.0.0-0`:f&&(r=`>=${o}.${a}.0${u} <${o}.${+a+1}.0-0`),yt("xRange return",r),r})},WK=(e,t)=>(yt("replaceStars",e,t),e.trim().replace(en[Gt.STAR],"")),GK=(e,t)=>(yt("replaceGTE0",e,t),e.trim().replace(en[t.includePrerelease?Gt.GTE0PRE:Gt.GTE0],"")),YK=e=>(t,n,r,i,o,a,s,u,l,c,f,d,h)=>(_n(r)?n="":_n(i)?n=`>=${r}.0.0${e?"-0":""}`:_n(o)?n=`>=${r}.${i}.0${e?"-0":""}`:a?n=`>=${n}`:n=`>=${n}${e?"-0":""}`,_n(l)?u="":_n(c)?u=`<${+l+1}.0.0-0`:_n(f)?u=`<${l}.${+c+1}.0-0`:d?u=`<=${l}.${c}.${f}-${d}`:e?u=`<${l}.${c}.${+f+1}-0`:u=`<=${u}`,`${n} ${u}`.trim()),VK=(e,t,n)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(let r=0;r<e.length;r++)if(yt(e[r].semver),e[r].semver!==cx.ANY&&e[r].semver.prerelease.length>0){const i=e[r].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0},Ff=Symbol("SemVer ANY");class Lg{static get ANY(){return Ff}constructor(t,n){if(n=XK(n),t instanceof Lg){if(t.loose===!!n.loose)return t;t=t.value}dx("comparator",t,n),this.options=n,this.loose=!!n.loose,this.parse(t),this.semver===Ff?this.value="":this.value=this.operator+this.semver.version,dx("comp",this)}parse(t){const n=this.options.loose?Gk[Yk.COMPARATORLOOSE]:Gk[Yk.COMPARATOR],r=t.match(n);if(!r)throw new TypeError(`Invalid comparator: ${t}`);this.operator=r[1]!==void 0?r[1]:"",this.operator==="="&&(this.operator=""),r[2]?this.semver=new Vk(r[2],this.options.loose):this.semver=Ff}toString(){return this.value}test(t){if(dx("Comparator.test",t,this.options.loose),this.semver===Ff||t===Ff)return!0;if(typeof t=="string")try{t=new Vk(t,this.options)}catch(n){return!1}return fx(t,this.operator,this.semver,this.options)}intersects(t,n){if(!(t instanceof Lg))throw new TypeError("a Comparator is required");if((!n||typeof n!="object")&&(n={loose:!!n,includePrerelease:!1}),this.operator==="")return this.value===""?!0:new Xk(t.value,n).test(this.value);if(t.operator==="")return t.value===""?!0:new Xk(this.value,n).test(t.semver);const r=(this.operator===">="||this.operator===">")&&(t.operator===">="||t.operator===">"),i=(this.operator==="<="||this.operator==="<")&&(t.operator==="<="||t.operator==="<"),o=this.semver.version===t.semver.version,a=(this.operator===">="||this.operator==="<=")&&(t.operator===">="||t.operator==="<="),s=fx(this.semver,"<",t.semver,n)&&(this.operator===">="||this.operator===">")&&(t.operator==="<="||t.operator==="<"),u=fx(this.semver,">",t.semver,n)&&(this.operator==="<="||this.operator==="<")&&(t.operator===">="||t.operator===">");return r||i||o&&a||s||u}}var jg=Lg;const XK=kg,{re:Gk,t:Yk}=va.exports,fx=Ik,dx=Fg,Vk=wn,Xk=ii,KK=ii,ZK=(e,t,n)=>{try{t=new KK(t,n)}catch(r){return!1}return t.test(e)};var Ig=ZK;const JK=ii,QK=(e,t)=>new JK(e,t).set.map(n=>n.map(r=>r.value).join(" ").trim().split(" "));var eZ=QK;const tZ=wn,nZ=ii,rZ=(e,t,n)=>{let r=null,i=null,o=null;try{o=new nZ(t,n)}catch(a){return null}return e.forEach(a=>{o.test(a)&&(!r||i.compare(a)===-1)&&(r=a,i=new tZ(r,n))}),r};var iZ=rZ;const oZ=wn,aZ=ii,sZ=(e,t,n)=>{let r=null,i=null,o=null;try{o=new aZ(t,n)}catch(a){return null}return e.forEach(a=>{o.test(a)&&(!r||i.compare(a)===1)&&(r=a,i=new oZ(r,n))}),r};var uZ=sZ;const hx=wn,lZ=ii,Kk=Ng,cZ=(e,t)=>{e=new lZ(e,t);let n=new hx("0.0.0");if(e.test(n)||(n=new hx("0.0.0-0"),e.test(n)))return n;n=null;for(let r=0;r<e.set.length;++r){const i=e.set[r];let o=null;i.forEach(a=>{const s=new hx(a.semver.version);switch(a.operator){case">":s.prerelease.length===0?s.patch++:s.prerelease.push(0),s.raw=s.format();case"":case">=":(!o||Kk(s,o))&&(o=s);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${a.operator}`)}}),o&&(!n||Kk(n,o))&&(n=o)}return n&&e.test(n)?n:null};var fZ=cZ;const dZ=ii,hZ=(e,t)=>{try{return new dZ(e,t).range||"*"}catch(n){return null}};var gZ=hZ;const pZ=wn,Zk=jg,{ANY:mZ}=Zk,yZ=ii,vZ=Ig,Jk=Ng,Qk=ox,bZ=sx,xZ=ax,wZ=(e,t,n,r)=>{e=new pZ(e,r),t=new yZ(t,r);let i,o,a,s,u;switch(n){case">":i=Jk,o=bZ,a=Qk,s=">",u=">=";break;case"<":i=Qk,o=xZ,a=Jk,s="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(vZ(e,t,r))return!1;for(let l=0;l<t.set.length;++l){const c=t.set[l];let f=null,d=null;if(c.forEach(h=>{h.semver===mZ&&(h=new Zk(">=0.0.0")),f=f||h,d=d||h,i(h.semver,f.semver,r)?f=h:a(h.semver,d.semver,r)&&(d=h)}),f.operator===s||f.operator===u||(!d.operator||d.operator===s)&&o(e,d.semver))return!1;if(d.operator===u&&a(e,d.semver))return!1}return!0};var gx=wZ;const _Z=gx,EZ=(e,t,n)=>_Z(e,t,">",n);var $Z=EZ;const AZ=gx,SZ=(e,t,n)=>AZ(e,t,"<",n);var CZ=SZ;const eM=ii,OZ=(e,t,n)=>(e=new eM(e,n),t=new eM(t,n),e.intersects(t));var FZ=OZ;const kZ=Ig,MZ=ni;var DZ=(e,t,n)=>{const r=[];let i=null,o=null;const a=e.sort((c,f)=>MZ(c,f,n));for(const c of a)kZ(c,t,n)?(o=c,i||(i=c)):(o&&r.push([i,o]),o=null,i=null);i&&r.push([i,null]);const s=[];for(const[c,f]of r)c===f?s.push(c):!f&&c===a[0]?s.push("*"):f?c===a[0]?s.push(`<=${f}`):s.push(`${c} - ${f}`):s.push(`>=${c}`);const u=s.join(" || "),l=typeof t.raw=="string"?t.raw:String(t);return u.length<l.length?u:t};const tM=ii,Bg=jg,{ANY:px}=Bg,kf=Ig,mx=ni,NZ=(e,t,n={})=>{if(e===t)return!0;e=new tM(e,n),t=new tM(t,n);let r=!1;e:for(const i of e.set){for(const o of t.set){const a=TZ(i,o,n);if(r=r||a!==null,a)continue e}if(r)return!1}return!0},TZ=(e,t,n)=>{if(e===t)return!0;if(e.length===1&&e[0].semver===px){if(t.length===1&&t[0].semver===px)return!0;n.includePrerelease?e=[new Bg(">=0.0.0-0")]:e=[new Bg(">=0.0.0")]}if(t.length===1&&t[0].semver===px){if(n.includePrerelease)return!0;t=[new Bg(">=0.0.0")]}const r=new Set;let i,o;for(const h of e)h.operator===">"||h.operator===">="?i=nM(i,h,n):h.operator==="<"||h.operator==="<="?o=rM(o,h,n):r.add(h.semver);if(r.size>1)return null;let a;if(i&&o){if(a=mx(i.semver,o.semver,n),a>0)return null;if(a===0&&(i.operator!==">="||o.operator!=="<="))return null}for(const h of r){if(i&&!kf(h,String(i),n)||o&&!kf(h,String(o),n))return null;for(const g of t)if(!kf(h,String(g),n))return!1;return!0}let s,u,l,c,f=o&&!n.includePrerelease&&o.semver.prerelease.length?o.semver:!1,d=i&&!n.includePrerelease&&i.semver.prerelease.length?i.semver:!1;f&&f.prerelease.length===1&&o.operator==="<"&&f.prerelease[0]===0&&(f=!1);for(const h of t){if(c=c||h.operator===">"||h.operator===">=",l=l||h.operator==="<"||h.operator==="<=",i){if(d&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===d.major&&h.semver.minor===d.minor&&h.semver.patch===d.patch&&(d=!1),h.operator===">"||h.operator===">="){if(s=nM(i,h,n),s===h&&s!==i)return!1}else if(i.operator===">="&&!kf(i.semver,String(h),n))return!1}if(o){if(f&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===f.major&&h.semver.minor===f.minor&&h.semver.patch===f.patch&&(f=!1),h.operator==="<"||h.operator==="<="){if(u=rM(o,h,n),u===h&&u!==o)return!1}else if(o.operator==="<="&&!kf(o.semver,String(h),n))return!1}if(!h.operator&&(o||i)&&a!==0)return!1}return!(i&&l&&!o&&a!==0||o&&c&&!i&&a!==0||d||f)},nM=(e,t,n)=>{if(!e)return t;const r=mx(e.semver,t.semver,n);return r>0?e:r<0||t.operator===">"&&e.operator===">="?t:e},rM=(e,t,n)=>{if(!e)return t;const r=mx(e.semver,t.semver,n);return r<0?e:r>0||t.operator==="<"&&e.operator==="<="?t:e};var RZ=NZ;const yx=va.exports;var iM={re:yx.re,src:yx.src,tokens:yx.t,SEMVER_SPEC_VERSION:Og.SEMVER_SPEC_VERSION,SemVer:wn,compareIdentifiers:nx.compareIdentifiers,rcompareIdentifiers:nx.rcompareIdentifiers,parse:ml,valid:yX,clean:xX,inc:EX,diff:FX,major:DX,minor:RX,patch:jX,prerelease:zX,compare:ni,rcompare:HX,compareLoose:YX,compareBuild:ix,sort:ZX,rsort:eK,gt:Ng,lt:ox,eq:rx,neq:jk,gte:ax,lte:sx,cmp:Ik,coerce:wK,Comparator:jg,Range:ii,satisfies:Ig,toComparators:eZ,maxSatisfying:iZ,minSatisfying:uZ,minVersion:fZ,validRange:gZ,outside:gx,gtr:$Z,ltr:CZ,intersects:FZ,simplifyRange:DZ,subset:RZ};function qn(e,t,n){return e.fields=t||[],e.fname=n,e}function ft(e){return e==null?null:e.fname}function tn(e){return e==null?null:e.fields}function oM(e){return e.length===1?PZ(e[0]):LZ(e)}const PZ=e=>function(t){return t[e]},LZ=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function B(e){throw Error(e)}function zg(e){const t=[],n=e.length;let r=null,i=0,o="",a,s,u;e=e+"";function l(){t.push(o+e.substring(a,s)),o="",a=s+1}for(a=s=0;s<n;++s)if(u=e[s],u==="\\")o+=e.substring(a,s),o+=e.substring(++s,++s),a=s;else if(u===r)l(),r=null,i=-1;else{if(r)continue;a===i&&u==='"'||a===i&&u==="'"?(a=s+1,r=u):u==="."&&!i?s>a?l():a=s+1:u==="["?(s>a&&l(),i=a=s+1):u==="]"&&(i||B("Access path missing open bracket: "+e),i>0&&l(),i=0,a=s+1)}return i&&B("Access path missing closing bracket: "+e),r&&B("Access path missing closing quote: "+e),s>a&&(s++,l()),t}function Hn(e,t,n){const r=zg(e);return e=r.length===1?r[0]:e,qn((n&&n.get||oM)(r),[e],t||e)}const Mf=Hn("id"),En=qn(e=>e,[],"identity"),ba=qn(()=>0,[],"zero"),bl=qn(()=>1,[],"one"),Dr=qn(()=>!0,[],"true"),xa=qn(()=>!1,[],"false");function jZ(e,t,n){const r=[t].concat([].slice.call(n));console[e].apply(console,r)}const aM=0,vx=1,sM=2,uM=3,lM=4;function cM(e,t,n=jZ){let r=e||aM;return{level(i){return arguments.length?(r=+i,this):r},error(){return r>=vx&&n(t||"error","ERROR",arguments),this},warn(){return r>=sM&&n(t||"warn","WARN",arguments),this},info(){return r>=uM&&n(t||"log","INFO",arguments),this},debug(){return r>=lM&&n(t||"log","DEBUG",arguments),this}}}var ee=Array.isArray;function le(e){return e===Object(e)}const fM=e=>e!=="__proto__";function Ug(...e){return e.reduce((t,n)=>{for(const r in n)if(r==="signals")t.signals=IZ(t.signals,n.signals);else{const i=r==="legend"?{layout:1}:r==="style"?!0:null;Df(t,r,n[r],i)}return t},{})}function Df(e,t,n,r){if(!fM(t))return;let i,o;if(le(n)&&!ee(n)){o=le(e[t])?e[t]:e[t]={};for(i in n)r&&(r===!0||r[i])?Df(o,i,n[i]):fM(i)&&(o[i]=n[i])}else e[t]=n}function IZ(e,t){if(e==null)return t;const n={},r=[];function i(o){n[o.name]||(n[o.name]=1,r.push(o))}return t.forEach(i),e.forEach(i),r}function Se(e){return e[e.length-1]}function nn(e){return e==null||e===""?null:+e}const dM=e=>t=>e*Math.exp(t),hM=e=>t=>Math.log(e*t),gM=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),pM=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,qg=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function Hg(e,t,n,r){const i=n(e[0]),o=n(Se(e)),a=(o-i)*t;return[r(i-a),r(o-a)]}function mM(e,t){return Hg(e,t,nn,En)}function yM(e,t){var n=Math.sign(e[0]);return Hg(e,t,hM(n),dM(n))}function vM(e,t,n){return Hg(e,t,qg(n),qg(1/n))}function bM(e,t,n){return Hg(e,t,gM(n),pM(n))}function Wg(e,t,n,r,i){const o=r(e[0]),a=r(Se(e)),s=t!=null?r(t):(o+a)/2;return[i(s+(o-s)*n),i(s+(a-s)*n)]}function bx(e,t,n){return Wg(e,t,n,nn,En)}function xx(e,t,n){const r=Math.sign(e[0]);return Wg(e,t,n,hM(r),dM(r))}function Gg(e,t,n,r){return Wg(e,t,n,qg(r),qg(1/r))}function wx(e,t,n,r){return Wg(e,t,n,gM(r),pM(r))}function xM(e){return 1+~~(new Date(e).getMonth()/3)}function wM(e){return 1+~~(new Date(e).getUTCMonth()/3)}function ae(e){return e!=null?ee(e)?e:[e]:[]}function _M(e,t,n){let r=e[0],i=e[1],o;return i<r&&(o=i,i=r,r=o),o=i-r,o>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-o),r+o]}function ye(e){return typeof e=="function"}const BZ="descending";function _x(e,t,n){n=n||{},t=ae(t)||[];const r=[],i=[],o={},a=n.comparator||zZ;return ae(e).forEach((s,u)=>{s!=null&&(r.push(t[u]===BZ?-1:1),i.push(s=ye(s)?s:Hn(s,null,n)),(tn(s)||[]).forEach(l=>o[l]=1))}),i.length===0?null:qn(a(i,r),Object.keys(o))}const Yg=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),zZ=(e,t)=>e.length===1?UZ(e[0],t[0]):qZ(e,t,e.length),UZ=(e,t)=>function(n,r){return Yg(e(n),e(r))*t},qZ=(e,t,n)=>(t.push(0),function(r,i){let o,a=0,s=-1;for(;a===0&&++s<n;)o=e[s],a=Yg(o(r),o(i));return a*t[s]});function rn(e){return ye(e)?e:()=>e}function Ex(e,t){let n;return r=>{n&&clearTimeout(n),n=setTimeout(()=>(t(r),n=null),e)}}function pe(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}function ji(e,t){let n=0,r,i,o,a;if(e&&(r=e.length))if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);for(o=a=i;n<r;++n)i=e[n],i!=null&&(i<o&&(o=i),i>a&&(a=i))}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));for(o=a=i;n<r;++n)i=t(e[n]),i!=null&&(i<o&&(o=i),i>a&&(a=i))}return[o,a]}function EM(e,t){const n=e.length;let r=-1,i,o,a,s,u;if(t==null){for(;++r<n;)if(o=e[r],o!=null&&o>=o){i=a=o;break}if(r===n)return[-1,-1];for(s=u=r;++r<n;)o=e[r],o!=null&&(i>o&&(i=o,s=r),a<o&&(a=o,u=r))}else{for(;++r<n;)if(o=t(e[r],r,e),o!=null&&o>=o){i=a=o;break}if(r===n)return[-1,-1];for(s=u=r;++r<n;)o=t(e[r],r,e),o!=null&&(i>o&&(i=o,s=r),a<o&&(a=o,u=r))}return[s,u]}const HZ=Object.prototype.hasOwnProperty;function se(e,t){return HZ.call(e,t)}const Vg={};function xl(e){let t={},n;function r(o){return se(t,o)&&t[o]!==Vg}const i={size:0,empty:0,object:t,has:r,get(o){return r(o)?t[o]:void 0},set(o,a){return r(o)||(++i.size,t[o]===Vg&&--i.empty),t[o]=a,this},delete(o){return r(o)&&(--i.size,++i.empty,t[o]=Vg),this},clear(){i.size=i.empty=0,i.object=t={}},test(o){return arguments.length?(n=o,i):n},clean(){const o={};let a=0;for(const s in t){const u=t[s];u!==Vg&&(!n||!n(u))&&(o[s]=u,++a)}i.size=a,i.empty=0,i.object=t=o}};return e&&Object.keys(e).forEach(o=>{i.set(o,e[o])}),i}function $M(e,t,n,r,i,o){if(!n&&n!==0)return o;const a=+n;let s=e[0],u=Se(e),l;u<s&&(l=s,s=u,u=l),l=Math.abs(t-s);const c=Math.abs(u-t);return l<c&&l<=a?r:c<=a?i:o}function H(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),pe(r,n)}function wl(e,t,n,r){let i=t[0],o=t[t.length-1],a;return i>o&&(a=i,i=o,o=a),n=n===void 0||n,r=r===void 0||r,(n?i<=e:i<e)&&(r?e<=o:e<o)}function $x(e){return typeof e=="boolean"}function wa(e){return Object.prototype.toString.call(e)==="[object Date]"}function AM(e){return e&&ye(e[Symbol.iterator])}function _a(e){return typeof e=="number"}function SM(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function Me(e){return typeof e=="string"}function Ax(e,t,n){e&&(e=t?ae(e).map(s=>s.replace(/\\(.)/g,"$1")):ae(e));const r=e&&e.length,i=n&&n.get||oM,o=s=>i(t?[s]:zg(s));let a;if(!r)a=function(){return""};else if(r===1){const s=o(e[0]);a=function(u){return""+s(u)}}else{const s=e.map(o);a=function(u){let l=""+s[0](u),c=0;for(;++c<r;)l+="|"+s[c](u);return l}}return qn(a,e,"key")}function CM(e,t){const n=e[0],r=Se(e),i=+t;return i?i===1?r:n+i*(r-n):n}const WZ=1e4;function OM(e){e=+e||WZ;let t,n,r;const i=()=>{t={},n={},r=0},o=(a,s)=>(++r>e&&(n=t,t={},r=1),t[a]=s);return i(),{clear:i,has:a=>se(t,a)||se(n,a),get:a=>se(t,a)?t[a]:se(n,a)?o(a,n[a]):void 0,set:(a,s)=>se(t,a)?t[a]=s:o(a,s)}}function FM(e,t,n,r){const i=t.length,o=n.length;if(!o)return t;if(!i)return n;const a=r||new t.constructor(i+o);let s=0,u=0,l=0;for(;s<i&&u<o;++l)a[l]=e(t[s],n[u])>0?n[u++]:t[s++];for(;s<i;++s,++l)a[l]=t[s];for(;u<o;++u,++l)a[l]=n[u];return a}function Nf(e,t){let n="";for(;--t>=0;)n+=e;return n}function kM(e,t,n,r){const i=n||" ",o=e+"",a=t-o.length;return a<=0?o:r==="left"?Nf(i,a)+o:r==="center"?Nf(i,~~(a/2))+o+Nf(i,Math.ceil(a/2)):o+Nf(i,a)}function Tf(e){return e&&Se(e)-e[0]||0}function re(e){return ee(e)?"["+e.map(re)+"]":le(e)||Me(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function Sx(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const GZ=e=>_a(e)||wa(e)?e:Date.parse(e);function Cx(e,t){return t=t||GZ,e==null||e===""?null:t(e)}function Ox(e){return e==null||e===""?null:e+""}function oi(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function MM(e,t,n,r){const i=r!=null?r:"\u2026",o=e+"",a=o.length,s=Math.max(0,t-i.length);return a<=t?o:n==="left"?i+o.slice(a-s):n==="center"?o.slice(0,Math.ceil(s/2))+i+o.slice(a-~~(s/2)):o.slice(0,s)+i}function Ea(e,t,n){if(e)if(t){const r=e.length;for(let i=0;i<r;++i){const o=t(e[i]);o&&n(o,i,e)}}else e.forEach(n)}var DM={},Fx={},kx=34,Rf=10,Mx=13;function NM(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function YZ(e,t){var n=NM(e);return function(r,i){return t(n(r),i,e)}}function TM(e){var t=Object.create(null),n=[];return e.forEach(function(r){for(var i in r)i in t||n.push(t[i]=i)}),n}function Wn(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function VZ(e){return e<0?"-"+Wn(-e,6):e>9999?"+"+Wn(e,6):Wn(e,4)}function XZ(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":VZ(e.getUTCFullYear())+"-"+Wn(e.getUTCMonth()+1,2)+"-"+Wn(e.getUTCDate(),2)+(i?"T"+Wn(t,2)+":"+Wn(n,2)+":"+Wn(r,2)+"."+Wn(i,3)+"Z":r?"T"+Wn(t,2)+":"+Wn(n,2)+":"+Wn(r,2)+"Z":n||t?"T"+Wn(t,2)+":"+Wn(n,2)+"Z":"")}function KZ(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function r(f,d){var h,g,p=i(f,function(m,y){if(h)return h(m,y-1);g=m,h=d?YZ(m,d):NM(m)});return p.columns=g||[],p}function i(f,d){var h=[],g=f.length,p=0,m=0,y,v=g<=0,b=!1;f.charCodeAt(g-1)===Rf&&--g,f.charCodeAt(g-1)===Mx&&--g;function x(){if(v)return Fx;if(b)return b=!1,DM;var E,_=p,S;if(f.charCodeAt(_)===kx){for(;p++<g&&f.charCodeAt(p)!==kx||f.charCodeAt(++p)===kx;);return(E=p)>=g?v=!0:(S=f.charCodeAt(p++))===Rf?b=!0:S===Mx&&(b=!0,f.charCodeAt(p)===Rf&&++p),f.slice(_+1,E-1).replace(/""/g,'"')}for(;p<g;){if((S=f.charCodeAt(E=p++))===Rf)b=!0;else if(S===Mx)b=!0,f.charCodeAt(p)===Rf&&++p;else if(S!==n)continue;return f.slice(_,E)}return v=!0,f.slice(_,g)}for(;(y=x())!==Fx;){for(var w=[];y!==DM&&y!==Fx;)w.push(y),y=x();d&&(w=d(w,m++))==null||h.push(w)}return h}function o(f,d){return f.map(function(h){return d.map(function(g){return c(h[g])}).join(e)})}function a(f,d){return d==null&&(d=TM(f)),[d.map(c).join(e)].concat(o(f,d)).join(`
`)}function s(f,d){return d==null&&(d=TM(f)),o(f,d).join(`
`)}function u(f){return f.map(l).join(`
`)}function l(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?XZ(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:r,parseRows:i,format:a,formatBody:s,formatRows:u,formatRow:l,formatValue:c}}function ZZ(e){return e}function JZ(e){if(e==null)return ZZ;var t,n,r=e.scale[0],i=e.scale[1],o=e.translate[0],a=e.translate[1];return function(s,u){u||(t=n=0);var l=2,c=s.length,f=new Array(c);for(f[0]=(t+=s[0])*r+o,f[1]=(n+=s[1])*i+a;l<c;)f[l]=s[l],++l;return f}}function QZ(e,t){for(var n,r=e.length,i=r-t;i<--r;)n=e[i],e[i++]=e[r],e[r]=n}function eJ(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return RM(e,n)})}:RM(e,t)}function RM(e,t){var n=t.id,r=t.bbox,i=t.properties==null?{}:t.properties,o=PM(e,t);return n==null&&r==null?{type:"Feature",properties:i,geometry:o}:r==null?{type:"Feature",id:n,properties:i,geometry:o}:{type:"Feature",id:n,bbox:r,properties:i,geometry:o}}function PM(e,t){var n=JZ(e.transform),r=e.arcs;function i(c,f){f.length&&f.pop();for(var d=r[c<0?~c:c],h=0,g=d.length;h<g;++h)f.push(n(d[h],h));c<0&&QZ(f,g)}function o(c){return n(c)}function a(c){for(var f=[],d=0,h=c.length;d<h;++d)i(c[d],f);return f.length<2&&f.push(f[0]),f}function s(c){for(var f=a(c);f.length<4;)f.push(f[0]);return f}function u(c){return c.map(s)}function l(c){var f=c.type,d;switch(f){case"GeometryCollection":return{type:f,geometries:c.geometries.map(l)};case"Point":d=o(c.coordinates);break;case"MultiPoint":d=c.coordinates.map(o);break;case"LineString":d=a(c.arcs);break;case"MultiLineString":d=c.arcs.map(a);break;case"Polygon":d=u(c.arcs);break;case"MultiPolygon":d=c.arcs.map(u);break;default:return null}return{type:f,coordinates:d}}return l(t)}function tJ(e,t){var n={},r={},i={},o=[],a=-1;t.forEach(function(l,c){var f=e.arcs[l<0?~l:l],d;f.length<3&&!f[1][0]&&!f[1][1]&&(d=t[++a],t[a]=l,t[c]=d)}),t.forEach(function(l){var c=s(l),f=c[0],d=c[1],h,g;if(h=i[f])if(delete i[h.end],h.push(l),h.end=d,g=r[d]){delete r[g.start];var p=g===h?h:h.concat(g);r[p.start=h.start]=i[p.end=g.end]=p}else r[h.start]=i[h.end]=h;else if(h=r[d])if(delete r[h.start],h.unshift(l),h.start=f,g=i[f]){delete i[g.end];var m=g===h?h:g.concat(h);r[m.start=g.start]=i[m.end=h.end]=m}else r[h.start]=i[h.end]=h;else h=[l],r[h.start=f]=i[h.end=d]=h});function s(l){var c=e.arcs[l<0?~l:l],f=c[0],d;return e.transform?(d=[0,0],c.forEach(function(h){d[0]+=h[0],d[1]+=h[1]})):d=c[c.length-1],l<0?[d,f]:[f,d]}function u(l,c){for(var f in l){var d=l[f];delete c[d.start],delete d.start,delete d.end,d.forEach(function(h){n[h<0?~h:h]=1}),o.push(d)}}return u(i,r),u(r,i),t.forEach(function(l){n[l<0?~l:l]||o.push([l])}),o}function nJ(e){return PM(e,rJ.apply(this,arguments))}function rJ(e,t,n){var r,i,o;if(arguments.length>1)r=iJ(e,t,n);else for(i=0,r=new Array(o=e.arcs.length);i<o;++i)r[i]=i;return{type:"MultiLineString",arcs:tJ(e,r)}}function iJ(e,t,n){var r=[],i=[],o;function a(f){var d=f<0?~f:f;(i[d]||(i[d]=[])).push({i:f,g:o})}function s(f){f.forEach(a)}function u(f){f.forEach(s)}function l(f){f.forEach(u)}function c(f){switch(o=f,f.type){case"GeometryCollection":f.geometries.forEach(c);break;case"LineString":s(f.arcs);break;case"MultiLineString":case"Polygon":u(f.arcs);break;case"MultiPolygon":l(f.arcs);break}}return c(t),i.forEach(n==null?function(f){r.push(f[0].i)}:function(f){n(f[0].g,f[f.length-1].g)&&r.push(f[0].i)}),r}var oJ=Math.sqrt(50),aJ=Math.sqrt(10),sJ=Math.sqrt(2);function uJ(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=oJ?i*=10:o>=aJ?i*=5:o>=sJ&&(i*=2),t<e?-i:i}function lJ(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Xg(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function _l(e){return e=Xg(Math.abs(e)),e?e[1]:NaN}function cJ(e,t){return function(n,r){for(var i=n.length,o=[],a=0,s=e[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),o.push(n.substring(i-=s,i+s)),!((u+=s+1)>r));)s=e[a=(a+1)%e.length];return o.reverse().join(t)}}function fJ(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var dJ=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Pf(e){if(!(t=dJ.exec(e)))throw new Error("invalid format: "+e);var t;return new Dx({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Pf.prototype=Dx.prototype;function Dx(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Dx.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function hJ(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var LM;function gJ(e,t){var n=Xg(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(LM=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Xg(e,Math.max(0,t+o-1))[0]}function jM(e,t){var n=Xg(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var IM={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:lJ,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>jM(e*100,t),r:jM,s:gJ,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function BM(e){return e}var zM=Array.prototype.map,UM=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function qM(e){var t=e.grouping===void 0||e.thousands===void 0?BM:cJ(zM.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?BM:fJ(zM.call(e.numerals,String)),a=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"\u2212":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function l(f){f=Pf(f);var d=f.fill,h=f.align,g=f.sign,p=f.symbol,m=f.zero,y=f.width,v=f.comma,b=f.precision,x=f.trim,w=f.type;w==="n"?(v=!0,w="g"):IM[w]||(b===void 0&&(b=12),x=!0,w="g"),(m||d==="0"&&h==="=")&&(m=!0,d="0",h="=");var E=p==="$"?n:p==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",_=p==="$"?r:/[%p]/.test(w)?a:"",S=IM[w],C=/[defgprs%]/.test(w);b=b===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function O($){var M=E,F=_,N,A,k;if(w==="c")F=S($)+F,$="";else{$=+$;var T=$<0||1/$<0;if($=isNaN($)?u:S(Math.abs($),b),x&&($=hJ($)),T&&+$==0&&g!=="+"&&(T=!1),M=(T?g==="("?g:s:g==="-"||g==="("?"":g)+M,F=(w==="s"?UM[8+LM/3]:"")+F+(T&&g==="("?")":""),C){for(N=-1,A=$.length;++N<A;)if(k=$.charCodeAt(N),48>k||k>57){F=(k===46?i+$.slice(N+1):$.slice(N))+F,$=$.slice(0,N);break}}}v&&!m&&($=t($,1/0));var L=M.length+$.length+F.length,z=L<y?new Array(y-L+1).join(d):"";switch(v&&m&&($=t(z+$,z.length?y-F.length:1/0),z=""),h){case"<":$=M+$+F+z;break;case"=":$=M+z+$+F;break;case"^":$=z.slice(0,L=z.length>>1)+M+$+F+z.slice(L);break;default:$=z+M+$+F;break}return o($)}return O.toString=function(){return f+""},O}function c(f,d){var h=l((f=Pf(f),f.type="f",f)),g=Math.max(-8,Math.min(8,Math.floor(_l(d)/3)))*3,p=Math.pow(10,-g),m=UM[8+g/3];return function(y){return h(p*y)+m}}return{format:l,formatPrefix:c}}var Kg,HM,WM;pJ({thousands:",",grouping:[3],currency:["$",""]});function pJ(e){return Kg=qM(e),HM=Kg.format,WM=Kg.formatPrefix,Kg}function mJ(e){return Math.max(0,-_l(Math.abs(e)))}function yJ(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(_l(t)/3)))*3-_l(Math.abs(e)))}function vJ(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,_l(t)-_l(e))+1}var Nx=new Date,Tx=new Date;function Rt(e,t,n,r){function i(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=function(o){return e(o=new Date(+o)),o},i.ceil=function(o){return e(o=new Date(o-1)),t(o,1),e(o),o},i.round=function(o){var a=i(o),s=i.ceil(o);return o-a<s-o?a:s},i.offset=function(o,a){return t(o=new Date(+o),a==null?1:Math.floor(a)),o},i.range=function(o,a,s){var u=[],l;if(o=i.ceil(o),s=s==null?1:Math.floor(s),!(o<a)||!(s>0))return u;do u.push(l=new Date(+o)),t(o,s),e(o);while(l<o&&o<a);return u},i.filter=function(o){return Rt(function(a){if(a>=a)for(;e(a),!o(a);)a.setTime(a-1)},function(a,s){if(a>=a)if(s<0)for(;++s<=0;)for(;t(a,-1),!o(a););else for(;--s>=0;)for(;t(a,1),!o(a););})},n&&(i.count=function(o,a){return Nx.setTime(+o),Tx.setTime(+a),e(Nx),e(Tx),Math.floor(n(Nx,Tx))},i.every=function(o){return o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(r?function(a){return r(a)%o==0}:function(a){return i.count(0,a)%o==0}):i}),i}var Rx=Rt(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});Rx.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Rt(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):Rx};var GM=Rx;const Lf=1e3,$a=Lf*60,jf=$a*60,Px=jf*24,YM=Px*7;var bJ=Rt(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*Lf)},function(e,t){return(t-e)/Lf},function(e){return e.getUTCSeconds()}),VM=bJ,xJ=Rt(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Lf)},function(e,t){e.setTime(+e+t*$a)},function(e,t){return(t-e)/$a},function(e){return e.getMinutes()}),wJ=xJ,_J=Rt(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Lf-e.getMinutes()*$a)},function(e,t){e.setTime(+e+t*jf)},function(e,t){return(t-e)/jf},function(e){return e.getHours()}),EJ=_J,$J=Rt(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*$a)/Px,e=>e.getDate()-1),Zg=$J;function Ps(e){return Rt(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+n*7)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*$a)/YM})}var XM=Ps(0);Ps(1);Ps(2);Ps(3);Ps(4);Ps(5);Ps(6);var AJ=Rt(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()}),KM=AJ,ZM=Rt(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});ZM.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:Rt(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)})};var SJ=ZM,CJ=Rt(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*$a)},function(e,t){return(t-e)/$a},function(e){return e.getUTCMinutes()}),OJ=CJ,FJ=Rt(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*jf)},function(e,t){return(t-e)/jf},function(e){return e.getUTCHours()}),kJ=FJ,MJ=Rt(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/Px},function(e){return e.getUTCDate()-1}),Jg=MJ;function Ls(e){return Rt(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n*7)},function(t,n){return(n-t)/YM})}var JM=Ls(0);Ls(1);Ls(2);Ls(3);Ls(4);Ls(5);Ls(6);var DJ=Rt(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12},function(e){return e.getUTCMonth()}),QM=DJ,eD=Rt(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});eD.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:Rt(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})};var NJ=eD;function TJ(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function RJ(e){let t=e,n=e;e.length===1&&(t=(a,s)=>e(a)-s,n=PJ(e));function r(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)<0?u=c+1:l=c}return u}function i(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)>0?l=c:u=c+1}return u}function o(a,s,u,l){u==null&&(u=0),l==null&&(l=a.length);const c=r(a,s,u,l-1);return c>u&&t(a[c-1],s)>-t(a[c],s)?c-1:c}return{left:r,center:o,right:i}}function PJ(e){return(t,n)=>TJ(e(t),n)}var LJ=Math.sqrt(50),jJ=Math.sqrt(10),IJ=Math.sqrt(2);function tD(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=LJ?i*=10:o>=jJ?i*=5:o>=IJ&&(i*=2),t<e?-i:i}const Yt="year",Gn="quarter",on="month",St="week",Yn="date",an="day",Ii="dayofyear",pr="hours",mr="minutes",Nr="seconds",ai="milliseconds",Lx=[Yt,Gn,on,St,Yn,an,Ii,pr,mr,Nr,ai],jx=Lx.reduce((e,t,n)=>(e[t]=1+n,e),{});function Ix(e){const t=ae(e).slice(),n={};return t.length||B("Missing time unit."),t.forEach(i=>{se(jx,i)?n[i]=1:B("Invalid time unit: ".concat(i,"."))}),(n[St]||n[an]?1:0)+(n[Gn]||n[on]||n[Yn]?1:0)+(n[Ii]?1:0)>1&&B("Incompatible time units: ".concat(e)),t.sort((i,o)=>jx[i]-jx[o]),t}const BJ={[Yt]:"%Y ",[Gn]:"Q%q ",[on]:"%b ",[Yn]:"%d ",[St]:"W%U ",[an]:"%a ",[Ii]:"%j ",[pr]:"%H:00",[mr]:"00:%M",[Nr]:":%S",[ai]:".%L",["".concat(Yt,"-").concat(on)]:"%Y-%m ",["".concat(Yt,"-").concat(on,"-").concat(Yn)]:"%Y-%m-%d ",["".concat(pr,"-").concat(mr)]:"%H:%M"};function nD(e,t){const n=pe({},BJ,t),r=Ix(e),i=r.length;let o="",a=0,s,u;for(a=0;a<i;)for(s=r.length;s>a;--s)if(u=r.slice(a,s).join("-"),n[u]!=null){o+=n[u],a=s;break}return o.trim()}const js=new Date;function Bx(e){return js.setFullYear(e),js.setMonth(0),js.setDate(1),js.setHours(0,0,0,0),js}function rD(e){return oD(new Date(e))}function iD(e){return zx(new Date(e))}function oD(e){return Zg.count(Bx(e.getFullYear())-1,e)}function zx(e){return XM.count(Bx(e.getFullYear())-1,e)}function Ux(e){return Bx(e).getDay()}function zJ(e,t,n,r,i,o,a){if(0<=e&&e<100){const s=new Date(-1,t,n,r,i,o,a);return s.setFullYear(e),s}return new Date(e,t,n,r,i,o,a)}function aD(e){return uD(new Date(e))}function sD(e){return qx(new Date(e))}function uD(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return Jg.count(t-1,e)}function qx(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return JM.count(t-1,e)}function Hx(e){return js.setTime(Date.UTC(e,0,1)),js.getUTCDay()}function UJ(e,t,n,r,i,o,a){if(0<=e&&e<100){const s=new Date(Date.UTC(-1,t,n,r,i,o,a));return s.setUTCFullYear(n.y),s}return new Date(Date.UTC(e,t,n,r,i,o,a))}function lD(e,t,n,r,i){const o=t||1,a=Se(e),s=(y,v,b)=>(b=b||y,qJ(n[b],r[b],y===a&&o,v)),u=new Date,l=oi(e),c=l[Yt]?s(Yt):rn(2012),f=l[on]?s(on):l[Gn]?s(Gn):ba,d=l[St]&&l[an]?s(an,1,St+an):l[St]?s(St,1):l[an]?s(an,1):l[Yn]?s(Yn,1):l[Ii]?s(Ii,1):bl,h=l[pr]?s(pr):ba,g=l[mr]?s(mr):ba,p=l[Nr]?s(Nr):ba,m=l[ai]?s(ai):ba;return function(y){u.setTime(+y);const v=c(u);return i(v,f(u),d(u,v),h(u),g(u),p(u),m(u))}}function qJ(e,t,n,r){const i=n<=1?e:r?(o,a)=>r+n*Math.floor((e(o,a)-r)/n):(o,a)=>n*Math.floor(e(o,a)/n);return t?(o,a)=>t(i(o,a),a):i}function El(e,t,n){return t+e*7-(n+6)%7}const HJ={[Yt]:e=>e.getFullYear(),[Gn]:e=>Math.floor(e.getMonth()/3),[on]:e=>e.getMonth(),[Yn]:e=>e.getDate(),[pr]:e=>e.getHours(),[mr]:e=>e.getMinutes(),[Nr]:e=>e.getSeconds(),[ai]:e=>e.getMilliseconds(),[Ii]:e=>oD(e),[St]:e=>zx(e),[St+an]:(e,t)=>El(zx(e),e.getDay(),Ux(t)),[an]:(e,t)=>El(1,e.getDay(),Ux(t))},WJ={[Gn]:e=>3*e,[St]:(e,t)=>El(e,0,Ux(t))};function cD(e,t){return lD(e,t||1,HJ,WJ,zJ)}const GJ={[Yt]:e=>e.getUTCFullYear(),[Gn]:e=>Math.floor(e.getUTCMonth()/3),[on]:e=>e.getUTCMonth(),[Yn]:e=>e.getUTCDate(),[pr]:e=>e.getUTCHours(),[mr]:e=>e.getUTCMinutes(),[Nr]:e=>e.getUTCSeconds(),[ai]:e=>e.getUTCMilliseconds(),[Ii]:e=>uD(e),[St]:e=>qx(e),[an]:(e,t)=>El(1,e.getUTCDay(),Hx(t)),[St+an]:(e,t)=>El(qx(e),e.getUTCDay(),Hx(t))},YJ={[Gn]:e=>3*e,[St]:(e,t)=>El(e,0,Hx(t))};function fD(e,t){return lD(e,t||1,GJ,YJ,UJ)}const VJ={[Yt]:SJ,[Gn]:KM.every(3),[on]:KM,[St]:XM,[Yn]:Zg,[an]:Zg,[Ii]:Zg,[pr]:EJ,[mr]:wJ,[Nr]:VM,[ai]:GM},XJ={[Yt]:NJ,[Gn]:QM.every(3),[on]:QM,[St]:JM,[Yn]:Jg,[an]:Jg,[Ii]:Jg,[pr]:kJ,[mr]:OJ,[Nr]:VM,[ai]:GM};function $l(e){return VJ[e]}function Al(e){return XJ[e]}function dD(e,t,n){return e?e.offset(t,n):void 0}function hD(e,t,n){return dD($l(e),t,n)}function gD(e,t,n){return dD(Al(e),t,n)}function pD(e,t,n,r){return e?e.range(t,n,r):void 0}function mD(e,t,n,r){return pD($l(e),t,n,r)}function yD(e,t,n,r){return pD(Al(e),t,n,r)}const If=1e3,Bf=If*60,zf=Bf*60,Qg=zf*24,KJ=Qg*7,vD=Qg*30,Wx=Qg*365,bD=[Yt,on,Yn,pr,mr,Nr,ai],Uf=bD.slice(0,-1),qf=Uf.slice(0,-1),Hf=qf.slice(0,-1),ZJ=Hf.slice(0,-1),JJ=[Yt,St],xD=[Yt,on],wD=[Yt],Wf=[[Uf,1,If],[Uf,5,5*If],[Uf,15,15*If],[Uf,30,30*If],[qf,1,Bf],[qf,5,5*Bf],[qf,15,15*Bf],[qf,30,30*Bf],[Hf,1,zf],[Hf,3,3*zf],[Hf,6,6*zf],[Hf,12,12*zf],[ZJ,1,Qg],[JJ,1,KJ],[xD,1,vD],[xD,3,3*vD],[wD,1,Wx]];function _D(e){const t=e.extent,n=e.maxbins||40,r=Math.abs(Tf(t))/n;let i=RJ(s=>s[2]).right(Wf,r),o,a;return i===Wf.length?(o=wD,a=tD(t[0]/Wx,t[1]/Wx,n)):i?(i=Wf[r/Wf[i-1][2]<Wf[i][2]/r?i-1:i],o=i[0],a=i[1]):(o=bD,a=Math.max(tD(t[0],t[1],n),1)),{units:o,step:a}}var Gx=new Date,Yx=new Date;function Ro(e,t,n,r){function i(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=function(o){return e(o=new Date(+o)),o},i.ceil=function(o){return e(o=new Date(o-1)),t(o,1),e(o),o},i.round=function(o){var a=i(o),s=i.ceil(o);return o-a<s-o?a:s},i.offset=function(o,a){return t(o=new Date(+o),a==null?1:Math.floor(a)),o},i.range=function(o,a,s){var u=[],l;if(o=i.ceil(o),s=s==null?1:Math.floor(s),!(o<a)||!(s>0))return u;do u.push(l=new Date(+o)),t(o,s),e(o);while(l<o&&o<a);return u},i.filter=function(o){return Ro(function(a){if(a>=a)for(;e(a),!o(a);)a.setTime(a-1)},function(a,s){if(a>=a)if(s<0)for(;++s<=0;)for(;t(a,-1),!o(a););else for(;--s>=0;)for(;t(a,1),!o(a););})},n&&(i.count=function(o,a){return Gx.setTime(+o),Yx.setTime(+a),e(Gx),e(Yx),Math.floor(n(Gx,Yx))},i.every=function(o){return o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(r?function(a){return r(a)%o==0}:function(a){return i.count(0,a)%o==0}):i}),i}const QJ=1e3,Vx=QJ*60,eQ=Vx*60,Xx=eQ*24,ED=Xx*7;var tQ=Ro(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Vx)/Xx,e=>e.getDate()-1),$D=tQ;function Is(e){return Ro(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+n*7)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Vx)/ED})}var nQ=Is(0),Kx=Is(1);Is(2);Is(3);var Gf=Is(4);Is(5);Is(6);var AD=Ro(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});AD.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:Ro(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)})};var Yf=AD,rQ=Ro(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/Xx},function(e){return e.getUTCDate()-1}),SD=rQ;function Bs(e){return Ro(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n*7)},function(t,n){return(n-t)/ED})}var iQ=Bs(0),Zx=Bs(1);Bs(2);Bs(3);var Vf=Bs(4);Bs(5);Bs(6);var CD=Ro(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});CD.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:Ro(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})};var Xf=CD;function Jx(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Qx(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Kf(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function OD(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,a=e.shortDays,s=e.months,u=e.shortMonths,l=Zf(i),c=Jf(i),f=Zf(o),d=Jf(o),h=Zf(a),g=Jf(a),p=Zf(s),m=Jf(s),y=Zf(u),v=Jf(u),b={a:T,A:L,b:z,B:Q,c:null,d:TD,e:TD,f:CQ,g:LQ,G:IQ,H:$Q,I:AQ,j:SQ,L:RD,m:OQ,M:FQ,p:oe,q:ue,Q:zD,s:UD,S:kQ,u:MQ,U:DQ,V:NQ,w:TQ,W:RQ,x:null,X:null,y:PQ,Y:jQ,Z:BQ,"%":BD},x={a:ce,A:xe,b:_e,B:Wt,c:null,d:LD,e:LD,f:HQ,g:eee,G:nee,H:zQ,I:UQ,j:qQ,L:jD,m:WQ,M:GQ,p:ur,q:Bn,Q:zD,s:UD,S:YQ,u:VQ,U:XQ,V:KQ,w:ZQ,W:JQ,x:null,X:null,y:QQ,Y:tee,Z:ree,"%":BD},w={a:O,A:$,b:M,B:F,c:N,d:DD,e:DD,f:xQ,g:MD,G:kD,H:ND,I:ND,j:mQ,L:bQ,m:pQ,M:yQ,p:C,q:gQ,Q:_Q,s:EQ,S:vQ,u:lQ,U:cQ,V:fQ,w:uQ,W:dQ,x:A,X:k,y:MD,Y:kD,Z:hQ,"%":wQ};b.x=E(n,b),b.X=E(r,b),b.c=E(t,b),x.x=E(n,x),x.X=E(r,x),x.c=E(t,x);function E(P,W){return function(V){var D=[],Ee=-1,X=0,ke=P.length,$e,Qt,kr;for(V instanceof Date||(V=new Date(+V));++Ee<ke;)P.charCodeAt(Ee)===37&&(D.push(P.slice(X,Ee)),(Qt=FD[$e=P.charAt(++Ee)])!=null?$e=P.charAt(++Ee):Qt=$e==="e"?" ":"0",(kr=W[$e])&&($e=kr(V,Qt)),D.push($e),X=Ee+1);return D.push(P.slice(X,Ee)),D.join("")}}function _(P,W){return function(V){var D=Kf(1900,void 0,1),Ee=S(D,P,V+="",0),X,ke;if(Ee!=V.length)return null;if("Q"in D)return new Date(D.Q);if("s"in D)return new Date(D.s*1e3+("L"in D?D.L:0));if(W&&!("Z"in D)&&(D.Z=0),"p"in D&&(D.H=D.H%12+D.p*12),D.m===void 0&&(D.m="q"in D?D.q:0),"V"in D){if(D.V<1||D.V>53)return null;"w"in D||(D.w=1),"Z"in D?(X=Qx(Kf(D.y,0,1)),ke=X.getUTCDay(),X=ke>4||ke===0?Zx.ceil(X):Zx(X),X=SD.offset(X,(D.V-1)*7),D.y=X.getUTCFullYear(),D.m=X.getUTCMonth(),D.d=X.getUTCDate()+(D.w+6)%7):(X=Jx(Kf(D.y,0,1)),ke=X.getDay(),X=ke>4||ke===0?Kx.ceil(X):Kx(X),X=$D.offset(X,(D.V-1)*7),D.y=X.getFullYear(),D.m=X.getMonth(),D.d=X.getDate()+(D.w+6)%7)}else("W"in D||"U"in D)&&("w"in D||(D.w="u"in D?D.u%7:"W"in D?1:0),ke="Z"in D?Qx(Kf(D.y,0,1)).getUTCDay():Jx(Kf(D.y,0,1)).getDay(),D.m=0,D.d="W"in D?(D.w+6)%7+D.W*7-(ke+5)%7:D.w+D.U*7-(ke+6)%7);return"Z"in D?(D.H+=D.Z/100|0,D.M+=D.Z%100,Qx(D)):Jx(D)}}function S(P,W,V,D){for(var Ee=0,X=W.length,ke=V.length,$e,Qt;Ee<X;){if(D>=ke)return-1;if($e=W.charCodeAt(Ee++),$e===37){if($e=W.charAt(Ee++),Qt=w[$e in FD?W.charAt(Ee++):$e],!Qt||(D=Qt(P,V,D))<0)return-1}else if($e!=V.charCodeAt(D++))return-1}return D}function C(P,W,V){var D=l.exec(W.slice(V));return D?(P.p=c.get(D[0].toLowerCase()),V+D[0].length):-1}function O(P,W,V){var D=h.exec(W.slice(V));return D?(P.w=g.get(D[0].toLowerCase()),V+D[0].length):-1}function $(P,W,V){var D=f.exec(W.slice(V));return D?(P.w=d.get(D[0].toLowerCase()),V+D[0].length):-1}function M(P,W,V){var D=y.exec(W.slice(V));return D?(P.m=v.get(D[0].toLowerCase()),V+D[0].length):-1}function F(P,W,V){var D=p.exec(W.slice(V));return D?(P.m=m.get(D[0].toLowerCase()),V+D[0].length):-1}function N(P,W,V){return S(P,t,W,V)}function A(P,W,V){return S(P,n,W,V)}function k(P,W,V){return S(P,r,W,V)}function T(P){return a[P.getDay()]}function L(P){return o[P.getDay()]}function z(P){return u[P.getMonth()]}function Q(P){return s[P.getMonth()]}function oe(P){return i[+(P.getHours()>=12)]}function ue(P){return 1+~~(P.getMonth()/3)}function ce(P){return a[P.getUTCDay()]}function xe(P){return o[P.getUTCDay()]}function _e(P){return u[P.getUTCMonth()]}function Wt(P){return s[P.getUTCMonth()]}function ur(P){return i[+(P.getUTCHours()>=12)]}function Bn(P){return 1+~~(P.getUTCMonth()/3)}return{format:function(P){var W=E(P+="",b);return W.toString=function(){return P},W},parse:function(P){var W=_(P+="",!1);return W.toString=function(){return P},W},utcFormat:function(P){var W=E(P+="",x);return W.toString=function(){return P},W},utcParse:function(P){var W=_(P+="",!0);return W.toString=function(){return P},W}}}var FD={"-":"",_:" ","0":"0"},Pt=/^\s*\d+/,oQ=/^%/,aQ=/[\\^$*+?|[\]().{}]/g;function Te(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function sQ(e){return e.replace(aQ,"\\$&")}function Zf(e){return new RegExp("^(?:"+e.map(sQ).join("|")+")","i")}function Jf(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function uQ(e,t,n){var r=Pt.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function lQ(e,t,n){var r=Pt.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function cQ(e,t,n){var r=Pt.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function fQ(e,t,n){var r=Pt.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function dQ(e,t,n){var r=Pt.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function kD(e,t,n){var r=Pt.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function MD(e,t,n){var r=Pt.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function hQ(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function gQ(e,t,n){var r=Pt.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function pQ(e,t,n){var r=Pt.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function DD(e,t,n){var r=Pt.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function mQ(e,t,n){var r=Pt.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function ND(e,t,n){var r=Pt.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function yQ(e,t,n){var r=Pt.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function vQ(e,t,n){var r=Pt.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function bQ(e,t,n){var r=Pt.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function xQ(e,t,n){var r=Pt.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function wQ(e,t,n){var r=oQ.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function _Q(e,t,n){var r=Pt.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function EQ(e,t,n){var r=Pt.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function TD(e,t){return Te(e.getDate(),t,2)}function $Q(e,t){return Te(e.getHours(),t,2)}function AQ(e,t){return Te(e.getHours()%12||12,t,2)}function SQ(e,t){return Te(1+$D.count(Yf(e),e),t,3)}function RD(e,t){return Te(e.getMilliseconds(),t,3)}function CQ(e,t){return RD(e,t)+"000"}function OQ(e,t){return Te(e.getMonth()+1,t,2)}function FQ(e,t){return Te(e.getMinutes(),t,2)}function kQ(e,t){return Te(e.getSeconds(),t,2)}function MQ(e){var t=e.getDay();return t===0?7:t}function DQ(e,t){return Te(nQ.count(Yf(e)-1,e),t,2)}function PD(e){var t=e.getDay();return t>=4||t===0?Gf(e):Gf.ceil(e)}function NQ(e,t){return e=PD(e),Te(Gf.count(Yf(e),e)+(Yf(e).getDay()===4),t,2)}function TQ(e){return e.getDay()}function RQ(e,t){return Te(Kx.count(Yf(e)-1,e),t,2)}function PQ(e,t){return Te(e.getFullYear()%100,t,2)}function LQ(e,t){return e=PD(e),Te(e.getFullYear()%100,t,2)}function jQ(e,t){return Te(e.getFullYear()%1e4,t,4)}function IQ(e,t){var n=e.getDay();return e=n>=4||n===0?Gf(e):Gf.ceil(e),Te(e.getFullYear()%1e4,t,4)}function BQ(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Te(t/60|0,"0",2)+Te(t%60,"0",2)}function LD(e,t){return Te(e.getUTCDate(),t,2)}function zQ(e,t){return Te(e.getUTCHours(),t,2)}function UQ(e,t){return Te(e.getUTCHours()%12||12,t,2)}function qQ(e,t){return Te(1+SD.count(Xf(e),e),t,3)}function jD(e,t){return Te(e.getUTCMilliseconds(),t,3)}function HQ(e,t){return jD(e,t)+"000"}function WQ(e,t){return Te(e.getUTCMonth()+1,t,2)}function GQ(e,t){return Te(e.getUTCMinutes(),t,2)}function YQ(e,t){return Te(e.getUTCSeconds(),t,2)}function VQ(e){var t=e.getUTCDay();return t===0?7:t}function XQ(e,t){return Te(iQ.count(Xf(e)-1,e),t,2)}function ID(e){var t=e.getUTCDay();return t>=4||t===0?Vf(e):Vf.ceil(e)}function KQ(e,t){return e=ID(e),Te(Vf.count(Xf(e),e)+(Xf(e).getUTCDay()===4),t,2)}function ZQ(e){return e.getUTCDay()}function JQ(e,t){return Te(Zx.count(Xf(e)-1,e),t,2)}function QQ(e,t){return Te(e.getUTCFullYear()%100,t,2)}function eee(e,t){return e=ID(e),Te(e.getUTCFullYear()%100,t,2)}function tee(e,t){return Te(e.getUTCFullYear()%1e4,t,4)}function nee(e,t){var n=e.getUTCDay();return e=n>=4||n===0?Vf(e):Vf.ceil(e),Te(e.getUTCFullYear()%1e4,t,4)}function ree(){return"+0000"}function BD(){return"%"}function zD(e){return+e}function UD(e){return Math.floor(+e/1e3)}var Sl,qD,HD,WD,GD;iee({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function iee(e){return Sl=OD(e),qD=Sl.format,HD=Sl.parse,WD=Sl.utcFormat,GD=Sl.utcParse,Sl}function Qf(e){const t={};return n=>t[n]||(t[n]=e(n))}function oee(e,t){return n=>{const r=e(n),i=r.indexOf(t);if(i<0)return r;let o=aee(r,i);const a=o<r.length?r.slice(o):"";for(;--o>i;)if(r[o]!=="0"){++o;break}return r.slice(0,o)+a}}function aee(e,t){let n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;)if(r=e.charCodeAt(n),r>=48&&r<=57)return n+1}function YD(e){const t=Qf(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(r){const i=Pf(r||",");if(i.precision==null){switch(i.precision=12,i.type){case"%":i.precision-=2;break;case"e":i.precision-=1;break}return oee(t(i),t(".1f")(1)[1])}else return t(i)},formatSpan(r,i,o,a){a=Pf(a==null?",f":a);const s=uJ(r,i,o),u=Math.max(Math.abs(r),Math.abs(i));let l;if(a.precision==null)switch(a.type){case"s":return isNaN(l=yJ(s,u))||(a.precision=l),n(a,u);case"":case"e":case"g":case"p":case"r":{isNaN(l=vJ(s,u))||(a.precision=l-(a.type==="e"));break}case"f":case"%":{isNaN(l=mJ(s))||(a.precision=l-(a.type==="%")*2);break}}return t(a)}}}let e2;VD();function VD(){return e2=YD({format:HM,formatPrefix:WM})}function XD(e){return YD(qM(e))}function ep(e){return arguments.length?e2=XD(e):e2}function KD(e,t,n){n=n||{},le(n)||B("Invalid time multi-format specifier: ".concat(n));const r=t(Nr),i=t(mr),o=t(pr),a=t(Yn),s=t(St),u=t(on),l=t(Gn),c=t(Yt),f=e(n[ai]||".%L"),d=e(n[Nr]||":%S"),h=e(n[mr]||"%I:%M"),g=e(n[pr]||"%I %p"),p=e(n[Yn]||n[an]||"%a %d"),m=e(n[St]||"%b %d"),y=e(n[on]||"%B"),v=e(n[Gn]||"%B"),b=e(n[Yt]||"%Y");return x=>(r(x)<x?f:i(x)<x?d:o(x)<x?h:a(x)<x?g:u(x)<x?s(x)<x?p:m:c(x)<x?l(x)<x?y:v:b)(x)}function ZD(e){const t=Qf(e.format),n=Qf(e.utcFormat);return{timeFormat:r=>Me(r)?t(r):KD(t,$l,r),utcFormat:r=>Me(r)?n(r):KD(n,Al,r),timeParse:Qf(e.parse),utcParse:Qf(e.utcParse)}}let t2;JD();function JD(){return t2=ZD({format:qD,parse:HD,utcFormat:WD,utcParse:GD})}function QD(e){return ZD(OD(e))}function ed(e){return arguments.length?t2=QD(e):t2}const n2=(e,t)=>pe({},e,t);function e5(e,t){const n=e?XD(e):ep(),r=t?QD(t):ed();return n2(n,r)}function r2(e,t){const n=arguments.length;return n&&n!==2&&B("defaultLocale expects either zero or two arguments."),n?n2(ep(e),ed(t)):n2(ep(),ed())}function see(){return VD(),JD(),r2()}const uee=/^(data:|([A-Za-z]+:)?\/\/)/,lee=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,cee=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,t5="file://";function fee(e,t){return n=>({options:n||{},sanitize:hee,load:dee,fileAccess:!!t,file:gee(t),http:mee(e)})}async function dee(e,t){const n=await this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)}async function hee(e,t){t=pe({},this.options,t);const n=this.fileAccess,r={href:null};let i,o,a;const s=lee.test(e.replace(cee,""));(e==null||typeof e!="string"||!s)&&B("Sanitize failure, invalid URI: "+re(e));const u=uee.test(e);return(a=t.baseURL)&&!u&&(!e.startsWith("/")&&!a.endsWith("/")&&(e="/"+e),e=a+e),o=(i=e.startsWith(t5))||t.mode==="file"||t.mode!=="http"&&!u&&n,i?e=e.slice(t5.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),o=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!o}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r}function gee(e){return e?t=>new Promise((n,r)=>{e.readFile(t,(i,o)=>{i?r(i):n(o)})}):pee}async function pee(){B("No file system access.")}function mee(e){return e?async function(t,n){const r=pe({},this.options.http,n),i=n&&n.response,o=await e(t,r);return o.ok?ye(o[i])?o[i]():o.text():B(o.status+""+o.statusText)}:yee}async function yee(){B("No HTTP fetch method available.")}const vee=e=>e!=null&&e===e,bee=e=>e==="true"||e==="false"||e===!0||e===!1,xee=e=>!Number.isNaN(Date.parse(e)),n5=e=>!Number.isNaN(+e)&&!(e instanceof Date),wee=e=>n5(e)&&Number.isInteger(+e),i2={boolean:Sx,integer:nn,number:nn,date:Cx,string:Ox,unknown:En},tp=[bee,wee,n5,xee],_ee=["boolean","integer","number","date"];function r5(e,t){if(!e||!e.length)return"unknown";const n=e.length,r=tp.length,i=tp.map((o,a)=>a+1);for(let o=0,a=0,s,u;o<n;++o)for(u=t?e[o][t]:e[o],s=0;s<r;++s)if(i[s]&&vee(u)&&!tp[s](u)&&(i[s]=0,++a,a===tp.length))return"string";return _ee[i.reduce((o,a)=>o===0?a:o,0)-1]}function i5(e,t){return t.reduce((n,r)=>(n[r]=r5(e,r),n),{})}function o5(e){const t=function(n,r){const i={delimiter:e};return o2(n,r?pe(r,i):i)};return t.responseType="text",t}function o2(e,t){return t.header&&(e=t.header.map(re).join(t.delimiter)+`
`+e),KZ(t.delimiter).parse(e+"")}o2.responseType="text";function Eee(e){return typeof Buffer=="function"&&ye(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function a2(e,t){const n=t&&t.property?Hn(t.property):En;return le(e)&&!Eee(e)?$ee(n(e),t):n(JSON.parse(e))}a2.responseType="json";function $ee(e,t){return!ee(e)&&AM(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}const Aee={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function a5(e,t){let n,r,i,o;return e=a2(e,t),t&&t.feature?(n=eJ,i=t.feature):t&&t.mesh?(n=nJ,i=t.mesh,o=Aee[t.filter]):B("Missing TopoJSON feature or mesh parameter."),r=(r=e.objects[i])?n(e,r,o):B("Invalid TopoJSON object: "+i),r&&r.features||[r]}a5.responseType="json";const np={dsv:o2,csv:o5(","),tsv:o5("	"),json:a2,topojson:a5};function s2(e,t){return arguments.length>1?(np[e]=t,this):se(np,e)?np[e]:null}function s5(e){const t=s2(e);return t&&t.responseType||"text"}function u5(e,t,n,r){t=t||{};const i=s2(t.type||"json");return i||B("Unknown data format type: "+t.type),e=i(e,t),t.parse&&See(e,t.parse,n,r),se(e,"columns")&&delete e.columns,e}function See(e,t,n,r){if(!e.length)return;const i=ed();n=n||i.timeParse,r=r||i.utcParse;let o=e.columns||Object.keys(e[0]),a,s,u,l,c,f;t==="auto"&&(t=i5(e,o)),o=Object.keys(t);const d=o.map(h=>{const g=t[h];let p,m;if(g&&(g.startsWith("date:")||g.startsWith("utc:")))return p=g.split(/:(.+)?/,2),m=p[1],(m[0]==="'"&&m[m.length-1]==="'"||m[0]==='"'&&m[m.length-1]==='"')&&(m=m.slice(1,-1)),(p[0]==="utc"?r:n)(m);if(!i2[g])throw Error("Illegal format pattern: "+h+":"+g);return i2[g]});for(u=0,c=e.length,f=o.length;u<c;++u)for(a=e[u],l=0;l<f;++l)s=o[l],a[s]=d[l](a[s])}const rp=fee(typeof fetch!="undefined"&&fetch,null);function ip(e){const t=e||En,n=[],r={};return n.add=i=>{const o=t(i);return r[o]||(r[o]=1,n.push(i)),n},n.remove=i=>{const o=t(i);if(r[o]){r[o]=0;const a=n.indexOf(i);a>=0&&n.splice(a,1)}return n},n}async function op(e,t){try{await t(e)}catch(n){e.error(n)}}const l5=Symbol("vega_id");let Cee=1;function ap(e){return!!(e&&te(e))}function te(e){return e[l5]}function c5(e,t){return e[l5]=t,e}function Ie(e){const t=e===Object(e)?e:{data:e};return te(t)?t:c5(t,Cee++)}function u2(e){return sp(e,Ie({}))}function sp(e,t){for(const n in e)t[n]=e[n];return t}function f5(e,t){return c5(t,te(e))}function zs(e,t){return e?t?(n,r)=>e(n,r)||te(t(n))-te(t(r)):(n,r)=>e(n,r)||te(n)-te(r):null}function d5(e){return e&&e.constructor===Us}function Us(){const e=[],t=[],n=[],r=[],i=[];let o=null,a=!1;return{constructor:Us,insert(s){const u=ae(s),l=u.length;for(let c=0;c<l;++c)e.push(u[c]);return this},remove(s){const u=ye(s)?r:t,l=ae(s),c=l.length;for(let f=0;f<c;++f)u.push(l[f]);return this},modify(s,u,l){const c={field:u,value:rn(l)};return ye(s)?(c.filter=s,i.push(c)):(c.tuple=s,n.push(c)),this},encode(s,u){return ye(s)?i.push({filter:s,field:u}):n.push({tuple:s,field:u}),this},clean(s){return o=s,this},reflow(){return a=!0,this},pulse(s,u){const l={},c={};let f,d,h,g,p,m;for(f=0,d=u.length;f<d;++f)l[te(u[f])]=1;for(f=0,d=t.length;f<d;++f)p=t[f],l[te(p)]=-1;for(f=0,d=r.length;f<d;++f)g=r[f],u.forEach(v=>{g(v)&&(l[te(v)]=-1)});for(f=0,d=e.length;f<d;++f)p=e[f],m=te(p),l[m]?l[m]=1:s.add.push(Ie(e[f]));for(f=0,d=u.length;f<d;++f)p=u[f],l[te(p)]<0&&s.rem.push(p);function y(v,b,x){x?v[b]=x(v):s.encode=b,a||(c[te(v)]=v)}for(f=0,d=n.length;f<d;++f)h=n[f],p=h.tuple,g=h.field,m=l[te(p)],m>0&&(y(p,g,h.value),s.modifies(g));for(f=0,d=i.length;f<d;++f)h=i[f],g=h.filter,u.forEach(v=>{g(v)&&l[te(v)]>0&&y(v,h.field,h.value)}),s.modifies(h.field);if(a)s.mod=t.length||r.length?u.filter(v=>l[te(v)]>0):u.slice();else for(m in c)s.mod.push(c[m]);return(o||o==null&&(t.length||r.length))&&s.clean(!0),s}}}const up="_:mod:_";function lp(){Object.defineProperty(this,up,{writable:!0,value:{}})}lp.prototype={set(e,t,n,r){const i=this,o=i[e],a=i[up];return t!=null&&t>=0?(o[t]!==n||r)&&(o[t]=n,a[t+":"+e]=-1,a[e]=-1):(o!==n||r)&&(i[e]=n,a[e]=ee(n)?1+n.length:-1),i},modified(e,t){const n=this[up];if(arguments.length){if(ee(e)){for(let r=0;r<e.length;++r)if(n[e[r]])return!0;return!1}}else{for(const r in n)if(n[r])return!0;return!1}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[up]={},this}};let Oee=0;const Fee="pulse",kee=new lp,Mee=1,Dee=2;function Ve(e,t,n,r){this.id=++Oee,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,r)}function h5(e){return function(t){const n=this.flags;return arguments.length===0?!!(n&e):(this.flags=t?n|e:n&~e,this)}}Ve.prototype={targets(){return this._targets||(this._targets=ip(Mf))},set(e){return this.value!==e?(this.value=e,1):0},skip:h5(Mee),modified:h5(Dee),parameters(e,t,n){t=t!==!1;const r=this._argval=this._argval||new lp,i=this._argops=this._argops||[],o=[];let a,s,u,l;const c=(f,d,h)=>{h instanceof Ve?(h!==this&&(t&&h.targets().add(this),o.push(h)),i.push({op:h,name:f,index:d})):r.set(f,d,h)};for(a in e)if(s=e[a],a===Fee)ae(s).forEach(f=>{f instanceof Ve?f!==this&&(f.targets().add(this),o.push(f)):B("Pulse parameters must be operator instances.")}),this.source=s;else if(ee(s))for(r.set(a,-1,Array(u=s.length)),l=0;l<u;++l)c(a,l,s[l]);else c(a,-1,s);return this.marshall().clear(),n&&(i.initonly=!0),o},marshall(e){const t=this._argval||kee,n=this._argops;let r,i,o,a;if(n){const s=n.length;for(i=0;i<s;++i)r=n[i],o=r.op,a=o.modified()&&o.stamp===e,t.set(r.name,r.index,o.value,a);if(n.initonly){for(i=0;i<s;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,r,i;if(e)for(t=0,n=e.length;t<n;++t)r=e[t],i=r.op,i._targets&&i._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),r=t.call(this,n,e);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};function Nee(e,t,n,r){let i=1,o;return e instanceof Ve?o=e:e&&e.prototype instanceof Ve?o=new e:ye(e)?o=new Ve(null,e):(i=0,o=new Ve(e,t)),this.rank(o),i&&(r=n,n=t),n&&this.connect(o,o.parameters(n,r)),this.touch(o),o}function Tee(e,t){const n=e.rank,r=t.length;for(let i=0;i<r;++i)if(n<t[i].rank){this.rerank(e);return}}let Ree=0;function cp(e,t,n){this.id=++Ree,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function Aa(e,t,n){return new cp(e,t,n)}cp.prototype={_filter:Dr,_apply:En,targets(){return this._targets||(this._targets=ip(Mf))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,r=n?n.length:0;for(let i=0;i<r;++i)n[i].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=Aa(e);return this.targets().add(t),t},apply(e){const t=Aa(null,e);return this.targets().add(t),t},merge(){const e=Aa();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=Aa();return this.targets().add(Aa(null,null,Ex(e,n=>{const r=n.dataflow;t.receive(n),r&&r.run&&r.run()}))),t},between(e,t){let n=!1;return e.targets().add(Aa(null,null,()=>n=!0)),t.targets().add(Aa(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=Dr,this._targets=null}};function Pee(e,t,n,r){const i=this,o=Aa(n,r),a=function(l){l.dataflow=i;try{o.receive(l)}catch(c){i.error(c)}finally{i.run()}};let s;typeof e=="string"&&typeof document!="undefined"?s=document.querySelectorAll(e):s=ae(e);const u=s.length;for(let l=0;l<u;++l)s[l].addEventListener(t,a);return o}function Lee(e,t){const n=this.locale();return u5(e,t,n.timeParse,n.utcParse)}function jee(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))}async function Iee(e,t){const n=this;let r=0,i;try{i=await n.loader().load(e,{context:"dataflow",response:s5(t&&t.type)});try{i=n.parse(i,t)}catch(o){r=-2,n.warn("Data ingestion failed",e,o)}}catch(o){r=-1,n.warn("Loading failed",e,o)}return{data:i,status:r}}async function Bee(e,t,n){const r=this,i=r._pending||zee(r);i.requests+=1;const o=await r.request(t,n);return r.pulse(e,r.changeset().remove(Dr).insert(o.data||[])),i.done(),o}function zee(e){let t;const n=new Promise(r=>t=r);return n.requests=0,n.done=()=>{--n.requests==0&&(e._pending=null,t(e))},e._pending=n}const Uee={skip:!0};function qee(e,t,n,r,i){return(e instanceof Ve?Wee:Hee)(this,e,t,n,r,i),this}function Hee(e,t,n,r,i,o){const a=pe({},o,Uee);let s,u;ye(n)||(n=rn(n)),r===void 0?s=l=>e.touch(n(l)):ye(r)?(u=new Ve(null,r,i,!1),s=l=>{u.evaluate(l);const c=n(l),f=u.value;d5(f)?e.pulse(c,f,o):e.update(c,f,a)}):s=l=>e.update(n(l),r,a),t.apply(s)}function Wee(e,t,n,r,i,o){if(r===void 0)t.targets().add(n);else{const a=o||{},s=new Ve(null,Gee(n,r),i,!1);s.modified(a.force),s.rank=t.rank,t.targets().add(s),n&&(s.skip(!0),s.value=n.value,s.targets().add(n),e.connect(n,[s]))}}function Gee(e,t){return t=ye(t)?t:rn(t),e?function(n,r){const i=t(n,r);return e.skip()||(e.skip(i!==this.value).value=i),i}:t}function Yee(e){e.rank=++this._rank}function Vee(e){const t=[e];let n,r,i;for(;t.length;)if(this.rank(n=t.pop()),r=n._targets)for(i=r.length;--i>=0;)t.push(n=r[i]),n===e&&B("Cycle detected in dataflow graph.")}const fp={},Bi=1<<0,Sa=1<<1,Po=1<<2,Xee=Bi|Sa,g5=Bi|Po,Cl=Bi|Sa|Po,p5=1<<3,td=1<<4,m5=1<<5,y5=1<<6;function Ca(e,t,n){this.dataflow=e,this.stamp=t==null?-1:t,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function l2(e,t){const n=[];return Ea(e,t,r=>n.push(r)),n}function v5(e,t){const n={};return e.visit(t,r=>{n[te(r)]=1}),r=>n[te(r)]?null:r}function dp(e,t){return e?(n,r)=>e(n,r)&&t(n,r):t}Ca.prototype={StopPropagation:fp,ADD:Bi,REM:Sa,MOD:Po,ADD_REM:Xee,ADD_MOD:g5,ALL:Cl,REFLOW:p5,SOURCE:td,NO_SOURCE:m5,NO_FIELDS:y5,fork(e){return new Ca(this.dataflow).init(this,e)},clone(){const e=this.fork(Cl);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(Cl|td)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new Ca(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(t&y5)&&(n.fields=e.fields),t&Bi?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&Sa?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&Po?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&m5?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||Cl;return t&Bi&&this.add.length||t&Sa&&this.rem.length||t&Po&&this.mod.length},reflow(e){if(e)return this.fork(Cl).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(Po,v5(this,Bi))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return ee(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return(t||this.mod.length)&&n?arguments.length?ee(e)?e.some(r=>n[r]):n[e]:!!n:!1},filter(e,t){const n=this;return e&Bi&&(n.addF=dp(n.addF,t)),e&Sa&&(n.remF=dp(n.remF,t)),e&Po&&(n.modF=dp(n.modF,t)),e&td&&(n.srcF=dp(n.srcF,t)),n},materialize(e){e=e||Cl;const t=this;return e&Bi&&t.addF&&(t.add=l2(t.add,t.addF),t.addF=null),e&Sa&&t.remF&&(t.rem=l2(t.rem,t.remF),t.remF=null),e&Po&&t.modF&&(t.mod=l2(t.mod,t.modF),t.modF=null),e&td&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,r=t;if(e&td)return Ea(n.source,n.srcF,r),n;e&Bi&&Ea(n.add,n.addF,r),e&Sa&&Ea(n.rem,n.remF,r),e&Po&&Ea(n.mod,n.modF,r);const i=n.source;if(e&p5&&i){const o=n.add.length+n.mod.length;o===i.length||(o?Ea(i,v5(n,g5),r):Ea(i,n.srcF,r))}return n}};function c2(e,t,n,r){const i=this,o=n.length;let a=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=r||null,this.pulses=n;for(let s=0;s<o;++s){const u=n[s];if(u.stamp===t){if(u.fields){const l=i.fields||(i.fields={});for(const c in u.fields)l[c]=1}u.changed(i.ADD)&&(a|=i.ADD),u.changed(i.REM)&&(a|=i.REM),u.changed(i.MOD)&&(a|=i.MOD)}}this.changes=a}H(c2,Ca,{fork(e){const t=new Ca(this.dataflow).init(this,e&this.NO_FIELDS);return e!==void 0&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?ee(e)?e.some(r=>n[r]):n[e]:0},filter(){B("MultiPulse does not support filtering.")},materialize(){B("MultiPulse does not support materialization.")},visit(e,t){const n=this,r=n.pulses,i=r.length;let o=0;if(e&n.SOURCE)for(;o<i;++o)r[o].visit(e,t);else for(;o<i;++o)r[o].stamp===n.stamp&&r[o].visit(e,t);return n}});async function Kee(e,t,n){const r=this,i=[];if(r._pulse)return b5(r);if(r._pending&&await r._pending,t&&await op(r,t),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const o=++r._clock;r._pulse=new Ca(r,o,e),r._touched.forEach(c=>r._enqueue(c,!0)),r._touched=ip(Mf);let a=0,s,u,l;try{for(;r._heap.size()>0;){if(s=r._heap.pop(),s.rank!==s.qrank){r._enqueue(s,!0);continue}u=s.run(r._getPulse(s,e)),u.then?u=await u:u.async&&(i.push(u.async),u=fp),u!==fp&&s._targets&&s._targets.forEach(c=>r._enqueue(c)),++a}}catch(c){r._heap.clear(),l=c}if(r._input={},r._pulse=null,r.debug(`Pulse ${o}: ${a} operators`),l&&(r._postrun=[],r.error(l)),r._postrun.length){const c=r._postrun.sort((f,d)=>d.priority-f.priority);r._postrun=[];for(let f=0;f<c.length;++f)await op(r,c[f].callback)}return n&&await op(r,n),i.length&&Promise.all(i).then(c=>r.runAsync(null,()=>{c.forEach(f=>{try{f(r)}catch(d){r.error(d)}})})),r}async function Zee(e,t,n){for(;this._running;)await this._running;const r=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(r,r),this._running}function Jee(e,t,n){return this._pulse?b5(this):(this.evaluate(e,t,n),this)}function Qee(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(r){this.error(r)}}function b5(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function ete(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function tte(e,t){const n=e.source,r=this._clock;return n&&ee(n)?new c2(this,r,n.map(i=>i.pulse),t):this._input[e.id]||nte(this._pulse,n&&n.pulse)}function nte(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==fp&&(e.source=t.source),e)}const f2={skip:!1,force:!1};function rte(e,t){const n=t||f2;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function ite(e,t,n){const r=n||f2;return(e.set(t)||r.force)&&this.touch(e,r),this}function ote(e,t,n){this.touch(e,n||f2);const r=new Ca(this,this._clock+(this._pulse?0:1)),i=e.pulse&&e.pulse.source||[];return r.target=e,this._input[e.id]=t.pulse(r,i),this}function ate(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),x5(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let r;return t.length?(r=t[0],t[0]=n,ste(t,0,e)):r=n,r}}}function x5(e,t,n,r){let i,o;const a=e[n];for(;n>t;){if(o=n-1>>1,i=e[o],r(a,i)<0){e[n]=i,n=o;continue}break}return e[n]=a}function ste(e,t,n){const r=t,i=e.length,o=e[t];let a=(t<<1)+1,s;for(;a<i;)s=a+1,s<i&&n(e[a],e[s])>=0&&(a=s),e[t]=e[a],t=a,a=(t<<1)+1;return e[t]=o,x5(e,r,t,n)}function Ol(){this.logger(cM()),this.logLevel(vx),this._clock=0,this._rank=0,this._locale=r2();try{this._loader=rp()}catch(e){}this._touched=ip(Mf),this._input={},this._pulse=null,this._heap=ate((e,t)=>e.qrank-t.qrank),this._postrun=[]}function nd(e){return function(){return this._log[e].apply(this,arguments)}}Ol.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:nd("error"),warn:nd("warn"),info:nd("info"),debug:nd("debug"),logLevel:nd("level"),cleanThreshold:1e4,add:Nee,connect:Tee,rank:Yee,rerank:Vee,pulse:ote,touch:rte,update:ite,changeset:Us,ingest:jee,parse:Lee,preload:Bee,request:Iee,events:Pee,on:qee,evaluate:Kee,run:Jee,runAsync:Zee,runAfter:Qee,_enqueue:ete,_getPulse:tte};function R(e,t){Ve.call(this,e,null,t)}H(R,Ve,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const Fl={};function w5(e){const t=_5(e);return t&&t.Definition||null}function _5(e){return e=e&&e.toLowerCase(),se(Fl,e)?Fl[e]:null}function d2(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function ute(e){return e===null?NaN:+e}function*lte(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(r=+r)>=r&&(yield r)}}function cte(e,t){let n=0,r,i=0,o=0;if(t===void 0)for(let a of e)a!=null&&(a=+a)>=a&&(r=a-i,i+=r/++n,o+=r*(a-i));else{let a=-1;for(let s of e)(s=t(s,++a,e))!=null&&(s=+s)>=s&&(r=s-i,i+=r/++n,o+=r*(s-i))}if(n>1)return o/(n-1)}function fte(e,t){const n=cte(e,t);return n&&Math.sqrt(n)}function E5(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function $5(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function A5(e,t,n=0,r=e.length-1,i=d2){for(;r>n;){if(r-n>600){const u=r-n+1,l=t-n+1,c=Math.log(u),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(u-f)/u)*(l-u/2<0?-1:1),h=Math.max(n,Math.floor(t-l*f/u+d)),g=Math.min(r,Math.floor(t+(u-l)*f/u+d));A5(e,t,h,g,i)}const o=e[t];let a=n,s=r;for(rd(e,n,t),i(e[r],o)>0&&rd(e,n,r);a<s;){for(rd(e,a,s),++a,--s;i(e[a],o)<0;)++a;for(;i(e[s],o)>0;)--s}i(e[n],o)===0?rd(e,n,s):(++s,rd(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function rd(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function h2(e,t,n){if(e=Float64Array.from(lte(e,n)),!!(r=e.length)){if((t=+t)<=0||r<2)return $5(e);if(t>=1)return E5(e);var r,i=(r-1)*t,o=Math.floor(i),a=E5(A5(e,o).subarray(0,o+1)),s=$5(e.subarray(o+1));return a+(s-a)*(i-o)}}function dte(e,t,n=ute){if(!!(r=e.length)){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),a=+n(e[o],o,e),s=+n(e[o+1],o+1,e);return a+(s-a)*(i-o)}}function hte(e,t){return h2(e,.5,t)}function*S5(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)r=t(r,++n,e),r!=null&&r!==""&&(r=+r)>=r&&(yield r)}}function g2(e,t,n){const r=Float64Array.from(S5(e,n));return r.sort(d2),t.map(i=>dte(r,i))}function p2(e,t){return g2(e,[.25,.5,.75],t)}function m2(e,t){const n=e.length,r=fte(e,t),i=p2(e,t),o=(i[2]-i[0])/1.34,a=Math.min(r,o)||r||Math.abs(i[0])||1;return 1.06*a*Math.pow(n,-.2)}function C5(e){const t=e.maxbins||20,n=e.base||10,r=Math.log(n),i=e.divide||[5,2];let o=e.extent[0],a=e.extent[1],s,u,l,c,f,d;const h=e.span||a-o||Math.abs(o)||1;if(e.step)s=e.step;else if(e.steps){for(c=h/t,f=0,d=e.steps.length;f<d&&e.steps[f]<c;++f);s=e.steps[Math.max(0,f-1)]}else{for(u=Math.ceil(Math.log(t)/r),l=e.minstep||0,s=Math.max(l,Math.pow(n,Math.round(Math.log(h)/r)-u));Math.ceil(h/s)>t;)s*=n;for(f=0,d=i.length;f<d;++f)c=s/i[f],c>=l&&h/c<=t&&(s=c)}c=Math.log(s);const g=c>=0?0:~~(-c/r)+1,p=Math.pow(n,-g-1);return(e.nice||e.nice===void 0)&&(c=Math.floor(o/s+p)*s,o=o<c?c-s:c,a=Math.ceil(a/s)*s),{start:o,stop:a===o?o+s:a,step:s}}var Tr=Math.random;function gte(e){Tr=e}function O5(e,t,n,r){if(!e.length)return[void 0,void 0];const i=Float64Array.from(S5(e,r)),o=i.length,a=t;let s,u,l,c;for(l=0,c=Array(a);l<a;++l){for(s=0,u=0;u<o;++u)s+=i[~~(Tr()*o)];c[l]=s/o}return c.sort(d2),[h2(c,n/2),h2(c,1-n/2)]}function F5(e,t,n,r){r=r||(d=>d);const i=e.length,o=new Float64Array(i);let a=0,s=1,u=r(e[0]),l=u,c=u+t,f;for(;s<i;++s){if(f=r(e[s]),f>=c){for(l=(u+l)/2;a<s;++a)o[a]=l;c=f+t,u=f}l=f}for(l=(u+l)/2;a<s;++a)o[a]=l;return n?pte(o,t+t/4):o}function pte(e,t){const n=e.length;let r=0,i=1,o,a;for(;e[r]===e[i];)++i;for(;i<n;){for(o=i+1;e[i]===e[o];)++o;if(e[i]-e[i-1]<t){for(a=i+(r+o-i-i>>1);a<i;)e[a++]=e[i];for(;a>i;)e[a--]=e[r]}r=i,i=o}return e}function mte(e){return function(){return e=(1103515245*e+12345)%2147483647,e/2147483647}}function yte(e,t){t==null&&(t=e,e=0);let n,r,i;const o={min(a){return arguments.length?(n=a||0,i=r-n,o):n},max(a){return arguments.length?(r=a||0,i=r-n,o):r},sample(){return n+Math.floor(i*Tr())},pdf(a){return a===Math.floor(a)&&a>=n&&a<r?1/i:0},cdf(a){const s=Math.floor(a);return s<n?0:s>=r?1:(s-n+1)/i},icdf(a){return a>=0&&a<=1?n-1+Math.floor(a*i):NaN}};return o.min(e).max(t)}const k5=Math.sqrt(2*Math.PI),vte=Math.SQRT2;let id=NaN;function hp(e,t){e=e||0,t=t==null?1:t;let n=0,r=0,i,o;if(id===id)n=id,id=NaN;else{do n=Tr()*2-1,r=Tr()*2-1,i=n*n+r*r;while(i===0||i>1);o=Math.sqrt(-2*Math.log(i)/i),n*=o,id=r*o}return e+n*t}function y2(e,t,n){n=n==null?1:n;const r=(e-(t||0))/n;return Math.exp(-.5*r*r)/(n*k5)}function gp(e,t,n){t=t||0,n=n==null?1:n;const r=(e-t)/n,i=Math.abs(r);let o;if(i>37)o=0;else{const a=Math.exp(-i*i/2);let s;i<7.07106781186547?(s=.0352624965998911*i+.700383064443688,s=s*i+6.37396220353165,s=s*i+33.912866078383,s=s*i+112.079291497871,s=s*i+221.213596169931,s=s*i+220.206867912376,o=a*s,s=.0883883476483184*i+1.75566716318264,s=s*i+16.064177579207,s=s*i+86.7807322029461,s=s*i+296.564248779674,s=s*i+637.333633378831,s=s*i+793.826512519948,s=s*i+440.413735824752,o=o/s):(s=i+.65,s=i+4/s,s=i+3/s,s=i+2/s,s=i+1/s,o=a/s/2.506628274631)}return r>0?1-o:o}function pp(e,t,n){return e<0||e>1?NaN:(t||0)+(n==null?1:n)*vte*bte(2*e-1)}function bte(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function v2(e,t){let n,r;const i={mean(o){return arguments.length?(n=o||0,i):n},stdev(o){return arguments.length?(r=o==null?1:o,i):r},sample:()=>hp(n,r),pdf:o=>y2(o,n,r),cdf:o=>gp(o,n,r),icdf:o=>pp(o,n,r)};return i.mean(e).stdev(t)}function b2(e,t){const n=v2();let r=0;const i={data(o){return arguments.length?(e=o,r=o?o.length:0,i.bandwidth(t)):e},bandwidth(o){return arguments.length?(t=o,!t&&e&&(t=m2(e)),i):t},sample(){return e[~~(Tr()*r)]+t*n.sample()},pdf(o){let a=0,s=0;for(;s<r;++s)a+=n.pdf((o-e[s])/t);return a/t/r},cdf(o){let a=0,s=0;for(;s<r;++s)a+=n.cdf((o-e[s])/t);return a/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(e)}function x2(e,t){return e=e||0,t=t==null?1:t,Math.exp(e+hp()*t)}function w2(e,t,n){if(e<=0)return 0;t=t||0,n=n==null?1:n;const r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*k5*e)}function _2(e,t,n){return gp(Math.log(e),t,n)}function E2(e,t,n){return Math.exp(pp(e,t,n))}function M5(e,t){let n,r;const i={mean(o){return arguments.length?(n=o||0,i):n},stdev(o){return arguments.length?(r=o==null?1:o,i):r},sample:()=>x2(n,r),pdf:o=>w2(o,n,r),cdf:o=>_2(o,n,r),icdf:o=>E2(o,n,r)};return i.mean(e).stdev(t)}function D5(e,t){let n=0,r;function i(a){const s=[];let u=0,l;for(l=0;l<n;++l)u+=s[l]=a[l]==null?1:+a[l];for(l=0;l<n;++l)s[l]/=u;return s}const o={weights(a){return arguments.length?(r=i(t=a||[]),o):t},distributions(a){return arguments.length?(a?(n=a.length,e=a):(n=0,e=[]),o.weights(t)):e},sample(){const a=Tr();let s=e[n-1],u=r[0],l=0;for(;l<n-1;u+=r[++l])if(a<u){s=e[l];break}return s.sample()},pdf(a){let s=0,u=0;for(;u<n;++u)s+=r[u]*e[u].pdf(a);return s},cdf(a){let s=0,u=0;for(;u<n;++u)s+=r[u]*e[u].cdf(a);return s},icdf(){throw Error("Mixture icdf not supported.")}};return o.distributions(e).weights(t)}function $2(e,t){return t==null&&(t=e==null?1:e,e=0),e+(t-e)*Tr()}function A2(e,t,n){return n==null&&(n=t==null?1:t,t=0),e>=t&&e<=n?1/(n-t):0}function S2(e,t,n){return n==null&&(n=t==null?1:t,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function C2(e,t,n){return n==null&&(n=t==null?1:t,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function N5(e,t){let n,r;const i={min(o){return arguments.length?(n=o||0,i):n},max(o){return arguments.length?(r=o==null?1:o,i):r},sample:()=>$2(n,r),pdf:o=>A2(o,n,r),cdf:o=>S2(o,n,r),icdf:o=>C2(o,n,r)};return t==null&&(t=e==null?1:e,e=0),i.min(e).max(t)}function od(e,t,n,r){const i=r-e*e,o=Math.abs(i)<1e-24?0:(n-e*t)/i;return[t-o*e,o]}function mp(e,t,n,r){e=e.filter(h=>{let g=t(h),p=n(h);return g!=null&&(g=+g)>=g&&p!=null&&(p=+p)>=p}),r&&e.sort((h,g)=>t(h)-t(g));const i=e.length,o=new Float64Array(i),a=new Float64Array(i);let s=0,u=0,l=0,c,f,d;for(d of e)o[s]=c=+t(d),a[s]=f=+n(d),++s,u+=(c-u)/s,l+=(f-l)/s;for(s=0;s<i;++s)o[s]-=u,a[s]-=l;return[o,a,u,l]}function ad(e,t,n,r){let i=-1,o,a;for(const s of e)o=t(s),a=n(s),o!=null&&(o=+o)>=o&&a!=null&&(a=+a)>=a&&r(o,a,++i)}function kl(e,t,n,r,i){let o=0,a=0;return ad(e,t,n,(s,u)=>{const l=u-i(s),c=u-r;o+=l*l,a+=c*c}),1-o/a}function O2(e,t,n){let r=0,i=0,o=0,a=0,s=0;ad(e,t,n,(c,f)=>{++s,r+=(c-r)/s,i+=(f-i)/s,o+=(c*f-o)/s,a+=(c*c-a)/s});const u=od(r,i,o,a),l=c=>u[0]+u[1]*c;return{coef:u,predict:l,rSquared:kl(e,t,n,i,l)}}function T5(e,t,n){let r=0,i=0,o=0,a=0,s=0;ad(e,t,n,(c,f)=>{++s,c=Math.log(c),r+=(c-r)/s,i+=(f-i)/s,o+=(c*f-o)/s,a+=(c*c-a)/s});const u=od(r,i,o,a),l=c=>u[0]+u[1]*Math.log(c);return{coef:u,predict:l,rSquared:kl(e,t,n,i,l)}}function R5(e,t,n){const[r,i,o,a]=mp(e,t,n);let s=0,u=0,l=0,c=0,f=0,d,h,g;ad(e,t,n,(v,b)=>{d=r[f++],h=Math.log(b),g=d*b,s+=(b*h-s)/f,u+=(g-u)/f,l+=(g*h-l)/f,c+=(d*g-c)/f});const[p,m]=od(u/a,s/a,l/a,c/a),y=v=>Math.exp(p+m*(v-o));return{coef:[Math.exp(p-m*o),m],predict:y,rSquared:kl(e,t,n,a,y)}}function P5(e,t,n){let r=0,i=0,o=0,a=0,s=0,u=0;ad(e,t,n,(f,d)=>{const h=Math.log(f),g=Math.log(d);++u,r+=(h-r)/u,i+=(g-i)/u,o+=(h*g-o)/u,a+=(h*h-a)/u,s+=(d-s)/u});const l=od(r,i,o,a),c=f=>l[0]*Math.pow(f,l[1]);return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:kl(e,t,n,s,c)}}function F2(e,t,n){const[r,i,o,a]=mp(e,t,n),s=r.length;let u=0,l=0,c=0,f=0,d=0,h,g,p,m;for(h=0;h<s;)g=r[h],p=i[h++],m=g*g,u+=(m-u)/h,l+=(m*g-l)/h,c+=(m*m-c)/h,f+=(g*p-f)/h,d+=(m*p-d)/h;const y=c-u*u,v=u*y-l*l,b=(d*u-f*l)/v,x=(f*y-d*l)/v,w=-b*u,E=_=>(_=_-o,b*_*_+x*_+w+a);return{coef:[w-x*o+b*o*o+a,x-2*b*o,b],predict:E,rSquared:kl(e,t,n,a,E)}}function L5(e,t,n,r){if(r===1)return O2(e,t,n);if(r===2)return F2(e,t,n);const[i,o,a,s]=mp(e,t,n),u=i.length,l=[],c=[],f=r+1;let d,h,g,p,m;for(d=0;d<f;++d){for(g=0,p=0;g<u;++g)p+=Math.pow(i[g],d)*o[g];for(l.push(p),m=new Float64Array(f),h=0;h<f;++h){for(g=0,p=0;g<u;++g)p+=Math.pow(i[g],d+h);m[h]=p}c.push(m)}c.push(l);const y=wte(c),v=b=>{b-=a;let x=s+y[0]+y[1]*b+y[2]*b*b;for(d=3;d<f;++d)x+=y[d]*Math.pow(b,d);return x};return{coef:xte(f,y,-a,s),predict:v,rSquared:kl(e,t,n,s,v)}}function xte(e,t,n,r){const i=Array(e);let o,a,s,u;for(o=0;o<e;++o)i[o]=0;for(o=e-1;o>=0;--o)for(s=t[o],u=1,i[o]+=s,a=1;a<=o;++a)u*=(o+1-a)/a,i[o-a]+=s*Math.pow(n,a)*u;return i[0]+=r,i}function wte(e){const t=e.length-1,n=[];let r,i,o,a,s;for(r=0;r<t;++r){for(a=r,i=r+1;i<t;++i)Math.abs(e[r][i])>Math.abs(e[r][a])&&(a=i);for(o=r;o<t+1;++o)s=e[o][r],e[o][r]=e[o][a],e[o][a]=s;for(i=r+1;i<t;++i)for(o=t;o>=r;o--)e[o][i]-=e[o][r]*e[r][i]/e[r][r]}for(i=t-1;i>=0;--i){for(s=0,o=i+1;o<t;++o)s+=e[o][i]*n[o];n[i]=(e[t][i]-s)/e[i][i]}return n}const j5=2,I5=1e-12;function B5(e,t,n,r){const[i,o,a,s]=mp(e,t,n,!0),u=i.length,l=Math.max(2,~~(r*u)),c=new Float64Array(u),f=new Float64Array(u),d=new Float64Array(u).fill(1);for(let h=-1;++h<=j5;){const g=[0,l-1];for(let m=0;m<u;++m){const y=i[m],v=g[0],b=g[1],x=y-i[v]>i[b]-y?v:b;let w=0,E=0,_=0,S=0,C=0;const O=1/Math.abs(i[x]-y||1);for(let F=v;F<=b;++F){const N=i[F],A=o[F],k=_te(Math.abs(y-N)*O)*d[F],T=N*k;w+=k,E+=T,_+=A*k,S+=A*T,C+=N*T}const[$,M]=od(E/w,_/w,S/w,C/w);c[m]=$+M*y,f[m]=Math.abs(o[m]-c[m]),Ete(i,m+1,g)}if(h===j5)break;const p=hte(f);if(Math.abs(p)<I5)break;for(let m=0,y,v;m<u;++m)y=f[m]/(6*p),d[m]=y>=1?I5:(v=1-y*y)*v}return $te(i,c,a,s)}function _te(e){return(e=1-e*e*e)*e*e}function Ete(e,t,n){const r=e[t];let i=n[0],o=n[1]+1;if(!(o>=e.length))for(;t>i&&e[o]-r<=r-e[i];)n[0]=++i,n[1]=o,++o}function $te(e,t,n,r){const i=e.length,o=[];let a=0,s=0,u=[],l;for(;a<i;++a)l=e[a]+n,u[0]===l?u[1]+=(t[a]-u[1])/++s:(s=0,u[1]+=r,u=[l,t[a]],o.push(u));return u[1]+=r,o}const Ate=.5*Math.PI/180;function yp(e,t,n,r){n=n||25,r=Math.max(n,r||200);const i=p=>[p,e(p)],o=t[0],a=t[1],s=a-o,u=s/r,l=[i(o)],c=[];if(n===r){for(let p=1;p<r;++p)l.push(i(o+p/n*s));return l.push(i(a)),l}else{c.push(i(a));for(let p=n;--p>0;)c.push(i(o+p/n*s))}let f=l[0],d=c[c.length-1];const h=1/s,g=Ste(f[1],c);for(;d;){const p=i((f[0]+d[0])/2);p[0]-f[0]>=u&&Cte(f,p,d,h,g)>Ate?c.push(p):(f=d,l.push(d),c.pop()),d=c[c.length-1]}return l}function Ste(e,t){let n=e,r=e;const i=t.length;for(let o=0;o<i;++o){const a=t[o][1];a<n&&(n=a),a>r&&(r=a)}return 1/(r-n)}function Cte(e,t,n,r,i){const o=Math.atan2(i*(n[1]-e[1]),r*(n[0]-e[0])),a=Math.atan2(i*(t[1]-e[1]),r*(t[0]-e[0]));return Math.abs(o-a)}function z5(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Ote(e){let t=e,n=e;e.length===1&&(t=(a,s)=>e(a)-s,n=Fte(e));function r(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)<0?u=c+1:l=c}return u}function i(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)>0?l=c:u=c+1}return u}function o(a,s,u,l){u==null&&(u=0),l==null&&(l=a.length);const c=r(a,s,u,l-1);return c>u&&t(a[c-1],s)>-t(a[c],s)?c-1:c}return{left:r,center:o,right:i}}function Fte(e){return(t,n)=>z5(e(t),n)}function*kte(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(r=+r)>=r&&(yield r)}}function k2(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function M2(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function U5(e,t,n=0,r=e.length-1,i=z5){for(;r>n;){if(r-n>600){const u=r-n+1,l=t-n+1,c=Math.log(u),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(u-f)/u)*(l-u/2<0?-1:1),h=Math.max(n,Math.floor(t-l*f/u+d)),g=Math.min(r,Math.floor(t+(u-l)*f/u+d));U5(e,t,h,g,i)}const o=e[t];let a=n,s=r;for(sd(e,n,t),i(e[r],o)>0&&sd(e,n,r);a<s;){for(sd(e,a,s),++a,--s;i(e[a],o)<0;)++a;for(;i(e[s],o)>0;)--s}i(e[n],o)===0?sd(e,n,s):(++s,sd(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function sd(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function Mte(e,t,n){if(e=Float64Array.from(kte(e,n)),!!(r=e.length)){if((t=+t)<=0||r<2)return M2(e);if(t>=1)return k2(e);var r,i=(r-1)*t,o=Math.floor(i),a=k2(U5(e,o).subarray(0,o+1)),s=M2(e.subarray(o+1));return a+(s-a)*(i-o)}}function Dte(e,t){let n=0,r=0;if(t===void 0)for(let i of e)i!=null&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let o of e)(o=t(o,++i,e))!=null&&(o=+o)>=o&&(++n,r+=o)}if(n)return r/n}function Nte(e,t){return Mte(e,.5,t)}function q5(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(i);++r<i;)o[r]=e+r*n;return o}function Tte(e){return t=>{const n=e.length;let r=1,i=String(e[0](t));for(;r<n;++r)i+="|"+e[r](t);return i}}function D2(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:Tte(e)}function H5(e,t,n){return n||e+(t?"_"+t:"")}const N2=()=>{},Rte={init:N2,add:N2,rem:N2,idx:0},ud={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.sum,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||e.min===void 0)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||e.max===void 0)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},ld=Object.keys(ud);function Pte(e,t){return n=>pe({name:e,out:n||e},Rte,t)}ld.forEach(e=>{ud[e]=Pte(e,ud[e])});function W5(e,t){return ud[e](t)}function G5(e,t){return e.idx-t.idx}function Lte(e){const t={};e.forEach(r=>t[r.name]=r);const n=r=>{!r.req||r.req.forEach(i=>{t[i]||n(t[i]=ud[i]())})};return e.forEach(n),Object.values(t).sort(G5)}function jte(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.init(this))}function Ite(e,t){if(e==null||e===""){++this.missing;return}e===e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t)))}function Bte(e,t){if(e==null||e===""){--this.missing;return}e===e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t)))}function zte(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function Y5(e,t){const n=t||En,r=Lte(e),i=e.slice().sort(G5);function o(a){this._ops=r,this._out=i,this.cell=a,this.init()}return o.prototype.init=jte,o.prototype.add=Ite,o.prototype.rem=Bte,o.prototype.set=zte,o.prototype.get=n,o.fields=e.map(a=>a.out),o}function T2(e){this._key=e?Hn(e):te,this.reset()}const Vt=T2.prototype;Vt.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null};Vt.add=function(e){this._add.push(e)};Vt.rem=function(e){this._rem.push(e)};Vt.values=function(){if(this._get=null,this._rem.length===0)return this._add;const e=this._add,t=this._rem,n=this._key,r=e.length,i=t.length,o=Array(r-i),a={};let s,u,l;for(s=0;s<i;++s)a[n(t[s])]=1;for(s=0,u=0;s<r;++s)a[n(l=e[s])]?a[n(l)]=0:o[u++]=l;return this._rem=[],this._add=o};Vt.distinct=function(e){const t=this.values(),n={};let r=t.length,i=0,o;for(;--r>=0;)o=e(t[r])+"",se(n,o)||(n[o]=1,++i);return i};Vt.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=EM(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext};Vt.argmin=function(e){return this.extent(e)[0]||{}};Vt.argmax=function(e){return this.extent(e)[1]||{}};Vt.min=function(e){const t=this.extent(e)[0];return t!=null?e(t):void 0};Vt.max=function(e){const t=this.extent(e)[1];return t!=null?e(t):void 0};Vt.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=p2(this.values(),e),this._get=e),this._q};Vt.q1=function(e){return this.quartile(e)[0]};Vt.q2=function(e){return this.quartile(e)[1]};Vt.q3=function(e){return this.quartile(e)[2]};Vt.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=O5(this.values(),1e3,.05,e),this._get=e),this._ci};Vt.ci0=function(e){return this.ci(e)[0]};Vt.ci1=function(e){return this.ci(e)[1]};function Oa(e){R.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}Oa.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:ld},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};H(Oa,R,{transform(e,t){const n=this,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.modified();return n.stamp=r.stamp,n.value&&(i||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(e):{},t.visit(t.SOURCE,o=>n.add(o))):(n.value=n.value||n.init(e),t.visit(t.REM,o=>n.rem(o)),t.visit(t.ADD,o=>n.add(o))),r.modifies(n._outputs),n._drop=e.drop!==!1,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&r.clean(!0).runAfter(()=>this.clean()),n.changes(r)},cross(){const e=this,t=e.value,n=e._dnames,r=n.map(()=>({})),i=n.length;function o(s){let u,l,c,f;for(u in s)for(c=s[u].tuple,l=0;l<i;++l)r[l][f=c[n[l]]]=f}o(e._prev),o(t);function a(s,u,l){const c=n[l],f=r[l++];for(const d in f){const h=s?s+"|"+d:d;u[c]=f[d],l<i?a(h,u,l):t[h]||e.cell(h,u)}}a("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],r={};function i(m){const y=ae(tn(m)),v=y.length;let b=0,x;for(;b<v;++b)r[x=y[b]]||(r[x]=1,t.push(x))}this._dims=ae(e.groupby),this._dnames=this._dims.map(m=>{const y=ft(m);return i(m),n.push(y),y}),this.cellkey=e.key?e.key:D2(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const o=e.fields||[null],a=e.ops||["count"],s=e.as||[],u=o.length,l={};let c,f,d,h,g,p;for(u!==a.length&&B("Unmatched number of fields and aggregate ops."),p=0;p<u;++p){if(c=o[p],f=a[p],c==null&&f!=="count"&&B("Null aggregate field specified."),h=ft(c),g=H5(f,h,s[p]),n.push(g),f==="count"){this._counts.push(g);continue}d=l[h],d||(i(c),d=l[h]=[],d.field=c,this._measures.push(d)),f!=="count"&&(this._countOnly=!1),d.push(W5(f,g))}return this._measures=this._measures.map(m=>Y5(m,m.field)),{}},cellkey:D2(),cell(e,t){let n=this.value[e];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const r=this._measures,i=r.length;n.agg=Array(i);for(let o=0;o<i;++o)n.agg[o]=new r[o](n)}return n.store&&(n.data=new T2),n},newtuple(e,t){const n=this._dnames,r=this._dims,i=r.length,o={};for(let a=0;a<i;++a)o[n[a]]=r[a](e);return t?f5(t.tuple,o):Ie(o)},clean(){const e=this.value;for(const t in e)e[t].num===0&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].add(r[i].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].rem(r[i].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let r=0,i=n.length;r<i;++r)t[n[r]]=e.num;if(!this._countOnly){const r=e.agg;for(let i=0,o=r.length;i<o;++i)r[i].set(t)}return t},changes(e){const t=this._adds,n=this._mods,r=this._prev,i=this._drop,o=e.add,a=e.rem,s=e.mod;let u,l,c,f;if(r)for(l in r)u=r[l],(!i||u.num)&&a.push(u.tuple);for(c=0,f=this._alen;c<f;++c)o.push(this.celltuple(t[c])),t[c]=null;for(c=0,f=this._mlen;c<f;++c)u=n[c],(u.num===0&&i?a:s).push(this.celltuple(u)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}});const Ute=1e-14;function R2(e){R.call(this,null,e)}R2.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};H(R2,R,{transform(e,t){const n=e.interval!==!1,r=this._bins(e),i=r.start,o=r.step,a=e.as||["bin0","bin1"],s=a[0],u=a[1];let l;return e.modified()?(t=t.reflow(!0),l=t.SOURCE):l=t.modified(tn(e.field))?t.ADD_MOD:t.ADD,t.visit(l,n?c=>{const f=r(c);c[s]=f,c[u]=f==null?null:i+o*(1+(f-i)/o)}:c=>c[s]=r(c)),t.modifies(n?a:s)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=C5(e),r=n.step;let i=n.start,o=i+Math.ceil((n.stop-i)/r)*r,a,s;(a=e.anchor)!=null&&(s=a-(i+r*Math.floor((a-i)/r)),i+=s,o+=s);const u=function(l){let c=nn(t(l));return c==null?null:c<i?-1/0:c>o?1/0:(c=Math.max(i,Math.min(c,o-r)),i+r*Math.floor(Ute+(c-i)/r))};return u.start=i,u.stop=n.stop,u.step=r,this.value=qn(u,tn(t),e.name||"bin_"+ft(t))}});function V5(e,t,n){const r=e;let i=t||[],o=n||[],a={},s=0;return{add:u=>o.push(u),remove:u=>a[r(u)]=++s,size:()=>i.length,data:(u,l)=>(s&&(i=i.filter(c=>!a[r(c)]),a={},s=0),l&&u&&i.sort(u),o.length&&(i=u?FM(u,i,o.sort(u)):i.concat(o),o=[]),i)}}function P2(e){R.call(this,[],e)}P2.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]};H(P2,R,{transform(e,t){const n=t.fork(t.ALL),r=V5(te,this.value,n.materialize(n.ADD).add),i=e.sort,o=t.changed()||i&&(e.modified("sort")||t.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(o),this.value=n.source=r.data(zs(i),o),t.source&&t.source.root&&(this.value.root=t.source.root),n}});function X5(e){Ve.call(this,null,qte,e)}H(X5,Ve);function qte(e){return this.value&&!e.modified()?this.value:_x(e.fields,e.orders)}function L2(e){R.call(this,null,e)}L2.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function Hte(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}H(L2,R,{transform(e,t){const n=f=>d=>{for(var h=Hte(s(d),e.case,o)||[],g,p=0,m=h.length;p<m;++p)a.test(g=h[p])||f(g)},r=this._parameterCheck(e,t),i=this._counts,o=this._match,a=this._stop,s=e.field,u=e.as||["text","count"],l=n(f=>i[f]=1+(i[f]||0)),c=n(f=>i[f]-=1);return r?t.visit(t.SOURCE,l):(t.visit(t.ADD,l),t.visit(t.REM,c)),this._finish(t,u)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,r=this._tuples||(this._tuples={}),i=t[0],o=t[1],a=e.fork(e.NO_SOURCE|e.NO_FIELDS);let s,u,l;for(s in n)u=r[s],l=n[s]||0,!u&&l?(r[s]=u=Ie({}),u[i]=s,u[o]=l,a.add.push(u)):l===0?(u&&a.rem.push(u),n[s]=null,r[s]=null):u[o]!==l&&(u[o]=l,a.mod.push(u));return a.modifies(t)}});function j2(e){R.call(this,null,e)}j2.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]};H(j2,R,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.as||["a","b"],i=r[0],o=r[1],a=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let s=this.value;return a?(s&&(n.rem=s),s=t.materialize(t.SOURCE).source,n.add=this.value=Wte(s,i,o,e.filter||Dr)):n.mod=s,n.source=this.value,n.modifies(r)}});function Wte(e,t,n,r){for(var i=[],o={},a=e.length,s=0,u,l;s<a;++s)for(o[t]=l=e[s],u=0;u<a;++u)o[n]=e[u],r(o)&&(i.push(Ie(o)),o={},o[t]=l);return i}const K5={kde:b2,mixture:D5,normal:v2,lognormal:M5,uniform:N5},Gte="distributions",Z5="function",Yte="field";function J5(e,t){const n=e[Z5];se(K5,n)||B("Unknown distribution function: "+n);const r=K5[n]();for(const i in e)i===Yte?r.data((e.from||t()).map(e[i])):i===Gte?r[i](e[i].map(o=>J5(o,t))):typeof r[i]===Z5&&r[i](e[i]);return r}function I2(e){R.call(this,null,e)}const Q5=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],Vte={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:Q5},{name:"weights",type:"number",array:!0}]};I2.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:Q5.concat(Vte)},{name:"as",type:"string",array:!0,default:["value","density"]}]};H(I2,R,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=J5(e.distribution,Xte(t)),i=e.steps||e.minsteps||25,o=e.steps||e.maxsteps||200;let a=e.method||"pdf";a!=="pdf"&&a!=="cdf"&&B("Invalid density method: "+a),!e.extent&&!r.data&&B("Missing density extent parameter."),a=r[a];const s=e.as||["value","density"],u=e.extent||ji(r.data()),l=yp(a,u,i,o).map(c=>{const f={};return f[s[0]]=c[0],f[s[1]]=c[1],Ie(f)});this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function Xte(e){return()=>e.materialize(e.SOURCE).source}function eN(e,t){return e?e.map((n,r)=>t[r]||ft(n)):null}function B2(e,t,n){const r=[],i=f=>f(u);let o,a,s,u,l,c;if(t==null)r.push(e.map(n));else for(o={},a=0,s=e.length;a<s;++a)u=e[a],l=t.map(i),c=o[l],c||(o[l]=c=[],c.dims=l,r.push(c)),c.push(n(u));return r}const tN="bin";function z2(e){R.call(this,null,e)}z2.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:tN}]};const Kte=(e,t)=>Tf(ji(e,t))/30;H(z2,R,{transform(e,t){if(this.value&&!(e.modified()||t.changed()))return t;const n=t.materialize(t.SOURCE).source,r=B2(t.source,e.groupby,En),i=e.smooth||!1,o=e.field,a=e.step||Kte(n,o),s=zs((g,p)=>o(g)-o(p)),u=e.as||tN,l=r.length;let c=1/0,f=-1/0,d=0,h;for(;d<l;++d){const g=r[d].sort(s);h=-1;for(const p of F5(g,a,i,o))p<c&&(c=p),p>f&&(f=p),g[++h][u]=p}return this.value={start:c,stop:f,step:a},t.reflow(!0).modifies(u)}});function nN(e){Ve.call(this,null,Zte,e),this.modified(!0)}H(nN,Ve);function Zte(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:qn(n=>t(n,e),tn(t),ft(t))}function U2(e){R.call(this,[void 0,void 0],e)}U2.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]};H(U2,R,{transform(e,t){const n=this.value,r=e.field,i=t.changed()||t.modified(r.fields)||e.modified("field");let o=n[0],a=n[1];if((i||o==null)&&(o=1/0,a=-1/0),t.visit(i?t.SOURCE:t.ADD,s=>{const u=nn(r(s));u!=null&&(u<o&&(o=u),u>a&&(a=u))}),!Number.isFinite(o)||!Number.isFinite(a)){let s=ft(r);s&&(s=` for field "${s}"`),t.dataflow.warn(`Infinite extent${s}: [${o}, ${a}]`),o=a=void 0}this.value=[o,a]}});function q2(e,t){Ve.call(this,e),this.parent=t,this.count=0}H(q2,Ve,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}});function vp(e){R.call(this,{},e),this._keys=xl();const t=this._targets=[];t.active=0,t.forEach=n=>{for(let r=0,i=t.active;r<i;++r)n(t[r],r,t)}}H(vp,R,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,r){const i=this.value;let o=se(i,e)&&i[e],a,s;return o?o.value.stamp<n.stamp&&(o.init(n),this.activate(o)):(s=r||(s=this._group[e])&&s.tuple,a=n.dataflow,o=new q2(n.fork(n.NO_SOURCE),this),a.add(o).connect(t(a,e,s)),i[e]=o,this.activate(o)),o},clean(){const e=this.value;let t=0;for(const n in e)if(e[n].count===0){const r=e[n].detachSubflow;r&&r(),delete e[n],++t}if(t){const n=this._targets.filter(r=>r&&r.count>0);this.initTargets(n)}},initTargets(e){const t=this._targets,n=t.length,r=e?e.length:0;let i=0;for(;i<r;++i)t[i]=e[i];for(;i<n&&t[i]!=null;++i)t[i]=null;t.active=r},transform(e,t){const n=t.dataflow,r=e.key,i=e.subflow,o=this._keys,a=e.modified("key"),s=u=>this.subflow(u,i,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,u=>{const l=te(u),c=o.get(l);c!==void 0&&(o.delete(l),s(c).rem(u))}),t.visit(t.ADD,u=>{const l=r(u);o.set(te(u),l),s(l).add(u)}),a||t.modified(r.fields)?t.visit(t.MOD,u=>{const l=te(u),c=o.get(l),f=r(u);c===f?s(f).mod(u):(o.set(l,f),s(c).rem(u),s(f).add(u))}):t.changed(t.MOD)&&t.visit(t.MOD,u=>{s(o.get(te(u))).mod(u)}),a&&t.visit(t.REFLOW,u=>{const l=te(u),c=o.get(l),f=r(u);c!==f&&(o.set(l,f),s(c).rem(u),s(f).add(u))}),t.clean()?n.runAfter(()=>{this.clean(),o.clean()}):o.empty>n.cleanThreshold&&n.runAfter(o.clean),t}});function rN(e){Ve.call(this,null,Jte,e)}H(rN,Ve);function Jte(e){return this.value&&!e.modified()?this.value:ee(e.name)?ae(e.name).map(t=>Hn(t)):Hn(e.name,e.as)}function H2(e){R.call(this,xl(),e)}H2.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]};H(H2,R,{transform(e,t){const n=t.dataflow,r=this.value,i=t.fork(),o=i.add,a=i.rem,s=i.mod,u=e.expr;let l=!0;t.visit(t.REM,f=>{const d=te(f);r.has(d)?r.delete(d):a.push(f)}),t.visit(t.ADD,f=>{u(f,e)?o.push(f):r.set(te(f),1)});function c(f){const d=te(f),h=u(f,e),g=r.get(d);h&&g?(r.delete(d),o.push(f)):!h&&!g?(r.set(d,1),a.push(f)):l&&h&&!g&&s.push(f)}return t.visit(t.MOD,c),e.modified()&&(l=!1,t.visit(t.REFLOW,c)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}});function W2(e){R.call(this,[],e)}W2.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]};H(W2,R,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=eN(r,e.as||[]),o=e.index||null,a=i.length;return n.rem=this.value,t.visit(t.SOURCE,s=>{const u=r.map(g=>g(s)),l=u.reduce((g,p)=>Math.max(g,p.length),0);let c=0,f,d,h;for(;c<l;++c){for(d=u2(s),f=0;f<a;++f)d[i[f]]=(h=u[f][c])==null?null:h;o&&(d[o]=c),n.add.push(d)}}),this.value=n.source=n.add,o&&n.modifies(o),n.modifies(i)}});function G2(e){R.call(this,[],e)}G2.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]};H(G2,R,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=r.map(ft),o=e.as||["key","value"],a=o[0],s=o[1],u=r.length;return n.rem=this.value,t.visit(t.SOURCE,l=>{for(let c=0,f;c<u;++c)f=u2(l),f[a]=i[c],f[s]=r[c](l),n.add.push(f)}),this.value=n.source=n.add,n.modifies(o)}});function Y2(e){R.call(this,null,e)}Y2.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]};H(Y2,R,{transform(e,t){const n=e.expr,r=e.as,i=e.modified(),o=e.initonly?t.ADD:i?t.SOURCE:t.modified(n.fields)||t.modified(r)?t.ADD_MOD:t.ADD;return i&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(r),t.visit(o,a=>a[r]=n(a,e))}});function iN(e){R.call(this,[],e)}H(iN,R,{transform(e,t){const n=t.fork(t.ALL),r=e.generator;let i=this.value,o=e.size-i.length,a,s,u;if(o>0){for(a=[];--o>=0;)a.push(u=Ie(r(e))),i.push(u);n.add=n.add.length?n.materialize(n.ADD).add.concat(a):a}else s=i.slice(0,-o),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(s):s,i=i.slice(-o);return n.source=this.value=i,n}});const bp={value:"value",median:Nte,mean:Dte,min:M2,max:k2},Qte=[];function V2(e){R.call(this,[],e)}V2.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function ene(e){var t=e.method||bp.value,n;if(bp[t]==null)B("Unrecognized imputation method: "+t);else return t===bp.value?(n=e.value!==void 0?e.value:0,()=>n):bp[t]}function tne(e){const t=e.field;return n=>n?t(n):NaN}H(V2,R,{transform(e,t){var n=t.fork(t.ALL),r=ene(e),i=tne(e),o=ft(e.field),a=ft(e.key),s=(e.groupby||[]).map(ft),u=nne(t.source,e.groupby,e.key,e.keyvals),l=[],c=this.value,f=u.domain.length,d,h,g,p,m,y,v,b,x,w;for(m=0,b=u.length;m<b;++m)for(d=u[m],g=d.values,h=NaN,v=0;v<f;++v)if(d[v]==null){for(p=u.domain[v],w={_impute:!0},y=0,x=g.length;y<x;++y)w[s[y]]=g[y];w[a]=p,w[o]=Number.isNaN(h)?h=r(d,i):h,l.push(Ie(w))}return l.length&&(n.add=n.materialize(n.ADD).add.concat(l)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=l,n}});function nne(e,t,n,r){var i=y=>y(m),o=[],a=r?r.slice():[],s={},u={},l,c,f,d,h,g,p,m;for(a.forEach((y,v)=>s[y]=v+1),d=0,p=e.length;d<p;++d)m=e[d],g=n(m),h=s[g]||(s[g]=a.push(g)),c=(l=t?t.map(i):Qte)+"",(f=u[c])||(f=u[c]=[],o.push(f),f.values=l),f[h-1]=m;return o.domain=a,o}function X2(e){Oa.call(this,e)}X2.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:ld},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};H(X2,Oa,{transform(e,t){const n=this,r=e.modified();let i;return n.value&&(r||t.modified(n._inputs,!0))?(i=n.value=r?n.init(e):{},t.visit(t.SOURCE,o=>n.add(o))):(i=n.value=n.value||this.init(e),t.visit(t.REM,o=>n.rem(o)),t.visit(t.ADD,o=>n.add(o))),n.changes(),t.visit(t.SOURCE,o=>{pe(o,i[n.cellkey(o)].tuple)}),t.reflow(r).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(e[n]),e[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}});function K2(e){R.call(this,null,e)}K2.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]};H(K2,R,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=B2(r,e.groupby,e.field),o=(e.groupby||[]).map(ft),a=e.bandwidth,s=e.cumulative?"cdf":"pdf",u=e.as||["value","density"],l=[];let c=e.extent,f=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;s!=="pdf"&&s!=="cdf"&&B("Invalid density method: "+s),e.resolve==="shared"&&(c||(c=ji(r,e.field)),f=d=e.steps||d),i.forEach(h=>{const g=b2(h,a)[s],p=e.counts?h.length:1,m=c||ji(h);yp(g,m,f,d).forEach(y=>{const v={};for(let b=0;b<o.length;++b)v[o[b]]=h.dims[b];v[u[0]]=y[0],v[u[1]]=y[1]*p,l.push(Ie(v))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function oN(e){Ve.call(this,null,rne,e)}H(oN,Ve);function rne(e){return this.value&&!e.modified()?this.value:Ax(e.fields,e.flat)}function aN(e){R.call(this,[],e),this._pending=null}H(aN,R,{transform(e,t){const n=t.dataflow;return this._pending?Z2(this,t,this._pending):ine(e)?t.StopPropagation:e.values?Z2(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(i=>(this._pending=ae(i.data),o=>o.touch(this)))}:n.request(e.url,e.format).then(r=>Z2(this,t,ae(r.data)))}});function ine(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function Z2(e,t,n){n.forEach(Ie);const r=t.fork(t.NO_FIELDS&t.NO_SOURCE);return r.rem=e.value,e.value=r.source=r.add=n,e._pending=null,r.rem.length&&r.clean(!0),r}function J2(e){R.call(this,{},e)}J2.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]};H(J2,R,{transform(e,t){const n=e.fields,r=e.index,i=e.values,o=e.default==null?null:e.default,a=e.modified(),s=n.length;let u=a?t.SOURCE:t.ADD,l=t,c=e.as,f,d,h;return i?(d=i.length,s>1&&!c&&B('Multi-field lookup requires explicit "as" parameter.'),c&&c.length!==s*d&&B('The "as" parameter has too few output field names.'),c=c||i.map(ft),f=function(g){for(var p=0,m=0,y,v;p<s;++p)if(v=r.get(n[p](g)),v==null)for(y=0;y<d;++y,++m)g[c[m]]=o;else for(y=0;y<d;++y,++m)g[c[m]]=i[y](v)}):(c||B("Missing output field names."),f=function(g){for(var p=0,m;p<s;++p)m=r.get(n[p](g)),g[c[p]]=m==null?o:m}),a?l=t.reflow(!0):(h=n.some(g=>t.modified(g.fields)),u|=h?t.MOD:0),t.visit(u,f),l.modifies(c)}});function sN(e){Ve.call(this,null,one,e)}H(sN,Ve);function one(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let r=1/0,i=-1/0,o,a;for(o=0;o<n;++o)a=t[o],a[0]<r&&(r=a[0]),a[1]>i&&(i=a[1]);return[r,i]}function uN(e){Ve.call(this,null,ane,e)}H(uN,Ve);function ane(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function lN(e){R.call(this,null,e)}H(lN,R,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Q2(e){Oa.call(this,e)}Q2.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:ld,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};H(Q2,Oa,{_transform:Oa.prototype.transform,transform(e,t){return this._transform(sne(e,t),t)}});function sne(e,t){const n=e.field,r=e.value,i=(e.op==="count"?"__count__":e.op)||"sum",o=tn(n).concat(tn(r)),a=lne(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:a.map(()=>i),fields:a.map(s=>une(s,n,r,o)),as:a.map(s=>s+""),modified:e.modified.bind(e)}}function une(e,t,n,r){return qn(i=>t(i)===e?n(i):NaN,r,e+"")}function lne(e,t,n){const r={},i=[];return n.visit(n.SOURCE,o=>{const a=e(o);r[a]||(r[a]=1,i.push(a))}),i.sort(Yg),t?i.slice(0,t):i}function cN(e){vp.call(this,e)}H(cN,vp,{transform(e,t){const n=e.subflow,r=e.field,i=o=>this.subflow(te(o),n,t,o);return(e.modified("field")||r&&t.modified(tn(r)))&&B("PreFacet does not support field modification."),this.initTargets(),r?(t.visit(t.MOD,o=>{const a=i(o);r(o).forEach(s=>a.mod(s))}),t.visit(t.ADD,o=>{const a=i(o);r(o).forEach(s=>a.add(Ie(s)))}),t.visit(t.REM,o=>{const a=i(o);r(o).forEach(s=>a.rem(s))})):(t.visit(t.MOD,o=>i(o).mod(o)),t.visit(t.ADD,o=>i(o).add(o)),t.visit(t.REM,o=>i(o).rem(o))),t.clean()&&t.runAfter(()=>this.clean()),t}});function ew(e){R.call(this,null,e)}ew.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]};H(ew,R,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=eN(e.fields,e.as||[]),o=r?(s,u)=>cne(s,u,r,i):sp;let a;return this.value?a=this.value:(t=t.addAll(),a=this.value={}),t.visit(t.REM,s=>{const u=te(s);n.rem.push(a[u]),a[u]=null}),t.visit(t.ADD,s=>{const u=o(s,Ie({}));a[te(s)]=u,n.add.push(u)}),t.visit(t.MOD,s=>{n.mod.push(o(s,a[te(s)]))}),n}});function cne(e,t,n,r){for(let i=0,o=n.length;i<o;++i)t[r[i]]=n[i](e);return t}function fN(e){R.call(this,null,e)}H(fN,R,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function tw(e){R.call(this,null,e)}tw.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const fne=1e-14;H(tw,R,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const i=t.materialize(t.SOURCE).source,o=B2(i,e.groupby,e.field),a=(e.groupby||[]).map(ft),s=[],u=e.step||.01,l=e.probs||q5(u/2,1-fne,u),c=l.length;return o.forEach(f=>{const d=g2(f,l);for(let h=0;h<c;++h){const g={};for(let p=0;p<a.length;++p)g[a[p]]=f.dims[p];g[r[0]]=l[h],g[r[1]]=d[h],s.push(Ie(g))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=s,n}});function dN(e){R.call(this,null,e)}H(dN,R,{transform(e,t){let n,r;return this.value?r=this.value:(n=t=t.addAll(),r=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,i=>{const o=te(i);n.rem.push(r[o]),r[o]=null}),t.visit(t.ADD,i=>{const o=u2(i);r[te(i)]=o,n.add.push(o)}),t.visit(t.MOD,i=>{const o=r[te(i)];for(const a in i)o[a]=i[a],n.modifies(a);n.mod.push(o)})),n}});function nw(e){R.call(this,[],e),this.count=0}nw.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};H(nw,R,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.modified("size"),i=e.size,o=this.value.reduce((c,f)=>(c[te(f)]=1,c),{});let a=this.value,s=this.count,u=0;function l(c){let f,d;a.length<i?a.push(c):(d=~~((s+1)*Tr()),d<a.length&&d>=u&&(f=a[d],o[te(f)]&&n.rem.push(f),a[d]=c)),++s}if(t.rem.length&&(t.visit(t.REM,c=>{const f=te(c);o[f]&&(o[f]=-1,n.rem.push(c)),--s}),a=a.filter(c=>o[te(c)]!==-1)),(t.rem.length||r)&&a.length<i&&t.source&&(u=s=a.length,t.visit(t.SOURCE,c=>{o[te(c)]||l(c)}),u=-1),r&&a.length>i){const c=a.length-i;for(let f=0;f<c;++f)o[te(a[f])]=-1,n.rem.push(a[f]);a=a.slice(c)}return t.mod.length&&t.visit(t.MOD,c=>{o[te(c)]&&n.mod.push(c)}),t.add.length&&t.visit(t.ADD,l),(t.add.length||u<0)&&(n.add=a.filter(c=>!o[te(c)])),this.count=s,this.value=n.source=a,n}});function rw(e){R.call(this,null,e)}rw.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};H(rw,R,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),r=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=q5(e.start,e.stop,e.step||1).map(i=>{const o={};return o[r]=i,Ie(o)}),n.add=t.add.concat(this.value),n}});function hN(e){R.call(this,null,e),this.modified(!0)}H(hN,R,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function iw(e){R.call(this,null,e)}const gN=["unit0","unit1"];iw.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:Lx,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:gN}]};H(iw,R,{transform(e,t){const n=e.field,r=e.interval!==!1,i=e.timezone==="utc",o=this._floor(e,t),a=(i?Al:$l)(o.unit).offset,s=e.as||gN,u=s[0],l=s[1],c=o.step;let f=o.start||1/0,d=o.stop||-1/0,h=t.ADD;return(e.modified()||t.modified(tn(n)))&&(t=t.reflow(!0),h=t.SOURCE,f=1/0,d=-1/0),t.visit(h,g=>{const p=n(g);let m,y;p==null?(g[u]=null,r&&(g[l]=null)):(g[u]=m=y=o(p),r&&(g[l]=y=a(m,c)),m<f&&(f=m),y>d&&(d=y))}),o.start=f,o.stop=d,t.modifies(r?s:u)},_floor(e,t){const n=e.timezone==="utc",{units:r,step:i}=e.units?{units:e.units,step:e.step||1}:_D({extent:e.extent||ji(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),o=Ix(r),a=this.value||{},s=(n?fD:cD)(o,i);return s.unit=Se(o),s.units=o,s.step=i,s.start=a.start,s.stop=a.stop,this.value=s}});function pN(e){R.call(this,xl(),e)}H(pN,R,{transform(e,t){const n=t.dataflow,r=e.field,i=this.value,o=s=>i.set(r(s),s);let a=!0;return e.modified("field")||t.modified(r.fields)?(i.clear(),t.visit(t.SOURCE,o)):t.changed()?(t.visit(t.REM,s=>i.delete(r(s))),t.visit(t.ADD,o)):a=!1,this.modified(a),i.empty>n.cleanThreshold&&n.runAfter(i.clean),t.fork()}});function mN(e){R.call(this,null,e)}H(mN,R,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(zs(e.sort)):t.source).map(e.field))}});function dne(e,t,n,r){const i=cd[e](t,n);return{init:i.init||ba,update:function(o,a){a[r]=i.next(o)}}}const cd={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?++e:e}}},percent_rank:function(){const e=cd.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,r=t.compare;let i=t.index;if(e<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;e=i}return(1+e)/n.length}}},ntile:function(e,t){t=+t,t>0||B("ntile num must be greater than zero.");const n=cd.cume_dist(),r=n.next;return{init:n.init,next:i=>Math.ceil(t*r(i))}},lag:function(e,t){return t=+t||1,{next:n=>{const r=n.index-t;return r>=0?e(n.data[r]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const r=n.index+t,i=n.data;return r<i.length?e(i[r]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return t=+t,t>0||B("nth_value nth must be greater than zero."),{next:n=>{const r=n.i0+(t-1);return r<n.i1?e(n.data[r]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const r=e(n.data[n.index]);return r!=null?t=r:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:r=>{const i=r.data;return r.index<=n?t:(n=hne(e,i,r.index))<0?(n=i.length,t=null):t=e(i[n])}}}};function hne(e,t,n){for(let r=t.length;n<r;++n)if(e(t[n])!=null)return n;return-1}const gne=Object.keys(cd);function yN(e){const t=ae(e.ops),n=ae(e.fields),r=ae(e.params),i=ae(e.as),o=this.outputs=[],a=this.windows=[],s={},u={},l=[],c=[];let f=!0;function d(h){ae(tn(h)).forEach(g=>s[g]=1)}d(e.sort),t.forEach((h,g)=>{const p=n[g],m=ft(p),y=H5(h,m,i[g]);if(d(p),o.push(y),se(cd,h))a.push(dne(h,n[g],r[g],y));else{if(p==null&&h!=="count"&&B("Null aggregate field specified."),h==="count"){l.push(y);return}f=!1;let v=u[m];v||(v=u[m]=[],v.field=p,c.push(v)),v.push(W5(h,y))}}),(l.length||c.length)&&(this.cell=pne(c,l,f)),this.inputs=Object.keys(s)}const vN=yN.prototype;vN.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()};vN.update=function(e,t){const n=this.cell,r=this.windows,i=e.data,o=r&&r.length;let a;if(n){for(a=e.p0;a<e.i0;++a)n.rem(i[a]);for(a=e.p1;a<e.i1;++a)n.add(i[a]);n.set(t)}for(a=0;a<o;++a)r[a].update(e,t)};function pne(e,t,n){e=e.map(u=>Y5(u,u.field));const r={num:0,agg:null,store:!1,count:t};if(!n)for(var i=e.length,o=r.agg=Array(i),a=0;a<i;++a)o[a]=new e[a](r);if(r.store)var s=r.data=new T2;return r.add=function(u){if(r.num+=1,!n){s&&s.add(u);for(let l=0;l<i;++l)o[l].add(o[l].get(u),u)}},r.rem=function(u){if(r.num-=1,!n){s&&s.rem(u);for(let l=0;l<i;++l)o[l].rem(o[l].get(u),u)}},r.set=function(u){let l,c;for(s&&s.values(),l=0,c=t.length;l<c;++l)u[t[l]]=r.num;if(!n)for(l=0,c=o.length;l<c;++l)o[l].set(u)},r.init=function(){r.num=0,s&&s.reset();for(let u=0;u<i;++u)o[u].init()},r}function ow(e){R.call(this,{},e),this._mlen=0,this._mods=[]}ow.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:gne.concat(ld)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};H(ow,R,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),r=zs(e.sort),i=D2(e.groupby),o=s=>this.group(i(s));let a=this.state;(!a||n)&&(a=this.state=new yN(e)),n||t.modified(a.inputs)?(this.value={},t.visit(t.SOURCE,s=>o(s).add(s))):(t.visit(t.REM,s=>o(s).remove(s)),t.visit(t.ADD,s=>o(s).add(s)));for(let s=0,u=this._mlen;s<u;++s)mne(this._mods[s],a,r,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(a.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=V5(te),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});function mne(e,t,n,r){const i=r.sort,o=i&&!r.ignorePeers,a=r.frame||[null,0],s=e.data(n),u=s.length,l=o?Ote(i):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:s,compare:i||rn(-1)};t.init();for(let f=0;f<u;++f)yne(c,a,f,u),o&&vne(c,l),t.update(c,s[f])}function yne(e,t,n,r){e.p0=e.i0,e.p1=e.i1,e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0])),e.i1=t[1]==null?r:Math.min(r,n+Math.abs(t[1])+1),e.index=n}function vne(e,t){const n=e.i0,r=e.i1-1,i=e.compare,o=e.data,a=o.length-1;n>0&&!i(o[n],o[n-1])&&(e.i0=t.left(o,o[n])),r<a&&!i(o[r],o[r+1])&&(e.i1=t.right(o,o[r]))}var bne=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",aggregate:Oa,bin:R2,collect:P2,compare:X5,countpattern:L2,cross:j2,density:I2,dotbin:z2,expression:nN,extent:U2,facet:vp,field:rN,filter:H2,flatten:W2,fold:G2,formula:Y2,generate:iN,impute:V2,joinaggregate:X2,kde:K2,key:oN,load:aN,lookup:J2,multiextent:sN,multivalues:uN,params:lN,pivot:Q2,prefacet:cN,project:ew,proxy:fN,quantile:tw,relay:dN,sample:nw,sequence:rw,sieve:hN,subflow:q2,timeunit:iw,tupleindex:pN,values:mN,window:ow});const aw=Math.PI,sw=2*aw,qs=1e-6,xne=sw-qs;function uw(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Hs(){return new uw}uw.prototype=Hs.prototype={constructor:uw,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,i,o){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(e,t,n,r,i){e=+e,t=+t,n=+n,r=+r,i=+i;var o=this._x1,a=this._y1,s=n-e,u=r-t,l=o-e,c=a-t,f=l*l+c*c;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>qs)if(!(Math.abs(c*s-u*l)>qs)||!i)this._+="L"+(this._x1=e)+","+(this._y1=t);else{var d=n-o,h=r-a,g=s*s+u*u,p=d*d+h*h,m=Math.sqrt(g),y=Math.sqrt(f),v=i*Math.tan((aw-Math.acos((g+f-p)/(2*m*y)))/2),b=v/y,x=v/m;Math.abs(b-1)>qs&&(this._+="L"+(e+b*l)+","+(t+b*c)),this._+="A"+i+","+i+",0,0,"+ +(c*d>l*h)+","+(this._x1=e+x*s)+","+(this._y1=t+x*u)}},arc:function(e,t,n,r,i,o){e=+e,t=+t,n=+n,o=!!o;var a=n*Math.cos(r),s=n*Math.sin(r),u=e+a,l=t+s,c=1^o,f=o?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+u+","+l:(Math.abs(this._x1-u)>qs||Math.abs(this._y1-l)>qs)&&(this._+="L"+u+","+l),!!n&&(f<0&&(f=f%sw+sw),f>xne?this._+="A"+n+","+n+",0,1,"+c+","+(e-a)+","+(t-s)+"A"+n+","+n+",0,1,"+c+","+(this._x1=u)+","+(this._y1=l):f>qs&&(this._+="A"+n+","+n+",0,"+ +(f>=aw)+","+c+","+(this._x1=e+n*Math.cos(i))+","+(this._y1=t+n*Math.sin(i))))},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};function Be(e){return function(){return e}}var bN=Math.abs,sn=Math.atan2,Ws=Math.cos,wne=Math.max,lw=Math.min,zi=Math.sin,Ml=Math.sqrt,un=1e-12,Dl=Math.PI,xp=Dl/2,xN=2*Dl;function _ne(e){return e>1?0:e<-1?Dl:Math.acos(e)}function wN(e){return e>=1?xp:e<=-1?-xp:Math.asin(e)}function Ene(e){return e.innerRadius}function $ne(e){return e.outerRadius}function Ane(e){return e.startAngle}function Sne(e){return e.endAngle}function Cne(e){return e&&e.padAngle}function One(e,t,n,r,i,o,a,s){var u=n-e,l=r-t,c=a-i,f=s-o,d=f*u-c*l;if(!(d*d<un))return d=(c*(t-o)-f*(e-i))/d,[e+d*u,t+d*l]}function wp(e,t,n,r,i,o,a){var s=e-n,u=t-r,l=(a?o:-o)/Ml(s*s+u*u),c=l*u,f=-l*s,d=e+c,h=t+f,g=n+c,p=r+f,m=(d+g)/2,y=(h+p)/2,v=g-d,b=p-h,x=v*v+b*b,w=i-o,E=d*p-g*h,_=(b<0?-1:1)*Ml(wne(0,w*w*x-E*E)),S=(E*b-v*_)/x,C=(-E*v-b*_)/x,O=(E*b+v*_)/x,$=(-E*v+b*_)/x,M=S-m,F=C-y,N=O-m,A=$-y;return M*M+F*F>N*N+A*A&&(S=O,C=$),{cx:S,cy:C,x01:-c,y01:-f,x11:S*(i/w-1),y11:C*(i/w-1)}}function Fne(){var e=Ene,t=$ne,n=Be(0),r=null,i=Ane,o=Sne,a=Cne,s=null;function u(){var l,c,f=+e.apply(this,arguments),d=+t.apply(this,arguments),h=i.apply(this,arguments)-xp,g=o.apply(this,arguments)-xp,p=bN(g-h),m=g>h;if(s||(s=l=Hs()),d<f&&(c=d,d=f,f=c),!(d>un))s.moveTo(0,0);else if(p>xN-un)s.moveTo(d*Ws(h),d*zi(h)),s.arc(0,0,d,h,g,!m),f>un&&(s.moveTo(f*Ws(g),f*zi(g)),s.arc(0,0,f,g,h,m));else{var y=h,v=g,b=h,x=g,w=p,E=p,_=a.apply(this,arguments)/2,S=_>un&&(r?+r.apply(this,arguments):Ml(f*f+d*d)),C=lw(bN(d-f)/2,+n.apply(this,arguments)),O=C,$=C,M,F;if(S>un){var N=wN(S/f*zi(_)),A=wN(S/d*zi(_));(w-=N*2)>un?(N*=m?1:-1,b+=N,x-=N):(w=0,b=x=(h+g)/2),(E-=A*2)>un?(A*=m?1:-1,y+=A,v-=A):(E=0,y=v=(h+g)/2)}var k=d*Ws(y),T=d*zi(y),L=f*Ws(x),z=f*zi(x);if(C>un){var Q=d*Ws(v),oe=d*zi(v),ue=f*Ws(b),ce=f*zi(b),xe;if(p<Dl&&(xe=One(k,T,ue,ce,Q,oe,L,z))){var _e=k-xe[0],Wt=T-xe[1],ur=Q-xe[0],Bn=oe-xe[1],P=1/zi(_ne((_e*ur+Wt*Bn)/(Ml(_e*_e+Wt*Wt)*Ml(ur*ur+Bn*Bn)))/2),W=Ml(xe[0]*xe[0]+xe[1]*xe[1]);O=lw(C,(f-W)/(P-1)),$=lw(C,(d-W)/(P+1))}}E>un?$>un?(M=wp(ue,ce,k,T,d,$,m),F=wp(Q,oe,L,z,d,$,m),s.moveTo(M.cx+M.x01,M.cy+M.y01),$<C?s.arc(M.cx,M.cy,$,sn(M.y01,M.x01),sn(F.y01,F.x01),!m):(s.arc(M.cx,M.cy,$,sn(M.y01,M.x01),sn(M.y11,M.x11),!m),s.arc(0,0,d,sn(M.cy+M.y11,M.cx+M.x11),sn(F.cy+F.y11,F.cx+F.x11),!m),s.arc(F.cx,F.cy,$,sn(F.y11,F.x11),sn(F.y01,F.x01),!m))):(s.moveTo(k,T),s.arc(0,0,d,y,v,!m)):s.moveTo(k,T),!(f>un)||!(w>un)?s.lineTo(L,z):O>un?(M=wp(L,z,Q,oe,f,-O,m),F=wp(k,T,ue,ce,f,-O,m),s.lineTo(M.cx+M.x01,M.cy+M.y01),O<C?s.arc(M.cx,M.cy,O,sn(M.y01,M.x01),sn(F.y01,F.x01),!m):(s.arc(M.cx,M.cy,O,sn(M.y01,M.x01),sn(M.y11,M.x11),!m),s.arc(0,0,f,sn(M.cy+M.y11,M.cx+M.x11),sn(F.cy+F.y11,F.cx+F.x11),m),s.arc(F.cx,F.cy,O,sn(F.y11,F.x11),sn(F.y01,F.x01),!m))):s.arc(0,0,f,x,b,m)}if(s.closePath(),l)return s=null,l+""||null}return u.centroid=function(){var l=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,c=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-Dl/2;return[Ws(c)*l,zi(c)*l]},u.innerRadius=function(l){return arguments.length?(e=typeof l=="function"?l:Be(+l),u):e},u.outerRadius=function(l){return arguments.length?(t=typeof l=="function"?l:Be(+l),u):t},u.cornerRadius=function(l){return arguments.length?(n=typeof l=="function"?l:Be(+l),u):n},u.padRadius=function(l){return arguments.length?(r=l==null?null:typeof l=="function"?l:Be(+l),u):r},u.startAngle=function(l){return arguments.length?(i=typeof l=="function"?l:Be(+l),u):i},u.endAngle=function(l){return arguments.length?(o=typeof l=="function"?l:Be(+l),u):o},u.padAngle=function(l){return arguments.length?(a=typeof l=="function"?l:Be(+l),u):a},u.context=function(l){return arguments.length?(s=l==null?null:l,u):s},u}function _N(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function EN(e){this._context=e}EN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function cw(e){return new EN(e)}function $N(e){return e[0]}function AN(e){return e[1]}function SN(e,t){var n=Be(!0),r=null,i=cw,o=null;e=typeof e=="function"?e:e===void 0?$N:Be(e),t=typeof t=="function"?t:t===void 0?AN:Be(t);function a(s){var u,l=(s=_N(s)).length,c,f=!1,d;for(r==null&&(o=i(d=Hs())),u=0;u<=l;++u)!(u<l&&n(c=s[u],u,s))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+e(c,u,s),+t(c,u,s));if(d)return o=null,d+""||null}return a.x=function(s){return arguments.length?(e=typeof s=="function"?s:Be(+s),a):e},a.y=function(s){return arguments.length?(t=typeof s=="function"?s:Be(+s),a):t},a.defined=function(s){return arguments.length?(n=typeof s=="function"?s:Be(!!s),a):n},a.curve=function(s){return arguments.length?(i=s,r!=null&&(o=i(r)),a):i},a.context=function(s){return arguments.length?(s==null?r=o=null:o=i(r=s),a):r},a}function CN(e,t,n){var r=null,i=Be(!0),o=null,a=cw,s=null;e=typeof e=="function"?e:e===void 0?$N:Be(+e),t=typeof t=="function"?t:Be(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?AN:Be(+n);function u(c){var f,d,h,g=(c=_N(c)).length,p,m=!1,y,v=new Array(g),b=new Array(g);for(o==null&&(s=a(y=Hs())),f=0;f<=g;++f){if(!(f<g&&i(p=c[f],f,c))===m)if(m=!m)d=f,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),h=f-1;h>=d;--h)s.point(v[h],b[h]);s.lineEnd(),s.areaEnd()}m&&(v[f]=+e(p,f,c),b[f]=+t(p,f,c),s.point(r?+r(p,f,c):v[f],n?+n(p,f,c):b[f]))}if(y)return s=null,y+""||null}function l(){return SN().defined(i).curve(a).context(o)}return u.x=function(c){return arguments.length?(e=typeof c=="function"?c:Be(+c),r=null,u):e},u.x0=function(c){return arguments.length?(e=typeof c=="function"?c:Be(+c),u):e},u.x1=function(c){return arguments.length?(r=c==null?null:typeof c=="function"?c:Be(+c),u):r},u.y=function(c){return arguments.length?(t=typeof c=="function"?c:Be(+c),n=null,u):t},u.y0=function(c){return arguments.length?(t=typeof c=="function"?c:Be(+c),u):t},u.y1=function(c){return arguments.length?(n=c==null?null:typeof c=="function"?c:Be(+c),u):n},u.lineX0=u.lineY0=function(){return l().x(e).y(t)},u.lineY1=function(){return l().x(e).y(n)},u.lineX1=function(){return l().x(r).y(t)},u.defined=function(c){return arguments.length?(i=typeof c=="function"?c:Be(!!c),u):i},u.curve=function(c){return arguments.length?(a=c,o!=null&&(s=a(o)),u):a},u.context=function(c){return arguments.length?(c==null?o=s=null:s=a(o=c),u):o},u}var kne={draw:function(e,t){var n=Math.sqrt(t/Dl);e.moveTo(n,0),e.arc(0,0,n,0,xN)}};function Mne(e,t){var n=null;e=typeof e=="function"?e:Be(e||kne),t=typeof t=="function"?t:Be(t===void 0?64:+t);function r(){var i;if(n||(n=i=Hs()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),i)return n=null,i+""||null}return r.type=function(i){return arguments.length?(e=typeof i=="function"?i:Be(i),r):e},r.size=function(i){return arguments.length?(t=typeof i=="function"?i:Be(+i),r):t},r.context=function(i){return arguments.length?(n=i==null?null:i,r):n},r}function Fa(){}function _p(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Ep(e){this._context=e}Ep.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:_p(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:_p(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Dne(e){return new Ep(e)}function ON(e){this._context=e}ON.prototype={areaStart:Fa,areaEnd:Fa,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:_p(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Nne(e){return new ON(e)}function FN(e){this._context=e}FN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:_p(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Tne(e){return new FN(e)}function kN(e,t){this._basis=new Ep(e),this._beta=t}kN.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],i=t[0],o=e[n]-r,a=t[n]-i,s=-1,u;++s<=n;)u=s/n,this._basis.point(this._beta*e[s]+(1-this._beta)*(r+u*o),this._beta*t[s]+(1-this._beta)*(i+u*a));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var Rne=function e(t){function n(r){return t===1?new Ep(r):new kN(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function $p(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function fw(e,t){this._context=e,this._k=(1-t)/6}fw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:$p(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:$p(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Pne=function e(t){function n(r){return new fw(r,t)}return n.tension=function(r){return e(+r)},n}(0);function dw(e,t){this._context=e,this._k=(1-t)/6}dw.prototype={areaStart:Fa,areaEnd:Fa,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:$p(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Lne=function e(t){function n(r){return new dw(r,t)}return n.tension=function(r){return e(+r)},n}(0);function hw(e,t){this._context=e,this._k=(1-t)/6}hw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:$p(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var jne=function e(t){function n(r){return new hw(r,t)}return n.tension=function(r){return e(+r)},n}(0);function gw(e,t,n){var r=e._x1,i=e._y1,o=e._x2,a=e._y2;if(e._l01_a>un){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,u=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/u,i=(i*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/u}if(e._l23_a>un){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);o=(o*l+e._x1*e._l23_2a-t*e._l12_2a)/c,a=(a*l+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,o,a,e._x2,e._y2)}function MN(e,t){this._context=e,this._alpha=t}MN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:gw(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Ine=function e(t){function n(r){return t?new MN(r,t):new fw(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function DN(e,t){this._context=e,this._alpha=t}DN.prototype={areaStart:Fa,areaEnd:Fa,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:gw(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Bne=function e(t){function n(r){return t?new DN(r,t):new dw(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function NN(e,t){this._context=e,this._alpha=t}NN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:gw(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var zne=function e(t){function n(r){return t?new NN(r,t):new hw(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function TN(e){this._context=e}TN.prototype={areaStart:Fa,areaEnd:Fa,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Une(e){return new TN(e)}function RN(e){return e<0?-1:1}function PN(e,t,n){var r=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(r||i<0&&-0),a=(n-e._y1)/(i||r<0&&-0),s=(o*i+a*r)/(r+i);return(RN(o)+RN(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function LN(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function pw(e,t,n){var r=e._x0,i=e._y0,o=e._x1,a=e._y1,s=(o-r)/3;e._context.bezierCurveTo(r+s,i+s*t,o-s,a-s*n,o,a)}function Ap(e){this._context=e}Ap.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:pw(this,this._t0,LN(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,pw(this,LN(this,n=PN(this,e,t)),n);break;default:pw(this,this._t0,n=PN(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function jN(e){this._context=new IN(e)}(jN.prototype=Object.create(Ap.prototype)).point=function(e,t){Ap.prototype.point.call(this,t,e)};function IN(e){this._context=e}IN.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,o){this._context.bezierCurveTo(t,e,r,n,o,i)}};function qne(e){return new Ap(e)}function Hne(e){return new jN(e)}function BN(e){this._context=e}BN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=zN(e),i=zN(t),o=0,a=1;a<n;++o,++a)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],e[a],t[a]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function zN(e){var t,n=e.length-1,r,i=new Array(n),o=new Array(n),a=new Array(n);for(i[0]=0,o[0]=2,a[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,o[t]=4,a[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,o[n-1]=7,a[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/o[t-1],o[t]-=r,a[t]-=r*a[t-1];for(i[n-1]=a[n-1]/o[n-1],t=n-2;t>=0;--t)i[t]=(a[t]-i[t+1])/o[t];for(o[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)o[t]=2*e[t+1]-i[t+1];return[i,o]}function Wne(e){return new BN(e)}function Sp(e,t){this._context=e,this._t=t}Sp.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function Gne(e){return new Sp(e,.5)}function Yne(e){return new Sp(e,0)}function Vne(e){return new Sp(e,1)}function Nl(e,t){if(typeof document!="undefined"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}const Xne=()=>typeof Image!="undefined"?Image:null;function mw(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function yw(e){let t=e,n=e;e.length===1&&(t=(a,s)=>e(a)-s,n=Kne(e));function r(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)<0?u=c+1:l=c}return u}function i(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)>0?l=c:u=c+1}return u}function o(a,s,u,l){u==null&&(u=0),l==null&&(l=a.length);const c=r(a,s,u,l-1);return c>u&&t(a[c-1],s)>-t(a[c],s)?c-1:c}return{left:r,center:o,right:i}}function Kne(e){return(t,n)=>mw(e(t),n)}function UN(e){return e===null?NaN:+e}const Zne=yw(mw),vw=Zne.right;yw(UN).center;var fd=vw,bw=Math.sqrt(50),xw=Math.sqrt(10),ww=Math.sqrt(2);function _w(e,t,n){var r,i=-1,o,a,s;if(t=+t,e=+e,n=+n,e===t&&n>0)return[e];if((r=t<e)&&(o=e,e=t,t=o),(s=qN(e,t,n))===0||!isFinite(s))return[];if(s>0){let u=Math.round(e/s),l=Math.round(t/s);for(u*s<e&&++u,l*s>t&&--l,a=new Array(o=l-u+1);++i<o;)a[i]=(u+i)*s}else{s=-s;let u=Math.round(e*s),l=Math.round(t*s);for(u/s<e&&++u,l/s>t&&--l,a=new Array(o=l-u+1);++i<o;)a[i]=(u+i)/s}return r&&a.reverse(),a}function qN(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=bw?10:o>=xw?5:o>=ww?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=bw?10:o>=xw?5:o>=ww?2:1)}function Ew(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=bw?i*=10:o>=xw?i*=5:o>=ww&&(i*=2),t<e?-i:i}function Jne(e,t,n=UN){if(!!(r=e.length)){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),a=+n(e[o],o,e),s=+n(e[o+1],o+1,e);return a+(s-a)*(i-o)}}function Qne(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(i);++r<i;)o[r]=e+r*n;return o}function Ui(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function ka(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const $w=Symbol("implicit");function Aw(){var e=new Map,t=[],n=[],r=$w;function i(o){var a=o+"",s=e.get(a);if(!s){if(r!==$w)return r;e.set(a,s=t.push(o))}return n[(s-1)%n.length]}return i.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new Map;for(const a of o){const s=a+"";e.has(s)||e.set(s,t.push(a))}return i},i.range=function(o){return arguments.length?(n=Array.from(o),i):n.slice()},i.unknown=function(o){return arguments.length?(r=o,i):r},i.copy=function(){return Aw(t,n).unknown(r)},Ui.apply(i,arguments),i}function Tl(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function dd(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Ma(){}var Gs=.7,Rl=1/Gs,Pl="\\s*([+-]?\\d+)\\s*",hd="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",qi="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ere=/^#([0-9a-f]{3,8})$/,tre=new RegExp("^rgb\\("+[Pl,Pl,Pl]+"\\)$"),nre=new RegExp("^rgb\\("+[qi,qi,qi]+"\\)$"),rre=new RegExp("^rgba\\("+[Pl,Pl,Pl,hd]+"\\)$"),ire=new RegExp("^rgba\\("+[qi,qi,qi,hd]+"\\)$"),ore=new RegExp("^hsl\\("+[hd,qi,qi]+"\\)$"),are=new RegExp("^hsla\\("+[hd,qi,qi,hd]+"\\)$"),HN={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Tl(Ma,gd,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:WN,formatHex:WN,formatHsl:sre,formatRgb:GN,toString:GN});function WN(){return this.rgb().formatHex()}function sre(){return ZN(this).formatHsl()}function GN(){return this.rgb().formatRgb()}function gd(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=ere.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?YN(t):n===3?new Xt(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Cp(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Cp(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=tre.exec(e))?new Xt(t[1],t[2],t[3],1):(t=nre.exec(e))?new Xt(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=rre.exec(e))?Cp(t[1],t[2],t[3],t[4]):(t=ire.exec(e))?Cp(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=ore.exec(e))?KN(t[1],t[2]/100,t[3]/100,1):(t=are.exec(e))?KN(t[1],t[2]/100,t[3]/100,t[4]):HN.hasOwnProperty(e)?YN(HN[e]):e==="transparent"?new Xt(NaN,NaN,NaN,0):null}function YN(e){return new Xt(e>>16&255,e>>8&255,e&255,1)}function Cp(e,t,n,r){return r<=0&&(e=t=n=NaN),new Xt(e,t,n,r)}function Sw(e){return e instanceof Ma||(e=gd(e)),e?(e=e.rgb(),new Xt(e.r,e.g,e.b,e.opacity)):new Xt}function Op(e,t,n,r){return arguments.length===1?Sw(e):new Xt(e,t,n,r==null?1:r)}function Xt(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Tl(Xt,Op,dd(Ma,{brighter:function(e){return e=e==null?Rl:Math.pow(Rl,e),new Xt(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?Gs:Math.pow(Gs,e),new Xt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:VN,formatHex:VN,formatRgb:XN,toString:XN}));function VN(){return"#"+Cw(this.r)+Cw(this.g)+Cw(this.b)}function XN(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function Cw(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function KN(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Hi(e,t,n,r)}function ZN(e){if(e instanceof Hi)return new Hi(e.h,e.s,e.l,e.opacity);if(e instanceof Ma||(e=gd(e)),!e)return new Hi;if(e instanceof Hi)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(t===o?a=(n-r)/s+(n<r)*6:n===o?a=(r-t)/s+2:a=(t-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new Hi(a,s,u,e.opacity)}function Ow(e,t,n,r){return arguments.length===1?ZN(e):new Hi(e,t,n,r==null?1:r)}function Hi(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Tl(Hi,Ow,dd(Ma,{brighter:function(e){return e=e==null?Rl:Math.pow(Rl,e),new Hi(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Gs:Math.pow(Gs,e),new Hi(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Xt(Fw(e>=240?e-240:e+120,i,r),Fw(e,i,r),Fw(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function Fw(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const JN=Math.PI/180,QN=180/Math.PI,Fp=18,eT=.96422,tT=1,nT=.82521,rT=4/29,Ll=6/29,iT=3*Ll*Ll,ure=Ll*Ll*Ll;function oT(e){if(e instanceof Wi)return new Wi(e.l,e.a,e.b,e.opacity);if(e instanceof Lo)return aT(e);e instanceof Xt||(e=Sw(e));var t=Tw(e.r),n=Tw(e.g),r=Tw(e.b),i=Mw((.2225045*t+.7168786*n+.0606169*r)/tT),o,a;return t===n&&n===r?o=a=i:(o=Mw((.4360747*t+.3850649*n+.1430804*r)/eT),a=Mw((.0139322*t+.0971045*n+.7141733*r)/nT)),new Wi(116*i-16,500*(o-i),200*(i-a),e.opacity)}function kw(e,t,n,r){return arguments.length===1?oT(e):new Wi(e,t,n,r==null?1:r)}function Wi(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}Tl(Wi,kw,dd(Ma,{brighter:function(e){return new Wi(this.l+Fp*(e==null?1:e),this.a,this.b,this.opacity)},darker:function(e){return new Wi(this.l-Fp*(e==null?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=eT*Dw(t),e=tT*Dw(e),n=nT*Dw(n),new Xt(Nw(3.1338561*t-1.6168667*e-.4906146*n),Nw(-.9787684*t+1.9161415*e+.033454*n),Nw(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function Mw(e){return e>ure?Math.pow(e,1/3):e/iT+rT}function Dw(e){return e>Ll?e*e*e:iT*(e-rT)}function Nw(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Tw(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function lre(e){if(e instanceof Lo)return new Lo(e.h,e.c,e.l,e.opacity);if(e instanceof Wi||(e=oT(e)),e.a===0&&e.b===0)return new Lo(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*QN;return new Lo(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function Rw(e,t,n,r){return arguments.length===1?lre(e):new Lo(e,t,n,r==null?1:r)}function Lo(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function aT(e){if(isNaN(e.h))return new Wi(e.l,0,0,e.opacity);var t=e.h*JN;return new Wi(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Tl(Lo,Rw,dd(Ma,{brighter:function(e){return new Lo(this.h,this.c,this.l+Fp*(e==null?1:e),this.opacity)},darker:function(e){return new Lo(this.h,this.c,this.l-Fp*(e==null?1:e),this.opacity)},rgb:function(){return aT(this).rgb()}}));var sT=-.14861,Pw=1.78277,Lw=-.29227,kp=-.90649,pd=1.97294,uT=pd*kp,lT=pd*Pw,cT=Pw*Lw-kp*sT;function cre(e){if(e instanceof Ys)return new Ys(e.h,e.s,e.l,e.opacity);e instanceof Xt||(e=Sw(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(cT*r+uT*t-lT*n)/(cT+uT-lT),o=r-i,a=(pd*(n-i)-Lw*o)/kp,s=Math.sqrt(a*a+o*o)/(pd*i*(1-i)),u=s?Math.atan2(a,o)*QN-120:NaN;return new Ys(u<0?u+360:u,s,i,e.opacity)}function jw(e,t,n,r){return arguments.length===1?cre(e):new Ys(e,t,n,r==null?1:r)}function Ys(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Tl(Ys,jw,dd(Ma,{brighter:function(e){return e=e==null?Rl:Math.pow(Rl,e),new Ys(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Gs:Math.pow(Gs,e),new Ys(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*JN,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new Xt(255*(t+n*(sT*r+Pw*i)),255*(t+n*(Lw*r+kp*i)),255*(t+n*(pd*r)),this.opacity)}}));function fT(e,t,n,r,i){var o=e*e,a=o*e;return((1-3*e+3*o-a)*t+(4-6*o+3*a)*n+(1+3*e+3*o-3*a)*r+a*i)/6}function dT(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],a=r>0?e[r-1]:2*i-o,s=r<t-1?e[r+2]:2*o-i;return fT((n-r/t)*t,a,i,o,s)}}function hT(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],a=e[(r+1)%t],s=e[(r+2)%t];return fT((n-r/t)*t,i,o,a,s)}}var Mp=e=>()=>e;function gT(e,t){return function(n){return e+n*t}}function fre(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Dp(e,t){var n=t-e;return n?gT(e,n>180||n<-180?n-360*Math.round(n/360):n):Mp(isNaN(e)?t:e)}function dre(e){return(e=+e)==1?Lt:function(t,n){return n-t?fre(t,n,e):Mp(isNaN(t)?n:t)}}function Lt(e,t){var n=t-e;return n?gT(e,n):Mp(isNaN(e)?t:e)}var Iw=function e(t){var n=dre(t);function r(i,o){var a=n((i=Op(i)).r,(o=Op(o)).r),s=n(i.g,o.g),u=n(i.b,o.b),l=Lt(i.opacity,o.opacity);return function(c){return i.r=a(c),i.g=s(c),i.b=u(c),i.opacity=l(c),i+""}}return r.gamma=e,r}(1);function pT(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),o=new Array(n),a,s;for(a=0;a<n;++a)s=Op(t[a]),r[a]=s.r||0,i[a]=s.g||0,o[a]=s.b||0;return r=e(r),i=e(i),o=e(o),s.opacity=1,function(u){return s.r=r(u),s.g=i(u),s.b=o(u),s+""}}}var hre=pT(dT),gre=pT(hT);function Bw(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(o){for(i=0;i<n;++i)r[i]=e[i]*(1-o)+t[i]*o;return r}}function mT(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function pre(e,t){return(mT(t)?Bw:yT)(e,t)}function yT(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),o=new Array(n),a;for(a=0;a<r;++a)i[a]=Vs(e[a],t[a]);for(;a<n;++a)o[a]=t[a];return function(s){for(a=0;a<r;++a)o[a]=i[a](s);return o}}function vT(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function si(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function bT(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=Vs(e[i],t[i]):r[i]=t[i];return function(o){for(i in n)r[i]=n[i](o);return r}}var zw=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Uw=new RegExp(zw.source,"g");function mre(e){return function(){return e}}function yre(e){return function(t){return e(t)+""}}function xT(e,t){var n=zw.lastIndex=Uw.lastIndex=0,r,i,o,a=-1,s=[],u=[];for(e=e+"",t=t+"";(r=zw.exec(e))&&(i=Uw.exec(t));)(o=i.index)>n&&(o=t.slice(n,o),s[a]?s[a]+=o:s[++a]=o),(r=r[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,u.push({i:a,x:si(r,i)})),n=Uw.lastIndex;return n<t.length&&(o=t.slice(n),s[a]?s[a]+=o:s[++a]=o),s.length<2?u[0]?yre(u[0].x):mre(t):(t=u.length,function(l){for(var c=0,f;c<t;++c)s[(f=u[c]).i]=f.x(l);return s.join("")})}function Vs(e,t){var n=typeof t,r;return t==null||n==="boolean"?Mp(t):(n==="number"?si:n==="string"?(r=gd(t))?(t=r,Iw):xT:t instanceof gd?Iw:t instanceof Date?vT:mT(t)?Bw:Array.isArray(t)?yT:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?bT:si)(e,t)}function vre(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function bre(e,t){var n=Dp(+e,+t);return function(r){var i=n(r);return i-360*Math.floor(i/360)}}function Np(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var wT=180/Math.PI,qw={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function _T(e,t,n,r,i,o){var a,s,u;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),e*r<t*n&&(e=-e,t=-t,u=-u,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*wT,skewX:Math.atan(u)*wT,scaleX:a,scaleY:s}}var Tp;function xre(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?qw:_T(t.a,t.b,t.c,t.d,t.e,t.f)}function wre(e){return e==null||(Tp||(Tp=document.createElementNS("http://www.w3.org/2000/svg","g")),Tp.setAttribute("transform",e),!(e=Tp.transform.baseVal.consolidate()))?qw:(e=e.matrix,_T(e.a,e.b,e.c,e.d,e.e,e.f))}function ET(e,t,n,r){function i(l){return l.length?l.pop()+" ":""}function o(l,c,f,d,h,g){if(l!==f||c!==d){var p=h.push("translate(",null,t,null,n);g.push({i:p-4,x:si(l,f)},{i:p-2,x:si(c,d)})}else(f||d)&&h.push("translate("+f+t+d+n)}function a(l,c,f,d){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),d.push({i:f.push(i(f)+"rotate(",null,r)-2,x:si(l,c)})):c&&f.push(i(f)+"rotate("+c+r)}function s(l,c,f,d){l!==c?d.push({i:f.push(i(f)+"skewX(",null,r)-2,x:si(l,c)}):c&&f.push(i(f)+"skewX("+c+r)}function u(l,c,f,d,h,g){if(l!==f||c!==d){var p=h.push(i(h)+"scale(",null,",",null,")");g.push({i:p-4,x:si(l,f)},{i:p-2,x:si(c,d)})}else(f!==1||d!==1)&&h.push(i(h)+"scale("+f+","+d+")")}return function(l,c){var f=[],d=[];return l=e(l),c=e(c),o(l.translateX,l.translateY,c.translateX,c.translateY,f,d),a(l.rotate,c.rotate,f,d),s(l.skewX,c.skewX,f,d),u(l.scaleX,l.scaleY,c.scaleX,c.scaleY,f,d),l=c=null,function(h){for(var g=-1,p=d.length,m;++g<p;)f[(m=d[g]).i]=m.x(h);return f.join("")}}}var _re=ET(xre,"px, ","px)","deg)"),Ere=ET(wre,", ",")",")"),$re=1e-12;function $T(e){return((e=Math.exp(e))+1/e)/2}function Are(e){return((e=Math.exp(e))-1/e)/2}function Sre(e){return((e=Math.exp(2*e))-1)/(e+1)}var Cre=function e(t,n,r){function i(o,a){var s=o[0],u=o[1],l=o[2],c=a[0],f=a[1],d=a[2],h=c-s,g=f-u,p=h*h+g*g,m,y;if(p<$re)y=Math.log(d/l)/t,m=function(_){return[s+_*h,u+_*g,l*Math.exp(t*_*y)]};else{var v=Math.sqrt(p),b=(d*d-l*l+r*p)/(2*l*n*v),x=(d*d-l*l-r*p)/(2*d*n*v),w=Math.log(Math.sqrt(b*b+1)-b),E=Math.log(Math.sqrt(x*x+1)-x);y=(E-w)/t,m=function(_){var S=_*y,C=$T(w),O=l/(n*v)*(C*Sre(t*S+w)-Are(w));return[s+O*h,u+O*g,l*C/$T(t*S+w)]}}return m.duration=y*1e3*t/Math.SQRT2,m}return i.rho=function(o){var a=Math.max(.001,+o),s=a*a,u=s*s;return e(a,s,u)},i}(Math.SQRT2,2,4);function AT(e){return function(t,n){var r=e((t=Ow(t)).h,(n=Ow(n)).h),i=Lt(t.s,n.s),o=Lt(t.l,n.l),a=Lt(t.opacity,n.opacity);return function(s){return t.h=r(s),t.s=i(s),t.l=o(s),t.opacity=a(s),t+""}}}var Ore=AT(Dp),Fre=AT(Lt);function kre(e,t){var n=Lt((e=kw(e)).l,(t=kw(t)).l),r=Lt(e.a,t.a),i=Lt(e.b,t.b),o=Lt(e.opacity,t.opacity);return function(a){return e.l=n(a),e.a=r(a),e.b=i(a),e.opacity=o(a),e+""}}function ST(e){return function(t,n){var r=e((t=Rw(t)).h,(n=Rw(n)).h),i=Lt(t.c,n.c),o=Lt(t.l,n.l),a=Lt(t.opacity,n.opacity);return function(s){return t.h=r(s),t.c=i(s),t.l=o(s),t.opacity=a(s),t+""}}}var Mre=ST(Dp),Dre=ST(Lt);function CT(e){return function t(n){n=+n;function r(i,o){var a=e((i=jw(i)).h,(o=jw(o)).h),s=Lt(i.s,o.s),u=Lt(i.l,o.l),l=Lt(i.opacity,o.opacity);return function(c){return i.h=a(c),i.s=s(c),i.l=u(Math.pow(c,n)),i.opacity=l(c),i+""}}return r.gamma=t,r}(1)}var Nre=CT(Dp),Tre=CT(Lt);function Hw(e,t){t===void 0&&(t=e,e=Vs);for(var n=0,r=t.length-1,i=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(i,i=t[++n]);return function(a){var s=Math.max(0,Math.min(r-1,Math.floor(a*=r)));return o[s](a-s)}}function Rre(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}var Pre=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",interpolate:Vs,interpolateArray:pre,interpolateBasis:dT,interpolateBasisClosed:hT,interpolateDate:vT,interpolateDiscrete:vre,interpolateHue:bre,interpolateNumber:si,interpolateNumberArray:Bw,interpolateObject:bT,interpolateRound:Np,interpolateString:xT,interpolateTransformCss:_re,interpolateTransformSvg:Ere,interpolateZoom:Cre,interpolateRgb:Iw,interpolateRgbBasis:hre,interpolateRgbBasisClosed:gre,interpolateHsl:Ore,interpolateHslLong:Fre,interpolateLab:kre,interpolateHcl:Mre,interpolateHclLong:Dre,interpolateCubehelix:Nre,interpolateCubehelixLong:Tre,piecewise:Hw,quantize:Rre});function Lre(e){return function(){return e}}function Ww(e){return+e}var OT=[0,1];function Vn(e){return e}function Gw(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Lre(isNaN(t)?NaN:.5)}function jre(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function Ire(e,t,n){var r=e[0],i=e[1],o=t[0],a=t[1];return i<r?(r=Gw(i,r),o=n(a,o)):(r=Gw(r,i),o=n(o,a)),function(s){return o(r(s))}}function Bre(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),o=new Array(r),a=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<r;)i[a]=Gw(e[a],e[a+1]),o[a]=n(t[a],t[a+1]);return function(s){var u=fd(e,s,1,r)-1;return o[u](i[u](s))}}function md(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Rp(){var e=OT,t=OT,n=Vs,r,i,o,a=Vn,s,u,l;function c(){var d=Math.min(e.length,t.length);return a!==Vn&&(a=jre(e[0],e[d-1])),s=d>2?Bre:Ire,u=l=null,f}function f(d){return d==null||isNaN(d=+d)?o:(u||(u=s(e.map(r),t,n)))(r(a(d)))}return f.invert=function(d){return a(i((l||(l=s(t,e.map(r),si)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,Ww),c()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),c()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),n=Np,c()},f.clamp=function(d){return arguments.length?(a=d?!0:Vn,c()):a!==Vn},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(o=d,f):o},function(d,h){return r=d,i=h,c()}}function FT(){return Rp()(Vn,Vn)}function zre(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Pp(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function jl(e){return e=Pp(Math.abs(e)),e?e[1]:NaN}function Ure(e,t){return function(n,r){for(var i=n.length,o=[],a=0,s=e[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),o.push(n.substring(i-=s,i+s)),!((u+=s+1)>r));)s=e[a=(a+1)%e.length];return o.reverse().join(t)}}function qre(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var Hre=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Lp(e){if(!(t=Hre.exec(e)))throw new Error("invalid format: "+e);var t;return new Yw({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Lp.prototype=Yw.prototype;function Yw(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Yw.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Wre(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var kT;function Gre(e,t){var n=Pp(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(kT=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Pp(e,Math.max(0,t+o-1))[0]}function MT(e,t){var n=Pp(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var DT={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:zre,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>MT(e*100,t),r:MT,s:Gre,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function NT(e){return e}var TT=Array.prototype.map,RT=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function Yre(e){var t=e.grouping===void 0||e.thousands===void 0?NT:Ure(TT.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?NT:qre(TT.call(e.numerals,String)),a=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"\u2212":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function l(f){f=Lp(f);var d=f.fill,h=f.align,g=f.sign,p=f.symbol,m=f.zero,y=f.width,v=f.comma,b=f.precision,x=f.trim,w=f.type;w==="n"?(v=!0,w="g"):DT[w]||(b===void 0&&(b=12),x=!0,w="g"),(m||d==="0"&&h==="=")&&(m=!0,d="0",h="=");var E=p==="$"?n:p==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",_=p==="$"?r:/[%p]/.test(w)?a:"",S=DT[w],C=/[defgprs%]/.test(w);b=b===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function O($){var M=E,F=_,N,A,k;if(w==="c")F=S($)+F,$="";else{$=+$;var T=$<0||1/$<0;if($=isNaN($)?u:S(Math.abs($),b),x&&($=Wre($)),T&&+$==0&&g!=="+"&&(T=!1),M=(T?g==="("?g:s:g==="-"||g==="("?"":g)+M,F=(w==="s"?RT[8+kT/3]:"")+F+(T&&g==="("?")":""),C){for(N=-1,A=$.length;++N<A;)if(k=$.charCodeAt(N),48>k||k>57){F=(k===46?i+$.slice(N+1):$.slice(N))+F,$=$.slice(0,N);break}}}v&&!m&&($=t($,1/0));var L=M.length+$.length+F.length,z=L<y?new Array(y-L+1).join(d):"";switch(v&&m&&($=t(z+$,z.length?y-F.length:1/0),z=""),h){case"<":$=M+$+F+z;break;case"=":$=M+z+$+F;break;case"^":$=z.slice(0,L=z.length>>1)+M+$+F+z.slice(L);break;default:$=z+M+$+F;break}return o($)}return O.toString=function(){return f+""},O}function c(f,d){var h=l((f=Lp(f),f.type="f",f)),g=Math.max(-8,Math.min(8,Math.floor(jl(d)/3)))*3,p=Math.pow(10,-g),m=RT[8+g/3];return function(y){return h(p*y)+m}}return{format:l,formatPrefix:c}}var jp,Vw,PT;Vre({thousands:",",grouping:[3],currency:["$",""]});function Vre(e){return jp=Yre(e),Vw=jp.format,PT=jp.formatPrefix,jp}function Xre(e){return Math.max(0,-jl(Math.abs(e)))}function Kre(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(jl(t)/3)))*3-jl(Math.abs(e)))}function Zre(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,jl(t)-jl(e))+1}function LT(e,t,n,r){var i=Ew(e,t,n),o;switch(r=Lp(r==null?",f":r),r.type){case"s":{var a=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(o=Kre(i,a))&&(r.precision=o),PT(r,a)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=Zre(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=Xre(i))&&(r.precision=o-(r.type==="%")*2);break}}return Vw(r)}function Xs(e){var t=e.domain;return e.ticks=function(n){var r=t();return _w(r[0],r[r.length-1],n==null?10:n)},e.tickFormat=function(n,r){var i=t();return LT(i[0],i[i.length-1],n==null?10:n,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,o=r.length-1,a=r[i],s=r[o],u,l,c=10;for(s<a&&(l=a,a=s,s=l,l=i,i=o,o=l);c-- >0;){if(l=qN(a,s,n),l===u)return r[i]=a,r[o]=s,t(r);if(l>0)a=Math.floor(a/l)*l,s=Math.ceil(s/l)*l;else if(l<0)a=Math.ceil(a*l)/l,s=Math.floor(s*l)/l;else break;u=l}return e},e}function jT(){var e=FT();return e.copy=function(){return md(e,jT())},Ui.apply(e,arguments),Xs(e)}function IT(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,Ww),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return IT(e).unknown(t)},e=arguments.length?Array.from(e,Ww):[0,1],Xs(n)}function BT(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],o=e[r],a;return o<i&&(a=n,n=r,r=a,a=i,i=o,o=a),e[n]=t.floor(i),e[r]=t.ceil(o),e}function zT(e){return Math.log(e)}function UT(e){return Math.exp(e)}function Jre(e){return-Math.log(-e)}function Qre(e){return-Math.exp(-e)}function eie(e){return isFinite(e)?+("1e"+e):e<0?0:e}function tie(e){return e===10?eie:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function nie(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function qT(e){return function(t){return-e(-t)}}function Xw(e){var t=e(zT,UT),n=t.domain,r=10,i,o;function a(){return i=nie(r),o=tie(r),n()[0]<0?(i=qT(i),o=qT(o),e(Jre,Qre)):e(zT,UT),t}return t.base=function(s){return arguments.length?(r=+s,a()):r},t.domain=function(s){return arguments.length?(n(s),a()):n()},t.ticks=function(s){var u=n(),l=u[0],c=u[u.length-1],f;(f=c<l)&&(d=l,l=c,c=d);var d=i(l),h=i(c),g,p,m,y=s==null?10:+s,v=[];if(!(r%1)&&h-d<y){if(d=Math.floor(d),h=Math.ceil(h),l>0){for(;d<=h;++d)for(p=1,g=o(d);p<r;++p)if(m=g*p,!(m<l)){if(m>c)break;v.push(m)}}else for(;d<=h;++d)for(p=r-1,g=o(d);p>=1;--p)if(m=g*p,!(m<l)){if(m>c)break;v.push(m)}v.length*2<y&&(v=_w(l,c,y))}else v=_w(d,h,Math.min(h-d,y)).map(o);return f?v.reverse():v},t.tickFormat=function(s,u){if(u==null&&(u=r===10?".0e":","),typeof u!="function"&&(u=Vw(u)),s===1/0)return u;s==null&&(s=10);var l=Math.max(1,r*s/t.ticks().length);return function(c){var f=c/o(Math.round(i(c)));return f*r<r-.5&&(f*=r),f<=l?u(c):""}},t.nice=function(){return n(BT(n(),{floor:function(s){return o(Math.floor(i(s)))},ceil:function(s){return o(Math.ceil(i(s)))}}))},t}function HT(){var e=Xw(Rp()).domain([1,10]);return e.copy=function(){return md(e,HT()).base(e.base())},Ui.apply(e,arguments),e}function WT(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function GT(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Kw(e){var t=1,n=e(WT(t),GT(t));return n.constant=function(r){return arguments.length?e(WT(t=+r),GT(t)):t},Xs(n)}function YT(){var e=Kw(Rp());return e.copy=function(){return md(e,YT()).constant(e.constant())},Ui.apply(e,arguments)}function VT(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function rie(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function iie(e){return e<0?-e*e:e*e}function Zw(e){var t=e(Vn,Vn),n=1;function r(){return n===1?e(Vn,Vn):n===.5?e(rie,iie):e(VT(n),VT(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},Xs(t)}function Jw(){var e=Zw(Rp());return e.copy=function(){return md(e,Jw()).exponent(e.exponent())},Ui.apply(e,arguments),e}function oie(){return Jw.apply(null,arguments).exponent(.5)}function XT(){var e=[],t=[],n=[],r;function i(){var a=0,s=Math.max(1,t.length);for(n=new Array(s-1);++a<s;)n[a-1]=Jne(e,a/s);return o}function o(a){return a==null||isNaN(a=+a)?r:t[fd(n,a)]}return o.invertExtent=function(a){var s=t.indexOf(a);return s<0?[NaN,NaN]:[s>0?n[s-1]:e[0],s<n.length?n[s]:e[e.length-1]]},o.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let s of a)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(mw),i()},o.range=function(a){return arguments.length?(t=Array.from(a),i()):t.slice()},o.unknown=function(a){return arguments.length?(r=a,o):r},o.quantiles=function(){return n.slice()},o.copy=function(){return XT().domain(e).range(t).unknown(r)},Ui.apply(o,arguments)}function KT(){var e=0,t=1,n=1,r=[.5],i=[0,1],o;function a(u){return u!=null&&u<=u?i[fd(r,u,0,n)]:o}function s(){var u=-1;for(r=new Array(n);++u<n;)r[u]=((u+1)*t-(u-n)*e)/(n+1);return a}return a.domain=function(u){return arguments.length?([e,t]=u,e=+e,t=+t,s()):[e,t]},a.range=function(u){return arguments.length?(n=(i=Array.from(u)).length-1,s()):i.slice()},a.invertExtent=function(u){var l=i.indexOf(u);return l<0?[NaN,NaN]:l<1?[e,r[0]]:l>=n?[r[n-1],t]:[r[l-1],r[l]]},a.unknown=function(u){return arguments.length&&(o=u),a},a.thresholds=function(){return r.slice()},a.copy=function(){return KT().domain([e,t]).range(i).unknown(o)},Ui.apply(Xs(a),arguments)}function ZT(){var e=[.5],t=[0,1],n,r=1;function i(o){return o!=null&&o<=o?t[fd(e,o,0,r)]:n}return i.domain=function(o){return arguments.length?(e=Array.from(o),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(o){return arguments.length?(t=Array.from(o),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(o){var a=t.indexOf(o);return[e[a-1],e[a]]},i.unknown=function(o){return arguments.length?(n=o,i):n},i.copy=function(){return ZT().domain(e).range(t).unknown(n)},Ui.apply(i,arguments)}var Qw=new Date,e_=new Date;function jt(e,t,n,r){function i(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=function(o){return e(o=new Date(+o)),o},i.ceil=function(o){return e(o=new Date(o-1)),t(o,1),e(o),o},i.round=function(o){var a=i(o),s=i.ceil(o);return o-a<s-o?a:s},i.offset=function(o,a){return t(o=new Date(+o),a==null?1:Math.floor(a)),o},i.range=function(o,a,s){var u=[],l;if(o=i.ceil(o),s=s==null?1:Math.floor(s),!(o<a)||!(s>0))return u;do u.push(l=new Date(+o)),t(o,s),e(o);while(l<o&&o<a);return u},i.filter=function(o){return jt(function(a){if(a>=a)for(;e(a),!o(a);)a.setTime(a-1)},function(a,s){if(a>=a)if(s<0)for(;++s<=0;)for(;t(a,-1),!o(a););else for(;--s>=0;)for(;t(a,1),!o(a););})},n&&(i.count=function(o,a){return Qw.setTime(+o),e_.setTime(+a),e(Qw),e(e_),Math.floor(n(Qw,e_))},i.every=function(o){return o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(r?function(a){return r(a)%o==0}:function(a){return i.count(0,a)%o==0}):i}),i}var t_=jt(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});t_.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?jt(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):t_};var aie=t_;const jo=1e3,Rr=jo*60,Io=Rr*60,Ks=Io*24,n_=Ks*7,JT=Ks*30,r_=Ks*365;var sie=jt(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*jo)},function(e,t){return(t-e)/jo},function(e){return e.getUTCSeconds()}),Il=sie,uie=jt(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*jo)},function(e,t){e.setTime(+e+t*Rr)},function(e,t){return(t-e)/Rr},function(e){return e.getMinutes()}),QT=uie,lie=jt(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*jo-e.getMinutes()*Rr)},function(e,t){e.setTime(+e+t*Io)},function(e,t){return(t-e)/Io},function(e){return e.getHours()}),e6=lie,cie=jt(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Rr)/Ks,e=>e.getDate()-1),Ip=cie;function Zs(e){return jt(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+n*7)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Rr)/n_})}var i_=Zs(0),o_=Zs(1);Zs(2);Zs(3);var yd=Zs(4);Zs(5);Zs(6);var fie=jt(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()}),t6=fie,n6=jt(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});n6.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:jt(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)})};var Js=n6,die=jt(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*Rr)},function(e,t){return(t-e)/Rr},function(e){return e.getUTCMinutes()}),r6=die,hie=jt(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*Io)},function(e,t){return(t-e)/Io},function(e){return e.getUTCHours()}),i6=hie,gie=jt(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/Ks},function(e){return e.getUTCDate()-1}),Bp=gie;function Qs(e){return jt(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n*7)},function(t,n){return(n-t)/n_})}var a_=Qs(0),s_=Qs(1);Qs(2);Qs(3);var vd=Qs(4);Qs(5);Qs(6);var pie=jt(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12},function(e){return e.getUTCMonth()}),o6=pie,a6=jt(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});a6.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:jt(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})};var eu=a6;function s6(e,t,n,r,i,o){const a=[[Il,1,jo],[Il,5,5*jo],[Il,15,15*jo],[Il,30,30*jo],[o,1,Rr],[o,5,5*Rr],[o,15,15*Rr],[o,30,30*Rr],[i,1,Io],[i,3,3*Io],[i,6,6*Io],[i,12,12*Io],[r,1,Ks],[r,2,2*Ks],[n,1,n_],[t,1,JT],[t,3,3*JT],[e,1,r_]];function s(l,c,f){const d=c<l;d&&([l,c]=[c,l]);const h=f&&typeof f.range=="function"?f:u(l,c,f),g=h?h.range(l,+c+1):[];return d?g.reverse():g}function u(l,c,f){const d=Math.abs(c-l)/f,h=yw(([,,m])=>m).right(a,d);if(h===a.length)return e.every(Ew(l/r_,c/r_,f));if(h===0)return aie.every(Math.max(Ew(l,c,f),1));const[g,p]=a[d/a[h-1][2]<a[h][2]/d?h-1:h];return g.every(p)}return[s,u]}const[mie,yie]=s6(eu,o6,a_,Bp,i6,r6),[vie,bie]=s6(Js,t6,i_,Ip,e6,QT);function u_(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function l_(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function bd(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function xie(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,a=e.shortDays,s=e.months,u=e.shortMonths,l=xd(i),c=wd(i),f=xd(o),d=wd(o),h=xd(a),g=wd(a),p=xd(s),m=wd(s),y=xd(u),v=wd(u),b={a:T,A:L,b:z,B:Q,c:null,d:h6,e:h6,f:qie,g:Qie,G:toe,H:Bie,I:zie,j:Uie,L:g6,m:Hie,M:Wie,p:oe,q:ue,Q:x6,s:w6,S:Gie,u:Yie,U:Vie,V:Xie,w:Kie,W:Zie,x:null,X:null,y:Jie,Y:eoe,Z:noe,"%":b6},x={a:ce,A:xe,b:_e,B:Wt,c:null,d:m6,e:m6,f:aoe,g:moe,G:voe,H:roe,I:ioe,j:ooe,L:y6,m:soe,M:uoe,p:ur,q:Bn,Q:x6,s:w6,S:loe,u:coe,U:foe,V:doe,w:hoe,W:goe,x:null,X:null,y:poe,Y:yoe,Z:boe,"%":b6},w={a:O,A:$,b:M,B:F,c:N,d:f6,e:f6,f:Pie,g:c6,G:l6,H:d6,I:d6,j:Die,L:Rie,m:Mie,M:Nie,p:C,q:kie,Q:jie,s:Iie,S:Tie,u:Aie,U:Sie,V:Cie,w:$ie,W:Oie,x:A,X:k,y:c6,Y:l6,Z:Fie,"%":Lie};b.x=E(n,b),b.X=E(r,b),b.c=E(t,b),x.x=E(n,x),x.X=E(r,x),x.c=E(t,x);function E(P,W){return function(V){var D=[],Ee=-1,X=0,ke=P.length,$e,Qt,kr;for(V instanceof Date||(V=new Date(+V));++Ee<ke;)P.charCodeAt(Ee)===37&&(D.push(P.slice(X,Ee)),(Qt=u6[$e=P.charAt(++Ee)])!=null?$e=P.charAt(++Ee):Qt=$e==="e"?" ":"0",(kr=W[$e])&&($e=kr(V,Qt)),D.push($e),X=Ee+1);return D.push(P.slice(X,Ee)),D.join("")}}function _(P,W){return function(V){var D=bd(1900,void 0,1),Ee=S(D,P,V+="",0),X,ke;if(Ee!=V.length)return null;if("Q"in D)return new Date(D.Q);if("s"in D)return new Date(D.s*1e3+("L"in D?D.L:0));if(W&&!("Z"in D)&&(D.Z=0),"p"in D&&(D.H=D.H%12+D.p*12),D.m===void 0&&(D.m="q"in D?D.q:0),"V"in D){if(D.V<1||D.V>53)return null;"w"in D||(D.w=1),"Z"in D?(X=l_(bd(D.y,0,1)),ke=X.getUTCDay(),X=ke>4||ke===0?s_.ceil(X):s_(X),X=Bp.offset(X,(D.V-1)*7),D.y=X.getUTCFullYear(),D.m=X.getUTCMonth(),D.d=X.getUTCDate()+(D.w+6)%7):(X=u_(bd(D.y,0,1)),ke=X.getDay(),X=ke>4||ke===0?o_.ceil(X):o_(X),X=Ip.offset(X,(D.V-1)*7),D.y=X.getFullYear(),D.m=X.getMonth(),D.d=X.getDate()+(D.w+6)%7)}else("W"in D||"U"in D)&&("w"in D||(D.w="u"in D?D.u%7:"W"in D?1:0),ke="Z"in D?l_(bd(D.y,0,1)).getUTCDay():u_(bd(D.y,0,1)).getDay(),D.m=0,D.d="W"in D?(D.w+6)%7+D.W*7-(ke+5)%7:D.w+D.U*7-(ke+6)%7);return"Z"in D?(D.H+=D.Z/100|0,D.M+=D.Z%100,l_(D)):u_(D)}}function S(P,W,V,D){for(var Ee=0,X=W.length,ke=V.length,$e,Qt;Ee<X;){if(D>=ke)return-1;if($e=W.charCodeAt(Ee++),$e===37){if($e=W.charAt(Ee++),Qt=w[$e in u6?W.charAt(Ee++):$e],!Qt||(D=Qt(P,V,D))<0)return-1}else if($e!=V.charCodeAt(D++))return-1}return D}function C(P,W,V){var D=l.exec(W.slice(V));return D?(P.p=c.get(D[0].toLowerCase()),V+D[0].length):-1}function O(P,W,V){var D=h.exec(W.slice(V));return D?(P.w=g.get(D[0].toLowerCase()),V+D[0].length):-1}function $(P,W,V){var D=f.exec(W.slice(V));return D?(P.w=d.get(D[0].toLowerCase()),V+D[0].length):-1}function M(P,W,V){var D=y.exec(W.slice(V));return D?(P.m=v.get(D[0].toLowerCase()),V+D[0].length):-1}function F(P,W,V){var D=p.exec(W.slice(V));return D?(P.m=m.get(D[0].toLowerCase()),V+D[0].length):-1}function N(P,W,V){return S(P,t,W,V)}function A(P,W,V){return S(P,n,W,V)}function k(P,W,V){return S(P,r,W,V)}function T(P){return a[P.getDay()]}function L(P){return o[P.getDay()]}function z(P){return u[P.getMonth()]}function Q(P){return s[P.getMonth()]}function oe(P){return i[+(P.getHours()>=12)]}function ue(P){return 1+~~(P.getMonth()/3)}function ce(P){return a[P.getUTCDay()]}function xe(P){return o[P.getUTCDay()]}function _e(P){return u[P.getUTCMonth()]}function Wt(P){return s[P.getUTCMonth()]}function ur(P){return i[+(P.getUTCHours()>=12)]}function Bn(P){return 1+~~(P.getUTCMonth()/3)}return{format:function(P){var W=E(P+="",b);return W.toString=function(){return P},W},parse:function(P){var W=_(P+="",!1);return W.toString=function(){return P},W},utcFormat:function(P){var W=E(P+="",x);return W.toString=function(){return P},W},utcParse:function(P){var W=_(P+="",!0);return W.toString=function(){return P},W}}}var u6={"-":"",_:" ","0":"0"},It=/^\s*\d+/,wie=/^%/,_ie=/[\\^$*+?|[\]().{}]/g;function Re(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function Eie(e){return e.replace(_ie,"\\$&")}function xd(e){return new RegExp("^(?:"+e.map(Eie).join("|")+")","i")}function wd(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function $ie(e,t,n){var r=It.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function Aie(e,t,n){var r=It.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function Sie(e,t,n){var r=It.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function Cie(e,t,n){var r=It.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function Oie(e,t,n){var r=It.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function l6(e,t,n){var r=It.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function c6(e,t,n){var r=It.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Fie(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function kie(e,t,n){var r=It.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function Mie(e,t,n){var r=It.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function f6(e,t,n){var r=It.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function Die(e,t,n){var r=It.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function d6(e,t,n){var r=It.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function Nie(e,t,n){var r=It.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function Tie(e,t,n){var r=It.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function Rie(e,t,n){var r=It.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function Pie(e,t,n){var r=It.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Lie(e,t,n){var r=wie.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function jie(e,t,n){var r=It.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function Iie(e,t,n){var r=It.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function h6(e,t){return Re(e.getDate(),t,2)}function Bie(e,t){return Re(e.getHours(),t,2)}function zie(e,t){return Re(e.getHours()%12||12,t,2)}function Uie(e,t){return Re(1+Ip.count(Js(e),e),t,3)}function g6(e,t){return Re(e.getMilliseconds(),t,3)}function qie(e,t){return g6(e,t)+"000"}function Hie(e,t){return Re(e.getMonth()+1,t,2)}function Wie(e,t){return Re(e.getMinutes(),t,2)}function Gie(e,t){return Re(e.getSeconds(),t,2)}function Yie(e){var t=e.getDay();return t===0?7:t}function Vie(e,t){return Re(i_.count(Js(e)-1,e),t,2)}function p6(e){var t=e.getDay();return t>=4||t===0?yd(e):yd.ceil(e)}function Xie(e,t){return e=p6(e),Re(yd.count(Js(e),e)+(Js(e).getDay()===4),t,2)}function Kie(e){return e.getDay()}function Zie(e,t){return Re(o_.count(Js(e)-1,e),t,2)}function Jie(e,t){return Re(e.getFullYear()%100,t,2)}function Qie(e,t){return e=p6(e),Re(e.getFullYear()%100,t,2)}function eoe(e,t){return Re(e.getFullYear()%1e4,t,4)}function toe(e,t){var n=e.getDay();return e=n>=4||n===0?yd(e):yd.ceil(e),Re(e.getFullYear()%1e4,t,4)}function noe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Re(t/60|0,"0",2)+Re(t%60,"0",2)}function m6(e,t){return Re(e.getUTCDate(),t,2)}function roe(e,t){return Re(e.getUTCHours(),t,2)}function ioe(e,t){return Re(e.getUTCHours()%12||12,t,2)}function ooe(e,t){return Re(1+Bp.count(eu(e),e),t,3)}function y6(e,t){return Re(e.getUTCMilliseconds(),t,3)}function aoe(e,t){return y6(e,t)+"000"}function soe(e,t){return Re(e.getUTCMonth()+1,t,2)}function uoe(e,t){return Re(e.getUTCMinutes(),t,2)}function loe(e,t){return Re(e.getUTCSeconds(),t,2)}function coe(e){var t=e.getUTCDay();return t===0?7:t}function foe(e,t){return Re(a_.count(eu(e)-1,e),t,2)}function v6(e){var t=e.getUTCDay();return t>=4||t===0?vd(e):vd.ceil(e)}function doe(e,t){return e=v6(e),Re(vd.count(eu(e),e)+(eu(e).getUTCDay()===4),t,2)}function hoe(e){return e.getUTCDay()}function goe(e,t){return Re(s_.count(eu(e)-1,e),t,2)}function poe(e,t){return Re(e.getUTCFullYear()%100,t,2)}function moe(e,t){return e=v6(e),Re(e.getUTCFullYear()%100,t,2)}function yoe(e,t){return Re(e.getUTCFullYear()%1e4,t,4)}function voe(e,t){var n=e.getUTCDay();return e=n>=4||n===0?vd(e):vd.ceil(e),Re(e.getUTCFullYear()%1e4,t,4)}function boe(){return"+0000"}function b6(){return"%"}function x6(e){return+e}function w6(e){return Math.floor(+e/1e3)}var zp,_6,E6;xoe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function xoe(e){return zp=xie(e),_6=zp.format,E6=zp.utcFormat,zp}function woe(e){return new Date(e)}function _oe(e){return e instanceof Date?+e:+new Date(+e)}function c_(e,t,n,r,i,o,a,s,u,l){var c=FT(),f=c.invert,d=c.domain,h=l(".%L"),g=l(":%S"),p=l("%I:%M"),m=l("%I %p"),y=l("%a %d"),v=l("%b %d"),b=l("%B"),x=l("%Y");function w(E){return(u(E)<E?h:s(E)<E?g:a(E)<E?p:o(E)<E?m:r(E)<E?i(E)<E?y:v:n(E)<E?b:x)(E)}return c.invert=function(E){return new Date(f(E))},c.domain=function(E){return arguments.length?d(Array.from(E,_oe)):d().map(woe)},c.ticks=function(E){var _=d();return e(_[0],_[_.length-1],E==null?10:E)},c.tickFormat=function(E,_){return _==null?w:l(_)},c.nice=function(E){var _=d();return(!E||typeof E.range!="function")&&(E=t(_[0],_[_.length-1],E==null?10:E)),E?d(BT(_,E)):c},c.copy=function(){return md(c,c_(e,t,n,r,i,o,a,s,u,l))},c}function Eoe(){return Ui.apply(c_(vie,bie,Js,t6,i_,Ip,e6,QT,Il,_6).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function $oe(){return Ui.apply(c_(mie,yie,eu,o6,a_,Bp,i6,r6,Il,E6).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Up(){var e=0,t=1,n,r,i,o,a=Vn,s=!1,u;function l(f){return f==null||isNaN(f=+f)?u:a(i===0?.5:(f=(o(f)-n)*i,s?Math.max(0,Math.min(1,f)):f))}l.domain=function(f){return arguments.length?([e,t]=f,n=o(e=+e),r=o(t=+t),i=n===r?0:1/(r-n),l):[e,t]},l.clamp=function(f){return arguments.length?(s=!!f,l):s},l.interpolator=function(f){return arguments.length?(a=f,l):a};function c(f){return function(d){var h,g;return arguments.length?([h,g]=d,a=f(h,g),l):[a(0),a(1)]}}return l.range=c(Vs),l.rangeRound=c(Np),l.unknown=function(f){return arguments.length?(u=f,l):u},function(f){return o=f,n=f(e),r=f(t),i=n===r?0:1/(r-n),l}}function Da(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function f_(){var e=Xs(Up()(Vn));return e.copy=function(){return Da(e,f_())},ka.apply(e,arguments)}function $6(){var e=Xw(Up()).domain([1,10]);return e.copy=function(){return Da(e,$6()).base(e.base())},ka.apply(e,arguments)}function A6(){var e=Kw(Up());return e.copy=function(){return Da(e,A6()).constant(e.constant())},ka.apply(e,arguments)}function d_(){var e=Zw(Up());return e.copy=function(){return Da(e,d_()).exponent(e.exponent())},ka.apply(e,arguments)}function Aoe(){return d_.apply(null,arguments).exponent(.5)}function qp(){var e=0,t=.5,n=1,r=1,i,o,a,s,u,l=Vn,c,f=!1,d;function h(p){return isNaN(p=+p)?d:(p=.5+((p=+c(p))-o)*(r*p<r*o?s:u),l(f?Math.max(0,Math.min(1,p)):p))}h.domain=function(p){return arguments.length?([e,t,n]=p,i=c(e=+e),o=c(t=+t),a=c(n=+n),s=i===o?0:.5/(o-i),u=o===a?0:.5/(a-o),r=o<i?-1:1,h):[e,t,n]},h.clamp=function(p){return arguments.length?(f=!!p,h):f},h.interpolator=function(p){return arguments.length?(l=p,h):l};function g(p){return function(m){var y,v,b;return arguments.length?([y,v,b]=m,l=Hw(p,[y,v,b]),h):[l(0),l(.5),l(1)]}}return h.range=g(Vs),h.rangeRound=g(Np),h.unknown=function(p){return arguments.length?(d=p,h):d},function(p){return c=p,i=p(e),o=p(t),a=p(n),s=i===o?0:.5/(o-i),u=o===a?0:.5/(a-o),r=o<i?-1:1,h}}function S6(){var e=Xs(qp()(Vn));return e.copy=function(){return Da(e,S6())},ka.apply(e,arguments)}function C6(){var e=Xw(qp()).domain([.1,1,10]);return e.copy=function(){return Da(e,C6()).base(e.base())},ka.apply(e,arguments)}function O6(){var e=Kw(qp());return e.copy=function(){return Da(e,O6()).constant(e.constant())},ka.apply(e,arguments)}function h_(){var e=Zw(qp());return e.copy=function(){return Da(e,h_()).exponent(e.exponent())},ka.apply(e,arguments)}function Soe(){return h_.apply(null,arguments).exponent(.5)}function g_(e,t,n){const r=e-t+n*2;return e?r>0?r:1:0}const Coe="identity",Bl="linear",Bo="log",_d="pow",Ed="sqrt",Hp="symlog",tu="time",nu="utc",Gi="sequential",zl="diverging",Ul="quantile",Wp="quantize",Gp="threshold",p_="ordinal",m_="point",F6="band",y_="bin-ordinal",Ct="continuous",$d="discrete",Ad="discretizing",Pr="interpolating",v_="temporal";function Ooe(e){return function(t){let n=t[0],r=t[1],i;return r<n&&(i=n,n=r,r=i),[e.invert(n),e.invert(r)]}}function Foe(e){return function(t){const n=e.range();let r=t[0],i=t[1],o=-1,a,s,u,l;for(i<r&&(s=r,r=i,i=s),u=0,l=n.length;u<l;++u)n[u]>=r&&n[u]<=i&&(o<0&&(o=u),a=u);if(!(o<0))return r=e.invertExtent(n[o]),i=e.invertExtent(n[a]),[r[0]===void 0?r[1]:r[0],i[1]===void 0?i[0]:i[1]]}}function b_(){const e=Aw().unknown(void 0),t=e.domain,n=e.range;let r=[0,1],i,o,a=!1,s=0,u=0,l=.5;delete e.unknown;function c(){const f=t().length,d=r[1]<r[0],h=r[1-d],g=g_(f,s,u);let p=r[d-0];i=(h-p)/(g||1),a&&(i=Math.floor(i)),p+=(h-p-i*(f-s))*l,o=i*(1-s),a&&(p=Math.round(p),o=Math.round(o));const m=Qne(f).map(y=>p+i*y);return n(d?m.reverse():m)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(r=[+f[0],+f[1]],c()):r.slice()},e.rangeRound=function(f){return r=[+f[0],+f[1]],a=!0,c()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(f){return arguments.length?(a=!!f,c()):a},e.padding=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),s=u,c()):s},e.paddingInner=function(f){return arguments.length?(s=Math.max(0,Math.min(1,f)),c()):s},e.paddingOuter=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.align=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const d=r[1]<r[0],h=d?n().reverse():n(),g=h.length-1;let p=+f[0],m=+f[1],y,v,b;if(!(p!==p||m!==m)&&(m<p&&(b=p,p=m,m=b),!(m<h[0]||p>r[1-d])))return y=Math.max(0,vw(h,p)-1),v=p===m?y:vw(h,m)-1,p-h[y]>o+1e-10&&++y,d&&(b=y,y=g-v,v=g-b),y>v?void 0:t().slice(y,v+1)},e.invert=function(f){const d=e.invertRange([f,f]);return d&&d[0]},e.copy=function(){return b_().domain(t()).range(r).round(a).paddingInner(s).paddingOuter(u).align(l)},c()}function k6(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return k6(t())},e}function koe(){return k6(b_().paddingInner(1))}var Moe=Array.prototype.map;function Doe(e){return Moe.call(e,nn)}const Noe=Array.prototype.slice;function M6(){let e=[],t=[];function n(r){return r==null||r!==r?void 0:t[(fd(e,r)-1)%t.length]}return n.domain=function(r){return arguments.length?(e=Doe(r),n):e.slice()},n.range=function(r){return arguments.length?(t=Noe.call(r),n):t.slice()},n.tickFormat=function(r,i){return LT(e[0],Se(e),r==null?10:r,i)},n.copy=function(){return M6().domain(n.domain()).range(n.range())},n}const Yp={};function Toe(e,t,n){const r=function(){const o=t();return o.invertRange||(o.invertRange=o.invert?Ooe(o):o.invertExtent?Foe(o):void 0),o.type=e,o};return r.metadata=oi(ae(n)),r}function Pe(e,t,n){return arguments.length>1?(Yp[e]=Toe(e,t,n),this):D6(e)?Yp[e]:void 0}Pe(Coe,IT);Pe(Bl,jT,Ct);Pe(Bo,HT,[Ct,Bo]);Pe(_d,Jw,Ct);Pe(Ed,oie,Ct);Pe(Hp,YT,Ct);Pe(tu,Eoe,[Ct,v_]);Pe(nu,$oe,[Ct,v_]);Pe(Gi,f_,[Ct,Pr]);Pe("".concat(Gi,"-").concat(Bl),f_,[Ct,Pr]);Pe("".concat(Gi,"-").concat(Bo),$6,[Ct,Pr,Bo]);Pe("".concat(Gi,"-").concat(_d),d_,[Ct,Pr]);Pe("".concat(Gi,"-").concat(Ed),Aoe,[Ct,Pr]);Pe("".concat(Gi,"-").concat(Hp),A6,[Ct,Pr]);Pe("".concat(zl,"-").concat(Bl),S6,[Ct,Pr]);Pe("".concat(zl,"-").concat(Bo),C6,[Ct,Pr,Bo]);Pe("".concat(zl,"-").concat(_d),h_,[Ct,Pr]);Pe("".concat(zl,"-").concat(Ed),Soe,[Ct,Pr]);Pe("".concat(zl,"-").concat(Hp),O6,[Ct,Pr]);Pe(Ul,XT,[Ad,Ul]);Pe(Wp,KT,Ad);Pe(Gp,ZT,Ad);Pe(y_,M6,[$d,Ad]);Pe(p_,Aw,$d);Pe(F6,b_,$d);Pe(m_,koe,$d);function D6(e){return se(Yp,e)}function ru(e,t){const n=Yp[e];return n&&n.metadata[t]}function x_(e){return ru(e,Ct)}function ql(e){return ru(e,$d)}function w_(e){return ru(e,Ad)}function N6(e){return ru(e,Bo)}function Roe(e){return ru(e,v_)}function T6(e){return ru(e,Pr)}function R6(e){return ru(e,Ul)}const Poe=["clamp","base","constant","exponent"];function P6(e,t){const n=t[0],r=Se(t)-n;return function(i){return e(n+i*r)}}function Vp(e,t,n){return Hw(__(t||"rgb",n),e)}function L6(e,t){const n=new Array(t),r=t+1;for(let i=0;i<t;)n[i]=e(++i/r);return n}function j6(e,t,n){const r=n-t;let i,o,a;return!r||!Number.isFinite(r)?rn(.5):(i=(o=e.type).indexOf("-"),o=i<0?o:o.slice(i+1),a=Pe(o)().domain([t,n]).range([0,1]),Poe.forEach(s=>e[s]?a[s](e[s]()):0),a)}function __(e,t){const n=Pre[Loe(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function Loe(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const joe={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},Ioe={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function I6(e){const t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}function B6(e,t){for(const n in e)E_(n,t(e[n]))}const z6={};B6(Ioe,I6);B6(joe,e=>Vp(I6(e)));function E_(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(z6[e]=t,this):z6[e]}const Xp="symbol",Boe="discrete",zoe="gradient",Uoe=e=>ee(e)?e.map(t=>String(t)):String(e),qoe=(e,t)=>e[1]-t[1],Hoe=(e,t)=>t[1]-e[1];function $_(e,t,n){let r;return _a(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),n!=null&&(t=Math.min(t,Math.floor(Tf(e.domain())/n||1)))),le(t)&&(r=t.step,t=t.interval),Me(t)&&(t=e.type===tu?$l(t):e.type==nu?Al(t):B("Only time and utc scales accept interval strings."),r&&(t=t.every(r))),t}function U6(e,t,n){let r=e.range(),i=r[0],o=Se(r),a=qoe;if(i>o&&(r=o,o=i,i=r,a=Hoe),i=Math.floor(i),o=Math.ceil(o),t=t.map(s=>[s,e(s)]).filter(s=>i<=s[1]&&s[1]<=o).sort(a).map(s=>s[0]),n>0&&t.length>1){const s=[t[0],Se(t)];for(;t.length>n&&t.length>=3;)t=t.filter((u,l)=>!(l%2));t.length<3&&(t=s)}return t}function A_(e,t){return e.bins?U6(e,e.bins):e.ticks?e.ticks(t):e.domain()}function q6(e,t,n,r,i,o){const a=t.type;let s=Uoe;if(a===tu||i===tu)s=e.timeFormat(r);else if(a===nu||i===nu)s=e.utcFormat(r);else if(N6(a)){const u=e.formatFloat(r);if(o||t.bins)s=u;else{const l=H6(t,n,!1);s=c=>l(c)?u(c):""}}else if(t.tickFormat){const u=t.domain();s=e.formatSpan(u[0],u[u.length-1],n,r)}else r&&(s=e.format(r));return s}function H6(e,t,n){const r=A_(e,t),i=e.base(),o=Math.log(i),a=Math.max(1,i*t/r.length),s=u=>{let l=u/Math.pow(i,Math.round(Math.log(u)/o));return l*i<i-.5&&(l*=i),l<=a};return n?r.filter(s):s}const S_={[Ul]:"quantiles",[Wp]:"thresholds",[Gp]:"domain"},W6={[Ul]:"quantiles",[Wp]:"domain"};function G6(e,t){return e.bins?Yoe(e.bins):e.type===Bo?H6(e,t,!0):S_[e.type]?Goe(e[S_[e.type]]()):A_(e,t)}function Woe(e,t,n){const r=t[W6[t.type]](),i=r.length;let o=i>1?r[1]-r[0]:r[0],a;for(a=1;a<i;++a)o=Math.min(o,r[a]-r[a-1]);return e.formatSpan(0,o,3*10,n)}function Goe(e){const t=[-1/0].concat(e);return t.max=1/0,t}function Yoe(e){const t=e.slice(0,-1);return t.max=Se(e),t}const Voe=e=>S_[e.type]||e.bins;function Y6(e,t,n,r,i,o,a){const s=W6[t.type]&&o!==tu&&o!==nu?Woe(e,t,i):q6(e,t,n,i,o,a);return r===Xp&&Voe(t)?Xoe(s):r===Boe?Koe(s):Zoe(s)}const Xoe=e=>(t,n,r)=>{const i=V6(r[n+1],V6(r.max,1/0)),o=X6(t,e),a=X6(i,e);return o&&a?o+" \u2013 "+a:a?"< "+a:"\u2265 "+o},V6=(e,t)=>e!=null?e:t,Koe=e=>(t,n)=>n?e(t):null,Zoe=e=>t=>e(t),X6=(e,t)=>Number.isFinite(e)?t(e):null;function Joe(e){const t=e.domain(),n=t.length-1;let r=+t[0],i=+Se(t),o=i-r;if(e.type===Gp){const a=n?o/n:.1;r-=a,i+=a,o=i-r}return a=>(a-r)/o}function Qoe(e,t,n,r){const i=r||t.type;return Me(n)&&Roe(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&i===tu?e.timeFormat("%A, %d %B %Y, %X"):!n&&i===nu?e.utcFormat("%A, %d %B %Y, %X UTC"):Y6(e,t,5,null,n,r,!0)}function K6(e,t,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=Qoe(e,t,n.format,n.formatType);if(w_(t.type)){const o=G6(t).slice(1).map(i),a=o.length;return"".concat(a," boundar").concat(a===1?"y":"ies",": ").concat(o.join(", "))}else if(ql(t.type)){const o=t.domain(),a=o.length,s=a>r?o.slice(0,r-2).map(i).join(", ")+", ending with "+o.slice(-1).map(i):o.map(i).join(", ");return"".concat(a," value").concat(a===1?"":"s",": ").concat(s)}else{const o=t.domain();return"values from ".concat(i(o[0])," to ").concat(i(Se(o)))}}let Z6=0;function eae(){Z6=0}const Kp="p_";function C_(e){return e&&e.gradient}function J6(e,t,n){const r=e.gradient;let i=e.id,o=r==="radial"?Kp:"";return i||(i=e.id="gradient_"+Z6++,r==="radial"?(e.x1=Yi(e.x1,.5),e.y1=Yi(e.y1,.5),e.r1=Yi(e.r1,0),e.x2=Yi(e.x2,.5),e.y2=Yi(e.y2,.5),e.r2=Yi(e.r2,.5),o=Kp):(e.x1=Yi(e.x1,0),e.y1=Yi(e.y1,0),e.x2=Yi(e.x2,1),e.y2=Yi(e.y2,0))),t[i]=e,"url("+(n||"")+"#"+o+i+")"}function Yi(e,t){return e!=null?e:t}function Q6(e,t){var n=[],r;return r={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(i,o){return n.push({offset:i,color:o}),r}}}const e8={basis:{curve:Dne},"basis-closed":{curve:Nne},"basis-open":{curve:Tne},bundle:{curve:Rne,tension:"beta",value:.85},cardinal:{curve:Pne,tension:"tension",value:0},"cardinal-open":{curve:jne,tension:"tension",value:0},"cardinal-closed":{curve:Lne,tension:"tension",value:0},"catmull-rom":{curve:Ine,tension:"alpha",value:.5},"catmull-rom-closed":{curve:Bne,tension:"alpha",value:.5},"catmull-rom-open":{curve:zne,tension:"alpha",value:.5},linear:{curve:cw},"linear-closed":{curve:Une},monotone:{horizontal:Hne,vertical:qne},natural:{curve:Wne},step:{curve:Gne},"step-after":{curve:Vne},"step-before":{curve:Yne}};function O_(e,t,n){var r=se(e8,e)&&e8[e],i=null;return r&&(i=r.curve||r[t||"vertical"],r.tension&&n!=null&&(i=i[r.tension](n))),i}const tae={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},Sd=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function Hl(e){const t=[];let n,r,i,o,a,s,u,l,c,f;const d=e.slice().replace(Sd[0],"###$1").split(Sd[1]).slice(1);for(u=0,c=d.length;u<c;++u){for(n=d[u],r=n.slice(1).trim().replace(Sd[2],"$1###$2").replace(Sd[3],"$1###$2").split(Sd[4]),a=n.charAt(0),i=[a],l=0,f=r.length;l<f;++l)(o=+r[l])===o&&i.push(o);if(s=tae[a.toLowerCase()],i.length-1>s){const h=i.length;for(l=1,t.push([a].concat(i.slice(l,l+=s))),a=a==="M"?"L":a==="m"?"l":a;l<h;l+=s)t.push([a].concat(i.slice(l,l+s)))}else t.push(i)}return t}const Na=Math.PI/180,nae=1e-14,iu=Math.PI/2,Vi=Math.PI*2,Wl=Math.sqrt(3)/2;var F_={},k_={},t8=[].join;function rae(e,t,n,r,i,o,a,s,u){const l=t8.call(arguments);if(F_[l])return F_[l];const c=a*Na,f=Math.sin(c),d=Math.cos(c);n=Math.abs(n),r=Math.abs(r);const h=d*(s-e)*.5+f*(u-t)*.5,g=d*(u-t)*.5-f*(s-e)*.5;let p=h*h/(n*n)+g*g/(r*r);p>1&&(p=Math.sqrt(p),n*=p,r*=p);const m=d/n,y=f/n,v=-f/r,b=d/r,x=m*s+y*u,w=v*s+b*u,E=m*e+y*t,_=v*e+b*t,S=(E-x)*(E-x)+(_-w)*(_-w);let C=1/S-.25;C<0&&(C=0);let O=Math.sqrt(C);o==i&&(O=-O);const $=.5*(x+E)-O*(_-w),M=.5*(w+_)+O*(E-x),F=Math.atan2(w-M,x-$);let A=Math.atan2(_-M,E-$)-F;A<0&&o===1?A+=Vi:A>0&&o===0&&(A-=Vi);const k=Math.ceil(Math.abs(A/(iu+.001))),T=[];for(let L=0;L<k;++L){const z=F+L*A/k,Q=F+(L+1)*A/k;T[L]=[$,M,z,Q,n,r,f,d]}return F_[l]=T}function iae(e){const t=t8.call(e);if(k_[t])return k_[t];var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7];const c=l*a,f=-u*s,d=u*a,h=l*s,g=Math.cos(i),p=Math.sin(i),m=Math.cos(o),y=Math.sin(o),v=.5*(o-i),b=Math.sin(v*.5),x=8/3*b*b/Math.sin(v),w=n+g-x*p,E=r+p+x*g,_=n+m,S=r+y,C=_+x*y,O=S-x*m;return k_[t]=[c*w+f*E,d*w+h*E,c*C+f*O,d*C+h*O,c*_+f*S,d*_+h*S]}const Lr=["l",0,0,0,0,0,0,0];function oae(e,t,n){const r=Lr[0]=e[0];if(r==="a"||r==="A")Lr[1]=t*e[1],Lr[2]=n*e[2],Lr[3]=e[3],Lr[4]=e[4],Lr[5]=e[5],Lr[6]=t*e[6],Lr[7]=n*e[7];else if(r==="h"||r==="H")Lr[1]=t*e[1];else if(r==="v"||r==="V")Lr[1]=n*e[1];else for(var i=1,o=e.length;i<o;++i)Lr[i]=(i%2==1?t:n)*e[i];return Lr}function Cd(e,t,n,r,i,o){var a,s=null,u=0,l=0,c=0,f=0,d,h,g,p;n==null&&(n=0),r==null&&(r=0),i==null&&(i=1),o==null&&(o=i),e.beginPath&&e.beginPath();for(var m=0,y=t.length;m<y;++m){switch(a=t[m],(i!==1||o!==1)&&(a=oae(a,i,o)),a[0]){case"l":u+=a[1],l+=a[2],e.lineTo(u+n,l+r);break;case"L":u=a[1],l=a[2],e.lineTo(u+n,l+r);break;case"h":u+=a[1],e.lineTo(u+n,l+r);break;case"H":u=a[1],e.lineTo(u+n,l+r);break;case"v":l+=a[1],e.lineTo(u+n,l+r);break;case"V":l=a[1],e.lineTo(u+n,l+r);break;case"m":u+=a[1],l+=a[2],e.moveTo(u+n,l+r);break;case"M":u=a[1],l=a[2],e.moveTo(u+n,l+r);break;case"c":d=u+a[5],h=l+a[6],c=u+a[3],f=l+a[4],e.bezierCurveTo(u+a[1]+n,l+a[2]+r,c+n,f+r,d+n,h+r),u=d,l=h;break;case"C":u=a[5],l=a[6],c=a[3],f=a[4],e.bezierCurveTo(a[1]+n,a[2]+r,c+n,f+r,u+n,l+r);break;case"s":d=u+a[3],h=l+a[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+r,u+a[1]+n,l+a[2]+r,d+n,h+r),c=u+a[1],f=l+a[2],u=d,l=h;break;case"S":d=a[3],h=a[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+r,a[1]+n,a[2]+r,d+n,h+r),u=d,l=h,c=a[1],f=a[2];break;case"q":d=u+a[3],h=l+a[4],c=u+a[1],f=l+a[2],e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h;break;case"Q":d=a[3],h=a[4],e.quadraticCurveTo(a[1]+n,a[2]+r,d+n,h+r),u=d,l=h,c=a[1],f=a[2];break;case"t":d=u+a[1],h=l+a[2],s[0].match(/[QqTt]/)===null?(c=u,f=l):s[0]==="t"?(c=2*u-g,f=2*l-p):s[0]==="q"&&(c=2*u-c,f=2*l-f),g=c,p=f,e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h,c=u+a[1],f=l+a[2];break;case"T":d=a[1],h=a[2],c=2*u-c,f=2*l-f,e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h;break;case"a":n8(e,u+n,l+r,[a[1],a[2],a[3],a[4],a[5],a[6]+u+n,a[7]+l+r]),u+=a[6],l+=a[7];break;case"A":n8(e,u+n,l+r,[a[1],a[2],a[3],a[4],a[5],a[6]+n,a[7]+r]),u=a[6],l=a[7];break;case"z":case"Z":e.closePath();break}s=a}}function n8(e,t,n,r){const i=rae(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(let o=0;o<i.length;++o){const a=iae(i[o]);e.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5])}}const r8=.5773502691896257,i8={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,Vi)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,o=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-o),e.lineTo(i,-o),e.lineTo(0,-n),e.lineTo(-i,-o),e.lineTo(-r,-o),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Wl*n,i=r-n*r8,o=n/4;e.moveTo(0,-r-i),e.lineTo(-o,r-i),e.lineTo(o,r-i),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Wl*n,i=r-n*r8;e.moveTo(0,-r-i),e.lineTo(-n,r-i),e.lineTo(n,r-i),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Wl*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Wl*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Wl*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Wl*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function o8(e){return se(i8,e)?i8[e]:aae(e)}var M_={};function aae(e){if(!se(M_,e)){const t=Hl(e);M_[e]={draw:function(n,r){Cd(n,t,0,0,Math.sqrt(r)/2)}}}return M_[e]}const Ta=.448084975506;function sae(e){return e.x}function uae(e){return e.y}function lae(e){return e.width}function cae(e){return e.height}function zo(e){return typeof e=="function"?e:()=>+e}function Zp(e,t,n){return Math.max(t,Math.min(e,n))}function a8(){var e=sae,t=uae,n=lae,r=cae,i=zo(0),o=i,a=i,s=i,u=null;function l(c,f,d){var h,g=f!=null?f:+e.call(this,c),p=d!=null?d:+t.call(this,c),m=+n.call(this,c),y=+r.call(this,c),v=Math.min(m,y)/2,b=Zp(+i.call(this,c),0,v),x=Zp(+o.call(this,c),0,v),w=Zp(+a.call(this,c),0,v),E=Zp(+s.call(this,c),0,v);if(u||(u=h=Hs()),b<=0&&x<=0&&w<=0&&E<=0)u.rect(g,p,m,y);else{var _=g+m,S=p+y;u.moveTo(g+b,p),u.lineTo(_-x,p),u.bezierCurveTo(_-Ta*x,p,_,p+Ta*x,_,p+x),u.lineTo(_,S-E),u.bezierCurveTo(_,S-Ta*E,_-Ta*E,S,_-E,S),u.lineTo(g+w,S),u.bezierCurveTo(g+Ta*w,S,g,S-Ta*w,g,S-w),u.lineTo(g,p+b),u.bezierCurveTo(g,p+Ta*b,g+Ta*b,p,g+b,p),u.closePath()}if(h)return u=null,h+""||null}return l.x=function(c){return arguments.length?(e=zo(c),l):e},l.y=function(c){return arguments.length?(t=zo(c),l):t},l.width=function(c){return arguments.length?(n=zo(c),l):n},l.height=function(c){return arguments.length?(r=zo(c),l):r},l.cornerRadius=function(c,f,d,h){return arguments.length?(i=zo(c),o=f!=null?zo(f):i,s=d!=null?zo(d):i,a=h!=null?zo(h):o,l):i},l.context=function(c){return arguments.length?(u=c==null?null:c,l):u},l}function s8(){var e,t,n,r,i=null,o,a,s,u;function l(f,d,h){const g=h/2;if(o){var p=s-d,m=f-a;if(p||m){var y=Math.sqrt(p*p+m*m),v=(p/=y)*u,b=(m/=y)*u,x=Math.atan2(m,p);i.moveTo(a-v,s-b),i.lineTo(f-p*g,d-m*g),i.arc(f,d,g,x-Math.PI,x),i.lineTo(a+v,s+b),i.arc(a,s,u,x,x+Math.PI)}else i.arc(f,d,g,0,Vi);i.closePath()}else o=1;a=f,s=d,u=g}function c(f){var d,h=f.length,g,p=!1,m;for(i==null&&(i=m=Hs()),d=0;d<=h;++d)!(d<h&&r(g=f[d],d,f))===p&&(p=!p)&&(o=0),p&&l(+e(g,d,f),+t(g,d,f),+n(g,d,f));if(m)return i=null,m+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(r=f,c):r},c.context=function(f){return arguments.length?(f==null?i=null:i=f,c):i},c}function Od(e,t){return e!=null?e:t}const Fd=e=>e.x||0,kd=e=>e.y||0,fae=e=>e.width||0,dae=e=>e.height||0,hae=e=>(e.x||0)+(e.width||0),gae=e=>(e.y||0)+(e.height||0),pae=e=>e.startAngle||0,mae=e=>e.endAngle||0,yae=e=>e.padAngle||0,vae=e=>e.innerRadius||0,bae=e=>e.outerRadius||0,xae=e=>e.cornerRadius||0,wae=e=>Od(e.cornerRadiusTopLeft,e.cornerRadius)||0,_ae=e=>Od(e.cornerRadiusTopRight,e.cornerRadius)||0,Eae=e=>Od(e.cornerRadiusBottomRight,e.cornerRadius)||0,$ae=e=>Od(e.cornerRadiusBottomLeft,e.cornerRadius)||0,Aae=e=>Od(e.size,64),Sae=e=>e.size||1,Jp=e=>e.defined!==!1,Cae=e=>o8(e.shape||"circle"),Oae=Fne().startAngle(pae).endAngle(mae).padAngle(yae).innerRadius(vae).outerRadius(bae).cornerRadius(xae),Fae=CN().x(Fd).y1(kd).y0(gae).defined(Jp),kae=CN().y(kd).x1(Fd).x0(hae).defined(Jp),Mae=SN().x(Fd).y(kd).defined(Jp),Dae=a8().x(Fd).y(kd).width(fae).height(dae).cornerRadius(wae,_ae,Eae,$ae),Nae=Mne().type(Cae).size(Aae),Tae=s8().x(Fd).y(kd).defined(Jp).size(Sae);function D_(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function Rae(e,t){return Oae.context(e)(t)}function Pae(e,t){const n=t[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?kae:Fae).curve(O_(r,n.orient,n.tension)).context(e)(t)}function Lae(e,t){const n=t[0],r=n.interpolate||"linear";return Mae.curve(O_(r,n.orient,n.tension)).context(e)(t)}function Gl(e,t,n,r){return Dae.context(e)(t,n,r)}function jae(e,t){return(t.mark.shape||t.shape).context(e)(t)}function Iae(e,t){return Nae.context(e)(t)}function Bae(e,t){return Tae.context(e)(t)}var u8=1;function l8(){u8=1}function N_(e,t,n){var r=t.clip,i=e._defs,o=t.clip_id||(t.clip_id="clip"+u8++),a=i.clipping[o]||(i.clipping[o]={id:o});return ye(r)?a.path=r(null):D_(n)?a.path=Gl(null,n,0,0):(a.width=n.width||0,a.height=n.height||0),"url(#"+o+")"}function Ot(e){this.clear(),e&&this.union(e)}Ot.prototype={clone(){return new Ot(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(e,t,n){var{x1:r,y1:i,x2:o,y2:a}=this,s=Math.cos(e),u=Math.sin(e),l=t-t*s+n*u,c=n-t*u-n*s;return[s*r-u*i+l,u*r+s*i+c,s*r-u*a+l,u*r+s*a+c,s*o-u*i+l,u*o+s*i+c,s*o-u*a+l,u*o+s*a+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function Qp(e){this.mark=e,this.bounds=this.bounds||new Ot}function em(e){Qp.call(this,e),this.items=this.items||[]}H(em,Qp);function T_(e){this._pending=0,this._loader=e||rp()}function c8(e){e._pending+=1}function Md(e){e._pending-=1}T_.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return c8(t),t._loader.sanitize(e,{context:"href"}).then(n=>(Md(t),n)).catch(()=>(Md(t),null))},loadImage(e){const t=this,n=Xne();return c8(t),t._loader.sanitize(e,{context:"image"}).then(r=>{const i=r.href;if(!i||!n)throw{url:i};const o=new n,a=se(r,"crossOrigin")?r.crossOrigin:"anonymous";return a!=null&&(o.crossOrigin=a),o.onload=()=>Md(t),o.onerror=()=>Md(t),o.src=i,o}).catch(r=>(Md(t),{complete:!1,width:0,height:0,src:r&&r.url||""}))},ready(){const e=this;return new Promise(t=>{function n(r){e.pending()?setTimeout(()=>{n(!0)},10):t(r)}n(!1)})}};function Uo(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const r=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(r+(n?zae(t,r):0))}return e}function zae(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const Uae=Vi-1e-8;let tm,nm,rm,ou,R_,im,P_,L_;const Ra=(e,t)=>tm.add(e,t),om=(e,t)=>Ra(nm=e,rm=t),f8=e=>Ra(e,tm.y1),d8=e=>Ra(tm.x1,e),au=(e,t)=>R_*e+P_*t,su=(e,t)=>im*e+L_*t,j_=(e,t)=>Ra(au(e,t),su(e,t)),I_=(e,t)=>om(au(e,t),su(e,t));function Dd(e,t){return tm=e,t?(ou=t*Na,R_=L_=Math.cos(ou),im=Math.sin(ou),P_=-im):(R_=L_=1,ou=im=P_=0),qae}const qae={beginPath(){},closePath(){},moveTo:I_,lineTo:I_,rect(e,t,n,r){ou?(j_(e+n,t),j_(e+n,t+r),j_(e,t+r),I_(e,t)):(Ra(e+n,t+r),om(e,t))},quadraticCurveTo(e,t,n,r){const i=au(e,t),o=su(e,t),a=au(n,r),s=su(n,r);h8(nm,i,a,f8),h8(rm,o,s,d8),om(a,s)},bezierCurveTo(e,t,n,r,i,o){const a=au(e,t),s=su(e,t),u=au(n,r),l=su(n,r),c=au(i,o),f=su(i,o);g8(nm,a,u,c,f8),g8(rm,s,l,f,d8),om(c,f)},arc(e,t,n,r,i,o){if(r+=ou,i+=ou,nm=n*Math.cos(i)+e,rm=n*Math.sin(i)+t,Math.abs(i-r)>Uae)Ra(e-n,t-n),Ra(e+n,t+n);else{const a=l=>Ra(n*Math.cos(l)+e,n*Math.sin(l)+t);let s,u;if(a(r),a(i),i!==r)if(r=r%Vi,r<0&&(r+=Vi),i=i%Vi,i<0&&(i+=Vi),i<r&&(o=!o,s=r,r=i,i=s),o)for(i-=Vi,s=r-r%iu,u=0;u<4&&s>i;++u,s-=iu)a(s);else for(s=r-r%iu+iu,u=0;u<4&&s<i;++u,s=s+iu)a(s)}}};function h8(e,t,n,r){const i=(e-t)/(e+n-2*t);0<i&&i<1&&r(e+(t-e)*i)}function g8(e,t,n,r,i){const o=r-e+3*t-3*n,a=e+n-2*t,s=e-t;let u=0,l=0,c;Math.abs(o)>nae?(c=a*a+s*o,c>=0&&(c=Math.sqrt(c),u=(-a+c)/o,l=(-a-c)/o)):u=.5*s/a,0<u&&u<1&&i(p8(u,e,t,n,r)),0<l&&l<1&&i(p8(l,e,t,n,r))}function p8(e,t,n,r,i){const o=1-e,a=o*o,s=e*e;return a*o*t+3*a*e*n+3*o*s*r+s*e*i}var Pa=(Pa=Nl(1,1))?Pa.getContext("2d"):null;const B_=new Ot;function z_(e){return function(t,n){if(!Pa)return!0;e(Pa,t),B_.clear().union(t.bounds).intersect(n).round();const{x1:r,y1:i,x2:o,y2:a}=B_;for(let s=i;s<=a;++s)for(let u=r;u<=o;++u)if(Pa.isPointInPath(u,s))return!0;return!1}}function U_(e,t){return t.contains(e.x||0,e.y||0)}function m8(e,t){const n=e.x||0,r=e.y||0,i=e.width||0,o=e.height||0;return t.intersects(B_.set(n,r,n+i,r+o))}function y8(e,t){const n=e.x||0,r=e.y||0,i=e.x2!=null?e.x2:n,o=e.y2!=null?e.y2:r;return Yl(t,n,r,i,o)}function Yl(e,t,n,r,i){const{x1:o,y1:a,x2:s,y2:u}=e,l=r-t,c=i-n;let f=0,d=1,h,g,p,m;for(m=0;m<4;++m){if(m===0&&(h=-l,g=-(o-t)),m===1&&(h=l,g=s-t),m===2&&(h=-c,g=-(a-n)),m===3&&(h=c,g=u-n),Math.abs(h)<1e-10&&g<0)return!1;if(p=g/h,h<0){if(p>d)return!1;p>f&&(f=p)}else if(h>0){if(p<f)return!1;p<d&&(d=p)}}return!0}function Vl(e,t){e.globalCompositeOperation=t.blend||"source-over"}function ui(e,t){return e==null?t:e}function v8(e,t){const n=t.length;for(let r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function Hae(e,t,n){const r=n.width(),i=n.height();let o;if(t.gradient==="radial")o=e.createRadialGradient(n.x1+ui(t.x1,.5)*r,n.y1+ui(t.y1,.5)*i,Math.max(r,i)*ui(t.r1,0),n.x1+ui(t.x2,.5)*r,n.y1+ui(t.y2,.5)*i,Math.max(r,i)*ui(t.r2,.5));else{const a=ui(t.x1,0),s=ui(t.y1,0),u=ui(t.x2,1),l=ui(t.y2,0);if(a===u||s===l||r===i)o=e.createLinearGradient(n.x1+a*r,n.y1+s*i,n.x1+u*r,n.y1+l*i);else{const c=Nl(Math.ceil(r),Math.ceil(i)),f=c.getContext("2d");return f.scale(r,i),f.fillStyle=v8(f.createLinearGradient(a,s,u,l),t.stops),f.fillRect(0,0,r,i),e.createPattern(c,"no-repeat")}}return v8(o,t.stops)}function b8(e,t,n){return C_(n)?Hae(e,n,t.bounds):n}function am(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=b8(e,t,t.fill),!0):!1}var Wae=[];function Xl(e,t,n){var r=(r=t.strokeWidth)!=null?r:1;return r<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=b8(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||Wae),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function Gae(e,t){return e.zindex-t.zindex||e.index-t.index}function q_(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],r,i,o;for(i=0,o=t.length;i<o;++i)r=t[i],r.index=i,r.zindex&&n.push(r);return e.zdirty=!1,e.zitems=n.sort(Gae)}function li(e,t){var n=e.items,r,i;if(!n||!n.length)return;const o=q_(e);if(o&&o.length){for(r=0,i=n.length;r<i;++r)n[r].zindex||t(n[r]);n=o}for(r=0,i=n.length;r<i;++r)t(n[r])}function sm(e,t){var n=e.items,r,i;if(!n||!n.length)return null;const o=q_(e);for(o&&o.length&&(n=o),i=n.length;--i>=0;)if(r=t(n[i]))return r;if(n===o){for(n=e.items,i=n.length;--i>=0;)if(!n[i].zindex&&(r=t(n[i])))return r}return null}function H_(e){return function(t,n,r){li(n,i=>{(!r||r.intersects(i.bounds))&&x8(e,t,i,i)})}}function Yae(e){return function(t,n,r){n.items.length&&(!r||r.intersects(n.bounds))&&x8(e,t,n.items[0],n.items)}}function x8(e,t,n,r){var i=n.opacity==null?1:n.opacity;i!==0&&(e(t,r)||(Vl(t,n),n.fill&&am(t,n,i)&&t.fill(),n.stroke&&Xl(t,n,i)&&t.stroke()))}function um(e){return e=e||Dr,function(t,n,r,i,o,a){return r*=t.pixelRatio,i*=t.pixelRatio,sm(n,s=>{const u=s.bounds;if(!(u&&!u.contains(o,a)||!u)&&e(t,s,r,i,o,a))return s})}}function Nd(e,t){return function(n,r,i,o){var a=Array.isArray(r)?r[0]:r,s=t==null?a.fill:t,u=a.stroke&&n.isPointInStroke,l,c;return u&&(l=a.strokeWidth,c=a.strokeCap,n.lineWidth=l!=null?l:1,n.lineCap=c!=null?c:"butt"),e(n,r)?!1:s&&n.isPointInPath(i,o)||u&&n.isPointInStroke(i,o)}}function W_(e){return um(Nd(e))}function uu(e,t){return"translate("+e+","+t+")"}function G_(e){return"rotate("+e+")"}function Vae(e,t){return"scale("+e+","+t+")"}function w8(e){return uu(e.x||0,e.y||0)}function Xae(e){return uu(e.x||0,e.y||0)+(e.angle?" "+G_(e.angle):"")}function Kae(e){return uu(e.x||0,e.y||0)+(e.angle?" "+G_(e.angle):"")+(e.scaleX||e.scaleY?" "+Vae(e.scaleX||1,e.scaleY||1):"")}function Y_(e,t,n){function r(a,s){a("transform",Xae(s)),a("d",t(null,s))}function i(a,s){return t(Dd(a,s.angle),s),Uo(a,s).translate(s.x||0,s.y||0)}function o(a,s){var u=s.x||0,l=s.y||0,c=s.angle||0;a.translate(u,l),c&&a.rotate(c*=Na),a.beginPath(),t(a,s),c&&a.rotate(-c),a.translate(-u,-l)}return{type:e,tag:"path",nested:!1,attr:r,bound:i,draw:H_(o),pick:W_(o),isect:n||z_(o)}}var Zae=Y_("arc",Rae);function Jae(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],r=e[0].orient==="horizontal"?"y":"x",i=e.length,o=1/0,a,s;--i>=0;)e[i].defined!==!1&&(s=Math.abs(e[i][r]-n),s<o&&(o=s,a=e[i]));return a}function Qae(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),r=e.length,i,o,a;--r>=0;)if(e[r].defined!==!1&&(i=e[r].x-t[0],o=e[r].y-t[1],a=i*i+o*o,a<n))return e[r];return null}function ese(e,t){for(var n=e.length,r,i,o;--n>=0;)if(e[n].defined!==!1&&(r=e[n].x-t[0],i=e[n].y-t[1],o=r*r+i*i,r=e[n].size||1,o<r*r))return e[n];return null}function V_(e,t,n){function r(u,l){var c=l.mark.items;c.length&&u("d",t(null,c))}function i(u,l){var c=l.items;return c.length===0?u:(t(Dd(u),c),Uo(u,c[0]))}function o(u,l){u.beginPath(),t(u,l)}const a=Nd(o);function s(u,l,c,f,d,h){var g=l.items,p=l.bounds;return!g||!g.length||p&&!p.contains(d,h)?null:(c*=u.pixelRatio,f*=u.pixelRatio,a(u,g,c,f)?g[0]:null)}return{type:e,tag:"path",nested:!0,attr:r,bound:i,draw:Yae(o),pick:s,isect:U_,tip:n}}var tse=V_("area",Pae,Jae);function nse(e,t){var n=t.clip;e.save(),ye(n)?(e.beginPath(),n(e),e.clip()):_8(e,t.group)}function _8(e,t){e.beginPath(),D_(t)?Gl(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function E8(e){const t=ui(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function rse(e,t){e("transform",w8(t))}function $8(e,t){const n=E8(t);e("d",Gl(null,t,n,n))}function ise(e,t){e("class","background"),e("aria-hidden",!0),$8(e,t)}function ose(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?$8(e,t):e("d","")}function ase(e,t,n){const r=t.clip?N_(n,t,t):null;e("clip-path",r)}function sse(e,t){if(!t.clip&&t.items){const n=t.items,r=n.length;for(let i=0;i<r;++i)e.union(n[i].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),Uo(e,t),e.translate(t.x||0,t.y||0)}function Td(e,t,n,r){const i=E8(t);e.beginPath(),Gl(e,t,(n||0)+i,(r||0)+i)}const use=Nd(Td),lse=Nd(Td,!1),cse=Nd(Td,!0);function fse(e,t,n){li(t,r=>{const i=r.x||0,o=r.y||0,a=r.strokeForeground,s=r.opacity==null?1:r.opacity;(r.stroke||r.fill)&&s&&(Td(e,r,i,o),Vl(e,r),r.fill&&am(e,r,s)&&e.fill(),r.stroke&&!a&&Xl(e,r,s)&&e.stroke()),e.save(),e.translate(i,o),r.clip&&_8(e,r),n&&n.translate(-i,-o),li(r,u=>{this.draw(e,u,n)}),n&&n.translate(i,o),e.restore(),a&&r.stroke&&s&&(Td(e,r,i,o),Vl(e,r),Xl(e,r,s)&&e.stroke())})}function dse(e,t,n,r,i,o){if(t.bounds&&!t.bounds.contains(i,o)||!t.items)return null;const a=n*e.pixelRatio,s=r*e.pixelRatio;return sm(t,u=>{let l,c,f;const d=u.bounds;if(d&&!d.contains(i,o))return;c=u.x||0,f=u.y||0;const h=c+(u.width||0),g=f+(u.height||0),p=u.clip;if(p&&(i<c||i>h||o<f||o>g))return;if(e.save(),e.translate(c,f),c=i-c,f=o-f,p&&D_(u)&&!cse(e,u,a,s))return e.restore(),null;const m=u.strokeForeground,y=t.interactive!==!1;return y&&m&&u.stroke&&lse(e,u,a,s)?(e.restore(),u):(l=sm(u,v=>hse(v,c,f)?this.pick(v,n,r,c,f):null),!l&&y&&(u.fill||!m&&u.stroke)&&use(e,u,a,s)&&(l=u),e.restore(),l||null)})}function hse(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var gse={type:"group",tag:"g",nested:!1,attr:rse,bound:sse,draw:fse,pick:dse,isect:m8,content:ase,background:ise,foreground:ose},Rd={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function X_(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(r=>{e.image=r,e.image.url=e.url})),n}function K_(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function Z_(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function lm(e,t){return e==="center"?t/2:e==="right"?t:0}function cm(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function pse(e,t,n){const r=X_(t,n),i=K_(t,r),o=Z_(t,r),a=(t.x||0)-lm(t.align,i),s=(t.y||0)-cm(t.baseline,o),u=!r.src&&r.toDataURL?r.toDataURL():r.src||"";e("href",u,Rd["xmlns:xlink"],"xlink:href"),e("transform",uu(a,s)),e("width",i),e("height",o),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function mse(e,t){const n=t.image,r=K_(t,n),i=Z_(t,n),o=(t.x||0)-lm(t.align,r),a=(t.y||0)-cm(t.baseline,i);return e.set(o,a,o+r,a+i)}function yse(e,t,n){li(t,r=>{if(n&&!n.intersects(r.bounds))return;const i=X_(r,this);let o=K_(r,i),a=Z_(r,i);if(o===0||a===0)return;let s=(r.x||0)-lm(r.align,o),u=(r.y||0)-cm(r.baseline,a),l,c,f,d;r.aspect!==!1&&(c=i.width/i.height,f=r.width/r.height,c===c&&f===f&&c!==f&&(f<c?(d=o/c,u+=(a-d)/2,a=d):(d=a*c,s+=(o-d)/2,o=d))),(i.complete||i.toDataURL)&&(Vl(e,r),e.globalAlpha=(l=r.opacity)!=null?l:1,e.imageSmoothingEnabled=r.smooth!==!1,e.drawImage(i,s,u,o,a))})}var vse={type:"image",tag:"image",nested:!1,attr:pse,bound:mse,draw:yse,pick:um(),isect:Dr,get:X_,xOffset:lm,yOffset:cm},bse=V_("line",Lae,Qae);function xse(e,t){var n=t.scaleX||1,r=t.scaleY||1;(n!==1||r!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",Kae(t)),e("d",t.path)}function fm(e,t){var n=t.path;if(n==null)return!0;var r=t.x||0,i=t.y||0,o=t.scaleX||1,a=t.scaleY||1,s=(t.angle||0)*Na,u=t.pathCache;(!u||u.path!==n)&&((t.pathCache=u=Hl(n)).path=n),s&&e.rotate&&e.translate?(e.translate(r,i),e.rotate(s),Cd(e,u,0,0,o,a),e.rotate(-s),e.translate(-r,-i)):Cd(e,u,r,i,o,a)}function wse(e,t){return fm(Dd(e,t.angle),t)?e.set(0,0,0,0):Uo(e,t,!0)}var _se={type:"path",tag:"path",nested:!1,attr:xse,bound:wse,draw:H_(fm),pick:W_(fm),isect:z_(fm)};function Ese(e,t){e("d",Gl(null,t))}function $se(e,t){var n,r;return Uo(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)}function A8(e,t){e.beginPath(),Gl(e,t)}var Ase={type:"rect",tag:"path",nested:!1,attr:Ese,bound:$se,draw:H_(A8),pick:W_(A8),isect:m8};function Sse(e,t){e("transform",w8(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function Cse(e,t){var n,r;return Uo(e.set(n=t.x||0,r=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r),t)}function S8(e,t,n){var r,i,o,a;return t.stroke&&Xl(e,t,n)?(r=t.x||0,i=t.y||0,o=t.x2!=null?t.x2:r,a=t.y2!=null?t.y2:i,e.beginPath(),e.moveTo(r,i),e.lineTo(o,a),!0):!1}function Ose(e,t,n){li(t,r=>{if(!(n&&!n.intersects(r.bounds))){var i=r.opacity==null?1:r.opacity;i&&S8(e,r,i)&&(Vl(e,r),e.stroke())}})}function Fse(e,t,n,r){return e.isPointInStroke?S8(e,t,1)&&e.isPointInStroke(n,r):!1}var kse={type:"rule",tag:"line",nested:!1,attr:Sse,bound:Cse,draw:Ose,pick:um(Fse),isect:y8},Mse=Y_("shape",jae),Dse=Y_("symbol",Iae,U_);const C8=OM();var Xi={height:Ki,measureWidth:Q_,estimateWidth:J_,width:J_,canvas:O8};O8(!0);function O8(e){Xi.width=e&&Pa?Q_:J_}function J_(e,t){return F8(ja(e,t),Ki(e))}function F8(e,t){return~~(.8*e.length*t)}function Q_(e,t){return Ki(e)<=0||!(t=ja(e,t))?0:k8(t,dm(e))}function k8(e,t){const n=`(${t}) ${e}`;let r=C8.get(n);return r===void 0&&(Pa.font=t,r=Pa.measureText(e).width,C8.set(n,r)),r}function Ki(e){return e.fontSize!=null?+e.fontSize||0:11}function La(e){return e.lineHeight!=null?e.lineHeight:Ki(e)+2}function Nse(e){return ee(e)?e.length>1?e:e[0]:e}function Pd(e){return Nse(e.lineBreak&&e.text&&!ee(e.text)?e.text.split(e.lineBreak):e.text)}function eE(e){const t=Pd(e);return(ee(t)?t.length-1:0)*La(e)}function ja(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?Rse(e,n):n}function Tse(e){if(Xi.width===Q_){const t=dm(e);return n=>k8(n,t)}else{const t=Ki(e);return n=>F8(n,t)}}function Rse(e,t){var n=+e.limit,r=Tse(e);if(r(t)<n)return t;var i=e.ellipsis||"\u2026",o=e.dir==="rtl",a=0,s=t.length,u;if(n-=r(i),o){for(;a<s;)u=a+s>>>1,r(t.slice(u))>n?a=u+1:s=u;return i+t.slice(a)}else{for(;a<s;)u=1+(a+s>>>1),r(t.slice(0,u))<n?a=u:s=u-1;return t.slice(0,a)+i}}function Ld(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function dm(e,t){return""+(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+Ki(e)+"px "+Ld(e,t)}function tE(e){var t=e.baseline,n=Ki(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*La(e):t==="line-bottom"?.29*n-.5*La(e):0)}const Pse={left:"start",center:"middle",right:"end"},jd=new Ot;function hm(e){var t=e.x||0,n=e.y||0,r=e.radius||0,i;return r&&(i=(e.theta||0)-iu,t+=r*Math.cos(i),n+=r*Math.sin(i)),jd.x1=t,jd.y1=n,jd}function Lse(e,t){var n=t.dx||0,r=(t.dy||0)+tE(t),i=hm(t),o=i.x1,a=i.y1,s=t.angle||0,u;e("text-anchor",Pse[t.align]||"start"),s?(u=uu(o,a)+" "+G_(s),(n||r)&&(u+=" "+uu(n,r))):u=uu(o+n,a+r),e("transform",u)}function nE(e,t,n){var r=Xi.height(t),i=t.align,o=hm(t),a=o.x1,s=o.y1,u=t.dx||0,l=(t.dy||0)+tE(t)-Math.round(.8*r),c=Pd(t),f;if(ee(c)?(r+=La(t)*(c.length-1),f=c.reduce((d,h)=>Math.max(d,Xi.width(t,h)),0)):f=Xi.width(t,c),i==="center"?u-=f/2:i==="right"&&(u-=f),e.set(u+=a,l+=s,u+f,l+r),t.angle&&!n)e.rotate(t.angle*Na,a,s);else if(n===2)return e.rotatedPoints(t.angle*Na,a,s);return e}function jse(e,t,n){li(t,r=>{var i=r.opacity==null?1:r.opacity,o,a,s,u,l,c,f;if(!(n&&!n.intersects(r.bounds)||i===0||r.fontSize<=0||r.text==null||r.text.length===0)){if(e.font=dm(r),e.textAlign=r.align||"left",o=hm(r),a=o.x1,s=o.y1,r.angle&&(e.save(),e.translate(a,s),e.rotate(r.angle*Na),a=s=0),a+=r.dx||0,s+=(r.dy||0)+tE(r),c=Pd(r),Vl(e,r),ee(c))for(l=La(r),u=0;u<c.length;++u)f=ja(r,c[u]),r.fill&&am(e,r,i)&&e.fillText(f,a,s),r.stroke&&Xl(e,r,i)&&e.strokeText(f,a,s),s+=l;else f=ja(r,c),r.fill&&am(e,r,i)&&e.fillText(f,a,s),r.stroke&&Xl(e,r,i)&&e.strokeText(f,a,s);r.angle&&e.restore()}})}function Ise(e,t,n,r,i,o){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var a=hm(t),s=a.x1,u=a.y1,l=nE(jd,t,1),c=-t.angle*Na,f=Math.cos(c),d=Math.sin(c),h=f*i-d*o+(s-f*s+d*u),g=d*i+f*o+(u-d*s-f*u);return l.contains(h,g)}function Bse(e,t){const n=nE(jd,e,2);return Yl(t,n[0],n[1],n[2],n[3])||Yl(t,n[0],n[1],n[4],n[5])||Yl(t,n[4],n[5],n[6],n[7])||Yl(t,n[2],n[3],n[6],n[7])}var zse={type:"text",tag:"text",nested:!1,attr:Lse,bound:nE,draw:jse,pick:um(Ise),isect:Bse},Use=V_("trail",Bae,ese),yr={arc:Zae,area:tse,group:gse,image:vse,line:bse,path:_se,rect:Ase,rule:kse,shape:Mse,symbol:Dse,text:zse,trail:Use};function rE(e,t,n){var r=yr[e.mark.marktype],i=t||r.bound;return r.nested&&(e=e.mark),i(e.bounds||(e.bounds=new Ot),e,n)}var M8={mark:null};function D8(e,t,n){var r=yr[e.marktype],i=r.bound,o=e.items,a=o&&o.length,s,u,l,c;if(r.nested)return a?l=o[0]:(M8.mark=e,l=M8),c=rE(l,i,n),t=t&&t.union(c)||c,t;if(t=t||e.bounds&&e.bounds.clear()||new Ot,a)for(s=0,u=o.length;s<u;++s)t.union(rE(o[s],i,n));return e.bounds=t}const qse=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function N8(e,t){return JSON.stringify(e,qse,t)}function T8(e){const t=typeof e=="string"?JSON.parse(e):e;return R8(t)}function R8(e){var t=e.marktype,n=e.items,r,i,o;if(n)for(i=0,o=n.length;i<o;++i)r=t?"mark":"group",n[i][r]=e,n[i].zindex&&(n[i][r].zdirty=!0),(t||r)==="group"&&R8(n[i]);return t&&D8(e),e}function iE(e){arguments.length?this.root=T8(e):(this.root=P8({marktype:"group",name:"root",role:"frame"}),this.root.items=[new em(this.root)])}iE.prototype={toJSON(e){return N8(this.root,e||0)},mark(e,t,n){t=t||this.root.items[0];const r=P8(e,t);return t.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}};function P8(e,t){const n={bounds:new Ot,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function Ia(e,t,n){return!e&&typeof document!="undefined"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function oE(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function Xn(e,t,n,r){var i=e.childNodes[t],o;return(!i||i.tagName.toLowerCase()!==n.toLowerCase())&&(o=i||null,i=Ia(e.ownerDocument,n,r),e.insertBefore(i,o)),i}function ci(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function L8(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function gm(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function Hse(e,t,n,r){var i=e&&e.mark,o,a;if(i&&(o=yr[i.marktype]).tip){for(a=gm(t,n),a[0]-=r[0],a[1]-=r[1];e=e.mark.group;)a[0]-=e.x||0,a[1]-=e.y||0;e=o.tip(i.items,a)}return e}function Ba(e,t){this._active=null,this._handlers={},this._loader=e||rp(),this._tooltip=t||Wse}function Wse(e,t,n,r){e.element().setAttribute("title",r||"")}Ba.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let r=e?e.length:0;--r>=0;)if(e[r].type===t&&(!n||e[r].handler===n))return r;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const r in t)n.push(...t[r]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then(r=>{const i=new MouseEvent(e.type,e),o=Ia(null,"a");for(const a in r)o.setAttribute(a,r[a]);o.dispatchEvent(i)}).catch(()=>{})},handleTooltip(e,t,n){if(t&&t.tooltip!=null){t=Hse(t,e,this.canvas(),this._origin);const r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),r=this._origin,i=e.bounds,o=i.width(),a=i.height();let s=i.x1+r[0]+n.left,u=i.y1+r[1]+n.top;for(;e.mark&&(e=e.mark.group);)s+=e.x||0,u+=e.y||0;return{x:s,y:u,width:o,height:a,left:s,top:u,right:s+o,bottom:u+a}}};function Zi(e){this._el=null,this._bgcolor=null,this._loader=new T_(e)}Zi.prototype={initialize(e,t,n,r,i){return this._el=e,this.resize(t,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return arguments.length===0?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){const t=this.render(e);return this._ready?this._ready.then(()=>t):Promise.resolve(t)},_load(e,t){var n=this,r=n._loader[e](t);if(!n._ready){const i=n._call;n._ready=n._loader.ready().then(o=>{o&&i(),n._ready=null})}return r},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const Gse="keydown",Yse="keypress",Vse="keyup",j8="dragenter",pm="dragleave",I8="dragover",aE="mousedown",Xse="mouseup",mm="mousemove",Id="mouseout",B8="mouseover",ym="click",Kse="dblclick",Zse="wheel",z8="mousewheel",vm="touchstart",bm="touchmove",xm="touchend",Jse=[Gse,Yse,Vse,j8,pm,I8,aE,Xse,mm,Id,B8,ym,Kse,Zse,z8,vm,bm,xm],sE=mm,Bd=Id,uE=ym;function zd(e,t){Ba.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}const Qse=e=>e===vm||e===bm||e===xm?[vm,bm,xm]:[e];function U8(e,t){Qse(t).forEach(n=>eue(e,n))}function eue(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?r=>e[t](r):r=>e.fire(t,r)))}function q8(e,t,n){return function(r){const i=this._active,o=this.pickEvent(r);o===i?this.fire(e,r):((!i||!i.exit)&&this.fire(n,r),this._active=o,this.fire(t,r),this.fire(e,r))}}function H8(e){return function(t){this.fire(e,t),this._active=null}}H(zd,Ba,{initialize(e,t,n){return this._canvas=e&&oE(e,"canvas"),[ym,aE,mm,Id,pm].forEach(r=>U8(this,r)),Ba.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:Jse,DOMMouseScroll(e){this.fire(z8,e)},mousemove:q8(mm,B8,Id),dragover:q8(I8,j8,pm),mouseout:H8(Id),dragleave:H8(pm),mousedown(e){this._down=this._active,this.fire(aE,e)},click(e){this._down===this._active&&(this.fire(ym,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(vm,e,!0)},touchmove(e){this.fire(bm,e,!0)},touchend(e){this.fire(xm,e,!0),this._touch=null},fire(e,t,n){const r=n?this._touch:this._active,i=this._handlers[e];if(t.vegaType=e,e===uE&&r&&r.href?this.handleHref(t,r,r.href):(e===sE||e===Bd)&&this.handleTooltip(t,r,e!==Bd),i)for(let o=0,a=i.length;o<a;++o)i[o].handler.call(this._obj,t,r)},on(e,t){const n=this.eventName(e),r=this._handlers;return this._handlerIndex(r[n],e,t)<0&&(U8(this,e),(r[n]||(r[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&r.splice(i,1),this},pickEvent(e){const t=gm(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,r,i){const o=this.context();return yr[e.marktype].pick.call(this,o,e,t,n,r,i)}});function tue(){return typeof window!="undefined"&&window.devicePixelRatio||1}var nue=tue();function rue(e,t,n,r,i,o){const a=typeof HTMLElement!="undefined"&&e instanceof HTMLElement&&e.parentNode!=null,s=e.getContext("2d"),u=a?nue:i;e.width=t*u,e.height=n*u;for(const l in o)s[l]=o[l];return a&&u!==1&&(e.style.width=t+"px",e.style.height=n+"px"),s.pixelRatio=u,s.setTransform(u,0,0,u,u*r[0],u*r[1]),e}function wm(e){Zi.call(this,e),this._options={},this._redraw=!1,this._dirty=new Ot,this._tempb=new Ot}const W8=Zi.prototype,iue=(e,t,n)=>new Ot().set(0,0,t,n).translate(-e[0],-e[1]);function oue(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}H(wm,Zi,{initialize(e,t,n,r,i,o){return this._options=o||{},this._canvas=this._options.externalContext?null:Nl(1,1,this._options.type),e&&this._canvas&&(ci(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),W8.initialize.call(this,e,t,n,r,i)},resize(e,t,n,r){if(W8.resize.call(this,e,t,n,r),this._canvas)rue(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const i=this._options.externalContext;i||B("CanvasRenderer is missing a valid canvas or context"),i.scale(this._scale,this._scale),i.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,r=this._width,i=this._height,o=this._dirty,a=iue(n,r,i);t.save();const s=this._redraw||o.empty()?(this._redraw=!1,a.expand(1)):oue(t,a.intersect(o),n);return this.clear(-n[0],-n[1],r,i),this.draw(t,e,s),t.restore(),o.clear(),this},draw(e,t,n){const r=yr[t.marktype];t.clip&&nse(e,t),r.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,r){const i=this._options,o=this.context();i.type!=="pdf"&&!i.externalContext&&o.clearRect(e,t,n,r),this._bgcolor!=null&&(o.fillStyle=this._bgcolor,o.fillRect(e,t,n,r))}});function lE(e,t){Ba.call(this,e,t);const n=this;n._hrefHandler=cE(n,(r,i)=>{i&&i.href&&n.handleHref(r,i,i.href)}),n._tooltipHandler=cE(n,(r,i)=>{n.handleTooltip(r,i,r.type!==Bd)})}const cE=(e,t)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)};H(lE,Ba,{initialize(e,t,n){let r=this._svg;return r&&(r.removeEventListener(uE,this._hrefHandler),r.removeEventListener(sE,this._tooltipHandler),r.removeEventListener(Bd,this._tooltipHandler)),this._svg=r=e&&oE(e,"svg"),r&&(r.addEventListener(uE,this._hrefHandler),r.addEventListener(sE,this._tooltipHandler),r.addEventListener(Bd,this._tooltipHandler)),Ba.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[n],e,t)<0){const o={type:e,handler:t,listener:cE(this,t)};(r[n]||(r[n]=[])).push(o),this._svg&&this._svg.addEventListener(n,o.listener)}return this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const G8="aria-hidden",fE="aria-label",dE="role",hE="aria-roledescription",Y8="graphics-object",gE="graphics-symbol",V8=(e,t,n)=>({[dE]:e,[hE]:t,[fE]:n||void 0}),aue=oi(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),X8={axis:{desc:"axis",caption:lue},legend:{desc:"legend",caption:cue},"title-text":{desc:"title",caption:e=>`Title text '${Q8(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${Q8(e)}'`}},K8={ariaRole:dE,ariaRoleDescription:hE,description:fE};function Z8(e,t){const n=t.aria===!1;if(e(G8,n||void 0),n||t.description==null)for(const r in K8)e(K8[r],void 0);else{const r=t.mark.marktype;e(fE,t.description),e(dE,t.ariaRole||(r==="group"?Y8:gE)),e(hE,t.ariaRoleDescription||`${r} mark`)}}function J8(e){return e.aria===!1?{[G8]:!0}:aue[e.role]?null:X8[e.role]?uue(e,X8[e.role]):sue(e)}function sue(e){const t=e.marktype,n=t==="group"||t==="text"||e.items.some(r=>r.description!=null&&r.aria!==!1);return V8(n?Y8:gE,`${t} mark container`,e.description)}function uue(e,t){try{const n=e.items[0],r=t.caption||(()=>"");return V8(t.role||gE,t.desc,n.description||r(n))}catch(n){return null}}function Q8(e){return ae(e.text).join(" ")}function lue(e){const t=e.datum,n=e.orient,r=t.title?e4(e):null,i=e.context,o=i.scales[t.scale].value,a=i.dataflow.locale(),s=o.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(r?` titled '${r}'`:"")+` for a ${ql(s)?"discrete":s} scale with ${K6(a,o,e)}`}function cue(e){const t=e.datum,n=t.title?e4(e):null,r=`${t.type||""} legend`.trim(),i=t.scales,o=Object.keys(i),a=e.context,s=a.scales[i[o[0]]].value,u=a.dataflow.locale();return due(r)+(n?` titled '${n}'`:"")+` for ${fue(o)} with ${K6(u,s,e)}`}function e4(e){try{return ae(Se(e.items).items[0].text).join(" ")}catch(t){return null}}function fue(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+Se(e)}function due(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const t4=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),hue=e=>t4(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function pE(){let e="",t="",n="";const r=[],i=()=>t=n="",o=u=>{t&&(e+=`${t}>${n}`,i()),r.push(u)},a=(u,l)=>(l!=null&&(t+=` ${u}="${hue(l)}"`),s),s={open(u,...l){o(u),t="<"+u;for(const c of l)for(const f in c)a(f,c[f]);return s},close(){const u=r.pop();return t?e+=t+(n?`>${n}</${u}>`:"/>"):e+=`</${u}>`,i(),s},attr:a,text:u=>(n+=t4(u),s),toString:()=>e};return s}const n4=e=>r4(pE(),e)+"";function r4(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,r=n.length;for(let i=0;i<r;++i)e.attr(n[i].name,n[i].value)}if(t.hasChildNodes()){const n=t.childNodes,r=n.length;for(let i=0;i<r;i++){const o=n[i];o.nodeType===3?e.text(o.nodeValue):r4(e,o)}}return e.close()}const _m={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},i4={fill:"none","stroke-miterlimit":10},Ud=0,o4="http://www.w3.org/2000/xmlns/",Ft=Rd.xmlns;function mE(e){Zi.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const yE=Zi.prototype;H(mE,Zi,{initialize(e,t,n,r,i){return this._defs={},this._clearDefs(),e&&(this._svg=Xn(e,0,"svg",Ft),this._svg.setAttributeNS(o4,"xmlns",Ft),this._svg.setAttributeNS(o4,"xmlns:xlink",Rd["xmlns:xlink"]),this._svg.setAttribute("version",Rd.version),this._svg.setAttribute("class","marks"),ci(e,1),this._root=Xn(this._svg,Ud,"g",Ft),za(this._root,i4),ci(this._svg,Ud+1)),this.background(this._bgcolor),yE.initialize.call(this,e,t,n,r,i)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),yE.background.apply(this,arguments)},resize(e,t,n,r){return yE.resize.call(this,e,t,n,r),this._svg&&(za(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=Xn(e,Ud,"rect",Ft),za(n,{width:this._width,height:this._height,fill:t}));const r=n4(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),r},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),ci(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,r,i,o,a,s,u;for(a=0,s=e.length;a<s;++a)if(n=e[a],r=n.mark,r.marktype!==i&&(i=r.marktype,o=yr[i]),r.zdirty&&r.dirty!==t&&(this._dirtyAll=!1,a4(n,t),r.items.forEach(l=>{l.dirty=t})),!r.zdirty){if(n.exit){o.nested&&r.items.length?(u=r.items[0],u._svg&&this._update(o,u._svg,u)):n._svg&&(u=n._svg.parentNode,u&&u.removeChild(n._svg)),n._svg=null;continue}n=o.nested?r.items[0]:n,n._update!==t&&(!n._svg||!n._svg.ownerSVGElement?(this._dirtyAll=!1,a4(n,t)):this._update(o,n._svg,n),n._update=t)}return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;const r=this._svg,i=yr[t.marktype],o=t.interactive===!1?"none":null,a=i.tag==="g";let s=null,u=0;const l=s4(t,e,n,"g",r);l.setAttribute("class",L8(t));const c=J8(t);for(const d in c)$n(l,d,c[d]);a||$n(l,"pointer-events",o),$n(l,"clip-path",t.clip?N_(this,t,t.group):null);const f=d=>{const h=this.isDirty(d),g=s4(d,l,s,i.tag,r);h&&(this._update(i,g,d),a&&mue(this,g,d)),s=g,++u};return i.nested?t.items.length&&f(t.items[0]):li(t,f),ci(l,u),l},_update(e,t,n){qo=t,ln=t.__values__,Z8(qd,n),e.attr(qd,n,this);const r=vue[e.type];r&&r.call(this,e,t,n),qo&&this.style(qo,n)},style(e,t){if(t!=null)for(const n in _m){let r=n==="font"?Ld(t):t[n];if(r===ln[n])continue;const i=_m[n];r==null?e.removeAttribute(i):(C_(r)&&(r=J6(r,this._defs.gradient,u4())),e.setAttribute(i,r+"")),ln[n]=r}},defs(){const e=this._svg,t=this._defs;let n=t.el,r=0;for(const i in t.gradient)n||(t.el=n=Xn(e,Ud+1,"defs",Ft)),r=gue(n,t.gradient[i],r);for(const i in t.clipping)n||(t.el=n=Xn(e,Ud+1,"defs",Ft)),r=pue(n,t.clipping[i],r);n&&(r===0?(e.removeChild(n),t.el=null):ci(n,r))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});function a4(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function gue(e,t,n){let r,i,o;if(t.gradient==="radial"){let a=Xn(e,n++,"pattern",Ft);za(a,{id:Kp+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),a=Xn(a,0,"rect",Ft),za(a,{width:1,height:1,fill:`url(${u4()}#${t.id})`}),e=Xn(e,n++,"radialGradient",Ft),za(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=Xn(e,n++,"linearGradient",Ft),za(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,i=t.stops.length;r<i;++r)o=Xn(e,r,"stop",Ft),o.setAttribute("offset",t.stops[r].offset),o.setAttribute("stop-color",t.stops[r].color);return ci(e,r),n}function pue(e,t,n){let r;return e=Xn(e,n,"clipPath",Ft),e.setAttribute("id",t.id),t.path?(r=Xn(e,0,"path",Ft),r.setAttribute("d",t.path)):(r=Xn(e,0,"rect",Ft),za(r,{x:0,y:0,width:t.width,height:t.height})),ci(e,1),n+1}function mue(e,t,n){t=t.lastChild.previousSibling;let r,i=0;li(n,o=>{r=e.mark(t,o,r),++i}),ci(t,1+i)}function s4(e,t,n,r,i){let o=e._svg,a;if(!o&&(a=t.ownerDocument,o=Ia(a,r,Ft),e._svg=o,e.mark&&(o.__data__=e,o.__values__={fill:"default"},r==="g"))){const s=Ia(a,"path",Ft);o.appendChild(s),s.__data__=e;const u=Ia(a,"g",Ft);o.appendChild(u),u.__data__=e;const l=Ia(a,"path",Ft);o.appendChild(l),l.__data__=e,l.__values__={fill:"default"}}return(o.ownerSVGElement!==i||yue(o,n))&&t.insertBefore(o,n?n.nextSibling:t.firstChild),o}function yue(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}let qo=null,ln=null;const vue={group(e,t,n){const r=qo=t.childNodes[2];ln=r.__values__,e.foreground(qd,n,this),ln=t.__values__,qo=t.childNodes[1],e.content(qd,n,this);const i=qo=t.childNodes[0];e.background(qd,n,this);const o=n.mark.interactive===!1?"none":null;if(o!==ln.events&&($n(r,"pointer-events",o),$n(i,"pointer-events",o),ln.events=o),n.strokeForeground&&n.stroke){const a=n.fill;$n(r,"display",null),this.style(i,n),$n(i,"stroke",null),a&&(n.fill=null),ln=r.__values__,this.style(r,n),a&&(n.fill=a),qo=null}else $n(r,"display","none")},image(e,t,n){n.smooth===!1?(vE(t,"image-rendering","optimizeSpeed"),vE(t,"image-rendering","pixelated")):vE(t,"image-rendering",null)},text(e,t,n){const r=Pd(n);let i,o,a,s;ee(r)?(o=r.map(u=>ja(n,u)),i=o.join(`
`),i!==ln.text&&(ci(t,0),a=t.ownerDocument,s=La(n),o.forEach((u,l)=>{const c=Ia(a,"tspan",Ft);c.__data__=n,c.textContent=u,l&&(c.setAttribute("x",0),c.setAttribute("dy",s)),t.appendChild(c)}),ln.text=i)):(o=ja(n,r),o!==ln.text&&(t.textContent=o,ln.text=o)),$n(t,"font-family",Ld(n)),$n(t,"font-size",Ki(n)+"px"),$n(t,"font-style",n.fontStyle),$n(t,"font-variant",n.fontVariant),$n(t,"font-weight",n.fontWeight)}};function qd(e,t,n){t!==ln[e]&&(n?bue(qo,e,t,n):$n(qo,e,t),ln[e]=t)}function vE(e,t,n){n!==ln[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),ln[t]=n)}function za(e,t){for(const n in t)$n(e,n,t[n])}function $n(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function bue(e,t,n,r){n!=null?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}function u4(){let e;return typeof window=="undefined"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function bE(e){Zi.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}H(bE,Zi,{svg(){return this._text},_render(e){const t=pE();t.open("svg",pe({},Rd,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&n!=="transparent"&&n!=="none"&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",i4,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=yr[t.marktype],r=n.tag,i=[Z8,n.attr];e.open("g",{class:L8(t),"clip-path":t.clip?N_(this,t,t.group):null},J8(t),{"pointer-events":r!=="g"&&t.interactive===!1?"none":null});const o=a=>{const s=this.href(a);if(s&&e.open("a",s),e.open(r,this.attr(t,a,i,r!=="g"?r:null)),r==="text"){const u=Pd(a);if(ee(u)){const l={x:0,dy:La(a)};for(let c=0;c<u.length;++c)e.open("tspan",c?l:null).text(ja(a,u[c])).close()}else e.text(ja(a,u))}else if(r==="g"){const u=a.strokeForeground,l=a.fill,c=a.stroke;u&&c&&(a.stroke=null),e.open("path",this.attr(t,a,n.background,"bgrect")).close(),e.open("g",this.attr(t,a,n.content)),li(a,f=>this.mark(e,f)),e.close(),u&&c?(l&&(a.fill=null),a.stroke=c,e.open("path",this.attr(t,a,n.foreground,"bgrect")).close(),l&&(a.fill=l)):e.open("path",this.attr(t,a,n.foreground,"bgfore")).close()}e.close(),s&&e.close()};return n.nested?t.items&&t.items.length&&o(t.items[0]):li(t,o),e.close()},href(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then(r=>{r["xlink:href"]=r.href,r.href=null,(this._hrefs||(this._hrefs={}))[t]=r})}return null},attr(e,t,n,r){const i={},o=(a,s,u,l)=>{i[l||a]=s};return Array.isArray(n)?n.forEach(a=>a(o,t,this)):n(o,t,this),r&&xue(i,t,e,r,this._defs),i},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(Object.keys(t).length+Object.keys(n).length!==0){e.open("defs");for(const i in t){const o=t[i],a=o.stops;o.gradient==="radial"?(e.open("pattern",{id:Kp+i,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+i+")"}).close(),e.close(),e.open("radialGradient",{id:i,fx:o.x1,fy:o.y1,fr:o.r1,cx:o.x2,cy:o.y2,r:o.r2})):e.open("linearGradient",{id:i,x1:o.x1,x2:o.x2,y1:o.y1,y2:o.y2});for(let s=0;s<a.length;++s)e.open("stop",{offset:a[s].offset,"stop-color":a[s].color}).close();e.close()}for(const i in n){const o=n[i];e.open("clipPath",{id:i}),o.path?e.open("path",{d:o.path}).close():e.open("rect",{x:0,y:0,width:o.width,height:o.height}).close(),e.close()}e.close()}}});function xue(e,t,n,r,i){if(t==null||(r==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),r==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;r==="image"&&t.smooth===!1&&(e.style="image-rendering: optimizeSpeed; image-rendering: pixelated;"),r==="text"&&(e["font-family"]=Ld(t),e["font-size"]=Ki(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const o in _m){let a=t[o];const s=_m[o];a==="transparent"&&(s==="fill"||s==="stroke")||a!=null&&(C_(a)&&(a=J6(a,i.gradient,"")),e[s]=a)}return e}const l4="canvas",c4="png",f4="svg",d4="none",Ua={Canvas:l4,PNG:c4,SVG:f4,None:d4},Kl={};Kl[l4]=Kl[c4]={renderer:wm,headless:wm,handler:zd};Kl[f4]={renderer:mE,headless:bE,handler:lE};Kl[d4]={};function Em(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(Kl[e]=t,this):Kl[e]}function h4(e,t,n){const r=[],i=new Ot().union(t),o=e.marktype;return o?g4(e,i,n,r):o==="group"?p4(e,i,n,r):B("Intersect scene must be mark node or group item.")}function g4(e,t,n,r){if(wue(e,t,n)){const i=e.items,o=e.marktype,a=i.length;let s=0;if(o==="group")for(;s<a;++s)p4(i[s],t,n,r);else for(const u=yr[o].isect;s<a;++s){const l=i[s];m4(l,t,u)&&r.push(l)}}return r}function wue(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function p4(e,t,n,r){n&&n(e.mark)&&m4(e,t,yr.group.isect)&&r.push(e);const i=e.items,o=i&&i.length;if(o){const a=e.x||0,s=e.y||0;t.translate(-a,-s);for(let u=0;u<o;++u)g4(i[u],t,n,r);t.translate(a,s)}return r}function m4(e,t,n){const r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}const xE=new Ot;function y4(e){const t=e.clip;if(ye(t))t(Dd(xE.clear()));else if(t)xE.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(xE)}const _ue=1e-9;function wE(e,t,n){return e===t?!0:n==="path"?v4(e,t):e instanceof Date&&t instanceof Date?+e==+t:_a(e)&&_a(t)?Math.abs(e-t)<=_ue:!e||!t||!le(e)&&!le(t)?e==t:Eue(e,t)}function v4(e,t){return wE(Hl(e),Hl(t))}function Eue(e,t){var n=Object.keys(e),r=Object.keys(t),i,o;if(n.length!==r.length)return!1;for(n.sort(),r.sort(),o=n.length-1;o>=0;o--)if(n[o]!=r[o])return!1;for(o=n.length-1;o>=0;o--)if(i=n[o],!wE(e[i],t[i],i))return!1;return typeof e==typeof t}function $ue(){l8(),eae()}const Zl="top",fi="left",di="right",qa="bottom",Aue="top-left",Sue="top-right",Cue="bottom-left",Oue="bottom-right",_E="start",EE="middle",An="end",Fue="x",kue="y",$m="group",$E="axis",AE="title",Mue="frame",Due="scope",SE="legend",b4="row-header",x4="row-footer",w4="row-title",_4="column-header",E4="column-footer",$4="column-title",Nue="padding",Tue="symbol",A4="fit",Rue="fit-x",Pue="fit-y",Lue="pad",CE="none",Am="all",OE="each",FE="flush",Ha="column",Wa="row";function S4(e){R.call(this,null,e)}H(S4,R,{transform(e,t){const n=t.dataflow,r=e.mark,i=r.marktype,o=yr[i],a=o.bound;let s=r.bounds,u;if(o.nested)r.items.length&&n.dirty(r.items[0]),s=Sm(r,a),r.items.forEach(l=>{l.bounds.clear().union(s)});else if(i===$m||e.modified())switch(t.visit(t.MOD,l=>n.dirty(l)),s.clear(),r.items.forEach(l=>s.union(Sm(l,a))),r.role){case $E:case SE:case AE:t.reflow()}else u=t.changed(t.REM),t.visit(t.ADD,l=>{s.union(Sm(l,a))}),t.visit(t.MOD,l=>{u=u||s.alignsWith(l.bounds),n.dirty(l),s.union(Sm(l,a))}),u&&(s.clear(),r.items.forEach(l=>s.union(l.bounds)));return y4(r),t.modifies("bounds")}});function Sm(e,t,n){return t(e.bounds.clear(),e,n)}const C4=":vega_identifier:";function kE(e){R.call(this,0,e)}kE.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]};H(kE,R,{transform(e,t){const n=jue(t.dataflow),r=e.as;let i=n.value;return t.visit(t.ADD,o=>o[r]=o[r]||++i),n.set(this.value=i),t}});function jue(e){return e._signals[C4]||(e._signals[C4]=e.add(0))}function O4(e){R.call(this,null,e)}H(O4,R,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,Iue(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const r=n.marktype===$m?em:Qp;return t.visit(t.ADD,i=>r.call(i,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});function Iue(e){const t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function F4(e){R.call(this,null,e)}const k4={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((r,i)=>!i||!M4(n.bounds,r.bounds,t)?(n=r,1):r.opacity=0)}},M4=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),D4=(e,t)=>{for(var n=1,r=e.length,i=e[0].bounds,o;n<r;i=o,++n)if(M4(i,o=e[n].bounds,t))return!0},Bue=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},zue=(e,t,n)=>{var r=e.range(),i=new Ot;return t===Zl||t===qa?i.set(r[0],-1/0,r[1],1/0):i.set(-1/0,r[0],1/0,r[1]),i.expand(n||1),o=>i.encloses(o.bounds)},N4=e=>(e.forEach(t=>t.opacity=1),e),T4=(e,t)=>e.reflow(t.modified()).modifies("opacity");H(F4,R,{transform(e,t){const n=k4[e.method]||k4.parity,r=e.separation||0;let i=t.materialize(t.SOURCE).source,o,a;if(!i||!i.length)return;if(!e.method)return e.modified("method")&&(N4(i),t=T4(t,e)),t;if(i=i.filter(Bue),!i.length)return;if(e.sort&&(i=i.slice().sort(e.sort)),o=N4(i),t=T4(t,e),o.length>=3&&D4(o,r)){do o=n(o,r);while(o.length>=3&&D4(o,r));o.length<3&&!Se(i).opacity&&(o.length>1&&(Se(o).opacity=0),Se(i).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(a=zue(e.boundScale,e.boundOrient,+e.boundTolerance),i.forEach(u=>{a(u)||(u.opacity=0)}));const s=o[0].mark.bounds.clear();return i.forEach(u=>{u.opacity&&s.union(u.bounds)}),t}});function R4(e){R.call(this,null,e)}H(R4,R,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,r=>n.dirty(r)),t.fields&&t.fields.zindex){const r=t.source&&t.source[0];r&&(r.mark.zdirty=!0)}}});const cn=new Ot;function Jl(e,t,n){return e[t]===n?0:(e[t]=n,1)}function Uue(e){var t=e.items[0].orient;return t===fi||t===di}function que(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function Hue(e,t,n,r){var i=t.items[0],o=i.datum,a=i.translate!=null?i.translate:.5,s=i.orient,u=que(o),l=i.range,c=i.offset,f=i.position,d=i.minExtent,h=i.maxExtent,g=o.title&&i.items[u[2]].items[0],p=i.titlePadding,m=i.bounds,y=g&&eE(g),v=0,b=0,x,w;switch(cn.clear().union(m),m.clear(),(x=u[0])>-1&&m.union(i.items[x].bounds),(x=u[1])>-1&&m.union(i.items[x].bounds),s){case Zl:v=f||0,b=-c,w=Math.max(d,Math.min(h,-m.y1)),m.add(0,-w).add(l,0),g&&Cm(e,g,w,p,y,0,-1,m);break;case fi:v=-c,b=f||0,w=Math.max(d,Math.min(h,-m.x1)),m.add(-w,0).add(0,l),g&&Cm(e,g,w,p,y,1,-1,m);break;case di:v=n+c,b=f||0,w=Math.max(d,Math.min(h,m.x2)),m.add(0,0).add(w,l),g&&Cm(e,g,w,p,y,1,1,m);break;case qa:v=f||0,b=r+c,w=Math.max(d,Math.min(h,m.y2)),m.add(0,0).add(l,w),g&&Cm(e,g,w,p,0,0,1,m);break;default:v=i.x,b=i.y}return Uo(m.translate(v,b),i),Jl(i,"x",v+a)|Jl(i,"y",b+a)&&(i.bounds=cn,e.dirty(i),i.bounds=m,e.dirty(i)),i.mark.bounds.clear().union(m)}function Cm(e,t,n,r,i,o,a,s){const u=t.bounds;if(t.auto){const l=a*(n+i+r);let c=0,f=0;e.dirty(t),o?c=(t.x||0)-(t.x=l):f=(t.y||0)-(t.y=l),t.mark.bounds.clear().union(u.translate(-c,-f)),e.dirty(t)}s.union(u)}const P4=(e,t)=>Math.floor(Math.min(e,t)),L4=(e,t)=>Math.ceil(Math.max(e,t));function Wue(e){var t=e.items,n=t.length,r=0,i,o;const a={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;r<n;++r)if(i=t[r],o=i.items,i.marktype===$m)switch(i.role){case $E:case SE:case AE:break;case b4:a.rowheaders.push(...o);break;case x4:a.rowfooters.push(...o);break;case _4:a.colheaders.push(...o);break;case E4:a.colfooters.push(...o);break;case w4:a.rowtitle=o[0];break;case $4:a.coltitle=o[0];break;default:a.marks.push(...o)}return a}function Gue(e){return new Ot().set(0,0,e.width||0,e.height||0)}function Yue(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function rt(e,t,n){const r=le(e)?e[t]:e;return r!=null?r:n!==void 0?n:0}function j4(e){return e<0?Math.ceil(-e):0}function I4(e,t,n){var r=!n.nodirty,i=n.bounds===FE?Gue:Yue,o=cn.set(0,0,0,0),a=rt(n.align,Ha),s=rt(n.align,Wa),u=rt(n.padding,Ha),l=rt(n.padding,Wa),c=n.columns||t.length,f=c<=0?1:Math.ceil(t.length/c),d=t.length,h=Array(d),g=Array(c),p=0,m=Array(d),y=Array(f),v=0,b=Array(d),x=Array(d),w=Array(d),E,_,S,C,O,$,M,F,N,A,k;for(_=0;_<c;++_)g[_]=0;for(_=0;_<f;++_)y[_]=0;for(_=0;_<d;++_)$=t[_],O=w[_]=i($),$.x=$.x||0,b[_]=0,$.y=$.y||0,x[_]=0,S=_%c,C=~~(_/c),p=Math.max(p,M=Math.ceil(O.x2)),v=Math.max(v,F=Math.ceil(O.y2)),g[S]=Math.max(g[S],M),y[C]=Math.max(y[C],F),h[_]=u+j4(O.x1),m[_]=l+j4(O.y1),r&&e.dirty(t[_]);for(_=0;_<d;++_)_%c==0&&(h[_]=0),_<c&&(m[_]=0);if(a===OE)for(S=1;S<c;++S){for(k=0,_=S;_<d;_+=c)k<h[_]&&(k=h[_]);for(_=S;_<d;_+=c)h[_]=k+g[S-1]}else if(a===Am){for(k=0,_=0;_<d;++_)_%c&&k<h[_]&&(k=h[_]);for(_=0;_<d;++_)_%c&&(h[_]=k+p)}else for(a=!1,S=1;S<c;++S)for(_=S;_<d;_+=c)h[_]+=g[S-1];if(s===OE)for(C=1;C<f;++C){for(k=0,_=C*c,E=_+c;_<E;++_)k<m[_]&&(k=m[_]);for(_=C*c;_<E;++_)m[_]=k+y[C-1]}else if(s===Am){for(k=0,_=c;_<d;++_)k<m[_]&&(k=m[_]);for(_=c;_<d;++_)m[_]=k+v}else for(s=!1,C=1;C<f;++C)for(_=C*c,E=_+c;_<E;++_)m[_]+=y[C-1];for(N=0,_=0;_<d;++_)N=h[_]+(_%c?N:0),b[_]+=N-t[_].x;for(S=0;S<c;++S)for(A=0,_=S;_<d;_+=c)A+=m[_],x[_]+=A-t[_].y;if(a&&rt(n.center,Ha)&&f>1)for(_=0;_<d;++_)O=a===Am?p:g[_%c],N=O-w[_].x2-t[_].x-b[_],N>0&&(b[_]+=N/2);if(s&&rt(n.center,Wa)&&c!==1)for(_=0;_<d;++_)O=s===Am?v:y[~~(_/c)],A=O-w[_].y2-t[_].y-x[_],A>0&&(x[_]+=A/2);for(_=0;_<d;++_)o.union(w[_].translate(b[_],x[_]));switch(N=rt(n.anchor,Fue),A=rt(n.anchor,kue),rt(n.anchor,Ha)){case An:N-=o.width();break;case EE:N-=o.width()/2}switch(rt(n.anchor,Wa)){case An:A-=o.height();break;case EE:A-=o.height()/2}for(N=Math.round(N),A=Math.round(A),o.clear(),_=0;_<d;++_)t[_].mark.bounds.clear();for(_=0;_<d;++_)$=t[_],$.x+=b[_]+=N,$.y+=x[_]+=A,o.union($.mark.bounds.union($.bounds.translate(b[_],x[_]))),r&&e.dirty($);return o}function Vue(e,t,n){var r=Wue(t),i=r.marks,o=n.bounds===FE?Xue:Kue,a=n.offset,s=n.columns||i.length,u=s<=0?1:Math.ceil(i.length/s),l=u*s,c,f,d,h,g,p,m;const y=I4(e,i,n);y.empty()&&y.set(0,0,0,0),r.rowheaders&&(p=rt(n.headerBand,Wa,null),c=Om(e,r.rowheaders,i,s,u,-rt(a,"rowHeader"),P4,0,o,"x1",0,s,1,p)),r.colheaders&&(p=rt(n.headerBand,Ha,null),f=Om(e,r.colheaders,i,s,s,-rt(a,"columnHeader"),P4,1,o,"y1",0,1,s,p)),r.rowfooters&&(p=rt(n.footerBand,Wa,null),d=Om(e,r.rowfooters,i,s,u,rt(a,"rowFooter"),L4,0,o,"x2",s-1,s,1,p)),r.colfooters&&(p=rt(n.footerBand,Ha,null),h=Om(e,r.colfooters,i,s,s,rt(a,"columnFooter"),L4,1,o,"y2",l-s,1,s,p)),r.rowtitle&&(g=rt(n.titleAnchor,Wa),m=rt(a,"rowTitle"),m=g===An?d+m:c-m,p=rt(n.titleBand,Wa,.5),B4(e,r.rowtitle,m,0,y,p)),r.coltitle&&(g=rt(n.titleAnchor,Ha),m=rt(a,"columnTitle"),m=g===An?h+m:f-m,p=rt(n.titleBand,Ha,.5),B4(e,r.coltitle,m,1,y,p))}function Xue(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):void 0}function Kue(e,t){return e.bounds[t]}function Om(e,t,n,r,i,o,a,s,u,l,c,f,d,h){var g=n.length,p=0,m=0,y,v,b,x,w,E,_,S,C;if(!g)return p;for(y=c;y<g;y+=f)n[y]&&(p=a(p,u(n[y],l)));if(!t.length)return p;for(t.length>i&&(e.warn("Grid headers exceed limit: "+i),t=t.slice(0,i)),p+=o,v=0,x=t.length;v<x;++v)e.dirty(t[v]),t[v].mark.bounds.clear();for(y=c,v=0,x=t.length;v<x;++v,y+=f){for(E=t[v],w=E.mark.bounds,b=y;b>=0&&(_=n[b])==null;b-=d);s?(S=h==null?_.x:Math.round(_.bounds.x1+h*_.bounds.width()),C=p):(S=p,C=h==null?_.y:Math.round(_.bounds.y1+h*_.bounds.height())),w.union(E.bounds.translate(S-(E.x||0),C-(E.y||0))),E.x=S,E.y=C,e.dirty(E),m=a(m,w[l])}return m}function B4(e,t,n,r,i,o){if(!!t){e.dirty(t);var a=n,s=n;r?a=Math.round(i.x1+o*i.width()):s=Math.round(i.y1+o*i.height()),t.bounds.translate(a-(t.x||0),s-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=a,t.y=s,e.dirty(t)}}function Zue(e,t){const n=e[t]||{};return(r,i)=>n[r]!=null?n[r]:e[r]!=null?e[r]:i}function Jue(e,t){let n=-1/0;return e.forEach(r=>{r.offset!=null&&(n=Math.max(n,r.offset))}),n>-1/0?n:t}function Que(e,t,n,r,i,o,a){const s=Zue(n,t),u=Jue(e,s("offset",0)),l=s("anchor",_E),c=l===An?1:l===EE?.5:0,f={align:OE,bounds:s("bounds",FE),columns:s("direction")==="vertical"?1:e.length,padding:s("margin",8),center:s("center"),nodirty:!0};switch(t){case fi:f.anchor={x:Math.floor(r.x1)-u,column:An,y:c*(a||r.height()+2*r.y1),row:l};break;case di:f.anchor={x:Math.ceil(r.x2)+u,y:c*(a||r.height()+2*r.y1),row:l};break;case Zl:f.anchor={y:Math.floor(i.y1)-u,row:An,x:c*(o||i.width()+2*i.x1),column:l};break;case qa:f.anchor={y:Math.ceil(i.y2)+u,x:c*(o||i.width()+2*i.x1),column:l};break;case Aue:f.anchor={x:u,y:u};break;case Sue:f.anchor={x:o-u,y:u,column:An};break;case Cue:f.anchor={x:u,y:a-u,row:An};break;case Oue:f.anchor={x:o-u,y:a-u,column:An,row:An};break}return f}function ele(e,t){var n=t.items[0],r=n.datum,i=n.orient,o=n.bounds,a=n.x,s=n.y,u,l;return n._bounds?n._bounds.clear().union(o):n._bounds=o.clone(),o.clear(),nle(e,n,n.items[0].items[0]),o=tle(n,o),u=2*n.padding,l=2*n.padding,o.empty()||(u=Math.ceil(o.width()+u),l=Math.ceil(o.height()+l)),r.type===Tue&&rle(n.items[0].items[0].items[0].items),i!==CE&&(n.x=a=0,n.y=s=0),n.width=u,n.height=l,Uo(o.set(a,s,a+u,s+l),n),n.mark.bounds.clear().union(o),n}function tle(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}function nle(e,t,n){var r=t.padding,i=r-n.x,o=r-n.y;if(!t.datum.title)(i||o)&&Hd(e,n,i,o);else{var a=t.items[1].items[0],s=a.anchor,u=t.titlePadding||0,l=r-a.x,c=r-a.y;switch(a.orient){case fi:i+=Math.ceil(a.bounds.width())+u;break;case di:case qa:break;default:o+=a.bounds.height()+u}switch((i||o)&&Hd(e,n,i,o),a.orient){case fi:c+=Ql(t,n,a,s,1,1);break;case di:l+=Ql(t,n,a,An,0,0)+u,c+=Ql(t,n,a,s,1,1);break;case qa:l+=Ql(t,n,a,s,0,0),c+=Ql(t,n,a,An,-1,0,1)+u;break;default:l+=Ql(t,n,a,s,0,0)}(l||c)&&Hd(e,a,l,c),(l=Math.round(a.bounds.x1-r))<0&&(Hd(e,n,-l,0),Hd(e,a,-l,0))}}function Ql(e,t,n,r,i,o,a){const s=e.datum.type!=="symbol",u=n.datum.vgrad,l=s&&(o||!u)&&!a?t.items[0]:t,c=l.bounds[i?"y2":"x2"]-e.padding,f=u&&o?c:0,d=u&&o?0:c,h=i<=0?0:eE(n);return Math.round(r===_E?f:r===An?d-h:.5*(c-h))}function Hd(e,t,n,r){t.x+=n,t.y+=r,t.bounds.translate(n,r),t.mark.bounds.translate(n,r),e.dirty(t)}function rle(e){const t=e.reduce((n,r)=>(n[r.column]=Math.max(r.bounds.x2-r.x,n[r.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}function ile(e,t,n,r,i){var o=t.items[0],a=o.frame,s=o.orient,u=o.anchor,l=o.offset,c=o.padding,f=o.items[0].items[0],d=o.items[1]&&o.items[1].items[0],h=s===fi||s===di?r:n,g=0,p=0,m=0,y=0,v=0,b;if(a!==$m?s===fi?(g=i.y2,h=i.y1):s===di?(g=i.y1,h=i.y2):(g=i.x1,h=i.x2):s===fi&&(g=r,h=0),b=u===_E?g:u===An?h:(g+h)/2,d&&d.text){switch(s){case Zl:case qa:v=f.bounds.height()+c;break;case fi:y=f.bounds.width()+c;break;case di:y=-f.bounds.width()-c;break}cn.clear().union(d.bounds),cn.translate(y-(d.x||0),v-(d.y||0)),Jl(d,"x",y)|Jl(d,"y",v)&&(e.dirty(d),d.bounds.clear().union(cn),d.mark.bounds.clear().union(cn),e.dirty(d)),cn.clear().union(d.bounds)}else cn.clear();switch(cn.union(f.bounds),s){case Zl:p=b,m=i.y1-cn.height()-l;break;case fi:p=i.x1-cn.width()-l,m=b;break;case di:p=i.x2+cn.width()+l,m=b;break;case qa:p=b,m=i.y2+l;break;default:p=o.x,m=o.y}return Jl(o,"x",p)|Jl(o,"y",m)&&(cn.translate(p,m),e.dirty(o),o.bounds.clear().union(cn),t.bounds.clear().union(cn),e.dirty(o)),o.bounds}function z4(e){R.call(this,null,e)}H(z4,R,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(r=>{e.layout&&Vue(n,r,e.layout),ale(n,r,e)}),ole(e.mark.group)?t.reflow():t}});function ole(e){return e&&e.mark.role!=="legend-entry"}function ale(e,t,n){var r=t.items,i=Math.max(0,t.width||0),o=Math.max(0,t.height||0),a=new Ot().set(0,0,i,o),s=a.clone(),u=a.clone(),l=[],c,f,d,h,g,p;for(g=0,p=r.length;g<p;++g)switch(f=r[g],f.role){case $E:h=Uue(f)?s:u,h.union(Hue(e,f,i,o));break;case AE:c=f;break;case SE:l.push(ele(e,f));break;case Mue:case Due:case b4:case x4:case w4:case _4:case E4:case $4:s.union(f.bounds),u.union(f.bounds);break;default:a.union(f.bounds)}if(l.length){const m={};l.forEach(y=>{d=y.orient||di,d!==CE&&(m[d]||(m[d]=[])).push(y)});for(const y in m){const v=m[y];I4(e,v,Que(v,y,n.legends,s,u,i,o))}l.forEach(y=>{const v=y.bounds;if(v.equals(y._bounds)||(y.bounds=y._bounds,e.dirty(y),y.bounds=v,e.dirty(y)),n.autosize&&n.autosize.type===A4)switch(y.orient){case fi:case di:a.add(v.x1,0).add(v.x2,0);break;case Zl:case qa:a.add(0,v.y1).add(0,v.y2)}else a.union(v)})}a.union(s).union(u),c&&a.union(ile(e,c,i,o,a)),t.clip&&a.set(0,0,t.width||0,t.height||0),sle(e,t,a,n)}function sle(e,t,n,r){const i=r.autosize||{},o=i.type;if(e._autosize<1||!o)return;let a=e._width,s=e._height,u=Math.max(0,t.width||0),l=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-u)),h=Math.max(0,Math.ceil(n.y2-c));if(i.contains===Nue){const g=e.padding();a-=g.left+g.right,s-=g.top+g.bottom}o===CE?(l=0,f=0,u=a,c=s):o===A4?(u=Math.max(0,a-l-d),c=Math.max(0,s-f-h)):o===Rue?(u=Math.max(0,a-l-d),s=c+f+h):o===Pue?(a=u+l+d,c=Math.max(0,s-f-h)):o===Lue&&(a=u+l+d,s=c+f+h),e._resizeView(a,s,u,c,[l,f],i.resize)}var ule=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",bound:S4,identifier:kE,mark:O4,overlap:F4,render:R4,viewlayout:z4});function U4(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(i);++r<i;)o[r]=e+r*n;return o}function lle(e,t){let n=0;if(t===void 0)for(let r of e)(r=+r)&&(n+=r);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}function ME(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function q4(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Wd(){}var Gd=.7,Fm=1/Gd,ec="\\s*([+-]?\\d+)\\s*",Yd="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ji="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",cle=/^#([0-9a-f]{3,8})$/,fle=new RegExp("^rgb\\("+[ec,ec,ec]+"\\)$"),dle=new RegExp("^rgb\\("+[Ji,Ji,Ji]+"\\)$"),hle=new RegExp("^rgba\\("+[ec,ec,ec,Yd]+"\\)$"),gle=new RegExp("^rgba\\("+[Ji,Ji,Ji,Yd]+"\\)$"),ple=new RegExp("^hsl\\("+[Yd,Ji,Ji]+"\\)$"),mle=new RegExp("^hsla\\("+[Yd,Ji,Ji,Yd]+"\\)$"),H4={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ME(Wd,Vd,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:W4,formatHex:W4,formatHsl:yle,formatRgb:G4,toString:G4});function W4(){return this.rgb().formatHex()}function yle(){return Z4(this).formatHsl()}function G4(){return this.rgb().formatRgb()}function Vd(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=cle.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Y4(t):n===3?new vr(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?km(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?km(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=fle.exec(e))?new vr(t[1],t[2],t[3],1):(t=dle.exec(e))?new vr(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=hle.exec(e))?km(t[1],t[2],t[3],t[4]):(t=gle.exec(e))?km(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=ple.exec(e))?K4(t[1],t[2]/100,t[3]/100,1):(t=mle.exec(e))?K4(t[1],t[2]/100,t[3]/100,t[4]):H4.hasOwnProperty(e)?Y4(H4[e]):e==="transparent"?new vr(NaN,NaN,NaN,0):null}function Y4(e){return new vr(e>>16&255,e>>8&255,e&255,1)}function km(e,t,n,r){return r<=0&&(e=t=n=NaN),new vr(e,t,n,r)}function vle(e){return e instanceof Wd||(e=Vd(e)),e?(e=e.rgb(),new vr(e.r,e.g,e.b,e.opacity)):new vr}function DE(e,t,n,r){return arguments.length===1?vle(e):new vr(e,t,n,r==null?1:r)}function vr(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}ME(vr,DE,q4(Wd,{brighter:function(e){return e=e==null?Fm:Math.pow(Fm,e),new vr(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?Gd:Math.pow(Gd,e),new vr(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:V4,formatHex:V4,formatRgb:X4,toString:X4}));function V4(){return"#"+NE(this.r)+NE(this.g)+NE(this.b)}function X4(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function NE(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function K4(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Qi(e,t,n,r)}function Z4(e){if(e instanceof Qi)return new Qi(e.h,e.s,e.l,e.opacity);if(e instanceof Wd||(e=Vd(e)),!e)return new Qi;if(e instanceof Qi)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(t===o?a=(n-r)/s+(n<r)*6:n===o?a=(r-t)/s+2:a=(t-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new Qi(a,s,u,e.opacity)}function ble(e,t,n,r){return arguments.length===1?Z4(e):new Qi(e,t,n,r==null?1:r)}function Qi(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}ME(Qi,ble,q4(Wd,{brighter:function(e){return e=e==null?Fm:Math.pow(Fm,e),new Qi(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Gd:Math.pow(Gd,e),new Qi(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new vr(TE(e>=240?e-240:e+120,i,r),TE(e,i,r),TE(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function TE(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}var RE=e=>()=>e;function xle(e,t){return function(n){return e+n*t}}function wle(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function _le(e){return(e=+e)==1?J4:function(t,n){return n-t?wle(t,n,e):RE(isNaN(t)?n:t)}}function J4(e,t){var n=t-e;return n?xle(e,n):RE(isNaN(e)?t:e)}var Q4=function e(t){var n=_le(t);function r(i,o){var a=n((i=DE(i)).r,(o=DE(o)).r),s=n(i.g,o.g),u=n(i.b,o.b),l=J4(i.opacity,o.opacity);return function(c){return i.r=a(c),i.g=s(c),i.b=u(c),i.opacity=l(c),i+""}}return r.gamma=e,r}(1);function Ele(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(o){for(i=0;i<n;++i)r[i]=e[i]*(1-o)+t[i]*o;return r}}function $le(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Ale(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),o=new Array(n),a;for(a=0;a<r;++a)i[a]=IE(e[a],t[a]);for(;a<n;++a)o[a]=t[a];return function(s){for(a=0;a<r;++a)o[a]=i[a](s);return o}}function Sle(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function PE(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Cle(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=IE(e[i],t[i]):r[i]=t[i];return function(o){for(i in n)r[i]=n[i](o);return r}}var LE=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,jE=new RegExp(LE.source,"g");function Ole(e){return function(){return e}}function Fle(e){return function(t){return e(t)+""}}function kle(e,t){var n=LE.lastIndex=jE.lastIndex=0,r,i,o,a=-1,s=[],u=[];for(e=e+"",t=t+"";(r=LE.exec(e))&&(i=jE.exec(t));)(o=i.index)>n&&(o=t.slice(n,o),s[a]?s[a]+=o:s[++a]=o),(r=r[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,u.push({i:a,x:PE(r,i)})),n=jE.lastIndex;return n<t.length&&(o=t.slice(n),s[a]?s[a]+=o:s[++a]=o),s.length<2?u[0]?Fle(u[0].x):Ole(t):(t=u.length,function(l){for(var c=0,f;c<t;++c)s[(f=u[c]).i]=f.x(l);return s.join("")})}function IE(e,t){var n=typeof t,r;return t==null||n==="boolean"?RE(t):(n==="number"?PE:n==="string"?(r=Vd(t))?(t=r,Q4):kle:t instanceof Vd?Q4:t instanceof Date?Sle:$le(t)?Ele:Array.isArray(t)?Ale:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Cle:PE)(e,t)}function Mle(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function eR(e){R.call(this,null,e)}H(eR,R,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,o=e.scale,a=e.count==null?e.values?e.values.length:10:e.count,s=$_(o,a,e.minstep),u=e.format||q6(n,o,s,e.formatSpecifier,e.formatType,!!e.values),l=e.values?U6(o,e.values,s):A_(o,s);return i&&(r.rem=i),i=l.map((c,f)=>Ie({index:f/(l.length-1||1),value:c,label:u(c)})),e.extra&&i.length&&i.push(Ie({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}});function tR(e){R.call(this,null,e)}function Dle(){return Ie({})}function Nle(e){const t=xl().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}H(tR,R,{transform(e,t){var n=t.dataflow,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.item||Dle,o=e.key||te,a=this.value;return ee(r.encode)&&(r.encode=null),a&&(e.modified("key")||t.modified(o))&&B("DataJoin does not support modified key function or fields."),a||(t=t.addAll(),this.value=a=Nle(o)),t.visit(t.ADD,s=>{const u=o(s);let l=a.get(u);l?l.exit?(a.empty--,r.add.push(l)):r.mod.push(l):(l=i(s),a.set(u,l),r.add.push(l)),l.datum=s,l.exit=!1}),t.visit(t.MOD,s=>{const u=o(s),l=a.get(u);l&&(l.datum=s,r.mod.push(l))}),t.visit(t.REM,s=>{const u=o(s),l=a.get(u);s===l.datum&&!l.exit&&(r.rem.push(l),l.exit=!0,++a.empty)}),t.changed(t.ADD_MOD)&&r.modifies("datum"),(t.clean()||e.clean&&a.empty>n.cleanThreshold)&&n.runAfter(a.clean),r}});function nR(e){R.call(this,null,e)}H(nR,R,{transform(e,t){var n=t.fork(t.ADD_REM),r=e.mod||!1,i=e.encoders,o=t.encode;if(ee(o))if(n.changed()||o.every(f=>i[f]))o=o[0],n.encode=null;else return t.StopPropagation;var a=o==="enter",s=i.update||xa,u=i.enter||xa,l=i.exit||xa,c=(o&&!a?i[o]:s)||xa;if(t.changed(t.ADD)&&(t.visit(t.ADD,f=>{u(f,e),s(f,e)}),n.modifies(u.output),n.modifies(s.output),c!==xa&&c!==s&&(t.visit(t.ADD,f=>{c(f,e)}),n.modifies(c.output))),t.changed(t.REM)&&l!==xa&&(t.visit(t.REM,f=>{l(f,e)}),n.modifies(l.output)),a||c!==xa){const f=t.MOD|(e.modified()?t.REFLOW:0);a?(t.visit(f,d=>{const h=u(d,e)||r;(c(d,e)||h)&&n.mod.push(d)}),n.mod.length&&n.modifies(u.output)):t.visit(f,d=>{(c(d,e)||r)&&n.mod.push(d)}),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}});function rR(e){R.call(this,[],e)}H(rR,R,{transform(e,t){if(this.value!=null&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,o=e.type||Xp,a=e.scale,s=+e.limit,u=$_(a,e.count==null?5:e.count,e.minstep),l=!!e.values||o===Xp,c=e.format||Y6(n,a,u,o,e.formatSpecifier,e.formatType,l),f=e.values||G6(a,u),d,h,g,p,m;return i&&(r.rem=i),o===Xp?(s&&f.length>s?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),i=f.slice(0,s-1),m=!0):i=f,ye(g=e.size)?(!e.values&&a(i[0])===0&&(i=i.slice(1)),p=i.reduce((y,v)=>Math.max(y,g(v,e)),0)):g=rn(p=g||8),i=i.map((y,v)=>Ie({index:v,label:c(y,v,i),value:y,offset:p,size:g(y,e)})),m&&(m=f[i.length],i.push(Ie({index:i.length,label:"\u2026".concat(f.length-i.length," entries"),value:m,offset:p,size:g(m,e)})))):o===zoe?(d=a.domain(),h=j6(a,d[0],Se(d)),f.length<3&&!e.values&&d[0]!==Se(d)&&(f=[d[0],Se(d)]),i=f.map((y,v)=>Ie({index:v,label:c(y,v,f),value:y,perc:h(y)}))):(g=f.length-1,h=Joe(a),i=f.map((y,v)=>Ie({index:v,label:c(y,v,f),value:y,perc:v?h(y):0,perc2:v===g?1:h(f[v+1])}))),r.source=i,r.add=i,this.value=i,r}});const Tle=e=>e.source.x,Rle=e=>e.source.y,Ple=e=>e.target.x,Lle=e=>e.target.y;function BE(e){R.call(this,{},e)}BE.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};H(BE,R,{transform(e,t){var n=e.sourceX||Tle,r=e.sourceY||Rle,i=e.targetX||Ple,o=e.targetY||Lle,a=e.as||"path",s=e.orient||"vertical",u=e.shape||"line",l=sR.get(u+"-"+s)||sR.get(u);return l||B("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,c=>{c[a]=l(n(c),r(c),i(c),o(c))}),t.reflow(e.modified()).modifies(a)}});const iR=(e,t,n,r)=>"M"+e+","+t+"L"+n+","+r,jle=(e,t,n,r)=>iR(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),oR=(e,t,n,r)=>{var i=n-e,o=r-t,a=Math.sqrt(i*i+o*o)/2,s=180*Math.atan2(o,i)/Math.PI;return"M"+e+","+t+"A"+a+","+a+" "+s+" 0 1 "+n+","+r},Ile=(e,t,n,r)=>oR(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),aR=(e,t,n,r)=>{const i=n-e,o=r-t,a=.2*(i+o),s=.2*(o-i);return"M"+e+","+t+"C"+(e+a)+","+(t+s)+" "+(n+s)+","+(r-a)+" "+n+","+r},Ble=(e,t,n,r)=>aR(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),zle=(e,t,n,r)=>"M"+e+","+t+"V"+r+"H"+n,Ule=(e,t,n,r)=>"M"+e+","+t+"H"+n+"V"+r,qle=(e,t,n,r)=>{const i=Math.cos(e),o=Math.sin(e),a=Math.cos(n),s=Math.sin(n),u=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*i+","+t*o+"A"+t+","+t+" 0 0,"+(u?1:0)+" "+t*a+","+t*s+"L"+r*a+","+r*s},Hle=(e,t,n,r)=>{const i=(e+n)/2;return"M"+e+","+t+"C"+i+","+t+" "+i+","+r+" "+n+","+r},Wle=(e,t,n,r)=>{const i=(t+r)/2;return"M"+e+","+t+"C"+e+","+i+" "+n+","+i+" "+n+","+r},Gle=(e,t,n,r)=>{const i=Math.cos(e),o=Math.sin(e),a=Math.cos(n),s=Math.sin(n),u=(t+r)/2;return"M"+t*i+","+t*o+"C"+u*i+","+u*o+" "+u*a+","+u*s+" "+r*a+","+r*s},sR=xl({line:iR,"line-radial":jle,arc:oR,"arc-radial":Ile,curve:aR,"curve-radial":Ble,"orthogonal-horizontal":zle,"orthogonal-vertical":Ule,"orthogonal-radial":qle,"diagonal-horizontal":Hle,"diagonal-vertical":Wle,"diagonal-radial":Gle});function zE(e){R.call(this,null,e)}zE.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]};H(zE,R,{transform(e,t){var n=e.as||["startAngle","endAngle"],r=n[0],i=n[1],o=e.field||bl,a=e.startAngle||0,s=e.endAngle!=null?e.endAngle:2*Math.PI,u=t.source,l=u.map(o),c=l.length,f=a,d=(s-a)/lle(l),h=U4(c),g,p,m;for(e.sort&&h.sort((y,v)=>l[y]-l[v]),g=0;g<c;++g)m=l[h[g]],p=u[h[g]],p[r]=f,p[i]=f+=m*d;return this.value=l,t.reflow(e.modified()).modifies(n)}});const Yle=5;function Vle(e){const t=e.type;return!e.bins&&(t===Bl||t===_d||t===Ed)}function uR(e){return x_(e)&&e!==Gi}const Xle=oi(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function lR(e){R.call(this,null,e),this.modified(!0)}H(lR,R,{transform(e,t){var n=t.dataflow,r=this.value,i=Kle(e);(!r||i!==r.type)&&(this.value=r=Pe(i)());for(i in e)if(!Xle[i]){if(i==="padding"&&uR(r.type))continue;ye(r[i])?r[i](e[i]):n.warn("Unsupported scale property: "+i)}return nce(r,e,tce(r,e,Jle(r,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Kle(e){var t=e.type,n="",r;return t===Gi?Gi+"-"+Bl:(Zle(e)&&(r=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0,n=r===2?Gi+"-":r===3?zl+"-":""),(n+t||Bl).toLowerCase())}function Zle(e){const t=e.type;return x_(t)&&t!==tu&&t!==nu&&(e.scheme||e.range&&e.range.length&&e.range.every(Me))}function Jle(e,t,n){const r=Qle(e,t.domainRaw,n);if(r>-1)return r;var i=t.domain,o=e.type,a=t.zero||t.zero===void 0&&Vle(e),s,u;if(!i)return 0;if(uR(o)&&t.padding&&i[0]!==Se(i)&&(i=ece(o,i,t.range,t.padding,t.exponent,t.constant)),(a||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null)&&(s=(i=i.slice()).length-1||1,a&&(i[0]>0&&(i[0]=0),i[s]<0&&(i[s]=0)),t.domainMin!=null&&(i[0]=t.domainMin),t.domainMax!=null&&(i[s]=t.domainMax),t.domainMid!=null)){u=t.domainMid;const l=u>i[s]?s+1:u<i[0]?0:s;l!==s&&n.warn("Scale domainMid exceeds domain min or max.",u),i.splice(l,0,u)}return e.domain(cR(o,i,n)),o===p_&&e.unknown(t.domainImplicit?$w:void 0),t.nice&&e.nice&&e.nice(t.nice!==!0&&$_(e,t.nice)||null),i.length}function Qle(e,t,n){return t?(e.domain(cR(e.type,t,n)),t.length):-1}function ece(e,t,n,r,i,o){var a=Math.abs(Se(n)-n[0]),s=a/(a-2*r),u=e===Bo?xx(t,null,s):e===Ed?Gg(t,null,s,.5):e===_d?Gg(t,null,s,i||1):e===Hp?wx(t,null,s,o||1):bx(t,null,s);return t=t.slice(),t[0]=u[0],t[t.length-1]=u[1],t}function cR(e,t,n){if(N6(e)){var r=Math.abs(t.reduce((i,o)=>i+(o<0?-1:o>0?1:0),0));r!==t.length&&n.warn("Log scale domain includes zero: "+re(t))}return t}function tce(e,t,n){let r=t.bins;if(r&&!ee(r)){const i=e.domain(),o=i[0],a=Se(i),s=r.step;let u=r.start==null?o:r.start,l=r.stop==null?a:r.stop;s||B("Scale bins parameter missing step property."),u<o&&(u=s*Math.ceil(o/s)),l>a&&(l=s*Math.floor(a/s)),r=U4(u,l+s/2,s)}return r?e.bins=r:e.bins&&delete e.bins,e.type===y_&&(r?!t.domain&&!t.domainRaw&&(e.domain(r),n=r.length):e.bins=e.domain()),n}function nce(e,t,n){var r=e.type,i=t.round||!1,o=t.range;if(t.rangeStep!=null)o=rce(r,t,n);else if(t.scheme&&(o=ice(r,t,n),ye(o))){if(e.interpolator)return e.interpolator(o);B("Scale type ".concat(r," does not support interpolating color schemes."))}if(o&&T6(r))return e.interpolator(Vp(UE(o,t.reverse),t.interpolate,t.interpolateGamma));o&&t.interpolate&&e.interpolate?e.interpolate(__(t.interpolate,t.interpolateGamma)):ye(e.round)?e.round(i):ye(e.rangeRound)&&e.interpolate(i?Mle:IE),o&&e.range(UE(o,t.reverse))}function rce(e,t,n){e!==F6&&e!==m_&&B("Only band and point scales support rangeStep.");var r=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,i=e===m_?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*g_(n,i,r)]}function ice(e,t,n){var r=t.schemeExtent,i,o;return ee(t.scheme)?o=Vp(t.scheme,t.interpolate,t.interpolateGamma):(i=t.scheme.toLowerCase(),o=E_(i),o||B("Unrecognized scheme name: ".concat(t.scheme))),n=e===Gp?n+1:e===y_?n-1:e===Ul||e===Wp?+t.schemeCount||Yle:n,T6(e)?fR(o,r,t.reverse):ye(o)?L6(fR(o,r),n):e===p_?o:o.slice(0,n)}function fR(e,t,n){return ye(e)&&(t||n)?P6(e,UE(t||[0,1],n)):e}function UE(e,t){return t?e.slice().reverse():e}function dR(e){R.call(this,null,e)}H(dR,R,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(zs(e.sort)),this.modified(n),t}});const hR="zero",gR="center",pR="normalize",mR=["y0","y1"];function qE(e){R.call(this,null,e)}qE.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:hR,values:[hR,gR,pR]},{name:"as",type:"string",array:!0,length:2,default:mR}]};H(qE,R,{transform(e,t){var n=e.as||mR,r=n[0],i=n[1],o=zs(e.sort),a=e.field||bl,s=e.offset===gR?oce:e.offset===pR?ace:sce,u,l,c,f;for(u=uce(t.source,e.groupby,o,a),l=0,c=u.length,f=u.max;l<c;++l)s(u[l],f,a,r,i);return t.reflow(e.modified()).modifies(n)}});function oce(e,t,n,r,i){for(var o=(t-e.sum)/2,a=e.length,s=0,u;s<a;++s)u=e[s],u[r]=o,u[i]=o+=Math.abs(n(u))}function ace(e,t,n,r,i){for(var o=1/e.sum,a=0,s=e.length,u=0,l=0,c;u<s;++u)c=e[u],c[r]=a,c[i]=a=o*(l+=Math.abs(n(c)))}function sce(e,t,n,r,i){for(var o=0,a=0,s=e.length,u=0,l,c;u<s;++u)c=e[u],l=+n(c),l<0?(c[r]=a,c[i]=a+=l):(c[r]=o,c[i]=o+=l)}function uce(e,t,n,r){var i=[],o=p=>p(c),a,s,u,l,c,f,d,h,g;if(t==null)i.push(e.slice());else for(a={},s=0,u=e.length;s<u;++s)c=e[s],f=t.map(o),d=a[f],d||(a[f]=d=[],i.push(d)),d.push(c);for(f=0,g=0,l=i.length;f<l;++f){for(d=i[f],s=0,h=0,u=d.length;s<u;++s)h+=Math.abs(r(d[s]));d.sum=h,h>g&&(g=h),n&&d.sort(n)}return i.max=g,i}var lce=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",axisticks:eR,datajoin:tR,encode:nR,legendentries:rR,linkpath:BE,pie:zE,scale:lR,sortitems:dR,stack:qE}),cce=Math.sqrt(50),fce=Math.sqrt(10),dce=Math.sqrt(2);function hce(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=cce?i*=10:o>=fce?i*=5:o>=dce&&(i*=2),t<e?-i:i}function Mm(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function lu(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(i);++r<i;)o[r]=e+r*n;return o}function gce(e,t){let n=0;if(t===void 0)for(let r of e)(r=+r)&&(n+=r);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}class cu{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const o=n[i],a=t+o,s=Math.abs(t)<Math.abs(o)?t-(a-o):o-(a-t);s&&(n[r++]=s),t=a}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,o,a=0;if(n>0){for(a=t[--n];n>0&&(r=a,i=t[--n],a=r+i,o=i-(a-r),!o););n>0&&(o<0&&t[n-1]<0||o>0&&t[n-1]>0)&&(i=o*2,r=a+i,i==r-a&&(a=r))}return a}}function*pce(e){for(const t of e)yield*t}function yR(e){return Array.from(pce(e))}var me=1e-6,vR=1e-12,we=Math.PI,dt=we/2,bR=we/4,br=we*2,fn=180/we,at=we/180,Ue=Math.abs,tc=Math.atan,Ho=Math.atan2,be=Math.cos,xR=Math.exp,Dm=Math.log,HE=Math.pow,de=Math.sin,jr=Math.sign||function(e){return e>0?1:e<0?-1:0},Kn=Math.sqrt,WE=Math.tan;function wR(e){return e>1?0:e<-1?we:Math.acos(e)}function Ir(e){return e>1?dt:e<-1?-dt:Math.asin(e)}function Br(){}function Nm(e,t){e&&ER.hasOwnProperty(e.type)&&ER[e.type](e,t)}var _R={Feature:function(e,t){Nm(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)Nm(n[r].geometry,t)}},ER={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){GE(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)GE(n[r],t,0)},Polygon:function(e,t){$R(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)$R(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)Nm(n[r],t)}};function GE(e,t,n){var r=-1,i=e.length-n,o;for(t.lineStart();++r<i;)o=e[r],t.point(o[0],o[1],o[2]);t.lineEnd()}function $R(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)GE(e[n],t,1);t.polygonEnd()}function nc(e,t){e&&_R.hasOwnProperty(e.type)?_R[e.type](e,t):Nm(e,t)}function YE(e){return[Ho(e[1],e[0]),Ir(e[2])]}function rc(e){var t=e[0],n=e[1],r=be(n);return[r*be(t),r*de(t),de(n)]}function Tm(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Rm(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function VE(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Pm(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function XE(e){var t=Kn(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function KE(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function ZE(e,t){return[Ue(e)>we?e+Math.round(-e/br)*br:e,t]}ZE.invert=ZE;function AR(e,t,n){return(e%=br)?t||n?KE(CR(e),OR(t,n)):CR(e):t||n?OR(t,n):ZE}function SR(e){return function(t,n){return t+=e,[t>we?t-br:t<-we?t+br:t,n]}}function CR(e){var t=SR(e);return t.invert=SR(-e),t}function OR(e,t){var n=be(e),r=de(e),i=be(t),o=de(t);function a(s,u){var l=be(u),c=be(s)*l,f=de(s)*l,d=de(u),h=d*n+c*r;return[Ho(f*i-h*o,c*n-d*r),Ir(h*i+f*o)]}return a.invert=function(s,u){var l=be(u),c=be(s)*l,f=de(s)*l,d=de(u),h=d*i-f*o;return[Ho(f*i+d*o,c*n+h*r),Ir(h*n-c*r)]},a}function mce(e){e=AR(e[0]*at,e[1]*at,e.length>2?e[2]*at:0);function t(n){return n=e(n[0]*at,n[1]*at),n[0]*=fn,n[1]*=fn,n}return t.invert=function(n){return n=e.invert(n[0]*at,n[1]*at),n[0]*=fn,n[1]*=fn,n},t}function yce(e,t,n,r,i,o){if(!!n){var a=be(t),s=de(t),u=r*n;i==null?(i=t+r*br,o=t-u/2):(i=FR(a,i),o=FR(a,o),(r>0?i<o:i>o)&&(i+=r*br));for(var l,c=i;r>0?c>o:c<o;c-=u)l=YE([a,-s*be(c),-s*de(c)]),e.point(l[0],l[1])}}function FR(e,t){t=rc(t),t[0]-=e,XE(t);var n=wR(-t[1]);return((-t[2]<0?-n:n)+br-me)%br}function kR(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:Br,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function Lm(e,t){return Ue(e[0]-t[0])<me&&Ue(e[1]-t[1])<me}function jm(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function MR(e,t,n,r,i){var o=[],a=[],s,u;if(e.forEach(function(g){if(!((p=g.length-1)<=0)){var p,m=g[0],y=g[p],v;if(Lm(m,y)){if(!m[2]&&!y[2]){for(i.lineStart(),s=0;s<p;++s)i.point((m=g[s])[0],m[1]);i.lineEnd();return}y[0]+=2*me}o.push(v=new jm(m,g,null,!0)),a.push(v.o=new jm(m,null,v,!1)),o.push(v=new jm(y,g,null,!1)),a.push(v.o=new jm(y,null,v,!0))}}),!!o.length){for(a.sort(t),DR(o),DR(a),s=0,u=a.length;s<u;++s)a[s].e=n=!n;for(var l=o[0],c,f;;){for(var d=l,h=!0;d.v;)if((d=d.n)===l)return;c=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(s=0,u=c.length;s<u;++s)i.point((f=c[s])[0],f[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(h)for(c=d.p.z,s=c.length-1;s>=0;--s)i.point((f=c[s])[0],f[1]);else r(d.x,d.p.x,-1,i);d=d.p}d=d.o,c=d.z,h=!h}while(!d.v);i.lineEnd()}}}function DR(e){if(!!(t=e.length)){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function JE(e){return Ue(e[0])<=we?e[0]:jr(e[0])*((Ue(e[0])+we)%br-we)}function vce(e,t){var n=JE(t),r=t[1],i=de(r),o=[de(n),-be(n),0],a=0,s=0,u=new cu;i===1?r=dt+me:i===-1&&(r=-dt-me);for(var l=0,c=e.length;l<c;++l)if(!!(d=(f=e[l]).length))for(var f,d,h=f[d-1],g=JE(h),p=h[1]/2+bR,m=de(p),y=be(p),v=0;v<d;++v,g=x,m=E,y=_,h=b){var b=f[v],x=JE(b),w=b[1]/2+bR,E=de(w),_=be(w),S=x-g,C=S>=0?1:-1,O=C*S,$=O>we,M=m*E;if(u.add(Ho(M*C*de(O),y*_+M*be(O))),a+=$?S+C*br:S,$^g>=n^x>=n){var F=Rm(rc(h),rc(b));XE(F);var N=Rm(o,F);XE(N);var A=($^S>=0?-1:1)*Ir(N[2]);(r>A||r===A&&(F[0]||F[1]))&&(s+=$^S>=0?1:-1)}}return(a<-me||a<me&&u<-vR)^s&1}function NR(e,t,n,r){return function(i){var o=t(i),a=kR(),s=t(a),u=!1,l,c,f,d={point:h,lineStart:p,lineEnd:m,polygonStart:function(){d.point=y,d.lineStart=v,d.lineEnd=b,c=[],l=[]},polygonEnd:function(){d.point=h,d.lineStart=p,d.lineEnd=m,c=yR(c);var x=vce(l,r);c.length?(u||(i.polygonStart(),u=!0),MR(c,xce,x,n,i)):x&&(u||(i.polygonStart(),u=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),u&&(i.polygonEnd(),u=!1),c=l=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(x,w){e(x,w)&&i.point(x,w)}function g(x,w){o.point(x,w)}function p(){d.point=g,o.lineStart()}function m(){d.point=h,o.lineEnd()}function y(x,w){f.push([x,w]),s.point(x,w)}function v(){s.lineStart(),f=[]}function b(){y(f[0][0],f[0][1]),s.lineEnd();var x=s.clean(),w=a.result(),E,_=w.length,S,C,O;if(f.pop(),l.push(f),f=null,!!_){if(x&1){if(C=w[0],(S=C.length-1)>0){for(u||(i.polygonStart(),u=!0),i.lineStart(),E=0;E<S;++E)i.point((O=C[E])[0],O[1]);i.lineEnd()}return}_>1&&x&2&&w.push(w.pop().concat(w.shift())),c.push(w.filter(bce))}}return d}}function bce(e){return e.length>1}function xce(e,t){return((e=e.x)[0]<0?e[1]-dt-me:dt-e[1])-((t=t.x)[0]<0?t[1]-dt-me:dt-t[1])}var TR=NR(function(){return!0},wce,Ece,[-we,-dt]);function wce(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(o,a){var s=o>0?we:-we,u=Ue(o-t);Ue(u-we)<me?(e.point(t,n=(n+a)/2>0?dt:-dt),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(s,n),e.point(o,n),i=0):r!==s&&u>=we&&(Ue(t-r)<me&&(t-=r*me),Ue(o-s)<me&&(o-=s*me),n=_ce(t,n,o,a),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(s,n),i=0),e.point(t=o,n=a),r=s},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function _ce(e,t,n,r){var i,o,a=de(e-n);return Ue(a)>me?tc((de(t)*(o=be(r))*de(n)-de(r)*(i=be(t))*de(e))/(i*o*a)):(t+r)/2}function Ece(e,t,n,r){var i;if(e==null)i=n*dt,r.point(-we,i),r.point(0,i),r.point(we,i),r.point(we,0),r.point(we,-i),r.point(0,-i),r.point(-we,-i),r.point(-we,0),r.point(-we,i);else if(Ue(e[0]-t[0])>me){var o=e[0]<t[0]?we:-we;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(t[0],t[1])}function $ce(e){var t=be(e),n=6*at,r=t>0,i=Ue(t)>me;function o(c,f,d,h){yce(h,e,n,d,c,f)}function a(c,f){return be(c)*be(f)>t}function s(c){var f,d,h,g,p;return{lineStart:function(){g=h=!1,p=1},point:function(m,y){var v=[m,y],b,x=a(m,y),w=r?x?0:l(m,y):x?l(m+(m<0?we:-we),y):0;if(!f&&(g=h=x)&&c.lineStart(),x!==h&&(b=u(f,v),(!b||Lm(f,b)||Lm(v,b))&&(v[2]=1)),x!==h)p=0,x?(c.lineStart(),b=u(v,f),c.point(b[0],b[1])):(b=u(f,v),c.point(b[0],b[1],2),c.lineEnd()),f=b;else if(i&&f&&r^x){var E;!(w&d)&&(E=u(v,f,!0))&&(p=0,r?(c.lineStart(),c.point(E[0][0],E[0][1]),c.point(E[1][0],E[1][1]),c.lineEnd()):(c.point(E[1][0],E[1][1]),c.lineEnd(),c.lineStart(),c.point(E[0][0],E[0][1],3)))}x&&(!f||!Lm(f,v))&&c.point(v[0],v[1]),f=v,h=x,d=w},lineEnd:function(){h&&c.lineEnd(),f=null},clean:function(){return p|(g&&h)<<1}}}function u(c,f,d){var h=rc(c),g=rc(f),p=[1,0,0],m=Rm(h,g),y=Tm(m,m),v=m[0],b=y-v*v;if(!b)return!d&&c;var x=t*y/b,w=-t*v/b,E=Rm(p,m),_=Pm(p,x),S=Pm(m,w);VE(_,S);var C=E,O=Tm(_,C),$=Tm(C,C),M=O*O-$*(Tm(_,_)-1);if(!(M<0)){var F=Kn(M),N=Pm(C,(-O-F)/$);if(VE(N,_),N=YE(N),!d)return N;var A=c[0],k=f[0],T=c[1],L=f[1],z;k<A&&(z=A,A=k,k=z);var Q=k-A,oe=Ue(Q-we)<me,ue=oe||Q<me;if(!oe&&L<T&&(z=T,T=L,L=z),ue?oe?T+L>0^N[1]<(Ue(N[0]-A)<me?T:L):T<=N[1]&&N[1]<=L:Q>we^(A<=N[0]&&N[0]<=k)){var ce=Pm(C,(-O+F)/$);return VE(ce,_),[N,YE(ce)]}}}function l(c,f){var d=r?e:we-e,h=0;return c<-d?h|=1:c>d&&(h|=2),f<-d?h|=4:f>d&&(h|=8),h}return NR(a,s,o,r?[0,-e]:[-we,e-we])}function Ace(e,t,n,r,i,o){var a=e[0],s=e[1],u=t[0],l=t[1],c=0,f=1,d=u-a,h=l-s,g;if(g=n-a,!(!d&&g>0)){if(g/=d,d<0){if(g<c)return;g<f&&(f=g)}else if(d>0){if(g>f)return;g>c&&(c=g)}if(g=i-a,!(!d&&g<0)){if(g/=d,d<0){if(g>f)return;g>c&&(c=g)}else if(d>0){if(g<c)return;g<f&&(f=g)}if(g=r-s,!(!h&&g>0)){if(g/=h,h<0){if(g<c)return;g<f&&(f=g)}else if(h>0){if(g>f)return;g>c&&(c=g)}if(g=o-s,!(!h&&g<0)){if(g/=h,h<0){if(g>f)return;g>c&&(c=g)}else if(h>0){if(g<c)return;g<f&&(f=g)}return c>0&&(e[0]=a+c*d,e[1]=s+c*h),f<1&&(t[0]=a+f*d,t[1]=s+f*h),!0}}}}}var Xd=1e9,Im=-Xd;function RR(e,t,n,r){function i(l,c){return e<=l&&l<=n&&t<=c&&c<=r}function o(l,c,f,d){var h=0,g=0;if(l==null||(h=a(l,f))!==(g=a(c,f))||u(l,c)<0^f>0)do d.point(h===0||h===3?e:n,h>1?r:t);while((h=(h+f+4)%4)!==g);else d.point(c[0],c[1])}function a(l,c){return Ue(l[0]-e)<me?c>0?0:3:Ue(l[0]-n)<me?c>0?2:1:Ue(l[1]-t)<me?c>0?1:0:c>0?3:2}function s(l,c){return u(l.x,c.x)}function u(l,c){var f=a(l,1),d=a(c,1);return f!==d?f-d:f===0?c[1]-l[1]:f===1?l[0]-c[0]:f===2?l[1]-c[1]:c[0]-l[0]}return function(l){var c=l,f=kR(),d,h,g,p,m,y,v,b,x,w,E,_={point:S,lineStart:M,lineEnd:F,polygonStart:O,polygonEnd:$};function S(A,k){i(A,k)&&c.point(A,k)}function C(){for(var A=0,k=0,T=h.length;k<T;++k)for(var L=h[k],z=1,Q=L.length,oe=L[0],ue,ce,xe=oe[0],_e=oe[1];z<Q;++z)ue=xe,ce=_e,oe=L[z],xe=oe[0],_e=oe[1],ce<=r?_e>r&&(xe-ue)*(r-ce)>(_e-ce)*(e-ue)&&++A:_e<=r&&(xe-ue)*(r-ce)<(_e-ce)*(e-ue)&&--A;return A}function O(){c=f,d=[],h=[],E=!0}function $(){var A=C(),k=E&&A,T=(d=yR(d)).length;(k||T)&&(l.polygonStart(),k&&(l.lineStart(),o(null,null,1,l),l.lineEnd()),T&&MR(d,s,A,o,l),l.polygonEnd()),c=l,d=h=g=null}function M(){_.point=N,h&&h.push(g=[]),w=!0,x=!1,v=b=NaN}function F(){d&&(N(p,m),y&&x&&f.rejoin(),d.push(f.result())),_.point=S,x&&c.lineEnd()}function N(A,k){var T=i(A,k);if(h&&g.push([A,k]),w)p=A,m=k,y=T,w=!1,T&&(c.lineStart(),c.point(A,k));else if(T&&x)c.point(A,k);else{var L=[v=Math.max(Im,Math.min(Xd,v)),b=Math.max(Im,Math.min(Xd,b))],z=[A=Math.max(Im,Math.min(Xd,A)),k=Math.max(Im,Math.min(Xd,k))];Ace(L,z,e,t,n,r)?(x||(c.lineStart(),c.point(L[0],L[1])),c.point(z[0],z[1]),T||c.lineEnd(),E=!1):T&&(c.lineStart(),c.point(A,k),E=!1)}v=A,b=k,x=T}return _}}var Kd=e=>e,QE=new cu,e$=new cu,PR,LR,t$,n$,Ga={point:Br,lineStart:Br,lineEnd:Br,polygonStart:function(){Ga.lineStart=Sce,Ga.lineEnd=Oce},polygonEnd:function(){Ga.lineStart=Ga.lineEnd=Ga.point=Br,QE.add(Ue(e$)),e$=new cu},result:function(){var e=QE/2;return QE=new cu,e}};function Sce(){Ga.point=Cce}function Cce(e,t){Ga.point=jR,PR=t$=e,LR=n$=t}function jR(e,t){e$.add(n$*e-t$*t),t$=e,n$=t}function Oce(){jR(PR,LR)}var IR=Ga,ic=1/0,Bm=ic,Zd=-ic,zm=Zd,Fce={point:kce,lineStart:Br,lineEnd:Br,polygonStart:Br,polygonEnd:Br,result:function(){var e=[[ic,Bm],[Zd,zm]];return Zd=zm=-(Bm=ic=1/0),e}};function kce(e,t){e<ic&&(ic=e),e>Zd&&(Zd=e),t<Bm&&(Bm=t),t>zm&&(zm=t)}var Um=Fce,r$=0,i$=0,Jd=0,qm=0,Hm=0,oc=0,o$=0,a$=0,Qd=0,BR,zR,eo,to,hi={point:fu,lineStart:UR,lineEnd:qR,polygonStart:function(){hi.lineStart=Nce,hi.lineEnd=Tce},polygonEnd:function(){hi.point=fu,hi.lineStart=UR,hi.lineEnd=qR},result:function(){var e=Qd?[o$/Qd,a$/Qd]:oc?[qm/oc,Hm/oc]:Jd?[r$/Jd,i$/Jd]:[NaN,NaN];return r$=i$=Jd=qm=Hm=oc=o$=a$=Qd=0,e}};function fu(e,t){r$+=e,i$+=t,++Jd}function UR(){hi.point=Mce}function Mce(e,t){hi.point=Dce,fu(eo=e,to=t)}function Dce(e,t){var n=e-eo,r=t-to,i=Kn(n*n+r*r);qm+=i*(eo+e)/2,Hm+=i*(to+t)/2,oc+=i,fu(eo=e,to=t)}function qR(){hi.point=fu}function Nce(){hi.point=Rce}function Tce(){HR(BR,zR)}function Rce(e,t){hi.point=HR,fu(BR=eo=e,zR=to=t)}function HR(e,t){var n=e-eo,r=t-to,i=Kn(n*n+r*r);qm+=i*(eo+e)/2,Hm+=i*(to+t)/2,oc+=i,i=to*e-eo*t,o$+=i*(eo+e),a$+=i*(to+t),Qd+=i*3,fu(eo=e,to=t)}var WR=hi;function GR(e){this._context=e}GR.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,br);break}}},result:Br};var s$=new cu,u$,YR,VR,eh,th,Wm={point:Br,lineStart:function(){Wm.point=Pce},lineEnd:function(){u$&&XR(YR,VR),Wm.point=Br},polygonStart:function(){u$=!0},polygonEnd:function(){u$=null},result:function(){var e=+s$;return s$=new cu,e}};function Pce(e,t){Wm.point=XR,YR=eh=e,VR=th=t}function XR(e,t){eh-=e,th-=t,s$.add(Kn(eh*eh+th*th)),eh=e,th=t}var KR=Wm;function ZR(){this._string=[]}ZR.prototype={_radius:4.5,_circle:JR(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._string.push("M",e,",",t),this._point=1;break}case 1:{this._string.push("L",e,",",t);break}default:{this._circle==null&&(this._circle=JR(this._radius)),this._string.push("M",e,",",t,this._circle);break}}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}else return null}};function JR(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function QR(e,t){var n=4.5,r,i;function o(a){return a&&(typeof n=="function"&&i.pointRadius(+n.apply(this,arguments)),nc(a,r(i))),i.result()}return o.area=function(a){return nc(a,r(IR)),IR.result()},o.measure=function(a){return nc(a,r(KR)),KR.result()},o.bounds=function(a){return nc(a,r(Um)),Um.result()},o.centroid=function(a){return nc(a,r(WR)),WR.result()},o.projection=function(a){return arguments.length?(r=a==null?(e=null,Kd):(e=a).stream,o):e},o.context=function(a){return arguments.length?(i=a==null?(t=null,new ZR):new GR(t=a),typeof n!="function"&&i.pointRadius(n),o):t},o.pointRadius=function(a){return arguments.length?(n=typeof a=="function"?a:(i.pointRadius(+a),+a),o):n},o.projection(e).context(t)}function Gm(e){return function(t){var n=new l$;for(var r in e)n[r]=e[r];return n.stream=t,n}}function l$(){}l$.prototype={constructor:l$,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function c$(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),nc(n,e.stream(Um)),t(Um.result()),r!=null&&e.clipExtent(r),e}function Ym(e,t,n){return c$(e,function(r){var i=t[1][0]-t[0][0],o=t[1][1]-t[0][1],a=Math.min(i/(r[1][0]-r[0][0]),o/(r[1][1]-r[0][1])),s=+t[0][0]+(i-a*(r[1][0]+r[0][0]))/2,u=+t[0][1]+(o-a*(r[1][1]+r[0][1]))/2;e.scale(150*a).translate([s,u])},n)}function f$(e,t,n){return Ym(e,[[0,0],t],n)}function d$(e,t,n){return c$(e,function(r){var i=+t,o=i/(r[1][0]-r[0][0]),a=(i-o*(r[1][0]+r[0][0]))/2,s=-o*r[0][1];e.scale(150*o).translate([a,s])},n)}function h$(e,t,n){return c$(e,function(r){var i=+t,o=i/(r[1][1]-r[0][1]),a=-o*r[0][0],s=(i-o*(r[1][1]+r[0][1]))/2;e.scale(150*o).translate([a,s])},n)}var e9=16,Lce=be(30*at);function t9(e,t){return+t?Ice(e,t):jce(e)}function jce(e){return Gm({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function Ice(e,t){function n(r,i,o,a,s,u,l,c,f,d,h,g,p,m){var y=l-r,v=c-i,b=y*y+v*v;if(b>4*t&&p--){var x=a+d,w=s+h,E=u+g,_=Kn(x*x+w*w+E*E),S=Ir(E/=_),C=Ue(Ue(E)-1)<me||Ue(o-f)<me?(o+f)/2:Ho(w,x),O=e(C,S),$=O[0],M=O[1],F=$-r,N=M-i,A=v*F-y*N;(A*A/b>t||Ue((y*F+v*N)/b-.5)>.3||a*d+s*h+u*g<Lce)&&(n(r,i,o,a,s,u,$,M,C,x/=_,w/=_,E,p,m),m.point($,M),n($,M,C,x,w,E,l,c,f,d,h,g,p,m))}}return function(r){var i,o,a,s,u,l,c,f,d,h,g,p,m={point:y,lineStart:v,lineEnd:x,polygonStart:function(){r.polygonStart(),m.lineStart=w},polygonEnd:function(){r.polygonEnd(),m.lineStart=v}};function y(S,C){S=e(S,C),r.point(S[0],S[1])}function v(){f=NaN,m.point=b,r.lineStart()}function b(S,C){var O=rc([S,C]),$=e(S,C);n(f,d,c,h,g,p,f=$[0],d=$[1],c=S,h=O[0],g=O[1],p=O[2],e9,r),r.point(f,d)}function x(){m.point=y,r.lineEnd()}function w(){v(),m.point=E,m.lineEnd=_}function E(S,C){b(i=S,C),o=f,a=d,s=h,u=g,l=p,m.point=b}function _(){n(f,d,c,h,g,p,o,a,i,s,u,l,e9,r),m.lineEnd=x,x()}return m}}var Bce=Gm({point:function(e,t){this.stream.point(e*at,t*at)}});function zce(e){return Gm({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function Uce(e,t,n,r,i){function o(a,s){return a*=r,s*=i,[t+e*a,n-e*s]}return o.invert=function(a,s){return[(a-t)/e*r,(n-s)/e*i]},o}function n9(e,t,n,r,i,o){if(!o)return Uce(e,t,n,r,i);var a=be(o),s=de(o),u=a*e,l=s*e,c=a/e,f=s/e,d=(s*n-a*t)/e,h=(s*t+a*n)/e;function g(p,m){return p*=r,m*=i,[u*p-l*m+t,n-l*p-u*m]}return g.invert=function(p,m){return[r*(c*p-f*m+d),i*(h-f*p-c*m)]},g}function Wo(e){return r9(function(){return e})()}function r9(e){var t,n=150,r=480,i=250,o=0,a=0,s=0,u=0,l=0,c,f=0,d=1,h=1,g=null,p=TR,m=null,y,v,b,x=Kd,w=.5,E,_,S,C,O;function $(A){return S(A[0]*at,A[1]*at)}function M(A){return A=S.invert(A[0],A[1]),A&&[A[0]*fn,A[1]*fn]}$.stream=function(A){return C&&O===A?C:C=Bce(zce(c)(p(E(x(O=A)))))},$.preclip=function(A){return arguments.length?(p=A,g=void 0,N()):p},$.postclip=function(A){return arguments.length?(x=A,m=y=v=b=null,N()):x},$.clipAngle=function(A){return arguments.length?(p=+A?$ce(g=A*at):(g=null,TR),N()):g*fn},$.clipExtent=function(A){return arguments.length?(x=A==null?(m=y=v=b=null,Kd):RR(m=+A[0][0],y=+A[0][1],v=+A[1][0],b=+A[1][1]),N()):m==null?null:[[m,y],[v,b]]},$.scale=function(A){return arguments.length?(n=+A,F()):n},$.translate=function(A){return arguments.length?(r=+A[0],i=+A[1],F()):[r,i]},$.center=function(A){return arguments.length?(o=A[0]%360*at,a=A[1]%360*at,F()):[o*fn,a*fn]},$.rotate=function(A){return arguments.length?(s=A[0]%360*at,u=A[1]%360*at,l=A.length>2?A[2]%360*at:0,F()):[s*fn,u*fn,l*fn]},$.angle=function(A){return arguments.length?(f=A%360*at,F()):f*fn},$.reflectX=function(A){return arguments.length?(d=A?-1:1,F()):d<0},$.reflectY=function(A){return arguments.length?(h=A?-1:1,F()):h<0},$.precision=function(A){return arguments.length?(E=t9(_,w=A*A),N()):Kn(w)},$.fitExtent=function(A,k){return Ym($,A,k)},$.fitSize=function(A,k){return f$($,A,k)},$.fitWidth=function(A,k){return d$($,A,k)},$.fitHeight=function(A,k){return h$($,A,k)};function F(){var A=n9(n,0,0,d,h,f).apply(null,t(o,a)),k=n9(n,r-A[0],i-A[1],d,h,f);return c=AR(s,u,l),_=KE(t,k),S=KE(c,_),E=t9(_,w),N()}function N(){return C=O=null,$}return function(){return t=e.apply(this,arguments),$.invert=t.invert&&M,F()}}function g$(e){var t=0,n=we/3,r=r9(e),i=r(t,n);return i.parallels=function(o){return arguments.length?r(t=o[0]*at,n=o[1]*at):[t*fn,n*fn]},i}function qce(e){var t=be(e);function n(r,i){return[r*t,de(i)/t]}return n.invert=function(r,i){return[r/t,Ir(i*t)]},n}function Hce(e,t){var n=de(e),r=(n+de(t))/2;if(Ue(r)<me)return qce(e);var i=1+n*(2*r-n),o=Kn(i)/r;function a(s,u){var l=Kn(i-2*r*de(u))/r;return[l*de(s*=r),o-l*be(s)]}return a.invert=function(s,u){var l=o-u,c=Ho(s,Ue(l))*jr(l);return l*r<0&&(c-=we*jr(s)*jr(l)),[c/r,Ir((i-(s*s+l*l)*r*r)/(2*r))]},a}function Vm(){return g$(Hce).scale(155.424).center([0,33.6442])}function i9(){return Vm().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Wce(e){var t=e.length;return{point:function(n,r){for(var i=-1;++i<t;)e[i].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function Gce(){var e,t,n=i9(),r,i=Vm().rotate([154,0]).center([-2,58.5]).parallels([55,65]),o,a=Vm().rotate([157,0]).center([-3,19.9]).parallels([8,18]),s,u,l={point:function(d,h){u=[d,h]}};function c(d){var h=d[0],g=d[1];return u=null,r.point(h,g),u||(o.point(h,g),u)||(s.point(h,g),u)}c.invert=function(d){var h=n.scale(),g=n.translate(),p=(d[0]-g[0])/h,m=(d[1]-g[1])/h;return(m>=.12&&m<.234&&p>=-.425&&p<-.214?i:m>=.166&&m<.234&&p>=-.214&&p<-.115?a:n).invert(d)},c.stream=function(d){return e&&t===d?e:e=Wce([n.stream(t=d),i.stream(d),a.stream(d)])},c.precision=function(d){return arguments.length?(n.precision(d),i.precision(d),a.precision(d),f()):n.precision()},c.scale=function(d){return arguments.length?(n.scale(d),i.scale(d*.35),a.scale(d),c.translate(n.translate())):n.scale()},c.translate=function(d){if(!arguments.length)return n.translate();var h=n.scale(),g=+d[0],p=+d[1];return r=n.translate(d).clipExtent([[g-.455*h,p-.238*h],[g+.455*h,p+.238*h]]).stream(l),o=i.translate([g-.307*h,p+.201*h]).clipExtent([[g-.425*h+me,p+.12*h+me],[g-.214*h-me,p+.234*h-me]]).stream(l),s=a.translate([g-.205*h,p+.212*h]).clipExtent([[g-.214*h+me,p+.166*h+me],[g-.115*h-me,p+.234*h-me]]).stream(l),f()},c.fitExtent=function(d,h){return Ym(c,d,h)},c.fitSize=function(d,h){return f$(c,d,h)},c.fitWidth=function(d,h){return d$(c,d,h)},c.fitHeight=function(d,h){return h$(c,d,h)};function f(){return e=t=null,c}return c.scale(1070)}function o9(e){return function(t,n){var r=be(t),i=be(n),o=e(r*i);return o===1/0?[2,0]:[o*i*de(t),o*de(n)]}}function nh(e){return function(t,n){var r=Kn(t*t+n*n),i=e(r),o=de(i),a=be(i);return[Ho(t*o,r*a),Ir(r&&n*o/r)]}}var a9=o9(function(e){return Kn(2/(1+e))});a9.invert=nh(function(e){return 2*Ir(e/2)});function Yce(){return Wo(a9).scale(124.75).clipAngle(180-.001)}var s9=o9(function(e){return(e=wR(e))&&e/de(e)});s9.invert=nh(function(e){return e});function Vce(){return Wo(s9).scale(79.4188).clipAngle(180-.001)}function Xm(e,t){return[e,Dm(WE((dt+t)/2))]}Xm.invert=function(e,t){return[e,2*tc(xR(t))-dt]};function Xce(){return u9(Xm).scale(961/br)}function u9(e){var t=Wo(e),n=t.center,r=t.scale,i=t.translate,o=t.clipExtent,a=null,s,u,l;t.scale=function(f){return arguments.length?(r(f),c()):r()},t.translate=function(f){return arguments.length?(i(f),c()):i()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(f==null?a=s=u=l=null:(a=+f[0][0],s=+f[0][1],u=+f[1][0],l=+f[1][1]),c()):a==null?null:[[a,s],[u,l]]};function c(){var f=we*r(),d=t(mce(t.rotate()).invert([0,0]));return o(a==null?[[d[0]-f,d[1]-f],[d[0]+f,d[1]+f]]:e===Xm?[[Math.max(d[0]-f,a),s],[Math.min(d[0]+f,u),l]]:[[a,Math.max(d[1]-f,s)],[u,Math.min(d[1]+f,l)]])}return c()}function Km(e){return WE((dt+e)/2)}function Kce(e,t){var n=be(e),r=e===t?de(e):Dm(n/be(t))/Dm(Km(t)/Km(e)),i=n*HE(Km(e),r)/r;if(!r)return Xm;function o(a,s){i>0?s<-dt+me&&(s=-dt+me):s>dt-me&&(s=dt-me);var u=i/HE(Km(s),r);return[u*de(r*a),i-u*be(r*a)]}return o.invert=function(a,s){var u=i-s,l=jr(r)*Kn(a*a+u*u),c=Ho(a,Ue(u))*jr(u);return u*r<0&&(c-=we*jr(a)*jr(u)),[c/r,2*tc(HE(i/l,1/r))-dt]},o}function Zce(){return g$(Kce).scale(109.5).parallels([30,30])}function Zm(e,t){return[e,t]}Zm.invert=Zm;function Jce(){return Wo(Zm).scale(152.63)}function Qce(e,t){var n=be(e),r=e===t?de(e):(n-be(t))/(t-e),i=n/r+e;if(Ue(r)<me)return Zm;function o(a,s){var u=i-s,l=r*a;return[u*de(l),i-u*be(l)]}return o.invert=function(a,s){var u=i-s,l=Ho(a,Ue(u))*jr(u);return u*r<0&&(l-=we*jr(a)*jr(u)),[l/r,i-jr(r)*Kn(a*a+u*u)]},o}function efe(){return g$(Qce).scale(131.154).center([0,13.9389])}var rh=1.340264,ih=-.081106,oh=893e-6,ah=.003796,Jm=Kn(3)/2,tfe=12;function l9(e,t){var n=Ir(Jm*de(t)),r=n*n,i=r*r*r;return[e*be(n)/(Jm*(rh+3*ih*r+i*(7*oh+9*ah*r))),n*(rh+ih*r+i*(oh+ah*r))]}l9.invert=function(e,t){for(var n=t,r=n*n,i=r*r*r,o=0,a,s,u;o<tfe&&(s=n*(rh+ih*r+i*(oh+ah*r))-t,u=rh+3*ih*r+i*(7*oh+9*ah*r),n-=a=s/u,r=n*n,i=r*r*r,!(Ue(a)<vR));++o);return[Jm*e*(rh+3*ih*r+i*(7*oh+9*ah*r))/be(n),Ir(de(n)/Jm)]};function nfe(){return Wo(l9).scale(177.158)}function c9(e,t){var n=be(t),r=be(e)*n;return[n*de(e)/r,de(t)/r]}c9.invert=nh(tc);function rfe(){return Wo(c9).scale(144.049).clipAngle(60)}function ife(){var e=1,t=0,n=0,r=1,i=1,o=0,a,s,u=null,l,c,f,d=1,h=1,g=Gm({point:function(x,w){var E=b([x,w]);this.stream.point(E[0],E[1])}}),p=Kd,m,y;function v(){return d=e*r,h=e*i,m=y=null,b}function b(x){var w=x[0]*d,E=x[1]*h;if(o){var _=E*a-w*s;w=w*a+E*s,E=_}return[w+t,E+n]}return b.invert=function(x){var w=x[0]-t,E=x[1]-n;if(o){var _=E*a+w*s;w=w*a-E*s,E=_}return[w/d,E/h]},b.stream=function(x){return m&&y===x?m:m=g(p(y=x))},b.postclip=function(x){return arguments.length?(p=x,u=l=c=f=null,v()):p},b.clipExtent=function(x){return arguments.length?(p=x==null?(u=l=c=f=null,Kd):RR(u=+x[0][0],l=+x[0][1],c=+x[1][0],f=+x[1][1]),v()):u==null?null:[[u,l],[c,f]]},b.scale=function(x){return arguments.length?(e=+x,v()):e},b.translate=function(x){return arguments.length?(t=+x[0],n=+x[1],v()):[t,n]},b.angle=function(x){return arguments.length?(o=x%360*at,s=de(o),a=be(o),v()):o*fn},b.reflectX=function(x){return arguments.length?(r=x?-1:1,v()):r<0},b.reflectY=function(x){return arguments.length?(i=x?-1:1,v()):i<0},b.fitExtent=function(x,w){return Ym(b,x,w)},b.fitSize=function(x,w){return f$(b,x,w)},b.fitWidth=function(x,w){return d$(b,x,w)},b.fitHeight=function(x,w){return h$(b,x,w)},b}function f9(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}f9.invert=function(e,t){var n=t,r=25,i;do{var o=n*n,a=o*o;n-=i=(n*(1.007226+o*(.015085+a*(-.044475+.028874*o-.005916*a)))-t)/(1.007226+o*(.015085*3+a*(-.044475*7+.028874*9*o-.005916*11*a)))}while(Ue(i)>me&&--r>0);return[e/(.8707+(o=n*n)*(-.131979+o*(-.013791+o*o*o*(.003971-.001529*o)))),n]};function ofe(){return Wo(f9).scale(175.295)}function d9(e,t){return[be(t)*de(e),de(t)]}d9.invert=nh(Ir);function afe(){return Wo(d9).scale(249.5).clipAngle(90+me)}function h9(e,t){var n=be(t),r=1+be(e)*n;return[n*de(e)/r,de(t)/r]}h9.invert=nh(function(e){return 2*tc(e)});function sfe(){return Wo(h9).scale(250).clipAngle(142)}function g9(e,t){return[Dm(WE((dt+t)/2)),-e]}g9.invert=function(e,t){return[-t,2*tc(xR(e))-dt]};function ufe(){var e=u9(g9),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}class lfe{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const o=n[i],a=t+o,s=Math.abs(t)<Math.abs(o)?t-(a-o):o-(a-t);s&&(n[r++]=s),t=a}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,o,a=0;if(n>0){for(a=t[--n];n>0&&(r=a,i=t[--n],a=r+i,o=i-(a-r),!o););n>0&&(o<0&&t[n-1]<0||o>0&&t[n-1]>0)&&(i=o*2,r=a+i,i==r-a&&(a=r))}return a}}function*cfe(e){for(const t of e)yield*t}function p9(e){return Array.from(cfe(e))}var Ze=1e-6,ffe=1e-12,Oe=Math.PI,zr=Oe/2,m9=Oe/4,gi=Oe*2,Go=180/Oe,xr=Oe/180,vt=Math.abs,dfe=Math.atan,sh=Math.atan2,bt=Math.cos,xt=Math.sin,hfe=Math.sign||function(e){return e>0?1:e<0?-1:0},Qm=Math.sqrt;function gfe(e){return e>1?0:e<-1?Oe:Math.acos(e)}function uh(e){return e>1?zr:e<-1?-zr:Math.asin(e)}function lh(){}function e1(e,t){e&&v9.hasOwnProperty(e.type)&&v9[e.type](e,t)}var y9={Feature:function(e,t){e1(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)e1(n[r].geometry,t)}},v9={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){p$(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)p$(n[r],t,0)},Polygon:function(e,t){b9(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)b9(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)e1(n[r],t)}};function p$(e,t,n){var r=-1,i=e.length-n,o;for(t.lineStart();++r<i;)o=e[r],t.point(o[0],o[1],o[2]);t.lineEnd()}function b9(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)p$(e[n],t,1);t.polygonEnd()}function pfe(e,t){e&&y9.hasOwnProperty(e.type)?y9[e.type](e,t):e1(e,t)}function m$(e){return[sh(e[1],e[0]),uh(e[2])]}function ac(e){var t=e[0],n=e[1],r=bt(n);return[r*bt(t),r*xt(t),xt(n)]}function t1(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function n1(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function y$(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function r1(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function v$(e){var t=Qm(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function b$(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function x$(e,t){return[vt(e)>Oe?e+Math.round(-e/gi)*gi:e,t]}x$.invert=x$;function mfe(e,t,n){return(e%=gi)?t||n?b$(w9(e),_9(t,n)):w9(e):t||n?_9(t,n):x$}function x9(e){return function(t,n){return t+=e,[t>Oe?t-gi:t<-Oe?t+gi:t,n]}}function w9(e){var t=x9(e);return t.invert=x9(-e),t}function _9(e,t){var n=bt(e),r=xt(e),i=bt(t),o=xt(t);function a(s,u){var l=bt(u),c=bt(s)*l,f=xt(s)*l,d=xt(u),h=d*n+c*r;return[sh(f*i-h*o,c*n-d*r),uh(h*i+f*o)]}return a.invert=function(s,u){var l=bt(u),c=bt(s)*l,f=xt(s)*l,d=xt(u),h=d*i-f*o;return[sh(f*i+d*o,c*n+h*r),uh(h*n-c*r)]},a}function yfe(e,t,n,r,i,o){if(!!n){var a=bt(t),s=xt(t),u=r*n;i==null?(i=t+r*gi,o=t-u/2):(i=E9(a,i),o=E9(a,o),(r>0?i<o:i>o)&&(i+=r*gi));for(var l,c=i;r>0?c>o:c<o;c-=u)l=m$([a,-s*bt(c),-s*xt(c)]),e.point(l[0],l[1])}}function E9(e,t){t=ac(t),t[0]-=e,v$(t);var n=gfe(-t[1]);return((-t[2]<0?-n:n)+gi-Ze)%gi}function $9(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:lh,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function i1(e,t){return vt(e[0]-t[0])<Ze&&vt(e[1]-t[1])<Ze}function o1(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function A9(e,t,n,r,i){var o=[],a=[],s,u;if(e.forEach(function(g){if(!((p=g.length-1)<=0)){var p,m=g[0],y=g[p],v;if(i1(m,y)){if(!m[2]&&!y[2]){for(i.lineStart(),s=0;s<p;++s)i.point((m=g[s])[0],m[1]);i.lineEnd();return}y[0]+=2*Ze}o.push(v=new o1(m,g,null,!0)),a.push(v.o=new o1(m,null,v,!1)),o.push(v=new o1(y,g,null,!1)),a.push(v.o=new o1(y,null,v,!0))}}),!!o.length){for(a.sort(t),S9(o),S9(a),s=0,u=a.length;s<u;++s)a[s].e=n=!n;for(var l=o[0],c,f;;){for(var d=l,h=!0;d.v;)if((d=d.n)===l)return;c=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(s=0,u=c.length;s<u;++s)i.point((f=c[s])[0],f[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(h)for(c=d.p.z,s=c.length-1;s>=0;--s)i.point((f=c[s])[0],f[1]);else r(d.x,d.p.x,-1,i);d=d.p}d=d.o,c=d.z,h=!h}while(!d.v);i.lineEnd()}}}function S9(e){if(!!(t=e.length)){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function w$(e){return vt(e[0])<=Oe?e[0]:hfe(e[0])*((vt(e[0])+Oe)%gi-Oe)}function vfe(e,t){var n=w$(t),r=t[1],i=xt(r),o=[xt(n),-bt(n),0],a=0,s=0,u=new lfe;i===1?r=zr+Ze:i===-1&&(r=-zr-Ze);for(var l=0,c=e.length;l<c;++l)if(!!(d=(f=e[l]).length))for(var f,d,h=f[d-1],g=w$(h),p=h[1]/2+m9,m=xt(p),y=bt(p),v=0;v<d;++v,g=x,m=E,y=_,h=b){var b=f[v],x=w$(b),w=b[1]/2+m9,E=xt(w),_=bt(w),S=x-g,C=S>=0?1:-1,O=C*S,$=O>Oe,M=m*E;if(u.add(sh(M*C*xt(O),y*_+M*bt(O))),a+=$?S+C*gi:S,$^g>=n^x>=n){var F=n1(ac(h),ac(b));v$(F);var N=n1(o,F);v$(N);var A=($^S>=0?-1:1)*uh(N[2]);(r>A||r===A&&(F[0]||F[1]))&&(s+=$^S>=0?1:-1)}}return(a<-Ze||a<Ze&&u<-ffe)^s&1}function C9(e,t,n,r){return function(i){var o=t(i),a=$9(),s=t(a),u=!1,l,c,f,d={point:h,lineStart:p,lineEnd:m,polygonStart:function(){d.point=y,d.lineStart=v,d.lineEnd=b,c=[],l=[]},polygonEnd:function(){d.point=h,d.lineStart=p,d.lineEnd=m,c=p9(c);var x=vfe(l,r);c.length?(u||(i.polygonStart(),u=!0),A9(c,xfe,x,n,i)):x&&(u||(i.polygonStart(),u=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),u&&(i.polygonEnd(),u=!1),c=l=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(x,w){e(x,w)&&i.point(x,w)}function g(x,w){o.point(x,w)}function p(){d.point=g,o.lineStart()}function m(){d.point=h,o.lineEnd()}function y(x,w){f.push([x,w]),s.point(x,w)}function v(){s.lineStart(),f=[]}function b(){y(f[0][0],f[0][1]),s.lineEnd();var x=s.clean(),w=a.result(),E,_=w.length,S,C,O;if(f.pop(),l.push(f),f=null,!!_){if(x&1){if(C=w[0],(S=C.length-1)>0){for(u||(i.polygonStart(),u=!0),i.lineStart(),E=0;E<S;++E)i.point((O=C[E])[0],O[1]);i.lineEnd()}return}_>1&&x&2&&w.push(w.pop().concat(w.shift())),c.push(w.filter(bfe))}}return d}}function bfe(e){return e.length>1}function xfe(e,t){return((e=e.x)[0]<0?e[1]-zr-Ze:zr-e[1])-((t=t.x)[0]<0?t[1]-zr-Ze:zr-t[1])}var O9=C9(function(){return!0},wfe,Efe,[-Oe,-zr]);function wfe(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(o,a){var s=o>0?Oe:-Oe,u=vt(o-t);vt(u-Oe)<Ze?(e.point(t,n=(n+a)/2>0?zr:-zr),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(s,n),e.point(o,n),i=0):r!==s&&u>=Oe&&(vt(t-r)<Ze&&(t-=r*Ze),vt(o-s)<Ze&&(o-=s*Ze),n=_fe(t,n,o,a),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(s,n),i=0),e.point(t=o,n=a),r=s},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function _fe(e,t,n,r){var i,o,a=xt(e-n);return vt(a)>Ze?dfe((xt(t)*(o=bt(r))*xt(n)-xt(r)*(i=bt(t))*xt(e))/(i*o*a)):(t+r)/2}function Efe(e,t,n,r){var i;if(e==null)i=n*zr,r.point(-Oe,i),r.point(0,i),r.point(Oe,i),r.point(Oe,0),r.point(Oe,-i),r.point(0,-i),r.point(-Oe,-i),r.point(-Oe,0),r.point(-Oe,i);else if(vt(e[0]-t[0])>Ze){var o=e[0]<t[0]?Oe:-Oe;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(t[0],t[1])}function $fe(e){var t=bt(e),n=6*xr,r=t>0,i=vt(t)>Ze;function o(c,f,d,h){yfe(h,e,n,d,c,f)}function a(c,f){return bt(c)*bt(f)>t}function s(c){var f,d,h,g,p;return{lineStart:function(){g=h=!1,p=1},point:function(m,y){var v=[m,y],b,x=a(m,y),w=r?x?0:l(m,y):x?l(m+(m<0?Oe:-Oe),y):0;if(!f&&(g=h=x)&&c.lineStart(),x!==h&&(b=u(f,v),(!b||i1(f,b)||i1(v,b))&&(v[2]=1)),x!==h)p=0,x?(c.lineStart(),b=u(v,f),c.point(b[0],b[1])):(b=u(f,v),c.point(b[0],b[1],2),c.lineEnd()),f=b;else if(i&&f&&r^x){var E;!(w&d)&&(E=u(v,f,!0))&&(p=0,r?(c.lineStart(),c.point(E[0][0],E[0][1]),c.point(E[1][0],E[1][1]),c.lineEnd()):(c.point(E[1][0],E[1][1]),c.lineEnd(),c.lineStart(),c.point(E[0][0],E[0][1],3)))}x&&(!f||!i1(f,v))&&c.point(v[0],v[1]),f=v,h=x,d=w},lineEnd:function(){h&&c.lineEnd(),f=null},clean:function(){return p|(g&&h)<<1}}}function u(c,f,d){var h=ac(c),g=ac(f),p=[1,0,0],m=n1(h,g),y=t1(m,m),v=m[0],b=y-v*v;if(!b)return!d&&c;var x=t*y/b,w=-t*v/b,E=n1(p,m),_=r1(p,x),S=r1(m,w);y$(_,S);var C=E,O=t1(_,C),$=t1(C,C),M=O*O-$*(t1(_,_)-1);if(!(M<0)){var F=Qm(M),N=r1(C,(-O-F)/$);if(y$(N,_),N=m$(N),!d)return N;var A=c[0],k=f[0],T=c[1],L=f[1],z;k<A&&(z=A,A=k,k=z);var Q=k-A,oe=vt(Q-Oe)<Ze,ue=oe||Q<Ze;if(!oe&&L<T&&(z=T,T=L,L=z),ue?oe?T+L>0^N[1]<(vt(N[0]-A)<Ze?T:L):T<=N[1]&&N[1]<=L:Q>Oe^(A<=N[0]&&N[0]<=k)){var ce=r1(C,(-O+F)/$);return y$(ce,_),[N,m$(ce)]}}}function l(c,f){var d=r?e:Oe-e,h=0;return c<-d?h|=1:c>d&&(h|=2),f<-d?h|=4:f>d&&(h|=8),h}return C9(a,s,o,r?[0,-e]:[-Oe,e-Oe])}function Afe(e,t,n,r,i,o){var a=e[0],s=e[1],u=t[0],l=t[1],c=0,f=1,d=u-a,h=l-s,g;if(g=n-a,!(!d&&g>0)){if(g/=d,d<0){if(g<c)return;g<f&&(f=g)}else if(d>0){if(g>f)return;g>c&&(c=g)}if(g=i-a,!(!d&&g<0)){if(g/=d,d<0){if(g>f)return;g>c&&(c=g)}else if(d>0){if(g<c)return;g<f&&(f=g)}if(g=r-s,!(!h&&g>0)){if(g/=h,h<0){if(g<c)return;g<f&&(f=g)}else if(h>0){if(g>f)return;g>c&&(c=g)}if(g=o-s,!(!h&&g<0)){if(g/=h,h<0){if(g>f)return;g>c&&(c=g)}else if(h>0){if(g<c)return;g<f&&(f=g)}return c>0&&(e[0]=a+c*d,e[1]=s+c*h),f<1&&(t[0]=a+f*d,t[1]=s+f*h),!0}}}}}var ch=1e9,a1=-ch;function Sfe(e,t,n,r){function i(l,c){return e<=l&&l<=n&&t<=c&&c<=r}function o(l,c,f,d){var h=0,g=0;if(l==null||(h=a(l,f))!==(g=a(c,f))||u(l,c)<0^f>0)do d.point(h===0||h===3?e:n,h>1?r:t);while((h=(h+f+4)%4)!==g);else d.point(c[0],c[1])}function a(l,c){return vt(l[0]-e)<Ze?c>0?0:3:vt(l[0]-n)<Ze?c>0?2:1:vt(l[1]-t)<Ze?c>0?1:0:c>0?3:2}function s(l,c){return u(l.x,c.x)}function u(l,c){var f=a(l,1),d=a(c,1);return f!==d?f-d:f===0?c[1]-l[1]:f===1?l[0]-c[0]:f===2?l[1]-c[1]:c[0]-l[0]}return function(l){var c=l,f=$9(),d,h,g,p,m,y,v,b,x,w,E,_={point:S,lineStart:M,lineEnd:F,polygonStart:O,polygonEnd:$};function S(A,k){i(A,k)&&c.point(A,k)}function C(){for(var A=0,k=0,T=h.length;k<T;++k)for(var L=h[k],z=1,Q=L.length,oe=L[0],ue,ce,xe=oe[0],_e=oe[1];z<Q;++z)ue=xe,ce=_e,oe=L[z],xe=oe[0],_e=oe[1],ce<=r?_e>r&&(xe-ue)*(r-ce)>(_e-ce)*(e-ue)&&++A:_e<=r&&(xe-ue)*(r-ce)<(_e-ce)*(e-ue)&&--A;return A}function O(){c=f,d=[],h=[],E=!0}function $(){var A=C(),k=E&&A,T=(d=p9(d)).length;(k||T)&&(l.polygonStart(),k&&(l.lineStart(),o(null,null,1,l),l.lineEnd()),T&&A9(d,s,A,o,l),l.polygonEnd()),c=l,d=h=g=null}function M(){_.point=N,h&&h.push(g=[]),w=!0,x=!1,v=b=NaN}function F(){d&&(N(p,m),y&&x&&f.rejoin(),d.push(f.result())),_.point=S,x&&c.lineEnd()}function N(A,k){var T=i(A,k);if(h&&g.push([A,k]),w)p=A,m=k,y=T,w=!1,T&&(c.lineStart(),c.point(A,k));else if(T&&x)c.point(A,k);else{var L=[v=Math.max(a1,Math.min(ch,v)),b=Math.max(a1,Math.min(ch,b))],z=[A=Math.max(a1,Math.min(ch,A)),k=Math.max(a1,Math.min(ch,k))];Afe(L,z,e,t,n,r)?(x||(c.lineStart(),c.point(L[0],L[1])),c.point(z[0],z[1]),T||c.lineEnd(),E=!1):T&&(c.lineStart(),c.point(A,k),E=!1)}v=A,b=k,x=T}return _}}var F9=e=>e,sc=1/0,s1=sc,fh=-sc,u1=fh,Cfe={point:Ofe,lineStart:lh,lineEnd:lh,polygonStart:lh,polygonEnd:lh,result:function(){var e=[[sc,s1],[fh,u1]];return fh=u1=-(s1=sc=1/0),e}};function Ofe(e,t){e<sc&&(sc=e),e>fh&&(fh=e),t<s1&&(s1=t),t>u1&&(u1=t)}var k9=Cfe;function _$(e){return function(t){var n=new E$;for(var r in e)n[r]=e[r];return n.stream=t,n}}function E$(){}E$.prototype={constructor:E$,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function $$(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),pfe(n,e.stream(k9)),t(k9.result()),r!=null&&e.clipExtent(r),e}function M9(e,t,n){return $$(e,function(r){var i=t[1][0]-t[0][0],o=t[1][1]-t[0][1],a=Math.min(i/(r[1][0]-r[0][0]),o/(r[1][1]-r[0][1])),s=+t[0][0]+(i-a*(r[1][0]+r[0][0]))/2,u=+t[0][1]+(o-a*(r[1][1]+r[0][1]))/2;e.scale(150*a).translate([s,u])},n)}function Ffe(e,t,n){return M9(e,[[0,0],t],n)}function kfe(e,t,n){return $$(e,function(r){var i=+t,o=i/(r[1][0]-r[0][0]),a=(i-o*(r[1][0]+r[0][0]))/2,s=-o*r[0][1];e.scale(150*o).translate([a,s])},n)}function Mfe(e,t,n){return $$(e,function(r){var i=+t,o=i/(r[1][1]-r[0][1]),a=-o*r[0][0],s=(i-o*(r[1][1]+r[0][1]))/2;e.scale(150*o).translate([a,s])},n)}var D9=16,Dfe=bt(30*xr);function N9(e,t){return+t?Tfe(e,t):Nfe(e)}function Nfe(e){return _$({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function Tfe(e,t){function n(r,i,o,a,s,u,l,c,f,d,h,g,p,m){var y=l-r,v=c-i,b=y*y+v*v;if(b>4*t&&p--){var x=a+d,w=s+h,E=u+g,_=Qm(x*x+w*w+E*E),S=uh(E/=_),C=vt(vt(E)-1)<Ze||vt(o-f)<Ze?(o+f)/2:sh(w,x),O=e(C,S),$=O[0],M=O[1],F=$-r,N=M-i,A=v*F-y*N;(A*A/b>t||vt((y*F+v*N)/b-.5)>.3||a*d+s*h+u*g<Dfe)&&(n(r,i,o,a,s,u,$,M,C,x/=_,w/=_,E,p,m),m.point($,M),n($,M,C,x,w,E,l,c,f,d,h,g,p,m))}}return function(r){var i,o,a,s,u,l,c,f,d,h,g,p,m={point:y,lineStart:v,lineEnd:x,polygonStart:function(){r.polygonStart(),m.lineStart=w},polygonEnd:function(){r.polygonEnd(),m.lineStart=v}};function y(S,C){S=e(S,C),r.point(S[0],S[1])}function v(){f=NaN,m.point=b,r.lineStart()}function b(S,C){var O=ac([S,C]),$=e(S,C);n(f,d,c,h,g,p,f=$[0],d=$[1],c=S,h=O[0],g=O[1],p=O[2],D9,r),r.point(f,d)}function x(){m.point=y,r.lineEnd()}function w(){v(),m.point=E,m.lineEnd=_}function E(S,C){b(i=S,C),o=f,a=d,s=h,u=g,l=p,m.point=b}function _(){n(f,d,c,h,g,p,o,a,i,s,u,l,D9,r),m.lineEnd=x,x()}return m}}var Rfe=_$({point:function(e,t){this.stream.point(e*xr,t*xr)}});function Pfe(e){return _$({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function Lfe(e,t,n,r,i){function o(a,s){return a*=r,s*=i,[t+e*a,n-e*s]}return o.invert=function(a,s){return[(a-t)/e*r,(n-s)/e*i]},o}function T9(e,t,n,r,i,o){if(!o)return Lfe(e,t,n,r,i);var a=bt(o),s=xt(o),u=a*e,l=s*e,c=a/e,f=s/e,d=(s*n-a*t)/e,h=(s*t+a*n)/e;function g(p,m){return p*=r,m*=i,[u*p-l*m+t,n-l*p-u*m]}return g.invert=function(p,m){return[r*(c*p-f*m+d),i*(h-f*p-c*m)]},g}function jfe(e){return Ife(function(){return e})()}function Ife(e){var t,n=150,r=480,i=250,o=0,a=0,s=0,u=0,l=0,c,f=0,d=1,h=1,g=null,p=O9,m=null,y,v,b,x=F9,w=.5,E,_,S,C,O;function $(A){return S(A[0]*xr,A[1]*xr)}function M(A){return A=S.invert(A[0],A[1]),A&&[A[0]*Go,A[1]*Go]}$.stream=function(A){return C&&O===A?C:C=Rfe(Pfe(c)(p(E(x(O=A)))))},$.preclip=function(A){return arguments.length?(p=A,g=void 0,N()):p},$.postclip=function(A){return arguments.length?(x=A,m=y=v=b=null,N()):x},$.clipAngle=function(A){return arguments.length?(p=+A?$fe(g=A*xr):(g=null,O9),N()):g*Go},$.clipExtent=function(A){return arguments.length?(x=A==null?(m=y=v=b=null,F9):Sfe(m=+A[0][0],y=+A[0][1],v=+A[1][0],b=+A[1][1]),N()):m==null?null:[[m,y],[v,b]]},$.scale=function(A){return arguments.length?(n=+A,F()):n},$.translate=function(A){return arguments.length?(r=+A[0],i=+A[1],F()):[r,i]},$.center=function(A){return arguments.length?(o=A[0]%360*xr,a=A[1]%360*xr,F()):[o*Go,a*Go]},$.rotate=function(A){return arguments.length?(s=A[0]%360*xr,u=A[1]%360*xr,l=A.length>2?A[2]%360*xr:0,F()):[s*Go,u*Go,l*Go]},$.angle=function(A){return arguments.length?(f=A%360*xr,F()):f*Go},$.reflectX=function(A){return arguments.length?(d=A?-1:1,F()):d<0},$.reflectY=function(A){return arguments.length?(h=A?-1:1,F()):h<0},$.precision=function(A){return arguments.length?(E=N9(_,w=A*A),N()):Qm(w)},$.fitExtent=function(A,k){return M9($,A,k)},$.fitSize=function(A,k){return Ffe($,A,k)},$.fitWidth=function(A,k){return kfe($,A,k)},$.fitHeight=function(A,k){return Mfe($,A,k)};function F(){var A=T9(n,0,0,d,h,f).apply(null,t(o,a)),k=T9(n,r-A[0],i-A[1],d,h,f);return c=mfe(s,u,l),_=b$(t,k),S=b$(c,_),E=N9(_,w),N()}function N(){return C=O=null,$}return function(){return t=e.apply(this,arguments),$.invert=t.invert&&M,F()}}var Bfe=Math.abs,A$=Math.cos,l1=Math.sin,zfe=1e-6,R9=Math.PI,S$=R9/2,P9=Ufe(2);function L9(e){return e>1?S$:e<-1?-S$:Math.asin(e)}function Ufe(e){return e>0?Math.sqrt(e):0}function qfe(e,t){var n=e*l1(t),r=30,i;do t-=i=(t+l1(t)-n)/(1+A$(t));while(Bfe(i)>zfe&&--r>0);return t/2}function Hfe(e,t,n){function r(i,o){return[e*i*A$(o=qfe(n,o)),t*l1(o)]}return r.invert=function(i,o){return o=L9(o/t),[i/(e*A$(o)),L9((2*o+l1(2*o))/n)]},r}var Wfe=Hfe(P9/S$,P9,R9);function Gfe(){return jfe(Wfe).scale(169.529)}const Yfe=QR(),C$=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function Vfe(e,t){return function n(){const r=t();return r.type=e,r.path=QR().projection(r),r.copy=r.copy||function(){const i=n();return C$.forEach(o=>{r[o]&&i[o](r[o]())}),i.path.pointRadius(r.path.pointRadius()),i},r}}function O$(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(c1[e]=Vfe(e,t),this):c1[e]||null}function j9(e){return e&&e.path||Yfe}const c1={albers:i9,albersusa:Gce,azimuthalequalarea:Yce,azimuthalequidistant:Vce,conicconformal:Zce,conicequalarea:Vm,conicequidistant:efe,equalEarth:nfe,equirectangular:Jce,gnomonic:rfe,identity:ife,mercator:Xce,mollweide:Gfe,naturalEarth1:ofe,orthographic:afe,stereographic:sfe,transversemercator:ufe};for(const e in c1)O$(e,c1[e]);var Ya=1e-6,I9=Math.abs,f1=Math.ceil;function B9(e,t,n){var r=lu(e,t-Ya,n).concat(t);return function(i){return r.map(function(o){return[i,o]})}}function z9(e,t,n){var r=lu(e,t-Ya,n).concat(t);return function(i){return r.map(function(o){return[o,i]})}}function Xfe(){var e,t,n,r,i,o,a,s,u=10,l=u,c=90,f=360,d,h,g,p,m=2.5;function y(){return{type:"MultiLineString",coordinates:v()}}function v(){return lu(f1(r/c)*c,n,c).map(g).concat(lu(f1(s/f)*f,a,f).map(p)).concat(lu(f1(t/u)*u,e,u).filter(function(b){return I9(b%c)>Ya}).map(d)).concat(lu(f1(o/l)*l,i,l).filter(function(b){return I9(b%f)>Ya}).map(h))}return y.lines=function(){return v().map(function(b){return{type:"LineString",coordinates:b}})},y.outline=function(){return{type:"Polygon",coordinates:[g(r).concat(p(a).slice(1),g(n).reverse().slice(1),p(s).reverse().slice(1))]}},y.extent=function(b){return arguments.length?y.extentMajor(b).extentMinor(b):y.extentMinor()},y.extentMajor=function(b){return arguments.length?(r=+b[0][0],n=+b[1][0],s=+b[0][1],a=+b[1][1],r>n&&(b=r,r=n,n=b),s>a&&(b=s,s=a,a=b),y.precision(m)):[[r,s],[n,a]]},y.extentMinor=function(b){return arguments.length?(t=+b[0][0],e=+b[1][0],o=+b[0][1],i=+b[1][1],t>e&&(b=t,t=e,e=b),o>i&&(b=o,o=i,i=b),y.precision(m)):[[t,o],[e,i]]},y.step=function(b){return arguments.length?y.stepMajor(b).stepMinor(b):y.stepMinor()},y.stepMajor=function(b){return arguments.length?(c=+b[0],f=+b[1],y):[c,f]},y.stepMinor=function(b){return arguments.length?(u=+b[0],l=+b[1],y):[u,l]},y.precision=function(b){return arguments.length?(m=+b,d=B9(o,i,90),h=z9(t,e,m),g=B9(s,a,90),p=z9(r,n,m),y):m},y.extentMajor([[-180,-90+Ya],[180,90-Ya]]).extentMinor([[-180,-80-Ya],[180,80+Ya]])}function F$(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function U9(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function dh(){}var hh=.7,d1=1/hh,uc="\\s*([+-]?\\d+)\\s*",gh="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",no="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Kfe=/^#([0-9a-f]{3,8})$/,Zfe=new RegExp("^rgb\\("+[uc,uc,uc]+"\\)$"),Jfe=new RegExp("^rgb\\("+[no,no,no]+"\\)$"),Qfe=new RegExp("^rgba\\("+[uc,uc,uc,gh]+"\\)$"),ede=new RegExp("^rgba\\("+[no,no,no,gh]+"\\)$"),tde=new RegExp("^hsl\\("+[gh,no,no]+"\\)$"),nde=new RegExp("^hsla\\("+[gh,no,no,gh]+"\\)$"),q9={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};F$(dh,k$,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:H9,formatHex:H9,formatHsl:rde,formatRgb:W9,toString:W9});function H9(){return this.rgb().formatHex()}function rde(){return K9(this).formatHsl()}function W9(){return this.rgb().formatRgb()}function k$(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Kfe.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?G9(t):n===3?new wr(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?h1(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?h1(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Zfe.exec(e))?new wr(t[1],t[2],t[3],1):(t=Jfe.exec(e))?new wr(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Qfe.exec(e))?h1(t[1],t[2],t[3],t[4]):(t=ede.exec(e))?h1(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=tde.exec(e))?X9(t[1],t[2]/100,t[3]/100,1):(t=nde.exec(e))?X9(t[1],t[2]/100,t[3]/100,t[4]):q9.hasOwnProperty(e)?G9(q9[e]):e==="transparent"?new wr(NaN,NaN,NaN,0):null}function G9(e){return new wr(e>>16&255,e>>8&255,e&255,1)}function h1(e,t,n,r){return r<=0&&(e=t=n=NaN),new wr(e,t,n,r)}function ide(e){return e instanceof dh||(e=k$(e)),e?(e=e.rgb(),new wr(e.r,e.g,e.b,e.opacity)):new wr}function M$(e,t,n,r){return arguments.length===1?ide(e):new wr(e,t,n,r==null?1:r)}function wr(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}F$(wr,M$,U9(dh,{brighter:function(e){return e=e==null?d1:Math.pow(d1,e),new wr(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?hh:Math.pow(hh,e),new wr(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Y9,formatHex:Y9,formatRgb:V9,toString:V9}));function Y9(){return"#"+D$(this.r)+D$(this.g)+D$(this.b)}function V9(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function D$(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function X9(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ro(e,t,n,r)}function K9(e){if(e instanceof ro)return new ro(e.h,e.s,e.l,e.opacity);if(e instanceof dh||(e=k$(e)),!e)return new ro;if(e instanceof ro)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(t===o?a=(n-r)/s+(n<r)*6:n===o?a=(r-t)/s+2:a=(t-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new ro(a,s,u,e.opacity)}function ode(e,t,n,r){return arguments.length===1?K9(e):new ro(e,t,n,r==null?1:r)}function ro(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}F$(ro,ode,U9(dh,{brighter:function(e){return e=e==null?d1:Math.pow(d1,e),new ro(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?hh:Math.pow(hh,e),new ro(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new wr(N$(e>=240?e-240:e+120,i,r),N$(e,i,r),N$(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function N$(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}function ade(){}const Yo=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function Z9(){var e=1,t=1,n=s;function r(u,l){return l.map(c=>i(u,c))}function i(u,l){var c=[],f=[];return o(u,l,d=>{n(d,u,l),sde(d)>0?c.push([d]):f.push(d)}),f.forEach(d=>{for(var h=0,g=c.length,p;h<g;++h)if(ude((p=c[h])[0],d)!==-1){p.push(d);return}}),{type:"MultiPolygon",value:l,coordinates:c}}function o(u,l,c){var f=new Array,d=new Array,h,g,p,m,y,v;for(h=g=-1,m=u[0]>=l,Yo[m<<1].forEach(b);++h<e-1;)p=m,m=u[h+1]>=l,Yo[p|m<<1].forEach(b);for(Yo[m<<0].forEach(b);++g<t-1;){for(h=-1,m=u[g*e+e]>=l,y=u[g*e]>=l,Yo[m<<1|y<<2].forEach(b);++h<e-1;)p=m,m=u[g*e+e+h+1]>=l,v=y,y=u[g*e+h+1]>=l,Yo[p|m<<1|y<<2|v<<3].forEach(b);Yo[m|y<<3].forEach(b)}for(h=-1,y=u[g*e]>=l,Yo[y<<2].forEach(b);++h<e-1;)v=y,y=u[g*e+h+1]>=l,Yo[y<<2|v<<3].forEach(b);Yo[y<<3].forEach(b);function b(x){var w=[x[0][0]+h,x[0][1]+g],E=[x[1][0]+h,x[1][1]+g],_=a(w),S=a(E),C,O;(C=d[_])?(O=f[S])?(delete d[C.end],delete f[O.start],C===O?(C.ring.push(E),c(C.ring)):f[C.start]=d[O.end]={start:C.start,end:O.end,ring:C.ring.concat(O.ring)}):(delete d[C.end],C.ring.push(E),d[C.end=S]=C):(C=f[S])?(O=d[_])?(delete f[C.start],delete d[O.end],C===O?(C.ring.push(E),c(C.ring)):f[O.start]=d[C.end]={start:O.start,end:C.end,ring:O.ring.concat(C.ring)}):(delete f[C.start],C.ring.unshift(w),f[C.start=_]=C):f[_]=d[S]={start:_,end:S,ring:[w,E]}}}function a(u){return u[0]*2+u[1]*(e+1)*4}function s(u,l,c){u.forEach(f=>{var d=f[0],h=f[1],g=d|0,p=h|0,m,y=l[p*e+g];d>0&&d<e&&g===d&&(m=l[p*e+g-1],f[0]=d+(c-m)/(y-m)-.5),h>0&&h<t&&p===h&&(m=l[(p-1)*e+g],f[1]=h+(c-m)/(y-m)-.5)})}return r.contour=i,r.size=function(u){if(!arguments.length)return[e,t];var l=Math.floor(u[0]),c=Math.floor(u[1]);return l>=0&&c>=0||B("invalid size"),e=l,t=c,r},r.smooth=function(u){return arguments.length?(n=u?s:ade,r):n===s},r}function sde(e){for(var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}function ude(e,t){for(var n=-1,r=t.length,i;++n<r;)if(i=lde(e,t[n]))return i;return 0}function lde(e,t){for(var n=t[0],r=t[1],i=-1,o=0,a=e.length,s=a-1;o<a;s=o++){var u=e[o],l=u[0],c=u[1],f=e[s],d=f[0],h=f[1];if(cde(u,f,t))return 0;c>r!=h>r&&n<(d-l)*(r-c)/(h-c)+l&&(i=-i)}return i}function cde(e,t,n){var r;return fde(e,t,n)&&dde(e[r=+(e[0]===t[0])],n[r],t[r])}function fde(e,t,n){return(t[0]-e[0])*(n[1]-e[1])==(n[0]-e[0])*(t[1]-e[1])}function dde(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function J9(e,t,n){return function(r){var i=ji(r),o=n?Math.min(i[0],0):i[0],a=i[1],s=a-o,u=t?hce(o,a,e):s/(e+1);return lu(o+u,a,u)}}function T$(e){R.call(this,null,e)}T$.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]};H(T$,R,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=e.field||En,o=Z9().smooth(e.smooth!==!1),a=e.thresholds||hde(r,i,e),s=e.as===null?null:e.as||"contour",u=[];return r.forEach(l=>{const c=i(l),f=o.size([c.width,c.height])(c.values,ee(a)?a:a(c.values));gde(f,c,l,e),f.forEach(d=>{u.push(sp(l,Ie(s!=null?{[s]:d}:d)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function hde(e,t,n){const r=J9(n.levels||10,n.nice,n.zero!==!1);return n.resolve!=="shared"?r:r(e.map(i=>Mm(t(i).values)))}function gde(e,t,n,r){let i=r.scale||t.scale,o=r.translate||t.translate;if(ye(i)&&(i=i(n,r)),ye(o)&&(o=o(n,r)),(i===1||i==null)&&!o)return;const a=(_a(i)?i:i[0])||1,s=(_a(i)?i:i[1])||1,u=o&&o[0]||0,l=o&&o[1]||0;e.forEach(Q9(t,a,s,u,l))}function Q9(e,t,n,r,i){const o=e.x1||0,a=e.y1||0,s=t*n<0;function u(f){f.forEach(l)}function l(f){s&&f.reverse(),f.forEach(c)}function c(f){f[0]=(f[0]-o)*t+r,f[1]=(f[1]-a)*n+i}return function(f){return f.coordinates.forEach(u),f}}function e7(e,t,n){const r=e>=0?e:m2(t,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function R$(e){return ye(e)?e:rn(+e)}function t7(){var e=u=>u[0],t=u=>u[1],n=bl,r=[-1,-1],i=960,o=500,a=2;function s(u,l){const c=e7(r[0],u,e)>>a,f=e7(r[1],u,t)>>a,d=c?c+2:0,h=f?f+2:0,g=2*d+(i>>a),p=2*h+(o>>a),m=new Float32Array(g*p),y=new Float32Array(g*p);let v=m;u.forEach(x=>{const w=d+(+e(x)>>a),E=h+(+t(x)>>a);w>=0&&w<g&&E>=0&&E<p&&(m[w+E*g]+=+n(x))}),c>0&&f>0?(lc(g,p,m,y,c),cc(g,p,y,m,f),lc(g,p,m,y,c),cc(g,p,y,m,f),lc(g,p,m,y,c),cc(g,p,y,m,f)):c>0?(lc(g,p,m,y,c),lc(g,p,y,m,c),lc(g,p,m,y,c),v=y):f>0&&(cc(g,p,m,y,f),cc(g,p,y,m,f),cc(g,p,m,y,f),v=y);const b=l?Math.pow(2,-2*a):1/gce(v);for(let x=0,w=g*p;x<w;++x)v[x]*=b;return{values:v,scale:1<<a,width:g,height:p,x1:d,y1:h,x2:d+(i>>a),y2:h+(o>>a)}}return s.x=function(u){return arguments.length?(e=R$(u),s):e},s.y=function(u){return arguments.length?(t=R$(u),s):t},s.weight=function(u){return arguments.length?(n=R$(u),s):n},s.size=function(u){if(!arguments.length)return[i,o];var l=+u[0],c=+u[1];return l>=0&&c>=0||B("invalid size"),i=l,o=c,s},s.cellSize=function(u){return arguments.length?((u=+u)>=1||B("invalid cell size"),a=Math.floor(Math.log(u)/Math.LN2),s):1<<a},s.bandwidth=function(u){return arguments.length?(u=ae(u),u.length===1&&(u=[+u[0],+u[0]]),u.length!==2&&B("invalid bandwidth"),r=u,s):r},s}function lc(e,t,n,r,i){const o=(i<<1)+1;for(let a=0;a<t;++a)for(let s=0,u=0;s<e+i;++s)s<e&&(u+=n[s+a*e]),s>=i&&(s>=o&&(u-=n[s-o+a*e]),r[s-i+a*e]=u/Math.min(s+1,e-1+o-s,o))}function cc(e,t,n,r,i){const o=(i<<1)+1;for(let a=0;a<e;++a)for(let s=0,u=0;s<t+i;++s)s<t&&(u+=n[a+s*e]),s>=i&&(s>=o&&(u-=n[a+(s-o)*e]),r[a+(s-i)*e]=u/Math.min(s+1,t-1+o-s,o))}function P$(e){R.call(this,null,e)}P$.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const pde=["x","y","weight","size","cellSize","bandwidth"];function n7(e,t){return pde.forEach(n=>t[n]!=null?e[n](t[n]):0),e}H(P$,R,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=mde(r,e.groupby),o=(e.groupby||[]).map(ft),a=n7(t7(),e),s=e.as||"grid",u=[];function l(c,f){for(let d=0;d<o.length;++d)c[o[d]]=f[d];return c}return u=i.map(c=>Ie(l({[s]:a(c,e.counts)},c.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function mde(e,t){var n=[],r=c=>c(s),i,o,a,s,u,l;if(t==null)n.push(e);else for(i={},o=0,a=e.length;o<a;++o)s=e[o],u=t.map(r),l=i[u],l||(i[u]=l=[],l.dims=u,n.push(l)),l.push(s);return n}function L$(e){R.call(this,null,e)}L$.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]};H(L$,R,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=Z9().smooth(e.smooth!==!1),i=e.values,o=e.thresholds||J9(e.count||10,e.nice,!!i),a=e.size,s,u;return i||(i=t.materialize(t.SOURCE).source,s=n7(t7(),e)(i,!0),u=Q9(s,s.scale||1,s.scale||1,0,0),a=[s.width,s.height],i=s.values),o=ee(o)?o:o(i),i=r.size(a)(i,o),u&&i.forEach(u),this.value&&(n.rem=this.value),this.value=n.source=n.add=(i||[]).map(Ie),n}});const j$="Feature",I$="FeatureCollection",yde="MultiPoint";function B$(e){R.call(this,null,e)}B$.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]};H(B$,R,{transform(e,t){var n=this._features,r=this._points,i=e.fields,o=i&&i[0],a=i&&i[1],s=e.geojson||!i&&En,u=t.ADD,l;l=e.modified()||t.changed(t.REM)||t.modified(tn(s))||o&&t.modified(tn(o))||a&&t.modified(tn(a)),(!this.value||l)&&(u=t.SOURCE,this._features=n=[],this._points=r=[]),s&&t.visit(u,c=>n.push(s(c))),o&&a&&(t.visit(u,c=>{var f=o(c),d=a(c);f!=null&&d!=null&&(f=+f)===f&&(d=+d)===d&&r.push([f,d])}),n=n.concat({type:j$,geometry:{type:yde,coordinates:r}})),this.value={type:I$,features:n}}});function z$(e){R.call(this,null,e)}z$.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]};H(z$,R,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.field||En,o=e.as||"path",a=n.SOURCE;!r||e.modified()?(this.value=r=j9(e.projection),n.materialize().reflow()):a=i===En||t.modified(i.fields)?n.ADD_MOD:n.ADD;const s=vde(r,e.pointRadius);return n.visit(a,u=>u[o]=r(i(u))),r.pointRadius(s),n.modifies(o)}});function vde(e,t){const n=e.pointRadius();return e.context(null),t!=null&&e.pointRadius(t),n}function U$(e){R.call(this,null,e)}U$.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]};H(U$,R,{transform(e,t){var n=e.projection,r=e.fields[0],i=e.fields[1],o=e.as||["x","y"],a=o[0],s=o[1],u;function l(c){const f=n([r(c),i(c)]);f?(c[a]=f[0],c[s]=f[1]):(c[a]=void 0,c[s]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,l):(u=t.modified(r.fields)||t.modified(i.fields),t.visit(u?t.ADD_MOD:t.ADD,l)),t.modifies(o)}});function q$(e){R.call(this,null,e)}q$.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]};H(q$,R,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.as||"shape",o=n.ADD;return(!r||e.modified())&&(this.value=r=bde(j9(e.projection),e.field||Hn("datum"),e.pointRadius),n.materialize().reflow(),o=n.SOURCE),n.visit(o,a=>a[i]=r),n.modifies(i)}});function bde(e,t,n){const r=n==null?i=>e(t(i)):i=>{var o=e.pointRadius(),a=e.pointRadius(n)(t(i));return e.pointRadius(o),a};return r.context=i=>(e.context(i),r),r}function H$(e){R.call(this,[],e),this.generator=Xfe()}H$.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};H(H$,R,{transform(e,t){var n=this.value,r=this.generator,i;if(!n.length||e.modified())for(const o in e)ye(r[o])&&r[o](e[o]);return i=r(),n.length?t.mod.push(f5(n[0],i)):t.add.push(Ie(i)),n[0]=i,t}});function W$(e){R.call(this,null,e)}W$.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};H(W$,R,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,r=e.resolve==="shared",i=e.field||En,o=wde(e.opacity,e),a=xde(e.color,e),s=e.as||"image",u={$x:0,$y:0,$value:0,$max:r?Mm(n.map(l=>Mm(i(l).values))):0};return n.forEach(l=>{const c=i(l),f=pe({},l,u);r||(f.$max=Mm(c.values||[])),l[s]=_de(c,f,a.dep?a:rn(a(f)),o.dep?o:rn(o(f)))}),t.reflow(!0).modifies(s)}});function xde(e,t){let n;return ye(e)?(n=r=>M$(e(r,t)),n.dep=r7(e)):n=rn(M$(e||"#888")),n}function wde(e,t){let n;return ye(e)?(n=r=>e(r,t),n.dep=r7(e)):e?n=rn(e):(n=r=>r.$value/r.$max||0,n.dep=!0),n}function r7(e){if(!ye(e))return!1;const t=oi(tn(e));return t.$x||t.$y||t.$value||t.$max}function _de(e,t,n,r){const i=e.width,o=e.height,a=e.x1||0,s=e.y1||0,u=e.x2||i,l=e.y2||o,c=e.values,f=c?m=>c[m]:ba,d=Nl(u-a,l-s),h=d.getContext("2d"),g=h.getImageData(0,0,u-a,l-s),p=g.data;for(let m=s,y=0;m<l;++m){t.$y=m-s;for(let v=a,b=m*i;v<u;++v,y+=4){t.$x=v-a,t.$value=f(v+b);const x=n(t);p[y+0]=x.r,p[y+1]=x.g,p[y+2]=x.b,p[y+3]=~~(255*r(t))}}return h.putImageData(g,0,0),d}function i7(e){R.call(this,null,e),this.modified(!0)}H(i7,R,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=$de(e.type),C$.forEach(r=>{e[r]!=null&&o7(n,r,e[r])})):C$.forEach(r=>{e.modified(r)&&o7(n,r,e[r])}),e.pointRadius!=null&&n.path.pointRadius(e.pointRadius),e.fit&&Ede(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Ede(e,t){const n=Ade(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function $de(e){const t=O$((e||"mercator").toLowerCase());return t||B("Unrecognized projection type: "+e),t()}function o7(e,t,n){ye(e[t])&&e[t](n)}function Ade(e){return e=ae(e),e.length===1?e[0]:{type:I$,features:e.reduce((t,n)=>t.concat(Sde(n)),[])}}function Sde(e){return e.type===I$?e.features:ae(e).filter(t=>t!=null).map(t=>t.type===j$?t:{type:j$,geometry:t})}var Cde=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",contour:L$,geojson:B$,geopath:z$,geopoint:U$,geoshape:q$,graticule:H$,heatmap:W$,isocontour:T$,kde2d:P$,projection:i7});function Ode(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function i(){var o,a=n.length,s,u=0,l=0;for(o=0;o<a;++o)s=n[o],u+=s.x,l+=s.y;for(u=(u/a-e)*r,l=(l/a-t)*r,o=0;o<a;++o)s=n[o],s.x-=u,s.y-=l}return i.initialize=function(o){n=o},i.x=function(o){return arguments.length?(e=+o,i):e},i.y=function(o){return arguments.length?(t=+o,i):t},i.strength=function(o){return arguments.length?(r=+o,i):r},i}function Fde(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return a7(this.cover(t,n),t,n,e)}function a7(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,o=e._root,a={data:r},s=e._x0,u=e._y0,l=e._x1,c=e._y1,f,d,h,g,p,m,y,v;if(!o)return e._root=a,e;for(;o.length;)if((p=t>=(f=(s+l)/2))?s=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d,i=o,!(o=o[y=m<<1|p]))return i[y]=a,e;if(h=+e._x.call(null,o.data),g=+e._y.call(null,o.data),t===h&&n===g)return a.next=o,i?i[y]=a:e._root=a,e;do i=i?i[y]=new Array(4):e._root=new Array(4),(p=t>=(f=(s+l)/2))?s=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d;while((y=m<<1|p)==(v=(g>=d)<<1|h>=f));return i[v]=o,i[y]=a,e}function kde(e){var t,n,r=e.length,i,o,a=new Array(r),s=new Array(r),u=1/0,l=1/0,c=-1/0,f=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(o=+this._y.call(null,t))||(a[n]=i,s[n]=o,i<u&&(u=i),i>c&&(c=i),o<l&&(l=o),o>f&&(f=o));if(u>c||l>f)return this;for(this.cover(u,l).cover(c,f),n=0;n<r;++n)a7(this,a[n],s[n],e[n]);return this}function Mde(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,o=(r=Math.floor(t))+1;else{for(var a=i-n||1,s=this._root,u,l;n>e||e>=i||r>t||t>=o;)switch(l=(t<r)<<1|e<n,u=new Array(4),u[l]=s,s=u,a*=2,l){case 0:i=n+a,o=r+a;break;case 1:n=i-a,o=r+a;break;case 2:i=n+a,r=o-a;break;case 3:n=i-a,r=o-a;break}this._root&&this._root.length&&(this._root=s)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this}function Dde(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function Nde(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Sn(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function Tde(e,t,n){var r,i=this._x0,o=this._y0,a,s,u,l,c=this._x1,f=this._y1,d=[],h=this._root,g,p;for(h&&d.push(new Sn(h,i,o,c,f)),n==null?n=1/0:(i=e-n,o=t-n,c=e+n,f=t+n,n*=n);g=d.pop();)if(!(!(h=g.node)||(a=g.x0)>c||(s=g.y0)>f||(u=g.x1)<i||(l=g.y1)<o))if(h.length){var m=(a+u)/2,y=(s+l)/2;d.push(new Sn(h[3],m,y,u,l),new Sn(h[2],a,y,m,l),new Sn(h[1],m,s,u,y),new Sn(h[0],a,s,m,y)),(p=(t>=y)<<1|e>=m)&&(g=d[d.length-1],d[d.length-1]=d[d.length-1-p],d[d.length-1-p]=g)}else{var v=e-+this._x.call(null,h.data),b=t-+this._y.call(null,h.data),x=v*v+b*b;if(x<n){var w=Math.sqrt(n=x);i=e-w,o=t-w,c=e+w,f=t+w,r=h.data}}return r}function Rde(e){if(isNaN(c=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,n=this._root,r,i,o,a=this._x0,s=this._y0,u=this._x1,l=this._y1,c,f,d,h,g,p,m,y;if(!n)return this;if(n.length)for(;;){if((g=c>=(d=(a+u)/2))?a=d:u=d,(p=f>=(h=(s+l)/2))?s=h:l=h,t=n,!(n=n[m=p<<1|g]))return this;if(!n.length)break;(t[m+1&3]||t[m+2&3]||t[m+3&3])&&(r=t,y=m)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(o=n.next)&&delete n.next,i?(o?i.next=o:delete i.next,this):t?(o?t[m]=o:delete t[m],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[y]=n:this._root=n),this):(this._root=o,this)}function Pde(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function Lde(){return this._root}function jde(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function Ide(e){var t=[],n,r=this._root,i,o,a,s,u;for(r&&t.push(new Sn(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,o=n.x0,a=n.y0,s=n.x1,u=n.y1)&&r.length){var l=(o+s)/2,c=(a+u)/2;(i=r[3])&&t.push(new Sn(i,l,c,s,u)),(i=r[2])&&t.push(new Sn(i,o,c,l,u)),(i=r[1])&&t.push(new Sn(i,l,a,s,c)),(i=r[0])&&t.push(new Sn(i,o,a,l,c))}return this}function Bde(e){var t=[],n=[],r;for(this._root&&t.push(new Sn(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var o,a=r.x0,s=r.y0,u=r.x1,l=r.y1,c=(a+u)/2,f=(s+l)/2;(o=i[0])&&t.push(new Sn(o,a,s,c,f)),(o=i[1])&&t.push(new Sn(o,c,s,u,f)),(o=i[2])&&t.push(new Sn(o,a,f,c,l)),(o=i[3])&&t.push(new Sn(o,c,f,u,l))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function zde(e){return e[0]}function Ude(e){return arguments.length?(this._x=e,this):this._x}function qde(e){return e[1]}function Hde(e){return arguments.length?(this._y=e,this):this._y}function G$(e,t,n){var r=new Y$(t==null?zde:t,n==null?qde:n,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function Y$(e,t,n,r,i,o){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function s7(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var Cn=G$.prototype=Y$.prototype;Cn.copy=function(){var e=new Y$(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=s7(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=s7(r));return e};Cn.add=Fde;Cn.addAll=kde;Cn.cover=Mde;Cn.data=Dde;Cn.extent=Nde;Cn.find=Tde;Cn.remove=Rde;Cn.removeAll=Pde;Cn.root=Lde;Cn.size=jde;Cn.visit=Ide;Cn.visitAfter=Bde;Cn.x=Ude;Cn.y=Hde;function On(e){return function(){return e}}function Va(e){return(e()-.5)*1e-6}function Wde(e){return e.x+e.vx}function Gde(e){return e.y+e.vy}function Yde(e){var t,n,r,i=1,o=1;typeof e!="function"&&(e=On(e==null?1:+e));function a(){for(var l,c=t.length,f,d,h,g,p,m,y=0;y<o;++y)for(f=G$(t,Wde,Gde).visitAfter(s),l=0;l<c;++l)d=t[l],p=n[d.index],m=p*p,h=d.x+d.vx,g=d.y+d.vy,f.visit(v);function v(b,x,w,E,_){var S=b.data,C=b.r,O=p+C;if(S){if(S.index>d.index){var $=h-S.x-S.vx,M=g-S.y-S.vy,F=$*$+M*M;F<O*O&&($===0&&($=Va(r),F+=$*$),M===0&&(M=Va(r),F+=M*M),F=(O-(F=Math.sqrt(F)))/F*i,d.vx+=($*=F)*(O=(C*=C)/(m+C)),d.vy+=(M*=F)*O,S.vx-=$*(O=1-O),S.vy-=M*O)}return}return x>h+O||E<h-O||w>g+O||_<g-O}}function s(l){if(l.data)return l.r=n[l.data.index];for(var c=l.r=0;c<4;++c)l[c]&&l[c].r>l.r&&(l.r=l[c].r)}function u(){if(!!t){var l,c=t.length,f;for(n=new Array(c),l=0;l<c;++l)f=t[l],n[f.index]=+e(f,l,t)}}return a.initialize=function(l,c){t=l,r=c,u()},a.iterations=function(l){return arguments.length?(o=+l,a):o},a.strength=function(l){return arguments.length?(i=+l,a):i},a.radius=function(l){return arguments.length?(e=typeof l=="function"?l:On(+l),u(),a):e},a}function Vde(e){return e.index}function u7(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function Xde(e){var t=Vde,n=f,r,i=On(30),o,a,s,u,l,c=1;e==null&&(e=[]);function f(m){return 1/Math.min(s[m.source.index],s[m.target.index])}function d(m){for(var y=0,v=e.length;y<c;++y)for(var b=0,x,w,E,_,S,C,O;b<v;++b)x=e[b],w=x.source,E=x.target,_=E.x+E.vx-w.x-w.vx||Va(l),S=E.y+E.vy-w.y-w.vy||Va(l),C=Math.sqrt(_*_+S*S),C=(C-o[b])/C*m*r[b],_*=C,S*=C,E.vx-=_*(O=u[b]),E.vy-=S*O,w.vx+=_*(O=1-O),w.vy+=S*O}function h(){if(!!a){var m,y=a.length,v=e.length,b=new Map(a.map((w,E)=>[t(w,E,a),w])),x;for(m=0,s=new Array(y);m<v;++m)x=e[m],x.index=m,typeof x.source!="object"&&(x.source=u7(b,x.source)),typeof x.target!="object"&&(x.target=u7(b,x.target)),s[x.source.index]=(s[x.source.index]||0)+1,s[x.target.index]=(s[x.target.index]||0)+1;for(m=0,u=new Array(v);m<v;++m)x=e[m],u[m]=s[x.source.index]/(s[x.source.index]+s[x.target.index]);r=new Array(v),g(),o=new Array(v),p()}}function g(){if(!!a)for(var m=0,y=e.length;m<y;++m)r[m]=+n(e[m],m,e)}function p(){if(!!a)for(var m=0,y=e.length;m<y;++m)o[m]=+i(e[m],m,e)}return d.initialize=function(m,y){a=m,l=y,h()},d.links=function(m){return arguments.length?(e=m,h(),d):e},d.id=function(m){return arguments.length?(t=m,d):t},d.iterations=function(m){return arguments.length?(c=+m,d):c},d.strength=function(m){return arguments.length?(n=typeof m=="function"?m:On(+m),g(),d):n},d.distance=function(m){return arguments.length?(i=typeof m=="function"?m:On(+m),p(),d):i},d}var Kde={value:()=>{}};function l7(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new g1(n)}function g1(e){this._=e}function Zde(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}g1.prototype=l7.prototype={constructor:g1,on:function(e,t){var n=this._,r=Zde(e+"",n),i,o=-1,a=r.length;if(arguments.length<2){for(;++o<a;)if((i=(e=r[o]).type)&&(i=Jde(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<a;)if(i=(e=r[o]).type)n[i]=c7(n[i],e.name,t);else if(t==null)for(i in n)n[i]=c7(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new g1(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],r=0,i=o.length;r<i;++r)o[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};function Jde(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function c7(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=Kde,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var fc=0,ph=0,mh=0,f7=1e3,p1,yh,m1=0,du=0,y1=0,vh=typeof performance=="object"&&performance.now?performance:Date,d7=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function h7(){return du||(d7(Qde),du=vh.now()+y1)}function Qde(){du=0}function V$(){this._call=this._time=this._next=null}V$.prototype=g7.prototype={constructor:V$,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?h7():+n)+(t==null?0:+t),!this._next&&yh!==this&&(yh?yh._next=this:p1=this,yh=this),this._call=e,this._time=n,X$()},stop:function(){this._call&&(this._call=null,this._time=1/0,X$())}};function g7(e,t,n){var r=new V$;return r.restart(e,t,n),r}function ehe(){h7(),++fc;for(var e=p1,t;e;)(t=du-e._time)>=0&&e._call.call(null,t),e=e._next;--fc}function p7(){du=(m1=vh.now())+y1,fc=ph=0;try{ehe()}finally{fc=0,nhe(),du=0}}function the(){var e=vh.now(),t=e-m1;t>f7&&(y1-=t,m1=e)}function nhe(){for(var e,t=p1,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:p1=n);yh=e,X$(r)}function X$(e){if(!fc){ph&&(ph=clearTimeout(ph));var t=e-du;t>24?(e<1/0&&(ph=setTimeout(p7,e-vh.now()-y1)),mh&&(mh=clearInterval(mh))):(mh||(m1=vh.now(),mh=setInterval(the,f7)),fc=1,d7(p7))}}const rhe=1664525,ihe=1013904223,m7=4294967296;function ohe(){let e=1;return()=>(e=(rhe*e+ihe)%m7)/m7}function ahe(e){return e.x}function she(e){return e.y}var uhe=10,lhe=Math.PI*(3-Math.sqrt(5));function che(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,a=.6,s=new Map,u=g7(f),l=l7("tick","end"),c=ohe();e==null&&(e=[]);function f(){d(),l.call("tick",t),n<r&&(u.stop(),l.call("end",t))}function d(p){var m,y=e.length,v;p===void 0&&(p=1);for(var b=0;b<p;++b)for(n+=(o-n)*i,s.forEach(function(x){x(n)}),m=0;m<y;++m)v=e[m],v.fx==null?v.x+=v.vx*=a:(v.x=v.fx,v.vx=0),v.fy==null?v.y+=v.vy*=a:(v.y=v.fy,v.vy=0);return t}function h(){for(var p=0,m=e.length,y;p<m;++p){if(y=e[p],y.index=p,y.fx!=null&&(y.x=y.fx),y.fy!=null&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var v=uhe*Math.sqrt(.5+p),b=p*lhe;y.x=v*Math.cos(b),y.y=v*Math.sin(b)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function g(p){return p.initialize&&p.initialize(e,c),p}return h(),t={tick:d,restart:function(){return u.restart(f),t},stop:function(){return u.stop(),t},nodes:function(p){return arguments.length?(e=p,h(),s.forEach(g),t):e},alpha:function(p){return arguments.length?(n=+p,t):n},alphaMin:function(p){return arguments.length?(r=+p,t):r},alphaDecay:function(p){return arguments.length?(i=+p,t):+i},alphaTarget:function(p){return arguments.length?(o=+p,t):o},velocityDecay:function(p){return arguments.length?(a=1-p,t):1-a},randomSource:function(p){return arguments.length?(c=p,s.forEach(g),t):c},force:function(p,m){return arguments.length>1?(m==null?s.delete(p):s.set(p,g(m)),t):s.get(p)},find:function(p,m,y){var v=0,b=e.length,x,w,E,_,S;for(y==null?y=1/0:y*=y,v=0;v<b;++v)_=e[v],x=p-_.x,w=m-_.y,E=x*x+w*w,E<y&&(S=_,y=E);return S},on:function(p,m){return arguments.length>1?(l.on(p,m),t):l.on(p)}}}function fhe(){var e,t,n,r,i=On(-30),o,a=1,s=1/0,u=.81;function l(h){var g,p=e.length,m=G$(e,ahe,she).visitAfter(f);for(r=h,g=0;g<p;++g)t=e[g],m.visit(d)}function c(){if(!!e){var h,g=e.length,p;for(o=new Array(g),h=0;h<g;++h)p=e[h],o[p.index]=+i(p,h,e)}}function f(h){var g=0,p,m,y=0,v,b,x;if(h.length){for(v=b=x=0;x<4;++x)(p=h[x])&&(m=Math.abs(p.value))&&(g+=p.value,y+=m,v+=m*p.x,b+=m*p.y);h.x=v/y,h.y=b/y}else{p=h,p.x=p.data.x,p.y=p.data.y;do g+=o[p.data.index];while(p=p.next)}h.value=g}function d(h,g,p,m){if(!h.value)return!0;var y=h.x-t.x,v=h.y-t.y,b=m-g,x=y*y+v*v;if(b*b/u<x)return x<s&&(y===0&&(y=Va(n),x+=y*y),v===0&&(v=Va(n),x+=v*v),x<a&&(x=Math.sqrt(a*x)),t.vx+=y*h.value*r/x,t.vy+=v*h.value*r/x),!0;if(h.length||x>=s)return;(h.data!==t||h.next)&&(y===0&&(y=Va(n),x+=y*y),v===0&&(v=Va(n),x+=v*v),x<a&&(x=Math.sqrt(a*x)));do h.data!==t&&(b=o[h.data.index]*r/x,t.vx+=y*b,t.vy+=v*b);while(h=h.next)}return l.initialize=function(h,g){e=h,n=g,c()},l.strength=function(h){return arguments.length?(i=typeof h=="function"?h:On(+h),c(),l):i},l.distanceMin=function(h){return arguments.length?(a=h*h,l):Math.sqrt(a)},l.distanceMax=function(h){return arguments.length?(s=h*h,l):Math.sqrt(s)},l.theta=function(h){return arguments.length?(u=h*h,l):Math.sqrt(u)},l}function dhe(e){var t=On(.1),n,r,i;typeof e!="function"&&(e=On(e==null?0:+e));function o(s){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vx+=(i[u]-c.x)*r[u]*s}function a(){if(!!n){var s,u=n.length;for(r=new Array(u),i=new Array(u),s=0;s<u;++s)r[s]=isNaN(i[s]=+e(n[s],s,n))?0:+t(n[s],s,n)}}return o.initialize=function(s){n=s,a()},o.strength=function(s){return arguments.length?(t=typeof s=="function"?s:On(+s),a(),o):t},o.x=function(s){return arguments.length?(e=typeof s=="function"?s:On(+s),a(),o):e},o}function hhe(e){var t=On(.1),n,r,i;typeof e!="function"&&(e=On(e==null?0:+e));function o(s){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vy+=(i[u]-c.y)*r[u]*s}function a(){if(!!n){var s,u=n.length;for(r=new Array(u),i=new Array(u),s=0;s<u;++s)r[s]=isNaN(i[s]=+e(n[s],s,n))?0:+t(n[s],s,n)}}return o.initialize=function(s){n=s,a()},o.strength=function(s){return arguments.length?(t=typeof s=="function"?s:On(+s),a(),o):t},o.y=function(s){return arguments.length?(e=typeof s=="function"?s:On(+s),a(),o):e},o}const y7={center:Ode,collide:Yde,nbody:fhe,link:Xde,x:dhe,y:hhe},bh="forces",K$=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],ghe=["static","iterations"],v7=["x","y","vx","vy"];function Z$(e){R.call(this,null,e)}Z$.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:v7}]};H(Z$,R,{transform(e,t){var n=this.value,r=t.changed(t.ADD_REM),i=e.modified(K$),o=e.iterations||300;if(n?(r&&(t.modifies("index"),n.nodes(t.source)),(i||t.changed(t.MOD))&&b7(n,e,0,t)):(this.value=n=mhe(t.source,e),n.on("tick",phe(t.dataflow,this)),e.static||(r=!0,n.tick()),t.modifies("index")),i||r||e.modified(ghe)||t.changed()&&e.restart){if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/o)),e.static)for(n.stop();--o>=0;)n.tick();else if(n.stopped()&&n.restart(),!r)return t.StopPropagation}return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let s=this._argops,u=0,l=s.length,c;u<l;++u)if(c=s[u],!(c.name!==bh||c.op._argval.force!=="link")){for(var r=c.op._argops,i=0,o=r.length,a;i<o;++i)if(r[i].name==="links"&&(a=r[i].op.source)){n.pulse(a,n.changeset().reflow());break}}return t.reflow(e.modified()).modifies(v7)}});function phe(e,t){return()=>e.touch(t).run()}function mhe(e,t){const n=che(e),r=n.stop,i=n.restart;let o=!1;return n.stopped=()=>o,n.restart=()=>(o=!1,i()),n.stop=()=>(o=!0,r()),b7(n,t,!0).on("end",()=>o=!0)}function b7(e,t,n,r){var i=ae(t.forces),o,a,s,u;for(o=0,a=K$.length;o<a;++o)s=K$[o],s!==bh&&t.modified(s)&&e[s](t[s]);for(o=0,a=i.length;o<a;++o)u=bh+o,s=n||t.modified(bh,o)?vhe(i[o]):r&&yhe(i[o],r)?e.force(u):null,s&&e.force(u,s);for(a=e.numForces||0;o<a;++o)e.force(bh+o,null);return e.numForces=i.length,e}function yhe(e,t){var n,r;for(n in e)if(ye(r=e[n])&&t.modified(tn(r)))return 1;return 0}function vhe(e){var t,n;se(y7,e.force)||B("Unrecognized force: "+e.force),t=y7[e.force]();for(n in e)ye(t[n])&&bhe(t[n],e[n],e);return t}function bhe(e,t,n){e(ye(t)?r=>t(r,n):t)}var xhe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",force:Z$});function whe(e,t){return e.parent===t.parent?1:2}function _he(e){return e.reduce(Ehe,0)/e.length}function Ehe(e,t){return e+t.x}function $he(e){return 1+e.reduce(Ahe,0)}function Ahe(e,t){return Math.max(e,t.y)}function She(e){for(var t;t=e.children;)e=t[0];return e}function Che(e){for(var t;t=e.children;)e=t[t.length-1];return e}function Ohe(){var e=whe,t=1,n=1,r=!1;function i(o){var a,s=0;o.eachAfter(function(d){var h=d.children;h?(d.x=_he(h),d.y=$he(h)):(d.x=a?s+=e(d,a):0,d.y=0,a=d)});var u=She(o),l=Che(o),c=u.x-e(u,l)/2,f=l.x+e(l,u)/2;return o.eachAfter(r?function(d){d.x=(d.x-o.x)*t,d.y=(o.y-d.y)*n}:function(d){d.x=(d.x-c)/(f-c)*t,d.y=(1-(o.y?d.y/o.y:1))*n})}return i.separation=function(o){return arguments.length?(e=o,i):e},i.size=function(o){return arguments.length?(r=!1,t=+o[0],n=+o[1],i):r?null:[t,n]},i.nodeSize=function(o){return arguments.length?(r=!0,t=+o[0],n=+o[1],i):r?[t,n]:null},i}function Fhe(e){var t=0,n=e.children,r=n&&n.length;if(!r)t=1;else for(;--r>=0;)t+=n[r].value;e.value=t}function khe(){return this.eachAfter(Fhe)}function Mhe(e,t){let n=-1;for(const r of this)e.call(t,r,++n,this);return this}function Dhe(e,t){for(var n=this,r=[n],i,o,a=-1;n=r.pop();)if(e.call(t,n,++a,this),i=n.children)for(o=i.length-1;o>=0;--o)r.push(i[o]);return this}function Nhe(e,t){for(var n=this,r=[n],i=[],o,a,s,u=-1;n=r.pop();)if(i.push(n),o=n.children)for(a=0,s=o.length;a<s;++a)r.push(o[a]);for(;n=i.pop();)e.call(t,n,++u,this);return this}function The(e,t){let n=-1;for(const r of this)if(e.call(t,r,++n,this))return r}function Rhe(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n})}function Phe(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function Lhe(e){for(var t=this,n=jhe(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r}function jhe(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;for(e=n.pop(),t=r.pop();e===t;)i=e,e=n.pop(),t=r.pop();return i}function Ihe(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function Bhe(){return Array.from(this)}function zhe(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function Uhe(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*qhe(){var e=this,t,n=[e],r,i,o;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,r=e.children)for(i=0,o=r.length;i<o;++i)n.push(r[i]);while(n.length)}function J$(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=Ghe)):t===void 0&&(t=Whe);for(var n=new dc(e),r,i=[n],o,a,s,u;r=i.pop();)if((a=t(r.data))&&(u=(a=Array.from(a)).length))for(r.children=a,s=u-1;s>=0;--s)i.push(o=a[s]=new dc(a[s])),o.parent=r,o.depth=r.depth+1;return n.eachBefore(x7)}function Hhe(){return J$(this).eachBefore(Yhe)}function Whe(e){return e.children}function Ghe(e){return Array.isArray(e)?e[1]:null}function Yhe(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function x7(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function dc(e){this.data=e,this.depth=this.height=0,this.parent=null}dc.prototype=J$.prototype={constructor:dc,count:khe,each:Mhe,eachAfter:Nhe,eachBefore:Dhe,find:The,sum:Rhe,sort:Phe,path:Lhe,ancestors:Ihe,descendants:Bhe,leaves:zhe,links:Uhe,copy:Hhe,[Symbol.iterator]:qhe};function Vhe(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Xhe(e){for(var t=e.length,n,r;t;)r=Math.random()*t--|0,n=e[t],e[t]=e[r],e[r]=n;return e}function Khe(e){for(var t=0,n=(e=Xhe(Array.from(e))).length,r=[],i,o;t<n;)i=e[t],o&&w7(o,i)?++t:(o=Jhe(r=Zhe(r,i)),t=0);return o}function Zhe(e,t){var n,r;if(Q$(t,e))return[t];for(n=0;n<e.length;++n)if(v1(t,e[n])&&Q$(xh(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(v1(xh(e[n],e[r]),t)&&v1(xh(e[n],t),e[r])&&v1(xh(e[r],t),e[n])&&Q$(_7(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function v1(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function w7(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function Q$(e,t){for(var n=0;n<t.length;++n)if(!w7(e,t[n]))return!1;return!0}function Jhe(e){switch(e.length){case 1:return Qhe(e[0]);case 2:return xh(e[0],e[1]);case 3:return _7(e[0],e[1],e[2])}}function Qhe(e){return{x:e.x,y:e.y,r:e.r}}function xh(e,t){var n=e.x,r=e.y,i=e.r,o=t.x,a=t.y,s=t.r,u=o-n,l=a-r,c=s-i,f=Math.sqrt(u*u+l*l);return{x:(n+o+u/f*c)/2,y:(r+a+l/f*c)/2,r:(f+i+s)/2}}function _7(e,t,n){var r=e.x,i=e.y,o=e.r,a=t.x,s=t.y,u=t.r,l=n.x,c=n.y,f=n.r,d=r-a,h=r-l,g=i-s,p=i-c,m=u-o,y=f-o,v=r*r+i*i-o*o,b=v-a*a-s*s+u*u,x=v-l*l-c*c+f*f,w=h*g-d*p,E=(g*x-p*b)/(w*2)-r,_=(p*m-g*y)/w,S=(h*b-d*x)/(w*2)-i,C=(d*y-h*m)/w,O=_*_+C*C-1,$=2*(o+E*_+S*C),M=E*E+S*S-o*o,F=-(O?($+Math.sqrt($*$-4*O*M))/(2*O):M/$);return{x:r+E+_*F,y:i+S+C*F,r:F}}function E7(e,t,n){var r=e.x-t.x,i,o,a=e.y-t.y,s,u,l=r*r+a*a;l?(o=t.r+n.r,o*=o,u=e.r+n.r,u*=u,o>u?(i=(l+u-o)/(2*l),s=Math.sqrt(Math.max(0,u/l-i*i)),n.x=e.x-i*r-s*a,n.y=e.y-i*a+s*r):(i=(l+o-u)/(2*l),s=Math.sqrt(Math.max(0,o/l-i*i)),n.x=t.x+i*r-s*a,n.y=t.y+i*a+s*r)):(n.x=t.x+n.r,n.y=t.y)}function $7(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function A7(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,o=(t.y*n.r+n.y*t.r)/r;return i*i+o*o}function b1(e){this._=e,this.next=null,this.previous=null}function e0e(e){if(!(i=(e=Vhe(e)).length))return 0;var t,n,r,i,o,a,s,u,l,c,f;if(t=e[0],t.x=0,t.y=0,!(i>1))return t.r;if(n=e[1],t.x=-n.r,n.x=t.r,n.y=0,!(i>2))return t.r+n.r;E7(n,t,r=e[2]),t=new b1(t),n=new b1(n),r=new b1(r),t.next=r.previous=n,n.next=t.previous=r,r.next=n.previous=t;e:for(s=3;s<i;++s){E7(t._,n._,r=e[s]),r=new b1(r),u=n.next,l=t.previous,c=n._.r,f=t._.r;do if(c<=f){if($7(u._,r._)){n=u,t.next=n,n.previous=t,--s;continue e}c+=u._.r,u=u.next}else{if($7(l._,r._)){t=l,t.next=n,n.previous=t,--s;continue e}f+=l._.r,l=l.previous}while(u!==l.next);for(r.previous=t,r.next=n,t.next=n.previous=n=r,o=A7(t);(r=r.next)!==n;)(a=A7(r))<o&&(t=r,o=a);n=t.next}for(t=[n._],r=n;(r=r.next)!==n;)t.push(r._);for(r=Khe(t),s=0;s<i;++s)t=e[s],t.x-=r.x,t.y-=r.y;return r.r}function t0e(e){return e==null?null:x1(e)}function x1(e){if(typeof e!="function")throw new Error;return e}function hu(){return 0}function hc(e){return function(){return e}}function n0e(e){return Math.sqrt(e.value)}function r0e(){var e=null,t=1,n=1,r=hu;function i(o){return o.x=t/2,o.y=n/2,e?o.eachBefore(S7(e)).eachAfter(eA(r,.5)).eachBefore(C7(1)):o.eachBefore(S7(n0e)).eachAfter(eA(hu,1)).eachAfter(eA(r,o.r/Math.min(t,n))).eachBefore(C7(Math.min(t,n)/(2*o.r))),o}return i.radius=function(o){return arguments.length?(e=t0e(o),i):e},i.size=function(o){return arguments.length?(t=+o[0],n=+o[1],i):[t,n]},i.padding=function(o){return arguments.length?(r=typeof o=="function"?o:hc(+o),i):r},i}function S7(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function eA(e,t){return function(n){if(r=n.children){var r,i,o=r.length,a=e(n)*t||0,s;if(a)for(i=0;i<o;++i)r[i].r+=a;if(s=e0e(r),a)for(i=0;i<o;++i)r[i].r-=a;n.r=s+a}}}function C7(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function O7(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function wh(e,t,n,r,i){for(var o=e.children,a,s=-1,u=o.length,l=e.value&&(r-t)/e.value;++s<u;)a=o[s],a.y0=n,a.y1=i,a.x0=t,a.x1=t+=a.value*l}function i0e(){var e=1,t=1,n=0,r=!1;function i(a){var s=a.height+1;return a.x0=a.y0=n,a.x1=e,a.y1=t/s,a.eachBefore(o(t,s)),r&&a.eachBefore(O7),a}function o(a,s){return function(u){u.children&&wh(u,u.x0,a*(u.depth+1)/s,u.x1,a*(u.depth+2)/s);var l=u.x0,c=u.y0,f=u.x1-n,d=u.y1-n;f<l&&(l=f=(l+f)/2),d<c&&(c=d=(c+d)/2),u.x0=l,u.y0=c,u.x1=f,u.y1=d}}return i.round=function(a){return arguments.length?(r=!!a,i):r},i.size=function(a){return arguments.length?(e=+a[0],t=+a[1],i):[e,t]},i.padding=function(a){return arguments.length?(n=+a,i):n},i}var o0e={depth:-1},F7={};function a0e(e){return e.id}function s0e(e){return e.parentId}function k7(){var e=a0e,t=s0e;function n(r){var i=Array.from(r),o=i.length,a,s,u,l,c,f,d,h=new Map;for(s=0;s<o;++s)a=i[s],c=i[s]=new dc(a),(f=e(a,s,r))!=null&&(f+="")&&(d=c.id=f,h.set(d,h.has(d)?F7:c)),(f=t(a,s,r))!=null&&(f+="")&&(c.parent=f);for(s=0;s<o;++s)if(c=i[s],f=c.parent){if(l=h.get(f),!l)throw new Error("missing: "+f);if(l===F7)throw new Error("ambiguous: "+f);l.children?l.children.push(c):l.children=[c],c.parent=l}else{if(u)throw new Error("multiple roots");u=c}if(!u)throw new Error("no root");if(u.parent=o0e,u.eachBefore(function(g){g.depth=g.parent.depth+1,--o}).eachBefore(x7),u.parent=null,o>0)throw new Error("cycle");return u}return n.id=function(r){return arguments.length?(e=x1(r),n):e},n.parentId=function(r){return arguments.length?(t=x1(r),n):t},n}function u0e(e,t){return e.parent===t.parent?1:2}function tA(e){var t=e.children;return t?t[0]:e.t}function nA(e){var t=e.children;return t?t[t.length-1]:e.t}function l0e(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function c0e(e){for(var t=0,n=0,r=e.children,i=r.length,o;--i>=0;)o=r[i],o.z+=t,o.m+=t,t+=o.s+(n+=o.c)}function f0e(e,t,n){return e.a.parent===t.parent?e.a:n}function w1(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}w1.prototype=Object.create(dc.prototype);function d0e(e){for(var t=new w1(e,0),n,r=[t],i,o,a,s;n=r.pop();)if(o=n._.children)for(n.children=new Array(s=o.length),a=s-1;a>=0;--a)r.push(i=n.children[a]=new w1(o[a],a)),i.parent=n;return(t.parent=new w1(null,0)).children=[t],t}function h0e(){var e=u0e,t=1,n=1,r=null;function i(l){var c=d0e(l);if(c.eachAfter(o),c.parent.m=-c.z,c.eachBefore(a),r)l.eachBefore(u);else{var f=l,d=l,h=l;l.eachBefore(function(v){v.x<f.x&&(f=v),v.x>d.x&&(d=v),v.depth>h.depth&&(h=v)});var g=f===d?1:e(f,d)/2,p=g-f.x,m=t/(d.x+g+p),y=n/(h.depth||1);l.eachBefore(function(v){v.x=(v.x+p)*m,v.y=v.depth*y})}return l}function o(l){var c=l.children,f=l.parent.children,d=l.i?f[l.i-1]:null;if(c){c0e(l);var h=(c[0].z+c[c.length-1].z)/2;d?(l.z=d.z+e(l._,d._),l.m=l.z-h):l.z=h}else d&&(l.z=d.z+e(l._,d._));l.parent.A=s(l,d,l.parent.A||f[0])}function a(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function s(l,c,f){if(c){for(var d=l,h=l,g=c,p=d.parent.children[0],m=d.m,y=h.m,v=g.m,b=p.m,x;g=nA(g),d=tA(d),g&&d;)p=tA(p),h=nA(h),h.a=l,x=g.z+v-d.z-m+e(g._,d._),x>0&&(l0e(f0e(g,l,f),l,x),m+=x,y+=x),v+=g.m,m+=d.m,b+=p.m,y+=h.m;g&&!nA(h)&&(h.t=g,h.m+=v-y),d&&!tA(p)&&(p.t=d,p.m+=m-b,f=l)}return f}function u(l){l.x*=t,l.y=l.depth*n}return i.separation=function(l){return arguments.length?(e=l,i):e},i.size=function(l){return arguments.length?(r=!1,t=+l[0],n=+l[1],i):r?null:[t,n]},i.nodeSize=function(l){return arguments.length?(r=!0,t=+l[0],n=+l[1],i):r?[t,n]:null},i}function _1(e,t,n,r,i){for(var o=e.children,a,s=-1,u=o.length,l=e.value&&(i-n)/e.value;++s<u;)a=o[s],a.x0=t,a.x1=r,a.y0=n,a.y1=n+=a.value*l}var M7=(1+Math.sqrt(5))/2;function D7(e,t,n,r,i,o){for(var a=[],s=t.children,u,l,c=0,f=0,d=s.length,h,g,p=t.value,m,y,v,b,x,w,E;c<d;){h=i-n,g=o-r;do m=s[f++].value;while(!m&&f<d);for(y=v=m,w=Math.max(g/h,h/g)/(p*e),E=m*m*w,x=Math.max(v/E,E/y);f<d;++f){if(m+=l=s[f].value,l<y&&(y=l),l>v&&(v=l),E=m*m*w,b=Math.max(v/E,E/y),b>x){m-=l;break}x=b}a.push(u={value:m,dice:h<g,children:s.slice(c,f)}),u.dice?wh(u,n,r,i,p?r+=g*m/p:o):_1(u,n,r,p?n+=h*m/p:i,o),p-=m,c=f}return a}var N7=function e(t){function n(r,i,o,a,s){D7(t,r,i,o,a,s)}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(M7);function g0e(){var e=N7,t=!1,n=1,r=1,i=[0],o=hu,a=hu,s=hu,u=hu,l=hu;function c(d){return d.x0=d.y0=0,d.x1=n,d.y1=r,d.eachBefore(f),i=[0],t&&d.eachBefore(O7),d}function f(d){var h=i[d.depth],g=d.x0+h,p=d.y0+h,m=d.x1-h,y=d.y1-h;m<g&&(g=m=(g+m)/2),y<p&&(p=y=(p+y)/2),d.x0=g,d.y0=p,d.x1=m,d.y1=y,d.children&&(h=i[d.depth+1]=o(d)/2,g+=l(d)-h,p+=a(d)-h,m-=s(d)-h,y-=u(d)-h,m<g&&(g=m=(g+m)/2),y<p&&(p=y=(p+y)/2),e(d,g,p,m,y))}return c.round=function(d){return arguments.length?(t=!!d,c):t},c.size=function(d){return arguments.length?(n=+d[0],r=+d[1],c):[n,r]},c.tile=function(d){return arguments.length?(e=x1(d),c):e},c.padding=function(d){return arguments.length?c.paddingInner(d).paddingOuter(d):c.paddingInner()},c.paddingInner=function(d){return arguments.length?(o=typeof d=="function"?d:hc(+d),c):o},c.paddingOuter=function(d){return arguments.length?c.paddingTop(d).paddingRight(d).paddingBottom(d).paddingLeft(d):c.paddingTop()},c.paddingTop=function(d){return arguments.length?(a=typeof d=="function"?d:hc(+d),c):a},c.paddingRight=function(d){return arguments.length?(s=typeof d=="function"?d:hc(+d),c):s},c.paddingBottom=function(d){return arguments.length?(u=typeof d=="function"?d:hc(+d),c):u},c.paddingLeft=function(d){return arguments.length?(l=typeof d=="function"?d:hc(+d),c):l},c}function p0e(e,t,n,r,i){var o=e.children,a,s=o.length,u,l=new Array(s+1);for(l[0]=u=a=0;a<s;++a)l[a+1]=u+=o[a].value;c(0,s,e.value,t,n,r,i);function c(f,d,h,g,p,m,y){if(f>=d-1){var v=o[f];v.x0=g,v.y0=p,v.x1=m,v.y1=y;return}for(var b=l[f],x=h/2+b,w=f+1,E=d-1;w<E;){var _=w+E>>>1;l[_]<x?w=_+1:E=_}x-l[w-1]<l[w]-x&&f+1<w&&--w;var S=l[w]-b,C=h-S;if(m-g>y-p){var O=h?(g*C+m*S)/h:m;c(f,w,S,g,p,O,y),c(w,d,C,O,p,m,y)}else{var $=h?(p*C+y*S)/h:y;c(f,w,S,g,p,m,$),c(w,d,C,g,$,m,y)}}}function m0e(e,t,n,r,i){(e.depth&1?_1:wh)(e,t,n,r,i)}var y0e=function e(t){function n(r,i,o,a,s){if((u=r._squarify)&&u.ratio===t)for(var u,l,c,f,d=-1,h,g=u.length,p=r.value;++d<g;){for(l=u[d],c=l.children,f=l.value=0,h=c.length;f<h;++f)l.value+=c[f].value;l.dice?wh(l,i,o,a,p?o+=(s-o)*l.value/p:s):_1(l,i,o,p?i+=(a-i)*l.value/p:a,s),p-=l.value}else r._squarify=u=D7(t,r,i,o,a,s),u.ratio=t}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(M7);function rA(e,t,n){const r={};return e.each(i=>{const o=i.data;n(o)&&(r[t(o)]=i)}),e.lookup=r,e}function iA(e){R.call(this,null,e)}iA.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const v0e=e=>e.values;H(iA,R,{transform(e,t){t.source||B("Nest transform requires an upstream data source.");var n=e.generate,r=e.modified(),i=t.clone(),o=this.value;return(!o||r||t.changed())&&(o&&o.each(a=>{a.children&&ap(a.data)&&i.rem.push(a.data)}),this.value=o=J$({values:ae(e.keys).reduce((a,s)=>(a.key(s),a),b0e()).entries(i.source)},v0e),n&&o.each(a=>{a.children&&(a=Ie(a.data),i.add.push(a),i.source.push(a))}),rA(o,te,te)),i.source.root=o,i}});function b0e(){const e=[],t={entries:i=>r(n(i,0),0),key:i=>(e.push(i),t)};function n(i,o){if(o>=e.length)return i;const a=i.length,s=e[o++],u={},l={};let c=-1,f,d,h;for(;++c<a;)f=s(d=i[c])+"",(h=u[f])?h.push(d):u[f]=[d];for(f in u)l[f]=n(u[f],o);return l}function r(i,o){if(++o>e.length)return i;const a=[];for(const s in i)a.push({key:s,values:r(i[s],o)});return a}return t}function Vo(e){R.call(this,null,e)}const x0e=(e,t)=>e.parent===t.parent?1:2;H(Vo,R,{transform(e,t){(!t.source||!t.source.root)&&B(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),r=this.fields,i=t.source.root,o=e.as||r;e.field?i.sum(e.field):i.count(),e.sort&&i.sort(zs(e.sort,a=>a.data)),w0e(n,this.params,e),n.separation&&n.separation(e.separation!==!1?x0e:bl);try{this.value=n(i)}catch(a){B(a)}return i.each(a=>_0e(a,r,o)),t.reflow(e.modified()).modifies(o).modifies("leaf")}});function w0e(e,t,n){for(let r,i=0,o=t.length;i<o;++i)r=t[i],r in n&&e[r](n[r])}function _0e(e,t,n){const r=e.data,i=t.length-1;for(let o=0;o<i;++o)r[n[o]]=e[t[o]];r[n[i]]=e.children?e.children.length:0}const oA=["x","y","r","depth","children"];function aA(e){Vo.call(this,e)}aA.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:oA.length,default:oA}]};H(aA,Vo,{layout:r0e,params:["radius","size","padding"],fields:oA});const sA=["x0","y0","x1","y1","depth","children"];function uA(e){Vo.call(this,e)}uA.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:sA.length,default:sA}]};H(uA,Vo,{layout:i0e,params:["size","round","padding"],fields:sA});function lA(e){R.call(this,null,e)}lA.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]};H(lA,R,{transform(e,t){t.source||B("Stratify transform requires an upstream data source.");let n=this.value;const r=e.modified(),i=t.fork(t.ALL).materialize(t.SOURCE),o=!n||r||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return i.source=i.source.slice(),o&&(n=i.source.length?rA(k7().id(e.key).parentId(e.parentKey)(i.source),e.key,Dr):rA(k7()([{}]),e.key,e.key)),i.source.root=this.value=n,i}});const T7={tidy:h0e,cluster:Ohe},cA=["x","y","depth","children"];function fA(e){Vo.call(this,e)}fA.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:cA.length,default:cA}]};H(fA,Vo,{layout(e){const t=e||"tidy";if(se(T7,t))return T7[t]();B("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:cA});function dA(e){R.call(this,[],e)}dA.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]};H(dA,R,{transform(e,t){const n=this.value,r=t.source&&t.source.root,i=t.fork(t.NO_SOURCE),o={};return r||B("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(i.rem=n,t.visit(t.SOURCE,a=>o[te(a)]=1),r.each(a=>{const s=a.data,u=a.parent&&a.parent.data;u&&o[te(s)]&&o[te(u)]&&i.add.push(Ie({source:u,target:s}))}),this.value=i.add):t.changed(t.MOD)&&(t.visit(t.MOD,a=>o[te(a)]=1),n.forEach(a=>{(o[te(a.source)]||o[te(a.target)])&&i.mod.push(a)})),i}});const R7={binary:p0e,dice:wh,slice:_1,slicedice:m0e,squarify:N7,resquarify:y0e},hA=["x0","y0","x1","y1","depth","children"];function gA(e){Vo.call(this,e)}gA.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:hA.length,default:hA}]};H(gA,Vo,{layout(){const e=g0e();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{se(R7,t)?e.tile(R7[t]):B("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:hA});var E0e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",nest:iA,pack:aA,partition:uA,stratify:lA,tree:fA,treelinks:dA,treemap:gA});const $0e=4278190080,A0e=268435456,S0e=.0625;function C0e(e,t){const n=e.bitmap();return(t||[]).forEach(r=>n.set(e(r.boundary[0]),e(r.boundary[3]))),[n,void 0]}function O0e(e,t,n,r){const i=e.width,o=e.height,a=n||r,s=Nl(i,o).getContext("2d");t.forEach(m=>P7(s,m,a));const u=new Uint32Array(s.getImageData(0,0,i,o).data.buffer),l=e.bitmap(),c=a&&e.bitmap();let f,d,h,g,p;for(d=0;d<o;++d)for(f=0;f<i;++f)p=u[d*i+f]&$0e,p&&(h=e(f),g=e(d),r||l.set(h,g),a&&p^A0e&&c.set(h,g));return[l,c]}function P7(e,t,n){if(!t.length)return;const r=t[0].mark.marktype;r==="group"?t.forEach(i=>{i.items.forEach(o=>P7(e,o.items,n))}):yr[r].draw(e,{items:n?t.map(F0e):t})}function F0e(e){const t=sp(e,{});return t.stroke&&(t.strokeOpacity=1),t.fill&&(t.fillOpacity=S0e,t.stroke="#000",t.strokeOpacity=1,t.strokeWidth=2),t}const Xo=5,Fn=31,_h=32,Xa=new Uint32Array(_h+1),pi=new Uint32Array(_h+1);pi[0]=0;Xa[0]=~pi[0];for(let e=1;e<=_h;++e)pi[e]=pi[e-1]<<1|1,Xa[e]=~pi[e];function k0e(e,t){const n=new Uint32Array(~~((e*t+_h)/_h));function r(o,a){n[o]|=a}function i(o,a){n[o]&=a}return{array:n,get:(o,a)=>{const s=a*e+o;return n[s>>>Xo]&1<<(s&Fn)},set:(o,a)=>{const s=a*e+o;r(s>>>Xo,1<<(s&Fn))},clear:(o,a)=>{const s=a*e+o;i(s>>>Xo,~(1<<(s&Fn)))},getRange:(o,a,s,u)=>{let l=u,c,f,d,h;for(;l>=a;--l)if(c=l*e+o,f=l*e+s,d=c>>>Xo,h=f>>>Xo,d===h){if(n[d]&Xa[c&Fn]&pi[(f&Fn)+1])return!0}else{if(n[d]&Xa[c&Fn]||n[h]&pi[(f&Fn)+1])return!0;for(let g=d+1;g<h;++g)if(n[g])return!0}return!1},setRange:(o,a,s,u)=>{let l,c,f,d,h;for(;a<=u;++a)if(l=a*e+o,c=a*e+s,f=l>>>Xo,d=c>>>Xo,f===d)r(f,Xa[l&Fn]&pi[(c&Fn)+1]);else for(r(f,Xa[l&Fn]),r(d,pi[(c&Fn)+1]),h=f+1;h<d;++h)r(h,4294967295)},clearRange:(o,a,s,u)=>{let l,c,f,d,h;for(;a<=u;++a)if(l=a*e+o,c=a*e+s,f=l>>>Xo,d=c>>>Xo,f===d)i(f,pi[l&Fn]|Xa[(c&Fn)+1]);else for(i(f,pi[l&Fn]),i(d,Xa[(c&Fn)+1]),h=f+1;h<d;++h)i(h,0)},outOfBounds:(o,a,s,u)=>o<0||a<0||u>=t||s>=e}}function M0e(e,t,n){const r=Math.max(1,Math.sqrt(e*t/1e6)),i=~~((e+2*n+r)/r),o=~~((t+2*n+r)/r),a=s=>~~((s+n)/r);return a.invert=s=>s*r-n,a.bitmap=()=>k0e(i,o),a.ratio=r,a.padding=n,a.width=e,a.height=t,a}function D0e(e,t,n,r){const i=e.width,o=e.height;return function(a){const s=a.datum.datum.items[r].items,u=s.length,l=a.datum.fontSize,c=Xi.width(a.datum,a.datum.text);let f=0,d,h,g,p,m,y,v;for(let b=0;b<u;++b)d=s[b].x,g=s[b].y,h=s[b].x2===void 0?d:s[b].x2,p=s[b].y2===void 0?g:s[b].y2,m=(d+h)/2,y=(g+p)/2,v=Math.abs(h-d+p-g),v>=f&&(f=v,a.x=m,a.y=y);return m=c/2,y=l/2,d=a.x-m,h=a.x+m,g=a.y-y,p=a.y+y,a.align="center",d<0&&h<=i?a.align="left":0<=d&&i<h&&(a.align="right"),a.baseline="middle",g<0&&p<=o?a.baseline="top":0<=g&&o<p&&(a.baseline="bottom"),!0}}function N0e(e,t,n,r,i,o){let a=n/2;return e-a<0||e+a>i||t-(a=r/2)<0||t+a>o}function T0e(){return!1}function R0e(e,t,n,r,i,o,a,s){const u=i*o/(r*2),l=e(t-u),c=e(t+u),f=e(n-(o=o/2)),d=e(n+o);return a.outOfBounds(l,f,c,d)||a.getRange(l,f,c,d)||s&&s.getRange(l,f,c,d)}function P0e(e,t,n,r,i,o,a,s){const u=i*o/(r*2);let l=e(t-u),c=e(t+u),f=e(n-(o=o/2)),d=e(n+o);return l=l>0?l:0,f=f>0?f:0,c=c<e.width?c:e.width-1,d=d<e.height?d:e.height-1,a.getRange(l,f,c,d)||s&&s.getRange(l,f,c,d)}function L7(e){return e?[P0e,T0e]:[R0e,N0e]}function L0e(e,t,n,r,i){const o=e.width,a=e.height,[s,u]=L7(i),l=t[0],c=t[1];function f(d,h,g,p,m){const y=e.invert(d),v=e.invert(h);let b=g,x=a,w;if(!u(y,v,p,m,o,a)&&!s(e,y,v,m,p,b,l,c)&&!s(e,y,v,m,p,m,l,null)){for(;x-b>=1;)w=(b+x)/2,s(e,y,v,m,p,w,l,c)?x=w:b=w;if(b>g)return[y,v,b,!0]}}return function(d){const h=d.datum.datum.items[r].items,g=h.length,p=d.datum.fontSize,m=Xi.width(d.datum,d.datum.text);let y=n?p:0,v=!1,b=!1,x=0,w,E,_,S,C,O,$,M,F,N,A,k,T,L,z,Q,oe;for(let ue=0;ue<g;++ue){for(w=h[ue].x,_=h[ue].y,E=h[ue].x2===void 0?w:h[ue].x2,S=h[ue].y2===void 0?_:h[ue].y2,w>E&&(oe=w,w=E,E=oe),_>S&&(oe=_,_=S,S=oe),F=e(w),A=e(E),N=~~((F+A)/2),k=e(_),L=e(S),T=~~((k+L)/2),$=N;$>=F;--$)for(M=T;M>=k;--M)Q=f($,M,y,m,p),Q&&([d.x,d.y,y,v]=Q);for($=N;$<=A;++$)for(M=T;M<=L;++M)Q=f($,M,y,m,p),Q&&([d.x,d.y,y,v]=Q);!v&&!n&&(z=Math.abs(E-w+S-_),C=(w+E)/2,O=(_+S)/2,z>=x&&!u(C,O,m,p,o,a)&&!s(e,C,O,p,m,p,l,null)&&(x=z,d.x=C,d.y=O,b=!0))}return v||b?(C=m/2,O=p/2,l.setRange(e(d.x-C),e(d.y-O),e(d.x+C),e(d.y+O)),d.align="center",d.baseline="middle",!0):!1}}const j0e=[-1,-1,1,1],I0e=[-1,1,-1,1];function B0e(e,t,n,r,i){const o=e.width,a=e.height,[s,u]=L7(i),l=t[0],c=t[1],f=e.bitmap();return function(d){const h=d.datum.datum.items[r].items,g=h.length,p=d.datum.fontSize,m=Xi.width(d.datum,d.datum.text),y=[];let v=n?p:0,b=!1,x=!1,w=0,E,_,S,C,O,$,M,F,N,A,k,T;for(let L=0;L<g;++L){for(E=h[L].x,S=h[L].y,_=h[L].x2===void 0?E:h[L].x2,C=h[L].y2===void 0?S:h[L].y2,y.push([e((E+_)/2),e((S+C)/2)]);y.length;)if([M,F]=y.pop(),!(l.get(M,F)||c.get(M,F)||f.get(M,F))){f.set(M,F);for(let z=0;z<4;++z)O=M+j0e[z],$=F+I0e[z],f.outOfBounds(O,$,O,$)||y.push([O,$]);if(O=e.invert(M),$=e.invert(F),N=v,A=a,!u(O,$,m,p,o,a)&&!s(e,O,$,p,m,N,l,c)&&!s(e,O,$,p,m,p,l,null)){for(;A-N>=1;)k=(N+A)/2,s(e,O,$,p,m,k,l,c)?A=k:N=k;N>v&&(d.x=O,d.y=$,v=N,b=!0)}}!b&&!n&&(T=Math.abs(_-E+C-S),O=(E+_)/2,$=(S+C)/2,T>=w&&!u(O,$,m,p,o,a)&&!s(e,O,$,p,m,p,l,null)&&(w=T,d.x=O,d.y=$,x=!0))}return b||x?(O=m/2,$=p/2,l.setRange(e(d.x-O),e(d.y-$),e(d.x+O),e(d.y+$)),d.align="center",d.baseline="middle",!0):!1}}const z0e=["right","center","left"],U0e=["bottom","middle","top"];function q0e(e,t,n,r,i){const o=e.width,a=e.height,s=t[0],u=t[1],l=r.length;return function(c){const f=c.boundary,d=c.datum.fontSize;if(!i&&(f[2]<0||f[5]<0||f[0]>o||f[3]>a))return!1;let h=0,g,p,m,y,v,b,x,w,E,_,S,C,O,$,M;for(let F=0;F<l;++F){if(g=(n[F]&3)-1,p=(n[F]>>>2&3)-1,m=g===0&&p===0||r[F]<0,y=g&&p?Math.SQRT1_2:1,v=r[F]<0?-1:1,b=f[1+g]+r[F]*g*y,S=f[4+p]+v*d*p/2+r[F]*p*y,w=S-d/2,E=S+d/2,C=e(b),$=e(w),M=e(E),i&&(C=C<0?0:C,$=$<0?0:$,M=M>=e.height?e.height-1:M),!h)if(j7(C,C,$,M,s,u,b,b,w,E,f,m))h=Xi.width(c.datum,c.datum.text);else continue;if(_=b+v*h*g/2,b=_-h/2,x=_+h/2,C=e(b),O=e(x),i&&(C=C<0?0:C,O=O>=e.width?e.width-1:O),j7(C,O,$,M,s,u,b,x,w,E,f,m))return c.x=g?g*v<0?x:b:_,c.y=p?p*v<0?E:w:S,c.align=z0e[g*v+1],c.baseline=U0e[p*v+1],s.setRange(C,$,O,M),!0}return!1}}function j7(e,t,n,r,i,o,a,s,u,l,c,f){return!(i.outOfBounds(e,n,t,r)||(f&&o?o.getRange(e,n,t,r)||!H0e(a,u,s,l,c):i.getRange(e,n,t,r)))}function H0e(e,t,n,r,i){return i[0]<=e&&n<=i[2]&&i[3]<=t&&r<=i[5]}const pA=0,mA=4,yA=8,vA=0,bA=1,xA=2,W0e={"top-left":pA+vA,top:pA+bA,"top-right":pA+xA,left:mA+vA,middle:mA+bA,right:mA+xA,"bottom-left":yA+vA,bottom:yA+bA,"bottom-right":yA+xA},G0e={naive:D0e,"reduced-search":L0e,floodfill:B0e};function Y0e(e,t,n,r,i,o,a,s,u,l,c){if(!e.length)return e;const f=Math.max(r.length,i.length),d=V0e(r,f),h=X0e(i,f),g=K0e(e[0].datum),p=g==="group"&&e[0].datum.items[u].marktype,m=p==="area",y=Z0e(g,p,s,u),v=l===null||l===1/0,b=M0e(t[0],t[1],v?0:l),x=m&&c==="naive",w=e.map(S=>({datum:S,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:y(S)}));let E;if(!x){n&&w.sort((C,O)=>n(C.datum,O.datum));let S=!1;for(let C=0;C<h.length&&!S;++C)S=h[C]===5||d[C]<0;g&&(a||m)&&(o=[e.map(C=>C.datum)].concat(o)),E=o.length?O0e(b,o,S,m):C0e(b,a&&w)}const _=m?G0e[c](b,E,a,u,v):q0e(b,E,h,d,v);return w.forEach(S=>S.opacity=+_(S)),w}function V0e(e,t){const n=new Float64Array(t),r=e.length;for(let i=0;i<r;++i)n[i]=e[i]||0;for(let i=r;i<t;++i)n[i]=n[r-1];return n}function X0e(e,t){const n=new Int8Array(t),r=e.length;for(let i=0;i<r;++i)n[i]|=W0e[e[i]];for(let i=r;i<t;++i)n[i]=n[r-1];return n}function K0e(e){return e&&e.mark&&e.mark.marktype}function Z0e(e,t,n,r){const i=o=>[o.x,o.x,o.x,o.y,o.y,o.y];return e?e==="line"||e==="area"?o=>i(o.datum):t==="line"?o=>{const a=o.datum.items[r].items;return i(a.length?a[n==="start"?0:a.length-1]:{x:NaN,y:NaN})}:o=>{const a=o.datum.bounds;return[a.x1,(a.x1+a.x2)/2,a.x2,a.y1,(a.y1+a.y2)/2,a.y2]}:i}const wA=["x","y","opacity","align","baseline"],I7=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function _A(e){R.call(this,null,e)}_A.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:I7},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:wA.length,default:wA}]};H(_A,R,{transform(e,t){function n(o){const a=e[o];return ye(a)&&t.modified(a.fields)}const r=e.modified();if(!(r||t.changed(t.ADD_REM)||n("sort")))return;(!e.size||e.size.length!==2)&&B("Size parameter should be specified as a [width, height] array.");const i=e.as||wA;return Y0e(t.materialize(t.SOURCE).source||[],e.size,e.sort,ae(e.offset==null?1:e.offset),ae(e.anchor||I7),e.avoidMarks||[],e.avoidBaseMark!==!1,e.lineAnchor||"end",e.markIndex||0,e.padding===void 0?0:e.padding,e.method||"naive").forEach(o=>{const a=o.datum;a[i[0]]=o.x,a[i[1]]=o.y,a[i[2]]=o.opacity,a[i[3]]=o.align,a[i[4]]=o.baseline}),t.reflow(r).modifies(i)}});var J0e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",label:_A});function B7(e,t){var n=[],r=function(c){return c(s)},i,o,a,s,u,l;if(t==null)n.push(e);else for(i={},o=0,a=e.length;o<a;++o)s=e[o],u=t.map(r),l=i[u],l||(i[u]=l=[],l.dims=u,n.push(l)),l.push(s);return n}function EA(e){R.call(this,null,e)}EA.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]};H(EA,R,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=B7(r,e.groupby),o=(e.groupby||[]).map(ft),a=o.length,s=e.as||[ft(e.x),ft(e.y)],u=[];i.forEach(l=>{B5(l,e.x,e.y,e.bandwidth||.3).forEach(c=>{const f={};for(let d=0;d<a;++d)f[o[d]]=l.dims[d];f[s[0]]=c[0],f[s[1]]=c[1],u.push(Ie(f))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});const $A={linear:O2,log:T5,exp:R5,pow:P5,quad:F2,poly:L5},Q0e=(e,t)=>e==="poly"?t:e==="quad"?2:1;function AA(e){R.call(this,null,e)}AA.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys($A)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]};H(AA,R,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=B7(r,e.groupby),o=(e.groupby||[]).map(ft),a=e.method||"linear",s=e.order||3,u=Q0e(a,s),l=e.as||[ft(e.x),ft(e.y)],c=$A[a],f=[];let d=e.extent;se($A,a)||B("Invalid regression method: "+a),d!=null&&a==="log"&&d[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),d=null),i.forEach(h=>{if(h.length<=u){t.dataflow.warn("Skipping regression with more parameters than data points.");return}const p=c(h,e.x,e.y,s);if(e.params){f.push(Ie({keys:h.dims,coef:p.coef,rSquared:p.rSquared}));return}const m=d||ji(h,e.x),y=v=>{const b={};for(let x=0;x<o.length;++x)b[o[x]]=h.dims[x];b[l[0]]=v[0],b[l[1]]=v[1],f.push(Ie(b))};a==="linear"?m.forEach(v=>y([v,p.predict(v)])):yp(p.predict,m,25,200).forEach(y)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=f}return n}});var ege=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",loess:EA,regression:AA});const z7=Math.pow(2,-52),E1=new Uint32Array(512);class $1{static from(t,n=oge,r=age){const i=t.length,o=new Float64Array(i*2);for(let a=0;a<i;a++){const s=t[a];o[2*a]=n(s),o[2*a+1]=r(s)}return new $1(o)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const r=Math.max(2*n-5,0);this._triangles=new Uint32Array(r*3),this._halfedges=new Int32Array(r*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:r,_hullTri:i,_hullHash:o}=this,a=t.length>>1;let s=1/0,u=1/0,l=-1/0,c=-1/0;for(let O=0;O<a;O++){const $=t[2*O],M=t[2*O+1];$<s&&(s=$),M<u&&(u=M),$>l&&(l=$),M>c&&(c=M),this._ids[O]=O}const f=(s+l)/2,d=(u+c)/2;let h=1/0,g,p,m;for(let O=0;O<a;O++){const $=SA(f,d,t[2*O],t[2*O+1]);$<h&&(g=O,h=$)}const y=t[2*g],v=t[2*g+1];h=1/0;for(let O=0;O<a;O++){if(O===g)continue;const $=SA(y,v,t[2*O],t[2*O+1]);$<h&&$>0&&(p=O,h=$)}let b=t[2*p],x=t[2*p+1],w=1/0;for(let O=0;O<a;O++){if(O===g||O===p)continue;const $=rge(y,v,b,x,t[2*O],t[2*O+1]);$<w&&(m=O,w=$)}let E=t[2*m],_=t[2*m+1];if(w===1/0){for(let M=0;M<a;M++)this._dists[M]=t[2*M]-t[0]||t[2*M+1]-t[1];gc(this._ids,this._dists,0,a-1);const O=new Uint32Array(a);let $=0;for(let M=0,F=-1/0;M<a;M++){const N=this._ids[M];this._dists[N]>F&&(O[$++]=N,F=this._dists[N])}this.hull=O.subarray(0,$),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(A1(y,v,b,x,E,_)){const O=p,$=b,M=x;p=m,b=E,x=_,m=O,E=$,_=M}const S=ige(y,v,b,x,E,_);this._cx=S.x,this._cy=S.y;for(let O=0;O<a;O++)this._dists[O]=SA(t[2*O],t[2*O+1],S.x,S.y);gc(this._ids,this._dists,0,a-1),this._hullStart=g;let C=3;r[g]=n[m]=p,r[p]=n[g]=m,r[m]=n[p]=g,i[g]=0,i[p]=1,i[m]=2,o.fill(-1),o[this._hashKey(y,v)]=g,o[this._hashKey(b,x)]=p,o[this._hashKey(E,_)]=m,this.trianglesLen=0,this._addTriangle(g,p,m,-1,-1,-1);for(let O=0,$,M;O<this._ids.length;O++){const F=this._ids[O],N=t[2*F],A=t[2*F+1];if(O>0&&Math.abs(N-$)<=z7&&Math.abs(A-M)<=z7||($=N,M=A,F===g||F===p||F===m))continue;let k=0;for(let oe=0,ue=this._hashKey(N,A);oe<this._hashSize&&(k=o[(ue+oe)%this._hashSize],!(k!==-1&&k!==r[k]));oe++);k=n[k];let T=k,L;for(;L=r[T],!A1(N,A,t[2*T],t[2*T+1],t[2*L],t[2*L+1]);)if(T=L,T===k){T=-1;break}if(T===-1)continue;let z=this._addTriangle(T,F,r[T],-1,-1,i[T]);i[F]=this._legalize(z+2),i[T]=z,C++;let Q=r[T];for(;L=r[Q],A1(N,A,t[2*Q],t[2*Q+1],t[2*L],t[2*L+1]);)z=this._addTriangle(Q,F,L,i[F],-1,i[Q]),i[F]=this._legalize(z+2),r[Q]=Q,C--,Q=L;if(T===k)for(;L=n[T],A1(N,A,t[2*L],t[2*L+1],t[2*T],t[2*T+1]);)z=this._addTriangle(L,F,T,-1,i[T],i[L]),this._legalize(z+2),i[L]=z,r[T]=T,C--,T=L;this._hullStart=n[F]=T,r[T]=n[Q]=F,r[F]=Q,o[this._hashKey(N,A)]=F,o[this._hashKey(t[2*T],t[2*T+1])]=T}this.hull=new Uint32Array(C);for(let O=0,$=this._hullStart;O<C;O++)this.hull[O]=$,$=r[$];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(tge(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:r,coords:i}=this;let o=0,a=0;for(;;){const s=r[t],u=t-t%3;if(a=u+(t+2)%3,s===-1){if(o===0)break;t=E1[--o];continue}const l=s-s%3,c=u+(t+1)%3,f=l+(s+2)%3,d=n[a],h=n[t],g=n[c],p=n[f];if(nge(i[2*d],i[2*d+1],i[2*h],i[2*h+1],i[2*g],i[2*g+1],i[2*p],i[2*p+1])){n[t]=p,n[s]=d;const y=r[f];if(y===-1){let b=this._hullStart;do{if(this._hullTri[b]===f){this._hullTri[b]=t;break}b=this._hullPrev[b]}while(b!==this._hullStart)}this._link(t,y),this._link(s,r[a]),this._link(a,f);const v=l+(s+1)%3;o<E1.length&&(E1[o++]=v)}else{if(o===0)break;t=E1[--o]}}return a}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,r,i,o,a){const s=this.trianglesLen;return this._triangles[s]=t,this._triangles[s+1]=n,this._triangles[s+2]=r,this._link(s,i),this._link(s+1,o),this._link(s+2,a),this.trianglesLen+=3,s}}function tge(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function SA(e,t,n,r){const i=e-n,o=t-r;return i*i+o*o}function CA(e,t,n,r,i,o){const a=(r-t)*(i-e),s=(n-e)*(o-t);return Math.abs(a-s)>=33306690738754716e-32*Math.abs(a+s)?a-s:0}function A1(e,t,n,r,i,o){return(CA(i,o,e,t,n,r)||CA(e,t,n,r,i,o)||CA(n,r,i,o,e,t))<0}function nge(e,t,n,r,i,o,a,s){const u=e-a,l=t-s,c=n-a,f=r-s,d=i-a,h=o-s,g=u*u+l*l,p=c*c+f*f,m=d*d+h*h;return u*(f*m-p*h)-l*(c*m-p*d)+g*(c*h-f*d)<0}function rge(e,t,n,r,i,o){const a=n-e,s=r-t,u=i-e,l=o-t,c=a*a+s*s,f=u*u+l*l,d=.5/(a*l-s*u),h=(l*c-s*f)*d,g=(a*f-u*c)*d;return h*h+g*g}function ige(e,t,n,r,i,o){const a=n-e,s=r-t,u=i-e,l=o-t,c=a*a+s*s,f=u*u+l*l,d=.5/(a*l-s*u),h=e+(l*c-s*f)*d,g=t+(a*f-u*c)*d;return{x:h,y:g}}function gc(e,t,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const o=e[i],a=t[o];let s=i-1;for(;s>=n&&t[e[s]]>a;)e[s+1]=e[s--];e[s+1]=o}else{const i=n+r>>1;let o=n+1,a=r;Eh(e,i,o),t[e[n]]>t[e[r]]&&Eh(e,n,r),t[e[o]]>t[e[r]]&&Eh(e,o,r),t[e[n]]>t[e[o]]&&Eh(e,n,o);const s=e[o],u=t[s];for(;;){do o++;while(t[e[o]]<u);do a--;while(t[e[a]]>u);if(a<o)break;Eh(e,o,a)}e[n+1]=e[a],e[a]=s,r-o+1>=a-n?(gc(e,t,o,r),gc(e,t,n,a-1)):(gc(e,t,n,a-1),gc(e,t,o,r))}}function Eh(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function oge(e){return e[0]}function age(e){return e[1]}const U7=1e-6;class gu{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,r){t=+t,n=+n,r=+r;const i=t+r,o=n;if(r<0)throw new Error("negative radius");this._x1===null?this._+=`M${i},${o}`:(Math.abs(this._x1-i)>U7||Math.abs(this._y1-o)>U7)&&(this._+="L"+i+","+o),!!r&&(this._+=`A${r},${r},0,1,1,${t-r},${n}A${r},${r},0,1,1,${this._x1=i},${this._y1=o}`)}rect(t,n,r,i){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+r}v${+i}h${-r}Z`}value(){return this._||null}}class OA{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}class sge{constructor(t,[n,r,i,o]=[0,0,960,500]){if(!((i=+i)>=(n=+n))||!((o=+o)>=(r=+r)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=i,this.xmin=n,this.ymax=o,this.ymin=r,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:r},vectors:i}=this,o=this.circumcenters=this._circumcenters.subarray(0,r.length/3*2);for(let h=0,g=0,p=r.length,m,y;h<p;h+=3,g+=2){const v=r[h]*2,b=r[h+1]*2,x=r[h+2]*2,w=t[v],E=t[v+1],_=t[b],S=t[b+1],C=t[x],O=t[x+1],$=_-w,M=S-E,F=C-w,N=O-E,A=$*$+M*M,k=F*F+N*N,T=($*N-M*F)*2;if(!T)m=(w+C)/2-1e8*N,y=(E+O)/2+1e8*F;else if(Math.abs(T)<1e-8)m=(w+C)/2,y=(E+O)/2;else{const L=1/T;m=w+(N*A-M*k)*L,y=E+($*k-F*A)*L}o[g]=m,o[g+1]=y}let a=n[n.length-1],s,u=a*4,l,c=t[2*a],f,d=t[2*a+1];i.fill(0);for(let h=0;h<n.length;++h)a=n[h],s=u,l=c,f=d,u=a*4,c=t[2*a],d=t[2*a+1],i[s+2]=i[u]=f-d,i[s+3]=i[u+1]=c-l}render(t){const n=t==null?t=new gu:void 0,{delaunay:{halfedges:r,inedges:i,hull:o},circumcenters:a,vectors:s}=this;if(o.length<=1)return null;for(let c=0,f=r.length;c<f;++c){const d=r[c];if(d<c)continue;const h=Math.floor(c/3)*2,g=Math.floor(d/3)*2,p=a[h],m=a[h+1],y=a[g],v=a[g+1];this._renderSegment(p,m,y,v,t)}let u,l=o[o.length-1];for(let c=0;c<o.length;++c){u=l,l=o[c];const f=Math.floor(i[l]/3)*2,d=a[f],h=a[f+1],g=u*4,p=this._project(d,h,s[g+2],s[g+3]);p&&this._renderSegment(d,h,p[0],p[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new gu:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const r=n==null?n=new gu:void 0,i=this._clip(t);if(i===null||!i.length)return;n.moveTo(i[0],i[1]);let o=i.length;for(;i[0]===i[o-2]&&i[1]===i[o-1]&&o>1;)o-=2;for(let a=2;a<o;a+=2)(i[a]!==i[a-2]||i[a+1]!==i[a-1])&&n.lineTo(i[a],i[a+1]);return n.closePath(),r&&r.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,r=t.length/2;n<r;++n){const i=this.cellPolygon(n);i&&(i.index=n,yield i)}}cellPolygon(t){const n=new OA;return this.renderCell(t,n),n.value()}_renderSegment(t,n,r,i,o){let a;const s=this._regioncode(t,n),u=this._regioncode(r,i);s===0&&u===0?(o.moveTo(t,n),o.lineTo(r,i)):(a=this._clipSegment(t,n,r,i,s,u))&&(o.moveTo(a[0],a[1]),o.lineTo(a[2],a[3]))}contains(t,n,r){return n=+n,n!==n||(r=+r,r!==r)?!1:this.delaunay._step(t,n,r)===t}*neighbors(t){const n=this._clip(t);if(n)for(const r of this.delaunay.neighbors(t)){const i=this._clip(r);if(i)e:for(let o=0,a=n.length;o<a;o+=2)for(let s=0,u=i.length;s<u;s+=2)if(n[o]==i[s]&&n[o+1]==i[s+1]&&n[(o+2)%a]==i[(s+u-2)%u]&&n[(o+3)%a]==i[(s+u-1)%u]){yield r;break e}}}_cell(t){const{circumcenters:n,delaunay:{inedges:r,halfedges:i,triangles:o}}=this,a=r[t];if(a===-1)return null;const s=[];let u=a;do{const l=Math.floor(u/3);if(s.push(n[l*2],n[l*2+1]),u=u%3==2?u-2:u+1,o[u]!==t)break;u=i[u]}while(u!==a&&u!==-1);return s}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:r}=this,i=t*4;return r[i]||r[i+1]?this._clipInfinite(t,n,r[i],r[i+1],r[i+2],r[i+3]):this._clipFinite(t,n)}_clipFinite(t,n){const r=n.length;let i=null,o,a,s=n[r-2],u=n[r-1],l,c=this._regioncode(s,u),f,d;for(let h=0;h<r;h+=2)if(o=s,a=u,s=n[h],u=n[h+1],l=c,c=this._regioncode(s,u),l===0&&c===0)f=d,d=0,i?i.push(s,u):i=[s,u];else{let g,p,m,y,v;if(l===0){if((g=this._clipSegment(o,a,s,u,l,c))===null)continue;[p,m,y,v]=g}else{if((g=this._clipSegment(s,u,o,a,c,l))===null)continue;[y,v,p,m]=g,f=d,d=this._edgecode(p,m),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(p,m):i=[p,m]}f=d,d=this._edgecode(y,v),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(y,v):i=[y,v]}if(i)f=d,d=this._edgecode(i[0],i[1]),f&&d&&this._edge(t,f,d,i,i.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return i}_clipSegment(t,n,r,i,o,a){for(;;){if(o===0&&a===0)return[t,n,r,i];if(o&a)return null;let s,u,l=o||a;l&8?(s=t+(r-t)*(this.ymax-n)/(i-n),u=this.ymax):l&4?(s=t+(r-t)*(this.ymin-n)/(i-n),u=this.ymin):l&2?(u=n+(i-n)*(this.xmax-t)/(r-t),s=this.xmax):(u=n+(i-n)*(this.xmin-t)/(r-t),s=this.xmin),o?(t=s,n=u,o=this._regioncode(t,n)):(r=s,i=u,a=this._regioncode(r,i))}}_clipInfinite(t,n,r,i,o,a){let s=Array.from(n),u;if((u=this._project(s[0],s[1],r,i))&&s.unshift(u[0],u[1]),(u=this._project(s[s.length-2],s[s.length-1],o,a))&&s.push(u[0],u[1]),s=this._clipFinite(t,s))for(let l=0,c=s.length,f,d=this._edgecode(s[c-2],s[c-1]);l<c;l+=2)f=d,d=this._edgecode(s[l],s[l+1]),f&&d&&(l=this._edge(t,f,d,s,l),c=s.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return s}_edge(t,n,r,i,o){for(;n!==r;){let a,s;switch(n){case 5:n=4;continue;case 4:n=6,a=this.xmax,s=this.ymin;break;case 6:n=2;continue;case 2:n=10,a=this.xmax,s=this.ymax;break;case 10:n=8;continue;case 8:n=9,a=this.xmin,s=this.ymax;break;case 9:n=1;continue;case 1:n=5,a=this.xmin,s=this.ymin;break}(i[o]!==a||i[o+1]!==s)&&this.contains(t,a,s)&&(i.splice(o,0,a,s),o+=2)}if(i.length>4)for(let a=0;a<i.length;a+=2){const s=(a+2)%i.length,u=(a+4)%i.length;(i[a]===i[s]&&i[s]===i[u]||i[a+1]===i[s+1]&&i[s+1]===i[u+1])&&(i.splice(s,2),a-=2)}return o}_project(t,n,r,i){let o=1/0,a,s,u;if(i<0){if(n<=this.ymin)return null;(a=(this.ymin-n)/i)<o&&(u=this.ymin,s=t+(o=a)*r)}else if(i>0){if(n>=this.ymax)return null;(a=(this.ymax-n)/i)<o&&(u=this.ymax,s=t+(o=a)*r)}if(r>0){if(t>=this.xmax)return null;(a=(this.xmax-t)/r)<o&&(s=this.xmax,u=n+(o=a)*i)}else if(r<0){if(t<=this.xmin)return null;(a=(this.xmin-t)/r)<o&&(s=this.xmin,u=n+(o=a)*i)}return[s,u]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}}const uge=2*Math.PI,pc=Math.pow;function lge(e){return e[0]}function cge(e){return e[1]}function fge(e){const{triangles:t,coords:n}=e;for(let r=0;r<t.length;r+=3){const i=2*t[r],o=2*t[r+1],a=2*t[r+2];if((n[a]-n[i])*(n[o+1]-n[i+1])-(n[o]-n[i])*(n[a+1]-n[i+1])>1e-10)return!1}return!0}function dge(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class FA{static from(t,n=lge,r=cge,i){return new FA("length"in t?hge(t,n,r,i):Float64Array.from(gge(t,n,r,i)))}constructor(t){this._delaunator=new $1(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&fge(t)){this.collinear=Int32Array.from({length:n.length/2},(d,h)=>h).sort((d,h)=>n[2*d]-n[2*h]||n[2*d+1]-n[2*h+1]);const u=this.collinear[0],l=this.collinear[this.collinear.length-1],c=[n[2*u],n[2*u+1],n[2*l],n[2*l+1]],f=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let d=0,h=n.length/2;d<h;++d){const g=dge(n[2*d],n[2*d+1],f);n[2*d]=g[0],n[2*d+1]=g[1]}this._delaunator=new $1(n)}else delete this.collinear;const r=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,o=this.triangles=this._delaunator.triangles,a=this.inedges.fill(-1),s=this._hullIndex.fill(-1);for(let u=0,l=r.length;u<l;++u){const c=o[u%3==2?u-2:u+1];(r[u]===-1||a[c]===-1)&&(a[c]=u)}for(let u=0,l=i.length;u<l;++u)s[i[u]]=u;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],this.triangles[1]=i[1],this.triangles[2]=i[1],a[i[0]]=1,i.length===2&&(a[i[1]]=0))}voronoi(t){return new sge(this,t)}*neighbors(t){const{inedges:n,hull:r,_hullIndex:i,halfedges:o,triangles:a,collinear:s}=this;if(s){const f=s.indexOf(t);f>0&&(yield s[f-1]),f<s.length-1&&(yield s[f+1]);return}const u=n[t];if(u===-1)return;let l=u,c=-1;do{if(yield c=a[l],l=l%3==2?l-2:l+1,a[l]!==t)return;if(l=o[l],l===-1){const f=r[(i[t]+1)%r.length];f!==c&&(yield f);return}}while(l!==u)}find(t,n,r=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const i=r;let o;for(;(o=this._step(r,t,n))>=0&&o!==r&&o!==i;)r=o;return o}_step(t,n,r){const{inedges:i,hull:o,_hullIndex:a,halfedges:s,triangles:u,points:l}=this;if(i[t]===-1||!l.length)return(t+1)%(l.length>>1);let c=t,f=pc(n-l[t*2],2)+pc(r-l[t*2+1],2);const d=i[t];let h=d;do{let g=u[h];const p=pc(n-l[g*2],2)+pc(r-l[g*2+1],2);if(p<f&&(f=p,c=g),h=h%3==2?h-2:h+1,u[h]!==t)break;if(h=s[h],h===-1){if(h=o[(a[t]+1)%o.length],h!==g&&pc(n-l[h*2],2)+pc(r-l[h*2+1],2)<f)return h;break}}while(h!==d);return c}render(t){const n=t==null?t=new gu:void 0,{points:r,halfedges:i,triangles:o}=this;for(let a=0,s=i.length;a<s;++a){const u=i[a];if(u<a)continue;const l=o[a]*2,c=o[u]*2;t.moveTo(r[l],r[l+1]),t.lineTo(r[c],r[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n=2){const r=t==null?t=new gu:void 0,{points:i}=this;for(let o=0,a=i.length;o<a;o+=2){const s=i[o],u=i[o+1];t.moveTo(s+n,u),t.arc(s,u,n,0,uge)}return r&&r.value()}renderHull(t){const n=t==null?t=new gu:void 0,{hull:r,points:i}=this,o=r[0]*2,a=r.length;t.moveTo(i[o],i[o+1]);for(let s=1;s<a;++s){const u=2*r[s];t.lineTo(i[u],i[u+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new OA;return this.renderHull(t),t.value()}renderTriangle(t,n){const r=n==null?n=new gu:void 0,{points:i,triangles:o}=this,a=o[t*=3]*2,s=o[t+1]*2,u=o[t+2]*2;return n.moveTo(i[a],i[a+1]),n.lineTo(i[s],i[s+1]),n.lineTo(i[u],i[u+1]),n.closePath(),r&&r.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,r=t.length/3;n<r;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new OA;return this.renderTriangle(t,n),n.value()}}function hge(e,t,n,r){const i=e.length,o=new Float64Array(i*2);for(let a=0;a<i;++a){const s=e[a];o[a*2]=t.call(r,s,a,e),o[a*2+1]=n.call(r,s,a,e)}return o}function*gge(e,t,n,r){let i=0;for(const o of e)yield t.call(r,o,i,e),yield n.call(r,o,i,e),++i}function kA(e){R.call(this,null,e)}kA.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const pge=[-1e5,-1e5,1e5,1e5];H(kA,R,{transform(e,t){const n=e.as||"path",r=t.source;if(!r||!r.length)return t;let i=e.size;i=i?[0,0,i[0],i[1]]:(i=e.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:pge;const o=this.value=FA.from(r,e.x,e.y).voronoi(i);for(let a=0,s=r.length;a<s;++a){const u=o.cellPolygon(a);r[a][n]=u?mge(u):null}return t.reflow(e.modified()).modifies(n)}});function mge(e){const t=e[0][0],n=e[0][1];let r=e.length-1;for(;e[r][0]===t&&e[r][1]===n;--r);return"M"+e.slice(0,r+1).join("L")+"Z"}var yge=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",voronoi:kA}),MA=Math.PI/180,$h=1<<11>>5,S1=1<<11;function vge(){var e=[256,256],t,n,r,i,o,a,s,u=q7,l=[],c=Math.random,f={};f.layout=function(){for(var g=d(Nl()),p=$ge((e[0]>>5)*e[1]),m=null,y=l.length,v=-1,b=[],x=l.map(E=>({text:t(E),font:n(E),style:i(E),weight:o(E),rotate:a(E),size:~~(r(E)+1e-14),padding:s(E),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:E})).sort((E,_)=>_.size-E.size);++v<y;){var w=x[v];w.x=e[0]*(c()+.5)>>1,w.y=e[1]*(c()+.5)>>1,bge(g,w,x,v),w.hasText&&h(p,w,m)&&(b.push(w),m?wge(m,w):m=[{x:w.x+w.x0,y:w.y+w.y0},{x:w.x+w.x1,y:w.y+w.y1}],w.x-=e[0]>>1,w.y-=e[1]>>1)}return b};function d(g){g.width=g.height=1;var p=Math.sqrt(g.getContext("2d").getImageData(0,0,1,1).data.length>>2);g.width=($h<<5)/p,g.height=S1/p;var m=g.getContext("2d");return m.fillStyle=m.strokeStyle="red",m.textAlign="center",{context:m,ratio:p}}function h(g,p,m){for(var y=p.x,v=p.y,b=Math.sqrt(e[0]*e[0]+e[1]*e[1]),x=u(e),w=c()<.5?1:-1,E=-w,_,S,C;(_=x(E+=w))&&(S=~~_[0],C=~~_[1],!(Math.min(Math.abs(S),Math.abs(C))>=b));)if(p.x=y+S,p.y=v+C,!(p.x+p.x0<0||p.y+p.y0<0||p.x+p.x1>e[0]||p.y+p.y1>e[1])&&(!m||!xge(p,g,e[0]))&&(!m||_ge(p,m))){for(var O=p.sprite,$=p.width>>5,M=e[0]>>5,F=p.x-($<<4),N=F&127,A=32-N,k=p.y1-p.y0,T=(p.y+p.y0)*M+(F>>5),L,z=0;z<k;z++){L=0;for(var Q=0;Q<=$;Q++)g[T+Q]|=L<<A|(Q<$?(L=O[z*$+Q])>>>N:0);T+=M}return p.sprite=null,!0}return!1}return f.words=function(g){return arguments.length?(l=g,f):l},f.size=function(g){return arguments.length?(e=[+g[0],+g[1]],f):e},f.font=function(g){return arguments.length?(n=pu(g),f):n},f.fontStyle=function(g){return arguments.length?(i=pu(g),f):i},f.fontWeight=function(g){return arguments.length?(o=pu(g),f):o},f.rotate=function(g){return arguments.length?(a=pu(g),f):a},f.text=function(g){return arguments.length?(t=pu(g),f):t},f.spiral=function(g){return arguments.length?(u=Age[g]||g,f):u},f.fontSize=function(g){return arguments.length?(r=pu(g),f):r},f.padding=function(g){return arguments.length?(s=pu(g),f):s},f.random=function(g){return arguments.length?(c=g,f):c},f}function bge(e,t,n,r){if(!t.sprite){var i=e.context,o=e.ratio;i.clearRect(0,0,($h<<5)/o,S1/o);var a=0,s=0,u=0,l=n.length,c,f,d,h,g;for(--r;++r<l;){if(t=n[r],i.save(),i.font=t.style+" "+t.weight+" "+~~((t.size+1)/o)+"px "+t.font,c=i.measureText(t.text+"m").width*o,d=t.size<<1,t.rotate){var p=Math.sin(t.rotate*MA),m=Math.cos(t.rotate*MA),y=c*m,v=c*p,b=d*m,x=d*p;c=Math.max(Math.abs(y+x),Math.abs(y-x))+31>>5<<5,d=~~Math.max(Math.abs(v+b),Math.abs(v-b))}else c=c+31>>5<<5;if(d>u&&(u=d),a+c>=$h<<5&&(a=0,s+=u,u=0),s+d>=S1)break;i.translate((a+(c>>1))/o,(s+(d>>1))/o),t.rotate&&i.rotate(t.rotate*MA),i.fillText(t.text,0,0),t.padding&&(i.lineWidth=2*t.padding,i.strokeText(t.text,0,0)),i.restore(),t.width=c,t.height=d,t.xoff=a,t.yoff=s,t.x1=c>>1,t.y1=d>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,a+=c}for(var w=i.getImageData(0,0,($h<<5)/o,S1/o).data,E=[];--r>=0;)if(t=n[r],!!t.hasText){for(c=t.width,f=c>>5,d=t.y1-t.y0,h=0;h<d*f;h++)E[h]=0;if(a=t.xoff,a==null)return;s=t.yoff;var _=0,S=-1;for(g=0;g<d;g++){for(h=0;h<c;h++){var C=f*g+(h>>5),O=w[(s+g)*($h<<5)+(a+h)<<2]?1<<31-h%32:0;E[C]|=O,_|=O}_?S=g:(t.y0++,d--,g--,s++)}t.y1=t.y0+S,t.sprite=E.slice(0,(t.y1-t.y0)*f)}}}function xge(e,t,n){n>>=5;for(var r=e.sprite,i=e.width>>5,o=e.x-(i<<4),a=o&127,s=32-a,u=e.y1-e.y0,l=(e.y+e.y0)*n+(o>>5),c,f=0;f<u;f++){c=0;for(var d=0;d<=i;d++)if((c<<s|(d<i?(c=r[f*i+d])>>>a:0))&t[l+d])return!0;l+=n}return!1}function wge(e,t){var n=e[0],r=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>r.x&&(r.x=t.x+t.x1),t.y+t.y1>r.y&&(r.y=t.y+t.y1)}function _ge(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function q7(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function Ege(e){var t=4,n=t*e[0]/e[1],r=0,i=0;return function(o){var a=o<0?-1:1;switch(Math.sqrt(1+4*a*o)-a&3){case 0:r+=n;break;case 1:i+=t;break;case 2:r-=n;break;default:i-=t;break}return[r,i]}}function $ge(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function pu(e){return typeof e=="function"?e:function(){return e}}var Age={archimedean:q7,rectangular:Ege};const H7=["x","y","font","fontSize","fontStyle","fontWeight","angle"],Sge=["text","font","rotate","fontSize","fontStyle","fontWeight"];function DA(e){R.call(this,vge(),e)}DA.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:H7}]};H(DA,R,{transform(e,t){e.size&&!(e.size[0]&&e.size[1])&&B("Wordcloud size dimensions must be non-zero.");function n(g){const p=e[g];return ye(p)&&t.modified(p.fields)}const r=e.modified();if(!(r||t.changed(t.ADD_REM)||Sge.some(n)))return;const i=t.materialize(t.SOURCE).source,o=this.value,a=e.as||H7;let s=e.fontSize||14,u;if(ye(s)?u=e.fontSizeRange:s=rn(s),u){const g=s,p=Pe("sqrt")().domain(ji(i,g)).range(u);s=m=>p(g(m))}i.forEach(g=>{g[a[0]]=NaN,g[a[1]]=NaN,g[a[3]]=0});const l=o.words(i).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(s).random(Tr).layout(),c=o.size(),f=c[0]>>1,d=c[1]>>1,h=l.length;for(let g=0,p,m;g<h;++g)p=l[g],m=p.datum,m[a[0]]=p.x+f,m[a[1]]=p.y+d,m[a[2]]=p.font,m[a[3]]=p.size,m[a[4]]=p.style,m[a[5]]=p.weight,m[a[6]]=p.rotate;return t.reflow(r).modifies(a)}});var Cge=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",wordcloud:DA});function W7(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function G7(e){let t=e,n=e;e.length===1&&(t=(a,s)=>e(a)-s,n=Oge(e));function r(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)<0?u=c+1:l=c}return u}function i(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)>0?l=c:u=c+1}return u}function o(a,s,u,l){u==null&&(u=0),l==null&&(l=a.length);const c=r(a,s,u,l-1);return c>u&&t(a[c-1],s)>-t(a[c],s)?c-1:c}return{left:r,center:o,right:i}}function Oge(e){return(t,n)=>W7(e(t),n)}function Fge(e){return e===null?NaN:+e}const Y7=G7(W7),kge=Y7.right,Mge=Y7.left;G7(Fge).center;function Dge(e,t){return Array.from(t,n=>e[n])}const Nge=e=>new Uint8Array(e),Tge=e=>new Uint16Array(e),Ah=e=>new Uint32Array(e);function Rge(){let e=8,t=[],n=Ah(0),r=C1(0,e),i=C1(0,e);return{data:()=>t,seen:()=>n=Pge(n,t.length),add(o){for(let a=0,s=t.length,u=o.length,l;a<u;++a)l=o[a],l._index=s++,t.push(l)},remove(o,a){const s=t.length,u=Array(s-o),l=t;let c,f,d;for(f=0;!a[f]&&f<s;++f)u[f]=t[f],l[f]=f;for(d=f;f<s;++f)c=t[f],a[f]?l[f]=-1:(l[f]=d,r[d]=r[f],i[d]=i[f],u[d]=c,c._index=d++),r[f]=0;return t=u,l},size:()=>t.length,curr:()=>r,prev:()=>i,reset:o=>i[o]=r[o],all:()=>e<257?255:e<65537?65535:4294967295,set(o,a){r[o]|=a},clear(o,a){r[o]&=~a},resize(o,a){const s=r.length;(o>s||a>e)&&(e=Math.max(a,e),r=C1(o,e,r),i=C1(o,e))}}}function Pge(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function C1(e,t,n){const r=(t<257?Nge:t<65537?Tge:Ah)(e);return n&&r.set(n),r}function V7(e,t,n){const r=1<<t;return{one:r,zero:~r,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(i,o){const a=this,s=a.bisect(a.range,i.value),u=i.index,l=s[0],c=s[1],f=u.length;let d;for(d=0;d<l;++d)o[u[d]]|=r;for(d=c;d<f;++d)o[u[d]]|=r;return a}}}function X7(){let e=Ah(0),t=[],n=0;function r(s,u,l){if(!u.length)return[];const c=n,f=u.length,d=Ah(f);let h=Array(f),g,p,m;for(m=0;m<f;++m)h[m]=s(u[m]),d[m]=m;if(h=Lge(h,d),c)g=t,p=e,t=Array(c+f),e=Ah(c+f),jge(l,g,p,c,h,d,f,t,e);else{if(l>0)for(m=0;m<f;++m)d[m]+=l;t=h,e=d}return n=c+f,{index:d,value:h}}function i(s,u){const l=n;let c,f,d;for(f=0;!u[e[f]]&&f<l;++f);for(d=f;f<l;++f)u[c=e[f]]||(e[d]=c,t[d]=t[f],++d);n=l-s}function o(s){for(let u=0,l=n;u<l;++u)e[u]=s[e[u]]}function a(s,u){let l;return u?l=u.length:(u=t,l=n),[Mge(u,s[0],0,l),kge(u,s[1],0,l)]}return{insert:r,remove:i,bisect:a,reindex:o,index:()=>e,size:()=>n}}function Lge(e,t){return e.sort.call(t,(n,r)=>{const i=e[n],o=e[r];return i<o?-1:i>o?1:0}),Dge(e,t)}function jge(e,t,n,r,i,o,a,s,u){let l=0,c=0,f;for(f=0;l<r&&c<a;++f)t[l]<i[c]?(s[f]=t[l],u[f]=n[l++]):(s[f]=i[c],u[f]=o[c++]+e);for(;l<r;++l,++f)s[f]=t[l],u[f]=n[l];for(;c<a;++c,++f)s[f]=i[c],u[f]=o[c]+e}function NA(e){R.call(this,Rge(),e),this._indices=null,this._dims=null}NA.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};H(NA,R,{transform(e,t){if(this._dims){var n=e.modified("fields")||e.fields.some(r=>t.modified(r.fields));return n?this.reinit(e,t):this.eval(e,t)}else return this.init(e,t)},init(e,t){const n=e.fields,r=e.query,i=this._indices={},o=this._dims=[],a=r.length;let s=0,u,l;for(;s<a;++s)u=n[s].fname,l=i[u]||(i[u]=X7()),o.push(V7(l,s,r[s]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),r=e.fields,i=e.query,o=this._indices,a=this._dims,s=this.value,u=s.curr(),l=s.prev(),c=s.all(),f=n.rem=n.add,d=n.mod,h=i.length,g={};let p,m,y,v,b,x,w,E,_;if(l.set(u),t.rem.length&&(b=this.remove(e,t,n)),t.add.length&&s.add(t.add),t.mod.length)for(x={},v=t.mod,w=0,E=v.length;w<E;++w)x[v[w]._index]=1;for(w=0;w<h;++w)_=r[w],(!a[w]||e.modified("fields",w)||t.modified(_.fields))&&(y=_.fname,(p=g[y])||(o[y]=m=X7(),g[y]=p=m.insert(_,t.source,0)),a[w]=V7(m,w,i[w]).onAdd(p,u));for(w=0,E=s.data().length;w<E;++w)b[w]||(l[w]!==u[w]?f.push(w):x[w]&&u[w]!==c&&d.push(w));return s.mask=(1<<h)-1,n},eval(e,t){const n=t.materialize().fork(),r=this._dims.length;let i=0;return t.rem.length&&(this.remove(e,t,n),i|=(1<<r)-1),e.modified("query")&&!e.modified("fields")&&(i|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),i|=(1<<r)-1),t.mod.length&&(this.modify(t,n),i|=(1<<r)-1),this.value.mask=i,n},insert(e,t,n){const r=t.add,i=this.value,o=this._dims,a=this._indices,s=e.fields,u={},l=n.add,c=i.size()+r.length,f=o.length;let d=i.size(),h,g,p;i.resize(c,f),i.add(r);const m=i.curr(),y=i.prev(),v=i.all();for(h=0;h<f;++h)g=s[h].fname,p=u[g]||(u[g]=a[g].insert(s[h],r,d)),o[h].onAdd(p,m);for(;d<c;++d)y[d]=v,m[d]!==v&&l.push(d)},modify(e,t){const n=t.mod,r=this.value,i=r.curr(),o=r.all(),a=e.mod;let s,u,l;for(s=0,u=a.length;s<u;++s)l=a[s]._index,i[l]!==o&&n.push(l)},remove(e,t,n){const r=this._indices,i=this.value,o=i.curr(),a=i.prev(),s=i.all(),u={},l=n.rem,c=t.rem;let f,d,h,g;for(f=0,d=c.length;f<d;++f)h=c[f]._index,u[h]=1,a[h]=g=o[h],o[h]=s,g!==s&&l.push(h);for(h in r)r[h].remove(d,u);return this.reindex(t,d,u),u},reindex(e,t,n){const r=this._indices,i=this.value;e.runAfter(()=>{const o=i.remove(t,n);for(const a in r)r[a].reindex(o)})},update(e,t,n){const r=this._dims,i=e.query,o=t.stamp,a=r.length;let s=0,u,l;for(n.filters=0,l=0;l<a;++l)e.modified("query",l)&&(u=l,++s);if(s===1)s=r[u].one,this.incrementOne(r[u],i[u],n.add,n.rem);else for(l=0,s=0;l<a;++l)!e.modified("query",l)||(s|=r[l].one,this.incrementAll(r[l],i[l],o,n.add),n.rem=n.add);return s},incrementAll(e,t,n,r){const i=this.value,o=i.seen(),a=i.curr(),s=i.prev(),u=e.index(),l=e.bisect(e.range),c=e.bisect(t),f=c[0],d=c[1],h=l[0],g=l[1],p=e.one;let m,y,v;if(f<h)for(m=f,y=Math.min(h,d);m<y;++m)v=u[m],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=p;else if(f>h)for(m=h,y=Math.min(f,g);m<y;++m)v=u[m],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=p;if(d>g)for(m=Math.max(f,g),y=d;m<y;++m)v=u[m],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=p;else if(d<g)for(m=Math.max(h,d),y=g;m<y;++m)v=u[m],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=p;e.range=t.slice()},incrementOne(e,t,n,r){const i=this.value,o=i.curr(),a=e.index(),s=e.bisect(e.range),u=e.bisect(t),l=u[0],c=u[1],f=s[0],d=s[1],h=e.one;let g,p,m;if(l<f)for(g=l,p=Math.min(f,c);g<p;++g)m=a[g],o[m]^=h,n.push(m);else if(l>f)for(g=f,p=Math.min(l,d);g<p;++g)m=a[g],o[m]^=h,r.push(m);if(c>d)for(g=Math.max(l,d),p=c;g<p;++g)m=a[g],o[m]^=h,n.push(m);else if(c<d)for(g=Math.max(f,c),p=d;g<p;++g)m=a[g],o[m]^=h,r.push(m);e.range=t.slice()}});function TA(e){R.call(this,null,e)}TA.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};H(TA,R,{transform(e,t){const n=~(e.ignore||0),r=e.filter,i=r.mask;if((i&n)==0)return t.StopPropagation;const o=t.fork(t.ALL),a=r.data(),s=r.curr(),u=r.prev(),l=c=>s[c]&n?null:a[c];return o.filter(o.MOD,l),i&i-1?(o.filter(o.ADD,c=>{const f=s[c]&n;return!f&&f^u[c]&n?a[c]:null}),o.filter(o.REM,c=>{const f=s[c]&n;return f&&!(f^(f^u[c]&n))?a[c]:null})):(o.filter(o.ADD,l),o.filter(o.REM,c=>(s[c]&n)===i?a[c]:null)),o.filter(o.SOURCE,c=>l(c._index))}});var Ige=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",crossfilter:NA,resolvefilter:TA}),Bge=Math.sqrt(50),zge=Math.sqrt(10),Uge=Math.sqrt(2);function qge(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=Bge?i*=10:o>=zge?i*=5:o>=Uge&&(i*=2),t<e?-i:i}const Hge="RawCode",mu="Literal",Wge="Property",Gge="Identifier",Yge="ArrayExpression",Vge="BinaryExpression",K7="CallExpression",Xge="ConditionalExpression",Kge="LogicalExpression",Zge="MemberExpression",Jge="ObjectExpression",Qge="UnaryExpression";function mi(e){this.type=e}mi.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=epe(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function epe(e){switch(e.type){case Yge:return e.elements;case Vge:case Kge:return[e.left,e.right];case K7:return[e.callee].concat(e.arguments);case Xge:return[e.test,e.consequent,e.alternate];case Zge:return[e.object,e.property];case Jge:return e.properties;case Wge:return[e.key,e.value];case Qge:return[e.argument];case Gge:case mu:case Hge:default:return[]}}var io,K,j,dn,qe,O1=1,Sh=2,yu=3,Ka=4,F1=5,vu=6,Zn=7,Ch=8,tpe=9;io={};io[O1]="Boolean";io[Sh]="<end>";io[yu]="Identifier";io[Ka]="Keyword";io[F1]="Null";io[vu]="Numeric";io[Zn]="Punctuator";io[Ch]="String";io[tpe]="RegularExpression";var npe="ArrayExpression",rpe="BinaryExpression",ipe="CallExpression",ope="ConditionalExpression",Z7="Identifier",ape="Literal",spe="LogicalExpression",upe="MemberExpression",lpe="ObjectExpression",cpe="Property",fpe="UnaryExpression",Bt="Unexpected token %0",dpe="Unexpected number",hpe="Unexpected string",gpe="Unexpected identifier",ppe="Unexpected reserved word",mpe="Unexpected end of input",RA="Invalid regular expression",PA="Invalid regular expression: missing /",J7="Octal literals are not allowed in strict mode.",ype="Duplicate data property in object literal not allowed in strict mode",Kt="ILLEGAL",Oh="Disabled.",vpe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),bpe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function k1(e,t){if(!e)throw new Error("ASSERT: "+t)}function Ko(e){return e>=48&&e<=57}function LA(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function Fh(e){return"01234567".indexOf(e)>=0}function xpe(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function kh(e){return e===10||e===13||e===8232||e===8233}function Mh(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&vpe.test(String.fromCharCode(e))}function M1(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&bpe.test(String.fromCharCode(e))}const wpe={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function Q7(){for(;j<dn;){const e=K.charCodeAt(j);if(xpe(e)||kh(e))++j;else break}}function jA(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)j<dn&&LA(K[j])?(r=K[j++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):Le({},Bt,Kt);return String.fromCharCode(i)}function _pe(){var e,t,n,r;for(e=K[j],t=0,e==="}"&&Le({},Bt,Kt);j<dn&&(e=K[j++],!!LA(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&Le({},Bt,Kt),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function eP(){var e,t;for(e=K.charCodeAt(j++),t=String.fromCharCode(e),e===92&&(K.charCodeAt(j)!==117&&Le({},Bt,Kt),++j,e=jA("u"),(!e||e==="\\"||!Mh(e.charCodeAt(0)))&&Le({},Bt,Kt),t=e);j<dn&&(e=K.charCodeAt(j),!!M1(e));)++j,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),K.charCodeAt(j)!==117&&Le({},Bt,Kt),++j,e=jA("u"),(!e||e==="\\"||!M1(e.charCodeAt(0)))&&Le({},Bt,Kt),t+=e);return t}function Epe(){var e,t;for(e=j++;j<dn;){if(t=K.charCodeAt(j),t===92)return j=e,eP();if(M1(t))++j;else break}return K.slice(e,j)}function $pe(){var e,t,n;return e=j,t=K.charCodeAt(j)===92?eP():Epe(),t.length===1?n=yu:wpe.hasOwnProperty(t)?n=Ka:t==="null"?n=F1:t==="true"||t==="false"?n=O1:n=yu,{type:n,value:t,start:e,end:j}}function IA(){var e=j,t=K.charCodeAt(j),n,r=K[j],i,o,a;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++j,{type:Zn,value:String.fromCharCode(t),start:e,end:j};default:if(n=K.charCodeAt(j+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return j+=2,{type:Zn,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:j};case 33:case 61:return j+=2,K.charCodeAt(j)===61&&++j,{type:Zn,value:K.slice(e,j),start:e,end:j}}}if(a=K.substr(j,4),a===">>>=")return j+=4,{type:Zn,value:a,start:e,end:j};if(o=a.substr(0,3),o===">>>"||o==="<<="||o===">>=")return j+=3,{type:Zn,value:o,start:e,end:j};if(i=o.substr(0,2),r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>")return j+=2,{type:Zn,value:i,start:e,end:j};if(i==="//"&&Le({},Bt,Kt),"<>=!+-*%&|^/".indexOf(r)>=0)return++j,{type:Zn,value:r,start:e,end:j};Le({},Bt,Kt)}function Ape(e){let t="";for(;j<dn&&LA(K[j]);)t+=K[j++];return t.length===0&&Le({},Bt,Kt),Mh(K.charCodeAt(j))&&Le({},Bt,Kt),{type:vu,value:parseInt("0x"+t,16),start:e,end:j}}function Spe(e){let t="0"+K[j++];for(;j<dn&&Fh(K[j]);)t+=K[j++];return(Mh(K.charCodeAt(j))||Ko(K.charCodeAt(j)))&&Le({},Bt,Kt),{type:vu,value:parseInt(t,8),octal:!0,start:e,end:j}}function tP(){var e,t,n;if(n=K[j],k1(Ko(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=j,e="",n!=="."){if(e=K[j++],n=K[j],e==="0"){if(n==="x"||n==="X")return++j,Ape(t);if(Fh(n))return Spe(t);n&&Ko(n.charCodeAt(0))&&Le({},Bt,Kt)}for(;Ko(K.charCodeAt(j));)e+=K[j++];n=K[j]}if(n==="."){for(e+=K[j++];Ko(K.charCodeAt(j));)e+=K[j++];n=K[j]}if(n==="e"||n==="E")if(e+=K[j++],n=K[j],(n==="+"||n==="-")&&(e+=K[j++]),Ko(K.charCodeAt(j)))for(;Ko(K.charCodeAt(j));)e+=K[j++];else Le({},Bt,Kt);return Mh(K.charCodeAt(j))&&Le({},Bt,Kt),{type:vu,value:parseFloat(e),start:t,end:j}}function Cpe(){var e="",t,n,r,i,o=!1;for(t=K[j],k1(t==="'"||t==='"',"String literal must starts with a quote"),n=j,++j;j<dn;)if(r=K[j++],r===t){t="";break}else if(r==="\\")if(r=K[j++],!r||!kh(r.charCodeAt(0)))switch(r){case"u":case"x":K[j]==="{"?(++j,e+=_pe()):e+=jA(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:Fh(r)?(i="01234567".indexOf(r),i!==0&&(o=!0),j<dn&&Fh(K[j])&&(o=!0,i=i*8+"01234567".indexOf(K[j++]),"0123".indexOf(r)>=0&&j<dn&&Fh(K[j])&&(i=i*8+"01234567".indexOf(K[j++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&K[j]===`
`&&++j;else{if(kh(r.charCodeAt(0)))break;e+=r}return t!==""&&Le({},Bt,Kt),{type:Ch,value:e,octal:o,start:n,end:j}}function Ope(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(r,i)=>{if(parseInt(i,16)<=1114111)return"x";Le({},RA)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){Le({},RA)}try{return new RegExp(e,t)}catch(r){return null}}function Fpe(){var e,t,n,r,i;for(e=K[j],k1(e==="/","Regular expression literal must start with a slash"),t=K[j++],n=!1,r=!1;j<dn;)if(e=K[j++],t+=e,e==="\\")e=K[j++],kh(e.charCodeAt(0))&&Le({},PA),t+=e;else if(kh(e.charCodeAt(0)))Le({},PA);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||Le({},PA),i=t.substr(1,t.length-2),{value:i,literal:t}}function kpe(){var e,t,n;for(t="",n="";j<dn&&(e=K[j],!!M1(e.charCodeAt(0)));)++j,e==="\\"&&j<dn?Le({},Bt,Kt):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&Le({},RA,n),{value:n,literal:t}}function Mpe(){var e,t,n,r;return qe=null,Q7(),e=j,t=Fpe(),n=kpe(),r=Ope(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:j}}function Dpe(e){return e.type===yu||e.type===Ka||e.type===O1||e.type===F1}function nP(){if(Q7(),j>=dn)return{type:Sh,start:j,end:j};const e=K.charCodeAt(j);return Mh(e)?$pe():e===40||e===41||e===59?IA():e===39||e===34?Cpe():e===46?Ko(K.charCodeAt(j+1))?tP():IA():Ko(e)?tP():IA()}function Jn(){const e=qe;return j=e.end,qe=nP(),j=e.end,e}function rP(){const e=j;qe=nP(),j=e}function Npe(e){const t=new mi(npe);return t.elements=e,t}function iP(e,t,n){const r=new mi(e==="||"||e==="&&"?spe:rpe);return r.operator=e,r.left=t,r.right=n,r}function Tpe(e,t){const n=new mi(ipe);return n.callee=e,n.arguments=t,n}function Rpe(e,t,n){const r=new mi(ope);return r.test=e,r.consequent=t,r.alternate=n,r}function BA(e){const t=new mi(Z7);return t.name=e,t}function Dh(e){const t=new mi(ape);return t.value=e.value,t.raw=K.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function oP(e,t,n){const r=new mi(upe);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function Ppe(e){const t=new mi(lpe);return t.properties=e,t}function aP(e,t,n){const r=new mi(cpe);return r.key=t,r.value=n,r.kind=e,r}function Lpe(e,t){const n=new mi(fpe);return n.operator=e,n.argument=t,n.prefix=!0,n}function Le(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(o,a)=>(k1(a<r.length,"Message reference must be in range"),r[a]));throw n=new Error(i),n.index=j,n.description=i,n}function D1(e){e.type===Sh&&Le(e,mpe),e.type===vu&&Le(e,dpe),e.type===Ch&&Le(e,hpe),e.type===yu&&Le(e,gpe),e.type===Ka&&Le(e,ppe),Le(e,Bt,e.value)}function hn(e){const t=Jn();(t.type!==Zn||t.value!==e)&&D1(t)}function tt(e){return qe.type===Zn&&qe.value===e}function zA(e){return qe.type===Ka&&qe.value===e}function jpe(){const e=[];for(j=qe.start,hn("[");!tt("]");)tt(",")?(Jn(),e.push(null)):(e.push(bu()),tt("]")||hn(","));return Jn(),Npe(e)}function sP(){j=qe.start;const e=Jn();return e.type===Ch||e.type===vu?(e.octal&&Le(e,J7),Dh(e)):BA(e.value)}function Ipe(){var e,t,n,r;if(j=qe.start,e=qe,e.type===yu)return n=sP(),hn(":"),r=bu(),aP("init",n,r);if(e.type===Sh||e.type===Zn)D1(e);else return t=sP(),hn(":"),r=bu(),aP("init",t,r)}function Bpe(){var e=[],t,n,r,i={},o=String;for(j=qe.start,hn("{");!tt("}");)t=Ipe(),t.key.type===Z7?n=t.key.name:n=o(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?Le({},ype):i[r]=!0,e.push(t),tt("}")||hn(",");return hn("}"),Ppe(e)}function zpe(){hn("(");const e=UA();return hn(")"),e}const Upe={if:1};function qpe(){var e,t,n;if(tt("("))return zpe();if(tt("["))return jpe();if(tt("{"))return Bpe();if(e=qe.type,j=qe.start,e===yu||Upe[qe.value])n=BA(Jn().value);else if(e===Ch||e===vu)qe.octal&&Le(qe,J7),n=Dh(Jn());else{if(e===Ka)throw new Error(Oh);e===O1?(t=Jn(),t.value=t.value==="true",n=Dh(t)):e===F1?(t=Jn(),t.value=null,n=Dh(t)):tt("/")||tt("/=")?(n=Dh(Mpe()),rP()):D1(Jn())}return n}function Hpe(){const e=[];if(hn("("),!tt(")"))for(;j<dn&&(e.push(bu()),!tt(")"));)hn(",");return hn(")"),e}function Wpe(){j=qe.start;const e=Jn();return Dpe(e)||D1(e),BA(e.value)}function Gpe(){return hn("."),Wpe()}function Ype(){hn("[");const e=UA();return hn("]"),e}function Vpe(){var e,t,n;for(e=qpe();;)if(tt("."))n=Gpe(),e=oP(".",e,n);else if(tt("("))t=Hpe(),e=Tpe(e,t);else if(tt("["))n=Ype(),e=oP("[",e,n);else break;return e}function uP(){const e=Vpe();if(qe.type===Zn&&(tt("++")||tt("--")))throw new Error(Oh);return e}function N1(){var e,t;if(qe.type!==Zn&&qe.type!==Ka)t=uP();else{if(tt("++")||tt("--"))throw new Error(Oh);if(tt("+")||tt("-")||tt("~")||tt("!"))e=Jn(),t=N1(),t=Lpe(e.value,t);else{if(zA("delete")||zA("void")||zA("typeof"))throw new Error(Oh);t=uP()}}return t}function lP(e){let t=0;if(e.type!==Zn&&e.type!==Ka)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function Xpe(){var e,t,n,r,i,o,a,s,u,l;if(e=qe,u=N1(),r=qe,i=lP(r),i===0)return u;for(r.prec=i,Jn(),t=[e,qe],a=N1(),o=[u,r,a];(i=lP(qe))>0;){for(;o.length>2&&i<=o[o.length-2].prec;)a=o.pop(),s=o.pop().value,u=o.pop(),t.pop(),n=iP(s,u,a),o.push(n);r=Jn(),r.prec=i,o.push(r),t.push(qe),n=N1(),o.push(n)}for(l=o.length-1,n=o[l],t.pop();l>1;)t.pop(),n=iP(o[l-1].value,o[l-2],n),l-=2;return n}function bu(){var e,t,n;return e=Xpe(),tt("?")&&(Jn(),t=bu(),hn(":"),n=bu(),e=Rpe(e,t,n)),e}function UA(){const e=bu();if(tt(","))throw new Error(Oh);return e}function cP(e){K=e,j=0,dn=K.length,qe=null,rP();const t=UA();if(qe.type!==Sh)throw new Error("Unexpect token after expression.");return t}var fP={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function dP(e){function t(a,s,u,l){let c=e(s[0]);return u&&(c=u+"("+c+")",u.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+a+(l<0?"":l===0?"()":"("+s.slice(1).map(e).join(",")+")")}function n(a,s,u){return l=>t(a,l,s,u)}const r="new Date",i="String",o="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(a){a.length<3&&B("Missing arguments to clamp function."),a.length>3&&B("Too many arguments to clamp function.");const s=a.map(e);return"Math.max("+s[1]+", Math.min("+s[2]+","+s[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),trim:n("trim",i,0),regexp:o,test:n("test",o),if:function(a){a.length<3&&B("Missing arguments to if function."),a.length>3&&B("Too many arguments to if function.");const s=a.map(e);return"("+s[0]+"?"+s[1]+":"+s[2]+")"}}}function Kpe(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function hP(e){e=e||{};const t=e.allowed?oi(e.allowed):{},n=e.forbidden?oi(e.forbidden):{},r=e.constants||fP,i=(e.functions||dP)(f),o=e.globalvar,a=e.fieldvar,s=ye(o)?o:g=>`${o}["${g}"]`;let u={},l={},c=0;function f(g){if(Me(g))return g;const p=d[g.type];return p==null&&B("Unsupported type: "+g.type),p(g)}const d={Literal:g=>g.raw,Identifier:g=>{const p=g.name;return c>0?p:se(n,p)?B("Illegal identifier: "+p):se(r,p)?r[p]:se(t,p)?p:(u[p]=1,s(p))},MemberExpression:g=>{const p=!g.computed,m=f(g.object);p&&(c+=1);const y=f(g.property);return m===a&&(l[Kpe(y)]=1),p&&(c-=1),m+(p?"."+y:"["+y+"]")},CallExpression:g=>{g.callee.type!=="Identifier"&&B("Illegal callee type: "+g.callee.type);const p=g.callee.name,m=g.arguments,y=se(i,p)&&i[p];return y||B("Unrecognized function: "+p),ye(y)?y(m):y+"("+m.map(f).join(",")+")"},ArrayExpression:g=>"["+g.elements.map(f).join(",")+"]",BinaryExpression:g=>"("+f(g.left)+" "+g.operator+" "+f(g.right)+")",UnaryExpression:g=>"("+g.operator+f(g.argument)+")",ConditionalExpression:g=>"("+f(g.test)+"?"+f(g.consequent)+":"+f(g.alternate)+")",LogicalExpression:g=>"("+f(g.left)+g.operator+f(g.right)+")",ObjectExpression:g=>"{"+g.properties.map(f).join(",")+"}",Property:g=>{c+=1;const p=f(g.key);return c-=1,p+":"+f(g.value)}};function h(g){const p={code:f(g),globals:Object.keys(u),fields:Object.keys(l)};return u={},l={},p}return h.functions=i,h.constants=r,h}class Za{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const o=n[i],a=t+o,s=Math.abs(t)<Math.abs(o)?t-(a-o):o-(a-t);s&&(n[r++]=s),t=a}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,o,a=0;if(n>0){for(a=t[--n];n>0&&(r=a,i=t[--n],a=r+i,o=i-(a-r),!o););n>0&&(o<0&&t[n-1]<0||o>0&&t[n-1]>0)&&(i=o*2,r=a+i,i==r-a&&(a=r))}return a}}function Zpe(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(i);++r<i;)o[r]=e+r*n;return o}var T1=1e-6,gP=1e-12,Nh=Math.PI,pP=Nh/2,mP=Nh/4,yP=Nh*2,Th=180/Nh,gn=Nh/180,qA=Math.abs,R1=Math.atan2,kn=Math.cos,HA=Math.hypot,Mn=Math.sin,vP=Math.sqrt;function WA(e){return e>1?pP:e<-1?-pP:Math.asin(e)}function Rh(){}function P1(e,t){e&&xP.hasOwnProperty(e.type)&&xP[e.type](e,t)}var bP={Feature:function(e,t){P1(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)P1(n[r].geometry,t)}},xP={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){GA(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)GA(n[r],t,0)},Polygon:function(e,t){wP(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)wP(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)P1(n[r],t)}};function GA(e,t,n){var r=-1,i=e.length-n,o;for(t.lineStart();++r<i;)o=e[r],t.point(o[0],o[1],o[2]);t.lineEnd()}function wP(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)GA(e[n],t,1);t.polygonEnd()}function YA(e,t){e&&bP.hasOwnProperty(e.type)?bP[e.type](e,t):P1(e,t)}var L1=new Za,j1=new Za,_P,EP,VA,XA,KA,oo={point:Rh,lineStart:Rh,lineEnd:Rh,polygonStart:function(){L1=new Za,oo.lineStart=Jpe,oo.lineEnd=Qpe},polygonEnd:function(){var e=+L1;j1.add(e<0?yP+e:e),this.lineStart=this.lineEnd=this.point=Rh},sphere:function(){j1.add(yP)}};function Jpe(){oo.point=eme}function Qpe(){$P(_P,EP)}function eme(e,t){oo.point=$P,_P=e,EP=t,e*=gn,t*=gn,VA=e,XA=kn(t=t/2+mP),KA=Mn(t)}function $P(e,t){e*=gn,t*=gn,t=t/2+mP;var n=e-VA,r=n>=0?1:-1,i=r*n,o=kn(t),a=Mn(t),s=KA*a,u=XA*o+s*kn(i),l=s*r*Mn(i);L1.add(R1(l,u)),VA=e,XA=o,KA=a}function tme(e){return j1=new Za,YA(e,oo),j1*2}function nme(e){return[R1(e[1],e[0]),WA(e[2])]}function rme(e){var t=e[0],n=e[1],r=kn(n);return[r*kn(t),r*Mn(t),Mn(n)]}function AP(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function ime(e){var t=vP(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var st,Qn,ht,_r,xu,SP,CP,mc,Ph,Ja,Zo,Jo={point:ZA,lineStart:FP,lineEnd:kP,polygonStart:function(){Jo.point=MP,Jo.lineStart=ome,Jo.lineEnd=ame,Ph=new Za,oo.polygonStart()},polygonEnd:function(){oo.polygonEnd(),Jo.point=ZA,Jo.lineStart=FP,Jo.lineEnd=kP,L1<0?(st=-(ht=180),Qn=-(_r=90)):Ph>T1?_r=90:Ph<-T1&&(Qn=-90),Zo[0]=st,Zo[1]=ht},sphere:function(){st=-(ht=180),Qn=-(_r=90)}};function ZA(e,t){Ja.push(Zo=[st=e,ht=e]),t<Qn&&(Qn=t),t>_r&&(_r=t)}function OP(e,t){var n=rme([e*gn,t*gn]);if(mc){var r=AP(mc,n),i=[r[1],-r[0],0],o=AP(i,r);ime(o),o=nme(o);var a=e-xu,s=a>0?1:-1,u=o[0]*Th*s,l,c=qA(a)>180;c^(s*xu<u&&u<s*e)?(l=o[1]*Th,l>_r&&(_r=l)):(u=(u+360)%360-180,c^(s*xu<u&&u<s*e)?(l=-o[1]*Th,l<Qn&&(Qn=l)):(t<Qn&&(Qn=t),t>_r&&(_r=t))),c?e<xu?Er(st,e)>Er(st,ht)&&(ht=e):Er(e,ht)>Er(st,ht)&&(st=e):ht>=st?(e<st&&(st=e),e>ht&&(ht=e)):e>xu?Er(st,e)>Er(st,ht)&&(ht=e):Er(e,ht)>Er(st,ht)&&(st=e)}else Ja.push(Zo=[st=e,ht=e]);t<Qn&&(Qn=t),t>_r&&(_r=t),mc=n,xu=e}function FP(){Jo.point=OP}function kP(){Zo[0]=st,Zo[1]=ht,Jo.point=ZA,mc=null}function MP(e,t){if(mc){var n=e-xu;Ph.add(qA(n)>180?n+(n>0?360:-360):n)}else SP=e,CP=t;oo.point(e,t),OP(e,t)}function ome(){oo.lineStart()}function ame(){MP(SP,CP),oo.lineEnd(),qA(Ph)>T1&&(st=-(ht=180)),Zo[0]=st,Zo[1]=ht,mc=null}function Er(e,t){return(t-=e)<0?t+360:t}function sme(e,t){return e[0]-t[0]}function DP(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function ume(e){var t,n,r,i,o,a,s;if(_r=ht=-(st=Qn=1/0),Ja=[],YA(e,Jo),n=Ja.length){for(Ja.sort(sme),t=1,r=Ja[0],o=[r];t<n;++t)i=Ja[t],DP(r,i[0])||DP(r,i[1])?(Er(r[0],i[1])>Er(r[0],r[1])&&(r[1]=i[1]),Er(i[0],r[1])>Er(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(a=-1/0,n=o.length-1,t=0,r=o[n];t<=n;r=i,++t)i=o[t],(s=Er(r[1],i[0]))>a&&(a=s,st=i[0],ht=r[1])}return Ja=Zo=null,st===1/0||Qn===1/0?[[NaN,NaN],[NaN,NaN]]:[[st,Qn],[ht,_r]]}var Lh,I1,B1,z1,U1,q1,H1,W1,JA,QA,eS,NP,TP,Dn,Nn,Tn,yi={sphere:Rh,point:tS,lineStart:RP,lineEnd:PP,polygonStart:function(){yi.lineStart=fme,yi.lineEnd=dme},polygonEnd:function(){yi.lineStart=RP,yi.lineEnd=PP}};function tS(e,t){e*=gn,t*=gn;var n=kn(t);jh(n*kn(e),n*Mn(e),Mn(t))}function jh(e,t,n){++Lh,B1+=(e-B1)/Lh,z1+=(t-z1)/Lh,U1+=(n-U1)/Lh}function RP(){yi.point=lme}function lme(e,t){e*=gn,t*=gn;var n=kn(t);Dn=n*kn(e),Nn=n*Mn(e),Tn=Mn(t),yi.point=cme,jh(Dn,Nn,Tn)}function cme(e,t){e*=gn,t*=gn;var n=kn(t),r=n*kn(e),i=n*Mn(e),o=Mn(t),a=R1(vP((a=Nn*o-Tn*i)*a+(a=Tn*r-Dn*o)*a+(a=Dn*i-Nn*r)*a),Dn*r+Nn*i+Tn*o);I1+=a,q1+=a*(Dn+(Dn=r)),H1+=a*(Nn+(Nn=i)),W1+=a*(Tn+(Tn=o)),jh(Dn,Nn,Tn)}function PP(){yi.point=tS}function fme(){yi.point=hme}function dme(){LP(NP,TP),yi.point=tS}function hme(e,t){NP=e,TP=t,e*=gn,t*=gn,yi.point=LP;var n=kn(t);Dn=n*kn(e),Nn=n*Mn(e),Tn=Mn(t),jh(Dn,Nn,Tn)}function LP(e,t){e*=gn,t*=gn;var n=kn(t),r=n*kn(e),i=n*Mn(e),o=Mn(t),a=Nn*o-Tn*i,s=Tn*r-Dn*o,u=Dn*i-Nn*r,l=HA(a,s,u),c=WA(l),f=l&&-c/l;JA.add(f*a),QA.add(f*s),eS.add(f*u),I1+=c,q1+=c*(Dn+(Dn=r)),H1+=c*(Nn+(Nn=i)),W1+=c*(Tn+(Tn=o)),jh(Dn,Nn,Tn)}function gme(e){Lh=I1=B1=z1=U1=q1=H1=W1=0,JA=new Za,QA=new Za,eS=new Za,YA(e,yi);var t=+JA,n=+QA,r=+eS,i=HA(t,n,r);return i<gP&&(t=q1,n=H1,r=W1,I1<T1&&(t=B1,n=z1,r=U1),i=HA(t,n,r),i<gP)?[NaN,NaN]:[R1(n,t)*Th,WA(r/i)*Th]}function Ih(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function G1(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function wu(){}var Bh=.7,Y1=1/Bh,yc="\\s*([+-]?\\d+)\\s*",zh="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",ao="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",pme=/^#([0-9a-f]{3,8})$/,mme=new RegExp("^rgb\\("+[yc,yc,yc]+"\\)$"),yme=new RegExp("^rgb\\("+[ao,ao,ao]+"\\)$"),vme=new RegExp("^rgba\\("+[yc,yc,yc,zh]+"\\)$"),bme=new RegExp("^rgba\\("+[ao,ao,ao,zh]+"\\)$"),xme=new RegExp("^hsl\\("+[zh,ao,ao]+"\\)$"),wme=new RegExp("^hsla\\("+[zh,ao,ao,zh]+"\\)$"),jP={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ih(wu,nS,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:IP,formatHex:IP,formatHsl:_me,formatRgb:BP,toString:BP});function IP(){return this.rgb().formatHex()}function _me(){return GP(this).formatHsl()}function BP(){return this.rgb().formatRgb()}function nS(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=pme.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?zP(t):n===3?new Rn(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?V1(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?V1(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=mme.exec(e))?new Rn(t[1],t[2],t[3],1):(t=yme.exec(e))?new Rn(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=vme.exec(e))?V1(t[1],t[2],t[3],t[4]):(t=bme.exec(e))?V1(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=xme.exec(e))?WP(t[1],t[2]/100,t[3]/100,1):(t=wme.exec(e))?WP(t[1],t[2]/100,t[3]/100,t[4]):jP.hasOwnProperty(e)?zP(jP[e]):e==="transparent"?new Rn(NaN,NaN,NaN,0):null}function zP(e){return new Rn(e>>16&255,e>>8&255,e&255,1)}function V1(e,t,n,r){return r<=0&&(e=t=n=NaN),new Rn(e,t,n,r)}function UP(e){return e instanceof wu||(e=nS(e)),e?(e=e.rgb(),new Rn(e.r,e.g,e.b,e.opacity)):new Rn}function rS(e,t,n,r){return arguments.length===1?UP(e):new Rn(e,t,n,r==null?1:r)}function Rn(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Ih(Rn,rS,G1(wu,{brighter:function(e){return e=e==null?Y1:Math.pow(Y1,e),new Rn(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?Bh:Math.pow(Bh,e),new Rn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:qP,formatHex:qP,formatRgb:HP,toString:HP}));function qP(){return"#"+iS(this.r)+iS(this.g)+iS(this.b)}function HP(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function iS(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function WP(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new so(e,t,n,r)}function GP(e){if(e instanceof so)return new so(e.h,e.s,e.l,e.opacity);if(e instanceof wu||(e=nS(e)),!e)return new so;if(e instanceof so)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(t===o?a=(n-r)/s+(n<r)*6:n===o?a=(r-t)/s+2:a=(t-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new so(a,s,u,e.opacity)}function YP(e,t,n,r){return arguments.length===1?GP(e):new so(e,t,n,r==null?1:r)}function so(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Ih(so,YP,G1(wu,{brighter:function(e){return e=e==null?Y1:Math.pow(Y1,e),new so(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Bh:Math.pow(Bh,e),new so(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Rn(oS(e>=240?e-240:e+120,i,r),oS(e,i,r),oS(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function oS(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Eme=Math.PI/180,$me=180/Math.PI,X1=18,VP=.96422,XP=1,KP=.82521,ZP=4/29,vc=6/29,JP=3*vc*vc,Ame=vc*vc*vc;function QP(e){if(e instanceof uo)return new uo(e.l,e.a,e.b,e.opacity);if(e instanceof Qo)return nL(e);e instanceof Rn||(e=UP(e));var t=lS(e.r),n=lS(e.g),r=lS(e.b),i=aS((.2225045*t+.7168786*n+.0606169*r)/XP),o,a;return t===n&&n===r?o=a=i:(o=aS((.4360747*t+.3850649*n+.1430804*r)/VP),a=aS((.0139322*t+.0971045*n+.7141733*r)/KP)),new uo(116*i-16,500*(o-i),200*(i-a),e.opacity)}function eL(e,t,n,r){return arguments.length===1?QP(e):new uo(e,t,n,r==null?1:r)}function uo(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}Ih(uo,eL,G1(wu,{brighter:function(e){return new uo(this.l+X1*(e==null?1:e),this.a,this.b,this.opacity)},darker:function(e){return new uo(this.l-X1*(e==null?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=VP*sS(t),e=XP*sS(e),n=KP*sS(n),new Rn(uS(3.1338561*t-1.6168667*e-.4906146*n),uS(-.9787684*t+1.9161415*e+.033454*n),uS(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function aS(e){return e>Ame?Math.pow(e,1/3):e/JP+ZP}function sS(e){return e>vc?e*e*e:JP*(e-ZP)}function uS(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function lS(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Sme(e){if(e instanceof Qo)return new Qo(e.h,e.c,e.l,e.opacity);if(e instanceof uo||(e=QP(e)),e.a===0&&e.b===0)return new Qo(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*$me;return new Qo(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function tL(e,t,n,r){return arguments.length===1?Sme(e):new Qo(e,t,n,r==null?1:r)}function Qo(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function nL(e){if(isNaN(e.h))return new uo(e.l,0,0,e.opacity);var t=e.h*Eme;return new uo(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Ih(Qo,tL,G1(wu,{brighter:function(e){return new Qo(this.h,this.c,this.l+X1*(e==null?1:e),this.opacity)},darker:function(e){return new Qo(this.h,this.c,this.l-X1*(e==null?1:e),this.opacity)},rgb:function(){return nL(this).rgb()}}));function Cme(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Ome(e){let t=e,n=e;e.length===1&&(t=(a,s)=>e(a)-s,n=Fme(e));function r(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)<0?u=c+1:l=c}return u}function i(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)>0?l=c:u=c+1}return u}function o(a,s,u,l){u==null&&(u=0),l==null&&(l=a.length);const c=r(a,s,u,l-1);return c>u&&t(a[c-1],s)>-t(a[c],s)?c-1:c}return{left:r,center:o,right:i}}function Fme(e){return(t,n)=>Cme(e(t),n)}const cS="intersect",rL="union",kme="vlMulti",Mme="vlPoint",iL="or",Dme="and",Nme="_vgsid_",Tme="E",Rme="R",Pme="R-E",Lme="R-LE",jme="R-RE",K1="index:unit";function oL(e,t){for(var n=t.fields,r=t.values,i=n.length,o=0,a,s;o<i;++o)if(s=n[o],s.getter=Hn.getter||Hn(s.field),a=s.getter(e),wa(a)&&(a=nn(a)),wa(r[o])&&(r[o]=nn(r[o])),wa(r[o][0])&&(r[o]=r[o].map(nn)),s.type===Tme){if(ee(r[o])?r[o].indexOf(a)<0:a!==r[o])return!1}else if(s.type===Rme){if(!wl(a,r[o]))return!1}else if(s.type===jme){if(!wl(a,r[o],!0,!1))return!1}else if(s.type===Pme){if(!wl(a,r[o],!1,!1))return!1}else if(s.type===Lme&&!wl(a,r[o],!1,!0))return!1;return!0}function Ime(e,t,n){for(var r=this.context.data[e],i=r?r.values.value:[],o=r?r[K1]&&r[K1].value:void 0,a=n===cS,s=i.length,u=0,l,c,f,d,h;u<s;++u)if(l=i[u],o&&a){if(c=c||{},f=c[d=l.unit]||0,f===-1)continue;if(h=oL(t,l),c[d]=h?-1:++f,h&&o.size===1)return!0;if(!h&&f===o.get(d).count)return!1}else if(h=oL(t,l),a^h)return h;return s&&a}const fS=Hn(Nme),aL=Ome(fS),Bme=aL.left,zme=aL.right;function Ume(e,t,n){const r=this.context.data[e],i=r?r.values.value:[],o=r?r[K1]&&r[K1].value:void 0,a=n===cS,s=fS(t),u=Bme(i,s);if(u===i.length||fS(i[u])!==s)return!1;if(o&&a){if(o.size===1)return!0;if(zme(i,s)-u<o.size)return!1}return!0}function qme(e,t){return e.map(n=>pe({values:t.fields.map(r=>(r.getter||(r.getter=Hn(r.field)))(n.datum))},t))}function Hme(e,t,n,r){for(var i=this.context.data[e],o=i?i.values.value:[],a={},s={},u={},l,c,f,d,h,g,p,m,y,v=o.length,b=0,x,w;b<v;++b){for(l=o[b],d=l.unit,c=l.fields,f=l.values,x=0,w=c.length;x<w;++x)h=c[x],g=a[h.field]||(a[h.field]={}),p=g[d]||(g[d]=[]),u[h.field]=m=h.type.charAt(0),y=sL[m+"_union"],g[d]=y(p,ae(f[x]));n&&(p=s[d]||(s[d]=[]),p.push(ae(f).reduce((E,_,S)=>(E[c[S].field]=_,E),{})))}if(t=t||rL,Object.keys(a).forEach(E=>{a[E]=Object.keys(a[E]).map(_=>a[E][_]).reduce((_,S)=>_===void 0?S:sL[u[E]+"_"+t](_,S))}),o=Object.keys(s),n&&o.length){const E=r?Mme:kme;a[E]=t===rL?{[iL]:o.reduce((_,S)=>(_.push(...s[S]),_),[])}:{[Dme]:o.map(_=>({[iL]:s[_]}))}}return a}var sL={E_union:function(e,t){if(!e.length)return t;for(var n=0,r=t.length;n<r;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.indexOf(n)>=0):t},R_union:function(e,t){var n=nn(t[0]),r=nn(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<r&&(e[1]=r),e):[n,r]},R_intersect:function(e,t){var n=nn(t[0]),r=nn(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?r<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>r&&(e[1]=r),e):[n,r]}};const Wme=":",Gme="@";function dS(e,t,n,r){t[0].type!==mu&&B("First argument to selection functions must be a string literal.");const i=t[0].value,o=t.length>=2&&Se(t).value,a="unit",s=Gme+a,u=Wme+i;o===cS&&!se(r,s)&&(r[s]=n.getData(i).indataRef(n,a)),se(r,u)||(r[u]=n.getData(i).tuplesRef())}function uL(e){const t=this.context.data[e];return t?t.values.value:[]}function Yme(e,t,n){const r=this.context.data[e]["index:"+t],i=r?r.value.get(n):void 0;return i&&i.count}function Vme(e,t){const n=this.context.dataflow,r=this.context.data[e],i=r.input;return n.pulse(i,n.changeset().remove(Dr).insert(t)),1}function Xme(e,t,n){if(e){const r=this.context.dataflow,i=e.mark.source;r.pulse(i,r.changeset().encode(e,t))}return n!==void 0?n:e}const Uh=e=>function(t,n){return this.context.dataflow.locale()[e](n)(t)},Kme=Uh("format"),lL=Uh("timeFormat"),Zme=Uh("utcFormat"),Jme=Uh("timeParse"),Qme=Uh("utcParse"),Z1=new Date(2e3,0,1);function J1(e,t,n){return!Number.isInteger(e)||!Number.isInteger(t)?"":(Z1.setYear(2e3),Z1.setMonth(e),Z1.setDate(t),lL.call(this,Z1,n))}function e1e(e){return J1.call(this,e,1,"%B")}function t1e(e){return J1.call(this,e,1,"%b")}function n1e(e){return J1.call(this,0,2+e,"%A")}function r1e(e){return J1.call(this,0,2+e,"%a")}const i1e=":",o1e="@",hS="%",cL="$";function gS(e,t,n,r){t[0].type!==mu&&B("First argument to data functions must be a string literal.");const i=t[0].value,o=i1e+i;if(!se(o,r))try{r[o]=n.getData(i).tuplesRef()}catch(a){}}function a1e(e,t,n,r){t[0].type!==mu&&B("First argument to indata must be a string literal."),t[1].type!==mu&&B("Second argument to indata must be a string literal.");const i=t[0].value,o=t[1].value,a=o1e+o;se(a,r)||(r[a]=n.getData(i).indataRef(n,o))}function er(e,t,n,r){if(t[0].type===mu)fL(n,r,t[0].value);else for(e in n.scales)fL(n,r,e)}function fL(e,t,n){const r=hS+n;if(!se(t,r))try{t[r]=e.scaleRef(n)}catch(i){}}function ea(e,t){let n;return ye(e)?e:Me(e)?(n=t.scales[e])&&n.value:void 0}function s1e(e,t,n){t.__bandwidth=i=>i&&i.bandwidth?i.bandwidth():0,n._bandwidth=er,n._range=er,n._scale=er;const r=i=>"_["+(i.type===mu?re(hS+i.value):re(hS)+"+"+e(i))+"]";return{_bandwidth:i=>`this.__bandwidth(${r(i[0])})`,_range:i=>`${r(i[0])}.range()`,_scale:i=>`${r(i[0])}(${e(i[1])})`}}function pS(e,t){return function(n,r,i){if(n){const o=ea(n,(i||this).context);return o&&o.path[e](r)}else return t(r)}}const u1e=pS("area",tme),l1e=pS("bounds",ume),c1e=pS("centroid",gme);function f1e(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function mS(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(r){e.warn(r)}return n[n.length-1]}function d1e(){return mS(this.context.dataflow,"warn",arguments)}function h1e(){return mS(this.context.dataflow,"info",arguments)}function g1e(){return mS(this.context.dataflow,"debug",arguments)}function yS(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function vS(e){const t=rS(e),n=yS(t.r),r=yS(t.g),i=yS(t.b);return .2126*n+.7152*r+.0722*i}function p1e(e,t){const n=vS(e),r=vS(t),i=Math.max(n,r),o=Math.min(n,r);return(i+.05)/(o+.05)}function m1e(){const e=[].slice.call(arguments);return e.unshift({}),pe(...e)}function dL(e,t){return e===t||e!==e&&t!==t?!0:ee(e)?ee(t)&&e.length===t.length?y1e(e,t):!1:le(e)&&le(t)?hL(e,t):!1}function y1e(e,t){for(let n=0,r=e.length;n<r;++n)if(!dL(e[n],t[n]))return!1;return!0}function hL(e,t){for(const n in e)if(!dL(e[n],t[n]))return!1;return!0}function gL(e){return t=>hL(e,t)}function v1e(e,t,n,r,i,o){const a=this.context.dataflow,s=this.context.data[e],u=s.input,l=a.stamp();let c=s.changes,f,d;if(a._trigger===!1||!(u.value.length||t||r))return 0;if((!c||c.stamp<l)&&(s.changes=c=a.changeset(),c.stamp=l,a.runAfter(()=>{s.modified=!0,a.pulse(u,c).run()},!0,1)),n&&(f=n===!0?Dr:ee(n)||ap(n)?n:gL(n),c.remove(f)),t&&c.insert(t),r&&(f=gL(r),u.value.some(f)?c.remove(f):c.insert(r)),i)for(d in o)c.modify(i,d,o[d]);return 1}function b1e(e){const t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+r*r)}function x1e(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}const pL={};function w1e(e,t){const n=pL[t]||(pL[t]=Hn(t));return ee(e)?e.map(n):n(e)}function bS(e){return ee(e)||ArrayBuffer.isView(e)?e:null}function xS(e){return bS(e)||(Me(e)?e:null)}function _1e(e,...t){return bS(e).join(...t)}function E1e(e,...t){return xS(e).indexOf(...t)}function $1e(e,...t){return xS(e).lastIndexOf(...t)}function A1e(e,...t){return xS(e).slice(...t)}function S1e(e,t,n){return ye(n)&&B("Function argument passed to replace."),String(e).replace(t,n)}function C1e(e){return bS(e).slice().reverse()}function O1e(e,t,n){return g_(e||0,t||0,n||0)}function F1e(e,t){const n=ea(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function k1e(e,t){const n=ea(e,(t||this).context);return n?n.copy():void 0}function M1e(e,t){const n=ea(e,(t||this).context);return n?n.domain():[]}function D1e(e,t,n){const r=ea(e,(n||this).context);return r?ee(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t):void 0}function N1e(e,t){const n=ea(e,(t||this).context);return n&&n.range?n.range():[]}function T1e(e,t,n){const r=ea(e,(n||this).context);return r?r(t):void 0}function R1e(e,t,n,r,i){e=ea(e,(i||this).context);const o=Q6(t,n);let a=e.domain(),s=a[0],u=Se(a),l=En;return u-s?l=j6(e,s,u):e=(e.interpolator?Pe("sequential")().interpolator(e.interpolator()):Pe("linear")().interpolate(e.interpolate()).range(e.range())).domain([s=0,u=1]),e.ticks&&(a=e.ticks(+r||15),s!==a[0]&&a.unshift(s),u!==Se(a)&&a.push(u)),a.forEach(c=>o.stop(l(c),e(c))),o}function P1e(e,t,n){const r=ea(e,(n||this).context);return function(i){return r?r.path.context(i)(t):""}}function L1e(e){let t=null;return function(n){return n?Cd(n,t=t||Hl(e)):e}}const mL=e=>e.data;function yL(e,t){const n=uL.call(t,e);return n.root&&n.root.lookup||{}}function j1e(e,t,n){const r=yL(e,this),i=r[t],o=r[n];return i&&o?i.path(o).map(mL):void 0}function I1e(e,t){const n=yL(e,this)[t];return n?n.ancestors().map(mL):void 0}const vL=()=>typeof window!="undefined"&&window||null;function B1e(){const e=vL();return e?e.screen:{}}function z1e(){const e=vL();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function U1e(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function q1e(e,t,n){if(!e)return[];const[r,i]=e,o=new Ot().set(r[0],r[1],i[0],i[1]),a=n||this.context.dataflow.scenegraph().root;return h4(a,o,H1e(t))}function H1e(e){let t=null;if(e){const n=ae(e.marktype),r=ae(e.markname);t=i=>(!n.length||n.some(o=>i.marktype===o))&&(!r.length||r.some(o=>i.name===o))}return t}const qh={random(){return Tr()},cumulativeNormal:gp,cumulativeLogNormal:_2,cumulativeUniform:S2,densityNormal:y2,densityLogNormal:w2,densityUniform:A2,quantileNormal:pp,quantileLogNormal:E2,quantileUniform:C2,sampleNormal:hp,sampleLogNormal:x2,sampleUniform:$2,isArray:ee,isBoolean:$x,isDate:wa,isDefined(e){return e!==void 0},isNumber:_a,isObject:le,isRegExp:SM,isString:Me,isTuple:ap,isValid(e){return e!=null&&e===e},toBoolean:Sx,toDate:Cx,toNumber:nn,toString:Ox,indexof:E1e,join:_1e,lastindexof:$1e,replace:S1e,reverse:C1e,slice:A1e,flush:$M,lerp:CM,merge:m1e,pad:kM,peek:Se,pluck:w1e,span:Tf,inrange:wl,truncate:MM,rgb:rS,lab:eL,hcl:tL,hsl:YP,luminance:vS,contrast:p1e,sequence:Zpe,format:Kme,utcFormat:Zme,utcParse:Qme,utcOffset:gD,utcSequence:yD,timeFormat:lL,timeParse:Jme,timeOffset:hD,timeSequence:mD,timeUnitSpecifier:nD,monthFormat:e1e,monthAbbrevFormat:t1e,dayFormat:n1e,dayAbbrevFormat:r1e,quarter:xM,utcquarter:wM,week:iD,utcweek:sD,dayofyear:rD,utcdayofyear:aD,warn:d1e,info:h1e,debug:g1e,extent:ji,inScope:f1e,intersect:q1e,clampRange:_M,pinchDistance:b1e,pinchAngle:x1e,screen:B1e,containerSize:U1e,windowSize:z1e,bandspace:O1e,setdata:Vme,pathShape:L1e,panLinear:mM,panLog:yM,panPow:vM,panSymlog:bM,zoomLinear:bx,zoomLog:xx,zoomPow:Gg,zoomSymlog:wx,encode:Xme,modify:v1e},W1e=["view","item","group","xy","x","y"],G1e="event.vega.",bL="this.",wS={},xL={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${re(cL+e)}]`,functions:Y1e,constants:fP,visitors:wS},_S=hP(xL);function Y1e(e){const t=dP(e);W1e.forEach(n=>t[n]=G1e+n);for(const n in qh)t[n]=bL+n;return pe(t,s1e(e,qh,wS)),t}function _t(e,t,n){return arguments.length===1?qh[e]:(qh[e]=t,n&&(wS[e]=n),_S&&(_S.functions[e]=bL+e),this)}_t("bandwidth",F1e,er);_t("copy",k1e,er);_t("domain",M1e,er);_t("range",N1e,er);_t("invert",D1e,er);_t("scale",T1e,er);_t("gradient",R1e,er);_t("geoArea",u1e,er);_t("geoBounds",l1e,er);_t("geoCentroid",c1e,er);_t("geoShape",P1e,er);_t("indata",Yme,a1e);_t("data",uL,gS);_t("treePath",j1e,gS);_t("treeAncestors",I1e,gS);_t("vlSelectionTest",Ime,dS);_t("vlSelectionIdTest",Ume,dS);_t("vlSelectionResolve",Hme,dS);_t("vlSelectionTuples",qme);function lo(e,t){const n={};let r;try{e=Me(e)?e:re(e)+"",r=cP(e)}catch(o){B("Expression parse error: "+e)}r.visit(o=>{if(o.type!==K7)return;const a=o.callee.name,s=xL.visitors[a];s&&s(a,o.arguments,t,n)});const i=_S(r);return i.globals.forEach(o=>{const a=cL+o;!se(n,a)&&t.getSignal(o)&&(n[a]=t.signalRef(o))}),{$expr:pe({code:i.code},t.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}function V1e(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(r=>t.parseOperator(r)),n.forEach(r=>t.parseOperatorParameters(r)),(e.streams||[]).forEach(r=>t.parseStream(r)),(e.updates||[]).forEach(r=>t.parseUpdate(r)),t.resolve()}const X1e=oi(["rule"]),wL=oi(["group","image","rect"]);function K1e(e,t){let n="";return X1e[t]||(e.x2&&(e.x?(wL[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(wL[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function ES(e){return(e+"").toLowerCase()}function Z1e(e){return ES(e)==="operator"}function J1e(e){return ES(e)==="collect"}function Hh(e,t,n){n[n.length-1]!==";"&&(n="return("+n+");");const r=Function(...t.concat(n));return e&&e.functions?r.bind(e.functions):r}function Q1e(e,t,n,r){return"((u = ".concat(e,") < (v = ").concat(t,") || u == null) && v != null ? ").concat(n,`
  : (u > v || v == null) && u != null ? `).concat(r,`
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? `).concat(n,`
  : v !== v && u === u ? `).concat(r," : ")}var eye={operator:(e,t)=>Hh(e,["_"],t.code),parameter:(e,t)=>Hh(e,["datum","_"],t.code),event:(e,t)=>Hh(e,["event"],t.code),handler:(e,t)=>{const n="var datum=event.item&&event.item.datum;return ".concat(t.code,";");return Hh(e,["_","event"],n)},encode:(e,t)=>{const{marktype:n,channels:r}=t;let i="var o=item,datum=o.datum,m=0,$;";for(const o in r){const a="o["+re(o)+"]";i+="$=".concat(r[o].code,";if(").concat(a,"!==$)").concat(a,"=$,m=1;")}return i+=K1e(r,n),i+="return m;",Hh(e,["item","_"],i)},codegen:{get(e){const t="[".concat(e.map(re).join("]["),"]"),n=Function("_","return _".concat(t,";"));return n.path=t,n},comparator(e,t){let n;const r=(o,a)=>{const s=t[a];let u,l;return o.path?(u="a".concat(o.path),l="b".concat(o.path)):((n=n||{})["f"+a]=o,u="this.f".concat(a,"(a)"),l="this.f".concat(a,"(b)")),Q1e(u,l,-s,s)},i=Function("a","b","var u, v; return "+e.map(r).join("")+"0;");return n?i.bind(n):i}}};function tye(e){const t=this;Z1e(e.type)||!e.type?t.operator(e,e.update?t.operatorExpression(e.update):null):t.transform(e,e.type)}function nye(e){const t=this;if(e.params){const n=t.get(e.id);n||B("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}}function rye(e,t){t=t||{};const n=this;for(const r in e){const i=e[r];t[r]=ee(i)?i.map(o=>_L(o,n,t)):_L(i,n,t)}return t}function _L(e,t,n){if(!e||!le(e))return e;for(let r=0,i=EL.length,o;r<i;++r)if(o=EL[r],se(e,o.key))return o.parse(e,t,n);return e}var EL=[{key:"$ref",parse:iye},{key:"$key",parse:aye},{key:"$expr",parse:oye},{key:"$field",parse:sye},{key:"$encode",parse:lye},{key:"$compare",parse:uye},{key:"$context",parse:cye},{key:"$subflow",parse:fye},{key:"$tupleid",parse:dye}];function iye(e,t){return t.get(e.$ref)||B("Operator not defined: "+e.$ref)}function oye(e,t,n){e.$params&&t.parseParameters(e.$params,n);const r="e:"+e.$expr.code+"_"+e.$name;return t.fn[r]||(t.fn[r]=qn(t.parameterExpression(e.$expr),e.$fields,e.$name))}function aye(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=Ax(e.$key,e.$flat,t.expr.codegen))}function sye(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=Hn(e.$field,e.$name,t.expr.codegen))}function uye(e,t){const n="c:"+e.$compare+"_"+e.$order,r=ae(e.$compare).map(i=>i&&i.$tupleid?te:i);return t.fn[n]||(t.fn[n]=_x(r,e.$order,t.expr.codegen))}function lye(e,t){const n=e.$encode,r={};for(const i in n){const o=n[i];r[i]=qn(t.encodeExpression(o.$expr),o.$fields),r[i].output=o.$output}return r}function cye(e,t){return t}function fye(e,t){const n=e.$subflow;return function(r,i,o){const a=t.fork().parse(n),s=a.get(n.operators[0].id),u=a.signals.parent;return u&&u.set(o),s.detachSubflow=()=>t.detach(a),s}}function dye(){return te}function hye(e){var t=this,n=e.filter!=null?t.eventExpression(e.filter):void 0,r=e.stream!=null?t.get(e.stream):void 0,i;e.source?r=t.events(e.source,e.type,n):e.merge&&(i=e.merge.map(o=>t.get(o)),r=i[0].merge.apply(i[0],i.slice(1))),e.between&&(i=e.between.map(o=>t.get(o)),r=r.between(i[0],i[1])),e.filter&&(r=r.filter(n)),e.throttle!=null&&(r=r.throttle(+e.throttle)),e.debounce!=null&&(r=r.debounce(+e.debounce)),r==null&&B("Invalid stream definition: "+JSON.stringify(e)),e.consume&&r.consume(!0),t.stream(e,r)}function gye(e){var t=this,n=le(n=e.source)?n.$ref:n,r=t.get(n),i=null,o=e.update,a=void 0;r||B("Source not defined: "+e.source),i=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),o&&o.$expr&&(o.$params&&(a=t.parseParameters(o.$params)),o=t.handlerExpression(o.$expr)),t.update(e,r,i,o,a)}const pye={skip:!0};function mye(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach(o=>{const a=t.signals[o];e.signals(o,a)&&(r[o]=a.value)})}if(e.data){var i=n.data={};Object.keys(t.data).forEach(o=>{const a=t.data[o];e.data(o,a)&&(i[o]=a.input.value)})}return t.subcontext&&e.recurse!==!1&&(n.subcontext=t.subcontext.map(o=>o.getState(e))),n}function yye(e){var t=this,n=t.dataflow,r=e.data,i=e.signals;Object.keys(i||{}).forEach(o=>{n.update(t.signals[o],i[o],pye)}),Object.keys(r||{}).forEach(o=>{n.pulse(t.data[o].input,n.changeset().remove(Dr).insert(r[o]))}),(e.subcontext||[]).forEach((o,a)=>{const s=t.subcontext[a];s&&s.setState(o)})}function $L(e,t,n,r){return new AL(e,t,n,r)}function AL(e,t,n,r){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=r||eye,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function SL(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}AL.prototype=SL.prototype={fork(){const e=new SL(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,r=n.dataflow,i=e.value;if(n.set(e.id,t),J1e(e.type)&&i&&(i.$ingest?r.ingest(t,i.$ingest,i.$format):i.$request?r.preload(t,i.$request,i.$format):r.pulse(t,r.changeset().insert(i))),e.root&&(n.root=t),e.parent){let o=n.get(e.parent.$ref);o?(r.connect(o,[t]),t.targets().add(o)):(n.unresolved=n.unresolved||[]).push(()=>{o=n.get(e.parent.$ref),r.connect(o,[t]),t.targets().add(o)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const o in e.data){const a=n.data[o]||(n.data[o]={});e.data[o].forEach(s=>a[s]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[ES(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,r,i){this.dataflow.on(t,n,r,i,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:V1e,parseOperator:tye,parseOperatorParameters:nye,parseParameters:rye,parseStream:hye,parseUpdate:gye,getState:mye,setState:yye};var bc=0,Wh=0,Gh=0,CL=1e3,Q1,Yh,ey=0,_u=0,ty=0,Vh=typeof performance=="object"&&performance.now?performance:Date,OL=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function $S(){return _u||(OL(vye),_u=Vh.now()+ty)}function vye(){_u=0}function AS(){this._call=this._time=this._next=null}AS.prototype={constructor:AS,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?$S():+n)+(t==null?0:+t),!this._next&&Yh!==this&&(Yh?Yh._next=this:Q1=this,Yh=this),this._call=e,this._time=n,SS()},stop:function(){this._call&&(this._call=null,this._time=1/0,SS())}};function bye(){$S(),++bc;for(var e=Q1,t;e;)(t=_u-e._time)>=0&&e._call.call(null,t),e=e._next;--bc}function FL(){_u=(ey=Vh.now())+ty,bc=Wh=0;try{bye()}finally{bc=0,wye(),_u=0}}function xye(){var e=Vh.now(),t=e-ey;t>CL&&(ty-=t,ey=e)}function wye(){for(var e,t=Q1,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Q1=n);Yh=e,SS(r)}function SS(e){if(!bc){Wh&&(Wh=clearTimeout(Wh));var t=e-_u;t>24?(e<1/0&&(Wh=setTimeout(FL,e-Vh.now()-ty)),Gh&&(Gh=clearInterval(Gh))):(Gh||(ey=Vh.now(),Gh=setInterval(xye,CL)),bc=1,OL(FL))}}function _ye(e,t,n){var r=new AS,i=t;return t==null?(r.restart(e,t,n),r):(r._restart=r.restart,r.restart=function(o,a,s){a=+a,s=s==null?$S():+s,r._restart(function u(l){l+=i,r._restart(u,i+=a,s),o(l)},a,s)},r.restart(e,t,n),r)}function Eye(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),kL(t,e.description()))}function kL(e,t){e&&(t==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}function $ye(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}const CS="default";function Aye(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:CS,item:null}));e.on(e.events("view","mousemove"),t,(n,r)=>{const i=t.value,o=i?Me(i)?i:i.user:CS,a=r.item&&r.item.cursor||null;return i&&o===i.user&&a==i.item?i:{user:o,item:a}}),e.add(null,function(n){let r=n.cursor,i=this.value;return Me(r)||(i=r.item,r=r.user),OS(e,r&&r!==CS?r:i||r),i},{cursor:t})}function OS(e,t){const n=e.globalCursor()?typeof document!="undefined"&&document.body:e.container();if(n)return t==null?n.style.removeProperty("cursor"):n.style.cursor=t}function ny(e,t){var n=e._runtime.data;return se(n,t)||B("Unrecognized data set: "+t),n[t]}function Sye(e,t){return arguments.length<2?ny(this,e).values.value:ry.call(this,e,Us().remove(Dr).insert(t))}function ry(e,t){d5(t)||B("Second argument to changes must be a changeset.");const n=ny(this,e);return n.modified=!0,this.pulse(n.input,t)}function Cye(e,t){return ry.call(this,e,Us().insert(t))}function Oye(e,t){return ry.call(this,e,Us().remove(t))}function ML(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function DL(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function iy(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function Fye(e){var t=iy(e),n=ML(e),r=DL(e);e._renderer.background(e.background()),e._renderer.resize(n,r,t),e._handler.origin(t),e._resizeListeners.forEach(i=>{try{i(n,r)}catch(o){e.error(o)}})}function kye(e,t,n){var r=e._renderer,i=r&&r.canvas(),o,a,s;return i&&(s=iy(e),a=t.changedTouches?t.changedTouches[0]:t,o=gm(a,i),o[0]-=s[0],o[1]-=s[1]),t.dataflow=e,t.item=n,t.vega=Mye(e,n,o),t}function Mye(e,t,n){const r=t?t.mark.marktype==="group"?t:t.mark.group:null;function i(a){var s=r,u;if(a){for(u=t;u;u=u.mark.group)if(u.mark.name===a){s=u;break}}return s&&s.mark&&s.mark.interactive?s:{}}function o(a){if(!a)return n;Me(a)&&(a=i(a));const s=n.slice();for(;a;)s[0]-=a.x||0,s[1]-=a.y||0,a=a.mark&&a.mark.group;return s}return{view:rn(e),item:rn(t||{}),group:i,xy:o,x:a=>o(a)[0],y:a=>o(a)[1]}}const NL="view",Dye="timer",Nye="window",Tye={trap:!1};function Rye(e){const t=pe({defaults:{}},e),n=(r,i)=>{i.forEach(o=>{ee(r[o])&&(r[o]=oi(r[o]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}function TL(e,t,n,r){e._eventListeners.push({type:n,sources:ae(t),handler:r})}function Pye(e,t){var n=e._eventConfig.defaults,r=n.prevent,i=n.allow;return r===!1||i===!0?!1:r===!0||i===!1?!0:r?r[t]:i?!i[t]:e.preventDefault()}function oy(e,t,n){const r=e._eventConfig&&e._eventConfig[t];return r===!1||le(r)&&!r[n]?(e.warn(`Blocked ${t} ${n} event listener.`),!1):!0}function Lye(e,t,n){var r=this,i=new cp(n),o=function(l,c){r.runAsync(null,()=>{e===NL&&Pye(r,t)&&l.preventDefault(),i.receive(kye(r,l,c))})},a;if(e===Dye)oy(r,"timer",t)&&r.timer(o,t);else if(e===NL)oy(r,"view",t)&&r.addEventListener(t,o,Tye);else if(e===Nye?oy(r,"window",t)&&typeof window!="undefined"&&(a=[window]):typeof document!="undefined"&&oy(r,"selector",t)&&(a=document.querySelectorAll(e)),!a)r.warn("Can not resolve event source: "+e);else{for(var s=0,u=a.length;s<u;++s)a[s].addEventListener(t,o);TL(r,a,t,o)}return i}function RL(e){return e.item}function PL(e){return e.item.mark.source}function LL(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function jye(e,t){return e=[e||"hover"],t=[t||"update",e[0]],this.on(this.events("view","mouseover",RL),PL,LL(e)),this.on(this.events("view","mouseout",RL),PL,LL(t)),this}function Iye(){var e=this._tooltip,t=this._timers,n=this._eventListeners,r,i,o;for(r=t.length;--r>=0;)t[r].stop();for(r=n.length;--r>=0;)for(o=n[r],i=o.sources.length;--i>=0;)o.sources[i].removeEventListener(o.type,o.handler);return e&&e.call(this,this._handler,null,null,null),this}function $r(e,t,n){const r=document.createElement(e);for(const i in t)r.setAttribute(i,t[i]);return n!=null&&(r.textContent=n),r}const Bye="vega-bind",zye="vega-bind-name",Uye="vega-bind-radio";function qye(e,t,n){if(!t)return;const r=n.param;let i=n.state;return i||(i=n.state={elements:null,active:!1,set:null,update:a=>{a!=e.signal(r.signal)&&e.runAsync(null,()=>{i.source=!0,e.signal(r.signal,a)})}},r.debounce&&(i.update=Ex(r.debounce,i.update))),(r.input==null&&r.element?Hye:Gye)(i,t,r,e),i.active||(e.on(e._signals[r.signal],null,()=>{i.source?i.source=!1:i.set(e.signal(r.signal))}),i.active=!0),i}function Hye(e,t,n,r){const i=n.event||"input",o=()=>e.update(t.value);r.signal(n.signal,t.value),t.addEventListener(i,o),TL(r,t,i,o),e.set=a=>{t.value=a,t.dispatchEvent(Wye(i))}}function Wye(e){return typeof Event!="undefined"?new Event(e):{type:e}}function Gye(e,t,n,r){const i=r.signal(n.signal),o=$r("div",{class:Bye}),a=n.input==="radio"?o:o.appendChild($r("label"));a.appendChild($r("span",{class:zye},n.name||n.signal)),t.appendChild(o);let s=Yye;switch(n.input){case"checkbox":s=Vye;break;case"select":s=Xye;break;case"radio":s=Kye;break;case"range":s=Zye;break}s(e,a,n,i)}function Yye(e,t,n,r){const i=$r("input");for(const o in n)o!=="signal"&&o!=="element"&&i.setAttribute(o==="input"?"type":o,n[o]);i.setAttribute("name",n.signal),i.value=r,t.appendChild(i),i.addEventListener("input",()=>e.update(i.value)),e.elements=[i],e.set=o=>i.value=o}function Vye(e,t,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const o=$r("input",i);t.appendChild(o),o.addEventListener("change",()=>e.update(o.checked)),e.elements=[o],e.set=a=>o.checked=!!a||null}function Xye(e,t,n,r){const i=$r("select",{name:n.signal}),o=n.labels||[];n.options.forEach((a,s)=>{const u={value:a};ay(a,r)&&(u.selected=!0),i.appendChild($r("option",u,(o[s]||a)+""))}),t.appendChild(i),i.addEventListener("change",()=>{e.update(n.options[i.selectedIndex])}),e.elements=[i],e.set=a=>{for(let s=0,u=n.options.length;s<u;++s)if(ay(n.options[s],a)){i.selectedIndex=s;return}}}function Kye(e,t,n,r){const i=$r("span",{class:Uye}),o=n.labels||[];t.appendChild(i),e.elements=n.options.map((a,s)=>{const u={type:"radio",name:n.signal,value:a};ay(a,r)&&(u.checked=!0);const l=$r("input",u);l.addEventListener("change",()=>e.update(a));const c=$r("label",{},(o[s]||a)+"");return c.prepend(l),i.appendChild(c),l}),e.set=a=>{const s=e.elements,u=s.length;for(let l=0;l<u;++l)ay(s[l].value,a)&&(s[l].checked=!0)}}function Zye(e,t,n,r){r=r!==void 0?r:(+n.max+ +n.min)/2;const i=n.max!=null?n.max:Math.max(100,+r)||100,o=n.min||Math.min(0,i,+r)||0,a=n.step||qge(o,i,100),s=$r("input",{type:"range",name:n.signal,min:o,max:i,step:a});s.value=r;const u=$r("span",{},+r);t.appendChild(s),t.appendChild(u);const l=()=>{u.textContent=s.value,e.update(+s.value)};s.addEventListener("input",l),s.addEventListener("change",l),e.elements=[s],e.set=c=>{s.value=c,u.textContent=c}}function ay(e,t){return e===t||e+""==t+""}function jL(e,t,n,r,i,o){return t=t||new r(e.loader()),t.initialize(n,ML(e),DL(e),iy(e),i,o).background(e.background())}function FS(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function Jye(e,t,n,r){const i=new r(e.loader(),FS(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,iy(e),e);return t&&t.handlers().forEach(o=>{i.on(o.type,o.handler)}),i}function Qye(e,t){const n=this,r=n._renderType,i=n._eventConfig.bind,o=Em(r);e=n._el=e?kS(n,e,!0):null,Eye(n),o||n.error("Unrecognized renderer type: "+r);const a=o.handler||zd,s=e?o.renderer:o.headless;return n._renderer=s?jL(n,n._renderer,e,s):null,n._handler=Jye(n,n._handler,e,a),n._redraw=!0,e&&i!=="none"&&(t=t?n._elBind=kS(n,t,!0):e.appendChild($r("form",{class:"vega-bindings"})),n._bind.forEach(u=>{u.param.element&&i!=="container"&&(u.element=kS(n,u.param.element,!!u.param.input))}),n._bind.forEach(u=>{qye(n,u.element||t,u)})),n}function kS(e,t,n){if(typeof t=="string")if(typeof document!="undefined"){if(t=document.querySelector(t),!t)return e.error("Signal bind element not found: "+t),null}else return e.error("DOM document instance not found."),null;if(t&&n)try{t.innerHTML=""}catch(r){t=null,e.error(r)}return t}const Xh=e=>+e||0,eve=e=>({top:e,bottom:e,left:e,right:e});function IL(e){return le(e)?{top:Xh(e.top),bottom:Xh(e.bottom),left:Xh(e.left),right:Xh(e.right)}:eve(Xh(e))}async function MS(e,t,n,r){const i=Em(t),o=i&&i.headless;return o||B("Unrecognized renderer type: "+t),await e.runAsync(),jL(e,null,null,o,n,r).renderAsync(e._scenegraph.root)}async function tve(e,t){e!==Ua.Canvas&&e!==Ua.SVG&&e!==Ua.PNG&&B("Unrecognized image type: "+e);const n=await MS(this,e,t);return e===Ua.SVG?nve(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function nve(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}async function rve(e,t){return(await MS(this,Ua.Canvas,e,t)).canvas()}async function ive(e){return(await MS(this,Ua.SVG,e)).svg()}function ove(e,t,n){return $L(e,Fl,qh,n).parse(t)}function ave(e){var t=this._runtime.scales;return se(t,e)||B("Unrecognized scale or projection: "+e),t[e].value}var BL="width",zL="height",DS="padding",UL={skip:!0};function qL(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===DS?r.left+r.right:0)}function HL(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===DS?r.top+r.bottom:0)}function sve(e){var t=e._signals,n=t[BL],r=t[zL],i=t[DS];function o(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,s=>{e._width=s.size,e._viewWidth=qL(e,s.size),o()},{size:n}),e._resizeHeight=e.add(null,s=>{e._height=s.size,e._viewHeight=HL(e,s.size),o()},{size:r});const a=e.add(null,o,{pad:i});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=r.rank+1,a.rank=i.rank+1}function uve(e,t,n,r,i,o){this.runAfter(a=>{let s=0;a._autosize=0,a.width()!==n&&(s=1,a.signal(BL,n,UL),a._resizeWidth.skip(!0)),a.height()!==r&&(s=1,a.signal(zL,r,UL),a._resizeHeight.skip(!0)),a._viewWidth!==e&&(a._resize=1,a._viewWidth=e),a._viewHeight!==t&&(a._resize=1,a._viewHeight=t),(a._origin[0]!==i[0]||a._origin[1]!==i[1])&&(a._resize=1,a._origin=i),s&&a.run("enter"),o&&a.runAfter(u=>u.resize())},!1,1)}function lve(e){return this._runtime.getState(e||{data:cve,signals:fve,recurse:!0})}function cve(e,t){return t.modified&&ee(t.input.value)&&e.indexOf("_:vega:_")}function fve(e,t){return!(e==="parent"||t instanceof Fl.proxy)}function dve(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}function hve(e,t){function n(r){e({timestamp:Date.now(),elapsed:r})}this._timers.push(_ye(n,t))}function gve(e,t,n,r){const i=e.element();i&&i.setAttribute("title",pve(r))}function pve(e){return e==null?"":ee(e)?WL(e):le(e)&&!wa(e)?mve(e):e+""}function mve(e){return Object.keys(e).map(t=>{const n=e[t];return t+": "+(ee(n)?WL(n):GL(n))}).join(`
`)}function WL(e){return"["+e.map(GL).join(", ")+"]"}function GL(e){return ee(e)?"[\u2026]":le(e)&&!wa(e)?"{\u2026}":e}function YL(e,t){const n=this;if(t=t||{},Ol.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),t.logLevel!=null&&n.logLevel(t.logLevel),t.locale||e.locale){const o=pe({},e.locale,t.locale);n.locale(e5(o.number,o.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||Ua.Canvas,n._scenegraph=new iE;const r=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||gve,n._redraw=!0,n._handler=new zd().scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=Rye(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=ove(n,e,t.expr);n._runtime=i,n._signals=i.signals,n._bind=(e.bindings||[]).map(o=>({state:null,param:pe({},o)})),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=qL(n,n._width),n._viewHeight=HL(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,sve(n),$ye(n),Aye(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function sy(e,t){return se(e._signals,t)?e._signals[t]:B("Unrecognized signal name: "+re(t))}function VL(e,t){const n=(e._targets||[]).filter(r=>r._update&&r._update.handler===t);return n.length?n[0]:null}function XL(e,t,n,r){let i=VL(n,r);return i||(i=FS(e,()=>r(t,n.value)),i.handler=r,e.on(n,null,i)),e}function KL(e,t,n){const r=VL(t,n);return r&&t._targets.remove(r),e}H(YL,Ol,{async evaluate(e,t,n){if(await Ol.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,Fye(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(r){this.error(r)}return n&&op(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=e!=null?e+"":null;return t!==this._desc&&kL(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const r=sy(this,e);return arguments.length===1?r.value:this.update(r,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",IL(e)):IL(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(Em(e)||B("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(Ol.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(sy(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:uve,addEventListener(e,t,n){let r=t;return n&&n.trap===!1||(r=FS(this,t),r.raw=t),this._handler.on(e,r),this},removeEventListener(e,t){for(var n=this._handler.handlers(e),r=n.length,i,o;--r>=0;)if(o=n[r].type,i=n[r].handler,e===o&&(t===i||t===i.raw)){this._handler.off(o,i);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return XL(this,e,sy(this,e),t)},removeSignalListener(e,t){return KL(this,sy(this,e),t)},addDataListener(e,t){return XL(this,e,ny(this,e).values,t)},removeDataListener(e,t){return KL(this,ny(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=OS(this,null);this._globalCursor=!!e,t&&OS(this,t)}return this}else return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:hve,events:Lye,finalize:Iye,hover:jye,data:Sye,change:ry,insert:Cye,remove:Oye,scale:ave,initialize:Qye,toImageURL:tve,toCanvas:rve,toSVG:ive,getState:lve,setState:dve});const yve="view",uy="[",ly="]",ZL="{",JL="}",vve=":",QL=",",bve="@",xve=">",wve=/[[\]{}]/,_ve={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let ej,tj;function nj(e,t,n){return ej=t||yve,tj=n||_ve,rj(e.trim()).map(NS)}function Eve(e){return tj[e]}function Kh(e,t,n,r,i){const o=e.length;let a=0,s;for(;t<o;++t){if(s=e[t],!a&&s===n)return t;i&&i.indexOf(s)>=0?--a:r&&r.indexOf(s)>=0&&++a}return t}function rj(e){const t=[],n=e.length;let r=0,i=0;for(;i<n;)i=Kh(e,i,QL,uy+ZL,ly+JL),t.push(e.substring(r,i).trim()),r=++i;if(t.length===0)throw"Empty event selector: "+e;return t}function NS(e){return e[0]==="["?$ve(e):Ave(e)}function $ve(e){const t=e.length;let n=1,r;if(n=Kh(e,n,ly,uy,ly),n===t)throw"Empty between selector: "+e;if(r=rj(e.substring(1,n)),r.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==xve)throw"Expected '>' after between selector: "+e;r=r.map(NS);const i=NS(e.slice(1).trim());return i.between?{between:r,stream:i}:(i.between=r,i)}function Ave(e){const t={source:ej},n=[];let r=[0,0],i=0,o=0,a=e.length,s=0,u,l;if(e[a-1]===JL){if(s=e.lastIndexOf(ZL),s>=0){try{r=Sve(e.substring(s+1,a-1))}catch(c){throw"Invalid throttle specification: "+e}e=e.slice(0,s).trim(),a=e.length}else throw"Unmatched right brace: "+e;s=0}if(!a)throw e;if(e[0]===bve&&(i=++s),u=Kh(e,s,vve),u<a&&(n.push(e.substring(o,u).trim()),o=s=++u),s=Kh(e,s,uy),s===a)n.push(e.substring(o,a).trim());else if(n.push(e.substring(o,s).trim()),l=[],o=++s,o===a)throw"Unmatched left bracket: "+e;for(;s<a;){if(s=Kh(e,s,ly),s===a)throw"Unmatched left bracket: "+e;if(l.push(e.substring(o,s).trim()),s<a-1&&e[++s]!==uy)throw"Expected left bracket: "+e;o=++s}if(!(a=n.length)||wve.test(n[a-1]))throw"Invalid event selector: "+e;return a>1?(t.type=n[1],i?t.markname=n[0].slice(1):Eve(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),l!=null&&(t.filter=l),r[0]&&(t.throttle=r[0]),r[1]&&(t.debounce=r[1]),t}function Sve(e){const t=e.split(QL);if(!e.length||t.length>2)throw e;return t.map(n=>{const r=+n;if(r!==r)throw e;return r})}function Cve(e){return le(e)?e:{type:e||"pad"}}const Zh=e=>+e||0,Ove=e=>({top:e,bottom:e,left:e,right:e});function Fve(e){return le(e)?e.signal?e:{top:Zh(e.top),bottom:Zh(e.bottom),left:Zh(e.left),right:Zh(e.right)}:Ove(Zh(e))}const zt=e=>le(e)&&!ee(e)?pe({},e):{value:e};function ij(e,t,n,r){return n!=null?(le(n)&&!ee(n)||ee(n)&&n.length&&le(n[0])?e.update[t]=n:e[r||"enter"][t]={value:n},1):0}function Zt(e,t,n){for(const r in t)ij(e,r,t[r]);for(const r in n)ij(e,r,n[r],"update")}function xc(e,t,n){for(const r in t)n&&se(n,r)||(e[r]=pe(e[r]||{},t[r]));return e}function wc(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const TS="mark",RS="frame",PS="scope",kve="axis",Mve="axis-domain",Dve="axis-grid",Nve="axis-label",Tve="axis-tick",Rve="axis-title",Pve="legend",Lve="legend-band",jve="legend-entry",Ive="legend-gradient",oj="legend-label",Bve="legend-symbol",zve="legend-title",Uve="title",qve="title-text",Hve="title-subtitle";function Wve(e,t,n,r,i){const o={},a={};let s,u,l,c;u="lineBreak",t==="text"&&i[u]!=null&&!wc(u,e)&&LS(o,u,i[u]),(n=="legend"||String(n).startsWith("axis"))&&(n=null),c=n===RS?i.group:n===TS?pe({},i.mark,i[t]):null;for(u in c)l=wc(u,e)||(u==="fill"||u==="stroke")&&(wc("fill",e)||wc("stroke",e)),l||LS(o,u,c[u]);ae(r).forEach(f=>{const d=i.style&&i.style[f];for(const h in d)wc(h,e)||LS(o,h,d[h])}),e=pe({},e);for(u in o)c=o[u],c.signal?(s=s||{})[u]=c:a[u]=c;return e.enter=pe(a,e.enter),s&&(e.update=pe(s,e.update)),e}function LS(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const aj=e=>Me(e)?re(e):e.signal?`(${e.signal})`:sj(e);function cy(e){if(e.gradient!=null)return Yve(e);let t=e.signal?`(${e.signal})`:e.color?Gve(e.color):e.field!=null?sj(e.field):e.value!==void 0?re(e.value):void 0;return e.scale!=null&&(t=Vve(e,t)),t===void 0&&(t=null),e.exponent!=null&&(t=`pow(${t},${dy(e.exponent)})`),e.mult!=null&&(t+=`*${dy(e.mult)}`),e.offset!=null&&(t+=`+${dy(e.offset)}`),e.round&&(t=`round(${t})`),t}const fy=(e,t,n,r)=>`(${e}(${[t,n,r].map(cy).join(",")})+'')`;function Gve(e){return e.c?fy("hcl",e.h,e.c,e.l):e.h||e.s?fy("hsl",e.h,e.s,e.l):e.l||e.a?fy("lab",e.l,e.a,e.b):e.r||e.g||e.b?fy("rgb",e.r,e.g,e.b):null}function Yve(e){const t=[e.start,e.stop,e.count].map(n=>n==null?null:re(n));for(;t.length&&Se(t)==null;)t.pop();return t.unshift(aj(e.gradient)),`gradient(${t.join(",")})`}function dy(e){return le(e)?"("+cy(e)+")":e}function sj(e){return uj(le(e)?e:{datum:e})}function uj(e){let t,n,r;if(e.signal)t="datum",r=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(r=e.parent,t+=".datum"):r=e.group}else e.datum?(t="datum",r=e.datum):B("Invalid field reference: "+re(e));return e.signal||(r=Me(r)?zg(r).map(re).join("]["):uj(r)),t+"["+r+"]"}function Vve(e,t){const n=aj(e.scale);return e.range!=null?t=`lerp(_range(${n}), ${+e.range})`:(t!==void 0&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(+e.band==1?"":"*"+dy(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),t==null&&(t="0")),t}function Xve(e){let t="";return e.forEach(n=>{const r=cy(n);t+=n.test?`(${n.test})?${r}:`:r}),Se(t)===":"&&(t+="null"),t}function lj(e,t,n,r,i,o){const a={};o=o||{},o.encoders={$encode:a},e=Wve(e,t,n,r,i.config);for(const s in e)a[s]=Kve(e[s],t,o,i);return o}function Kve(e,t,n,r){const i={},o={};for(const a in e)e[a]!=null&&(i[a]=Jve(Zve(e[a]),r,n,o));return{$expr:{marktype:t,channels:i},$fields:Object.keys(o),$output:Object.keys(e)}}function Zve(e){return ee(e)?Xve(e):cy(e)}function Jve(e,t,n,r){const i=lo(e,t);return i.$fields.forEach(o=>r[o]=1),pe(n,i.$params),i.$expr}const Qve="outer",ebe=["value","update","init","react","bind"];function cj(e,t){B(e+' for "outer" push: '+re(t))}function fj(e,t){const n=e.name;if(e.push===Qve)t.signals[n]||cj("No prior signal definition",n),ebe.forEach(r=>{e[r]!==void 0&&cj("Invalid property ",r)});else{const r=t.addSignal(n,e.value);e.react===!1&&(r.react=!1),e.bind&&t.addBinding(n,e.bind)}}function jS(e,t,n,r){this.id=-1,this.type=e,this.value=t,this.params=n,r&&(this.parent=r)}function hy(e,t,n,r){return new jS(e,t,n,r)}function gy(e,t){return hy("operator",e,t)}function ne(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function Jh(e,t){return t?{$field:e,$name:t}:{$field:e}}const IS=Jh("key");function dj(e,t){return{$compare:e,$order:t}}function tbe(e,t){const n={$key:e};return t&&(n.$flat=!0),n}const nbe="ascending",rbe="descending";function ibe(e){return le(e)?(e.order===rbe?"-":"+")+py(e.op,e.field):""}function py(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const BS="scope",zS="view";function kt(e){return e&&e.signal}function obe(e){return e&&e.expr}function my(e){if(kt(e))return!0;if(le(e)){for(const t in e)if(my(e[t]))return!0}return!1}function vi(e,t){return e!=null?e:t}function Eu(e){return e&&e.signal||e}const hj="timer";function Qh(e,t){return(e.merge?sbe:e.stream?ube:e.type?lbe:B("Invalid stream specification: "+re(e)))(e,t)}function abe(e){return e===BS?zS:e||zS}function sbe(e,t){const n=e.merge.map(i=>Qh(i,t)),r=US({merge:n},e,t);return t.addStream(r).id}function ube(e,t){const n=Qh(e.stream,t),r=US({stream:n},e,t);return t.addStream(r).id}function lbe(e,t){let n;e.type===hj?(n=t.event(hj,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(abe(e.source),e.type);const r=US({stream:n},e,t);return Object.keys(r).length===1?n:t.addStream(r).id}function US(e,t,n){let r=t.between;return r&&(r.length!==2&&B('Stream "between" parameter must have 2 entries: '+re(t)),e.between=[Qh(r[0],n),Qh(r[1],n)]),r=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&r.push(cbe(t.marktype,t.markname,t.markrole)),t.source===BS&&r.push("inScope(event.item)"),r.length&&(e.filter=lo("("+r.join(")&&(")+")",n).$expr),(r=t.throttle)!=null&&(e.throttle=+r),(r=t.debounce)!=null&&(e.debounce=+r),t.consume&&(e.consume=!0),e}function cbe(e,t,n){const r="event.item";return r+(e&&e!=="*"?"&&"+r+".mark.marktype==='"+e+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(t?"&&"+r+".mark.name==='"+t+"'":"")}const fbe={code:"_.$value",ast:{type:"Identifier",value:"value"}};function dbe(e,t,n){const r=e.encode,i={target:n};let o=e.events,a=e.update,s=[];o||B("Signal update missing events specification."),Me(o)&&(o=nj(o,t.isSubscope()?BS:zS)),o=ae(o).filter(u=>u.signal||u.scale?(s.push(u),0):1),s.length>1&&(s=[gbe(s)]),o.length&&s.push(o.length>1?{merge:o}:o[0]),r!=null&&(a&&B("Signal encode and update are mutually exclusive."),a="encode(item(),"+re(r)+")"),i.update=Me(a)?lo(a,t):a.expr!=null?lo(a.expr,t):a.value!=null?a.value:a.signal!=null?{$expr:fbe,$params:{$value:t.signalRef(a.signal)}}:B("Invalid signal update specification."),e.force&&(i.options={force:!0}),s.forEach(u=>t.addUpdate(pe(hbe(u,t),i)))}function hbe(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):Qh(e,t)}}function gbe(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}function pbe(e,t){const n=t.getSignal(e.name);let r=e.update;e.init&&(r?B("Signals can not include both init and update expressions."):(r=e.init,n.initonly=!0)),r&&(r=lo(r,t),n.update=r.$expr,n.params=r.$params),e.on&&e.on.forEach(i=>dbe(i,t,n.id))}const We=e=>(t,n,r)=>hy(e,n,t||void 0,r),gj=We("aggregate"),mbe=We("axisticks"),pj=We("bound"),bi=We("collect"),mj=We("compare"),ybe=We("datajoin"),yj=We("encode"),vbe=We("expression"),bbe=We("facet"),xbe=We("field"),wbe=We("key"),_be=We("legendentries"),Ebe=We("load"),$be=We("mark"),Abe=We("multiextent"),Sbe=We("multivalues"),Cbe=We("overlap"),Obe=We("params"),vj=We("prefacet"),Fbe=We("projection"),kbe=We("proxy"),Mbe=We("relay"),bj=We("render"),Dbe=We("scale"),$u=We("sieve"),Nbe=We("sortitems"),xj=We("viewlayout"),Tbe=We("values");let Rbe=0;const wj={min:"min",max:"max",count:"sum"};function Pbe(e,t){const n=e.type||"linear";D6(n)||B("Unrecognized scale type: "+re(n)),t.addScale(e.name,{type:n,domain:void 0})}function Lbe(e,t){const n=t.getScale(e.name).params;let r;n.domain=_j(e.domain,e,t),e.range!=null&&(n.range=$j(e,t,n)),e.interpolate!=null&&Ybe(e.interpolate,n),e.nice!=null&&(n.nice=Gbe(e.nice)),e.bins!=null&&(n.bins=Wbe(e.bins,t));for(r in e)se(n,r)||r==="name"||(n[r]=Ur(e[r],t))}function Ur(e,t){return le(e)?e.signal?t.signalRef(e.signal):B("Unsupported object: "+re(e)):e}function yy(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>Ur(n,t))}function vy(e){B("Can not find data set: "+re(e))}function _j(e,t,n){if(!e){(t.domainMin!=null||t.domainMax!=null)&&B("No scale domain defined for domainMin/domainMax to override.");return}return e.signal?n.signalRef(e.signal):(ee(e)?jbe:e.fields?Bbe:Ibe)(e,t,n)}function jbe(e,t,n){return e.map(r=>Ur(r,n))}function Ibe(e,t,n){const r=n.getData(e.data);return r||vy(e.data),ql(t.type)?r.valuesRef(n,e.field,Ej(e.sort,!1)):R6(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)}function Bbe(e,t,n){const r=e.data,i=e.fields.reduce((o,a)=>(a=Me(a)?{data:r,field:a}:ee(a)||a.signal?zbe(a,n):a,o.push(a),o),[]);return(ql(t.type)?Ube:R6(t.type)?qbe:Hbe)(e,n,i)}function zbe(e,t){const n="_:vega:_"+Rbe++,r=bi({});if(ee(e))r.value={$ingest:e};else if(e.signal){const i="setdata("+re(n)+","+e.signal+")";r.params.input=t.signalRef(i)}return t.addDataPipeline(n,[r,$u({})]),{data:n,field:"data"}}function Ube(e,t,n){const r=Ej(e.sort,!0);let i,o;const a=n.map(l=>{const c=t.getData(l.data);return c||vy(l.data),c.countsRef(t,l.field,r)}),s={groupby:IS,pulse:a};r&&(i=r.op||"count",o=r.field?py(i,r.field):"count",s.ops=[wj[i]],s.fields=[t.fieldRef(o)],s.as=[o]),i=t.add(gj(s));const u=t.add(bi({pulse:ne(i)}));return o=t.add(Tbe({field:IS,sort:t.sortRef(r),pulse:ne(u)})),ne(o)}function Ej(e,t){return e&&(!e.field&&!e.op?le(e)?e.field="key":e={field:"key"}:!e.field&&e.op!=="count"?B("No field provided for sort aggregate op: "+e.op):t&&e.field&&e.op&&!wj[e.op]&&B("Multiple domain scales can not be sorted using "+e.op)),e}function qbe(e,t,n){const r=n.map(i=>{const o=t.getData(i.data);return o||vy(i.data),o.domainRef(t,i.field)});return ne(t.add(Sbe({values:r})))}function Hbe(e,t,n){const r=n.map(i=>{const o=t.getData(i.data);return o||vy(i.data),o.extentRef(t,i.field)});return ne(t.add(Abe({extents:r})))}function Wbe(e,t){return e.signal||ee(e)?yy(e,t):t.objectProperty(e)}function Gbe(e){return le(e)?{interval:Ur(e.interval),step:Ur(e.step)}:Ur(e)}function Ybe(e,t){t.interpolate=Ur(e.type||e),e.gamma!=null&&(t.interpolateGamma=Ur(e.gamma))}function $j(e,t,n){const r=t.config.range;let i=e.range;if(i.signal)return t.signalRef(i.signal);if(Me(i)){if(r&&se(r,i))return e=pe({},e,{range:r[i]}),$j(e,t,n);i==="width"?i=[0,{signal:"width"}]:i==="height"?i=ql(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:B("Unrecognized scale range value: "+re(i))}else if(i.scheme){n.scheme=ee(i.scheme)?yy(i.scheme,t):Ur(i.scheme,t),i.extent&&(n.schemeExtent=yy(i.extent,t)),i.count&&(n.schemeCount=Ur(i.count,t));return}else if(i.step){n.rangeStep=Ur(i.step,t);return}else{if(ql(e.type)&&!ee(i))return _j(i,e,t);ee(i)||B("Unsupported range type: "+re(i))}return i.map(o=>(ee(o)?yy:Ur)(o,t))}function Vbe(e,t){const n=t.config.projection||{},r={};for(const i in e)i!=="name"&&(r[i]=qS(e[i],i,t));for(const i in n)r[i]==null&&(r[i]=qS(n[i],i,t));t.addProjection(e.name,r)}function qS(e,t,n){return ee(e)?e.map(r=>qS(r,t,n)):le(e)?e.signal?n.signalRef(e.signal):t==="fit"?e:B("Unsupported parameter object: "+re(e)):e}const xi="top",_c="left",Ec="right",Qa="bottom",Aj="center",Xbe="vertical",Kbe="start",Zbe="middle",Jbe="end",HS="index",WS="label",Qbe="offset",$c="perc",exe="perc2",qr="value",e0="guide-label",GS="guide-title",txe="group-title",nxe="group-subtitle",Sj="symbol",by="gradient",YS="discrete",VS="size",rxe="shape",ixe="fill",oxe="stroke",axe="strokeWidth",sxe="strokeDash",uxe="opacity",XS=[VS,rxe,ixe,oxe,axe,sxe,uxe],t0={name:1,style:1,interactive:1},Fe={value:0},Hr={value:1},xy="group",Cj="rect",KS="rule",lxe="symbol",Au="text";function n0(e){return e.type=xy,e.interactive=e.interactive||!1,e}function tr(e,t){const n=(r,i)=>vi(e[r],vi(t[r],i));return n.isVertical=r=>Xbe===vi(e.direction,t.direction||(r?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>vi(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>vi(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>vi(e.columns,vi(t.columns,+n.isVertical(!0))),n}function Oj(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function cxe(e,t,n){const r=t.config.style[n];return r&&r[e]}function wy(e,t,n){return`item.anchor === '${Kbe}' ? ${e} : item.anchor === '${Jbe}' ? ${t} : ${n}`}const ZS=wy(re(_c),re(Ec),re(Aj));function fxe(e){const t=e("tickBand");let n=e("tickOffset"),r,i;return t?t.signal?(r={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},i={signal:`(${t.signal}) === 'extent'`},le(n)||(n={signal:`(${t.signal}) === 'extent' ? 0 : ${n}`})):t==="extent"?(r=1,i=!0,n=0):(r=.5,i=!1):(r=e("bandPosition"),i=e("tickExtra")),{extra:i,band:r,offset:n}}function Fj(e,t){return t?e?le(e)?Object.assign({},e,{offset:Fj(e.offset,t)}):{value:e,offset:t}:t:e}function Ar(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=xc(e.encode,t,t0)):e.interactive=!1,e}function dxe(e,t,n,r){const i=tr(e,n),o=i.isVertical(),a=i.gradientThickness(),s=i.gradientLength();let u,l,c,f,d;o?(l=[0,1],c=[0,0],f=a,d=s):(l=[0,0],c=[1,0],f=s,d=a);const h={enter:u={opacity:Fe,x:Fe,y:Fe,width:zt(f),height:zt(d)},update:pe({},u,{opacity:Hr,fill:{gradient:t,start:l,stop:c}}),exit:{opacity:Fe}};return Zt(h,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),Ar({type:Cj,role:Ive,encode:h},r)}function hxe(e,t,n,r,i){const o=tr(e,n),a=o.isVertical(),s=o.gradientThickness(),u=o.gradientLength();let l,c,f,d,h="";a?(l="y",f="y2",c="x",d="width",h="1-"):(l="x",f="x2",c="y",d="height");const g={opacity:Fe,fill:{scale:t,field:qr}};g[l]={signal:h+"datum."+$c,mult:u},g[c]=Fe,g[f]={signal:h+"datum."+exe,mult:u},g[d]=zt(s);const p={enter:g,update:pe({},g,{opacity:Hr}),exit:{opacity:Fe}};return Zt(p,{stroke:o("gradientStrokeColor"),strokeWidth:o("gradientStrokeWidth")},{opacity:o("gradientOpacity")}),Ar({type:Cj,role:Lve,key:qr,from:i,encode:p},r)}const gxe=`datum.${$c}<=0?"${_c}":datum.${$c}>=1?"${Ec}":"${Aj}"`,pxe=`datum.${$c}<=0?"${Qa}":datum.${$c}>=1?"${xi}":"${Zbe}"`;function kj(e,t,n,r){const i=tr(e,t),o=i.isVertical(),a=zt(i.gradientThickness()),s=i.gradientLength();let u=i("labelOverlap"),l,c,f,d,h="";const g={enter:l={opacity:Fe},update:c={opacity:Hr,text:{field:WS}},exit:{opacity:Fe}};return Zt(g,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:vi(e.labelLimit,t.gradientLabelLimit)}),o?(l.align={value:"left"},l.baseline=c.baseline={signal:pxe},f="y",d="x",h="1-"):(l.align=c.align={signal:gxe},l.baseline={value:"top"},f="x",d="y"),l[f]=c[f]={signal:h+"datum."+$c,mult:s},l[d]=c[d]=a,a.offset=vi(e.labelOffset,t.gradientLabelOffset)||0,u=u?{separation:i("labelSeparation"),method:u,order:"datum."+HS}:void 0,Ar({type:Au,role:oj,style:e0,key:qr,from:r,encode:g,overlap:u},n)}function mxe(e,t,n,r,i){const o=tr(e,t),a=n.entries,s=!!(a&&a.interactive),u=a?a.name:void 0,l=o("clipHeight"),c=o("symbolOffset"),f={data:"value"},d=`(${i}) ? datum.${Qbe} : datum.${VS}`,h=l?zt(l):{field:VS},g=`datum.${HS}`,p=`max(1, ${i})`;let m,y,v,b,x;h.mult=.5,m={enter:y={opacity:Fe,x:{signal:d,mult:.5,offset:c},y:h},update:v={opacity:Hr,x:y.x,y:y.y},exit:{opacity:Fe}};let w=null,E=null;e.fill||(w=t.symbolBaseFillColor,E=t.symbolBaseStrokeColor),Zt(m,{fill:o("symbolFillColor",w),shape:o("symbolType"),size:o("symbolSize"),stroke:o("symbolStrokeColor",E),strokeDash:o("symbolDash"),strokeDashOffset:o("symbolDashOffset"),strokeWidth:o("symbolStrokeWidth")},{opacity:o("symbolOpacity")}),XS.forEach(O=>{e[O]&&(v[O]=y[O]={scale:e[O],field:qr})});const _=Ar({type:lxe,role:Bve,key:qr,from:f,clip:l?!0:void 0,encode:m},n.symbols),S=zt(c);S.offset=o("labelOffset"),m={enter:y={opacity:Fe,x:{signal:d,offset:S},y:h},update:v={opacity:Hr,text:{field:WS},x:y.x,y:y.y},exit:{opacity:Fe}},Zt(m,{align:o("labelAlign"),baseline:o("labelBaseline"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontStyle:o("labelFontStyle"),fontWeight:o("labelFontWeight"),limit:o("labelLimit")});const C=Ar({type:Au,role:oj,style:e0,key:qr,from:f,encode:m},n.labels);return m={enter:{noBound:{value:!l},width:Fe,height:l?zt(l):Fe,opacity:Fe},exit:{opacity:Fe},update:v={opacity:Hr,row:{signal:null},column:{signal:null}}},o.isVertical(!0)?(b=`ceil(item.mark.items.length / ${p})`,v.row.signal=`${g}%${b}`,v.column.signal=`floor(${g} / ${b})`,x={field:["row",g]}):(v.row.signal=`floor(${g} / ${p})`,v.column.signal=`${g} % ${p}`,x={field:g}),v.column.signal=`(${i})?${v.column.signal}:${g}`,r={facet:{data:r,name:"value",groupby:HS}},n0({role:PS,from:r,encode:xc(m,a,t0),marks:[_,C],name:u,interactive:s,sort:x})}function yxe(e,t){const n=tr(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const JS='item.orient === "left"',QS='item.orient === "right"',_y=`(${JS} || ${QS})`,vxe=`datum.vgrad && ${_y}`,bxe=wy('"top"','"bottom"','"middle"'),xxe=wy('"right"','"left"','"center"'),wxe=`datum.vgrad && ${QS} ? (${xxe}) : (${_y} && !(datum.vgrad && ${JS})) ? "left" : ${ZS}`,_xe=`item._anchor || (${_y} ? "middle" : "start")`,Exe=`${vxe} ? (${JS} ? -90 : 90) : 0`,$xe=`${_y} ? (datum.vgrad ? (${QS} ? "bottom" : "top") : ${bxe}) : "top"`;function Axe(e,t,n,r){const i=tr(e,t),o={enter:{opacity:Fe},update:{opacity:Hr,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:Fe}};return Zt(o,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:_xe},angle:{signal:Exe},align:{signal:wxe},baseline:{signal:$xe},text:e.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),Ar({type:Au,role:zve,style:GS,from:r,encode:o},n)}function Sxe(e,t){let n;return le(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+Mj(e.path)+")":e.sphere&&(n="geoShape("+Mj(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function Mj(e){return le(e)&&e.signal?e.signal:re(e)}function Dj(e){const t=e.role||"";return!t.indexOf("axis")||!t.indexOf("legend")||!t.indexOf("title")?t:e.type===xy?PS:t||TS}function Cxe(e){return{marktype:e.type,name:e.name||void 0,role:e.role||Dj(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function Oxe(e,t){return e&&e.signal?t.signalRef(e.signal):e!==!1}function eC(e,t){const n=w5(e.type);n||B("Unrecognized transform type: "+re(e.type));const r=hy(n.type.toLowerCase(),null,Nj(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(r)),r.metadata=n.metadata||{},r}function Nj(e,t,n){const r={},i=e.params.length;for(let o=0;o<i;++o){const a=e.params[o];r[a.name]=Fxe(a,t,n)}return r}function Fxe(e,t,n){const r=e.type,i=t[e.name];if(r==="index")return kxe(e,t,n);if(i===void 0){e.required&&B("Missing required "+re(t.type)+" parameter: "+re(e.name));return}else{if(r==="param")return Mxe(e,t,n);if(r==="projection")return n.projectionRef(t[e.name])}return e.array&&!kt(i)?i.map(o=>Tj(e,o,n)):Tj(e,i,n)}function Tj(e,t,n){const r=e.type;if(kt(t))return Pj(r)?B("Expression references can not be signals."):tC(r)?n.fieldRef(t):Lj(r)?n.compareRef(t):n.signalRef(t.signal);{const i=e.expr||tC(r);return i&&Dxe(t)?n.exprRef(t.expr,t.as):i&&Nxe(t)?Jh(t.field,t.as):Pj(r)?lo(t,n):Txe(r)?ne(n.getData(t).values):tC(r)?Jh(t):Lj(r)?n.compareRef(t):t}}function kxe(e,t,n){return Me(t.from)||B('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function Mxe(e,t,n){const r=t[e.name];return e.array?(ee(r)||B("Expected an array of sub-parameters. Instead: "+re(r)),r.map(i=>Rj(e,i,n))):Rj(e,r,n)}function Rj(e,t,n){const r=e.params.length;let i;for(let a=0;a<r;++a){i=e.params[a];for(const s in i.key)if(i.key[s]!==t[s]){i=null;break}if(i)break}i||B("Unsupported parameter: "+re(t));const o=pe(Nj(i,t,n),i.key);return ne(n.add(Obe(o)))}const Dxe=e=>e&&e.expr,Nxe=e=>e&&e.field,Txe=e=>e==="data",Pj=e=>e==="expr",tC=e=>e==="field",Lj=e=>e==="compare";function Rxe(e,t,n){let r,i,o,a,s;return e?(r=e.facet)&&(t||B("Only group marks can be faceted."),r.field!=null?a=s=Ey(r,n):(e.data?s=ne(n.getData(e.data).aggregate):(o=eC(pe({type:"aggregate",groupby:ae(r.groupby)},r.aggregate),n),o.params.key=n.keyRef(r.groupby),o.params.pulse=Ey(r,n),a=s=ne(n.add(o))),i=n.keyRef(r.groupby,!0))):a=ne(n.add(bi(null,[{}]))),a||(a=Ey(e,n)),{key:i,pulse:a,parent:s}}function Ey(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:ne(t.getData(e.data).output)}function Su(e,t,n,r,i){this.scope=e,this.input=t,this.output=n,this.values=r,this.aggregate=i,this.index={}}Su.fromEntries=function(e,t){const n=t.length,r=t[n-1],i=t[n-2];let o=t[0],a=null,s=1;for(o&&o.type==="load"&&(o=t[1]),e.add(t[0]);s<n;++s)t[s].params.pulse=ne(t[s-1]),e.add(t[s]),t[s].type==="aggregate"&&(a=t[s]);return new Su(e,o,i,r,a)};function jj(e){return Me(e)?e:null}function Ij(e,t,n){const r=py(n.op,n.field);let i;if(t.ops){for(let o=0,a=t.as.length;o<a;++o)if(t.as[o]===r)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((i=n.op.signal)?e.signalRef(i):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(r))}function r0(e,t,n,r,i,o,a){const s=t[n]||(t[n]={}),u=ibe(o);let l=jj(i),c,f;if(l!=null&&(e=t.scope,l=l+(u?"|"+u:""),c=s[l]),!c){const d=o?{field:IS,pulse:t.countsRef(e,i,o)}:{field:e.fieldRef(i),pulse:ne(t.output)};u&&(d.sort=e.sortRef(o)),f=e.add(hy(r,void 0,d)),a&&(t.index[i]=f),c=ne(f),l!=null&&(s[l]=c)}return c}Su.prototype={countsRef(e,t,n){const r=this,i=r.counts||(r.counts={}),o=jj(t);let a,s,u;return o!=null&&(e=r.scope,a=i[o]),a?n&&n.field&&Ij(e,a.agg.params,n):(u={groupby:e.fieldRef(t,"key"),pulse:ne(r.output)},n&&n.field&&Ij(e,u,n),s=e.add(gj(u)),a=e.add(bi({pulse:ne(s)})),a={agg:s,ref:ne(a)},o!=null&&(i[o]=a)),a.ref},tuplesRef(){return ne(this.values)},extentRef(e,t){return r0(e,this,"extent","extent",t,!1)},domainRef(e,t){return r0(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return r0(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return r0(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return r0(e,this,"indata","tupleindex",t,!0,!0)}};function Pxe(e,t,n){const r=e.from.facet,i=r.name,o=Ey(r,t);let a;r.name||B("Facet must have a name: "+re(r)),r.data||B("Facet must reference a data set: "+re(r)),r.field?a=t.add(vj({field:t.fieldRef(r.field),pulse:o})):r.groupby?a=t.add(bbe({key:t.keyRef(r.groupby),group:ne(t.proxy(n.parent)),pulse:o})):B("Facet must specify groupby or field: "+re(r));const s=t.fork(),u=s.add(bi()),l=s.add($u({pulse:ne(u)}));s.addData(i,new Su(s,u,u,l)),s.addSignal("parent",null),a.params.subflow={$subflow:s.parse(e).toRuntime()}}function Lxe(e,t,n){const r=t.add(vj({pulse:n.pulse})),i=t.fork();i.add($u()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(e).toRuntime()}}function Bj(e,t,n){const r=e.remove,i=e.insert,o=e.toggle,a=e.modify,s=e.values,u=t.add(gy()),l="if("+e.trigger+',modify("'+n+'",'+[i,r,o,a,s].map(f=>f==null?"null":f).join(",")+"),0)",c=lo(l,t);u.update=c.$expr,u.params=c.$params}function $y(e,t){const n=Dj(e),r=e.type===xy,i=e.from&&e.from.facet,o=e.overlap;let a=e.layout||n===PS||n===RS,s,u,l,c,f,d,h;const g=n===TS||a||i,p=Rxe(e.from,r,t);u=t.add(ybe({key:p.key||(e.key?Jh(e.key):void 0),pulse:p.pulse,clean:!r}));const m=ne(u);u=l=t.add(bi({pulse:m})),u=t.add($be({markdef:Cxe(e),interactive:Oxe(e.interactive,t),clip:Sxe(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:ne(u)}));const y=ne(u);u=c=t.add(yj(lj(e.encode,e.type,n,e.style,t,{mod:!1,pulse:y}))),u.params.parent=t.encode(),e.transform&&e.transform.forEach(E=>{const _=eC(E,t),S=_.metadata;(S.generates||S.changes)&&B("Mark transforms should not generate new data."),S.nomod||(c.params.mod=!0),_.params.pulse=ne(u),t.add(u=_)}),e.sort&&(u=t.add(Nbe({sort:t.compareRef(e.sort),pulse:ne(u)})));const v=ne(u);(i||a)&&(a=t.add(xj({layout:t.objectProperty(e.layout),legends:t.legends,mark:y,pulse:v})),d=ne(a));const b=t.add(pj({mark:y,pulse:d||v}));h=ne(b),r&&(g&&(s=t.operators,s.pop(),a&&s.pop()),t.pushState(v,d||h,m),i?Pxe(e,t,p):g?Lxe(e,t,p):t.parse(e),t.popState(),g&&(a&&s.push(a),s.push(b))),o&&(h=jxe(o,h,t));const x=t.add(bj({pulse:h})),w=t.add($u({pulse:ne(x)},void 0,t.parent()));e.name!=null&&(f=e.name,t.addData(f,new Su(t,l,x,w)),e.on&&e.on.forEach(E=>{(E.insert||E.remove||E.toggle)&&B("Marks only support modify triggers."),Bj(E,t,f)}))}function jxe(e,t,n){const r=e.method,i=e.bound,o=e.separation,a={separation:kt(o)?n.signalRef(o.signal):o,method:kt(r)?n.signalRef(r.signal):r,pulse:t};if(e.order&&(a.sort=n.compareRef({field:e.order})),i){const s=i.tolerance;a.boundTolerance=kt(s)?n.signalRef(s.signal):+s,a.boundScale=n.scaleRef(i.scale),a.boundOrient=i.orient}return ne(n.add(Cbe(a)))}function Ixe(e,t){const n=t.config.legend,r=e.encode||{},i=tr(e,n),o=r.legend||{},a=o.name||void 0,s=o.interactive,u=o.style,l={};let c=0,f,d,h;XS.forEach(b=>e[b]?(l[b]=e[b],c=c||e[b]):0),c||B("Missing valid scale for legend.");const g=Bxe(e,t.scaleType(c)),p={title:e.title!=null,scales:l,type:g,vgrad:g!=="symbol"&&i.isVertical()},m=ne(t.add(bi(null,[p]))),y={enter:{x:{value:0},y:{value:0}}},v=ne(t.add(_be(d={type:g,scale:t.scaleRef(c),count:t.objectProperty(i("tickCount")),limit:t.property(i("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return g===by?(h=[dxe(e,c,n,r.gradient),kj(e,n,r.labels,v)],d.count=d.count||t.signalRef(`max(2,2*floor((${Eu(i.gradientLength())})/100))`)):g===YS?h=[hxe(e,c,n,r.gradient,v),kj(e,n,r.labels,v)]:(f=yxe(e,n),h=[mxe(e,n,r,v,Eu(f.columns))],d.size=qxe(e,t,h[0].marks)),h=[n0({role:jve,from:m,encode:y,marks:h,layout:f,interactive:s})],p.title&&h.push(Axe(e,n,r.title,m)),$y(n0({role:Pve,from:m,encode:xc(Uxe(i,e,n),o,t0),marks:h,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:a,interactive:s,style:u}),t)}function Bxe(e,t){let n=e.type||Sj;return!e.type&&zxe(e)===1&&(e.fill||e.stroke)&&(n=x_(t)?by:w_(t)?YS:Sj),n!==by?n:w_(t)?YS:by}function zxe(e){return XS.reduce((t,n)=>t+(e[n]?1:0),0)}function Uxe(e,t,n){const r={enter:{},update:{}};return Zt(r,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),r}function qxe(e,t,n){const r=Eu(zj("size",e,n)),i=Eu(zj("strokeWidth",e,n)),o=Eu(Hxe(n[1].encode,t,e0));return lo(`max(ceil(sqrt(${r})+${i}),${o})`,t)}function zj(e,t,n){return t[e]?`scale("${t[e]}",datum)`:Oj(e,n[0].encode)}function Hxe(e,t,n){return Oj("fontSize",e)||cxe("fontSize",t,n)}const Wxe=`item.orient==="${_c}"?-90:item.orient==="${Ec}"?90:0`;function Gxe(e,t){e=Me(e)?{text:e}:e;const n=tr(e,t.config.title),r=e.encode||{},i=r.group||{},o=i.name||void 0,a=i.interactive,s=i.style,u=[],l={},c=ne(t.add(bi(null,[l])));return u.push(Xxe(e,n,Yxe(e),c)),e.subtitle&&u.push(Kxe(e,n,r.subtitle,c)),$y(n0({role:Uve,from:c,encode:Vxe(n,i),marks:u,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:o,interactive:a,style:s}),t)}function Yxe(e){const t=e.encode;return t&&t.title||pe({name:e.name,interactive:e.interactive,style:e.style},t)}function Vxe(e,t){const n={enter:{},update:{}};return Zt(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:ZS},angle:{signal:Wxe},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),xc(n,t,t0)}function Xxe(e,t,n,r){const i={value:0},o=e.text,a={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return Zt(a,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Ar({type:Au,role:qve,style:txe,from:r,encode:a},n)}function Kxe(e,t,n,r){const i={value:0},o=e.subtitle,a={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return Zt(a,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Ar({type:Au,role:Hve,style:nxe,from:r,encode:a},n)}function Zxe(e,t){const n=[];e.transform&&e.transform.forEach(r=>{n.push(eC(r,t))}),e.on&&e.on.forEach(r=>{Bj(r,t,e.name)}),t.addDataPipeline(e.name,Jxe(e,t,n))}function Jxe(e,t,n){const r=[];let i=null,o=!1,a=!1,s,u,l,c,f;for(e.values?kt(e.values)||my(e.format)?(r.push(Uj(t,e)),r.push(i=Cu())):r.push(i=Cu({$ingest:e.values,$format:e.format})):e.url?my(e.url)||my(e.format)?(r.push(Uj(t,e)),r.push(i=Cu())):r.push(i=Cu({$request:e.url,$format:e.format})):e.source&&(i=s=ae(e.source).map(d=>ne(t.getData(d).output)),r.push(null)),u=0,l=n.length;u<l;++u)c=n[u],f=c.metadata,!i&&!f.source&&r.push(i=Cu()),r.push(c),f.generates&&(a=!0),f.modifies&&!a&&(o=!0),f.source?i=c:f.changes&&(i=null);return s&&(l=s.length-1,r[0]=Mbe({derive:o,pulse:l?s:s[0]}),(o||l)&&r.splice(1,0,Cu())),i||r.push(Cu()),r.push($u({})),r}function Cu(e){const t=bi({},e);return t.metadata={source:!0},t}function Uj(e,t){return Ebe({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const qj=e=>e===Qa||e===xi,Ay=(e,t,n)=>kt(e)?n2e(e.signal,t,n):e===_c||e===xi?t:n,Ut=(e,t,n)=>kt(e)?e2e(e.signal,t,n):qj(e)?t:n,wi=(e,t,n)=>kt(e)?t2e(e.signal,t,n):qj(e)?n:t,Hj=(e,t,n)=>kt(e)?r2e(e.signal,t,n):e===xi?{value:t}:{value:n},Qxe=(e,t,n)=>kt(e)?i2e(e.signal,t,n):e===Ec?{value:t}:{value:n},e2e=(e,t,n)=>Wj(`${e} === '${xi}' || ${e} === '${Qa}'`,t,n),t2e=(e,t,n)=>Wj(`${e} !== '${xi}' && ${e} !== '${Qa}'`,t,n),n2e=(e,t,n)=>nC(`${e} === '${_c}' || ${e} === '${xi}'`,t,n),r2e=(e,t,n)=>nC(`${e} === '${xi}'`,t,n),i2e=(e,t,n)=>nC(`${e} === '${Ec}'`,t,n),Wj=(e,t,n)=>(t=t!=null?zt(t):t,n=n!=null?zt(n):n,Gj(t)&&Gj(n)?(t=t?t.signal||re(t.value):null,n=n?n.signal||re(n.value):null,{signal:`${e} ? (${t}) : (${n})`}):[pe({test:e},t)].concat(n||[])),Gj=e=>e==null||Object.keys(e).length===1,nC=(e,t,n)=>({signal:`${e} ? (${Ac(t)}) : (${Ac(n)})`}),o2e=(e,t,n,r,i)=>({signal:(r!=null?`${e} === '${_c}' ? (${Ac(r)}) : `:"")+(n!=null?`${e} === '${Qa}' ? (${Ac(n)}) : `:"")+(i!=null?`${e} === '${Ec}' ? (${Ac(i)}) : `:"")+(t!=null?`${e} === '${xi}' ? (${Ac(t)}) : `:"")+"(null)"}),Ac=e=>kt(e)?e.signal:e==null?null:re(e),a2e=(e,t)=>t===0?0:kt(e)?{signal:`(${e.signal}) * ${t}`}:{value:e*t},Sc=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function Cc(e,t,n,r){let i;if(t&&se(t,e))return t[e];if(se(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=e[5].toLowerCase()+e.slice(6)}return r[GS][i]}else if(e.startsWith("label")){switch(e){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=e[5].toLowerCase()+e.slice(6)}return r[e0][i]}return null}function Yj(e){const t={};for(const n of e)if(!!n)for(const r in n)t[r]=1;return Object.keys(t)}function s2e(e,t){var n=t.config,r=n.style,i=n.axis,o=t.scaleType(e.scale)==="band"&&n.axisBand,a=e.orient,s,u,l;if(kt(a)){const f=Yj([n.axisX,n.axisY]),d=Yj([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);s={};for(l of f)s[l]=Ut(a,Cc(l,n.axisX,i,r),Cc(l,n.axisY,i,r));u={};for(l of d)u[l]=o2e(a.signal,Cc(l,n.axisTop,i,r),Cc(l,n.axisBottom,i,r),Cc(l,n.axisLeft,i,r),Cc(l,n.axisRight,i,r))}else s=a===xi||a===Qa?n.axisX:n.axisY,u=n["axis"+a[0].toUpperCase()+a.slice(1)];return s||u||o?pe({},i,s,u,o):i}function u2e(e,t,n,r){const i=tr(e,t),o=e.orient;let a,s;const u={enter:a={opacity:Fe},update:s={opacity:Hr},exit:{opacity:Fe}};Zt(u,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});const l=Vj(e,0),c=Vj(e,1);return a.x=s.x=Ut(o,l,Fe),a.x2=s.x2=Ut(o,c),a.y=s.y=wi(o,l,Fe),a.y2=s.y2=wi(o,c),Ar({type:KS,role:Mve,from:r,encode:u},n)}function Vj(e,t){return{scale:e.scale,range:t}}function l2e(e,t,n,r,i){const o=tr(e,t),a=e.orient,s=e.gridScale,u=Ay(a,1,-1),l=c2e(e.offset,u);let c,f,d;const h={enter:c={opacity:Fe},update:d={opacity:Hr},exit:f={opacity:Fe}};Zt(h,{stroke:o("gridColor"),strokeCap:o("gridCap"),strokeDash:o("gridDash"),strokeDashOffset:o("gridDashOffset"),strokeOpacity:o("gridOpacity"),strokeWidth:o("gridWidth")});const g={scale:e.scale,field:qr,band:i.band,extra:i.extra,offset:i.offset,round:o("tickRound")},p=Ut(a,{signal:"height"},{signal:"width"}),m=s?{scale:s,range:0,mult:u,offset:l}:{value:0,offset:l},y=s?{scale:s,range:1,mult:u,offset:l}:pe(p,{mult:u,offset:l});return c.x=d.x=Ut(a,g,m),c.y=d.y=wi(a,g,m),c.x2=d.x2=wi(a,y),c.y2=d.y2=Ut(a,y),f.x=Ut(a,g),f.y=wi(a,g),Ar({type:KS,role:Dve,key:qr,from:r,encode:h},n)}function c2e(e,t){if(t!==1)if(!le(e))e=kt(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);else{let n=e=pe({},e);for(;n.mult!=null;)if(le(n.mult))n=n.mult=pe({},n.mult);else return n.mult=kt(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n.mult=t}return e}function f2e(e,t,n,r,i,o){const a=tr(e,t),s=e.orient,u=Ay(s,-1,1);let l,c,f;const d={enter:l={opacity:Fe},update:f={opacity:Hr},exit:c={opacity:Fe}};Zt(d,{stroke:a("tickColor"),strokeCap:a("tickCap"),strokeDash:a("tickDash"),strokeDashOffset:a("tickDashOffset"),strokeOpacity:a("tickOpacity"),strokeWidth:a("tickWidth")});const h=zt(i);h.mult=u;const g={scale:e.scale,field:qr,band:o.band,extra:o.extra,offset:o.offset,round:a("tickRound")};return f.y=l.y=Ut(s,Fe,g),f.y2=l.y2=Ut(s,h),c.x=Ut(s,g),f.x=l.x=wi(s,Fe,g),f.x2=l.x2=wi(s,h),c.y=wi(s,g),Ar({type:KS,role:Tve,key:qr,from:r,encode:d},n)}function rC(e,t,n,r,i){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+r+","+i+")"}}function d2e(e,t,n,r,i,o){const a=tr(e,t),s=e.orient,u=e.scale,l=Ay(s,-1,1),c=Eu(a("labelFlush")),f=Eu(a("labelFlushOffset")),d=a("labelAlign"),h=a("labelBaseline");let g=c===0||!!c,p;const m=zt(i);m.mult=l,m.offset=zt(a("labelPadding")||0),m.offset.mult=l;const y={scale:u,field:qr,band:.5,offset:Fj(o.offset,a("labelOffset"))},v=Ut(s,g?rC(u,c,'"left"','"right"','"center"'):{value:"center"},Qxe(s,"left","right")),b=Ut(s,Hj(s,"bottom","top"),g?rC(u,c,'"top"','"bottom"','"middle"'):{value:"middle"}),x=rC(u,c,`-(${f})`,f,0);g=g&&f;const w={opacity:Fe,x:Ut(s,y,m),y:wi(s,y,m)},E={enter:w,update:p={opacity:Hr,text:{field:WS},x:w.x,y:w.y,align:v,baseline:b},exit:{opacity:Fe,x:w.x,y:w.y}};Zt(E,{dx:!d&&g?Ut(s,x):null,dy:!h&&g?wi(s,x):null}),Zt(E,{angle:a("labelAngle"),fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontWeight:a("labelFontWeight"),fontStyle:a("labelFontStyle"),limit:a("labelLimit"),lineHeight:a("labelLineHeight")},{align:d,baseline:h});const _=a("labelBound");let S=a("labelOverlap");return S=S||_?{separation:a("labelSeparation"),method:S,order:"datum.index",bound:_?{scale:u,orient:s,tolerance:_}:null}:void 0,p.align!==v&&(p.align=Sc(p.align,v)),p.baseline!==b&&(p.baseline=Sc(p.baseline,b)),Ar({type:Au,role:Nve,style:e0,key:qr,from:r,encode:E,overlap:S},n)}function h2e(e,t,n,r){const i=tr(e,t),o=e.orient,a=Ay(o,-1,1);let s,u;const l={enter:s={opacity:Fe,anchor:zt(i("titleAnchor",null)),align:{signal:ZS}},update:u=pe({},s,{opacity:Hr,text:zt(e.title)}),exit:{opacity:Fe}},c={signal:`lerp(range("${e.scale}"), ${wy(0,1,.5)})`};return u.x=Ut(o,c),u.y=wi(o,c),s.angle=Ut(o,Fe,a2e(a,90)),s.baseline=Ut(o,Hj(o,Qa,xi),{value:Qa}),u.angle=s.angle,u.baseline=s.baseline,Zt(l,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),g2e(i,o,l,n),l.update.align=Sc(l.update.align,s.align),l.update.angle=Sc(l.update.angle,s.angle),l.update.baseline=Sc(l.update.baseline,s.baseline),Ar({type:Au,role:Rve,style:GS,from:r,encode:l},n)}function g2e(e,t,n,r){const i=(s,u)=>s!=null?(n.update[u]=Sc(zt(s),n.update[u]),!1):!wc(u,r),o=i(e("titleX"),"x"),a=i(e("titleY"),"y");n.enter.auto=a===o?zt(a):Ut(t,zt(a),zt(o))}function p2e(e,t){const n=s2e(e,t),r=e.encode||{},i=r.axis||{},o=i.name||void 0,a=i.interactive,s=i.style,u=tr(e,n),l=fxe(u),c={scale:e.scale,ticks:!!u("ticks"),labels:!!u("labels"),grid:!!u("grid"),domain:!!u("domain"),title:e.title!=null},f=ne(t.add(bi({},[c]))),d=ne(t.add(mbe({scale:t.scaleRef(e.scale),extra:t.property(l.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),h=[];let g;return c.grid&&h.push(l2e(e,n,r.grid,d,l)),c.ticks&&(g=u("tickSize"),h.push(f2e(e,n,r.ticks,d,g,l))),c.labels&&(g=c.ticks?g:0,h.push(d2e(e,n,r.labels,d,g,l))),c.domain&&h.push(u2e(e,n,r.domain,f)),c.title&&h.push(h2e(e,n,r.title,f)),$y(n0({role:kve,from:f,encode:xc(m2e(u,e),i,t0),marks:h,aria:u("aria"),description:u("description"),zindex:u("zindex"),name:o,interactive:a,style:s}),t)}function m2e(e,t){const n={enter:{},update:{}};return Zt(n,{orient:e("orient"),offset:e("offset")||0,position:vi(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function Xj(e,t,n){const r=ae(e.signals),i=ae(e.scales);return n||r.forEach(o=>fj(o,t)),ae(e.projections).forEach(o=>Vbe(o,t)),i.forEach(o=>Pbe(o,t)),ae(e.data).forEach(o=>Zxe(o,t)),i.forEach(o=>Lbe(o,t)),(n||r).forEach(o=>pbe(o,t)),ae(e.axes).forEach(o=>p2e(o,t)),ae(e.marks).forEach(o=>$y(o,t)),ae(e.legends).forEach(o=>Ixe(o,t)),e.title&&Gxe(e.title,t),t.parseLambdas(),t}const y2e=e=>xc({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function v2e(e,t){const n=t.config,r=ne(t.root=t.add(gy())),i=b2e(e,n);i.forEach(l=>fj(l,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const o=t.add(bi()),a=t.add(yj(lj(y2e(e.encode),xy,RS,e.style,t,{pulse:ne(o)}))),s=t.add(xj({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:r,pulse:ne(a)}));t.operators.pop(),t.pushState(ne(a),ne(s),null),Xj(e,t,i),t.operators.push(s);let u=t.add(pj({mark:r,pulse:ne(s)}));return u=t.add(bj({pulse:ne(u)})),u=t.add($u({pulse:ne(u)})),t.addData("root",new Su(t,o,o,u)),t}function i0(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function b2e(e,t){const n=a=>vi(e[a],t[a]),r=[i0("background",n("background")),i0("autosize",Cve(n("autosize"))),i0("padding",Fve(n("padding"))),i0("width",n("width")||0),i0("height",n("height")||0)],i=r.reduce((a,s)=>(a[s.name]=s,a),{}),o={};return ae(e.signals).forEach(a=>{se(i,a.name)?a=pe(i[a.name],a):r.push(a),o[a.name]=a}),ae(t.signals).forEach(a=>{!se(o,a.name)&&!se(i,a.name)&&r.push(a)}),r}function Kj(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function Zj(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}Kj.prototype=Zj.prototype={parse(e){return Xj(e,this)},fork(){return new Zj(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){const t=e instanceof jS?ne(e):e;return this.add(kbe({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;this.root&&(this.root.root=!0);for(e in this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(r,i,o){let a,s;r&&(a=r.data||(r.data={}),s=a[i]||(a[i]=[]),s.push(o))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const r in t.index)n(t.index[r],e,"index:"+r)}return this},pushState(e,t,n){this._encode.push(ne(this.add($u({pulse:e})))),this._parent.push(t),this._lookup.push(n?ne(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return Se(this._parent)},encode(){return Se(this._encode)},lookup(){return Se(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(Me(e))return Jh(e,t);e.signal||B("Unsupported field reference: "+re(e));const n=e.signal;let r=this.field[n];if(!r){const i={name:this.signalRef(n)};t&&(i.as=t),this.field[n]=r=ne(this.add(xbe(i)))}return r},compareRef(e){let t=!1;const n=o=>kt(o)?(t=!0,this.signalRef(o.signal)):obe(o)?(t=!0,this.exprRef(o.expr)):o,r=ae(e.field).map(n),i=ae(e.order).map(n);return t?ne(this.add(mj({fields:r,orders:i}))):dj(r,i)},keyRef(e,t){let n=!1;const r=o=>kt(o)?(n=!0,ne(i[o.signal])):o,i=this.signals;return e=ae(e).map(r),n?ne(this.add(wbe({fields:e,flat:t}))):tbe(e,t)},sortRef(e){if(!e)return e;const t=py(e.op,e.field),n=e.order||nbe;return n.signal?ne(this.add(mj({fields:t,orders:this.signalRef(n.signal)}))):dj(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const r=this.id();this.streams.push({id:r,source:e,type:t}),this.events[n]=r}return this.events[n]},hasOwnSignal(e){return se(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&B("Duplicate signal name: "+re(e));const n=t instanceof jS?t:this.add(gy(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||B("Unrecognized signal name: "+re(e)),this.signals[e]},signalRef(e){return this.signals[e]?ne(this.signals[e]):(se(this.lambdas,e)||(this.lambdas[e]=this.add(gy(null))),ne(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const r=e[t],i=lo(r,this),o=this.lambdas[r];o.params=i.$params,o.update=i.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return!e||!le(e)?e:this.signalRef(e.signal||iC(e))},exprRef(e,t){const n={expr:lo(e,this)};return t&&(n.expr.$name=t),ne(this.add(vbe(n)))},addBinding(e,t){this.bindings||B("Nested signals do not support binding: "+re(e)),this.bindings.push(pe({signal:e},t))},addScaleProj(e,t){se(this.scales,e)&&B("Duplicate scale or projection name: "+re(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,Dbe(t))},addProjection(e,t){this.addScaleProj(e,Fbe(t))},getScale(e){return this.scales[e]||B("Unrecognized scale name: "+re(e)),this.scales[e]},scaleRef(e){return ne(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return se(this.data,e)&&B("Duplicate data set name: "+re(e)),this.data[e]=t},getData(e){return this.data[e]||B("Undefined data set name: "+re(e)),this.data[e]},addDataPipeline(e,t){return se(this.data,e)&&B("Duplicate data set name: "+re(e)),this.addData(e,Su.fromEntries(this,t))}};function iC(e){return(ee(e)?x2e:w2e)(e)}function x2e(e){const t=e.length;let n="[";for(let r=0;r<t;++r){const i=e[r];n+=(r>0?",":"")+(le(i)?i.signal||iC(i):re(i))}return n+"]"}function w2e(e){let t="{",n=0,r,i;for(r in e)i=e[r],t+=(++n>1?",":"")+re(r)+":"+(le(i)?i.signal||iC(i):re(i));return t+"}"}function _2e(){const e="sans-serif",t=30,n=2,r="#4c78a8",i="#000",o="#888",a="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:r},area:{fill:r},image:null,line:{stroke:r,strokeWidth:n},path:{stroke:r},rect:{fill:r},rule:{stroke:i},shape:{stroke:r},symbol:{fill:r,size:64},text:{fill:i,font:e,fontSize:11},trail:{fill:r,size:n},style:{"guide-label":{fill:i,font:e,fontSize:10},"guide-title":{fill:i,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:i,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:i,font:e,fontSize:12},point:{size:t,strokeWidth:n,shape:"circle"},circle:{size:t,strokeWidth:n},square:{size:t,strokeWidth:n,shape:"square"},cell:{fill:"transparent",stroke:a}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:o,grid:!1,gridWidth:1,gridColor:a,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:o,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:a,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:o,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function E2e(e,t,n){return le(e)||B("Input Vega specification must be an object."),t=Ug(_2e(),t,e.config),v2e(e,new Kj(t,n)).toRuntime()}var $2e="vega",A2e="5.21.0",S2e="The Vega visualization grammar.",C2e=["vega","visualization","interaction","dataflow","library","data","d3"],O2e="BSD-3-Clause",F2e="UW Interactive Data Lab (http://idl.cs.washington.edu)",k2e="build/vega-node.js",M2e="build/vega.module.js",D2e="build/vega.min.js",N2e="build/vega.min.js",T2e="index.d.ts",R2e="vega/vega",P2e={bundle:"rollup -c --config-bundle",prebuild:"rimraf build && rimraf build-es5",build:"rollup -c --config-core --config-bundle --config-ie",postbuild:"node schema-copy",pretest:"yarn build --config-test",test:"TZ=America/Los_Angeles tape 'test/**/*-test.js'",prepublishOnly:"yarn test && yarn build",postpublish:"./schema-deploy.sh"},L2e={"vega-crossfilter":"~4.0.5","vega-dataflow":"~5.7.4","vega-encode":"~4.8.3","vega-event-selector":"~3.0.0","vega-expression":"~5.0.0","vega-force":"~4.0.7","vega-format":"~1.0.4","vega-functions":"~5.12.1","vega-geo":"~4.3.8","vega-hierarchy":"~4.0.9","vega-label":"~1.1.0","vega-loader":"~4.4.1","vega-parser":"~6.1.4","vega-projection":"~1.4.5","vega-regression":"~1.0.9","vega-runtime":"~6.1.3","vega-scale":"~7.1.1","vega-scenegraph":"~4.9.4","vega-statistics":"~1.7.10","vega-time":"~2.0.4","vega-transforms":"~4.9.4","vega-typings":"~0.22.0","vega-util":"~1.17.0","vega-view":"~5.10.1","vega-view-transforms":"~4.5.8","vega-voronoi":"~4.1.5","vega-wordcloud":"~4.1.3"},j2e={"vega-schema":"*"},I2e="774165e29850b66ec8b79ba52a7955f1ab936ea6",B2e={name:$2e,version:A2e,description:S2e,keywords:C2e,license:O2e,author:F2e,main:k2e,module:M2e,unpkg:D2e,jsdelivr:N2e,types:T2e,repository:R2e,scripts:P2e,dependencies:L2e,devDependencies:j2e,gitHead:I2e};pe(Fl,bne,ule,lce,Cde,xhe,J0e,E0e,ege,yge,Cge,Ige);const z2e=B2e.version;var U2e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",version:z2e,Dataflow:Ol,EventStream:cp,MultiPulse:c2,Operator:Ve,Parameters:lp,Pulse:Ca,Transform:R,changeset:Us,definition:w5,ingest:Ie,isTuple:ap,transform:_5,transforms:Fl,tupleid:te,interpolate:__,interpolateColors:Vp,interpolateRange:P6,quantizeInterpolator:L6,scale:Pe,scheme:E_,projection:O$,View:YL,defaultLocale:r2,formatLocale:ep,locale:e5,resetDefaultLocale:see,timeFormatLocale:ed,expressionFunction:_t,parse:E2e,runtimeContext:$L,codegenExpression:hP,parseExpression:cP,parseSelector:nj,Debug:lM,Error:vx,Info:uM,None:aM,Warn:sM,accessor:qn,accessorFields:tn,accessorName:ft,array:ae,ascending:Yg,clampRange:_M,compare:_x,constant:rn,debounce:Ex,error:B,extend:pe,extent:ji,extentIndex:EM,falsy:xa,fastmap:xl,field:Hn,flush:$M,hasOwnProperty:se,id:Mf,identity:En,inherits:H,inrange:wl,isArray:ee,isBoolean:$x,isDate:wa,isFunction:ye,isIterable:AM,isNumber:_a,isObject:le,isRegExp:SM,isString:Me,key:Ax,lerp:CM,logger:cM,lruCache:OM,merge:FM,mergeConfig:Ug,one:bl,pad:kM,panLinear:mM,panLog:yM,panPow:vM,panSymlog:bM,peek:Se,quarter:xM,repeat:Nf,span:Tf,splitAccessPath:zg,stringValue:re,toBoolean:Sx,toDate:Cx,toNumber:nn,toSet:oi,toString:Ox,truncate:MM,truthy:Dr,utcquarter:wM,visitArray:Ea,writeConfig:Df,zero:ba,zoomLinear:bx,zoomLog:xx,zoomPow:Gg,zoomSymlog:wx,bandwidthNRD:m2,bin:C5,bootstrapCI:O5,cumulativeLogNormal:_2,cumulativeNormal:gp,cumulativeUniform:S2,densityLogNormal:w2,densityNormal:y2,densityUniform:A2,dotbin:F5,quantileLogNormal:E2,quantileNormal:pp,quantileUniform:C2,quantiles:g2,quartiles:p2,get random(){return Tr},randomInteger:yte,randomKDE:b2,randomLCG:mte,randomLogNormal:M5,randomMixture:D5,randomNormal:v2,randomUniform:N5,regressionExp:R5,regressionLinear:O2,regressionLoess:B5,regressionLog:T5,regressionPoly:L5,regressionPow:P5,regressionQuad:F2,sampleCurve:yp,sampleLogNormal:x2,sampleNormal:hp,sampleUniform:$2,setRandom:gte,DATE:Yn,DAY:an,DAYOFYEAR:Ii,HOURS:pr,MILLISECONDS:ai,MINUTES:mr,MONTH:on,QUARTER:Gn,SECONDS:Nr,TIME_UNITS:Lx,WEEK:St,YEAR:Yt,dayofyear:rD,timeBin:_D,timeFloor:cD,timeInterval:$l,timeOffset:hD,timeSequence:mD,timeUnitSpecifier:nD,timeUnits:Ix,utcFloor:fD,utcInterval:Al,utcOffset:gD,utcSequence:yD,utcdayofyear:aD,utcweek:sD,week:iD,format:np,formats:s2,inferType:r5,inferTypes:i5,loader:rp,read:u5,responseType:s5,typeParsers:i2,Bounds:Ot,CanvasHandler:zd,CanvasRenderer:wm,Gradient:Q6,GroupItem:em,Handler:Ba,Item:Qp,Marks:yr,RenderType:Ua,Renderer:Zi,ResourceLoader:T_,SVGHandler:lE,SVGRenderer:mE,SVGStringRenderer:bE,Scenegraph:iE,boundClip:y4,boundContext:Dd,boundItem:rE,boundMark:D8,boundStroke:Uo,domChild:Xn,domClear:ci,domCreate:Ia,domFind:oE,font:dm,fontFamily:Ld,fontSize:Ki,intersect:h4,intersectBoxLine:Yl,intersectPath:z_,intersectPoint:U_,intersectRule:y8,lineHeight:La,markup:pE,multiLineOffset:eE,pathCurves:O_,pathEqual:v4,pathParse:Hl,pathRectangle:a8,pathRender:Cd,pathSymbols:o8,pathTrail:s8,point:gm,renderModule:Em,resetSVGClipId:l8,resetSVGDefIds:$ue,sceneEqual:wE,sceneFromJSON:T8,scenePickVisit:sm,sceneToJSON:N8,sceneVisit:li,sceneZOrder:q_,serializeXML:n4,textMetrics:Xi});function q2e(e,t,n){let r;t.x2&&(t.x?(n&&e.x>e.x2&&(r=e.x,e.x=e.x2,e.x2=r),e.width=e.x2-e.x):e.x=e.x2-(e.width||0)),t.xc&&(e.x=e.xc-(e.width||0)/2),t.y2&&(t.y?(n&&e.y>e.y2&&(r=e.y,e.y=e.y2,e.y2=r),e.height=e.y2-e.y):e.y=e.y2-(e.height||0)),t.yc&&(e.y=e.yc-(e.height||0)/2)}var H2e={NaN:NaN,E:Math.E,LN2:Math.LN2,LN10:Math.LN10,LOG2E:Math.LOG2E,LOG10E:Math.LOG10E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,MIN_VALUE:Number.MIN_VALUE,MAX_VALUE:Number.MAX_VALUE},W2e={"*":(e,t)=>e*t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,">":(e,t)=>e>t,"<":(e,t)=>e<t,"<=":(e,t)=>e<=t,">=":(e,t)=>e>=t,"==":(e,t)=>e==t,"!=":(e,t)=>e!=t,"===":(e,t)=>e===t,"!==":(e,t)=>e!==t,"&":(e,t)=>e&t,"|":(e,t)=>e|t,"^":(e,t)=>e^t,"<<":(e,t)=>e<<t,">>":(e,t)=>e>>t,">>>":(e,t)=>e>>>t},G2e={"+":e=>+e,"-":e=>-e,"~":e=>~e,"!":e=>!e};const Y2e=Array.prototype.slice,Ou=(e,t,n)=>{const r=n?n(t[0]):t[0];return r[e].apply(r,Y2e.call(t,1))},V2e=(e,t,n,r,i,o,a)=>new Date(e,t||0,n!=null?n:1,r||0,i||0,o||0,a||0);var X2e={isNaN:Number.isNaN,isFinite:Number.isFinite,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:Math.atan2,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,pow:Math.pow,random:Math.random,round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,clamp:(e,t,n)=>Math.max(t,Math.min(n,e)),now:Date.now,utc:Date.UTC,datetime:V2e,date:e=>new Date(e).getDate(),day:e=>new Date(e).getDay(),year:e=>new Date(e).getFullYear(),month:e=>new Date(e).getMonth(),hours:e=>new Date(e).getHours(),minutes:e=>new Date(e).getMinutes(),seconds:e=>new Date(e).getSeconds(),milliseconds:e=>new Date(e).getMilliseconds(),time:e=>new Date(e).getTime(),timezoneoffset:e=>new Date(e).getTimezoneOffset(),utcdate:e=>new Date(e).getUTCDate(),utcday:e=>new Date(e).getUTCDay(),utcyear:e=>new Date(e).getUTCFullYear(),utcmonth:e=>new Date(e).getUTCMonth(),utchours:e=>new Date(e).getUTCHours(),utcminutes:e=>new Date(e).getUTCMinutes(),utcseconds:e=>new Date(e).getUTCSeconds(),utcmilliseconds:e=>new Date(e).getUTCMilliseconds(),length:e=>e.length,join:function(){return Ou("join",arguments)},indexof:function(){return Ou("indexOf",arguments)},lastindexof:function(){return Ou("lastIndexOf",arguments)},slice:function(){return Ou("slice",arguments)},reverse:e=>e.slice().reverse(),parseFloat,parseInt,upper:e=>String(e).toUpperCase(),lower:e=>String(e).toLowerCase(),substring:function(){return Ou("substring",arguments,String)},split:function(){return Ou("split",arguments,String)},replace:function(){return Ou("replace",arguments,String)},trim:e=>String(e).trim(),regexp:RegExp,test:(e,t)=>RegExp(e).test(t)};const K2e=["view","item","group","xy","x","y"],Z2e={Literal:(e,t)=>t.value,Identifier:(e,t)=>{const n=t.name;return e.memberDepth>0?n:n==="datum"?e.datum:n==="event"?e.event:n==="item"?e.item:H2e[n]||e.params["$"+n]},MemberExpression:(e,t)=>{const n=!t.computed,r=e(t.object);n&&(e.memberDepth+=1);const i=e(t.property);return n&&(e.memberDepth-=1),r[i]},CallExpression:(e,t)=>{const n=t.arguments;let r=t.callee.name;return r.startsWith("_")&&(r=r.slice(1)),r==="if"?e(n[0])?e(n[1]):e(n[2]):(e.fn[r]||X2e[r]).apply(e.fn,n.map(e))},ArrayExpression:(e,t)=>t.elements.map(e),BinaryExpression:(e,t)=>W2e[t.operator](e(t.left),e(t.right)),UnaryExpression:(e,t)=>G2e[t.operator](e(t.argument)),ConditionalExpression:(e,t)=>e(t.test)?e(t.consequent):e(t.alternate),LogicalExpression:(e,t)=>t.operator==="&&"?e(t.left)&&e(t.right):e(t.left)||e(t.right),ObjectExpression:(e,t)=>t.properties.reduce((n,r)=>{e.memberDepth+=1;const i=e(r.key);return e.memberDepth-=1,n[i]=e(r.value),n},{})};function o0(e,t,n,r,i,o){const a=s=>Z2e[s.type](a,s);return a.memberDepth=0,a.fn=Object.create(t),a.params=n,a.datum=r,a.event=i,a.item=o,K2e.forEach(s=>a.fn[s]=(...u)=>i.vega[s](...u)),a(e)}var J2e={operator(e,t){const n=t.ast,r=e.functions;return i=>o0(n,r,i)},parameter(e,t){const n=t.ast,r=e.functions;return(i,o)=>o0(n,r,o,i)},event(e,t){const n=t.ast,r=e.functions;return i=>o0(n,r,void 0,void 0,i)},handler(e,t){const n=t.ast,r=e.functions;return(i,o)=>{const a=o.item&&o.item.datum;return o0(n,r,i,a,o)}},encode(e,t){const{marktype:n,channels:r}=t,i=e.functions,o=n==="group"||n==="image"||n==="rect";return(a,s)=>{const u=a.datum;let l=0,c;for(const f in r)c=o0(r[f].ast,i,s,u,void 0,a),a[f]!==c&&(a[f]=c,l=1);return n!=="rule"&&q2e(a,r,o),l}}};const Q2e="vega-lite",ewe='Dominik Moritz, Kanit "Ham" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer',twe="5.1.1",nwe=["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],rwe="https://vega.github.io/vega-lite/",iwe="Vega-Lite is a concise high-level language for interactive visualization.",owe="build/vega-lite.js",awe="build/vega-lite.min.js",swe="build/vega-lite.min.js",uwe="build/src/index",lwe="build/src/index.d.ts",cwe={vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2pdf:"./bin/vl2pdf",vl2vg:"./bin/vl2vg"},fwe={test:"test"},dwe=["bin","build","src","vega-lite*","tsconfig.json"],hwe={changelog:"conventional-changelog -p angular -r 2",prebuild:"yarn clean:build",build:"yarn build:only","build:only":"tsc -p tsconfig.build.json && rollup -c","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"rollup -c site/rollup.config.js","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh",clean:"yarn clean:build && del-cli 'site/data/*' 'examples/compiled/*.png' && find site/examples ! -name 'index.md' ! -name 'data' -type f -delete","clean:build":"del-cli 'build/*' !build/vega-lite-schema.json","predeploy:site":"yarn presite","deploy:site":"gh-pages -d site",data:"rsync -r node_modules/vega-datasets/data/* site/data",schema:"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/",renameschema:"scripts/rename-schema.sh",presite:"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh",site:"yarn site:only","site:only":"pushd site && bundle exec jekyll serve -I -l && popd",prettierbase:"prettier '**/*.{md,css,yml}'",eslintbase:"eslint .",format:"yarn eslintbase --fix && yarn prettierbase --write",lint:"yarn eslintbase && yarn prettierbase --check",jest:"NODE_OPTIONS=--experimental-vm-modules npx jest",test:"yarn jest test/ && yarn lint && yarn schema && yarn jest examples/ && yarn test:runtime","test:cover":"yarn jest --collectCoverage test/","test:inspect":"node --inspect-brk --experimental-vm-modules ./node_modules/.bin/jest --runInBand test","test:runtime":"NODE_OPTIONS=--experimental-vm-modules TZ=America/Los_Angeles npx jest test-runtime/ --config test-runtime/jest-config.json","test:runtime:generate":"yarn build:only && del-cli test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime",watch:"tsc -p tsconfig.build.json -w","watch:site":"yarn build:site -w","watch:test":"yarn jest --watch test/"},gwe={type:"git",url:"https://github.com/vega/vega-lite.git"},pwe="BSD-3-Clause",mwe={url:"https://github.com/vega/vega-lite/issues"},ywe={"@babel/core":"^7.15.0","@babel/preset-env":"^7.15.0","@babel/preset-typescript":"^7.15.0","@rollup/plugin-babel":"^5.3.0","@rollup/plugin-commonjs":"^20.0.0","@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^13.0.4","@types/chai":"^4.2.21","@types/d3":"^7.0.0","@types/jest":"^27.0.1","@types/mkdirp":"^1.0.2","@types/pako":"^1.0.2","@typescript-eslint/eslint-plugin":"^4.29.2","@typescript-eslint/parser":"^4.29.2",ajv:"^8.6.2","ajv-formats":"^2.1.1",chai:"^4.3.4",cheerio:"^1.0.0-rc.10","conventional-changelog-cli":"^2.1.1",d3:"^7.0.1","del-cli":"^4.0.1",eslint:"^7.32.0","eslint-config-prettier":"^8.3.0","eslint-plugin-jest":"^24.4.0","eslint-plugin-prettier":"^4.0.0","gh-pages":"^3.2.3","highlight.js":"^11.2.0",jest:"^27.0.6","jest-dev-server":"^5.0.3",mkdirp:"^1.0.4",pako:"^2.0.4",prettier:"^2.3.2",puppeteer:"^10.2.0",rollup:"^2.56.3","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-sourcemaps":"^0.6.3","rollup-plugin-terser":"^7.0.2",serve:"^12.0.0",terser:"^5.7.1","ts-jest":"^27.0.5","ts-json-schema-generator":"^0.95.0",typescript:"~4.4.2","vega-cli":"^5.20.2","vega-datasets":"~2.2.0","vega-embed":"^6.18.2","vega-tooltip":"^0.27.0","yaml-front-matter":"^4.1.1"},vwe={"@types/clone":"~2.1.1","array-flat-polyfill":"^1.0.1",clone:"~2.1.2","fast-deep-equal":"~3.1.3","fast-json-stable-stringify":"~2.1.0","json-stringify-pretty-compact":"~3.0.0",tslib:"~2.3.1","vega-event-selector":"~2.0.6","vega-expression":"~4.0.1","vega-util":"~1.16.1",yargs:"~17.1.1"},bwe={vega:"^5.20.2"},xwe={node:">=12"};var wwe={name:Q2e,author:ewe,version:twe,collaborators:nwe,homepage:rwe,description:iwe,main:owe,unpkg:awe,jsdelivr:swe,module:uwe,types:lwe,bin:cwe,directories:fwe,files:dwe,scripts:hwe,repository:gwe,license:pwe,bugs:mwe,devDependencies:ywe,dependencies:vwe,peerDependencies:bwe,engines:xwe};function Oc(e,t,n){return e.fields=t||[],e.fname=n,e}function _we(e){return e.length===1?Ewe(e[0]):$we(e)}const Ewe=e=>function(t){return t[e]},$we=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function oC(e){throw Error(e)}function Fu(e){const t=[],n=e.length;let r=null,i=0,o="",a,s,u;e=e+"";function l(){t.push(o+e.substring(a,s)),o="",a=s+1}for(a=s=0;s<n;++s)if(u=e[s],u==="\\")o+=e.substring(a,s),o+=e.substring(++s,++s),a=s;else if(u===r)l(),r=null,i=-1;else{if(r)continue;a===i&&u==='"'||a===i&&u==="'"?(a=s+1,r=u):u==="."&&!i?s>a?l():a=s+1:u==="["?(s>a&&l(),i=a=s+1):u==="]"&&(i||oC("Access path missing open bracket: "+e),i>0&&l(),i=0,a=s+1)}return i&&oC("Access path missing closing bracket: "+e),r&&oC("Access path missing closing quote: "+e),s>a&&(s++,l()),t}function Awe(e,t,n){const r=Fu(e);return e=r.length===1?r[0]:e,Oc((n&&n.get||_we)(r),[e],t||e)}Awe("id");const Swe=Oc(e=>e,[],"identity");Oc(()=>0,[],"zero");Oc(()=>1,[],"one");Oc(()=>!0,[],"true");Oc(()=>!1,[],"false");function Sy(e,t,n){const r=[t].concat([].slice.call(n));console[e].apply(console,r)}const Cwe=0,Owe=1,Jj=2,Fwe=3,kwe=4;function Mwe(e,t){let n=e||Cwe;return{level(r){return arguments.length?(n=+r,this):n},error(){return n>=Owe&&Sy(t||"error","ERROR",arguments),this},warn(){return n>=Jj&&Sy(t||"warn","WARN",arguments),this},info(){return n>=Fwe&&Sy(t||"log","INFO",arguments),this},debug(){return n>=kwe&&Sy(t||"log","DEBUG",arguments),this}}}var Z=Array.isArray;function Xe(e){return e===Object(e)}const Qj=e=>e!=="__proto__";function eI(...e){return e.reduce((t,n)=>{for(const r in n)if(r==="signals")t.signals=Dwe(t.signals,n.signals);else{const i=r==="legend"?{layout:1}:r==="style"?!0:null;aC(t,r,n[r],i)}return t},{})}function aC(e,t,n,r){if(!Qj(t))return;let i,o;if(Xe(n)&&!Z(n)){o=Xe(e[t])?e[t]:e[t]={};for(i in n)r&&(r===!0||r[i])?aC(o,i,n[i]):Qj(i)&&(o[i]=n[i])}else e[t]=n}function Dwe(e,t){if(e==null)return t;const n={},r=[];function i(o){n[o.name]||(n[o.name]=1,r.push(o))}return t.forEach(i),e.forEach(i),r}function gt(e){return e!=null?Z(e)?e:[e]:[]}function Nwe(e){return typeof e=="function"}const Twe=Object.prototype.hasOwnProperty;function Fc(e,t){return Twe.call(e,t)}function a0(e){return typeof e=="boolean"}function Et(e){return typeof e=="number"}function he(e){return typeof e=="string"}function De(e){return Z(e)?"["+e.map(De)+"]":Xe(e)||he(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function ku(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,function(n,r){return Array.isArray(r)?n.push.apply(n,e.call(r,t-1)):n.push(r),n},[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var tI={exports:{}};(function(e){var t=function(){function n(d,h){return h!=null&&d instanceof h}var r;try{r=Map}catch(d){r=function(){}}var i;try{i=Set}catch(d){i=function(){}}var o;try{o=Promise}catch(d){o=function(){}}function a(d,h,g,p,m){typeof h=="object"&&(g=h.depth,p=h.prototype,m=h.includeNonEnumerable,h=h.circular);var y=[],v=[],b=typeof Buffer!="undefined";typeof h=="undefined"&&(h=!0),typeof g=="undefined"&&(g=1/0);function x(w,E){if(w===null)return null;if(E===0)return w;var _,S;if(typeof w!="object")return w;if(n(w,r))_=new r;else if(n(w,i))_=new i;else if(n(w,o))_=new o(function(T,L){w.then(function(z){T(x(z,E-1))},function(z){L(x(z,E-1))})});else if(a.__isArray(w))_=[];else if(a.__isRegExp(w))_=new RegExp(w.source,f(w)),w.lastIndex&&(_.lastIndex=w.lastIndex);else if(a.__isDate(w))_=new Date(w.getTime());else{if(b&&Buffer.isBuffer(w))return Buffer.allocUnsafe?_=Buffer.allocUnsafe(w.length):_=new Buffer(w.length),w.copy(_),_;n(w,Error)?_=Object.create(w):typeof p=="undefined"?(S=Object.getPrototypeOf(w),_=Object.create(S)):(_=Object.create(p),S=p)}if(h){var C=y.indexOf(w);if(C!=-1)return v[C];y.push(w),v.push(_)}n(w,r)&&w.forEach(function(T,L){var z=x(L,E-1),Q=x(T,E-1);_.set(z,Q)}),n(w,i)&&w.forEach(function(T){var L=x(T,E-1);_.add(L)});for(var O in w){var $;S&&($=Object.getOwnPropertyDescriptor(S,O)),!($&&$.set==null)&&(_[O]=x(w[O],E-1))}if(Object.getOwnPropertySymbols)for(var M=Object.getOwnPropertySymbols(w),O=0;O<M.length;O++){var F=M[O],N=Object.getOwnPropertyDescriptor(w,F);N&&!N.enumerable&&!m||(_[F]=x(w[F],E-1),N.enumerable||Object.defineProperty(_,F,{enumerable:!1}))}if(m)for(var A=Object.getOwnPropertyNames(w),O=0;O<A.length;O++){var k=A[O],N=Object.getOwnPropertyDescriptor(w,k);N&&N.enumerable||(_[k]=x(w[k],E-1),Object.defineProperty(_,k,{enumerable:!1}))}return _}return x(d,g)}a.clonePrototype=function(h){if(h===null)return null;var g=function(){};return g.prototype=h,new g};function s(d){return Object.prototype.toString.call(d)}a.__objToStr=s;function u(d){return typeof d=="object"&&s(d)==="[object Date]"}a.__isDate=u;function l(d){return typeof d=="object"&&s(d)==="[object Array]"}a.__isArray=l;function c(d){return typeof d=="object"&&s(d)==="[object RegExp]"}a.__isRegExp=c;function f(d){var h="";return d.global&&(h+="g"),d.ignoreCase&&(h+="i"),d.multiline&&(h+="m"),h}return a.__getRegExpFlags=f,a}();e.exports&&(e.exports=t)})(tI);var Rwe=tI.exports,Pwe=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var r,i,o;if(Array.isArray(t)){if(r=t.length,r!=n.length)return!1;for(i=r;i--!=0;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(o=Object.keys(t),r=o.length,r!==Object.keys(n).length)return!1;for(i=r;i--!=0;)if(!Object.prototype.hasOwnProperty.call(n,o[i]))return!1;for(i=r;i--!=0;){var a=o[i];if(!e(t[a],n[a]))return!1}return!0}return t!==t&&n!==n},sC=function(e,t){t||(t={}),typeof t=="function"&&(t={cmp:t});var n=typeof t.cycles=="boolean"?t.cycles:!1,r=t.cmp&&function(o){return function(a){return function(s,u){var l={key:s,value:a[s]},c={key:u,value:a[u]};return o(l,c)}}}(t.cmp),i=[];return function o(a){if(a&&a.toJSON&&typeof a.toJSON=="function"&&(a=a.toJSON()),a!==void 0){if(typeof a=="number")return isFinite(a)?""+a:"null";if(typeof a!="object")return JSON.stringify(a);var s,u;if(Array.isArray(a)){for(u="[",s=0;s<a.length;s++)s&&(u+=","),u+=o(a[s])||"null";return u+"]"}if(a===null)return"null";if(i.indexOf(a)!==-1){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var l=i.push(a)-1,c=Object.keys(a).sort(r&&r(a));for(u="",s=0;s<c.length;s++){var f=c[s],d=o(a[f]);!d||(u&&(u+=","),u+=JSON.stringify(f)+":"+d)}return i.splice(l,1),"{"+u+"}"}}(e)};function uC(e){return!!e.or}function lC(e){return!!e.and}function cC(e){return!!e.not}function Cy(e,t){if(cC(e))Cy(e.not,t);else if(lC(e))for(const n of e.and)Cy(n,t);else if(uC(e))for(const n of e.or)Cy(n,t);else t(e)}function kc(e,t){return cC(e)?{not:kc(e.not,t)}:lC(e)?{and:e.and.map(n=>kc(n,t))}:uC(e)?{or:e.or.map(n=>kc(n,t))}:t(e)}const co=Pwe,ge=Rwe;function Mc(e,t){const n={};for(const r of t)Fc(e,r)&&(n[r]=e[r]);return n}function Sr(e,t){const n=Object.assign({},e);for(const r of t)delete n[r];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>sC(e)).join(",")})`};const Je=sC;function Ce(e){if(Et(e))return e;const t=he(e)?e:sC(e);if(t.length<250)return t;let n=0;for(let r=0;r<t.length;r++){const i=t.charCodeAt(r);n=(n<<5)-n+i,n=n&n}return n}function fC(e){return e===!1||e===null}function ve(e,t){return e.includes(t)}function Dc(e,t){let n=0;for(const[r,i]of e.entries())if(t(i,r,n++))return!0;return!1}function dC(e,t){let n=0;for(const[r,i]of e.entries())if(!t(i,r,n++))return!1;return!0}function nI(e,...t){for(const n of t)Lwe(e,n!=null?n:{});return e}function Lwe(e,t){for(const n of U(t))aC(e,n,t[n],!0)}function fo(e,t){const n=[],r={};let i;for(const o of e)i=t(o),!(i in r)&&(r[i]=1,n.push(o));return n}function jwe(e,t){const n=U(e),r=U(t);if(n.length!==r.length)return!1;for(const i of n)if(e[i]!==t[i])return!1;return!0}function rI(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function hC(e,t){for(const n of e)if(t.has(n))return!0;return!1}function gC(e){const t=new Set;for(const n of e){const i=Fu(n).map((a,s)=>s===0?a:`[${a}]`),o=i.map((a,s)=>i.slice(0,s+1).join(""));for(const a of o)t.add(a)}return t}function pC(e,t){return e===void 0||t===void 0?!0:hC(gC(e),gC(t))}function Ge(e){return U(e).length===0}const U=Object.keys,pn=Object.values,es=Object.entries;function s0(e){return e===!0||e===!1}function it(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function u0(e,t){return cC(e)?`!(${u0(e.not,t)})`:lC(e)?`(${e.and.map(n=>u0(n,t)).join(") && (")})`:uC(e)?`(${e.or.map(n=>u0(n,t)).join(") || (")})`:t(e)}function Oy(e,t){if(t.length===0)return!0;const n=t.shift();return n in e&&Oy(e[n],t)&&delete e[n],Ge(e)}function l0(e){return e.charAt(0).toUpperCase()+e.substr(1)}function mC(e,t="datum"){const n=Fu(e),r=[];for(let i=1;i<=n.length;i++){const o=`[${n.slice(0,i).map(De).join("][")}]`;r.push(`${t}${o}`)}return r.join(" && ")}function iI(e,t="datum"){return`${t}[${De(Fu(e).join("."))}]`}function Iwe(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function Wr(e){return`${Fu(e).map(Iwe).join("\\.")}`}function Mu(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function yC(e){return`${Fu(e).join(".")}`}function Nc(e){return e?Fu(e).length:0}function $t(...e){for(const t of e)if(t!==void 0)return t}let oI=42;function aI(e){const t=++oI;return e?String(e)+t:t}function Bwe(){oI=42}function sI(e){return uI(e)?e:`__${e}`}function uI(e){return e.startsWith("__")}function c0(e){if(e!==void 0)return(e%360+360)%360}function Fy(e){return Et(e)?!0:!isNaN(e)&&!isNaN(parseFloat(e))}var f0=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const ta="row",na="column",ky="facet",ut="x",Mt="y",_i="x2",ho="y2",go="radius",ra="radius2",Ei="theta",ia="theta2",po="latitude",mo="longitude",$i="latitude2",Gr="longitude2",nr="color",yo="fill",vo="stroke",rr="shape",oa="size",Du="angle",aa="opacity",ts="fillOpacity",ns="strokeOpacity",rs="strokeWidth",is="strokeDash",d0="text",h0="order",g0="detail",My="key",Nu="tooltip",Dy="href",Ny="url",Ty="description",zwe={x:1,y:1,x2:1,y2:1},lI={theta:1,theta2:1,radius:1,radius2:1};function cI(e){return e in lI}const vC={longitude:1,longitude2:1,latitude:1,latitude2:1};function Uwe(e){switch(e){case po:return"y";case $i:return"y2";case mo:return"x";case Gr:return"x2"}}function qwe(e){return e in vC}const Hwe=U(vC),fI=Object.assign(Object.assign(Object.assign(Object.assign({},zwe),lI),vC),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function Tc(e){return e===nr||e===yo||e===vo}const dI={row:1,column:1,facet:1},Yr=U(dI),bC=Object.assign(Object.assign({},fI),dI),Wwe=U(bC),Gwe=f0(bC,["order","detail","tooltip"]),Ywe=f0(Gwe,["row","column","facet"]);function Vwe(e){return!!Ywe[e]}function hI(e){return!!bC[e]}const Xwe=[_i,ho,$i,Gr,ia,ra];function gI(e){return Tu(e)!==e}function Tu(e){switch(e){case _i:return ut;case ho:return Mt;case $i:return po;case Gr:return mo;case ia:return Ei;case ra:return go}return e}function os(e){if(cI(e))switch(e){case Ei:return"startAngle";case ia:return"endAngle";case go:return"outerRadius";case ra:return"innerRadius"}return e}function sa(e){switch(e){case ut:return _i;case Mt:return ho;case po:return $i;case mo:return Gr;case Ei:return ia;case go:return ra}}function Vr(e){switch(e){case ut:case _i:return"width";case Mt:case ho:return"height"}}function Kwe(e){switch(e){case ut:return"xOffset";case Mt:return"yOffset";case _i:return"x2Offset";case ho:return"y2Offset";case Ei:return"thetaOffset";case go:return"radiusOffset";case ia:return"theta2Offset";case ra:return"radius2Offset"}}const xC=f0(fI,["x","y","x2","y2","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),Zwe=U(xC),as={x:1,y:1},bo=U(as);function xo(e){return e in as}const wC={theta:1,radius:1},Jwe=U(wC);function Ry(e){return e==="width"?ut:Mt}const pI=f0(xC,["text","tooltip","href","url","description","detail","key","order"]),Qwe=U(pI);function e_e(e){return!!xC[e]}function t_e(e){switch(e){case nr:case yo:case vo:case oa:case rr:case aa:case rs:case is:return!0;case ts:case ns:case Du:return!1}}const mI=Object.assign(Object.assign(Object.assign({},as),wC),pI),Py=U(mI);function ss(e){return!!mI[e]}function n_e(e,t){return i_e(e)[t]}const yI={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},r_e=f0(yI,["geoshape"]);function i_e(e){switch(e){case nr:case yo:case vo:case Ty:case g0:case My:case Nu:case Dy:case h0:case aa:case ts:case ns:case rs:case ky:case ta:case na:return yI;case ut:case Mt:case po:case mo:return r_e;case _i:case ho:case $i:case Gr:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case oa:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case is:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case rr:return{point:"always",geoshape:"always"};case d0:return{text:"always"};case Du:return{point:"always",square:"always",text:"always"};case Ny:return{image:"always"};case Ei:return{text:"always",arc:"always"};case go:return{text:"always",arc:"always"};case ia:case ra:return{arc:"always"}}}function _C(e){switch(e){case ut:case Mt:case Ei:case go:case oa:case Du:case rs:case aa:case ts:case ns:case _i:case ho:case ia:case ra:return;case ky:case ta:case na:case rr:case is:case d0:case Nu:case Dy:case Ny:case Ty:return"discrete";case nr:case yo:case vo:return"flexible";case po:case mo:case $i:case Gr:case g0:case My:case h0:return}}const o_e={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},a_e={count:1,min:1,max:1};function ua(e){return!!e&&!!e.argmin}function us(e){return!!e&&!!e.argmax}function EC(e){return he(e)&&!!o_e[e]}const s_e=["count","valid","missing","distinct"];function vI(e){return he(e)&&ve(s_e,e)}function u_e(e){return he(e)&&ve(["min","max"],e)}const l_e=["count","sum","distinct","valid","missing"],c_e=["mean","average","median","q1","q3","min","max"],f_e=ku(c_e);function bI(e){return a0(e)&&(e=nv(e,void 0)),"bin"+U(e).map(t=>Ly(e[t])?it(`_${t}_${es(e[t])}`):it(`_${t}_${e[t]}`)).join("")}function Qe(e){return e===!0||Ru(e)&&!e.binned}function Pn(e){return e==="binned"||Ru(e)&&e.binned===!0}function Ru(e){return Xe(e)}function Ly(e){return e==null?void 0:e.param}function xI(e){switch(e){case ta:case na:case oa:case nr:case yo:case vo:case rs:case aa:case ts:case ns:case rr:return 6;case is:return 4;default:return 10}}function p0(e){return e&&!!e.expr}function ir(e){const t=U(e||{}),n={};for(const r of t)n[r]=Cr(e[r]);return n}var d_e=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function wI(e){const{anchor:t,frame:n,offset:r,orient:i,angle:o,limit:a,color:s,subtitleColor:u,subtitleFont:l,subtitleFontSize:c,subtitleFontStyle:f,subtitleFontWeight:d,subtitleLineHeight:h,subtitlePadding:g}=e,p=d_e(e,["anchor","frame","offset","orient","angle","limit","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),m=Object.assign(Object.assign({},p),s?{fill:s}:{}),y=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},t?{anchor:t}:{}),n?{frame:n}:{}),r?{offset:r}:{}),i?{orient:i}:{}),o!==void 0?{angle:o}:{}),a!==void 0?{limit:a}:{}),v=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},u?{subtitleColor:u}:{}),l?{subtitleFont:l}:{}),c?{subtitleFontSize:c}:{}),f?{subtitleFontStyle:f}:{}),d?{subtitleFontWeight:d}:{}),h?{subtitleLineHeight:h}:{}),g?{subtitlePadding:g}:{}),b=Mc(e,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:m,subtitleMarkConfig:b,nonMarkTitleProperties:y,subtitle:v}}function ls(e){return he(e)||Z(e)&&he(e[0])}function ie(e){return e&&!!e.signal}function cs(e){return!!e.step}function h_e(e){return Z(e)?!1:"fields"in e&&!("data"in e)}function g_e(e){return Z(e)?!1:"fields"in e&&"data"in e}function la(e){return Z(e)?!1:"field"in e&&"data"in e}const p_e={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1},m_e=U(p_e),y_e={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},$C=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];var AC=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function _I(e){const t=Z(e.condition)?e.condition.map(EI):EI(e.condition);return Object.assign(Object.assign({},Cr(e)),{condition:t})}function Cr(e){if(p0(e)){const{expr:t}=e,n=AC(e,["expr"]);return Object.assign({signal:t},n)}return e}function EI(e){if(p0(e)){const{expr:t}=e,n=AC(e,["expr"]);return Object.assign({signal:t},n)}return e}function ot(e){if(p0(e)){const{expr:t}=e,n=AC(e,["expr"]);return Object.assign({signal:t},n)}return ie(e)?e:e!==void 0?{value:e}:void 0}function $I(e){return ie(e)?e.signal:De(e.value)}function ca(e){return ie(e)?e.signal:e==null?null:De(e)}function v_e(e,t,n){for(const r of n){const i=Pu(r,t.markDef,t.config);i!==void 0&&(e[r]=ot(i))}return e}function AI(e){var t;return[].concat(e.type,(t=e.style)!==null&&t!==void 0?t:[])}function ze(e,t,n,r={}){const{vgChannel:i,ignoreVgConfig:o}=r;return i&&t[i]!==void 0?t[i]:t[e]!==void 0?t[e]:o&&(!i||i===e)?void 0:Pu(e,t,n,r)}function Pu(e,t,n,{vgChannel:r}={}){return $t(r?jy(e,t,n.style):void 0,jy(e,t,n.style),r?n[t.type][r]:void 0,n[t.type][e],r?n.mark[r]:n.mark[e])}function jy(e,t,n){return SI(e,AI(t),n)}function SI(e,t,n){t=gt(t);let r;for(const i of t){const o=n[i];o&&o[e]!==void 0&&(r=o[e])}return r}function CI(e,t){return gt(e).reduce((n,r)=>{var i;return n.field.push(G(r,t)),n.order.push((i=r.sort)!==null&&i!==void 0?i:"ascending"),n},{field:[],order:[]})}function OI(e,t){const n=[...e];return t.forEach(r=>{for(const i of n)if(co(i,r))return;n.push(r)}),n}function FI(e,t){return co(e,t)||!t?e:e?[...gt(e),...gt(t)].join(", "):t}function kI(e,t){const n=e.value,r=t.value;if(n==null||r===null)return{explicit:e.explicit,value:null};if((ls(n)||ie(n))&&(ls(r)||ie(r)))return{explicit:e.explicit,value:FI(n,r)};if(ls(n)||ie(n))return{explicit:e.explicit,value:n};if(ls(r)||ie(r))return{explicit:e.explicit,value:r};if(!ls(n)&&!ie(n)&&!ls(r)&&!ie(r))return{explicit:e.explicit,value:OI(n,r)};throw new Error("It should never reach here")}function SC(e){return`Invalid specification ${Je(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const b_e='Autosize "fit" only works for single views and layered views.';function MI(e){return`${e=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function DI(e){const t=e=="width"?"Width":"Height",n=e=="width"?"x":"y";return`${t} "container" only works well with autosize "fit" or "fit-${n}".`}function NI(e){return e?`Dropping "fit-${e}" because spec has discrete ${Vr(e)}.`:'Dropping "fit" because spec has discrete size.'}function CC(e){return`Unknown field for ${e}. Cannot calculate view size.`}function TI(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function x_e(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function w_e(e){return`The "nearest" transform is not supported for ${e} marks.`}function RI(e){return`Selection not supported for ${e} yet.`}function __e(e){return`Cannot find a selection named "${e}".`}const E_e="Scale bindings are currently only supported for scales with unbinned, continuous domains.",$_e="Legend bindings are only supported for selections over an individual field or encoding channel.";function A_e(e){return`Lookups can only be performed on selection parameters. "${e}" is a variable parameter.`}function S_e(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}const C_e="The same selection must be used to override scale domains in a layered view.",O_e='Interval selections should be initialized using "x" and/or "y" keys.';function F_e(e){return`Unknown repeated value "${e}".`}function PI(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const k_e="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function M_e(e){return`Unrecognized parse "${e}".`}function LI(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}const D_e="Attempt to add the same child twice.";function N_e(e){return`Ignoring an invalid transform: ${Je(e)}.`}const T_e='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function jI(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function R_e(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${Je(t)} is overridden by a child projection ${Je(n)}.`}const P_e="Arc marks uses theta channel rather than angle, replacing angle with theta.";function L_e(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${Je(n)}}.`}function II(e){return`Invalid field type "${e}".`}function j_e(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function I_e(e){return`Invalid aggregation operator "${e}".`}function BI(e,t){const{fill:n,stroke:r}=t;return`Dropping color ${e} as the plot also has ${n&&r?"fill and stroke":n?"fill":"stroke"}.`}function B_e(e){return`Position range does not support relative band size for ${e}.`}function OC(e,t){return`Dropping ${Je(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}const z_e="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function Iy(e,t,n){return`${e} dropped as it is incompatible with "${t}"${n?` when ${n}`:""}.`}function U_e(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function q_e(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function H_e(e){return`${e} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`}function W_e(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function FC(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${t==="ordinal"?"order":"magnitude"}.`}function G_e(e){return`The ${e} for range marks cannot be an expression`}function Y_e(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function V_e(e,t){return`Specified orient "${e}" overridden with "${t}".`}function X_e(e){return`Cannot use the scale property "${e}" with non-color channel.`}function K_e(e){return`Cannot use the relative band size with ${e} scale.`}function Z_e(e){return`Using unaggregated domain with raw field has no effect (${Je(e)}).`}function J_e(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function Q_e(e){return`Unaggregated domain is currently unsupported for log scale (${Je(e)}).`}function eEe(e){return`Cannot apply size to non-oriented mark "${e}".`}function tEe(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function nEe(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function zI(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function UI(e){return`The step for "${e}" is dropped because the ${e==="width"?"x":"y"} is continuous.`}function rEe(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${Je(n)} and ${Je(r)}). Using ${Je(n)}.`}function iEe(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${Je(n)} and ${Je(r)}). Using the union of the two domains.`}function oEe(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function aEe(e){return`Dropping sort property ${Je(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const qI="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",sEe="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",uEe="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",lEe="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.";function cEe(e){return`Cannot stack "${e}" if there is already "${e}2".`}function fEe(e){return`Cannot stack non-linear scale (${e}).`}function dEe(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function By(e,t){return`Invalid ${e}: ${Je(t)}.`}function hEe(e){return`Dropping day from datetime ${Je(e)} as day cannot be combined with other units.`}function gEe(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function pEe(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function mEe(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function HI(e){return`1D error band does not support ${e}.`}function WI(e){return`Channel ${e} is required for "binned" bin.`}function yEe(e){return`Channel ${e} should not be used with "binned" bin.`}function vEe(e){return`Domain for ${e} is required for threshold scale.`}const GI=Mwe(Jj);let Rc=GI;function bEe(e){return Rc=e,Rc}function xEe(){return Rc=GI,Rc}function q(...e){Rc.warn(...e)}function wEe(...e){Rc.debug(...e)}function Lu(e){if(e&&Xe(e)){for(const t of MC)if(t in e)return!0}return!1}const YI=["january","february","march","april","may","june","july","august","september","october","november","december"],_Ee=YI.map(e=>e.substr(0,3)),VI=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],EEe=VI.map(e=>e.substr(0,3));function $Ee(e){if(Fy(e)&&(e=+e),Et(e))return e>4&&q(By("quarter",e)),e-1;throw new Error(By("quarter",e))}function AEe(e){if(Fy(e)&&(e=+e),Et(e))return e-1;{const t=e.toLowerCase(),n=YI.indexOf(t);if(n!==-1)return n;const r=t.substr(0,3),i=_Ee.indexOf(r);if(i!==-1)return i;throw new Error(By("month",e))}}function SEe(e){if(Fy(e)&&(e=+e),Et(e))return e%7;{const t=e.toLowerCase(),n=VI.indexOf(t);if(n!==-1)return n;const r=t.substr(0,3),i=EEe.indexOf(r);if(i!==-1)return i;throw new Error(By("day",e))}}function kC(e,t){const n=[];if(t&&e.day!==void 0&&U(e).length>1&&(q(hEe(e)),e=ge(e),delete e.day),e.year!==void 0?n.push(e.year):n.push(2012),e.month!==void 0){const r=t?AEe(e.month):e.month;n.push(r)}else if(e.quarter!==void 0){const r=t?$Ee(e.quarter):e.quarter;n.push(Et(r)?r*3:`${r}*3`)}else n.push(0);if(e.date!==void 0)n.push(e.date);else if(e.day!==void 0){const r=t?SEe(e.day):e.day;n.push(Et(r)?r+1:`${r}+1`)}else n.push(1);for(const r of["hours","minutes","seconds","milliseconds"]){const i=e[r];n.push(typeof i=="undefined"?0:i)}return n}function m0(e){const n=kC(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function CEe(e){const n=kC(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function OEe(e){const t=kC(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}var FEe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const XI={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},MC=U(XI);function kEe(e){return!!XI[e]}function DC(e){return e.startsWith("utc")}function MEe(e){return e.substr(3)}const DEe={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function NC(e){return MC.filter(t=>KI(e,t))}function KI(e,t){const n=e.indexOf(t);return!(n<0||n>0&&t==="seconds"&&e.charAt(n-1)==="i"||e.length>n+3&&t==="day"&&e.charAt(n+3)==="o"||n>0&&t==="year"&&e.charAt(n-1)==="f")}function NEe(e,t,{end:n}={end:!1}){const r=mC(t),i=DC(e)?"utc":"";function o(u){return u==="quarter"?`(${i}quarter(${r})-1)`:`${i}${u}(${r})`}let a;const s={};for(const u of MC)KI(e,u)&&(s[u]=o(u),a=u);return n&&(s[a]+="+1"),CEe(s)}function ZI(e){if(!e)return;const t=NC(e);return`timeUnitSpecifier(${Je(t)}, ${Je(DEe)})`}function TEe(e,t,n){if(!e)return;const r=ZI(e);return`${n||DC(e)?"utc":"time"}Format(${t}, ${r})`}function Ln(e){if(!e)return;let t;return he(e)?t={unit:e}:Xe(e)&&(t=Object.assign(Object.assign({},e),e.unit?{unit:e.unit}:{})),DC(t.unit)&&(t.utc=!0,t.unit=MEe(t.unit)),t}function REe(e){const t=Ln(e),{utc:n}=t,r=FEe(t,["utc"]);return r.unit?(n?"utc":"")+U(r).map(i=>it(`${i==="unit"?"":`_${i}_`}${r[i]}`)).join(""):(n?"utc":"")+"timeunit"+U(r).map(i=>it(`_${i}_${r[i]}`)).join("")}function PEe(e){return e==null?void 0:e.param}function TC(e){return e&&!!e.field&&e.equal!==void 0}function RC(e){return e&&!!e.field&&e.lt!==void 0}function PC(e){return e&&!!e.field&&e.lte!==void 0}function LC(e){return e&&!!e.field&&e.gt!==void 0}function jC(e){return e&&!!e.field&&e.gte!==void 0}function IC(e){if(e==null?void 0:e.field){if(Z(e.range)&&e.range.length===2)return!0;if(ie(e.range))return!0}return!1}function BC(e){return e&&!!e.field&&(Z(e.oneOf)||Z(e.in))}function LEe(e){return e&&!!e.field&&e.valid!==void 0}function JI(e){return BC(e)||TC(e)||IC(e)||RC(e)||LC(e)||PC(e)||jC(e)}function wo(e,t){return rv(e,{timeUnit:t,wrapTime:!0})}function jEe(e,t){return e.map(n=>wo(n,t))}function QI(e,t=!0){var n;const{field:r}=e,i=(n=Ln(e.timeUnit))===null||n===void 0?void 0:n.unit,o=i?`time(${NEe(i,r)})`:G(e,{expr:"datum"});if(TC(e))return`${o}===${wo(e.equal,i)}`;if(RC(e)){const a=e.lt;return`${o}<${wo(a,i)}`}else if(LC(e)){const a=e.gt;return`${o}>${wo(a,i)}`}else if(PC(e)){const a=e.lte;return`${o}<=${wo(a,i)}`}else if(jC(e)){const a=e.gte;return`${o}>=${wo(a,i)}`}else{if(BC(e))return`indexof([${jEe(e.oneOf,i).join(",")}], ${o}) !== -1`;if(LEe(e))return zC(o,e.valid);if(IC(e)){const{range:a}=e,s=ie(a)?{signal:`${a.signal}[0]`}:a[0],u=ie(a)?{signal:`${a.signal}[1]`}:a[1];if(s!==null&&u!==null&&t)return"inrange("+o+", ["+wo(s,i)+", "+wo(u,i)+"])";const l=[];return s!==null&&l.push(`${o} >= ${wo(s,i)}`),u!==null&&l.push(`${o} <= ${wo(u,i)}`),l.length>0?l.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${Je(e)}`)}function zC(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function IEe(e){var t;return JI(e)&&e.timeUnit?Object.assign(Object.assign({},e),{timeUnit:(t=Ln(e.timeUnit))===null||t===void 0?void 0:t.unit}):e}const y0={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"},ju=y0.quantitative,UC=y0.ordinal,Pc=y0.temporal,qC=y0.nominal,Lc=y0.geojson;function BEe(e){if(e)switch(e=e.toLowerCase(),e){case"q":case ju:return"quantitative";case"t":case Pc:return"temporal";case"o":case UC:return"ordinal";case"n":case qC:return"nominal";case Lc:return"geojson"}}var zEe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const Dt={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},HC={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};function UEe(e,t){const n=HC[e],r=HC[t];return n===r||n==="ordinal-position"&&r==="time"||r==="ordinal-position"&&n==="time"}const qEe={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function eB(e){return qEe[e]}const tB=["linear","log","pow","sqrt","symlog","time","utc"],HEe=ku(tB),WEe=["linear","log","pow","sqrt","symlog"],GEe=ku(WEe);function YEe(e){return e in GEe}const VEe=["quantile","quantize","threshold"],XEe=ku(VEe),KEe=tB.concat(["quantile","quantize","threshold","sequential","identity"]),ZEe=ku(KEe),JEe=["ordinal","bin-ordinal","point","band"],QEe=ku(JEe);function mn(e){return e in QEe}function Or(e){return e in ZEe}function Ai(e){return e in HEe}function v0(e){return e in XEe}const e$e={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4};function t$e(e){return!he(e)&&!!e.name}function nB(e){return e==null?void 0:e.param}function n$e(e){return e&&e.unionWith}function r$e(e){return le(e)&&"field"in e}const i$e={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},o$e=zEe(i$e,["type","domain","range","rangeMax","rangeMin","scheme"]),a$e=U(o$e);function WC(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(e);case"bins":return!["point","band","identity","ordinal"].includes(e);case"round":return Ai(e)||e==="band"||e==="point";case"padding":case"rangeMin":case"rangeMax":return Ai(e)||["point","band"].includes(e);case"paddingOuter":case"align":return["point","band"].includes(e);case"paddingInner":return e==="band";case"domainMax":case"domainMid":case"domainMin":case"clamp":return Ai(e);case"nice":return Ai(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return Or(e)&&!ve(["log","time","utc","threshold","quantile"],e)}}function rB(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return Tc(e)?void 0:X_e(e);case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}function s$e(e,t){return ve([UC,qC],t)?e===void 0||mn(e):t===Pc?ve([Dt.TIME,Dt.UTC,void 0],e):t===ju?ve([Dt.LOG,Dt.POW,Dt.SQRT,Dt.SYMLOG,Dt.QUANTILE,Dt.QUANTIZE,Dt.THRESHOLD,Dt.LINEAR,void 0],e):!0}function u$e(e,t){if(!ss(e))return!1;switch(e){case ut:case Mt:case Ei:case go:return Ai(t)||ve(["band","point"],t);case oa:case rs:case aa:case ts:case ns:case Du:return Ai(t)||v0(t)||ve(["band","point","ordinal"],t);case nr:case yo:case vo:return t!=="band";case is:case rr:return t==="ordinal"||v0(t)}}const jn={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},iB=jn.arc,zy=jn.area,Uy=jn.bar,l$e=jn.image,qy=jn.line,Hy=jn.point,c$e=jn.rect,Wy=jn.rule,oB=jn.text,GC=jn.tick,f$e=jn.trail,YC=jn.circle,VC=jn.square,aB=jn.geoshape;function fs(e){return["line","area","trail"].includes(e)}function sB(e){return["rect","bar","image","arc"].includes(e)}const uB=U(jn);function _o(e){return e.type}ku(uB);const d$e=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],h$e=["fill","fillOpacity"],g$e=[...d$e,...h$e],p$e={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1},lB=U(p$e),m$e={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]},y$e={color:"#4c78a8",invalid:"filter",timeUnitBandSize:1},v$e={mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1},cB=U(v$e);function jc(e){return e&&e.band!=null}const b$e={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},fB=5,x$e={binSpacing:1,continuousBandSize:fB,timeUnitBandPosition:.5},w$e={binSpacing:0,continuousBandSize:fB,timeUnitBandPosition:.5},_$e={thickness:1};function E$e(e){return _o(e)?e.type:e}function XC(e){const{channel:t,channelDef:n,markDef:r,scale:i,config:o}=e,a=hB(e);return Y(n)&&!vI(n.aggregate)&&i&&Ai(i.get("type"))&&i.get("zero")===!1?dB({fieldDef:n,channel:t,markDef:r,ref:a,config:o}):a}function dB({fieldDef:e,channel:t,markDef:n,ref:r,config:i}){return fs(n.type)||ze("invalid",n,i)===null?r:[$$e(e,t),r]}function $$e(e,t){const n=KC(e,!0),i=Tu(t)==="y"?{field:{group:"height"}}:{value:0};return Object.assign({test:n},i)}function KC(e,t=!0){return zC(he(e)?e:G(e,{expr:"datum"}),!t)}function A$e(e){const{datum:t}=e;return Lu(t)?m0(t):`${Je(t)}`}function Iu(e,t,n,r){const i={};if(t&&(i.scale=t),ds(e)){const{datum:o}=e;Lu(o)?i.signal=m0(o):ie(o)?i.signal=o.signal:p0(o)?i.signal=o.expr:i.value=o}else i.field=G(e,n);if(r){const{offset:o,band:a}=r;o&&(i.offset=o),a&&(i.band=a)}return i}function Gy({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:r,startSuffix:i,bandPosition:o=.5}){const a=0<o&&o<1?"datum":void 0,s=G(t,{expr:a,suffix:i}),u=n!==void 0?G(n,{expr:a}):G(t,{suffix:"end",expr:a}),l={};if(o===0||o===1){l.scale=e;const c=o===0?s:u;l.field=c}else{const c=ie(o)?`${o.signal} * ${s} + (1-${o.signal}) * ${u}`:`${o} * ${s} + ${1-o} * ${u}`;l.signal=`scale("${e}", ${c})`}return r&&(l.offset=r),l}function hB({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:o,scale:a,stack:s,offset:u,defaultRef:l,bandPosition:c}){var f;if(t){if(fe(t)){if(Xr(t)){c!=null||(c=AB({fieldDef:t,fieldDef2:n,markDef:r,config:i}));const{bin:h,timeUnit:g,type:p}=t;if(Qe(h)||c&&g&&p===Pc)return(s==null?void 0:s.impute)?Iu(t,o,{binSuffix:"mid"},{offset:u}):c?Gy({scaleName:o,fieldOrDatumDef:t,bandPosition:c,offset:u}):Iu(t,o,w0(t,e)?{binSuffix:"range"}:{},{offset:u});if(Pn(h)){if(Y(n))return Gy({scaleName:o,fieldOrDatumDef:t,fieldOrDatumDef2:n,bandPosition:c,offset:u});q(WI(e===ut?_i:ho))}}const d=a==null?void 0:a.get("type");return Iu(t,o,mn(d)?{binSuffix:"range"}:{},{offset:u,band:d==="band"?(f=c!=null?c:t.bandPosition)!==null&&f!==void 0?f:.5:void 0})}else if(Si(t)){const d=t.value,h=u?{offset:u}:{};return Object.assign(Object.assign({},b0(e,d)),h)}}return Nwe(l)&&(l=l()),l&&Object.assign(Object.assign({},l),u?{offset:u}:{})}function b0(e,t){return ve(["x","x2"],e)&&t==="width"?{field:{group:"width"}}:ve(["y","y2"],e)&&t==="height"?{field:{group:"height"}}:ot(t)}function Bu(e){return e&&e!=="number"&&e!=="time"}function gB(e,t,n){return`${e}(${t}${n?`, ${Je(n)}`:""})`}const S$e=" \u2013 ";function ZC({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:o}){var a,s;if(Bu(n))return JC({fieldOrDatumDef:e,format:t,formatType:n,expr:r,config:o});const u=pB(e,r,i);if(zc(e)){const l=O$e(u,Y(e)?(a=Ln(e.timeUnit))===null||a===void 0?void 0:a.unit:void 0,t,o.timeFormat,zu(e)&&((s=e.scale)===null||s===void 0?void 0:s.type)===Dt.UTC);return l?{signal:l}:void 0}if(t=vB(nO(e),t,o),Y(e)&&Qe(e.bin)){const l=G(e,{expr:r,binSuffix:"end"});return{signal:Yy(u,l,t,n,o)}}else return t||nO(e)==="quantitative"?{signal:`${bB(u,t)}`}:{signal:`isValid(${u}) ? ${u} : ""+${u}`}}function pB(e,t,n){return Y(e)?n?`${G(e,{expr:t,suffix:"end"})}-${G(e,{expr:t,suffix:"start"})}`:G(e,{expr:t}):A$e(e)}function JC({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:o,field:a}){if(a!=null||(a=pB(e,r,i)),Y(e)&&Qe(e.bin)){const s=G(e,{expr:r,binSuffix:"end"});return{signal:Yy(a,s,t,n,o)}}return{signal:gB(n,a,t)}}function mB(e,t,n,r,i,o){var a;if(!Bu(r)){if(zc(e)){const s=Y(e)?(a=Ln(e.timeUnit))===null||a===void 0?void 0:a.unit:void 0;return C$e(n,s,i,o)}return vB(t,n,i)}}function yB(e,t,n){if(e&&(ie(e)||e==="number"||e==="time"))return e;if(zc(t)&&n!=="time"&&n!=="utc")return"time"}function vB(e,t,n){if(he(t))return t;if(e===ju)return n.numberFormat}function C$e(e,t,n,r){return e||(t?{signal:ZI(t)}:r?void 0:n.timeFormat)}function bB(e,t){return`format(${e}, "${t||""}")`}function xB(e,t,n,r){var i;return Bu(n)?gB(n,e,t):bB(e,(i=he(t)?t:void 0)!==null&&i!==void 0?i:r.numberFormat)}function Yy(e,t,n,r,i){const o=xB(e,n,r,i),a=xB(t,n,r,i);return`${zC(e,!1)} ? "null" : ${o} + "${S$e}" + ${a}`}function O$e(e,t,n,r,i){return!t||n?(n=he(n)?n:r,`${i?"utc":"time"}Format(${e}, '${n}')`):TEe(t,e,i)}const Vy="min",F$e={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function wB(e){return e in F$e}function _B(e){return!!e&&!!e.encoding}function Eo(e){return!!e&&(e.op==="count"||!!e.field)}function EB(e){return!!e&&Z(e)}function x0(e){return"row"in e||"column"in e}function QC(e){return!!e&&"header"in e}function Xy(e){return"facet"in e}var eO=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function k$e(e){return e.param}function M$e(e){return e&&!he(e)&&"repeat"in e}function $B(e){const{field:t,timeUnit:n,bin:r,aggregate:i}=e;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),r?{bin:r}:{}),i?{aggregate:i}:{}),{field:t})}function tO(e){return"sort"in e}function AB({fieldDef:e,fieldDef2:t,markDef:n,config:r}){if(fe(e)&&e.bandPosition!==void 0)return e.bandPosition;if(Y(e)){const{timeUnit:i,bin:o}=e;if(i&&!t)return sB(n.type)?0:Pu("timeUnitBandPosition",n,r);if(Qe(o))return .5}}function SB({channel:e,fieldDef:t,fieldDef2:n,markDef:r,config:i,scaleType:o,useVlSizeChannel:a}){var s,u,l;const c=Vr(e),f=ze(a?"size":c,r,i,{vgChannel:c});if(f!==void 0)return f;if(Y(t)){const{timeUnit:d,bin:h}=t;if(d&&!n)return{band:Pu("timeUnitBandSize",r,i)};if(Qe(h)&&!mn(o))return{band:1}}if(sB(r.type))return o?mn(o)?((s=i[r.type])===null||s===void 0?void 0:s.discreteBandSize)||{band:1}:(u=i[r.type])===null||u===void 0?void 0:u.continuousBandSize:(l=i[r.type])===null||l===void 0?void 0:l.discreteBandSize}function CB(e,t,n,r){return Qe(e.bin)||e.timeUnit&&Xr(e)&&e.type==="temporal"?AB({fieldDef:e,fieldDef2:t,markDef:n,config:r})!==void 0:!1}function Ky(e){return e&&"condition"in e}function Zy(e){const t=e&&e.condition;return!!t&&!Z(t)&&Y(t)}function Jy(e){const t=e&&e.condition;return!!t&&!Z(t)&&fe(t)}function D$e(e){const t=e&&e.condition;return!!t&&(Z(t)||Si(t))}function Y(e){return e&&(!!e.field||e.aggregate==="count")}function nO(e){return e&&e.type}function ds(e){return e&&"datum"in e}function $o(e){return Xr(e)&&!Qy(e)||rO(e)}function rO(e){return ds(e)&&Et(e.datum)}function fe(e){return Y(e)||ds(e)}function Xr(e){return e&&("field"in e||e.aggregate==="count")&&"type"in e}function Si(e){return e&&"value"in e&&"value"in e}function zu(e){return e&&("scale"in e||"sort"in e)}function iO(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function OB(e){return e&&"legend"in e}function FB(e){return e&&("format"in e||"formatType"in e)}function N$e(e){return Sr(e,["legend","axis","header","scale"])}function T$e(e){return"op"in e}function G(e,t={}){var n,r,i;let o=e.field;const a=t.prefix;let s=t.suffix,u="";if(P$e(e))o=sI("count");else{let l;if(!t.nofn)if(T$e(e))l=e.op;else{const{bin:c,aggregate:f,timeUnit:d}=e;Qe(c)?(l=bI(c),s=((n=t.binSuffix)!==null&&n!==void 0?n:"")+((r=t.suffix)!==null&&r!==void 0?r:"")):f?us(f)?(u=`["${o}"]`,o=`argmax_${f.argmax}`):ua(f)?(u=`["${o}"]`,o=`argmin_${f.argmin}`):l=String(f):d&&(l=REe(d),s=(!["range","mid"].includes(t.binSuffix)&&t.binSuffix||"")+((i=t.suffix)!==null&&i!==void 0?i:""))}l&&(o=o?`${l}_${o}`:l)}return s&&(o=`${o}_${s}`),a&&(o=`${a}_${o}`),t.forAs?yC(o):t.expr?iI(o,t.expr)+u:Wr(o)+u}function Qy(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return Y(e)&&!!e.bin;case"temporal":return!1}throw new Error(II(e.type))}function R$e(e){var t;return zu(e)&&v0((t=e.scale)===null||t===void 0?void 0:t.type)}function P$e(e){return e.aggregate==="count"}function L$e(e,t){var n;const{field:r,bin:i,timeUnit:o,aggregate:a}=e;if(a==="count")return t.countTitle;if(Qe(i))return`${r} (binned)`;if(o){const s=(n=Ln(o))===null||n===void 0?void 0:n.unit;if(s)return`${r} (${NC(s).join("-")})`}else if(a)return us(a)?`${r} for max ${a.argmax}`:ua(a)?`${r} for min ${a.argmin}`:`${l0(a)} of ${r}`;return r}function j$e(e){const{aggregate:t,bin:n,timeUnit:r,field:i}=e;if(us(t))return`${i} for argmax(${t.argmax})`;if(ua(t))return`${i} for argmin(${t.argmin})`;const o=Ln(r),a=t||(o==null?void 0:o.unit)||(o==null?void 0:o.maxbins)&&"timeunit"||Qe(n)&&"bin";return a?`${a.toUpperCase()}(${i})`:i}const kB=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return j$e(e);default:return L$e(e,t)}};let MB=kB;function DB(e){MB=e}function I$e(){DB(kB)}function Ic(e,t,{allowDisabling:n,includeDefault:r=!0}){var i,o;const a=(i=oO(e))===null||i===void 0?void 0:i.title;if(!Y(e))return a;const s=e,u=r?aO(s,t):void 0;return n?$t(a,s.title,u):(o=a!=null?a:s.title)!==null&&o!==void 0?o:u}function oO(e){if(iO(e)&&e.axis)return e.axis;if(OB(e)&&e.legend)return e.legend;if(QC(e)&&e.header)return e.header}function aO(e,t){return MB(e,t)}function ev(e){var t;if(FB(e)){const{format:n,formatType:r}=e;return{format:n,formatType:r}}else{const n=(t=oO(e))!==null&&t!==void 0?t:{},{format:r,formatType:i}=n;return{format:r,formatType:i}}}function B$e(e,t){var n;switch(t){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(tO(e)&&Z(e.sort))return"ordinal";const{aggregate:r,bin:i,timeUnit:o}=e;if(o)return"temporal";if(i||r&&!us(r)&&!ua(r))return"quantitative";if(zu(e)&&((n=e.scale)===null||n===void 0?void 0:n.type))switch(HC[e.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}function Ao(e){if(Y(e))return e;if(Zy(e))return e.condition}function Nt(e){if(fe(e))return e;if(Jy(e))return e.condition}function NB(e,t,n,r={}){if(he(e)||Et(e)||a0(e)){const i=he(e)?"string":Et(e)?"number":"boolean";return q(L_e(t,i,e)),{value:e}}return fe(e)?tv(e,t,n,r):Jy(e)?Object.assign(Object.assign({},e),{condition:tv(e.condition,t,n,r)}):e}function tv(e,t,n,r){if(FB(e)){const{format:i,formatType:o}=e,a=eO(e,["format","formatType"]);if(Bu(o)&&!n.customFormatTypes)return q(jI(t)),tv(a,t,n,r)}else{const i=iO(e)?"axis":OB(e)?"legend":QC(e)?"header":null;if(i&&e[i]){const o=e[i],{format:a,formatType:s}=o,u=eO(o,["format","formatType"]);if(Bu(s)&&!n.customFormatTypes)return q(jI(t)),tv(Object.assign(Object.assign({},e),{[i]:u}),t,n,r)}}return Y(e)?sO(e,t,r):z$e(e)}function z$e(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=Et(n)?"quantitative":he(n)?"nominal":Lu(n)?"temporal":void 0,Object.assign(Object.assign({},e),{type:t})}function sO(e,t,{compositeMark:n=!1}={}){const{aggregate:r,timeUnit:i,bin:o,field:a}=e,s=Object.assign({},e);if(!n&&r&&!EC(r)&&!us(r)&&!ua(r)&&(q(I_e(r)),delete s.aggregate),i&&(s.timeUnit=Ln(i)),a&&(s.field=`${a}`),Qe(o)&&(s.bin=nv(o,t)),Pn(o)&&!xo(t)&&q(yEe(t)),Xr(s)){const{type:u}=s,l=BEe(u);u!==l&&(s.type=l),u!=="quantitative"&&vI(r)&&(q(j_e(u,r)),s.type="quantitative")}else if(!gI(t)){const u=B$e(s,t);s.type=u}if(Xr(s)){const{compatible:u,warning:l}=U$e(s,t)||{};u===!1&&q(l)}if(tO(s)&&he(s.sort)){const{sort:u}=s;if(wB(u))return Object.assign(Object.assign({},s),{sort:{encoding:u}});const l=u.substr(1);if(u.charAt(0)==="-"&&wB(l))return Object.assign(Object.assign({},s),{sort:{encoding:l,order:"descending"}})}if(QC(s)){const{header:u}=s;if(u){const{orient:l}=u,c=eO(u,["orient"]);if(l)return Object.assign(Object.assign({},s),{header:Object.assign(Object.assign({},c),{labelOrient:u.labelOrient||l,titleOrient:u.titleOrient||l})})}}return s}function nv(e,t){return a0(e)?{maxbins:xI(t)}:e==="binned"?{binned:!0}:!e.maxbins&&!e.step?Object.assign(Object.assign({},e),{maxbins:xI(t)}):e}const Bc={compatible:!0};function U$e(e,t){const n=e.type;if(n==="geojson"&&t!=="shape")return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case ta:case na:case ky:return Qy(e)?Bc:{compatible:!1,warning:q_e(t)};case ut:case Mt:case nr:case yo:case vo:case d0:case g0:case My:case Nu:case Dy:case Ny:case Du:case Ei:case go:case Ty:return Bc;case mo:case Gr:case po:case $i:return n!==ju?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:Bc;case aa:case ts:case ns:case rs:case oa:case ia:case ra:case _i:case ho:return n==="nominal"&&!e.sort?{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`}:Bc;case rr:case is:return!Qy(e)&&!R$e(e)?{compatible:!1,warning:H_e(t)}:Bc;case h0:return e.type==="nominal"&&!("sort"in e)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:Bc}}function zc(e){const{formatType:t}=ev(e);return t==="time"||!t&&q$e(e)}function q$e(e){return e&&(e.type==="temporal"||Y(e)&&!!e.timeUnit)}function rv(e,{timeUnit:t,type:n,wrapTime:r,undefinedIfExprNotRequired:i}){var o;const a=t&&((o=Ln(t))===null||o===void 0?void 0:o.unit);let s=a||n==="temporal",u;return p0(e)?u=e.expr:ie(e)?u=e.signal:Lu(e)?(s=!0,u=m0(e)):(he(e)||Et(e))&&s&&(u=`datetime(${Je(e)})`,kEe(a)&&(Et(e)&&e<1e4||he(e)&&isNaN(Date.parse(e)))&&(u=m0({[a]:e}))),u?r&&s?`time(${u})`:u:i?void 0:Je(e)}function TB(e,t){const{type:n}=e;return t.map(r=>{const i=rv(r,{timeUnit:Y(e)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return i!==void 0?{signal:i}:r})}function w0(e,t){return Qe(e.bin)?ss(t)&&["ordinal","nominal"].includes(e.type):(console.warn("Only call this method for binned field defs."),!1)}const RB={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function _0(e){return e&&e.condition}const PB=["domain","grid","labels","ticks","title"],H$e={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},LB={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},W$e=Object.assign(Object.assign({},LB),{style:1,labelExpr:1,encoding:1});function jB(e){return!!W$e[e]}const G$e={axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1},IB=U(G$e);function fa(e){return"mark"in e}class iv{constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return fa(t)?E$e(t.mark)===this.name:!1}}var Y$e=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function Uu(e,t){const n=e&&e[t];return n?Z(n)?Dc(n,r=>!!r.field):Y(n)||Zy(n):!1}function uO(e){return Dc(Wwe,t=>{if(Uu(e,t)){const n=e[t];if(Z(n))return Dc(n,r=>!!r.aggregate);{const r=Ao(n);return r&&!!r.aggregate}}return!1})}function BB(e,t){const n=[],r=[],i=[],o=[],a={};return lO(e,(s,u)=>{if(Y(s)){const{field:l,aggregate:c,bin:f,timeUnit:d}=s,h=Y$e(s,["field","aggregate","bin","timeUnit"]);if(c||d||f){const g=oO(s),p=g==null?void 0:g.title;let m=G(s,{forAs:!0});const y=Object.assign(Object.assign(Object.assign({},p?[]:{title:Ic(s,t,{allowDisabling:!0})}),h),{field:m});if(c){let v;if(us(c)?(v="argmax",m=G({op:"argmax",field:c.argmax},{forAs:!0}),y.field=`${m}.${l}`):ua(c)?(v="argmin",m=G({op:"argmin",field:c.argmin},{forAs:!0}),y.field=`${m}.${l}`):c!=="boxplot"&&c!=="errorbar"&&c!=="errorband"&&(v=c),v){const b={op:v,as:m};l&&(b.field=l),o.push(b)}}else if(n.push(m),Xr(s)&&Qe(f)){if(r.push({bin:f,field:l,as:m}),n.push(G(s,{binSuffix:"end"})),w0(s,u)&&n.push(G(s,{binSuffix:"range"})),xo(u)){const v={field:`${m}_end`};a[`${u}2`]=v}y.bin="binned",gI(u)||(y.type=ju)}else if(d){i.push({timeUnit:d,field:l,as:m});const v=Xr(s)&&s.type!==Pc&&"time";v&&(u===d0||u===Nu?y.formatType=v:e_e(u)?y.legend=Object.assign({formatType:v},y.legend):xo(u)&&(y.axis=Object.assign({formatType:v},y.axis)))}a[u]=y}else n.push(l),a[u]=e[u]}else a[u]=e[u]}),{bins:r,timeUnits:i,aggregate:o,groupby:n,encoding:a}}function V$e(e,t,n){const r=n_e(t,n);if(r){if(r==="binned"){const i=e[t===_i?ut:Mt];return!!(Y(i)&&Y(e[t])&&Pn(i.bin))}}else return!1;return!0}function X$e(e,t,n,r){return U(e).reduce((i,o)=>{if(!hI(o))return q(U_e(o)),i;const a=e[o];if(o==="angle"&&t==="arc"&&!e.theta&&(q(P_e),o=Ei),!V$e(e,o,t))return q(Iy(o,t)),i;if(o===oa&&t==="line"){const s=Ao(e[o]);if(s==null?void 0:s.aggregate)return q(z_e),i}if(o===nr&&(n?"fill"in e:"stroke"in e))return q(BI("encoding",{fill:"fill"in e,stroke:"stroke"in e})),i;if(o===g0||o===h0&&!Z(a)&&!Si(a)||o===Nu&&Z(a))a&&(i[o]=gt(a).reduce((s,u)=>(Y(u)?s.push(sO(u,o)):q(OC(u,o)),s),[]));else{if(o===Nu&&a===null)i[o]=null;else if(!Y(a)&&!ds(a)&&!Si(a)&&!Ky(a)&&!ie(a))return q(OC(a,o)),i;i[o]=NB(a,o,r)}return i},{})}function ov(e,t){const n={};for(const r of U(e)){const i=NB(e[r],r,t,{compositeMark:!0});n[r]=i}return n}function K$e(e){const t=[];for(const n of U(e))if(Uu(e,n)){const r=e[n],i=gt(r);for(const o of i)Y(o)?t.push(o):Zy(o)&&t.push(o.condition)}return t}function lO(e,t,n){if(!!e)for(const r of U(e)){const i=e[r];if(Z(i))for(const o of i)t.call(n,o,r);else t.call(n,i,r)}}function Z$e(e,t,n,r){return e?U(e).reduce((i,o)=>{const a=e[o];return Z(a)?a.reduce((s,u)=>t.call(r,s,u,o),i):t.call(r,i,a,o)},n):n}function zB(e,t){return U(t).reduce((n,r)=>{switch(r){case ut:case Mt:case Dy:case Ty:case Ny:case _i:case ho:case Ei:case ia:case go:case ra:case po:case mo:case $i:case Gr:case d0:case rr:case Du:case Nu:return n;case h0:if(e==="line"||e==="trail")return n;case g0:case My:{const i=t[r];if(Z(i)||Y(i))for(const o of gt(i))o.aggregate||n.push(G(o,{}));return n}case oa:if(e==="trail")return n;case nr:case yo:case vo:case aa:case ts:case ns:case is:case rs:{const i=Ao(t[r]);return i&&!i.aggregate&&n.push(G(i,{})),n}}},[])}var UB=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function J$e(e){const{tooltip:t}=e,n=UB(e,["tooltip"]);if(!t)return{filteredEncoding:n};let r,i;if(Z(t)){for(const o of t)o.aggregate?(r||(r=[]),r.push(o)):(i||(i=[]),i.push(o));r&&(n.tooltip=r)}else t.aggregate?n.tooltip=t:i=t;return Z(i)&&i.length===1&&(i=i[0]),{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}function cO(e,t,n,r=!0){if("tooltip"in n)return{tooltip:n.tooltip};const i=e.map(({fieldPrefix:a,titlePrefix:s})=>{const u=r?` of ${fO(t)}`:"";return{field:a+t.field,type:t.type,title:ie(s)?{signal:`${s}"${escape(u)}"`}:s+u}}),o=K$e(n).map(N$e);return{tooltip:[...i,...fo(o,Ce)]}}function fO(e){const{title:t,field:n}=e;return $t(t,n)}function dO(e,t,n,r,i){const{scale:o,axis:a}=n;return({partName:s,mark:u,positionPrefix:l,endPositionPrefix:c=void 0,extraEncoding:f={}})=>{const d=fO(n);return qB(e,s,i,{mark:u,encoding:Object.assign(Object.assign(Object.assign({[t]:Object.assign(Object.assign(Object.assign({field:`${l}_${n.field}`,type:n.type},d!==void 0?{title:d}:{}),o!==void 0?{scale:o}:{}),a!==void 0?{axis:a}:{})},he(c)?{[`${t}2`]:{field:`${c}_${n.field}`}}:{}),r),f)})}}function qB(e,t,n,r){const{clip:i,color:o,opacity:a}=e,s=e.type;return e[t]||e[t]===void 0&&n[t]?[Object.assign(Object.assign({},r),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[t]),i?{clip:i}:{}),o?{color:o}:{}),a?{opacity:a}:{}),_o(r.mark)?r.mark:{type:r.mark}),{style:`${s}-${t}`}),a0(e[t])?{}:e[t])})]:[]}function HB(e,t,n){const{encoding:r}=e,i=t==="vertical"?"y":"x",o=r[i],a=r[`${i}2`],s=r[`${i}Error`],u=r[`${i}Error2`];return{continuousAxisChannelDef:av(o,n),continuousAxisChannelDef2:av(a,n),continuousAxisChannelDefError:av(s,n),continuousAxisChannelDefError2:av(u,n),continuousAxis:i}}function av(e,t){if(e==null?void 0:e.aggregate){const{aggregate:n}=e,r=UB(e,["aggregate"]);return n!==t&&q(mEe(n,t)),r}else return e}function WB(e,t){const{mark:n,encoding:r}=e,{x:i,y:o}=r;if(_o(n)&&n.orient)return n.orient;if($o(i)){if($o(o)){const a=Y(i)&&i.aggregate,s=Y(o)&&o.aggregate;if(!a&&s===t)return"vertical";if(!s&&a===t)return"horizontal";if(a===t&&s===t)throw new Error("Both x and y cannot have aggregate");return zc(o)&&!zc(i)?"horizontal":"vertical"}return"horizontal"}else{if($o(o))return"vertical";throw new Error(`Need a valid continuous axis for ${t}s`)}}var sv=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const uv="boxplot",Q$e=["box","median","outliers","rule","ticks"],eAe=new iv(uv,YB);function GB(e){return Et(e)?"tukey":e}function YB(e,{config:t}){var n,r;e=Object.assign(Object.assign({},e),{encoding:ov(e.encoding,t)});const{mark:i,encoding:o,params:a,projection:s}=e,u=sv(e,["mark","encoding","params","projection"]),l=_o(i)?i:{type:i};a&&q(RI("boxplot"));const c=(n=l.extent)!==null&&n!==void 0?n:t.boxplot.extent,f=ze("size",l,t),d=GB(c),{bins:h,timeUnits:g,transform:p,continuousAxisChannelDef:m,continuousAxis:y,groupby:v,aggregate:b,encodingWithoutContinuousAxis:x,ticksOrient:w,boxOrient:E,customTooltipWithoutAggregatedField:_}=tAe(e,c,t),{color:S,size:C}=x,O=sv(x,["color","size"]),$=$e=>dO(l,y,m,$e,t.boxplot),M=$(O),F=$(x),N=$(Object.assign(Object.assign({},O),C?{size:C}:{})),A=cO([{fieldPrefix:d==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:d==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],m,x),k={type:"tick",color:"black",opacity:1,orient:w,invalid:null,aria:!1},T=d==="min-max"?A:cO([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],m,x),L=[...M({partName:"rule",mark:{type:"rule",invalid:null,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:T}),...M({partName:"rule",mark:{type:"rule",invalid:null,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:T}),...M({partName:"ticks",mark:k,positionPrefix:"lower_whisker",extraEncoding:T}),...M({partName:"ticks",mark:k,positionPrefix:"upper_whisker",extraEncoding:T})],z=[...d!=="tukey"?L:[],...F({partName:"box",mark:Object.assign(Object.assign({type:"bar"},f?{size:f}:{}),{orient:E,invalid:null,ariaRoleDescription:"box"}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:A}),...N({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},Xe(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{}),f?{size:f}:{}),{orient:w,aria:!1}),positionPrefix:"mid_box",extraEncoding:A})];if(d==="min-max")return Object.assign(Object.assign({},u),{transform:((r=u.transform)!==null&&r!==void 0?r:[]).concat(p),layer:z});const Q=`datum["lower_box_${m.field}"]`,oe=`datum["upper_box_${m.field}"]`,ue=`(${oe} - ${Q})`,ce=`${Q} - ${c} * ${ue}`,xe=`${oe} + ${c} * ${ue}`,_e=`datum["${m.field}"]`,Wt={joinaggregate:VB(m.field),groupby:v},ur={transform:[{filter:`(${ce} <= ${_e}) && (${_e} <= ${xe})`},{aggregate:[{op:"min",field:m.field,as:`lower_whisker_${m.field}`},{op:"max",field:m.field,as:`upper_whisker_${m.field}`},{op:"min",field:`lower_box_${m.field}`,as:`lower_box_${m.field}`},{op:"max",field:`upper_box_${m.field}`,as:`upper_box_${m.field}`},...b],groupby:v}],layer:L},Bn=sv(O,["tooltip"]),{scale:P,axis:W}=m,V=fO(m),D=Sr(W,["title"]),Ee=qB(l,"outliers",t.boxplot,{transform:[{filter:`(${_e} < ${ce}) || (${_e} > ${xe})`}],mark:"point",encoding:Object.assign(Object.assign(Object.assign({[y]:Object.assign(Object.assign(Object.assign({field:m.field,type:m.type},V!==void 0?{title:V}:{}),P!==void 0?{scale:P}:{}),Ge(D)?{}:{axis:D})},Bn),S?{color:S}:{}),_?{tooltip:_}:{})})[0];let X;const ke=[...h,...g,Wt];return Ee?X={transform:ke,layer:[Ee,ur]}:(X=ur,X.transform.unshift(...ke)),Object.assign(Object.assign({},u),{layer:[X,{transform:p,layer:z}]})}function VB(e){return[{op:"q1",field:e,as:`lower_box_${e}`},{op:"q3",field:e,as:`upper_box_${e}`}]}function tAe(e,t,n){const r=WB(e,uv),{continuousAxisChannelDef:i,continuousAxis:o}=HB(e,r,uv),a=i.field,s=GB(t),u=[...VB(a),{op:"median",field:a,as:`mid_box_${a}`},{op:"min",field:a,as:(s==="min-max"?"lower_whisker_":"min_")+a},{op:"max",field:a,as:(s==="min-max"?"upper_whisker_":"max_")+a}],l=s==="min-max"||s==="tukey"?[]:[{calculate:`datum["upper_box_${a}"] - datum["lower_box_${a}"]`,as:`iqr_${a}`},{calculate:`min(datum["upper_box_${a}"] + datum["iqr_${a}"] * ${t}, datum["max_${a}"])`,as:`upper_whisker_${a}`},{calculate:`max(datum["lower_box_${a}"] - datum["iqr_${a}"] * ${t}, datum["min_${a}"])`,as:`lower_whisker_${a}`}],c=e.encoding,f=o;c[f];const d=sv(c,[typeof f=="symbol"?f:f+""]),{customTooltipWithoutAggregatedField:h,filteredEncoding:g}=J$e(d),{bins:p,timeUnits:m,aggregate:y,groupby:v,encoding:b}=BB(g,n),x=r==="vertical"?"horizontal":"vertical",w=r,E=[...p,...m,{aggregate:[...y,...u],groupby:v},...l];return{bins:p,timeUnits:m,transform:E,groupby:v,aggregate:y,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:b,ticksOrient:x,boxOrient:w,customTooltipWithoutAggregatedField:h}}var XB=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const hO="errorbar",nAe=["ticks","rule"],rAe=new iv(hO,KB);function KB(e,{config:t}){e=Object.assign(Object.assign({},e),{encoding:ov(e.encoding,t)});const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:o,ticksOrient:a,markDef:s,outerSpec:u,tooltipEncoding:l}=ZB(e,hO,t);delete o.size;const c=dO(s,i,r,o,t.errorbar),f=s.thickness,d=s.size,h=Object.assign(Object.assign({type:"tick",orient:a,aria:!1},f!==void 0?{thickness:f}:{}),d!==void 0?{size:d}:{}),g=[...c({partName:"ticks",mark:h,positionPrefix:"lower",extraEncoding:l}),...c({partName:"ticks",mark:h,positionPrefix:"upper",extraEncoding:l}),...c({partName:"rule",mark:Object.assign({type:"rule",ariaRoleDescription:"errorbar"},f!==void 0?{size:f}:{}),positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l})];return Object.assign(Object.assign(Object.assign({},u),{transform:n}),g.length>1?{layer:g}:Object.assign({},g[0]))}function iAe(e,t){const{encoding:n}=e;if(oAe(n))return{orient:WB(e,t),inputType:"raw"};const r=aAe(n),i=sAe(n),o=n.x,a=n.y;if(r){if(i)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const s=n.x2,u=n.y2;if(fe(s)&&fe(u))throw new Error(`${t} cannot have both x2 and y2`);if(fe(s)){if($o(o))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}else if(fe(u)){if($o(a))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}else{const s=n.xError,u=n.xError2,l=n.yError,c=n.yError2;if(fe(u)&&!fe(s))throw new Error(`${t} cannot have xError2 without xError`);if(fe(c)&&!fe(l))throw new Error(`${t} cannot have yError2 without yError`);if(fe(s)&&fe(l))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(fe(s)){if($o(o))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(fe(l)){if($o(a))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function oAe(e){return(fe(e.x)||fe(e.y))&&!fe(e.x2)&&!fe(e.y2)&&!fe(e.xError)&&!fe(e.xError2)&&!fe(e.yError)&&!fe(e.yError2)}function aAe(e){return fe(e.x2)||fe(e.y2)}function sAe(e){return fe(e.xError)||fe(e.xError2)||fe(e.yError)||fe(e.yError2)}function ZB(e,t,n){var r;const{mark:i,encoding:o,params:a,projection:s}=e,u=XB(e,["mark","encoding","params","projection"]),l=_o(i)?i:{type:i};a&&q(RI(t));const{orient:c,inputType:f}=iAe(e,t),{continuousAxisChannelDef:d,continuousAxisChannelDef2:h,continuousAxisChannelDefError:g,continuousAxisChannelDefError2:p,continuousAxis:m}=HB(e,c,t),{errorBarSpecificAggregate:y,postAggregateCalculates:v,tooltipSummary:b,tooltipTitleWithFieldName:x}=uAe(l,d,h,g,p,f,t,n),w=o,E=m;w[E];const _=m==="x"?"x2":"y2";w[_];const S=m==="x"?"xError":"yError";w[S];const C=m==="x"?"xError2":"yError2";w[C];const O=XB(w,[typeof E=="symbol"?E:E+"",typeof _=="symbol"?_:_+"",typeof S=="symbol"?S:S+"",typeof C=="symbol"?C:C+""]),{bins:$,timeUnits:M,aggregate:F,groupby:N,encoding:A}=BB(O,n),k=[...F,...y],T=f!=="raw"?[]:N,L=cO(b,d,A,x);return{transform:[...(r=u.transform)!==null&&r!==void 0?r:[],...$,...M,...k.length===0?[]:[{aggregate:k,groupby:T}],...v],groupby:T,continuousAxisChannelDef:d,continuousAxis:m,encodingWithoutContinuousAxis:A,ticksOrient:c==="vertical"?"horizontal":"vertical",markDef:l,outerSpec:u,tooltipEncoding:L}}function uAe(e,t,n,r,i,o,a,s){let u=[],l=[];const c=t.field;let f,d=!1;if(o==="raw"){const h=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":s.errorbar.center,g=e.extent?e.extent:h==="mean"?"stderr":"iqr";if(h==="median"!=(g==="iqr")&&q(pEe(h,g,a)),g==="stderr"||g==="stdev")u=[{op:g,field:c,as:`extent_${c}`},{op:h,field:c,as:`center_${c}`}],l=[{calculate:`datum["center_${c}"] + datum["extent_${c}"]`,as:`upper_${c}`},{calculate:`datum["center_${c}"] - datum["extent_${c}"]`,as:`lower_${c}`}],f=[{fieldPrefix:"center_",titlePrefix:l0(h)},{fieldPrefix:"upper_",titlePrefix:JB(h,g,"+")},{fieldPrefix:"lower_",titlePrefix:JB(h,g,"-")}],d=!0;else{let p,m,y;g==="ci"?(p="mean",m="ci0",y="ci1"):(p="median",m="q1",y="q3"),u=[{op:m,field:c,as:`lower_${c}`},{op:y,field:c,as:`upper_${c}`},{op:p,field:c,as:`center_${c}`}],f=[{fieldPrefix:"upper_",titlePrefix:Ic({field:c,aggregate:y,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:Ic({field:c,aggregate:m,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:Ic({field:c,aggregate:p,type:"quantitative"},s,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&q(gEe(e.center,e.extent)),o==="aggregated-upper-lower"?(f=[],l=[{calculate:`datum["${n.field}"]`,as:`upper_${c}`},{calculate:`datum["${c}"]`,as:`lower_${c}`}]):o==="aggregated-error"&&(f=[{fieldPrefix:"",titlePrefix:c}],l=[{calculate:`datum["${c}"] + datum["${r.field}"]`,as:`upper_${c}`}],i?l.push({calculate:`datum["${c}"] + datum["${i.field}"]`,as:`lower_${c}`}):l.push({calculate:`datum["${c}"] - datum["${r.field}"]`,as:`lower_${c}`}));for(const h of l)f.push({fieldPrefix:h.as.substring(0,6),titlePrefix:Mu(Mu(h.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:l,errorBarSpecificAggregate:u,tooltipSummary:f,tooltipTitleWithFieldName:d}}function JB(e,t,n){return`${l0(e)} ${n} ${t}`}const gO="errorband",lAe=["band","borders"],cAe=new iv(gO,QB);function QB(e,{config:t}){e=Object.assign(Object.assign({},e),{encoding:ov(e.encoding,t)});const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:o,markDef:a,outerSpec:s,tooltipEncoding:u}=ZB(e,gO,t),l=a,c=dO(l,i,r,o,t.errorband),f=e.encoding.x!==void 0&&e.encoding.y!==void 0;let d={type:f?"area":"rect"},h={type:f?"line":"rule"};const g=Object.assign(Object.assign({},l.interpolate?{interpolate:l.interpolate}:{}),l.tension&&l.interpolate?{tension:l.tension}:{});return f?(d=Object.assign(Object.assign(Object.assign({},d),g),{ariaRoleDescription:"errorband"}),h=Object.assign(Object.assign(Object.assign({},h),g),{aria:!1})):l.interpolate?q(HI("interpolate")):l.tension&&q(HI("tension")),Object.assign(Object.assign({},s),{transform:n,layer:[...c({partName:"band",mark:d,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"lower",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"upper",extraEncoding:u})]})}const ez={};function pO(e,t,n){const r=new iv(e,t);ez[e]={normalizer:r,parts:n}}function fAe(){return U(ez)}pO(uv,YB,Q$e);pO(hO,KB,nAe);pO(gO,QB,lAe);const dAe=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],tz={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},nz={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},hAe=U(tz),gAe=U(nz),pAe={header:1,headerRow:1,headerColumn:1,headerFacet:1},rz=U(pAe),iz=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],mAe={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},yAe={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},E0="_vgsid_",vAe={point:{on:"click",fields:[E0],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function mO(e){return!!e&&(e==="legend"||!!e.legend)}function yO(e){return mO(e)&&Xe(e)}function vO(e){return!!e.select}var bAe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function oz(e){const t=[];for(const n of e||[]){if(vO(n))continue;const{expr:r,bind:i}=n,o=bAe(n,["expr","bind"]);if(i&&r){const a=Object.assign(Object.assign({},o),{bind:i,init:r});t.push(a)}else{const a=Object.assign(Object.assign(Object.assign({},o),r?{update:r}:{}),i?{bind:i}:{});t.push(a)}}return t}function xAe(e){return lv(e)||xO(e)||bO(e)}function bO(e){return"concat"in e}function lv(e){return"vconcat"in e}function xO(e){return"hconcat"in e}function So(e){return Xe(e)&&e.step!==void 0}function az(e){return e.view||e.width||e.height}const sz=20,wAe={align:1,bounds:1,center:1,columns:1,spacing:1},_Ae=U(wAe);function EAe(e,t,n){var r,i;const o=n[t],a={},{spacing:s,columns:u}=o;s!==void 0&&(a.spacing=s),u!==void 0&&(Xy(e)&&!x0(e.facet)||bO(e))&&(a.columns=u),lv(e)&&(a.columns=1);for(const l of _Ae)if(e[l]!==void 0)if(l==="spacing"){const c=e[l];a[l]=Et(c)?c:{row:(r=c.row)!==null&&r!==void 0?r:s,column:(i=c.column)!==null&&i!==void 0?i:s}}else a[l]=e[l];return a}var $Ae=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function wO(e,t){var n;return(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"continuousWidth":"continuousHeight"]}function cv(e,t){const n=$0(e,t);return So(n)?n.step:uz}function $0(e,t){var n;const r=(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"discreteWidth":"discreteHeight"];return $t(r,{step:e.step})}const uz=20,AAe={continuousWidth:200,continuousHeight:200,step:uz},SAe={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:AAe,mark:y$e,arc:{},area:{},bar:x$e,circle:{},geoshape:{},image:{},line:{},point:{},rect:w$e,rule:{color:"black"},square:{},text:{color:"black"},tick:_$e,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:e$e,projection:{},legend:mAe,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:vAe,style:{},title:{},facet:{spacing:sz},concat:{spacing:sz}},da=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],lz={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},cz={blue:da[0],orange:da[1],red:da[2],teal:da[3],green:da[4],yellow:da[5],purple:da[6],pink:da[7],brown:da[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function CAe(e={}){return{signals:[{name:"color",value:Xe(e)?Object.assign(Object.assign({},cz),e):cz}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function OAe(e){return{signals:[{name:"fontSize",value:Xe(e)?Object.assign(Object.assign({},lz),e):lz}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function FAe(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function fz(e){const t=U(e||{}),n={};for(const r of t){const i=e[r];n[r]=_0(i)?_I(i):Cr(i)}return n}function kAe(e){const t=U(e),n={};for(const r of t)n[r]=fz(e[r]);return n}const MAe=[...cB,...IB,...rz,"background","padding","legend","lineBreak","scale","style","title","view"];function dz(e={}){const{color:t,font:n,fontSize:r,selection:i}=e,o=$Ae(e,["color","font","fontSize","selection"]),a=eI({},ge(SAe),n?FAe(n):{},t?CAe(t):{},r?OAe(r):{},o||{});i&&Df(a,"selection",i,!0);const s=Sr(a,MAe);for(const u of["background","lineBreak","padding"])a[u]&&(s[u]=Cr(a[u]));for(const u of cB)a[u]&&(s[u]=ir(a[u]));for(const u of IB)a[u]&&(s[u]=fz(a[u]));for(const u of rz)a[u]&&(s[u]=ir(a[u]));return a.legend&&(s.legend=ir(a.legend)),a.scale&&(s.scale=ir(a.scale)),a.style&&(s.style=kAe(a.style)),a.title&&(s.title=ir(a.title)),a.view&&(s.view=ir(a.view)),s}const DAe=["view",...uB],NAe=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],TAe=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},m$e);function RAe(e){e=ge(e);for(const t of NAe)delete e[t];if(e.axis)for(const t in e.axis)_0(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of dAe)delete e.legend[t];if(e.mark){for(const t of lB)delete e.mark[t];e.mark.tooltip&&Xe(e.mark.tooltip)&&delete e.mark.tooltip}e.params&&(e.signals=(e.signals||[]).concat(oz(e.params)),delete e.params);for(const t of DAe){for(const r of lB)delete e[t][r];const n=TAe[t];if(n)for(const r of n)delete e[t][r];LAe(e,t)}for(const t of fAe())delete e[t];PAe(e);for(const t in e)Xe(e[t])&&Ge(e[t])&&delete e[t];return Ge(e)?void 0:e}function PAe(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:r}=wI(e.title);Ge(t)||(e.style["group-title"]=Object.assign(Object.assign({},e.style["group-title"]),t)),Ge(n)||(e.style["group-subtitle"]=Object.assign(Object.assign({},e.style["group-subtitle"]),n)),Ge(r)?delete e.title:e.title=r}function LAe(e,t,n,r){const i=r?e[t][r]:e[t];t==="view"&&(n="cell");const o=Object.assign(Object.assign({},i),e.style[n!=null?n:t]);Ge(o)||(e.style[n!=null?n:t]=o),r||delete e[t]}function fv(e){return"layer"in e}function jAe(e){return"repeat"in e}function IAe(e){return!Z(e.repeat)&&e.repeat.layer}var BAe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};class _O{map(t,n){return Xy(t)?this.mapFacet(t,n):jAe(t)?this.mapRepeat(t,n):xO(t)?this.mapHConcat(t,n):lv(t)?this.mapVConcat(t,n):bO(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(fv(t))return this.mapLayer(t,n);if(fa(t))return this.mapUnit(t,n);throw new Error(SC(t))}mapLayer(t,n){return Object.assign(Object.assign({},t),{layer:t.layer.map(r=>this.mapLayerOrUnit(r,n))})}mapHConcat(t,n){return Object.assign(Object.assign({},t),{hconcat:t.hconcat.map(r=>this.map(r,n))})}mapVConcat(t,n){return Object.assign(Object.assign({},t),{vconcat:t.vconcat.map(r=>this.map(r,n))})}mapConcat(t,n){const{concat:r}=t,i=BAe(t,["concat"]);return Object.assign(Object.assign({},i),{concat:r.map(o=>this.map(o,n))})}mapFacet(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}mapRepeat(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}}const zAe={zero:1,center:1,normalize:1};function UAe(e){return e in zAe}const qAe=new Set([iB,Uy,zy,Wy,Hy,YC,VC,qy,oB,GC]),HAe=new Set([Uy,zy,iB]);function Uc(e){return Y(e)&&nO(e)==="quantitative"&&!e.bin}function hz(e,t){var n,r;const i=t==="x"?"y":"radius",o=e[t],a=e[i];if(Y(o)&&Y(a))if(Uc(o)&&Uc(a)){if(o.stack)return t;if(a.stack)return i;const s=Y(o)&&!!o.aggregate,u=Y(a)&&!!a.aggregate;if(s!==u)return s?t:i;{const l=(n=o.scale)===null||n===void 0?void 0:n.type,c=(r=a.scale)===null||r===void 0?void 0:r.type;if(l&&l!=="linear")return i;if(c&&c!=="linear")return t}}else{if(Uc(o))return t;if(Uc(a))return i}else{if(Uc(o))return t;if(Uc(a))return i}}function WAe(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function gz(e,t,n={}){var r,i;const o=_o(e)?e.type:e;if(!qAe.has(o))return null;const a=hz(t,"x")||hz(t,"theta");if(!a)return null;const s=t[a],u=Y(s)?G(s,{}):void 0;let l=WAe(a),c=t[l],f=Y(c)?G(c,{}):void 0;f===u&&(f=void 0,c=void 0,l=void 0);const d=Zwe.reduce((g,p)=>{if(p!=="tooltip"&&Uu(t,p)){const m=t[p];for(const y of gt(m)){const v=Ao(y);if(v.aggregate)continue;const b=G(v,{});(!b||b!==f)&&g.push({channel:p,fieldDef:v})}}return g},[]);let h;if(s.stack!==void 0?a0(s.stack)?h=s.stack?"zero":null:h=s.stack:HAe.has(o)&&(h="zero"),!h||!UAe(h)||uO(t)&&d.length===0)return null;if(((r=s==null?void 0:s.scale)===null||r===void 0?void 0:r.type)&&((i=s==null?void 0:s.scale)===null||i===void 0?void 0:i.type)!==Dt.LINEAR){if(n.disallowNonLinearStack)return null;q(fEe(s.scale.type))}return fe(t[sa(a)])?(s.stack!==void 0&&q(cEe(a)),null):(Y(s)&&s.aggregate&&!ve(l_e,s.aggregate)&&q(dEe(s.aggregate)),{groupbyChannel:c?l:void 0,groupbyField:f,fieldChannel:a,impute:s.impute===null?!1:fs(o),stackBy:d,offset:h})}var pz=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function GAe(e){const t=pz(e,["point","line"]);return U(t).length>1?t:t.type}function YAe(e){for(const t of["line","area","rule","trail"])e[t]&&(e=Object.assign(Object.assign({},e),{[t]:Sr(e[t],["point","line"])}));return e}function EO(e,t={},n){return e.point==="transparent"?{opacity:0}:e.point?Xe(e.point)?e.point:{}:e.point!==void 0?null:t.point||n.shape?Xe(t.point)?t.point:{}:void 0}function mz(e,t={}){return e.line?e.line===!0?{}:e.line:e.line!==void 0?null:t.line?t.line===!0?{}:t.line:void 0}class VAe{constructor(){this.name="path-overlay"}hasMatchingType(t,n){if(fa(t)){const{mark:r,encoding:i}=t,o=_o(r)?r:{type:r};switch(o.type){case"line":case"rule":case"trail":return!!EO(o,n[o.type],i);case"area":return!!EO(o,n[o.type],i)||!!mz(o,n[o.type])}}return!1}run(t,n,r){const{config:i}=n,{params:o,projection:a,mark:s,encoding:u}=t,l=pz(t,["params","projection","mark","encoding"]),c=ov(u,i),f=_o(s)?s:{type:s},d=EO(f,i[f.type],c),h=f.type==="area"&&mz(f,i[f.type]),g=[Object.assign(Object.assign({},o?{params:o}:{}),{mark:GAe(Object.assign(Object.assign({},f.type==="area"&&f.opacity===void 0&&f.fillOpacity===void 0?{opacity:.7}:{}),f)),encoding:Sr(c,["shape"])})],p=gz(f,c);let m=c;if(p){const{fieldChannel:y,offset:v}=p;m=Object.assign(Object.assign({},c),{[y]:Object.assign(Object.assign({},c[y]),v?{stack:v}:{})})}return h&&g.push(Object.assign(Object.assign({},a?{projection:a}:{}),{mark:Object.assign(Object.assign({type:"line"},Mc(f,["clip","interpolate","tension","tooltip"])),h),encoding:m})),d&&g.push(Object.assign(Object.assign({},a?{projection:a}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},Mc(f,["clip","tooltip"])),d),encoding:m})),r(Object.assign(Object.assign({},l),{layer:g}),Object.assign(Object.assign({},n),{config:YAe(i)}))}}var XAe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function KAe(e,t){return t?x0(e)?xz(e,t):yz(e,t):e}function $O(e,t){return t?xz(e,t):e}function AO(e,t,n){const r=t[e];if(M$e(r)){if(r.repeat in n)return Object.assign(Object.assign({},t),{[e]:n[r.repeat]});q(F_e(r.repeat));return}return t}function yz(e,t){if(e=AO("field",e,t),e!==void 0){if(e===null)return null;if(tO(e)&&Eo(e.sort)){const n=AO("field",e.sort,t);e=Object.assign(Object.assign({},e),n?{sort:n}:{})}return e}}function vz(e,t){if(Y(e))return yz(e,t);{const n=AO("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function bz(e,t){if(fe(e)){const n=vz(e,t);if(n)return n;if(Ky(e))return{condition:e.condition}}else{if(Jy(e)){const n=vz(e.condition,t);return n?Object.assign(Object.assign({},e),{condition:n}):XAe(e,["condition"])}return e}}function xz(e,t){const n={};for(const r in e)if(Fc(e,r)){const i=e[r];if(Z(i))n[r]=i.map(o=>bz(o,t)).filter(o=>o);else{const o=bz(i,t);o!==void 0&&(n[r]=o)}}return n}class ZAe{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(fa(t)){const{encoding:n,mark:r}=t;if(r==="line"||_o(r)&&r.type==="line")for(const i of Xwe){const o=Tu(i),a=n[o];if(n[i]&&(Y(a)&&!Pn(a.bin)||ds(a)))return!0}}return!1}run(t,n,r){const{encoding:i,mark:o}=t;return q(Y_e(!!i.x2,!!i.y2)),r(Object.assign(Object.assign({},t),{mark:Xe(o)?Object.assign(Object.assign({},o),{type:"rule"}):"rule"}),n)}}var hs=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};class JAe extends _O{constructor(){super(...arguments);this.nonFacetUnitNormalizers=[eAe,rAe,cAe,new VAe,new ZAe]}map(t,n){if(fa(t)){const r=Uu(t.encoding,ta),i=Uu(t.encoding,na),o=Uu(t.encoding,ky);if(r||i||o)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){const{parentEncoding:r,parentProjection:i}=n,o=$O(t.encoding,n.repeater),a=Object.assign(Object.assign({},t),o?{encoding:o}:{});if(r||i)return this.mapUnitWithParentEncodingOrProjection(a,n);const s=this.mapLayerOrUnit.bind(this);for(const u of this.nonFacetUnitNormalizers)if(u.hasMatchingType(a,n.config))return u.run(a,n,s);return a}mapRepeat(t,n){return IAe(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){const{repeat:r,spec:i}=t,o=hs(t,["repeat","spec"]),{row:a,column:s,layer:u}=r,{repeater:l={},repeaterPrefix:c=""}=n;return a||s?this.mapRepeat(Object.assign(Object.assign({},t),{repeat:Object.assign(Object.assign({},a?{row:a}:{}),s?{column:s}:{}),spec:{repeat:{layer:u},spec:i}}),n):Object.assign(Object.assign({},o),{layer:u.map(f=>{const d=Object.assign(Object.assign({},l),{layer:f}),h=`${(i.name||"")+c}child__layer_${it(f)}`,g=this.mapLayerOrUnit(i,Object.assign(Object.assign({},n),{repeater:d,repeaterPrefix:h}));return g.name=h,g})})}mapNonLayerRepeat(t,n){var r;const{repeat:i,spec:o,data:a}=t,s=hs(t,["repeat","spec","data"]);!Z(i)&&t.columns&&(t=Sr(t,["columns"]),q(PI("repeat")));const u=[],{repeater:l={},repeaterPrefix:c=""}=n,f=!Z(i)&&i.row||[l?l.row:null],d=!Z(i)&&i.column||[l?l.column:null],h=Z(i)&&i||[l?l.repeat:null];for(const p of h)for(const m of f)for(const y of d){const v={repeat:p,row:m,column:y,layer:l.layer},b=(o.name||"")+c+"child__"+(Z(i)?`${it(p)}`:(i.row?`row_${it(m)}`:"")+(i.column?`column_${it(y)}`:"")),x=this.map(o,Object.assign(Object.assign({},n),{repeater:v,repeaterPrefix:b}));x.name=b,u.push(Sr(x,["data"]))}const g=Z(i)?t.columns:i.column?i.column.length:1;return Object.assign(Object.assign({data:(r=o.data)!==null&&r!==void 0?r:a,align:"all"},s),{columns:g,concat:u})}mapFacet(t,n){const{facet:r}=t;return x0(r)&&t.columns&&(t=Sr(t,["columns"]),q(PI("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){const{encoding:r,projection:i}=t,{parentEncoding:o,parentProjection:a,config:s}=n,u=_z({parentProjection:a,projection:i}),l=wz({parentEncoding:o,encoding:$O(r,n.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},t),u?{projection:u}:{}),l?{encoding:l}:{}),{config:s})}mapFacetedUnit(t,n){const r=t.encoding,{row:i,column:o,facet:a}=r,s=hs(r,["row","column","facet"]),{mark:u,width:l,projection:c,height:f,view:d,params:h,encoding:g}=t,p=hs(t,["mark","width","projection","height","view","params","encoding"]),{facetMapping:m,layout:y}=this.getFacetMappingAndLayout({row:i,column:o,facet:a},n),v=$O(s,n.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},p),y),{facet:m,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},l?{width:l}:{}),f?{height:f}:{}),d?{view:d}:{}),c?{projection:c}:{}),{mark:u,encoding:v}),h?{params:h}:{})}),n)}getFacetMappingAndLayout(t,n){var r;const{row:i,column:o,facet:a}=t;if(i||o){a&&q(W_e([...i?[ta]:[],...o?[na]:[]]));const s={},u={};for(const l of[ta,na]){const c=t[l];if(c){const f=hs(c,["align","center","spacing","columns"]);s[l]=f;for(const d of["align","center","spacing"])c[d]!==void 0&&((r=u[d])!==null&&r!==void 0||(u[d]={}),u[d][l]=c[d])}}return{facetMapping:s,layout:u}}else{const{align:s,center:u,spacing:l,columns:c}=a,f=hs(a,["align","center","spacing","columns"]);return{facetMapping:KAe(f,n.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},s?{align:s}:{}),u?{center:u}:{}),l?{spacing:l}:{}),c?{columns:c}:{})}}}mapLayer(t,n){var{parentEncoding:r,parentProjection:i}=n,o=hs(n,["parentEncoding","parentProjection"]);const{encoding:a,projection:s}=t,u=hs(t,["encoding","projection"]),l=Object.assign(Object.assign({},o),{parentEncoding:wz({parentEncoding:r,encoding:a,layer:!0}),parentProjection:_z({parentProjection:i,projection:s})});return super.mapLayer(u,l)}}function wz({parentEncoding:e,encoding:t={},layer:n}){let r={};if(e){const i=new Set([...U(e),...U(t)]);for(const o of i){const a=t[o],s=e[o];if(fe(a)){const u=Object.assign(Object.assign({},s),a);r[o]=u}else Jy(a)?r[o]=Object.assign(Object.assign({},a),{condition:Object.assign(Object.assign({},s),a.condition)}):a||a===null?r[o]=a:(n||Si(s)||ie(s)||fe(s)||Z(s))&&(r[o]=s)}}else r=t;return!r||Ge(r)?void 0:r}function _z(e){const{parentProjection:t,projection:n}=e;return t&&n&&q(R_e({parentProjection:t,projection:n})),n!=null?n:t}function SO(e){return"filter"in e}function QAe(e){return(e==null?void 0:e.stop)!==void 0}function Ez(e){return"lookup"in e}function eSe(e){return"data"in e}function tSe(e){return"param"in e}function nSe(e){return"pivot"in e}function rSe(e){return"density"in e}function iSe(e){return"quantile"in e}function oSe(e){return"regression"in e}function aSe(e){return"loess"in e}function sSe(e){return"sample"in e}function uSe(e){return"window"in e}function lSe(e){return"joinaggregate"in e}function cSe(e){return"flatten"in e}function fSe(e){return"calculate"in e}function $z(e){return"bin"in e}function dSe(e){return"impute"in e}function hSe(e){return"timeUnit"in e}function gSe(e){return"aggregate"in e}function pSe(e){return"stack"in e}function mSe(e){return"fold"in e}function ySe(e){return e.map(t=>SO(t)?{filter:kc(t.filter,IEe)}:t)}var gs=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};class vSe extends _O{map(t,n){var r,i;return(r=n.emptySelections)!==null&&r!==void 0||(n.emptySelections={}),(i=n.selectionPredicates)!==null&&i!==void 0||(n.selectionPredicates={}),t=Az(t,n),super.map(t,n)}mapLayerOrUnit(t,n){if(t=Az(t,n),t.encoding){const r={};for(const[i,o]of es(t.encoding))r[i]=Sz(o,n);t=Object.assign(Object.assign({},t),{encoding:r})}return super.mapLayerOrUnit(t,n)}mapUnit(t,n){const r=t,{selection:i}=r,o=gs(r,["selection"]);return i?Object.assign(Object.assign({},o),{params:es(i).map(([a,s])=>{var u;const l=s,{init:c,bind:f,empty:d}=l,h=gs(l,["init","bind","empty"]);h.type==="single"?(h.type="point",h.toggle=!1):h.type==="multi"&&(h.type="point"),n.emptySelections[a]=d!=="none";for(const g of pn((u=n.selectionPredicates[a])!==null&&u!==void 0?u:{}))g.empty=d!=="none";return{name:a,value:c,select:h,bind:f}})}):t}}function Az(e,t){const{transform:n}=e,r=gs(e,["transform"]);if(n){const i=n.map(o=>{if(SO(o))return{filter:CO(o,t)};if($z(o)&&Ru(o.bin))return Object.assign(Object.assign({},o),{bin:Cz(o.bin)});if(Ez(o)){const a=o.from,{selection:s}=a,u=gs(a,["selection"]);return s?Object.assign(Object.assign({},o),{from:Object.assign({param:s},u)}):o}return o});return Object.assign(Object.assign({},r),{transform:i})}return e}function Sz(e,t){var n,r;const i=ge(e);if(Y(i)&&Ru(i.bin)&&(i.bin=Cz(i.bin)),zu(i)&&((r=(n=i.scale)===null||n===void 0?void 0:n.domain)===null||r===void 0?void 0:r.selection)){const o=i.scale.domain,{selection:a}=o,s=gs(o,["selection"]);i.scale.domain=Object.assign(Object.assign({},s),a?{param:a}:{})}if(Ky(i))if(ee(i.condition))i.condition=i.condition.map(o=>{const{selection:a,param:s,test:u}=o,l=gs(o,["selection","param","test"]);return s?o:Object.assign(Object.assign({},l),{test:CO(o,t)})});else{const o=Sz(i.condition,t),{selection:a,param:s,test:u}=o,l=gs(o,["selection","param","test"]);i.condition=s?i.condition:Object.assign(Object.assign({},l),{test:CO(i.condition,t)})}return i}function Cz(e){const t=e.extent;if(t==null?void 0:t.selection){const{selection:n}=t,r=gs(t,["selection"]);return Object.assign(Object.assign({},e),{extent:Object.assign(Object.assign({},r),{param:n})})}return e}function CO(e,t){const n=r=>kc(r,i=>{var o,a,s;const u=(o=t.emptySelections[i])!==null&&o!==void 0?o:!0,l={param:i,empty:u};return(a=(s=t.selectionPredicates)[i])!==null&&a!==void 0||(s[i]=[]),t.selectionPredicates[i].push(l),l});return e.selection?n(e.selection):kc(e.test||e.filter,r=>r.selection?n(r.selection):r)}class OO extends _O{map(t,n){var r;const i=(r=n.selections)!==null&&r!==void 0?r:[];if(t.params&&!fa(t)){const o=[];for(const a of t.params)vO(a)?i.push(a):o.push(a);t.params=o}return n.selections=i,super.map(t,Oz(t,n))}mapUnit(t,n){var r;const i=n.selections;if(!i||!i.length)return t;const o=((r=n.path)!==null&&r!==void 0?r:[]).concat(t.name),a=[];for(const s of i)if(!s.views||!s.views.length)a.push(s);else for(const u of s.views)(Me(u)&&(u===t.name||o.indexOf(u)>=0)||ee(u)&&u.map(l=>o.indexOf(l)).every((l,c,f)=>l!==-1&&(c===0||l>f[c-1])))&&a.push(s);return a.length&&(t.params=a),t}}for(const e of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const t=OO.prototype[e];OO.prototype[e]=function(n,r){return t.call(this,n,Oz(n,r))}}function Oz(e,t){var n;return e.name?Object.assign(Object.assign({},t),{path:((n=t.path)!==null&&n!==void 0?n:[]).concat(e.name)}):t}function Fz(e,t){t===void 0&&(t=dz(e.config));const n=_Se(e,t),{width:r,height:i}=e,o=ESe(n,{width:r,height:i,autosize:e.autosize},t);return Object.assign(Object.assign({},n),o?{autosize:o}:{})}const bSe=new JAe,xSe=new vSe,wSe=new OO;function _Se(e,t={}){const n={config:t};return wSe.map(bSe.map(xSe.map(e,n),n),n)}function kz(e){return he(e)?{type:e}:e!=null?e:{}}function ESe(e,t,n){let{width:r,height:i}=t;const o=fa(e)||fv(e),a={};o?r=="container"&&i=="container"?(a.type="fit",a.contains="padding"):r=="container"?(a.type="fit-x",a.contains="padding"):i=="container"&&(a.type="fit-y",a.contains="padding"):(r=="container"&&(q(MI("width")),r=void 0),i=="container"&&(q(MI("height")),i=void 0));const s=Object.assign(Object.assign(Object.assign({type:"pad"},a),n?kz(n.autosize):{}),kz(e.autosize));if(s.type==="fit"&&!o&&(q(b_e),s.type="pad"),r=="container"&&!(s.type=="fit"||s.type=="fit-x")&&q(DI("width")),i=="container"&&!(s.type=="fit"||s.type=="fit-y")&&q(DI("height")),!co(s,{type:"pad"}))return s}function $Se(e){return e==="fit"||e==="fit-x"||e==="fit-y"}function ASe(e){return e?`fit-${Ry(e)}`:"fit"}const SSe=["background","padding"];function Mz(e,t){const n={};for(const r of SSe)e&&e[r]!==void 0&&(n[r]=Cr(e[r]));return t&&(n.params=e.params),n}class ha{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new ha(ge(this.explicit),ge(this.implicit))}combine(){return Object.assign(Object.assign({},this.explicit),this.implicit)}get(t){return $t(this.explicit[t],this.implicit[t])}getWithExplicit(t){return this.explicit[t]!==void 0?{explicit:!0,value:this.explicit[t]}:this.implicit[t]!==void 0?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,{value:n,explicit:r}){n!==void 0&&this.set(t,n,r)}set(t,n,r){return delete this[r?"implicit":"explicit"][t],this[r?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,{explicit:n,implicit:r}){n[t]!==void 0?this.set(t,n[t],!0):r[t]!==void 0&&this.set(t,r[t],!1)}copyKeyFromObject(t,n){n[t]!==void 0&&this.set(t,n[t],!0)}copyAll(t){for(const n of U(t.combine())){const r=t.getWithExplicit(n);this.setWithExplicit(n,r)}}}function ga(e){return{explicit:!0,value:e}}function Fr(e){return{explicit:!1,value:e}}function Dz(e){return(t,n,r,i)=>{const o=e(t.value,n.value);return o>0?t:o<0?n:dv(t,n,r,i)}}function dv(e,t,n,r){return e.explicit&&t.explicit&&q(rEe(n,r,e.value,t.value)),e}function ps(e,t,n,r,i=dv){return e===void 0||e.value===void 0?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:co(e.value,t.value)?e:i(e,t,n,r)}class CSe extends ha{constructor(t={},n={},r=!1){super(t,n);this.explicit=t,this.implicit=n,this.parseNothing=r}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function qc(e){return"url"in e}function A0(e){return"values"in e}function Nz(e){return"name"in e&&!qc(e)&&!A0(e)&&!ms(e)}function ms(e){return e&&(Tz(e)||Rz(e)||FO(e))}function Tz(e){return"sequence"in e}function Rz(e){return"sphere"in e}function FO(e){return"graticule"in e}var et;(function(e){e[e.Raw=0]="Raw",e[e.Main=1]="Main",e[e.Row=2]="Row",e[e.Column=3]="Column",e[e.Lookup=4]="Lookup"})(et||(et={}));const OSe="view",hv="[",gv="]",Pz="{",Lz="}",FSe=":",jz=",",kSe="@",MSe=">",DSe=/[[\]{}]/,NSe={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let Iz,Bz;function Hc(e,t,n){return Iz=t||OSe,Bz=n||NSe,zz(e.trim()).map(kO)}function TSe(e){return Bz[e]}function S0(e,t,n,r,i){const o=e.length;let a=0,s;for(;t<o;++t){if(s=e[t],!a&&s===n)return t;i&&i.indexOf(s)>=0?--a:r&&r.indexOf(s)>=0&&++a}return t}function zz(e){const t=[],n=e.length;let r=0,i=0;for(;i<n;)i=S0(e,i,jz,hv+Pz,gv+Lz),t.push(e.substring(r,i).trim()),r=++i;if(t.length===0)throw"Empty event selector: "+e;return t}function kO(e){return e[0]==="["?RSe(e):PSe(e)}function RSe(e){const t=e.length;let n=1,r;if(n=S0(e,n,gv,hv,gv),n===t)throw"Empty between selector: "+e;if(r=zz(e.substring(1,n)),r.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==MSe)throw"Expected '>' after between selector: "+e;r=r.map(kO);const i=kO(e.slice(1).trim());return i.between?{between:r,stream:i}:(i.between=r,i)}function PSe(e){const t={source:Iz},n=[];let r=[0,0],i=0,o=0,a=e.length,s=0,u,l;if(e[a-1]===Lz){if(s=e.lastIndexOf(Pz),s>=0){try{r=LSe(e.substring(s+1,a-1))}catch(c){throw"Invalid throttle specification: "+e}e=e.slice(0,s).trim(),a=e.length}else throw"Unmatched right brace: "+e;s=0}if(!a)throw e;if(e[0]===kSe&&(i=++s),u=S0(e,s,FSe),u<a&&(n.push(e.substring(o,u).trim()),o=s=++u),s=S0(e,s,hv),s===a)n.push(e.substring(o,a).trim());else if(n.push(e.substring(o,s).trim()),l=[],o=++s,o===a)throw"Unmatched left bracket: "+e;for(;s<a;){if(s=S0(e,s,gv),s===a)throw"Unmatched left bracket: "+e;if(l.push(e.substring(o,s).trim()),s<a-1&&e[++s]!==hv)throw"Expected left bracket: "+e;o=++s}if(!(a=n.length)||DSe.test(n[a-1]))throw"Invalid event selector: "+e;return a>1?(t.type=n[1],i?t.markname=n[0].slice(1):TSe(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),l!=null&&(t.filter=l),r[0]&&(t.throttle=r[0]),r[1]&&(t.debounce=r[1]),t}function LSe(e){const t=e.split(jz);if(!e.length||t.length>2)throw e;return t.map(n=>{const r=+n;if(r!==r)throw e;return r})}var jSe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function Wc(e,t=!0,n=Swe){if(Z(e)){const r=e.map(i=>Wc(i,t,n));return t?`[${r.join(", ")}]`:r}else if(Lu(e))return n(t?m0(e):OEe(e));return t?n(Je(e)):e}function ISe(e,t){var n;for(const r of pn((n=e.component.selection)!==null&&n!==void 0?n:{})){const i=r.name;let o=`${i}${bs}, ${r.resolve==="global"?"true":`{unit: ${Vc(e)}}`}`;for(const a of bv)!a.defined(r)||(a.signals&&(t=a.signals(e,r,t)),a.modifyExpr&&(o=a.modifyExpr(e,r,o)));t.push({name:i+vCe,on:[{events:{signal:r.name+bs},update:`modify(${De(r.name+qu)}, ${o})`}]})}return MO(t)}function BSe(e,t){if(e.component.selection&&U(e.component.selection).length){const n=De(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:Hc("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return MO(t)}function zSe(e,t){var n;let r=!1;for(const i of pn((n=e.component.selection)!==null&&n!==void 0?n:{})){const o=i.name,a=De(o+qu);if(t.filter(u=>u.name===o).length===0){const u=i.resolve==="global"?"union":i.resolve,l=i.type==="point"?", true, true)":")";t.push({name:i.name,update:`${cU}(${a}, ${De(u)}${l}`})}r=!0;for(const u of bv)u.defined(i)&&u.topLevelSignals&&(t=u.topLevelSignals(e,i,t))}return r&&t.filter(o=>o.name==="unit").length===0&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]}),MO(t)}function USe(e,t){var n;const r=[...t];for(const i of pn((n=e.component.selection)!==null&&n!==void 0?n:{})){const o={name:i.name+qu};if(i.init){const s=i.project.items.map(u=>jSe(u,["signals"]));o.values=i.init.map(u=>({unit:Vc(e,{escape:!1}),fields:s,values:Wc(u,!1)}))}r.filter(s=>s.name===i.name+qu).length||r.push(o)}return r}function Uz(e,t){var n;for(const r of pn((n=e.component.selection)!==null&&n!==void 0?n:{}))for(const i of bv)i.defined(r)&&i.marks&&(t=i.marks(e,r,t));return t}function qSe(e,t){for(const n of e.children)At(n)&&(t=Uz(n,t));return t}function HSe(e,t,n,r){const i=OU(e,t.param,t);return{signal:Or(n.get("type"))&&Z(r)&&r[0]>r[1]?`isValid(${i}) && reverse(${i})`:i}}function MO(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}class Ye{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){if(this._children.includes(t)){q(D_e);return}n!==void 0?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const r of this._children)r.parent=t;this._children=[],t.removeChild(this),t.parent.removeChild(t),this.parent=n,t.parent=this}}class In extends Ye{constructor(t,n,r,i){super(t,n);this.type=r,this.refCounts=i,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const t=new this.constructor;return t.debugName=`clone_${this.debugName}`,t._source=this._source,t._name=`clone_${this._name}`,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${aI()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}var qz=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};class Co extends Ye{constructor(t,n){super(t);this.formula=n}clone(){return new Co(null,ge(this.formula))}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,o)=>{const{field:a,timeUnit:s}=o;if(s){const u=G(o,{forAs:!0});i[Ce({as:u,field:a,timeUnit:s})]={as:u,field:a,timeUnit:s}}return i},{});return Ge(r)?null:new Co(t,r)}static makeFromTransform(t,n){const r=Object.assign({},n),{timeUnit:i}=r,o=qz(r,["timeUnit"]),a=Ln(i),s=Object.assign(Object.assign({},o),{timeUnit:a});return new Co(t,{[Ce(s)]:s})}merge(t){this.formula=Object.assign({},this.formula);for(const n in t.formula)this.formula[n]||(this.formula[n]=t.formula[n]);for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}removeFormulas(t){const n={};for(const[r,i]of es(this.formula))t.has(i.as)||(n[r]=i);this.formula=n}producedFields(){return new Set(pn(this.formula).map(t=>t.as))}dependentFields(){return new Set(pn(this.formula).map(t=>t.field))}hash(){return`TimeUnit ${Ce(this.formula)}`}assemble(){const t=[];for(const n of pn(this.formula)){const{field:r,as:i,timeUnit:o}=n,a=Ln(o),{unit:s,utc:u}=a,l=qz(a,["unit","utc"]);t.push(Object.assign(Object.assign(Object.assign(Object.assign({field:Wr(r),type:"timeunit"},s?{units:NC(s)}:{}),u?{timezone:"utc"}:{}),l),{as:[i,`${i}_end`]}))}return t}}var WSe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const C0="_tuple_fields";class GSe{constructor(...t){this.items=t,this.hasChannel={},this.hasField={}}}const YSe={defined:()=>!0,parse:(e,t,n)=>{var r;const i=t.name,o=(r=t.project)!==null&&r!==void 0?r:t.project=new GSe,a={},s={},u=new Set,l=(p,m)=>{const y=m==="visual"?p.channel:p.field;let v=it(`${i}_${y}`);for(let b=1;u.has(v);b++)v=it(`${i}_${y}_${b}`);return u.add(v),{[m]:v}},c=t.type,f=e.config.selection[c],d=n.value!==void 0?gt(n.value):null;let{fields:h,encodings:g}=Xe(n.select)?n.select:{};if(!h&&!g&&d){for(const p of d)if(!!Xe(p))for(const m of U(p))Vwe(m)?(g||(g=[])).push(m):c==="interval"?(q(O_e),g=f.encodings):(h||(h=[])).push(m)}!h&&!g&&(g=f.encodings,"fields"in f&&(h=f.fields));for(const p of g!=null?g:[]){const m=e.fieldDef(p);if(m){let y=m.field;if(m.aggregate){q(x_e(p,m.aggregate));continue}else if(!y){q(TI(p));continue}if(m.timeUnit){y=e.vgField(p);const v={timeUnit:m.timeUnit,as:y,field:m.field};s[Ce(v)]=v}if(!a[y]){let v="E";if(c==="interval"){const x=e.getScaleComponent(p).get("type");Or(x)&&(v="R")}else m.bin&&(v="R-RE");const b={field:y,channel:p,type:v};b.signals=Object.assign(Object.assign({},l(b,"data")),l(b,"visual")),o.items.push(a[y]=b),o.hasField[y]=o.hasChannel[p]=a[y]}}else q(TI(p))}for(const p of h!=null?h:[]){if(o.hasField[p])continue;const m={type:"E",field:p};m.signals=Object.assign({},l(m,"data")),o.items.push(m),o.hasField[p]=m}d&&(t.init=d.map(p=>o.items.map(m=>Xe(p)?p[m.channel]!==void 0?p[m.channel]:p[m.field]:p))),Ge(s)||(o.timeUnit=new Co(null,s))},signals:(e,t,n)=>{const r=t.name+C0;return n.filter(o=>o.name===r).length>0?n:n.concat({name:r,value:t.project.items.map(o=>{const a=WSe(o,["signals","hasLegend"]);return a.field=Wr(a.field),a})})}},ys={defined:e=>e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales",parse:(e,t)=>{const n=t.scales=[];for(const r of t.project.items){const i=r.channel;if(!ss(i))continue;const o=e.getScaleComponent(i),a=o?o.get("type"):void 0;if(!o||!Or(a)){q(E_e);continue}o.set("selectionExtent",{param:t.name,field:r.field},!0),n.push(r)}},topLevelSignals:(e,t,n)=>{const r=t.scales.filter(a=>n.filter(s=>s.name===a.signals.data).length===0);if(!e.parent||NO(e)||r.length===0)return n;const i=n.filter(a=>a.name===t.name)[0];let o=i.update;if(o.indexOf(cU)>=0)i.update=`{${r.map(a=>`${De(Wr(a.field))}: ${a.signals.data}`).join(", ")}}`;else{for(const a of r){const s=`${De(Wr(a.field))}: ${a.signals.data}`;o.includes(s)||(o=`${o.substring(0,o.length-1)}, ${s}}`)}i.update=o}return n.concat(r.map(a=>({name:a.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!NO(e))for(const r of t.scales){const i=n.filter(o=>o.name===r.signals.data)[0];i.push="outer",delete i.value,delete i.update}return n}};function DO(e,t){return`domain(${De(e.scaleName(t))})`}function NO(e){var t;return e.parent&&tf(e.parent)&&((t=!e.parent.parent)!==null&&t!==void 0?t:NO(e.parent.parent))}var VSe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const Gc="_brush",TO="_scale_trigger",XSe={defined:e=>e.type==="interval",signals:(e,t,n)=>{const r=t.name,i=r+C0,o=ys.defined(t),a=t.init?t.init[0]:null,s=[],u=[];if(t.translate&&!o){const c=`!event.item || event.item.mark.name !== ${De(r+Gc)}`;Hz(t,(f,d)=>{var h,g;const p=gt((h=(g=d.between[0]).filter)!==null&&h!==void 0?h:g.filter=[]);return p.includes(c)||p.push(c),f})}t.project.items.forEach((c,f)=>{const d=c.channel;if(d!==ut&&d!==Mt){q("Interval selections only support x and y encoding channels.");return}const h=a?a[f]:null,g=KSe(e,t,c,h),p=c.signals.data,m=c.signals.visual,y=De(e.scaleName(d)),v=e.getScaleComponent(d).get("type"),b=Or(v)?"+":"";n.push(...g),s.push(p),u.push({scaleName:e.scaleName(d),expr:`(!isArray(${p}) || (${b}invert(${y}, ${m})[0] === ${b}${p}[0] && ${b}invert(${y}, ${m})[1] === ${b}${p}[1]))`})}),!o&&u.length&&n.push({name:r+TO,value:{},on:[{events:u.map(c=>({scale:c.scaleName})),update:`${u.map(c=>c.expr).join(" && ")} ? ${r+TO} : {}`}]});const l=`unit: ${Vc(e)}, fields: ${i}, values`;return n.concat(Object.assign(Object.assign({name:r+bs},a?{init:`{${l}: ${Wc(a)}}`}:{}),s.length?{on:[{events:[{signal:s.join(" || ")}],update:`${s.join(" && ")} ? {${l}: [${s}]} : null`}]}:{}))},marks:(e,t,n)=>{const r=t.name,{x:i,y:o}=t.project.hasChannel,a=i&&i.signals.visual,s=o&&o.signals.visual,u=`data(${De(t.name+qu)})`;if(ys.defined(t)||!i&&!o)return n;const l={x:i!==void 0?{signal:`${a}[0]`}:{value:0},y:o!==void 0?{signal:`${s}[0]`}:{value:0},x2:i!==void 0?{signal:`${a}[1]`}:{field:{group:"width"}},y2:o!==void 0?{signal:`${s}[1]`}:{field:{group:"height"}}};if(t.resolve==="global")for(const m of U(l))l[m]=[Object.assign({test:`${u}.length && ${u}[0].unit === ${Vc(e)}`},l[m]),{value:0}];const c=t.mark,{fill:f,fillOpacity:d,cursor:h}=c,g=VSe(c,["fill","fillOpacity","cursor"]),p=U(g).reduce((m,y)=>(m[y]=[{test:[i!==void 0&&`${a}[0] !== ${a}[1]`,o!==void 0&&`${s}[0] !== ${s}[1]`].filter(v=>v).join(" && "),value:g[y]},{value:null}],m),{});return[{name:`${r+Gc}_bg`,type:"rect",clip:!0,encode:{enter:{fill:{value:f},fillOpacity:{value:d}},update:l}},...n,{name:r+Gc,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},h?{cursor:{value:h}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},l),p)}}]}};function KSe(e,t,n,r){const i=n.channel,o=n.signals.visual,a=n.signals.data,s=ys.defined(t),u=De(e.scaleName(i)),l=e.getScaleComponent(i),c=l?l.get("type"):void 0,f=p=>`scale(${u}, ${p})`,d=e.getSizeSignalRef(i===ut?"width":"height").signal,h=`${i}(unit)`,g=Hz(t,(p,m)=>[...p,{events:m.between[0],update:`[${h}, ${h}]`},{events:m,update:`[${o}[0], clamp(${h}, 0, ${d})]`}]);return g.push({events:{signal:t.name+TO},update:Or(c)?`[${f(`${a}[0]`)}, ${f(`${a}[1]`)}]`:"[0, 0]"}),s?[{name:a,on:[]}]:[Object.assign(Object.assign({name:o},r?{init:Wc(r,!0,f)}:{value:[]}),{on:g}),Object.assign(Object.assign({name:a},r?{init:Wc(r)}:{}),{on:[{events:{signal:o},update:`${o}[0] === ${o}[1] ? null : invert(${u}, ${o})`}]})]}function Hz(e,t){return e.events.reduce((n,r)=>r.between?t(n,r):(q(`${r} is not an ordered event stream for interval selections.`),n),[])}const ZSe={defined:e=>e.type==="point",signals:(e,t,n)=>{var r;const i=t.name,o=i+C0,a=t.project,s="(item().isVoronoi ? datum.datum : datum)",u=a.items.map(h=>{const g=e.fieldDef(h.channel);return(g==null?void 0:g.bin)?`[${s}[${De(e.vgField(h.channel,{}))}], ${s}[${De(e.vgField(h.channel,{binSuffix:"end"}))}]]`:`${s}[${De(h.field)}]`}).join(", "),l=`unit: ${Vc(e)}, fields: ${o}, values`,c=t.events,f=pn((r=e.component.selection)!==null&&r!==void 0?r:{}).reduce((h,g)=>g.type==="interval"?h.concat(g.name+Gc):h,[]).map(h=>`indexof(item().mark.name, '${h}') < 0`).join(" && "),d="datum && item().mark.marktype !== 'group'"+(f?` && ${f}`:"");return n.concat([{name:i+bs,on:c?[{events:c,update:`${d} ? {${l}: [${u}]} : null`,force:!0}]:[]}])}};function Yc(e,t,n,r){const i=Ky(t)&&t.condition,o=r(t);if(i){const s=gt(i).map(u=>{const l=r(u);if(k$e(u)){const{param:c,empty:f}=u,d=CU(e,{param:c,empty:f});return Object.assign({test:d},l)}else{const c=Sv(e,u.test);return Object.assign({test:c},l)}});return{[n]:[...s,...o!==void 0?[o]:[]]}}else return o!==void 0?{[n]:o}:{}}function RO(e,t="text"){const n=e.encoding[t];return Yc(e,n,t,r=>pv(r,e.config))}function pv(e,t,n="datum"){if(e){if(Si(e))return ot(e.value);if(fe(e)){const{format:r,formatType:i}=ev(e);return ZC({fieldOrDatumDef:e,format:r,formatType:i,expr:n,config:t})}}}function Wz(e,t={}){const{encoding:n,markDef:r,config:i,stack:o}=e,a=n.tooltip;if(Z(a))return{tooltip:Yz({tooltip:a},o,i,t)};{const s=t.reactiveGeom?"datum.datum":"datum";return Yc(e,a,"tooltip",u=>{const l=pv(u,i,s);if(l)return l;if(u===null)return;let c=ze("tooltip",r,i);if(c===!0&&(c={content:"encoding"}),he(c))return{value:c};if(Xe(c))return ie(c)?c:c.content==="encoding"?Yz(n,o,i,t):{signal:s}})}}function Gz(e,t,n,{reactiveGeom:r}={}){const i={},o=r?"datum.datum":"datum",a=[];function s(l,c){const f=Tu(c),d=Xr(l)?l:Object.assign(Object.assign({},l),{type:e[f].type}),h=d.title||aO(d,n),g=gt(h).join(", ");let p;if(xo(c)){const m=c==="x"?"x2":"y2",y=Ao(e[m]);if(Pn(d.bin)&&y){const v=G(d,{expr:o}),b=G(y,{expr:o}),{format:x,formatType:w}=ev(d);p=Yy(v,b,x,w,n),i[m]=!0}else if(t&&t.fieldChannel===c&&t.offset==="normalize"){const{format:v,formatType:b}=ev(d);p=ZC({fieldOrDatumDef:d,format:v,formatType:b,expr:o,config:n,normalizeStack:!0}).signal}}p!=null||(p=pv(d,n,o).signal),a.push({channel:c,key:g,value:p})}lO(e,(l,c)=>{Y(l)?s(l,c):Zy(l)&&s(l.condition,c)});const u={};for(const{channel:l,key:c,value:f}of a)!i[l]&&!u[c]&&(u[c]=f);return u}function Yz(e,t,n,{reactiveGeom:r}={}){const i=Gz(e,t,n,{reactiveGeom:r}),o=es(i).map(([a,s])=>`"${a}": ${s}`);return o.length>0?{signal:`{${o.join(", ")}}`}:void 0}function JSe(e){const{markDef:t,config:n}=e,r=ze("aria",t,n);return r===!1?{}:Object.assign(Object.assign(Object.assign({},r?{aria:r}:{}),QSe(e)),eCe(e))}function QSe(e){const{mark:t,markDef:n,config:r}=e;if(r.aria===!1)return{};const i=ze("ariaRoleDescription",n,r);return i!=null?{ariaRoleDescription:{value:i}}:t in y_e?{}:{ariaRoleDescription:{value:t}}}function eCe(e){const{encoding:t,markDef:n,config:r,stack:i}=e,o=t.description;if(o)return Yc(e,o,"description",u=>pv(u,e.config));const a=ze("description",n,r);if(a!=null)return{description:ot(a)};if(r.aria===!1)return{};const s=Gz(t,i,r);if(!Ge(s))return{description:{signal:es(s).map(([u,l],c)=>`"${c>0?"; ":""}${u}: " + (${l})`).join(" + ")}}}function qt(e,t,n={}){const{markDef:r,encoding:i,config:o}=t,{vgChannel:a}=n;let{defaultRef:s,defaultValue:u}=n;s===void 0&&(u!=null||(u=ze(e,r,o,{vgChannel:a,ignoreVgConfig:!0})),u!==void 0&&(s=ot(u)));const l=i[e];return Yc(t,l,a!=null?a:e,c=>hB({channel:e,channelDef:c,markDef:r,config:o,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:s}))}function Vz(e,t={filled:void 0}){var n,r,i,o;const{markDef:a,encoding:s,config:u}=e,{type:l}=a,c=(n=t.filled)!==null&&n!==void 0?n:ze("filled",a,u),f=ve(["bar","point","circle","square","geoshape"],l)?"transparent":void 0,d=(i=(r=ze(c===!0?"color":void 0,a,u,{vgChannel:"fill"}))!==null&&r!==void 0?r:u.mark[c===!0&&"color"])!==null&&i!==void 0?i:f,h=(o=ze(c===!1?"color":void 0,a,u,{vgChannel:"stroke"}))!==null&&o!==void 0?o:u.mark[c===!1&&"color"],g=c?"fill":"stroke",p=Object.assign(Object.assign({},d?{fill:ot(d)}:{}),h?{stroke:ot(h)}:{});return a.color&&(c?a.fill:a.stroke)&&q(BI("property",{fill:"fill"in a,stroke:"stroke"in a})),Object.assign(Object.assign(Object.assign(Object.assign({},p),qt("color",e,{vgChannel:g,defaultValue:c?d:h})),qt("fill",e,{defaultValue:s.fill?d:void 0})),qt("stroke",e,{defaultValue:s.stroke?h:void 0}))}function tCe(e){const{encoding:t,mark:n}=e,r=t.order;return!fs(n)&&Si(r)?Yc(e,r,"zindex",i=>ot(i.value)):{}}function O0(e,t){const n=Kwe(e),r=t[n];if(r)return r}function yn(e,t,{defaultPos:n,vgChannel:r}){const{encoding:i,markDef:o,config:a,stack:s}=t,u=i[e],l=i[sa(e)],c=t.scaleName(e),f=t.getScaleComponent(e),d=O0(e,o),h=PO({model:t,defaultPos:n,channel:e,scaleName:c,scale:f}),g=!u&&xo(e)&&(i.latitude||i.longitude)?{field:t.getName(e)}:nCe({channel:e,channelDef:u,channel2Def:l,markDef:o,config:a,scaleName:c,scale:f,stack:s,offset:d,defaultRef:h});return g?{[r||e]:g}:void 0}function nCe(e){const{channel:t,channelDef:n,scaleName:r,stack:i,offset:o,markDef:a}=e;if(fe(n)&&i&&t===i.fieldChannel){if(Y(n)){let s=n.bandPosition;if(s===void 0&&a.type==="text"&&(t==="radius"||t==="theta")&&(s=.5),s!==void 0)return Gy({scaleName:r,fieldOrDatumDef:n,startSuffix:"start",bandPosition:s,offset:o})}return Iu(n,r,{suffix:"end"},{offset:o})}return XC(e)}function PO({model:e,defaultPos:t,channel:n,scaleName:r,scale:i}){const{markDef:o,config:a}=e;return()=>{const s=Tu(n),u=os(n),l=ze(n,o,a,{vgChannel:u});if(l!==void 0)return b0(n,l);switch(t){case"zeroOrMin":case"zeroOrMax":if(r){const c=i.get("type");if(!ve([Dt.LOG,Dt.TIME,Dt.UTC],c)){if(i.domainDefinitelyIncludesZero())return{scale:r,value:0}}}if(t==="zeroOrMin")return s==="y"?{field:{group:"height"}}:{value:0};switch(s){case"radius":return{signal:`min(${e.width.signal},${e.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":{const c=e[Vr(n)];return Object.assign(Object.assign({},c),{mult:.5})}}}}const rCe={left:"x",center:"xc",right:"x2"},iCe={top:"y",middle:"yc",bottom:"y2"};function Xz(e,t,n,r="middle"){if(e==="radius"||e==="theta")return os(e);const i=e==="x"?"align":"baseline",o=ze(i,t,n);let a;return ie(o)?(q(G_e(i)),a=void 0):a=o,e==="x"?rCe[a||(r==="top"?"left":"center")]:iCe[a||r]}function mv(e,t,{defaultPos:n,defaultPos2:r,range:i}){return i?Kz(e,t,{defaultPos:n,defaultPos2:r}):yn(e,t,{defaultPos:n})}function Kz(e,t,{defaultPos:n,defaultPos2:r}){const{markDef:i,config:o}=t,a=sa(e),s=Vr(e),u=oCe(t,r,a),l=u[s]?Xz(e,i,o):os(e);return Object.assign(Object.assign({},yn(e,t,{defaultPos:n,vgChannel:l})),u)}function oCe(e,t,n){const{encoding:r,mark:i,markDef:o,stack:a,config:s}=e,u=Tu(n),l=Vr(n),c=os(n),f=r[u],d=e.scaleName(u),h=e.getScaleComponent(u),g=n in r||n in o?O0(n,e.markDef):O0(u,e.markDef);if(!f&&(n==="x2"||n==="y2")&&(r.latitude||r.longitude)){const m=Vr(n),y=e.markDef[m];return y!=null?{[m]:{value:y}}:{[c]:{field:e.getName(n)}}}const p=aCe({channel:n,channelDef:f,channel2Def:r[n],markDef:o,config:s,scaleName:d,scale:h,stack:a,offset:g,defaultRef:void 0});return p!==void 0?{[c]:p}:yv(n,o)||yv(n,{[n]:jy(n,o,s.style),[l]:jy(l,o,s.style)})||yv(n,s[i])||yv(n,s.mark)||{[c]:PO({model:e,defaultPos:t,channel:n,scaleName:d,scale:h})()}}function aCe({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:o,scale:a,stack:s,offset:u,defaultRef:l}){return fe(t)&&s&&e.charAt(0)===s.fieldChannel.charAt(0)?Iu(t,o,{suffix:"start"},{offset:u}):XC({channel:e,channelDef:n,scaleName:o,scale:a,stack:s,markDef:r,config:i,offset:u,defaultRef:l})}function yv(e,t){const n=Vr(e),r=os(e);if(t[r]!==void 0)return{[r]:b0(e,t[r])};if(t[e]!==void 0)return{[r]:b0(e,t[e])};if(t[n]){const i=t[n];if(jc(i))q(B_e(n));else return{[n]:b0(e,i)}}}function vs(e,t,n){var r,i,o,a;const{config:s,encoding:u,markDef:l}=e,c=sa(t),f=Vr(t),d=u[t],h=u[c],g=e.getScaleComponent(t),p=g?g.get("type"):void 0,m=e.scaleName(t),y=l.orient,v=(i=(r=u[f])!==null&&r!==void 0?r:u.size)!==null&&i!==void 0?i:ze("size",l,s,{vgChannel:f}),b=n==="bar"&&(t==="x"?y==="vertical":y==="horizontal");if(Y(d)&&(Qe(d.bin)||Pn(d.bin)||d.timeUnit&&!h)&&!(v&&!jc(v))&&!mn(p)){const x=SB({channel:t,fieldDef:d,markDef:l,config:s,scaleType:p}),w=(o=e.component.axes[t])===null||o===void 0?void 0:o[0],E=(a=w==null?void 0:w.get("translate"))!==null&&a!==void 0?a:.5;return lCe({fieldDef:d,fieldDef2:h,channel:t,markDef:l,scaleName:m,bandSize:x,axisTranslate:E,spacing:xo(t)?ze("binSpacing",l,s):void 0,reverse:g.get("reverse"),config:s})}else return(fe(d)&&mn(p)||b)&&!h?uCe(d,t,e):Kz(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function sCe(e,t,n,r,i){if(jc(i))if(n){const a=n.get("type");if(a==="band")return{scale:t,band:i.band};i.band!==1&&(q(K_e(a)),i=void 0)}else return{mult:i.band,field:{group:e}};else{if(ie(i))return i;if(i)return{value:i}}if(n){const a=n.get("range");if(cs(a)&&Et(a.step))return{value:a.step-2}}return{value:cv(r.view,e)-2}}function uCe(e,t,n){const{markDef:r,encoding:i,config:o,stack:a}=n,s=r.orient,u=n.scaleName(t),l=n.getScaleComponent(t),c=Vr(t),f=sa(t),d=s==="horizontal"&&t==="y"||s==="vertical"&&t==="x";let h;(i.size||r.size)&&(d?h=qt("size",n,{vgChannel:c,defaultRef:ot(r.size)}):q(eEe(r.type)));const g=SB({channel:t,fieldDef:e,markDef:r,config:o,scaleType:l==null?void 0:l.get("type"),useVlSizeChannel:d});h=h||{[c]:sCe(c,u,l,o,g)};const p=(l==null?void 0:l.get("type"))!=="band"||!("band"in h[c])?"middle":"top",m=Xz(t,r,o,p),y=m==="xc"||m==="yc",v=O0(t,r),b=XC({channel:t,channelDef:e,markDef:r,config:o,scaleName:u,scale:l,stack:a,offset:v,defaultRef:PO({model:n,defaultPos:"mid",channel:t,scaleName:u,scale:l}),bandPosition:y?.5:ie(g)?{signal:`(1-${g})/2`}:jc(g)?(1-g.band)/2:0});if(c)return Object.assign({[m]:b},h);{const x=os(f),w=h[c],E=v?Object.assign(Object.assign({},w),{offset:v}):w;return{[m]:b,[x]:Z(b)?[b[0],Object.assign(Object.assign({},b[1]),{offset:E})]:Object.assign(Object.assign({},b),{offset:E})}}}function F0(e,t,n,r,i){if(cI(e))return 0;const o=e==="x"||e==="y2"?-t/2:t/2;if(ie(n)||ie(i)||ie(r)){const a=ca(n),s=ca(i),u=ca(r),l=u?`${u} + `:"",c=a?`(${a} ? -1 : 1) * `:"",f=s?`(${s} + ${o})`:o;return{signal:l+c+f}}else return i=i||0,r+(n?-i-o:+i+o)}function lCe({fieldDef:e,fieldDef2:t,channel:n,bandSize:r,scaleName:i,markDef:o,spacing:a=0,axisTranslate:s,reverse:u,config:l}){const c=sa(n),f=os(n),d=os(c),h=O0(n,o),g=ie(r)?{signal:`(1-${r.signal})/2`}:jc(r)?(1-r.band)/2:.5;if(Qe(e.bin)||e.timeUnit)return{[d]:Zz({channel:n,fieldDef:e,scaleName:i,markDef:o,bandPosition:g,offset:F0(c,a,u,s,h),config:l}),[f]:Zz({channel:n,fieldDef:e,scaleName:i,markDef:o,bandPosition:ie(g)?{signal:`1-${g.signal}`}:1-g,offset:F0(n,a,u,s,h),config:l})};if(Pn(e.bin)){const p=Iu(e,i,{},{offset:F0(c,a,u,s,h)});if(Y(t))return{[d]:p,[f]:Iu(t,i,{},{offset:F0(n,a,u,s,h)})};if(Ru(e.bin)&&e.bin.step)return{[d]:p,[f]:{signal:`scale("${i}", ${G(e,{expr:"datum"})} + ${e.bin.step})`,offset:F0(n,a,u,s,h)}}}q(WI(c))}function Zz({channel:e,fieldDef:t,scaleName:n,markDef:r,bandPosition:i,offset:o,config:a}){const s=Gy({scaleName:n,fieldOrDatumDef:t,bandPosition:i,offset:o});return dB({fieldDef:t,channel:e,markDef:r,ref:s,config:a})}const cCe=new Set(["aria","width","height"]);function Kr(e,t){const{fill:n=void 0,stroke:r=void 0}=t.color==="include"?Vz(e):{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},fCe(e.markDef,t)),Jz(e,"fill",n)),Jz(e,"stroke",r)),qt("opacity",e)),qt("fillOpacity",e)),qt("strokeOpacity",e)),qt("strokeWidth",e)),qt("strokeDash",e)),tCe(e)),Wz(e)),RO(e,"href")),JSe(e))}function Jz(e,t,n){const{config:r,mark:i,markDef:o}=e;if(ze("invalid",o,r)==="hide"&&n&&!fs(i)){const s=dCe(e,{invalid:!0,channels:Py});if(s)return{[t]:[{test:s,value:null},...gt(n)]}}return n?{[t]:n}:{}}function fCe(e,t){return m_e.reduce((n,r)=>(!cCe.has(r)&&e[r]!==void 0&&t[r]!=="ignore"&&(n[r]=ot(e[r])),n),{})}function dCe(e,{invalid:t=!1,channels:n}){const r=n.reduce((o,a)=>{const s=e.getScaleComponent(a);if(s){const u=s.get("type"),l=e.vgField(a,{expr:"datum"});l&&Or(u)&&(o[l]=!0)}return o},{}),i=U(r);if(i.length>0){const o=t?"||":"&&";return i.map(a=>KC(a,t)).join(` ${o} `)}}function LO(e){const{config:t,markDef:n}=e;if(ze("invalid",n,t)){const i=hCe(e,{channels:bo});if(i)return{defined:{signal:i}}}return{}}function hCe(e,{invalid:t=!1,channels:n}){const r=n.reduce((o,a)=>{const s=e.getScaleComponent(a);if(s){const u=s.get("type"),l=e.vgField(a,{expr:"datum"});l&&Or(u)&&(o[l]=!0)}return o},{}),i=U(r);if(i.length>0){const o=t?"||":"&&";return i.map(a=>KC(a,t)).join(` ${o} `)}}function Qz(e,t){if(t!==void 0)return{[e]:ot(t)}}const jO="voronoi",eU={defined:e=>e.type==="point"&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(jO)},marks:(e,t,n)=>{const{x:r,y:i}=t.project.hasChannel,o=e.mark;if(fs(o))return q(w_e(o)),n;const a={name:e.getName(jO),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},Wz(e,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:r||!i?"datum.datum.x || 0":"0"},y:{expr:i||!r?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let s=0,u=!1;return n.forEach((l,c)=>{var f;const d=(f=l.name)!==null&&f!==void 0?f:"";d===e.component.mark[0].name?s=c:d.indexOf(jO)>=0&&(u=!0)}),u||n.splice(s+1,0,a),n}},tU={defined:e=>e.type==="point"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!mO(e.bind),parse:(e,t,n)=>fU(t,n),topLevelSignals:(e,t,n)=>{const r=t.name,i=t.project,o=t.bind,a=t.init&&t.init[0],s=eU.defined(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return i.items.forEach((u,l)=>{var c,f;const d=it(`${r}_${u.field}`);n.filter(g=>g.name===d).length||n.unshift(Object.assign(Object.assign({name:d},a?{init:Wc(a[l])}:{value:null}),{on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${s}[${De(u.field)}] : null`}]:[],bind:(f=(c=o[u.field])!==null&&c!==void 0?c:o[u.channel])!==null&&f!==void 0?f:o}))}),n},signals:(e,t,n)=>{const r=t.name,i=t.project,o=n.filter(l=>l.name===r+bs)[0],a=r+C0,s=i.items.map(l=>it(`${r}_${l.field}`)),u=s.map(l=>`${l} !== null`).join(" && ");return s.length&&(o.update=`${u} ? {fields: ${a}, values: [${s.join(", ")}]} : null`),delete o.value,delete o.on,n}},vv="_toggle",nU={defined:e=>e.type==="point"&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+vv,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+bs,r=t.name+vv;return`${r} ? null : ${n}, `+(t.resolve==="global"?`${r} ? null : true, `:`${r} ? null : {unit: ${Vc(e)}}, `)+`${r} ? ${n} : null`}},gCe={defined:e=>e.clear!==void 0&&e.clear!==!1,parse:(e,t)=>{t.clear&&(t.clear=he(t.clear)?Hc(t.clear,"view"):t.clear)},topLevelSignals:(e,t,n)=>{if(tU.defined(t))for(const r of t.project.items){const i=n.findIndex(o=>o.name===it(`${t.name}_${r.field}`));i!==-1&&n[i].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function r(i,o){i!==-1&&n[i].on&&n[i].on.push({events:t.clear,update:o})}if(t.type==="interval")for(const i of t.project.items){const o=n.findIndex(a=>a.name===i.signals.visual);if(r(o,"[0, 0]"),o===-1){const a=n.findIndex(s=>s.name===i.signals.data);r(a,"null")}}else{let i=n.findIndex(o=>o.name===t.name+bs);r(i,"null"),nU.defined(t)&&(i=n.findIndex(o=>o.name===t.name+vv),r(i,"false"))}return n}},rU={defined:e=>{const t=e.resolve==="global"&&e.bind&&mO(e.bind),n=e.project.items.length===1&&e.project.items[0].field!==E0;return t&&!n&&q($_e),t&&n},parse:(e,t,n)=>{var r;const i=ge(n);if(i.select=he(i.select)?{type:i.select,toggle:t.toggle}:Object.assign(Object.assign({},i.select),{toggle:t.toggle}),fU(t,i),le(n.select)&&(n.select.on||n.select.clear)){const s='event.item && indexof(event.item.mark.role, "legend") < 0';for(const u of t.events)u.filter=gt((r=u.filter)!==null&&r!==void 0?r:[]),u.filter.includes(s)||u.filter.push(s)}const o=yO(t.bind)?t.bind.legend:"click",a=he(o)?Hc(o,"view"):gt(o);t.bind={legend:{merge:a}}},topLevelSignals:(e,t,n)=>{const r=t.name,i=yO(t.bind)&&t.bind.legend,o=a=>s=>{const u=ge(s);return u.markname=a,u};for(const a of t.project.items){if(!a.hasLegend)continue;const s=`${it(a.field)}_legend`,u=`${r}_${s}`;if(n.filter(c=>c.name===u).length===0){const c=i.merge.map(o(`${s}_symbols`)).concat(i.merge.map(o(`${s}_labels`))).concat(i.merge.map(o(`${s}_entries`)));n.unshift(Object.assign(Object.assign({name:u},t.init?{}:{value:null}),{on:[{events:c,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:`!event.item || !datum ? null : ${u}`,force:!0}]}))}}return n},signals:(e,t,n)=>{const r=t.name,i=t.project,o=n.find(d=>d.name===r+bs),a=r+C0,s=i.items.filter(d=>d.hasLegend).map(d=>it(`${r}_${it(d.field)}_legend`)),l=`${s.map(d=>`${d} !== null`).join(" && ")} ? {fields: ${a}, values: [${s.join(", ")}]} : null`;t.events&&s.length>0?o.on.push({events:s.map(d=>({signal:d})),update:l}):s.length>0&&(o.update=l,delete o.value,delete o.on);const c=n.find(d=>d.name===r+vv),f=yO(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push(Object.assign(Object.assign({},c.on[0]),{events:f})):c.on[0].events=f),n}};function pCe(e,t,n){var r,i,o,a;const s=(r=e.fieldDef(t))===null||r===void 0?void 0:r.field;for(const u of pn((i=e.component.selection)!==null&&i!==void 0?i:{})){const l=(o=u.project.hasField[s])!==null&&o!==void 0?o:u.project.hasChannel[t];if(l&&rU.defined(u)){const c=(a=n.get("selections"))!==null&&a!==void 0?a:[];c.push(u.name),n.set("selections",c,!1),l.hasLegend=!0}}}const iU="_translate_anchor",oU="_translate_delta",mCe={defined:e=>e.type==="interval"&&e.translate,signals:(e,t,n)=>{const r=t.name,i=ys.defined(t),o=r+iU,{x:a,y:s}=t.project.hasChannel;let u=Hc(t.translate,"scope");return i||(u=u.map(l=>(l.between[0].markname=r+Gc,l))),n.push({name:o,value:{},on:[{events:u.map(l=>l.between[0]),update:"{x: x(unit), y: y(unit)"+(a!==void 0?`, extent_x: ${i?DO(e,ut):`slice(${a.signals.visual})`}`:"")+(s!==void 0?`, extent_y: ${i?DO(e,Mt):`slice(${s.signals.visual})`}`:"")+"}"}]},{name:r+oU,value:{},on:[{events:u,update:`{x: ${o}.x - x(unit), y: ${o}.y - y(unit)}`}]}),a!==void 0&&aU(e,t,a,"width",n),s!==void 0&&aU(e,t,s,"height",n),n}};function aU(e,t,n,r,i){var o,a;const s=t.name,u=s+iU,l=s+oU,c=n.channel,f=ys.defined(t),d=i.filter(_=>_.name===n.signals[f?"data":"visual"])[0],h=e.getSizeSignalRef(r).signal,g=e.getScaleComponent(c),p=g.get("type"),m=g.get("reverse"),y=f?c===ut?m?"":"-":m?"-":"":"",v=`${u}.extent_${c}`,b=`${y}${l}.${c} / ${f?`${h}`:`span(${v})`}`,x=f?p==="log"?"panLog":p==="symlog"?"panSymlog":p==="pow"?"panPow":"panLinear":"panLinear",w=f?p==="pow"?`, ${(o=g.get("exponent"))!==null&&o!==void 0?o:1}`:p==="symlog"?`, ${(a=g.get("constant"))!==null&&a!==void 0?a:1}`:"":"",E=`${x}(${v}, ${b}${w})`;d.on.push({events:{signal:l},update:f?E:`clampRange(${E}, 0, ${h})`})}const sU="_zoom_anchor",uU="_zoom_delta",yCe={defined:e=>e.type==="interval"&&e.zoom,signals:(e,t,n)=>{const r=t.name,i=ys.defined(t),o=r+uU,{x:a,y:s}=t.project.hasChannel,u=De(e.scaleName(ut)),l=De(e.scaleName(Mt));let c=Hc(t.zoom,"scope");return i||(c=c.map(f=>(f.markname=r+Gc,f))),n.push({name:r+sU,on:[{events:c,update:i?"{"+[u?`x: invert(${u}, x(unit))`:"",l?`y: invert(${l}, y(unit))`:""].filter(f=>!!f).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:o,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),a!==void 0&&lU(e,t,a,"width",n),s!==void 0&&lU(e,t,s,"height",n),n}};function lU(e,t,n,r,i){var o,a;const s=t.name,u=n.channel,l=ys.defined(t),c=i.filter(x=>x.name===n.signals[l?"data":"visual"])[0],f=e.getSizeSignalRef(r).signal,d=e.getScaleComponent(u),h=d.get("type"),g=l?DO(e,u):c.name,p=s+uU,m=`${s}${sU}.${u}`,y=l?h==="log"?"zoomLog":h==="symlog"?"zoomSymlog":h==="pow"?"zoomPow":"zoomLinear":"zoomLinear",v=l?h==="pow"?`, ${(o=d.get("exponent"))!==null&&o!==void 0?o:1}`:h==="symlog"?`, ${(a=d.get("constant"))!==null&&a!==void 0?a:1}`:"":"",b=`${y}(${g}, ${m}, ${p}${v})`;c.on.push({events:{signal:p},update:l?b:`clampRange(${b}, 0, ${f})`})}const qu="_store",bs="_tuple",vCe="_modify",cU="vlSelectionResolve",bv=[ZSe,XSe,YSe,nU,tU,ys,rU,gCe,mCe,yCe,eU];function bCe(e){let t=e.parent;for(;t&&!ki(t);)t=t.parent;return t}function Vc(e,{escape:t}={escape:!0}){let n=t?De(e.name):e.name;const r=bCe(e);if(r){const{facet:i}=r;for(const o of Yr)i[o]&&(n+=` + '__facet_${o}_' + (facet[${De(r.vgField(o))}])`)}return n}function IO(e){var t;return pn((t=e.component.selection)!==null&&t!==void 0?t:{}).reduce((n,r)=>n||r.project.items.some(i=>i.field===E0),!1)}function fU(e,t){(Me(t.select)||!t.select.on)&&delete e.events,(Me(t.select)||!t.select.clear)&&delete e.clear,(Me(t.select)||!t.select.toggle)&&delete e.toggle}const xCe="RawCode",wCe="Literal",_Ce="Property",ECe="Identifier",$Ce="ArrayExpression",ACe="BinaryExpression",SCe="CallExpression",CCe="ConditionalExpression",OCe="LogicalExpression",FCe="MemberExpression",kCe="ObjectExpression",MCe="UnaryExpression";function Ci(e){this.type=e}Ci.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=DCe(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function DCe(e){switch(e.type){case $Ce:return e.elements;case ACe:case OCe:return[e.left,e.right];case SCe:return[e.callee].concat(e.arguments);case CCe:return[e.test,e.consequent,e.alternate];case FCe:return[e.object,e.property];case kCe:return e.properties;case _Ce:return[e.key,e.value];case MCe:return[e.argument];case ECe:case wCe:case xCe:default:return[]}}var Oo,J,I,vn,He,xv=1,k0=2,Hu=3,xs=4,wv=5,Wu=6,or=7,M0=8,NCe=9;Oo={};Oo[xv]="Boolean";Oo[k0]="<end>";Oo[Hu]="Identifier";Oo[xs]="Keyword";Oo[wv]="Null";Oo[Wu]="Numeric";Oo[or]="Punctuator";Oo[M0]="String";Oo[NCe]="RegularExpression";var TCe="ArrayExpression",RCe="BinaryExpression",PCe="CallExpression",LCe="ConditionalExpression",dU="Identifier",jCe="Literal",ICe="LogicalExpression",BCe="MemberExpression",zCe="ObjectExpression",UCe="Property",qCe="UnaryExpression",Ht="Unexpected token %0",HCe="Unexpected number",WCe="Unexpected string",GCe="Unexpected identifier",YCe="Unexpected reserved word",VCe="Unexpected end of input",BO="Invalid regular expression",zO="Invalid regular expression: missing /",hU="Octal literals are not allowed in strict mode.",XCe="Duplicate data property in object literal not allowed in strict mode",Jt="ILLEGAL",D0="Disabled.",KCe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),ZCe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function _v(e,t){if(!e)throw new Error("ASSERT: "+t)}function pa(e){return e>=48&&e<=57}function UO(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function N0(e){return"01234567".indexOf(e)>=0}function JCe(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function T0(e){return e===10||e===13||e===8232||e===8233}function R0(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&KCe.test(String.fromCharCode(e))}function Ev(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&ZCe.test(String.fromCharCode(e))}const QCe={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function gU(){for(;I<vn;){const e=J.charCodeAt(I);if(JCe(e)||T0(e))++I;else break}}function qO(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)I<vn&&UO(J[I])?(r=J[I++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):je({},Ht,Jt);return String.fromCharCode(i)}function eOe(){var e,t,n,r;for(e=J[I],t=0,e==="}"&&je({},Ht,Jt);I<vn&&(e=J[I++],!!UO(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&je({},Ht,Jt),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function pU(){var e,t;for(e=J.charCodeAt(I++),t=String.fromCharCode(e),e===92&&(J.charCodeAt(I)!==117&&je({},Ht,Jt),++I,e=qO("u"),(!e||e==="\\"||!R0(e.charCodeAt(0)))&&je({},Ht,Jt),t=e);I<vn&&(e=J.charCodeAt(I),!!Ev(e));)++I,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),J.charCodeAt(I)!==117&&je({},Ht,Jt),++I,e=qO("u"),(!e||e==="\\"||!Ev(e.charCodeAt(0)))&&je({},Ht,Jt),t+=e);return t}function tOe(){var e,t;for(e=I++;I<vn;){if(t=J.charCodeAt(I),t===92)return I=e,pU();if(Ev(t))++I;else break}return J.slice(e,I)}function nOe(){var e,t,n;return e=I,t=J.charCodeAt(I)===92?pU():tOe(),t.length===1?n=Hu:QCe.hasOwnProperty(t)?n=xs:t==="null"?n=wv:t==="true"||t==="false"?n=xv:n=Hu,{type:n,value:t,start:e,end:I}}function HO(){var e=I,t=J.charCodeAt(I),n,r=J[I],i,o,a;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++I,{type:or,value:String.fromCharCode(t),start:e,end:I};default:if(n=J.charCodeAt(I+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return I+=2,{type:or,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:I};case 33:case 61:return I+=2,J.charCodeAt(I)===61&&++I,{type:or,value:J.slice(e,I),start:e,end:I}}}if(a=J.substr(I,4),a===">>>=")return I+=4,{type:or,value:a,start:e,end:I};if(o=a.substr(0,3),o===">>>"||o==="<<="||o===">>=")return I+=3,{type:or,value:o,start:e,end:I};if(i=o.substr(0,2),r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>")return I+=2,{type:or,value:i,start:e,end:I};if(i==="//"&&je({},Ht,Jt),"<>=!+-*%&|^/".indexOf(r)>=0)return++I,{type:or,value:r,start:e,end:I};je({},Ht,Jt)}function rOe(e){let t="";for(;I<vn&&UO(J[I]);)t+=J[I++];return t.length===0&&je({},Ht,Jt),R0(J.charCodeAt(I))&&je({},Ht,Jt),{type:Wu,value:parseInt("0x"+t,16),start:e,end:I}}function iOe(e){let t="0"+J[I++];for(;I<vn&&N0(J[I]);)t+=J[I++];return(R0(J.charCodeAt(I))||pa(J.charCodeAt(I)))&&je({},Ht,Jt),{type:Wu,value:parseInt(t,8),octal:!0,start:e,end:I}}function mU(){var e,t,n;if(n=J[I],_v(pa(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=I,e="",n!=="."){if(e=J[I++],n=J[I],e==="0"){if(n==="x"||n==="X")return++I,rOe(t);if(N0(n))return iOe(t);n&&pa(n.charCodeAt(0))&&je({},Ht,Jt)}for(;pa(J.charCodeAt(I));)e+=J[I++];n=J[I]}if(n==="."){for(e+=J[I++];pa(J.charCodeAt(I));)e+=J[I++];n=J[I]}if(n==="e"||n==="E")if(e+=J[I++],n=J[I],(n==="+"||n==="-")&&(e+=J[I++]),pa(J.charCodeAt(I)))for(;pa(J.charCodeAt(I));)e+=J[I++];else je({},Ht,Jt);return R0(J.charCodeAt(I))&&je({},Ht,Jt),{type:Wu,value:parseFloat(e),start:t,end:I}}function oOe(){var e="",t,n,r,i,o=!1;for(t=J[I],_v(t==="'"||t==='"',"String literal must starts with a quote"),n=I,++I;I<vn;)if(r=J[I++],r===t){t="";break}else if(r==="\\")if(r=J[I++],!r||!T0(r.charCodeAt(0)))switch(r){case"u":case"x":J[I]==="{"?(++I,e+=eOe()):e+=qO(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:N0(r)?(i="01234567".indexOf(r),i!==0&&(o=!0),I<vn&&N0(J[I])&&(o=!0,i=i*8+"01234567".indexOf(J[I++]),"0123".indexOf(r)>=0&&I<vn&&N0(J[I])&&(i=i*8+"01234567".indexOf(J[I++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&J[I]===`
`&&++I;else{if(T0(r.charCodeAt(0)))break;e+=r}return t!==""&&je({},Ht,Jt),{type:M0,value:e,octal:o,start:n,end:I}}function aOe(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(r,i)=>{if(parseInt(i,16)<=1114111)return"x";je({},BO)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){je({},BO)}try{return new RegExp(e,t)}catch(r){return null}}function sOe(){var e,t,n,r,i;for(e=J[I],_v(e==="/","Regular expression literal must start with a slash"),t=J[I++],n=!1,r=!1;I<vn;)if(e=J[I++],t+=e,e==="\\")e=J[I++],T0(e.charCodeAt(0))&&je({},zO),t+=e;else if(T0(e.charCodeAt(0)))je({},zO);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||je({},zO),i=t.substr(1,t.length-2),{value:i,literal:t}}function uOe(){var e,t,n;for(t="",n="";I<vn&&(e=J[I],!!Ev(e.charCodeAt(0)));)++I,e==="\\"&&I<vn?je({},Ht,Jt):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&je({},BO,n),{value:n,literal:t}}function lOe(){var e,t,n,r;return He=null,gU(),e=I,t=sOe(),n=uOe(),r=aOe(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:I}}function cOe(e){return e.type===Hu||e.type===xs||e.type===xv||e.type===wv}function yU(){if(gU(),I>=vn)return{type:k0,start:I,end:I};const e=J.charCodeAt(I);return R0(e)?nOe():e===40||e===41||e===59?HO():e===39||e===34?oOe():e===46?pa(J.charCodeAt(I+1))?mU():HO():pa(e)?mU():HO()}function ar(){const e=He;return I=e.end,He=yU(),I=e.end,e}function vU(){const e=I;He=yU(),I=e}function fOe(e){const t=new Ci(TCe);return t.elements=e,t}function bU(e,t,n){const r=new Ci(e==="||"||e==="&&"?ICe:RCe);return r.operator=e,r.left=t,r.right=n,r}function dOe(e,t){const n=new Ci(PCe);return n.callee=e,n.arguments=t,n}function hOe(e,t,n){const r=new Ci(LCe);return r.test=e,r.consequent=t,r.alternate=n,r}function WO(e){const t=new Ci(dU);return t.name=e,t}function P0(e){const t=new Ci(jCe);return t.value=e.value,t.raw=J.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function xU(e,t,n){const r=new Ci(BCe);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function gOe(e){const t=new Ci(zCe);return t.properties=e,t}function wU(e,t,n){const r=new Ci(UCe);return r.key=t,r.value=n,r.kind=e,r}function pOe(e,t){const n=new Ci(qCe);return n.operator=e,n.argument=t,n.prefix=!0,n}function je(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(o,a)=>(_v(a<r.length,"Message reference must be in range"),r[a]));throw n=new Error(i),n.index=I,n.description=i,n}function $v(e){e.type===k0&&je(e,VCe),e.type===Wu&&je(e,HCe),e.type===M0&&je(e,WCe),e.type===Hu&&je(e,GCe),e.type===xs&&je(e,YCe),je(e,Ht,e.value)}function bn(e){const t=ar();(t.type!==or||t.value!==e)&&$v(t)}function nt(e){return He.type===or&&He.value===e}function GO(e){return He.type===xs&&He.value===e}function mOe(){const e=[];for(I=He.start,bn("[");!nt("]");)nt(",")?(ar(),e.push(null)):(e.push(Gu()),nt("]")||bn(","));return ar(),fOe(e)}function _U(){I=He.start;const e=ar();return e.type===M0||e.type===Wu?(e.octal&&je(e,hU),P0(e)):WO(e.value)}function yOe(){var e,t,n,r;if(I=He.start,e=He,e.type===Hu)return n=_U(),bn(":"),r=Gu(),wU("init",n,r);if(e.type===k0||e.type===or)$v(e);else return t=_U(),bn(":"),r=Gu(),wU("init",t,r)}function vOe(){var e=[],t,n,r,i={},o=String;for(I=He.start,bn("{");!nt("}");)t=yOe(),t.key.type===dU?n=t.key.name:n=o(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?je({},XCe):i[r]=!0,e.push(t),nt("}")||bn(",");return bn("}"),gOe(e)}function bOe(){bn("(");const e=YO();return bn(")"),e}const xOe={if:1};function wOe(){var e,t,n;if(nt("("))return bOe();if(nt("["))return mOe();if(nt("{"))return vOe();if(e=He.type,I=He.start,e===Hu||xOe[He.value])n=WO(ar().value);else if(e===M0||e===Wu)He.octal&&je(He,hU),n=P0(ar());else{if(e===xs)throw new Error(D0);e===xv?(t=ar(),t.value=t.value==="true",n=P0(t)):e===wv?(t=ar(),t.value=null,n=P0(t)):nt("/")||nt("/=")?(n=P0(lOe()),vU()):$v(ar())}return n}function _Oe(){const e=[];if(bn("("),!nt(")"))for(;I<vn&&(e.push(Gu()),!nt(")"));)bn(",");return bn(")"),e}function EOe(){I=He.start;const e=ar();return cOe(e)||$v(e),WO(e.value)}function $Oe(){return bn("."),EOe()}function AOe(){bn("[");const e=YO();return bn("]"),e}function SOe(){var e,t,n;for(e=wOe();;)if(nt("."))n=$Oe(),e=xU(".",e,n);else if(nt("("))t=_Oe(),e=dOe(e,t);else if(nt("["))n=AOe(),e=xU("[",e,n);else break;return e}function EU(){const e=SOe();if(He.type===or&&(nt("++")||nt("--")))throw new Error(D0);return e}function Av(){var e,t;if(He.type!==or&&He.type!==xs)t=EU();else{if(nt("++")||nt("--"))throw new Error(D0);if(nt("+")||nt("-")||nt("~")||nt("!"))e=ar(),t=Av(),t=pOe(e.value,t);else{if(GO("delete")||GO("void")||GO("typeof"))throw new Error(D0);t=EU()}}return t}function $U(e){let t=0;if(e.type!==or&&e.type!==xs)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function COe(){var e,t,n,r,i,o,a,s,u,l;if(e=He,u=Av(),r=He,i=$U(r),i===0)return u;for(r.prec=i,ar(),t=[e,He],a=Av(),o=[u,r,a];(i=$U(He))>0;){for(;o.length>2&&i<=o[o.length-2].prec;)a=o.pop(),s=o.pop().value,u=o.pop(),t.pop(),n=bU(s,u,a),o.push(n);r=ar(),r.prec=i,o.push(r),t.push(He),n=Av(),o.push(n)}for(l=o.length-1,n=o[l],t.pop();l>1;)t.pop(),n=bU(o[l-1].value,o[l-2],n),l-=2;return n}function Gu(){var e,t,n;return e=COe(),nt("?")&&(ar(),t=Gu(),bn(":"),n=Gu(),e=hOe(e,t,n)),e}function YO(){const e=Gu();if(nt(","))throw new Error(D0);return e}function OOe(e){J=e,I=0,vn=J.length,He=null,vU();const t=YO();if(He.type!==k0)throw new Error("Unexpect token after expression.");return t}function VO(e){const t=[];return e.type==="Identifier"?[e.name]:e.type==="Literal"?[e.value]:(e.type==="MemberExpression"&&(t.push(...VO(e.object)),t.push(...VO(e.property))),t)}function AU(e){return e.object.type==="MemberExpression"?AU(e.object):e.object.name==="datum"}function SU(e){const t=OOe(e),n=new Set;return t.visit(r=>{r.type==="MemberExpression"&&AU(r)&&n.add(VO(r).slice(1).join("."))}),n}class Xc extends Ye{constructor(t,n,r){super(t);this.model=n,this.filter=r,this.expr=Sv(this.model,this.filter,this),this._dependentFields=SU(this.expr)}clone(){return new Xc(null,this.model,ge(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function FOe(e,t){var n;const r={},i=e.config.selection;if(!t||!t.length)return r;for(const o of t){const a=it(o.name),s=o.select,u=he(s)?s:s.type,l=Xe(s)?ge(s):{type:u},c=i[u];for(const d in c)d==="fields"||d==="encodings"||(d==="mark"&&(l[d]=Object.assign(Object.assign({},c[d]),l[d])),(l[d]===void 0||l[d]===!0)&&(l[d]=(n=c[d])!==null&&n!==void 0?n:l[d]));const f=r[a]=Object.assign(Object.assign({},l),{name:a,type:u,init:o.value,bind:o.bind,events:he(l.on)?Hc(l.on,"scope"):gt(ge(l.on))});for(const d of bv)d.defined(f)&&d.parse&&d.parse(e,f,o)}return r}function CU(e,t,n,r="datum"){const i=he(t)?t:t.param,o=it(i),a=De(o+qu);let s;try{s=e.getSelectionComponent(o,i)}catch(c){return`!!${o}`}if(s.project.timeUnit){const c=n!=null?n:e.component.data.raw,f=s.project.timeUnit.clone();c.parent?f.insertAsParentOf(c):c.parent=f}const u=`vlSelectionTest(${a}, ${r}${s.resolve==="global"?")":`, ${De(s.resolve)})`}`,l=`length(data(${a}))`;return t.empty===!1?`${l} && ${u}`:`!${l} || ${u}`}function OU(e,t,n){const r=it(t),i=n.encoding;let o=n.field,a;try{a=e.getSelectionComponent(r,t)}catch(s){return r}if(!i&&!o)o=a.project.items[0].field,a.project.items.length>1&&q(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${De(o)}.`);else if(i&&!o){const s=a.project.items.filter(u=>u.channel===i);!s.length||s.length>1?(o=a.project.items[0].field,q((s.length?"Multiple ":"No ")+`matching ${De(i)} encoding found for selection ${De(n.param)}. Using "field": ${De(o)}.`)):o=s[0].field}return`${a.name}[${De(Wr(o))}]`}function kOe(e,t){var n;for(const[r,i]of es((n=e.component.selection)!==null&&n!==void 0?n:{})){const o=e.getName(`lookup_${r}`);e.component.data.outputNodes[o]=i.materialized=new In(new Xc(t,e,{param:r}),o,et.Lookup,e.component.data.outputNodeRefCounts)}}function Sv(e,t,n){return u0(t,r=>he(r)?r:PEe(r)?CU(e,r,n):QI(r))}var Cv=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function MOe(e,t){if(!!e)return Z(e)&&!ls(e)?e.map(n=>aO(n,t)).join(", "):e}function XO(e,t,n,r){var i,o,a,s,u;(i=e.encode)!==null&&i!==void 0||(e.encode={}),(o=(s=e.encode)[t])!==null&&o!==void 0||(s[t]={}),(a=(u=e.encode[t]).update)!==null&&a!==void 0||(u.update={}),e.encode[t].update[n]=r}function L0(e,t,n,r={header:!1}){var i,o;const a=e.combine(),{disable:s,orient:u,scale:l,labelExpr:c,title:f,zindex:d}=a,h=Cv(a,["disable","orient","scale","labelExpr","title","zindex"]);if(!s){for(const g in h){const p=H$e[g],m=h[g];if(p&&p!==t&&p!=="both")delete h[g];else if(_0(m)){const{condition:y}=m,v=Cv(m,["condition"]),b=gt(y),x=RB[g];if(x){const{vgProp:w,part:E}=x,_=[...b.map(S=>{const{test:C}=S,O=Cv(S,["test"]);return Object.assign({test:Sv(null,C)},O)}),v];XO(h,E,w,_),delete h[g]}else if(x===null){const w={signal:b.map(E=>{const{test:_}=E,S=Cv(E,["test"]);return`${Sv(null,_)} ? ${$I(S)} : `}).join("")+$I(v)};h[g]=w}}else if(ie(m)){const y=RB[g];if(y){const{vgProp:v,part:b}=y;XO(h,b,v,m),delete h[g]}}ve(["labelAlign","labelBaseline"],g)&&h[g]===null&&delete h[g]}if(t==="grid"){if(!h.grid)return;if(h.encode){const{grid:g}=h.encode;h.encode=Object.assign({},g?{grid:g}:{}),Ge(h.encode)&&delete h.encode}return Object.assign(Object.assign({scale:l,orient:u},h),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:$t(d,0)})}else{if(!r.header&&e.mainExtracted)return;if(c!==void 0){let p=c;((o=(i=h.encode)===null||i===void 0?void 0:i.labels)===null||o===void 0?void 0:o.update)&&ie(h.encode.labels.update.text)&&(p=Mu(c,"datum.label",h.encode.labels.update.text.signal)),XO(h,"labels","text",{signal:p})}if(h.labelAlign===null&&delete h.labelAlign,h.encode){for(const p of PB)e.hasAxisPart(p)||delete h.encode[p];Ge(h.encode)&&delete h.encode}const g=MOe(f,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:l,orient:u,grid:!1},g?{title:g}:{}),h),n.aria===!1?{aria:!1}:{}),{zindex:$t(d,0)})}}}function FU(e){const{axes:t}=e.component,n=[];for(const r of bo)if(t[r]){for(const i of t[r])if(!i.get("disable")&&!i.get("gridScale")){const o=r==="x"?"height":"width",a=e.getSizeSignalRef(o).signal;o!==a&&n.push({name:o,update:a})}}return n}function DOe(e,t){const{x:n=[],y:r=[]}=e;return[...n.map(i=>L0(i,"grid",t)),...r.map(i=>L0(i,"grid",t)),...n.map(i=>L0(i,"main",t)),...r.map(i=>L0(i,"main",t))].filter(i=>i)}function kU(e,t,n,r){return Object.assign.apply(null,[{},...e.map(i=>{if(i==="axisOrient"){const o=n==="x"?"bottom":"left",a=t[n==="x"?"axisBottom":"axisLeft"]||{},s=t[n==="x"?"axisTop":"axisRight"]||{},u=new Set([...U(a),...U(s)]),l={};for(const c of u.values())l[c]={signal:`${r.signal} === "${o}" ? ${ca(a[c])} : ${ca(s[c])}`};return l}return t[i]})])}function NOe(e,t,n,r){const i=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:YEe(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[],o=e==="x"?"axisX":"axisY",a=ie(n)?"axisOrient":`axis${l0(n)}`,s=[...i,...i.map(l=>o+l.substr(4))],u=["axis",a,o];return{vlOnlyAxisConfig:kU(s,r,e,n),vgAxisConfig:kU(u,r,e,n),axisConfigStyle:TOe([...u,...s],r)}}function TOe(e,t){var n;const r=[{}];for(const i of e){let o=(n=t[i])===null||n===void 0?void 0:n.style;if(o){o=gt(o);for(const a of o)r.push(t.style[a])}}return Object.assign.apply(null,r)}function KO(e,t,n,r={}){var i;const o=SI(e,n,t);if(o!==void 0)return{configFrom:"style",configValue:o};for(const a of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(((i=r[a])===null||i===void 0?void 0:i[e])!==void 0)return{configFrom:a,configValue:r[a][e]};return{}}const MU={scale:({model:e,channel:t})=>e.scaleName(t),format:({fieldOrDatumDef:e,config:t,axis:n})=>{const{format:r,formatType:i}=n;return mB(e,e.type,r,i,t,!0)},formatType:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:r}=e;return yB(r,t,n)},grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>{var r;return(r=t.grid)!==null&&r!==void 0?r:ROe(n,e)},gridScale:({model:e,channel:t})=>POe(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelAlign||NU(t,n,r),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelBaseline||DU(t,n,r),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>{var r;return(r=e.labelFlush)!==null&&r!==void 0?r:jOe(t.type,n)},labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{var r;return(r=e.labelOverlap)!==null&&r!==void 0?r:IOe(t.type,n,Y(t)&&!!t.timeUnit,Y(t)?t.sort:void 0)},orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:r,scaleType:i})=>{var o;const a=e==="x"?"width":e==="y"?"height":void 0,s=a?t.getSizeSignalRef(a):void 0;return(o=n.tickCount)!==null&&o!==void 0?o:zOe({fieldOrDatumDef:r,scaleType:i,size:s,values:n.values})},title:({axis:e,model:t,channel:n})=>{if(e.title!==void 0)return e.title;const r=TU(t,n);if(r!==void 0)return r;const i=t.typedFieldDef(n),o=n==="x"?"x2":"y2",a=t.fieldDef(o);return OI(i?[$B(i)]:[],Y(a)?[$B(a)]:[])},values:({axis:e,fieldOrDatumDef:t})=>UOe(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>{var r;return(r=e.zindex)!==null&&r!==void 0?r:qOe(n,t)}};function ROe(e,t){return!mn(e)&&Y(t)&&!Qe(t==null?void 0:t.bin)&&!Pn(t==null?void 0:t.bin)}function POe(e,t){const n=t==="x"?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function LOe(e,t,n,r,i){const o=t==null?void 0:t.labelAngle;if(o!==void 0)return ie(o)?o:c0(o);{const{configValue:a}=KO("labelAngle",r,t==null?void 0:t.style,i);return a!==void 0?c0(a):n===ut&&ve([qC,UC],e.type)&&!(Y(e)&&e.timeUnit)?270:void 0}}function ZO(e){return`(((${e.signal} % 360) + 360) % 360)`}function DU(e,t,n,r){if(e!==void 0)if(n==="x"){if(ie(e)){const i=ZO(e),o=ie(t)?`(${t.signal} === "top")`:t==="top";return{signal:`(45 < ${i} && ${i} < 135) || (225 < ${i} && ${i} < 315) ? "middle" :(${i} <= 45 || 315 <= ${i}) === ${o} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(ie(t)){const i=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${i} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==(t==="top")?"bottom":"top"}else{if(ie(e)){const i=ZO(e),o=ie(t)?`(${t.signal} === "left")`:t==="left";return{signal:`${i} <= 45 || 315 <= ${i} || (135 <= ${i} && ${i} <= 225) ? ${r?'"middle"':"null"} : (45 <= ${i} && ${i} <= 135) === ${o} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return r?"middle":null;if(ie(t)){const i=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${i} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==(t==="left")?"top":"bottom"}}function NU(e,t,n){if(e===void 0)return;const r=n==="x",i=r?0:90,o=r?"bottom":"left";if(ie(e)){const a=ZO(e),s=ie(t)?`(${t.signal} === "${o}")`:t===o;return{signal:`(${i?`(${a} + 90)`:a} % 180 === 0) ? ${r?null:'"center"'} :(${i} < ${a} && ${a} < ${180+i}) === ${s} ? "left" : "right"`}}if((e+i)%180==0)return r?null:"center";if(ie(t)){const a=i<e&&e<180+i?"===":"!==";return{signal:`${`${t.signal} ${a} "${o}"`} ? "left" : "right"`}}return(i<e&&e<180+i)==(t===o)?"left":"right"}function jOe(e,t){if(t==="x"&&ve(["quantitative","temporal"],e))return!0}function IOe(e,t,n,r){if(n&&!Xe(r)||e!=="nominal"&&e!=="ordinal")return t==="log"||t==="symlog"?"greedy":!0}function BOe(e){return e==="x"?"bottom":"left"}function zOe({fieldOrDatumDef:e,scaleType:t,size:n,values:r}){var i;if(!r&&!mn(t)&&t!=="log"){if(Y(e)){if(Qe(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&ve(["month","hours","day","quarter"],(i=Ln(e.timeUnit))===null||i===void 0?void 0:i.unit))return}return{signal:`ceil(${n.signal}/40)`}}}function TU(e,t){const n=t==="x"?"x2":"y2",r=e.fieldDef(t),i=e.fieldDef(n),o=r?r.title:void 0,a=i?i.title:void 0;if(o&&a)return FI(o,a);if(o)return o;if(a)return a;if(o!==void 0)return o;if(a!==void 0)return a}function UOe(e,t){const n=e.values;if(Z(n))return TB(t,n);if(ie(n))return n}function qOe(e,t){return e==="rect"&&Qy(t)?1:0}class Kc extends Ye{constructor(t,n){super(t);this.transform=n,this._dependentFields=SU(this.transform.calculate)}clone(){return new Kc(null,ge(this.transform))}static parseAllForSortIndex(t,n){return n.forEachFieldDef((r,i)=>{if(!!zu(r)&&EB(r.sort)){const{field:o,timeUnit:a}=r,s=r.sort,u=s.map((l,c)=>`${QI({field:o,timeUnit:a,equal:l})} ? ${c} : `).join("")+s.length;t=new Kc(t,{calculate:u,as:Zc(r,i,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${Ce(this.transform)}`}}function Zc(e,t,n){return G(e,Object.assign({prefix:t,suffix:"sort_index"},n!=null?n:{}))}function Ov(e,t){return ve(["top","bottom"],t)?"column":ve(["left","right"],t)||e==="row"?"row":"column"}function Jc(e,t,n,r){const i=r==="row"?n.headerRow:r==="column"?n.headerColumn:n.headerFacet;return $t((t||{})[e],i[e],n.header[e])}function Fv(e,t,n,r){const i={};for(const o of e){const a=Jc(o,t||{},n,r);a!==void 0&&(i[o]=a)}return i}const JO=["row","column"],QO=["header","footer"];function HOe(e,t){const n=e.component.layoutHeaders[t].title,r=e.config?e.config:void 0,i=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:o,titleAngle:a,titleOrient:s}=Fv(["titleAnchor","titleAngle","titleOrient"],i.header,r,t),u=Ov(t,s),l=c0(a);return{name:`${t}-title`,type:"group",role:`${u}-title`,title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},t==="row"?{orient:"left"}:{}),{style:"guide-title"}),PU(l,u)),RU(u,l,o)),LU(r,i,t,hAe,tz))}}function RU(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const r=NU(t,e==="row"?"left":"top",e==="row"?"y":"x");return r?{align:r}:{}}function PU(e,t){const n=DU(e,t==="row"?"left":"top",t==="row"?"y":"x",!0);return n?{baseline:n}:{}}function WOe(e,t){const n=e.component.layoutHeaders[t],r=[];for(const i of QO)if(n[i])for(const o of n[i]){const a=YOe(e,t,i,n,o);a!=null&&r.push(a)}return r}function GOe(e,t){var n;const{sort:r}=e;return Eo(r)?{field:G(r,{expr:"datum"}),order:(n=r.order)!==null&&n!==void 0?n:"ascending"}:Z(r)?{field:Zc(e,t,{expr:"datum"}),order:"ascending"}:{field:G(e,{expr:"datum"}),order:r!=null?r:"ascending"}}function e3(e,t,n){const{format:r,formatType:i,labelAngle:o,labelAnchor:a,labelOrient:s,labelExpr:u}=Fv(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e.header,n,t),l=ZC({fieldOrDatumDef:e,format:r,formatType:i,expr:"parent",config:n}).signal,c=Ov(t,s);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:u?Mu(Mu(u,"datum.label",l),"datum.value",G(e,{expr:"parent"})):l}},t==="row"?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),PU(o,c)),RU(c,o,a)),LU(n,e,t,gAe,nz))}function YOe(e,t,n,r,i){if(i){let o=null;const{facetFieldDef:a}=r,s=e.config?e.config:void 0;if(a&&i.labels){const{labelOrient:f}=Fv(["labelOrient"],a.header,s,t);(t==="row"&&!ve(["top","bottom"],f)||t==="column"&&!ve(["left","right"],f))&&(o=e3(a,t,s))}const u=ki(e)&&!x0(e.facet),l=i.axes,c=(l==null?void 0:l.length)>0;if(o||c){const f=t==="row"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`},r.facetFieldDef?{from:{data:e.getName(`${t}_domain`)},sort:GOe(a,t)}:{}),c&&u?{from:{data:e.getName(`facet_domain_${t}`)}}:{}),o?{title:o}:{}),i.sizeSignal?{encode:{update:{[f]:i.sizeSignal}}}:{}),c?{axes:l}:{})}}return null}const VOe={column:{start:0,end:1},row:{start:1,end:0}};function XOe(e,t){return VOe[t][e]}function KOe(e,t){const n={};for(const r of Yr){const i=e[r];if(i==null?void 0:i.facetFieldDef){const{titleAnchor:o,titleOrient:a}=Fv(["titleAnchor","titleOrient"],i.facetFieldDef.header,t,r),s=Ov(r,a),u=XOe(o,s);u!==void 0&&(n[s]=u)}}return Ge(n)?void 0:n}function LU(e,t,n,r,i){const o={};for(const a of r){if(!i[a])continue;const s=Jc(a,t==null?void 0:t.header,e,n);s!==void 0&&(o[i[a]]=s)}return o}function t3(e){return[...kv(e,"width"),...kv(e,"height"),...kv(e,"childWidth"),...kv(e,"childHeight")]}function kv(e,t){const n=t==="width"?"x":"y",r=e.component.layoutSize.get(t);if(!r||r==="merged")return[];const i=e.getSizeSignalRef(t).signal;if(r==="step"){const o=e.getScaleComponent(n);if(o){const a=o.get("type"),s=o.get("range");if(mn(a)&&cs(s)){const u=e.scaleName(n);return ki(e.parent)&&e.parent.component.resolve.scale[n]==="independent"?[jU(u,s)]:[jU(u,s),{name:i,update:IU(u,o,`domain('${u}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(r=="container"){const o=i.endsWith("width"),a=o?"containerSize()[0]":"containerSize()[1]",s=wO(e.config.view,o?"width":"height"),u=`isFinite(${a}) ? ${a} : ${s}`;return[{name:i,init:u,on:[{update:u,events:"window:resize"}]}]}else return[{name:i,value:r}]}function jU(e,t){return{name:`${e}_step`,value:t.step}}function IU(e,t,n){const r=t.get("type"),i=t.get("padding"),o=$t(t.get("paddingOuter"),i);let a=t.get("paddingInner");return a=r==="band"?a!==void 0?a:i:1,`bandspace(${n}, ${ca(a)}, ${ca(o)}) * ${e}_step`}function BU(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function zU(e,t){return U(e).reduce((n,r)=>{const i=e[r];return Object.assign(Object.assign({},n),Yc(t,i,r,o=>ot(o.value)))},{})}function UU(e,t){if(ki(t))return e==="theta"?"independent":"shared";if(tf(t))return"shared";if(y3(t))return xo(e)||e==="theta"||e==="radius"?"independent":"shared";throw new Error("invalid model type for resolve")}function n3(e,t){const n=e.scale[t],r=xo(t)?"axis":"legend";return n==="independent"?(e[r][t]==="shared"&&q(oEe(t)),"independent"):e[r][t]||"shared"}const ZOe=Object.assign(Object.assign({},yAe),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),qU=U(ZOe);class JOe extends ha{}const HU={symbols:QOe,gradient:e3e,labels:t3e,entries:n3e};function QOe(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i,legendType:o}){var a,s,u,l,c,f,d,h;if(o!=="symbol")return;const{markDef:g,encoding:p,config:m,mark:y}=n,v=g.filled&&y!=="trail";let b=Object.assign(Object.assign({},v_e({},n,g$e)),Vz(n,{filled:v}));const x=(a=i.get("symbolOpacity"))!==null&&a!==void 0?a:m.legend.symbolOpacity,w=(s=i.get("symbolFillColor"))!==null&&s!==void 0?s:m.legend.symbolFillColor,E=(u=i.get("symbolStrokeColor"))!==null&&u!==void 0?u:m.legend.symbolStrokeColor,_=x===void 0?(l=WU(p.opacity))!==null&&l!==void 0?l:g.opacity:void 0;if(b.fill){if(r==="fill"||v&&r===nr)delete b.fill;else if(b.fill.field)w?delete b.fill:(b.fill=ot((c=m.legend.symbolBaseFillColor)!==null&&c!==void 0?c:"black"),b.fillOpacity=ot(_!=null?_:1));else if(Z(b.fill)){const S=(h=(d=r3((f=p.fill)!==null&&f!==void 0?f:p.color))!==null&&d!==void 0?d:g.fill)!==null&&h!==void 0?h:v&&g.color;S&&(b.fill=ot(S))}}if(b.stroke){if(r==="stroke"||!v&&r===nr)delete b.stroke;else if(b.stroke.field||E)delete b.stroke;else if(Z(b.stroke)){const S=$t(r3(p.stroke||p.color),g.stroke,v?g.color:void 0);S&&(b.stroke={value:S})}}if(r!==aa){const S=Y(t)&&YU(n,i,t);S?b.opacity=[Object.assign({test:S},ot(_!=null?_:1)),ot(m.legend.unselectedOpacity)]:_&&(b.opacity=ot(_))}return b=Object.assign(Object.assign({},b),e),Ge(b)?void 0:b}function e3e(e,{model:t,legendType:n,legendCmpt:r}){var i;if(n!=="gradient")return;const{config:o,markDef:a,encoding:s}=t;let u={};const c=((i=r.get("gradientOpacity"))!==null&&i!==void 0?i:o.legend.gradientOpacity)===void 0?WU(s.opacity)||a.opacity:void 0;return c&&(u.opacity=ot(c)),u=Object.assign(Object.assign({},u),e),Ge(u)?void 0:u}function t3e(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i}){const o=n.legend(r)||{},a=n.config,s=Y(t)?YU(n,i,t):void 0,u=s?[{test:s,value:1},{value:a.legend.unselectedOpacity}]:void 0,{format:l,formatType:c}=o,f=Bu(c)?JC({fieldOrDatumDef:t,field:"datum.value",format:l,formatType:c,config:a}):void 0,d=Object.assign(Object.assign(Object.assign({},u?{opacity:u}:{}),f?{text:f}:{}),e);return Ge(d)?void 0:d}function n3e(e,{legendCmpt:t}){const n=t.get("selections");return(n==null?void 0:n.length)?Object.assign(Object.assign({},e),{fill:{value:"transparent"}}):e}function WU(e){return GU(e,(t,n)=>Math.max(t,n.value))}function r3(e){return GU(e,(t,n)=>$t(t,n.value))}function GU(e,t){if(D$e(e))return gt(e.condition).reduce(t,e.value);if(Si(e))return e.value}function YU(e,t,n){const r=t.get("selections");if(!(r==null?void 0:r.length))return;const i=De(n.field);return r.map(o=>`(!length(data(${De(it(o)+qu)})) || (${o}[${i}] && indexof(${o}[${i}], datum.value) >= 0))`).join(" || ")}const VU={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:r,formatType:i}=t;return mB(e,e.type,r,i,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:r}=e;return yB(r,t,n)},gradientLength:e=>{var t,n;const{legend:r,legendConfig:i}=e;return(n=(t=r.gradientLength)!==null&&t!==void 0?t:i.gradientLength)!==null&&n!==void 0?n:l3e(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>{var r,i;return(i=(r=e.labelOverlap)!==null&&r!==void 0?r:t.labelOverlap)!==null&&i!==void 0?i:c3e(n)},symbolType:({legend:e,markDef:t,channel:n,encoding:r})=>{var i;return(i=e.symbolType)!==null&&i!==void 0?i:i3e(t.type,n,r.shape,t.shape)},title:({fieldOrDatumDef:e,config:t})=>Ic(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(Tc(n)&&Ai(t)){if(e==="gradient")return}else if(e==="symbol")return;return e},values:({fieldOrDatumDef:e,legend:t})=>r3e(t,e)};function r3e(e,t){const n=e.values;if(Z(n))return TB(t,n);if(ie(n))return n}function i3e(e,t,n,r){var i;if(t!=="shape"){const o=(i=r3(n))!==null&&i!==void 0?i:r;if(o)return o}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function o3e(e){const{legend:t}=e;return $t(t.type,a3e(e))}function a3e({channel:e,timeUnit:t,scaleType:n}){if(Tc(e)){if(ve(["quarter","month","day"],t))return"symbol";if(Ai(n))return"gradient"}return"symbol"}function s3e({legendConfig:e,legendType:t,orient:n,legend:r}){var i,o;return(o=(i=r.direction)!==null&&i!==void 0?i:e[t?"gradientDirection":"symbolDirection"])!==null&&o!==void 0?o:u3e(n,t)}function u3e(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return t==="gradient"?"horizontal":void 0}}function l3e({legendConfig:e,model:t,direction:n,orient:r,scaleType:i}){const{gradientHorizontalMaxLength:o,gradientHorizontalMinLength:a,gradientVerticalMaxLength:s,gradientVerticalMinLength:u}=e;if(Ai(i))return n==="horizontal"?r==="top"||r==="bottom"?XU(t,"width",a,o):a:XU(t,"height",u,s)}function XU(e,t,n,r){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${r})`}}function c3e(e){if(ve(["quantile","threshold","log","symlog"],e))return"greedy"}function KU(e){const t=At(e)?f3e(e):p3e(e);return e.component.legends=t,t}function f3e(e){const{encoding:t}=e,n={};for(const r of[nr,...iz]){const i=Nt(t[r]);!i||!e.getScaleComponent(r)||r===rr&&Y(i)&&i.type===Lc||(n[r]=g3e(e,r))}return n}function d3e(e,t){const n=e.scaleName(t);if(e.mark==="trail"){if(t==="color")return{stroke:n};if(t==="size")return{strokeWidth:n}}return t==="color"?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}function h3e(e,t,n,r){switch(t){case"disable":return n!==void 0;case"values":return!!(n==null?void 0:n.values);case"title":if(t==="title"&&e===(r==null?void 0:r.title))return!0}return e===(n||{})[t]}function g3e(e,t){var n,r,i;let o=e.legend(t);const{markDef:a,encoding:s,config:u}=e,l=u.legend,c=new JOe({},d3e(e,t));pCe(e,t,c);const f=o!==void 0?!o:l.disable;if(c.set("disable",f,o!==void 0),f)return c;o=o||{};const d=e.getScaleComponent(t).get("type"),h=Nt(s[t]),g=Y(h)?(n=Ln(h.timeUnit))===null||n===void 0?void 0:n.unit:void 0,p=o.orient||u.legend.orient||"right",m=o3e({legend:o,channel:t,timeUnit:g,scaleType:d}),y=s3e({legend:o,legendType:m,orient:p,legendConfig:l}),v={legend:o,channel:t,model:e,markDef:a,encoding:s,fieldOrDatumDef:h,legendConfig:l,config:u,scaleType:d,orient:p,legendType:m,direction:y};for(const _ of qU){if(m==="gradient"&&_.startsWith("symbol")||m==="symbol"&&_.startsWith("gradient"))continue;const S=_ in VU?VU[_](v):o[_];if(S!==void 0){const C=h3e(S,_,o,e.fieldDef(t));(C||u.legend[_]===void 0)&&c.set(_,S,C)}}const b=(r=o==null?void 0:o.encoding)!==null&&r!==void 0?r:{},x=c.get("selections"),w={},E={fieldOrDatumDef:h,model:e,channel:t,legendCmpt:c,legendType:m};for(const _ of["labels","legend","title","symbols","gradient","entries"]){const S=zU((i=b[_])!==null&&i!==void 0?i:{},e),C=_ in HU?HU[_](S,E):S;C!==void 0&&!Ge(C)&&(w[_]=Object.assign(Object.assign(Object.assign({},(x==null?void 0:x.length)&&Y(h)?{name:`${it(h.field)}_legend_${_}`}:{}),(x==null?void 0:x.length)?{interactive:!!x}:{}),{update:C}))}return Ge(w)||c.set("encode",w,!!(o==null?void 0:o.encoding)),c}function p3e(e){const{legends:t,resolve:n}=e.component;for(const r of e.children){KU(r);for(const i of U(r.component.legends))n.legend[i]=n3(e.component.resolve,i),n.legend[i]==="shared"&&(t[i]=ZU(t[i],r.component.legends[i]),t[i]||(n.legend[i]="independent",delete t[i]))}for(const r of U(t))for(const i of e.children)!i.component.legends[r]||n.legend[r]==="shared"&&delete i.component.legends[r];return t}function ZU(e,t){var n,r,i,o;if(!e)return t.clone();const a=e.getWithExplicit("orient"),s=t.getWithExplicit("orient");if(a.explicit&&s.explicit&&a.value!==s.value)return;let u=!1;for(const l of qU){const c=ps(e.getWithExplicit(l),t.getWithExplicit(l),l,"legend",(f,d)=>{switch(l){case"symbolType":return m3e(f,d);case"title":return kI(f,d);case"type":return u=!0,Fr("symbol")}return dv(f,d,l,"legend")});e.setWithExplicit(l,c)}return u&&(((r=(n=e.implicit)===null||n===void 0?void 0:n.encode)===null||r===void 0?void 0:r.gradient)&&Oy(e.implicit,["encode","gradient"]),((o=(i=e.explicit)===null||i===void 0?void 0:i.encode)===null||o===void 0?void 0:o.gradient)&&Oy(e.explicit,["encode","gradient"])),e}function m3e(e,t){return t.value==="circle"?t:e}var y3e=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function v3e(e,t,n,r){var i,o,a,s,u;(i=e.encode)!==null&&i!==void 0||(e.encode={}),(o=(s=e.encode)[t])!==null&&o!==void 0||(s[t]={}),(a=(u=e.encode[t]).update)!==null&&a!==void 0||(u.update={}),e.encode[t].update[n]=r}function JU(e){const t=e.component.legends,n={};for(const i of U(t)){const o=e.getScaleComponent(i),a=Je(o.get("domains"));if(n[a])for(const s of n[a])ZU(s,t[i])||n[a].push(t[i]);else n[a]=[t[i].clone()]}return pn(n).flat().map(i=>b3e(i,e.config)).filter(i=>i!==void 0)}function b3e(e,t){var n,r,i;const o=e.combine(),{disable:a,labelExpr:s,selections:u}=o,l=y3e(o,["disable","labelExpr","selections"]);if(!a){if(t.aria===!1&&l.aria==null&&(l.aria=!1),(n=l.encode)===null||n===void 0?void 0:n.symbols){const c=l.encode.symbols.update;c.fill&&c.fill.value!=="transparent"&&!c.stroke&&!l.stroke&&(c.stroke={value:"transparent"});for(const f of iz)l[f]&&delete c[f]}if(l.title||delete l.title,s!==void 0){let c=s;((i=(r=l.encode)===null||r===void 0?void 0:r.labels)===null||i===void 0?void 0:i.update)&&ie(l.encode.labels.update.text)&&(c=Mu(s,"datum.label",l.encode.labels.update.text.signal)),v3e(l,"labels","text",{signal:c})}return l}}function x3e(e){return tf(e)||y3(e)?w3e(e):QU(e)}function w3e(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),QU(e))}function QU(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:r}=n;if(t.data){const i={signal:`[${t.size.map(a=>a.signal).join(", ")}]`},o=t.data.reduce((a,s)=>{const u=ie(s)?s.signal:`data('${e.lookupDataSource(s)}')`;return ve(a,u)||a.push(u),a},[]);if(o.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:r,size:i,fit:{signal:o.length>1?`[${o.join(", ")}]`:o[0]}},n)]}else return[Object.assign(Object.assign({name:r},{translate:{signal:"[width / 2, height / 2]"}}),n)]}const _3e=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class eq extends ha{constructor(t,n,r,i){super(Object.assign({},n),{name:t});this.specifiedProjection=n,this.size=r,this.data=i,this.merged=!1}get isFit(){return!!this.data}}function tq(e){e.component.projection=At(e)?E3e(e):S3e(e)}function E3e(e){var t;if(e.hasProjection){const n=ir(e.specifiedProjection),r=!(n&&(n.scale!=null||n.translate!=null)),i=r?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,o=r?$3e(e):void 0,a=new eq(e.projectionName(!0),Object.assign(Object.assign({},(t=ir(e.config.projection))!==null&&t!==void 0?t:{}),n!=null?n:{}),i,o);return a.get("type")||a.set("type","equalEarth",!1),a}}function $3e(e){const t=[],{encoding:n}=e;for(const r of[[mo,po],[Gr,$i]])(Nt(n[r[0]])||Nt(n[r[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(rr)&&e.typedFieldDef(rr).type===Lc&&t.push({signal:e.getName(`geojson_${t.length}`)}),t.length===0&&t.push(e.requestDataName(et.Main)),t}function A3e(e,t){const n=dC(_3e,i=>!!(!Fc(e.explicit,i)&&!Fc(t.explicit,i)||Fc(e.explicit,i)&&Fc(t.explicit,i)&&co(e.get(i),t.get(i))));if(co(e.size,t.size)){if(n)return e;if(co(e.explicit,{}))return t;if(co(t.explicit,{}))return e}return null}function S3e(e){if(e.children.length===0)return;let t;for(const r of e.children)tq(r);const n=dC(e.children,r=>{const i=r.component.projection;if(i)if(t){const o=A3e(t,i);return o&&(t=o),!!o}else return t=i,!0;else return!0});if(t&&n){const r=e.projectionName(!0),i=new eq(r,t.specifiedProjection,t.size,ge(t.data));for(const o of e.children){const a=o.component.projection;a&&(a.isFit&&i.data.push(...o.component.projection.data),o.renameProjection(a.get("name"),r),a.merged=!0)}return i}}var C3e=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function O3e(e,t,n,r){var i,o;if(w0(t,n)){const a=At(e)?(o=(i=e.axis(n))!==null&&i!==void 0?i:e.legend(n))!==null&&o!==void 0?o:{}:{},s=G(t,{expr:"datum"}),u=G(t,{expr:"datum",binSuffix:"end"});return{formulaAs:G(t,{binSuffix:"range",forAs:!0}),formula:Yy(s,u,a.format,a.formatType,r)}}return{}}function nq(e,t){return`${bI(e)}_${t}`}function F3e(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}function i3(e,t,n){var r;const i=(r=nv(n,void 0))!==null&&r!==void 0?r:{},o=nq(i,t);return e.getName(`${o}_bins`)}function k3e(e){return"as"in e}function rq(e,t,n){let r,i;k3e(e)?r=he(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:r=[G(e,{forAs:!0}),G(e,{binSuffix:"end",forAs:!0})];const o=Object.assign({},nv(t,void 0)),a=nq(o,e.field),{signal:s,extentSignal:u}=F3e(n,a);if(Ly(o.extent)){const c=o.extent;i=OU(n,c.param,c),delete o.extent}const l=Object.assign(Object.assign(Object.assign({bin:o,field:e.field,as:[r]},s?{signal:s}:{}),u?{extentSignal:u}:{}),i?{span:i}:{});return{key:a,binComponent:l}}class Fo extends Ye{constructor(t,n){super(t);this.bins=n}clone(){return new Fo(null,ge(this.bins))}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,o,a)=>{if(Xr(o)&&Qe(o.bin)){const{key:s,binComponent:u}=rq(o,o.bin,n);i[s]=Object.assign(Object.assign(Object.assign({},u),i[s]),O3e(n,o,a,n.config))}return i},{});return Ge(r)?null:new Fo(t,r)}static makeFromTransform(t,n,r){const{key:i,binComponent:o}=rq(n,n.bin,r);return new Fo(t,{[i]:o})}merge(t,n){for(const r of U(t.bins))r in this.bins?(n(t.bins[r].signal,this.bins[r].signal),this.bins[r].as=fo([...this.bins[r].as,...t.bins[r].as],Ce)):this.bins[r]=t.bins[r];for(const r of t.children)t.removeChild(r),r.parent=this;t.remove()}producedFields(){return new Set(pn(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(pn(this.bins).map(t=>t.field))}hash(){return`Bin ${Ce(this.bins)}`}assemble(){return pn(this.bins).flatMap(t=>{const n=[],[r,...i]=t.as,o=t.bin,{extent:a}=o,s=C3e(o,["extent"]),u=Object.assign(Object.assign(Object.assign({type:"bin",field:Wr(t.field),as:r,signal:t.signal},Ly(a)?{extent:null}:{extent:a}),t.span?{span:{signal:`span(${t.span})`}}:{}),s);!a&&t.extentSignal&&(n.push({type:"extent",field:Wr(t.field),signal:t.extentSignal}),u.extent={signal:t.extentSignal}),n.push(u);for(const l of i)for(let c=0;c<2;c++)n.push({type:"formula",expr:G({field:r[c]},{expr:"datum"}),as:l[c]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}}function M3e(e,t,n,r){var i;const o=At(r)?r.encoding[sa(t)]:void 0;if(Xr(n)&&At(r)&&CB(n,o,r.markDef,r.config))e.add(G(n,{})),e.add(G(n,{suffix:"end"})),n.bin&&w0(n,t)&&e.add(G(n,{binSuffix:"range"}));else if(qwe(t)){const a=Uwe(t);e.add(r.getName(a))}else e.add(G(n));return zu(n)&&r$e((i=n.scale)===null||i===void 0?void 0:i.range)&&e.add(n.scale.range.field),e}function D3e(e,t){var n;for(const r of U(t)){const i=t[r];for(const o of U(i))r in e?e[r][o]=new Set([...(n=e[r][o])!==null&&n!==void 0?n:[],...i[o]]):e[r]={[o]:i[o]}}}class Oi extends Ye{constructor(t,n,r){super(t);this.dimensions=n,this.measures=r}clone(){return new Oi(null,new Set(this.dimensions),ge(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let r=!1;n.forEachFieldDef(a=>{a.aggregate&&(r=!0)});const i={},o=new Set;return!r||(n.forEachFieldDef((a,s)=>{var u,l,c,f;const{aggregate:d,field:h}=a;if(d)if(d==="count")(u=i["*"])!==null&&u!==void 0||(i["*"]={}),i["*"].count=new Set([G(a,{forAs:!0})]);else{if(ua(d)||us(d)){const g=ua(d)?"argmin":"argmax",p=d[g];(l=i[p])!==null&&l!==void 0||(i[p]={}),i[p][g]=new Set([G({op:g,field:p},{forAs:!0})])}else(c=i[h])!==null&&c!==void 0||(i[h]={}),i[h][d]=new Set([G(a,{forAs:!0})]);ss(s)&&n.scaleDomain(s)==="unaggregated"&&((f=i[h])!==null&&f!==void 0||(i[h]={}),i[h].min=new Set([G({field:h,aggregate:"min"},{forAs:!0})]),i[h].max=new Set([G({field:h,aggregate:"max"},{forAs:!0})]))}else M3e(o,s,a,n)}),o.size+U(i).length===0)?null:new Oi(t,o,i)}static makeFromTransform(t,n){var r,i,o;const a=new Set,s={};for(const u of n.aggregate){const{op:l,field:c,as:f}=u;l&&(l==="count"?((r=s["*"])!==null&&r!==void 0||(s["*"]={}),s["*"].count=new Set([f||G(u,{forAs:!0})])):((i=s[c])!==null&&i!==void 0||(s[c]={}),s[c][l]=new Set([f||G(u,{forAs:!0})])))}for(const u of(o=n.groupby)!==null&&o!==void 0?o:[])a.add(u);return a.size+U(s).length===0?null:new Oi(t,a,s)}merge(t){return rI(this.dimensions,t.dimensions)?(D3e(this.measures,t.measures),!0):(wEe("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...U(this.measures)])}producedFields(){const t=new Set;for(const n of U(this.measures))for(const r of U(this.measures[n])){const i=this.measures[n][r];i.size===0?t.add(`${r}_${n}`):i.forEach(t.add,t)}return t}hash(){return`Aggregate ${Ce({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],n=[],r=[];for(const o of U(this.measures))for(const a of U(this.measures[o]))for(const s of this.measures[o][a])r.push(s),t.push(a),n.push(o==="*"?null:Wr(o));return{type:"aggregate",groupby:[...this.dimensions].map(Wr),ops:t,fields:n,as:r}}}class Qc extends Ye{constructor(t,n,r,i){super(t);this.model=n,this.name=r,this.data=i;for(const o of Yr){const a=n.facet[o];if(a){const{bin:s,sort:u}=a;this[o]=Object.assign({name:n.getName(`${o}_domain`),fields:[G(a),...Qe(s)?[G(a,{binSuffix:"end"})]:[]]},Eo(u)?{sortField:u}:Z(u)?{sortIndexField:Zc(a,o)}:{})}}this.childModel=n.child}hash(){let t="Facet";for(const n of Yr)this[n]&&(t+=` ${n.charAt(0)}:${Ce(this[n])}`);return t}get fields(){var t;const n=[];for(const r of Yr)((t=this[r])===null||t===void 0?void 0:t.fields)&&n.push(...this[r].fields);return n}dependentFields(){const t=new Set(this.fields);for(const n of Yr)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const n of bo){const r=this.childModel.component.scales[n];if(r&&!r.merged){const i=r.get("type"),o=r.get("range");if(mn(i)&&cs(o)){const a=Dv(this.childModel,n),s=g3(a);s?t[n]=s:q(CC(n))}}}return t}assembleRowColumnHeaderData(t,n,r){const i={row:"y",column:"x",facet:void 0}[t],o=[],a=[],s=[];i&&r&&r[i]&&(n?(o.push(`distinct_${r[i]}`),a.push("max")):(o.push(r[i]),a.push("distinct")),s.push(`distinct_${r[i]}`));const{sortField:u,sortIndexField:l}=this[t];if(u){const{op:c=Vy,field:f}=u;o.push(f),a.push(c),s.push(G(u,{forAs:!0}))}else l&&(o.push(l),a.push("max"),s.push(l));return{name:this[t].name,source:n!=null?n:this.data,transform:[Object.assign({type:"aggregate",groupby:this[t].fields},o.length?{fields:o,ops:a,as:s}:{})]}}assembleFacetHeaderData(t){var n,r;const{columns:i}=this.model.layout,{layoutHeaders:o}=this.model.component,a=[],s={};for(const c of JO){for(const f of QO){const d=(n=o[c]&&o[c][f])!==null&&n!==void 0?n:[];for(const h of d)if(((r=h.axes)===null||r===void 0?void 0:r.length)>0){s[c]=!0;break}}if(s[c]){const f=`length(data("${this.facet.name}"))`,d=c==="row"?i?{signal:`ceil(${f} / ${i})`}:1:i?{signal:`min(${f}, ${i})`}:{signal:f};a.push({name:`${this.facet.name}_${c}`,transform:[{type:"sequence",start:0,stop:d}]})}}const{row:u,column:l}=s;return(u||l)&&a.unshift(this.assembleRowColumnHeaderData("facet",null,t)),a}assemble(){var t,n;const r=[];let i=null;const o=this.getChildIndependentFieldsWithStep(),{column:a,row:s,facet:u}=this;if(a&&s&&(o.x||o.y)){i=`cross_${this.column.name}_${this.row.name}`;const l=[].concat((t=o.x)!==null&&t!==void 0?t:[],(n=o.y)!==null&&n!==void 0?n:[]),c=l.map(()=>"distinct");r.push({name:i,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:l,ops:c}]})}for(const l of[na,ta])this[l]&&r.push(this.assembleRowColumnHeaderData(l,i,o));if(u){const l=this.assembleFacetHeaderData(o);l&&r.push(...l)}return r}}function iq(e){return e[0]==="'"&&e[e.length-1]==="'"||e[0]==='"'&&e[e.length-1]==='"'?e.slice(1,-1):e}function N3e(e,t){const n=mC(e);if(t==="number")return`toNumber(${n})`;if(t==="boolean")return`toBoolean(${n})`;if(t==="string")return`toString(${n})`;if(t==="date")return`toDate(${n})`;if(t==="flatten")return n;if(t.startsWith("date:")){const r=iq(t.slice(5,t.length));return`timeParse(${n},'${r}')`}else if(t.startsWith("utc:")){const r=iq(t.slice(4,t.length));return`utcParse(${n},'${r}')`}else return q(M_e(t)),null}function T3e(e){const t={};return Cy(e.filter,n=>{var r;if(JI(n)){let i=null;TC(n)?i=Cr(n.equal):PC(n)?i=Cr(n.lte):RC(n)?i=Cr(n.lt):LC(n)?i=Cr(n.gt):jC(n)?i=Cr(n.gte):IC(n)?i=n.range[0]:BC(n)&&(i=((r=n.oneOf)!==null&&r!==void 0?r:n.in)[0]),i&&(Lu(i)?t[n.field]="date":Et(i)?t[n.field]="number":he(i)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}function R3e(e){const t={};function n(r){zc(r)?t[r.field]="date":r.type==="quantitative"&&u_e(r.aggregate)?t[r.field]="number":Nc(r.field)>1?r.field in t||(t[r.field]="flatten"):zu(r)&&Eo(r.sort)&&Nc(r.sort.field)>1&&(r.sort.field in t||(t[r.sort.field]="flatten"))}if((At(e)||ki(e))&&e.forEachFieldDef((r,i)=>{if(Xr(r))n(r);else{const o=Tu(i),a=e.fieldDef(o);n(Object.assign(Object.assign({},r),{type:a.type}))}}),At(e)){const{mark:r,markDef:i,encoding:o}=e;if(fs(r)&&!e.encoding.order){const a=i.orient==="horizontal"?"y":"x",s=o[a];Y(s)&&s.type==="quantitative"&&!(s.field in t)&&(t[s.field]="number")}}return t}function P3e(e){const t={};if(At(e)&&e.component.selection)for(const n of U(e.component.selection)){const r=e.component.selection[n];for(const i of r.project.items)!i.channel&&Nc(i.field)>1&&(t[i.field]="flatten")}return t}class xn extends Ye{constructor(t,n){super(t);this._parse=n}clone(){return new xn(null,ge(this._parse))}hash(){return`Parse ${Ce(this._parse)}`}static makeExplicit(t,n,r){var i;let o={};const a=n.data;return!ms(a)&&((i=a==null?void 0:a.format)===null||i===void 0?void 0:i.parse)&&(o=a.format.parse),this.makeWithAncestors(t,o,{},r)}static makeWithAncestors(t,n,r,i){for(const s of U(r)){const u=i.getWithExplicit(s);u.value!==void 0&&(u.explicit||u.value===r[s]||u.value==="derived"||r[s]==="flatten"?delete r[s]:q(LI(s,r[s],u.value)))}for(const s of U(n)){const u=i.get(s);u!==void 0&&(u===n[s]?delete n[s]:q(LI(s,n[s],u)))}const o=new ha(n,r);i.copyAll(o);const a={};for(const s of U(o.combine())){const u=o.get(s);u!==null&&(a[s]=u)}return U(a).length===0||i.parseNothing?null:new xn(t,a)}get parse(){return this._parse}merge(t){this._parse=Object.assign(Object.assign({},this._parse),t.parse),t.remove()}assembleFormatParse(){const t={};for(const n of U(this._parse)){const r=this._parse[n];Nc(n)===1&&(t[n]=r)}return t}producedFields(){return new Set(U(this._parse))}dependentFields(){return new Set(U(this._parse))}assembleTransforms(t=!1){return U(this._parse).filter(n=>t?Nc(n)>1:!0).map(n=>{const r=N3e(n,this._parse[n]);return r?{type:"formula",expr:r,as:yC(n)}:null}).filter(n=>n!==null)}}class ws extends Ye{clone(){return new ws(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([E0])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:E0}}}class j0 extends Ye{constructor(t,n){super(t);this.params=n}clone(){return new j0(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${Ce(this.params)}`}assemble(){return Object.assign({type:"graticule"},this.params===!0?{}:this.params)}}class I0 extends Ye{constructor(t,n){super(t);this.params=n}clone(){return new I0(null,this.params)}dependentFields(){return new Set}producedFields(){var t;return new Set([(t=this.params.as)!==null&&t!==void 0?t:"data"])}hash(){return`Hash ${Ce(this.params)}`}assemble(){return Object.assign({type:"sequence"},this.params)}}class Yu extends Ye{constructor(t){super(null);t!=null||(t={name:"source"});let n;if(ms(t)||(n=t.format?Object.assign({},Sr(t.format,["parse"])):{}),A0(t))this._data={values:t.values};else if(qc(t)){if(this._data={url:t.url},!n.type){let r=/(?:\.([^.]+))?$/.exec(t.url)[1];ve(["json","csv","tsv","dsv","topojson"],r)||(r="json"),n.type=r}}else Rz(t)?this._data={values:[{type:"Sphere"}]}:(Nz(t)||ms(t))&&(this._data={});this._generator=ms(t),t.name&&(this._name=t.name),n&&!Ge(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}var oq=function(e,t,n,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(e,n):i?i.value=n:t.set(e,n),n},L3e=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},B0;function o3(e){return e instanceof Yu||e instanceof j0||e instanceof I0}class a3{constructor(){B0.set(this,void 0),oq(this,B0,!1,"f")}setModified(){oq(this,B0,!0,"f")}get modifiedFlag(){return L3e(this,B0,"f")}}B0=new WeakMap;class Vu extends a3{getNodeDepths(t,n,r){r.set(t,n);for(const i of t.children)this.getNodeDepths(i,n+1,r);return r}optimize(t){const r=[...this.getNodeDepths(t,0,new Map).entries()].sort((i,o)=>o[1]-i[1]);for(const i of r)this.run(i[0]);return this.modifiedFlag}}class s3 extends a3{optimize(t){this.run(t);for(const n of t.children)this.optimize(n);return this.modifiedFlag}}class j3e extends s3{mergeNodes(t,n){const r=n.shift();for(const i of n)t.removeChild(i),i.parent=r,i.remove()}run(t){const n=t.children.map(i=>i.hash()),r={};for(let i=0;i<n.length;i++)r[n[i]]===void 0?r[n[i]]=[t.children[i]]:r[n[i]].push(t.children[i]);for(const i of U(r))r[i].length>1&&(this.setModified(),this.mergeNodes(t,r[i]))}}class I3e extends s3{constructor(t){super();this.requiresSelectionId=t&&IO(t)}run(t){t instanceof ws&&(this.requiresSelectionId&&(o3(t.parent)||t.parent instanceof Oi||t.parent instanceof xn)||(this.setModified(),t.remove()))}}class B3e extends a3{optimize(t){return this.run(t,new Set),this.modifiedFlag}run(t,n){let r=new Set;t instanceof Co&&(r=t.producedFields(),hC(r,n)&&(this.setModified(),t.removeFormulas(n),t.producedFields.length===0&&t.remove()));for(const i of t.children)this.run(i,new Set([...n,...r]))}}class z3e extends s3{constructor(){super()}run(t){t instanceof In&&!t.isRequired()&&(this.setModified(),t.remove())}}class U3e extends Vu{run(t){if(!o3(t)&&!(t.numChildren()>1)){for(const n of t.children)if(n instanceof xn)if(t instanceof xn)this.setModified(),t.merge(n);else{if(pC(t.producedFields(),n.dependentFields()))continue;this.setModified(),n.swapWithParent()}}}}class q3e extends Vu{run(t){const n=[...t.children],r=t.children.filter(i=>i instanceof xn);if(t.numChildren()>1&&r.length>=1){const i={},o=new Set;for(const a of r){const s=a.parse;for(const u of U(s))u in i?i[u]!==s[u]&&o.add(u):i[u]=s[u]}for(const a of o)delete i[a];if(!Ge(i)){this.setModified();const a=new xn(t,i);for(const s of n){if(s instanceof xn)for(const u of U(i))delete s.parse[u];t.removeChild(s),s.parent=a,s instanceof xn&&U(s.parse).length===0&&s.remove()}}}}}class H3e extends Vu{run(t){t instanceof In||t.numChildren()>0||t instanceof Qc||t instanceof Yu||(this.setModified(),t.remove())}}class W3e extends Vu{run(t){const n=t.children.filter(i=>i instanceof Co),r=n.pop();for(const i of n)this.setModified(),r.merge(i)}}class G3e extends Vu{run(t){const n=t.children.filter(i=>i instanceof Oi),r={};for(const i of n){const o=Ce(i.groupBy);o in r||(r[o]=[]),r[o].push(i)}for(const i of U(r)){const o=r[i];if(o.length>1){const a=o.pop();for(const s of o)a.merge(s)&&(t.removeChild(s),s.parent=a,s.remove(),this.setModified())}}}}class Y3e extends Vu{constructor(t){super();this.model=t}run(t){const n=!(o3(t)||t instanceof Xc||t instanceof xn||t instanceof ws),r=[],i=[];for(const o of t.children)o instanceof Fo&&(n&&!pC(t.producedFields(),o.dependentFields())?r.push(o):i.push(o));if(r.length>0){const o=r.pop();for(const a of r)o.merge(a,this.model.renameSignal.bind(this.model));this.setModified(),t instanceof Fo?t.merge(o,this.model.renameSignal.bind(this.model)):o.swapWithParent()}if(i.length>1){const o=i.pop();for(const a of i)o.merge(a,this.model.renameSignal.bind(this.model));this.setModified()}}}class V3e extends Vu{run(t){const n=[...t.children];if(!Dc(n,a=>a instanceof In)||t.numChildren()<=1)return;const i=[];let o;for(const a of n)if(a instanceof In){let s=a;for(;s.numChildren()===1;){const[u]=s.children;if(u instanceof In)s=u;else break}i.push(...s.children),o?(t.removeChild(a),a.parent=o.parent,o.parent.removeChild(o),o.parent=s,this.setModified()):o=s}else i.push(a);if(i.length){this.setModified();for(const a of i)a.parent.removeChild(a),a.parent=o}}}class Xu extends Ye{constructor(t,n){super(t);this.transform=n}clone(){return new Xu(null,ge(this.transform))}addDimensions(t){this.transform.groupby=fo(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:G(t)}hash(){return`JoinAggregateTransform ${Ce(this.transform)}`}assemble(){const t=[],n=[],r=[];for(const o of this.transform.joinaggregate)n.push(o.op),r.push(this.getDefaultName(o)),t.push(o.field===void 0?null:o.field);const i=this.transform.groupby;return Object.assign({type:"joinaggregate",as:r,ops:n,fields:t},i!==void 0?{groupby:i}:{})}}function X3e(e){return e.stack.stackBy.reduce((t,n)=>{const r=n.fieldDef,i=G(r);return i&&t.push(i),t},[])}function K3e(e){return Z(e)&&e.every(t=>he(t))&&e.length>1}class ma extends Ye{constructor(t,n){super(t);this._stack=n}clone(){return new ma(null,ge(this._stack))}static makeFromTransform(t,n){const{stack:r,groupby:i,as:o,offset:a="zero"}=n,s=[],u=[];if(n.sort!==void 0)for(const f of n.sort)s.push(f.field),u.push($t(f.order,"ascending"));const l={field:s,order:u};let c;return K3e(o)?c=o:he(o)?c=[o,`${o}_end`]:c=[`${n.stack}_start`,`${n.stack}_end`],new ma(t,{stackField:r,groupby:i,offset:a,sort:l,facetby:[],as:c})}static makeFromEncoding(t,n){const r=n.stack,{encoding:i}=n;if(!r)return null;const{groupbyChannel:o,fieldChannel:a,offset:s,impute:u}=r;let l;if(o){const h=i[o];l=Ao(h)}const c=X3e(n),f=n.encoding.order;let d;return Z(f)||Y(f)?d=CI(f):d=c.reduce((h,g)=>(h.field.push(g),h.order.push(a==="y"?"descending":"ascending"),h),{field:[],order:[]}),new ma(t,{dimensionFieldDef:l,stackField:n.vgField(a),facetby:[],stackby:c,sort:d,offset:s,impute:u,as:[n.vgField(a,{suffix:"start",forAs:!0}),n.vgField(a,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${Ce(this._stack)}`}getGroupbyFields(){const{dimensionFieldDef:t,impute:n,groupby:r}=this._stack;return t?t.bin?n?[G(t,{binSuffix:"mid"})]:[G(t,{}),G(t,{binSuffix:"end"})]:[G(t)]:r!=null?r:[]}assemble(){const t=[],{facetby:n,dimensionFieldDef:r,stackField:i,stackby:o,sort:a,offset:s,impute:u,as:l}=this._stack;if(u&&r){const{bandPosition:c=.5,bin:f}=r;f&&t.push({type:"formula",expr:`${c}*`+G(r,{expr:"datum"})+`+${1-c}*`+G(r,{expr:"datum",binSuffix:"end"}),as:G(r,{binSuffix:"mid",forAs:!0})}),t.push({type:"impute",field:i,groupby:[...o,...n],key:G(r,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:i,sort:a,as:l,offset:s}),t}}class ef extends Ye{constructor(t,n){super(t);this.transform=n}clone(){return new ef(null,ge(this.transform))}addDimensions(t){this.transform.groupby=fo(this.transform.groupby.concat(t),n=>n)}dependentFields(){var t,n;const r=new Set;return((t=this.transform.groupby)!==null&&t!==void 0?t:[]).forEach(r.add,r),((n=this.transform.sort)!==null&&n!==void 0?n:[]).forEach(i=>r.add(i.field)),this.transform.window.map(i=>i.field).filter(i=>i!==void 0).forEach(r.add,r),r}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:G(t)}hash(){return`WindowTransform ${Ce(this.transform)}`}assemble(){var t;const n=[],r=[],i=[],o=[];for(const d of this.transform.window)r.push(d.op),i.push(this.getDefaultName(d)),o.push(d.param===void 0?null:d.param),n.push(d.field===void 0?null:d.field);const a=this.transform.frame,s=this.transform.groupby;if(a&&a[0]===null&&a[1]===null&&r.every(d=>EC(d)))return Object.assign({type:"joinaggregate",as:i,ops:r,fields:n},s!==void 0?{groupby:s}:{});const u=[],l=[];if(this.transform.sort!==void 0)for(const d of this.transform.sort)u.push(d.field),l.push((t=d.order)!==null&&t!==void 0?t:"ascending");const c={field:u,order:l},f=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:o,as:i,ops:r,fields:n,sort:c},f!==void 0?{ignorePeers:f}:{}),s!==void 0?{groupby:s}:{}),a!==void 0?{frame:a}:{})}}function Z3e(e){function t(n){if(!(n instanceof Qc)){const r=n.clone();if(r instanceof In){const i=l3+r.getSource();r.setSource(i),e.model.component.data.outputNodes[i]=r}else(r instanceof Oi||r instanceof ma||r instanceof ef||r instanceof Xu)&&r.addDimensions(e.fields);for(const i of n.children.flatMap(t))i.parent=r;return[r]}return n.children.flatMap(t)}return t}function u3(e){if(e instanceof Qc)if(e.numChildren()===1&&!(e.children[0]instanceof In)){const t=e.children[0];(t instanceof Oi||t instanceof ma||t instanceof ef||t instanceof Xu)&&t.addDimensions(e.fields),t.swapWithParent(),u3(e)}else{const t=e.model.component.data.main;aq(t);const n=Z3e(e),r=e.children.map(n).flat();for(const i of r)i.parent=t}else e.children.map(u3)}function aq(e){if(e instanceof In&&e.type===et.Main&&e.numChildren()===1){const t=e.children[0];t instanceof Qc||(t.swapWithParent(),aq(e))}}const l3="scale_",Mv=5;function c3(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return!1;if(!c3(t.children))return!1}return!0}function Fi(e,t){let n=!1;for(const r of t)n=e.optimize(r)||n;return n}function sq(e,t,n){let r=e.sources,i=!1;return i=Fi(new z3e,r)||i,i=Fi(new I3e(t),r)||i,r=r.filter(o=>o.numChildren()>0),i=Fi(new H3e,r)||i,r=r.filter(o=>o.numChildren()>0),n||(i=Fi(new U3e,r)||i,i=Fi(new Y3e(t),r)||i,i=Fi(new B3e,r)||i,i=Fi(new q3e,r)||i,i=Fi(new G3e,r)||i,i=Fi(new W3e,r)||i,i=Fi(new j3e,r)||i,i=Fi(new V3e,r)||i),e.sources=r,i}function J3e(e,t){c3(e.sources);let n=0,r=0;for(let i=0;i<Mv&&sq(e,t,!0);i++)n++;e.sources.map(u3);for(let i=0;i<Mv&&sq(e,t,!1);i++)r++;c3(e.sources),Math.max(n,r)===Mv&&q(`Maximum optimization runs(${Mv}) reached.`)}class sr{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new sr(()=>t(n))}}var Q3e=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function uq(e){At(e)?eFe(e):tFe(e)}function eFe(e){const t=e.component.scales;for(const n of U(t)){const r=rFe(e,n);if(t[n].setWithExplicit("domains",r),oFe(e,n),e.component.data.isFaceted){let o=e;for(;!ki(o)&&o.parent;)o=o.parent;if(o.component.resolve.scale[n]==="shared")for(const s of r.value)la(s)&&(s.data=l3+s.data.replace(l3,""))}}}function tFe(e){for(const n of e.children)uq(n);const t=e.component.scales;for(const n of U(t)){let r,i=null;for(const o of e.children){const a=o.component.scales[n];if(a){r===void 0?r=a.getWithExplicit("domains"):r=ps(r,a.getWithExplicit("domains"),"domains","scale",h3);const s=a.get("selectionExtent");i&&s&&i.param!==s.param&&q(C_e),i=s}}t[n].setWithExplicit("domains",r),i&&t[n].set("selectionExtent",i,!0)}}function nFe(e,t,n,r){if(e==="unaggregated"){const{valid:i,reason:o}=lq(t,n);if(!i){q(o);return}}else if(e===void 0&&r.useUnaggregatedDomain){const{valid:i}=lq(t,n);if(i)return"unaggregated"}return e}function rFe(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:r}=e,i=nFe(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return i!==e.scaleDomain(t)&&(e.specifiedScales[t]=Object.assign(Object.assign({},e.specifiedScales[t]),{domain:i})),t==="x"&&Nt(r.x2)?Nt(r.x)?ps(_s(n,i,e,"x"),_s(n,i,e,"x2"),"domain","scale",h3):_s(n,i,e,"x2"):t==="y"&&Nt(r.y2)?Nt(r.y)?ps(_s(n,i,e,"y"),_s(n,i,e,"y2"),"domain","scale",h3):_s(n,i,e,"y2"):_s(n,i,e,t)}function iFe(e,t,n){return e.map(r=>({signal:`{data: ${rv(r,{timeUnit:n,type:t})}}`}))}function f3(e,t,n){var r;const i=(r=Ln(n))===null||r===void 0?void 0:r.unit;return t==="temporal"||i?iFe(e,t,i):[e]}function _s(e,t,n,r){const{encoding:i}=n,o=Nt(i[r]),{type:a}=o,s=o.timeUnit;if(n$e(t)){const f=_s(e,void 0,n,r),d=f3(t.unionWith,a,s);return ga([...f.value,...d])}else{if(ie(t))return ga([t]);if(t&&t!=="unaggregated"&&!nB(t))return ga(f3(t,a,s))}const u=n.stack;if(u&&r===u.fieldChannel){if(u.offset==="normalize")return Fr([[0,1]]);const f=n.requestDataName(et.Main);return Fr([{data:f,field:n.vgField(r,{suffix:"start"})},{data:f,field:n.vgField(r,{suffix:"end"})}])}const l=ss(r)&&Y(o)?aFe(n,r,e):void 0;if(ds(o)){const f=f3([o.datum],a,s);return Fr(f)}const c=o;if(t==="unaggregated"){const f=n.requestDataName(et.Main),{field:d}=o;return Fr([{data:f,field:G({field:d,aggregate:"min"})},{data:f,field:G({field:d,aggregate:"max"})}])}else if(Qe(c.bin)){if(mn(e))return Fr(e==="bin-ordinal"?[]:[{data:s0(l)?n.requestDataName(et.Main):n.requestDataName(et.Raw),field:n.vgField(r,w0(c,r)?{binSuffix:"range"}:{}),sort:l===!0||!Xe(l)?{field:n.vgField(r,{}),op:"min"}:l}]);{const{bin:f}=c;if(Qe(f)){const d=i3(n,c.field,f);return Fr([new sr(()=>{const h=n.getSignalName(d);return`[${h}.start, ${h}.stop]`})])}else return Fr([{data:n.requestDataName(et.Main),field:n.vgField(r,{})}])}}else if(c.timeUnit&&ve(["time","utc"],e)&&CB(c,At(n)?n.encoding[sa(r)]:void 0,n.markDef,n.config)){const f=n.requestDataName(et.Main);return Fr([{data:f,field:n.vgField(r)},{data:f,field:n.vgField(r,{suffix:"end"})}])}else return Fr(l?[{data:s0(l)?n.requestDataName(et.Main):n.requestDataName(et.Raw),field:n.vgField(r),sort:l}]:[{data:n.requestDataName(et.Main),field:n.vgField(r)}])}function d3(e,t){const{op:n,field:r,order:i}=e;return Object.assign(Object.assign({op:n!=null?n:t?"sum":Vy},r?{field:Wr(r)}:{}),i?{order:i}:{})}function oFe(e,t){var n;const r=e.component.scales[t],i=e.specifiedScales[t].domain,o=(n=e.fieldDef(t))===null||n===void 0?void 0:n.bin,a=nB(i)&&i,s=Ru(o)&&Ly(o.extent)&&o.extent;(a||s)&&r.set("selectionExtent",a!=null?a:s,!0)}function aFe(e,t,n){if(!mn(n))return;const r=e.fieldDef(t),i=r.sort;if(EB(i))return{op:"min",field:Zc(r,t),order:"ascending"};const{stack:o}=e,a=o?[...o.groupbyField?[o.groupbyField]:[],...o.stackBy.map(s=>s.fieldDef.field)]:void 0;if(Eo(i)){const s=o&&!ve(a,i.field);return d3(i,s)}else if(_B(i)){const{encoding:s,order:u}=i,l=e.fieldDef(s),{aggregate:c,field:f}=l,d=o&&!ve(a,f);if(ua(c)||us(c))return d3({field:G(l),order:u},d);if(EC(c)||!c)return d3({op:c,field:f,order:u},d)}else{if(i==="descending")return{op:"min",field:e.vgField(t),order:"descending"};if(ve(["ascending",void 0],i))return!0}}function lq(e,t){const{aggregate:n,type:r}=e;return n?he(n)&&!f_e[n]?{valid:!1,reason:J_e(n)}:r==="quantitative"&&t==="log"?{valid:!1,reason:Q_e(e)}:{valid:!0}:{valid:!1,reason:Z_e(e)}}function h3(e,t,n,r){return e.explicit&&t.explicit&&q(iEe(n,r,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function sFe(e){const t=fo(e.map(a=>la(a)?Q3e(a,["sort"]):a),Ce),n=fo(e.map(a=>{if(la(a)){const s=a.sort;return s!==void 0&&!s0(s)&&("op"in s&&s.op==="count"&&delete s.field,s.order==="ascending"&&delete s.order),s}}).filter(a=>a!==void 0),Ce);if(t.length===0)return;if(t.length===1){const a=e[0];if(la(a)&&n.length>0){let s=n[0];if(n.length>1)q(qI),s=!0;else if(Xe(s)&&"field"in s){const u=s.field;a.field===u&&(s=s.order?{order:s.order}:!0)}return Object.assign(Object.assign({},a),{sort:s})}return a}const r=fo(n.map(a=>s0(a)||!("op"in a)||he(a.op)&&a.op in a_e?a:(q(aEe(a)),!0)),Ce);let i;r.length===1?i=r[0]:r.length>1&&(q(qI),i=!0);const o=fo(e.map(a=>la(a)?a.data:null),a=>a);return o.length===1&&o[0]!==null?Object.assign({data:o[0],fields:t.map(s=>s.field)},i?{sort:i}:{}):Object.assign({fields:t},i?{sort:i}:{})}function g3(e){if(la(e)&&he(e.field))return e.field;if(h_e(e)){let t;for(const n of e.fields)if(la(n)&&he(n.field)){if(!t)t=n.field;else if(t!==n.field)return q(sEe),t}return q(uEe),t}else if(g_e(e)){q(lEe);const t=e.fields[0];return he(t)?t:void 0}}function Dv(e,t){const r=e.component.scales[t].get("domains").map(i=>(la(i)&&(i.data=e.lookupDataSource(i.data)),i));return sFe(r)}var uFe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function cq(e){return tf(e)||y3(e)?e.children.reduce((t,n)=>t.concat(cq(n)),fq(e)):fq(e)}function fq(e){return U(e.component.scales).reduce((t,n)=>{const r=e.component.scales[n];if(r.merged)return t;const i=r.combine(),{name:o,type:a,selectionExtent:s,domains:u,range:l,reverse:c}=i,f=uFe(i,["name","type","selectionExtent","domains","range","reverse"]),d=lFe(i.range,o,n,e),h=Dv(e,n),g=s?HSe(e,s,r,h):null;return t.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:o,type:a},h?{domain:h}:{}),g?{domainRaw:g}:{}),{range:d}),c!==void 0?{reverse:c}:{}),f)),t},[])}function lFe(e,t,n,r){if(xo(n)){if(cs(e))return{step:{signal:`${t}_step`}}}else if(Xe(e)&&la(e))return Object.assign(Object.assign({},e),{data:r.lookupDataSource(e.data)});return e}class dq extends ha{constructor(t,n){super({},{name:t});this.merged=!1,this.setWithExplicit("type",n)}domainDefinitelyIncludesZero(){return this.get("zero")!==!1?!0:Dc(this.get("domains"),t=>Z(t)&&t.length===2&&t[0]<=0&&t[1]>=0)}}const cFe=["range","scheme"];function hq(e){return e==="x"?"width":e==="y"?"height":void 0}function fFe(e){const t=e.component.scales;for(const n of Py){const r=t[n];if(!r)continue;const i=dFe(n,e);r.setWithExplicit("range",i)}}function gq(e,t){const n=e.fieldDef(t);if(n==null?void 0:n.bin){const{bin:r,field:i}=n,o=hq(t),a=e.getName(o);if(Xe(r)&&r.binned&&r.step!==void 0)return new sr(()=>{const s=e.scaleName(t),u=`(domain("${s}")[1] - domain("${s}")[0]) / ${r.step}`;return`${e.getSignalName(a)} / (${u})`});if(Qe(r)){const s=i3(e,i,r);return new sr(()=>{const u=e.getSignalName(s),l=`(${u}.stop - ${u}.start) / ${u}.step`;return`${e.getSignalName(a)} / (${l})`})}}}function dFe(e,t){const n=t.specifiedScales[e],{size:r}=t,o=t.getScaleComponent(e).get("type");for(const l of cFe)if(n[l]!==void 0){const c=WC(o,l),f=rB(e,l);if(!c)q(zI(o,l,e));else if(f)q(f);else switch(l){case"range":{const d=n.range;if(Z(d)){if(xo(e))return ga(d.map(h=>{if(h==="width"||h==="height"){const g=t.getName(h),p=t.getSignalName.bind(t);return sr.fromName(p,g)}return h}))}else if(Xe(d))return ga({data:t.requestDataName(et.Main),field:d.field,sort:{op:"min",field:t.vgField(e)}});return ga(d)}case"scheme":return ga(hFe(n[l]))}}if(e===ut||e===Mt){const l=e===ut?"width":"height",c=r[l];if(So(c)){if(mn(o))return ga({step:c.step});q(UI(l))}}const{rangeMin:a,rangeMax:s}=n,u=gFe(e,t);return(a!==void 0||s!==void 0)&&WC(o,"rangeMin")&&Z(u)&&u.length===2?ga([a!=null?a:u[0],s!=null?s:u[1]]):Fr(u)}function hFe(e){return t$e(e)?Object.assign({scheme:e.name},Sr(e,["name"])):{scheme:e}}function gFe(e,t){const{size:n,config:r,mark:i,encoding:o}=t,a=t.getSignalName.bind(t),{type:s}=Nt(o[e]),l=t.getScaleComponent(e).get("type"),{domain:c,domainMid:f}=t.specifiedScales[e];switch(e){case ut:case Mt:{if(ve(["point","band"],l)){if(e===ut&&!n.width){const g=$0(r.view,"width");if(So(g))return g}else if(e===Mt&&!n.height){const g=$0(r.view,"height");if(So(g))return g}}const d=hq(e),h=t.getName(d);return e===Mt&&Or(l)?[sr.fromName(a,h),0]:[0,sr.fromName(a,h)]}case oa:{const d=t.component.scales[e].get("zero"),h=pq(i,d,r),g=yFe(i,n,t,r);return v0(l)?mFe(h,g,pFe(l,r,c,e)):[h,g]}case Ei:return[0,Math.PI*2];case Du:return[0,360];case go:return[0,new sr(()=>{const d=t.getSignalName("width"),h=t.getSignalName("height");return`min(${d},${h})/2`})];case rs:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case is:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case rr:return"symbol";case nr:case yo:case vo:return l==="ordinal"?s==="nominal"?"category":"ordinal":f!==void 0?"diverging":i==="rect"||i==="geoshape"?"heatmap":"ramp";case aa:case ts:case ns:return[r.scale.minOpacity,r.scale.maxOpacity]}throw new Error(`Scale range undefined for channel ${e}`)}function pFe(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return n!==void 0&&Z(n)?n.length+1:(q(vEe(r)),3)}}function mFe(e,t,n){const r=()=>{const i=ca(t),o=ca(e),a=`(${i} - ${o}) / (${n} - 1)`;return`sequence(${o}, ${i} + ${a}, ${a})`};return ie(t)?new sr(r):{signal:r()}}function pq(e,t,n){if(t)return ie(t)?{signal:`${t.signal} ? 0 : ${pq(e,!1,n)}`}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(Iy("size",e))}const mq=.95;function yFe(e,t,n,r){const i={x:gq(n,"x"),y:gq(n,"y")};switch(e){case"bar":case"tick":{if(r.scale.maxBandSize!==void 0)return r.scale.maxBandSize;const o=yq(t,i,r.view);return Et(o)?o-1:new sr(()=>`${o.signal} - 1`)}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const o=yq(t,i,r.view);return Et(o)?Math.pow(mq*o,2):new sr(()=>`pow(${mq} * ${o.signal}, 2)`)}}throw new Error(Iy("size",e))}function yq(e,t,n){const r=So(e.width)?e.width.step:cv(n,"width"),i=So(e.height)?e.height.step:cv(n,"height");return t.x||t.y?new sr(()=>`min(${[t.x?t.x.signal:r,t.y?t.y.signal:i].join(", ")})`):Math.min(r,i)}function vq(e,t){At(e)?vFe(e,t):wq(e,t)}function vFe(e,t){const n=e.component.scales,{config:r,encoding:i,markDef:o,specifiedScales:a}=e;for(const s of U(n)){const u=a[s],l=n[s],c=e.getScaleComponent(s),f=Nt(i[s]),d=u[t],h=c.get("type"),g=c.get("padding"),p=c.get("paddingInner"),m=WC(h,t),y=rB(s,t);if(d!==void 0&&(m?y&&q(y):q(zI(h,t,s))),m&&y===void 0)if(d!==void 0){const v=f.timeUnit,b=f.type;switch(t){case"domainMax":case"domainMin":Lu(u[t])||b==="temporal"||v?l.set(t,{signal:rv(u[t],{type:b,timeUnit:v})},!0):l.set(t,u[t],!0);break;default:l.copyKeyFromObject(t,u)}}else{const v=t in bq?bq[t]({model:e,channel:s,fieldOrDatumDef:f,scaleType:h,scalePadding:g,scalePaddingInner:p,domain:u.domain,markDef:o,config:r}):r.scale[t];v!==void 0&&l.set(t,v,!1)}}}const bq={bins:({model:e,fieldOrDatumDef:t})=>Y(t)?bFe(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>xFe(e,t.type),nice:({scaleType:e,channel:t,domain:n,fieldOrDatumDef:r})=>wFe(e,t,n,r),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:r,config:i})=>_Fe(e,t,i.scale,n,r,i.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,config:r})=>EFe(e,t,n.type,r.scale),paddingOuter:({scalePadding:e,channel:t,scaleType:n,markDef:r,scalePaddingInner:i,config:o})=>$Fe(e,t,n,r.type,i,o.scale),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:r})=>{const i=Y(e)?e.sort:void 0;return AFe(t,i,n,r.scale)},zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:r,scaleType:i})=>SFe(e,t,n,r,i)};function xq(e){At(e)?fFe(e):wq(e,"range")}function wq(e,t){const n=e.component.scales;for(const r of e.children)t==="range"?xq(r):vq(r,t);for(const r of U(n)){let i;for(const o of e.children){const a=o.component.scales[r];if(a){const s=a.getWithExplicit(t);i=ps(i,s,t,"scale",Dz((u,l)=>{switch(t){case"range":return u.step&&l.step?u.step-l.step:0}return 0}))}}n[r].setWithExplicit(t,i)}}function bFe(e,t){const n=t.bin;if(Qe(n)){const r=i3(e,t.field,n);return new sr(()=>e.getSignalName(r))}else if(Pn(n)&&Ru(n)&&n.step!==void 0)return{step:n.step}}function xFe(e,t){if(ve([nr,yo,vo],e)&&t!=="nominal")return"hcl"}function wFe(e,t,n,r){var i;if(!(((i=Ao(r))===null||i===void 0?void 0:i.bin)||Z(n)||ve([Dt.TIME,Dt.UTC],e)))return t in as?!0:void 0}function _Fe(e,t,n,r,i,o){if(e in as){if(Ai(t)){if(n.continuousPadding!==void 0)return n.continuousPadding;const{type:a,orient:s}=i;if(a==="bar"&&!(Y(r)&&(r.bin||r.timeUnit))&&(s==="vertical"&&e==="x"||s==="horizontal"&&e==="y"))return o.continuousBandSize}if(t===Dt.POINT)return n.pointPadding}}function EFe(e,t,n,r){if(e===void 0&&t in as){const{bandPaddingInner:i,barBandPaddingInner:o,rectBandPaddingInner:a}=r;return $t(i,n==="bar"?o:a)}}function $Fe(e,t,n,r,i,o){if(e===void 0&&t in as&&n===Dt.BAND){const{bandPaddingOuter:a}=o;return $t(a,ie(i)?{signal:`${i.signal}/2`}:i/2)}}function AFe(e,t,n,r){if(n==="x"&&r.xReverse!==void 0)return Or(e)&&t==="descending"?ie(r.xReverse)?{signal:`!${r.xReverse.signal}`}:!r.xReverse:r.xReverse;if(Or(e)&&t==="descending")return!0}function SFe(e,t,n,r,i){if(!!n&&n!=="unaggregated"&&Or(i)){if(Z(n)){const a=n[0],s=n[n.length-1];if(a<=0&&s>=0)return!0}return!1}if(e==="size"&&t.type==="quantitative"&&!v0(i))return!0;if(!(Y(t)&&t.bin)&&ve([...bo,...Jwe],e)){const{orient:a,type:s}=r;return!(ve(["bar","area","line","trail"],s)&&(a==="horizontal"&&e==="y"||a==="vertical"&&e==="x"))}return!1}function CFe(e,t,n,r){const i=OFe(t,n,r),{type:o}=e;return ss(t)?o!==void 0?u$e(t,o)?Y(n)&&!s$e(o,n.type)?(q(nEe(o,i)),i):o:(q(tEe(t,o,i)),i):i:null}function OFe(e,t,n){var r;switch(t.type){case"nominal":case"ordinal":{if(Tc(e)||_C(e)==="discrete")return e==="shape"&&t.type==="ordinal"&&q(FC(e,"ordinal")),"ordinal";if(e in as){if(ve(["rect","bar","image","rule"],n.type))return"band"}else if(n.type==="arc"&&e in wC)return"band";const i=n[Vr(e)];return jc(i)||iO(t)&&((r=t.axis)===null||r===void 0?void 0:r.tickBand)?"band":"point"}case"temporal":return Tc(e)?"time":_C(e)==="discrete"?(q(FC(e,"temporal")),"ordinal"):Y(t)&&t.timeUnit&&Ln(t.timeUnit).utc?"utc":"time";case"quantitative":return Tc(e)?Y(t)&&Qe(t.bin)?"bin-ordinal":"linear":_C(e)==="discrete"?(q(FC(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(II(t.type))}function FFe(e,{ignoreRange:t}={}){_q(e),uq(e);for(const n of a$e)vq(e,n);t||xq(e)}function _q(e){At(e)?e.component.scales=kFe(e):e.component.scales=DFe(e)}function kFe(e){const{encoding:t,mark:n,markDef:r}=e;return Py.reduce((i,o)=>{const a=Nt(t[o]);if(a&&n===aB&&o===rr&&a.type===Lc)return i;let s=a&&a.scale;if(a&&s!==null&&s!==!1){s!=null||(s={});const u=CFe(s,o,a,r);i[o]=new dq(e.scaleName(`${o}`,!0),{value:u,explicit:s.type===u})}return i},{})}const MFe=Dz((e,t)=>eB(e)-eB(t));function DFe(e){var t,n;const r=e.component.scales={},i={},o=e.component.resolve;for(const a of e.children){_q(a);for(const s of U(a.component.scales))if((t=(n=o.scale)[s])!==null&&t!==void 0||(n[s]=UU(s,e)),o.scale[s]==="shared"){const u=i[s],l=a.component.scales[s].getWithExplicit("type");u?UEe(u.value,l.value)?i[s]=ps(u,l,"type","scale",MFe):(o.scale[s]="independent",delete i[s]):i[s]=l}}for(const a of U(i)){const s=e.scaleName(a,!0),u=i[a];r[a]=new dq(s,u);for(const l of e.children){const c=l.component.scales[a];c&&(l.renameScale(c.get("name"),s),c.merged=!0)}}return r}var p3=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};class m3{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return this.nameMap[t]!==void 0}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function At(e){return(e==null?void 0:e.type)==="unit"}function ki(e){return(e==null?void 0:e.type)==="facet"}function y3(e){return(e==null?void 0:e.type)==="concat"}function tf(e){return(e==null?void 0:e.type)==="layer"}class v3{constructor(t,n,r,i,o,a,s){var u,l;this.type=n,this.parent=r,this.config=o,this.correctDataNames=c=>{var f,d,h;return((f=c.from)===null||f===void 0?void 0:f.data)&&(c.from.data=this.lookupDataSource(c.from.data)),((h=(d=c.from)===null||d===void 0?void 0:d.facet)===null||h===void 0?void 0:h.data)&&(c.from.facet.data=this.lookupDataSource(c.from.facet.data)),c},this.parent=r,this.config=o,this.view=ir(s),this.name=(u=t.name)!==null&&u!==void 0?u:i,this.title=ls(t.title)?{text:t.title}:t.title?ir(t.title):void 0,this.scaleNameMap=r?r.scaleNameMap:new m3,this.projectionNameMap=r?r.projectionNameMap:new m3,this.signalNameMap=r?r.signalNameMap:new m3,this.data=t.data,this.description=t.description,this.transforms=ySe((l=t.transform)!==null&&l!==void 0?l:[]),this.layout=n==="layer"||n==="unit"?{}:EAe(t,n,o),this.component={data:{sources:r?r.component.data.sources:[],outputNodes:r?r.component.data.outputNodes:{},outputNodeRefCounts:r?r.component.data.outputNodeRefCounts:{},isFaceted:Xy(t)||r&&r.component.data.isFaceted&&t.data===void 0},layoutSize:new ha,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},a?ge(a):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){FFe(this)}parseProjection(){tq(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){KU(this)}assembleEncodeFromView(t){const n=p3(t,["style"]),r={};for(const i of U(n)){const o=n[i];o!==void 0&&(r[i]=ot(o))}return r}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),!t&&(this.description&&(n.description=ot(this.description)),this.type==="unit"||this.type==="layer")?Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},n!=null?n:{}):Ge(n)?void 0:n}assembleLayout(){if(!this.layout)return;const t=this.layout,{spacing:n}=t,r=p3(t,["spacing"]),{component:i,config:o}=this,a=KOe(i.layoutHeaders,o);return Object.assign(Object.assign(Object.assign({padding:n},this.assembleDefaultLayout()),r),a?{titleBand:a}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const r of Yr)t[r].title&&n.push(HOe(this,r));for(const r of JO)n=n.concat(WOe(this,r));return n}assembleAxes(){return DOe(this.component.axes,this.config)}assembleLegends(){return JU(this)}assembleProjections(){return x3e(this)}assembleTitle(){var t,n,r;const i=(t=this.title)!==null&&t!==void 0?t:{},{encoding:o}=i,a=p3(i,["encoding"]),s=Object.assign(Object.assign(Object.assign({},wI(this.config.title).nonMarkTitleProperties),a),o?{encode:{update:o}}:{});if(s.text)return ve(["unit","layer"],this.type)?ve(["middle",void 0],s.anchor)&&((n=s.frame)!==null&&n!==void 0||(s.frame="group")):(r=s.anchor)!==null&&r!==void 0||(s.anchor="start"),Ge(s)?void 0:s}assembleGroup(t=[]){const n={};t=t.concat(this.assembleSignals()),t.length>0&&(n.signals=t);const r=this.assembleLayout();r&&(n.layout=r),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const i=!this.parent||ki(this.parent)?cq(this):[];i.length>0&&(n.scales=i);const o=this.assembleAxes();o.length>0&&(n.axes=o);const a=this.assembleLegends();return a.length>0&&(n.legends=a),n}getName(t){return it((this.name?`${this.name}_`:"")+t)}getDataName(t){return this.getName(et[t].toLowerCase())}requestDataName(t){const n=this.getDataName(t),r=this.component.data.outputNodeRefCounts;return r[n]=(r[n]||0)+1,n}getSizeSignalRef(t){if(ki(this.parent)){const n=BU(t),r=Ry(n),i=this.component.scales[r];if(i&&!i.merged){const o=i.get("type"),a=i.get("range");if(mn(o)&&cs(a)){const s=i.get("name"),u=Dv(this,r),l=g3(u);if(l){const c=G({aggregate:"distinct",field:l},{expr:"datum"});return{signal:IU(s,i,c)}}else return q(CC(r)),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){if(n)return this.getName(t);if(hI(t)&&ss(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t)))return this.scaleNameMap.get(this.getName(t))}projectionName(t){if(t)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,n){let r=this.component.selection[t];if(!r&&this.parent&&(r=this.parent.getSelectionComponent(t,n)),!r)throw new Error(__e(n));return r}hasAxisOrientSignalRef(){var t,n;return((t=this.component.axes.x)===null||t===void 0?void 0:t.some(r=>r.hasOrientSignalRef()))||((n=this.component.axes.y)===null||n===void 0?void 0:n.some(r=>r.hasOrientSignalRef()))}}class Eq extends v3{vgField(t,n={}){const r=this.fieldDef(t);if(!!r)return G(r,n)}reduceFieldDef(t,n){return Z$e(this.getMapping(),(r,i,o)=>{const a=Ao(i);return a?t(r,a,o):r},n)}forEachFieldDef(t,n){lO(this.getMapping(),(r,i)=>{const o=Ao(r);o&&t(o,i)},n)}}var NFe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};class Nv extends Ye{constructor(t,n){var r,i,o;super(t);this.transform=n,this.transform=ge(n);const a=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=a[0])!==null&&i!==void 0?i:"value",(o=a[1])!==null&&o!==void 0?o:"density"]}clone(){return new Nv(null,ge(this.transform))}dependentFields(){var t;return new Set([this.transform.density,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${Ce(this.transform)}`}assemble(){const t=this.transform,{density:n}=t,r=NFe(t,["density"]);return Object.assign({type:"kde",field:n},r)}}class z0 extends Ye{constructor(t,n){super(t);this.filter=n}clone(){return new z0(null,Object.assign({},this.filter))}static make(t,n){const{config:r,mark:i,markDef:o}=n;if(ze("invalid",o,r)!=="filter")return null;const s=n.reduceFieldDef((u,l,c)=>{const f=ss(c)&&n.getScaleComponent(c);if(f){const d=f.get("type");Or(d)&&l.aggregate!=="count"&&!fs(i)&&(u[l.field]=l)}return u},{});return U(s).length?new z0(t,s):null}dependentFields(){return new Set(U(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${Ce(this.filter)}`}assemble(){const t=U(this.filter).reduce((n,r)=>{const i=this.filter[r],o=G(i,{expr:"datum"});return i!==null&&(i.type==="temporal"?n.push(`(isDate(${o}) || (isValid(${o}) && isFinite(+${o})))`):i.type==="quantitative"&&(n.push(`isValid(${o})`),n.push(`isFinite(+${o})`))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}class Tv extends Ye{constructor(t,n){super(t);this.transform=n,this.transform=ge(n);const{flatten:r,as:i=[]}=this.transform;this.transform.as=r.map((o,a)=>{var s;return(s=i[a])!==null&&s!==void 0?s:o})}clone(){return new Tv(this.parent,ge(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${Ce(this.transform)}`}assemble(){const{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}class Rv extends Ye{constructor(t,n){var r,i,o;super(t);this.transform=n,this.transform=ge(n);const a=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=a[0])!==null&&i!==void 0?i:"key",(o=a[1])!==null&&o!==void 0?o:"value"]}clone(){return new Rv(null,ge(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${Ce(this.transform)}`}assemble(){const{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}class nf extends Ye{constructor(t,n,r,i){super(t);this.fields=n,this.geojson=r,this.signal=i}clone(){return new nf(null,ge(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let r=0;for(const i of[[mo,po],[Gr,$i]]){const o=i.map(a=>{const s=Nt(n.encoding[a]);return Y(s)?s.field:ds(s)?{expr:`${s.datum}`}:Si(s)?{expr:`${s.value}`}:void 0});(o[0]||o[1])&&(t=new nf(t,o,null,n.getName(`geojson_${r++}`)))}if(n.channelHasField(rr)){const i=n.typedFieldDef(rr);i.type===Lc&&(t=new nf(t,null,i.field,n.getName(`geojson_${r++}`)))}return t}dependentFields(){var t;const n=((t=this.fields)!==null&&t!==void 0?t:[]).filter(he);return new Set([...this.geojson?[this.geojson]:[],...n])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${Ce(this.fields)}`}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})]}}class U0 extends Ye{constructor(t,n,r,i){super(t);this.projection=n,this.fields=r,this.as=i}clone(){return new U0(null,this.projection,ge(this.fields),ge(this.as))}static parseAll(t,n){if(!n.projectionName())return t;for(const r of[[mo,po],[Gr,$i]]){const i=r.map(a=>{const s=Nt(n.encoding[a]);return Y(s)?s.field:ds(s)?{expr:`${s.datum}`}:Si(s)?{expr:`${s.value}`}:void 0}),o=r[0]===Gr?"2":"";(i[0]||i[1])&&(t=new U0(t,n.projectionName(),i,[n.getName(`x${o}`),n.getName(`y${o}`)]))}return t}dependentFields(){return new Set(this.fields.filter(he))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${Ce(this.fields)} ${Ce(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class Ku extends Ye{constructor(t,n){super(t);this.transform=n}clone(){return new Ku(null,ge(this.transform))}dependentFields(){var t;return new Set([this.transform.impute,this.transform.key,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:n=0,stop:r,step:i}=t;return{signal:`sequence(${[n,r,...i?[i]:[]].join(",")})`}}static makeFromTransform(t,n){return new Ku(t,n)}static makeFromEncoding(t,n){const r=n.encoding,i=r.x,o=r.y;if(Y(i)&&Y(o)){const a=i.impute?i:o.impute?o:void 0;if(a===void 0)return;const s=i.impute?o:o.impute?i:void 0,{method:u,value:l,frame:c,keyvals:f}=a.impute,d=zB(n.mark,r);return new Ku(t,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:a.field,key:s.field},u?{method:u}:{}),l!==void 0?{value:l}:{}),c?{frame:c}:{}),f!==void 0?{keyvals:f}:{}),d.length?{groupby:d}:{}))}return null}hash(){return`Impute ${Ce(this.transform)}`}assemble(){const{impute:t,key:n,keyvals:r,method:i,groupby:o,value:a,frame:s=[null,null]}=this.transform,u=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:t,key:n},r?{keyvals:QAe(r)?this.processSequence(r):r}:{}),{method:"value"}),o?{groupby:o}:{}),{value:!i||i==="value"?a:null});if(i&&i!=="value"){const l=Object.assign({type:"window",as:[`imputed_${t}_value`],ops:[i],fields:[t],frame:s,ignorePeers:!1},o?{groupby:o}:{}),c={type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t};return[u,l,c]}else return[u]}}var TFe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};class Pv extends Ye{constructor(t,n){var r,i,o;super(t);this.transform=n,this.transform=ge(n);const a=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=a[0])!==null&&i!==void 0?i:n.on,(o=a[1])!==null&&o!==void 0?o:n.loess]}clone(){return new Pv(null,ge(this.transform))}dependentFields(){var t;return new Set([this.transform.loess,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${Ce(this.transform)}`}assemble(){const t=this.transform,{loess:n,on:r}=t,i=TFe(t,["loess","on"]);return Object.assign({type:"loess",x:r,y:n},i)}}class q0 extends Ye{constructor(t,n,r){super(t);this.transform=n,this.secondary=r}clone(){return new q0(null,ge(this.transform),this.secondary)}static make(t,n,r,i){const o=n.component.data.sources,{from:a}=r;let s=null;if(eSe(a)){let u=Cq(a.data,o);u||(u=new Yu(a.data),o.push(u));const l=n.getName(`lookup_${i}`);s=new In(u,l,et.Lookup,n.component.data.outputNodeRefCounts),n.component.data.outputNodes[l]=s}else if(tSe(a)){const u=a.param;r=Object.assign({as:u},r);let l;try{l=n.getSelectionComponent(it(u),u)}catch(c){throw new Error(A_e(u))}if(s=l.materialized,!s)throw new Error(S_e(u))}return new q0(t,r,s.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?gt(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${Ce({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t=Object.assign({values:this.transform.from.fields},this.transform.as?{as:gt(this.transform.as)}:{});else{let n=this.transform.as;he(n)||(q(T_e),n="_lookup"),t={as:[n]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},t),this.transform.default?{default:this.transform.default}:{})}}var RFe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};class Lv extends Ye{constructor(t,n){var r,i,o;super(t);this.transform=n,this.transform=ge(n);const a=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=a[0])!==null&&i!==void 0?i:"prob",(o=a[1])!==null&&o!==void 0?o:"value"]}clone(){return new Lv(null,ge(this.transform))}dependentFields(){var t;return new Set([this.transform.quantile,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${Ce(this.transform)}`}assemble(){const t=this.transform,{quantile:n}=t,r=RFe(t,["quantile"]);return Object.assign({type:"quantile",field:n},r)}}var PFe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};class jv extends Ye{constructor(t,n){var r,i,o;super(t);this.transform=n,this.transform=ge(n);const a=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=a[0])!==null&&i!==void 0?i:n.on,(o=a[1])!==null&&o!==void 0?o:n.regression]}clone(){return new jv(null,ge(this.transform))}dependentFields(){var t;return new Set([this.transform.regression,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${Ce(this.transform)}`}assemble(){const t=this.transform,{regression:n,on:r}=t,i=PFe(t,["regression","on"]);return Object.assign({type:"regression",x:r,y:n},i)}}class Iv extends Ye{constructor(t,n){super(t);this.transform=n}clone(){return new Iv(null,ge(this.transform))}addDimensions(t){var n;this.transform.groupby=fo(((n=this.transform.groupby)!==null&&n!==void 0?n:[]).concat(t),r=>r)}producedFields(){}dependentFields(){var t;return new Set([this.transform.pivot,this.transform.value,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}hash(){return`PivotTransform ${Ce(this.transform)}`}assemble(){const{pivot:t,value:n,groupby:r,limit:i,op:o}=this.transform;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:n},i!==void 0?{limit:i}:{}),o!==void 0?{op:o}:{}),r!==void 0?{groupby:r}:{})}}class Bv extends Ye{constructor(t,n){super(t);this.transform=n}clone(){return new Bv(null,ge(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${Ce(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function $q(e){let t=0;function n(r,i){var o;if(r instanceof Yu&&!r.isGenerator&&!qc(r.data)&&(e.push(i),i={name:null,source:i.name,transform:[]}),r instanceof xn&&(r.parent instanceof Yu&&!i.source?(i.format=Object.assign(Object.assign({},(o=i.format)!==null&&o!==void 0?o:{}),{parse:r.assembleFormatParse()}),i.transform.push(...r.assembleTransforms(!0))):i.transform.push(...r.assembleTransforms())),r instanceof Qc){i.name||(i.name=`data_${t++}`),!i.source||i.transform.length>0?(e.push(i),r.data=i.name):r.data=i.source,e.push(...r.assemble());return}switch((r instanceof j0||r instanceof I0||r instanceof z0||r instanceof Xc||r instanceof Kc||r instanceof U0||r instanceof Oi||r instanceof q0||r instanceof ef||r instanceof Xu||r instanceof Rv||r instanceof Tv||r instanceof Nv||r instanceof Pv||r instanceof Lv||r instanceof jv||r instanceof ws||r instanceof Bv||r instanceof Iv)&&i.transform.push(r.assemble()),(r instanceof Fo||r instanceof Co||r instanceof Ku||r instanceof ma||r instanceof nf)&&i.transform.push(...r.assemble()),r instanceof In&&(i.source&&i.transform.length===0?r.setSource(i.source):r.parent instanceof In?r.setSource(i.name):(i.name||(i.name=`data_${t++}`),r.setSource(i.name),r.numChildren()===1&&(e.push(i),i={name:null,source:i.name,transform:[]}))),r.numChildren()){case 0:r instanceof In&&(!i.source||i.transform.length>0)&&e.push(i);break;case 1:n(r.children[0],i);break;default:{i.name||(i.name=`data_${t++}`);let a=i.name;!i.source||i.transform.length>0?e.push(i):a=i.source;for(const s of r.children)n(s,{name:null,source:a,transform:[]});break}}}return n}function LFe(e){const t=[],n=$q(t);for(const r of e.children)n(r,{source:e.name,name:null,transform:[]});return t}function jFe(e,t){var n,r;const i=[],o=$q(i);let a=0;for(const u of e.sources){u.hasName()||(u.dataName=`source_${a++}`);const l=u.assemble();o(u,l)}for(const u of i)u.transform.length===0&&delete u.transform;let s=0;for(const[u,l]of i.entries())((n=l.transform)!==null&&n!==void 0?n:[]).length===0&&!l.source&&i.splice(s++,0,i.splice(u,1)[0]);for(const u of i)for(const l of(r=u.transform)!==null&&r!==void 0?r:[])l.type==="lookup"&&(l.from=e.outputNodes[l.from].getSource());for(const u of i)u.name in t&&(u.values=t[u.name]);return i}function IFe(e){return e==="top"||e==="left"||ie(e)?"header":"footer"}function BFe(e){for(const t of Yr)zFe(e,t);Sq(e,"x"),Sq(e,"y")}function zFe(e,t){var n;const{facet:r,config:i,child:o,component:a}=e;if(e.channelHasField(t)){const s=r[t],u=Jc("title",null,i,t);let l=Ic(s,i,{allowDisabling:!0,includeDefault:u===void 0||!!u});o.component.layoutHeaders[t].title&&(l=Z(l)?l.join(", "):l,l+=` / ${o.component.layoutHeaders[t].title}`,o.component.layoutHeaders[t].title=null);const c=Jc("labelOrient",s.header,i,t),f=s.header!==null?$t((n=s.header)===null||n===void 0?void 0:n.labels,i.header.labels,!0):!1,d=ve(["bottom","right"],c)?"footer":"header";a.layoutHeaders[t]={title:s.header!==null?l:null,facetFieldDef:s,[d]:t==="facet"?[]:[Aq(e,t,f)]}}}function Aq(e,t,n){const r=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(r)?e.child.getSizeSignalRef(r):void 0,axes:[]}}function Sq(e,t){var n;const{child:r}=e;if(r.component.axes[t]){const{layoutHeaders:i,resolve:o}=e.component;if(o.axis[t]=n3(o,t),o.axis[t]==="shared"){const a=t==="x"?"column":"row",s=i[a];for(const u of r.component.axes[t]){const l=IFe(u.get("orient"));(n=s[l])!==null&&n!==void 0||(s[l]=[Aq(e,a,!1)]);const c=L0(u,"main",e.config,{header:!0});c&&s[l][0].axes.push(c),u.mainExtracted=!0}}}}function UFe(e){b3(e),zv(e,"width"),zv(e,"height")}function qFe(e){b3(e);const t=e.layout.columns===1?"width":"childWidth",n=e.layout.columns===void 0?"height":"childHeight";zv(e,t),zv(e,n)}function b3(e){for(const t of e.children)t.parseLayoutSize()}function zv(e,t){var n;const r=BU(t),i=Ry(r),o=e.component.resolve,a=e.component.layoutSize;let s;for(const u of e.children){const l=u.component.layoutSize.getWithExplicit(r),c=(n=o.scale[i])!==null&&n!==void 0?n:UU(i,e);if(c==="independent"&&l.value==="step"){s=void 0;break}if(s){if(c==="independent"&&s.value!==l.value){s=void 0;break}s=ps(s,l,r,"")}else s=l}if(s){for(const u of e.children)e.renameSignal(u.getName(r),e.getName(t)),u.component.layoutSize.set(r,"merged",!1);a.setWithExplicit(t,s)}else a.setWithExplicit(t,{explicit:!1,value:void 0})}function HFe(e){const{size:t,component:n}=e;for(const r of bo){const i=Vr(r);if(t[i]){const o=t[i];n.layoutSize.set(i,So(o)?"step":o,!0)}else{const o=WFe(e,i);n.layoutSize.set(i,o,!1)}}}function WFe(e,t){const n=t==="width"?"x":"y",r=e.config,i=e.getScaleComponent(n);if(i){const o=i.get("type"),a=i.get("range");if(mn(o)){const s=$0(r.view,t);return cs(a)||So(s)?"step":s}else return wO(r.view,t)}else{if(e.hasProjection||e.mark==="arc")return wO(r.view,t);{const o=$0(r.view,t);return So(o)?o.step:o}}}function x3(e,t,n){return G(t,Object.assign({suffix:`by_${G(e)}`},n!=null?n:{}))}class H0 extends Eq{constructor(t,n,r,i){super(t,"facet",n,r,i,t.resolve);this.child=A3(t.spec,this,this.getName("child"),void 0,i),this.children=[this.child],this.facet=this.initFacet(t.facet)}initFacet(t){if(!x0(t))return{facet:this.initFacetFieldDef(t,"facet")};const n=U(t),r={};for(const i of n){if(![ta,na].includes(i)){q(Iy(i,"facet"));break}const o=t[i];if(o.field===void 0){q(OC(o,i));break}r[i]=this.initFacetFieldDef(o,i)}return r}initFacetFieldDef(t,n){const r=sO(t,n);return r.header?r.header=ir(r.header):r.header===null&&(r.header=null),r}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=Uv(this),this.child.parseData()}parseLayoutSize(){b3(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),BFe(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){var t,n,r;const i={};for(const o of Yr)for(const a of QO){const s=this.component.layoutHeaders[o],u=s[a],{facetFieldDef:l}=s;if(l){const c=Jc("titleOrient",l.header,this.config,o);if(["right","bottom"].includes(c)){const f=Ov(o,c);(t=i.titleAnchor)!==null&&t!==void 0||(i.titleAnchor={}),i.titleAnchor[f]="end"}}if(u==null?void 0:u[0]){const c=o==="row"?"height":"width",f=a==="header"?"headerBand":"footerBand";o!=="facet"&&!this.child.component.layoutSize.get(c)&&((n=i[f])!==null&&n!==void 0||(i[f]={}),i[f][o]=.5),s.title&&((r=i.offset)!==null&&r!==void 0||(i.offset={}),i.offset[o==="row"?"rowTitle":"columnTitle"]=10)}}return i}assembleDefaultLayout(){const{column:t,row:n}=this.facet,r=t?this.columnDistinctSignal():n?1:void 0;let i="all";return(!n&&this.component.resolve.scale.x==="independent"||!t&&this.component.resolve.scale.y==="independent")&&(i="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),r?{columns:r}:{}),{bounds:"full",align:i})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof H0))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroupStyle(){}assembleGroup(t){return this.parent&&this.parent instanceof H0?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:G(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(t)):super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],n=[],r=[];if(this.child instanceof H0){if(this.child.channelHasField("column")){const i=G(this.child.facet.column);t.push(i),n.push("distinct"),r.push(`distinct_${i}`)}}else for(const i of bo){const o=this.child.component.scales[i];if(o&&!o.merged){const a=o.get("type"),s=o.get("range");if(mn(a)&&cs(s)){const u=Dv(this.child,i),l=g3(u);l?(t.push(l),n.push("distinct"),r.push(`distinct_${l}`)):q(CC(i))}}}return{fields:t,ops:n,as:r}}assembleFacet(){const{name:t,data:n}=this.component.data.facetRoot,{row:r,column:i}=this.facet,{fields:o,ops:a,as:s}=this.getCardinalityAggregateForChild(),u=[];for(const c of Yr){const f=this.facet[c];if(f){u.push(G(f));const{bin:d,sort:h}=f;if(Qe(d)&&u.push(G(f,{binSuffix:"end"})),Eo(h)){const{field:g,op:p=Vy}=h,m=x3(f,h);r&&i?(o.push(m),a.push("max"),s.push(m)):(o.push(g),a.push(p),s.push(m))}else if(Z(h)){const g=Zc(f,c);o.push(g),a.push("max"),s.push(g)}}}const l=!!r&&!!i;return Object.assign({name:t,data:n,groupby:u},l||o.length>0?{aggregate:Object.assign(Object.assign({},l?{cross:l}:{}),o.length?{fields:o,ops:a,as:s}:{})}:{})}facetSortFields(t){const{facet:n}=this,r=n[t];return r?Eo(r.sort)?[x3(r,r.sort,{expr:"datum"})]:Z(r.sort)?[Zc(r,t,{expr:"datum"})]:[G(r,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:n}=this,r=n[t];if(r){const{sort:i}=r;return[(Eo(i)?i.order:!Z(i)&&i)||"ascending"]}return[]}assembleLabelTitle(){var t;const{facet:n,config:r}=this;if(n.facet)return e3(n.facet,"facet",r);const i={row:["top","bottom"],column:["left","right"]};for(const o of JO)if(n[o]){const a=Jc("labelOrient",(t=n[o])===null||t===void 0?void 0:t.header,r,o);if(i[o].includes(a))return e3(n[o],o,r)}}assembleMarks(){const{child:t}=this,n=this.component.data.facetRoot,r=LFe(n),i=t.assembleGroupEncodeEntry(!1),o=this.assembleLabelTitle()||t.assembleTitle(),a=t.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},o?{title:o}:{}),a?{style:a}:{}),{from:{facet:this.assembleFacet()},sort:{field:Yr.map(u=>this.facetSortFields(u)).flat(),order:Yr.map(u=>this.facetSortOrder(u)).flat()}}),r.length>0?{data:r}:{}),i?{encode:{update:i}}:{}),t.assembleGroup(BSe(this,[])))]}getMapping(){return this.facet}}function GFe(e,t){const{row:n,column:r}=t;if(n&&r){let i=null;for(const o of[n,r])if(Eo(o.sort)){const{field:a,op:s=Vy}=o.sort;e=i=new Xu(e,{joinaggregate:[{op:s,field:a,as:x3(o,o.sort,{forAs:!0})}],groupby:[G(o)]})}return i}return null}function Cq(e,t){var n,r,i,o;for(const a of t){const s=a.data;if(e.name&&a.hasName()&&e.name!==a.dataName)continue;const u=(n=e.format)===null||n===void 0?void 0:n.mesh,l=(r=s.format)===null||r===void 0?void 0:r.feature;if(u&&l)continue;const c=(i=e.format)===null||i===void 0?void 0:i.feature;if((c||l)&&c!==l)continue;const f=(o=s.format)===null||o===void 0?void 0:o.mesh;if(!((u||f)&&u!==f)){if(A0(e)&&A0(s)){if(co(e.values,s.values))return a}else if(qc(e)&&qc(s)){if(e.url===s.url)return a}else if(Nz(e)&&e.name===a.dataName)return a}}return null}function YFe(e,t){if(e.data||!e.parent){if(e.data===null){const r=new Yu({values:[]});return t.push(r),r}const n=Cq(e.data,t);if(n)return ms(e.data)||(n.data.format=nI({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const r=new Yu(e.data);return t.push(r),r}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function VFe(e,t,n){var r,i;let o=0;for(const a of t.transforms){let s,u;if(fSe(a))u=e=new Kc(e,a),s="derived";else if(SO(a)){const l=T3e(a);u=e=(r=xn.makeWithAncestors(e,{},l,n))!==null&&r!==void 0?r:e,e=new Xc(e,t,a.filter)}else if($z(a))u=e=Fo.makeFromTransform(e,a,t),s="number";else if(hSe(a))s="date",n.getWithExplicit(a.field).value===void 0&&(e=new xn(e,{[a.field]:s}),n.set(a.field,s,!1)),u=e=Co.makeFromTransform(e,a);else if(gSe(a))u=e=Oi.makeFromTransform(e,a),s="number",IO(t)&&(e=new ws(e));else if(Ez(a))u=e=q0.make(e,t,a,o++),s="derived";else if(uSe(a))u=e=new ef(e,a),s="number";else if(lSe(a))u=e=new Xu(e,a),s="number";else if(pSe(a))u=e=ma.makeFromTransform(e,a),s="derived";else if(mSe(a))u=e=new Rv(e,a),s="derived";else if(cSe(a))u=e=new Tv(e,a),s="derived";else if(nSe(a))u=e=new Iv(e,a),s="derived";else if(sSe(a))e=new Bv(e,a);else if(dSe(a))u=e=Ku.makeFromTransform(e,a),s="derived";else if(rSe(a))u=e=new Nv(e,a),s="derived";else if(iSe(a))u=e=new Lv(e,a),s="derived";else if(oSe(a))u=e=new jv(e,a),s="derived";else if(aSe(a))u=e=new Pv(e,a),s="derived";else{q(N_e(a));continue}if(u&&s!==void 0)for(const l of(i=u.producedFields())!==null&&i!==void 0?i:[])n.set(l,s,!1)}return e}function Uv(e){var t,n,r,i,o,a,s,u,l,c;let f=YFe(e,e.component.data.sources);const{outputNodes:d,outputNodeRefCounts:h}=e.component.data,g=e.data,m=!(g&&(ms(g)||qc(g)||A0(g)))&&e.parent?e.parent.component.data.ancestorParse.clone():new CSe;ms(g)?(Tz(g)?f=new I0(f,g.sequence):FO(g)&&(f=new j0(f,g.graticule)),m.parseNothing=!0):((t=g==null?void 0:g.format)===null||t===void 0?void 0:t.parse)===null&&(m.parseNothing=!0),f=(n=xn.makeExplicit(f,e,m))!==null&&n!==void 0?n:f,f=new ws(f);const y=e.parent&&tf(e.parent);(At(e)||ki(e))&&y&&(f=(r=Fo.makeFromEncoding(f,e))!==null&&r!==void 0?r:f),e.transforms.length>0&&(f=VFe(f,e,m));const v=P3e(e),b=R3e(e);f=(i=xn.makeWithAncestors(f,{},Object.assign(Object.assign({},v),b),m))!==null&&i!==void 0?i:f,At(e)&&(f=nf.parseAll(f,e),f=U0.parseAll(f,e)),(At(e)||ki(e))&&(y||(f=(o=Fo.makeFromEncoding(f,e))!==null&&o!==void 0?o:f),f=(a=Co.makeFromEncoding(f,e))!==null&&a!==void 0?a:f,f=Kc.parseAllForSortIndex(f,e));const x=e.getDataName(et.Raw),w=new In(f,x,et.Raw,h);if(d[x]=w,f=w,At(e)){const C=Oi.makeFromEncoding(f,e);C&&(f=C,IO(e)&&(f=new ws(f))),f=(s=Ku.makeFromEncoding(f,e))!==null&&s!==void 0?s:f,f=(u=ma.makeFromEncoding(f,e))!==null&&u!==void 0?u:f}At(e)&&(f=(l=z0.make(f,e))!==null&&l!==void 0?l:f);const E=e.getDataName(et.Main),_=new In(f,E,et.Main,h);d[E]=_,f=_,At(e)&&kOe(e,_);let S=null;if(ki(e)){const C=e.getName("facet");f=(c=GFe(f,e.facet))!==null&&c!==void 0?c:f,S=new Qc(f,e,C,_.getSource()),d[C]=S}return Object.assign(Object.assign({},e.component.data),{outputNodes:d,outputNodeRefCounts:h,raw:w,main:_,facetRoot:S,ancestorParse:m})}class XFe extends v3{constructor(t,n,r,i){var o,a,s,u;super(t,"concat",n,r,i,t.resolve);(((a=(o=t.resolve)===null||o===void 0?void 0:o.axis)===null||a===void 0?void 0:a.x)==="shared"||((u=(s=t.resolve)===null||s===void 0?void 0:s.axis)===null||u===void 0?void 0:u.y)==="shared")&&q(k_e),this.children=this.getChildren(t).map((l,c)=>A3(l,this,this.getName(`concat_${c}`),void 0,i))}parseData(){this.component.data=Uv(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of U(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return lv(t)?t.vconcat:xO(t)?t.hconcat:t.concat}parseLayoutSize(){qFe(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=t3(this);for(const n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{const n=t.assembleTitle(),r=t.assembleGroupStyle(),i=t.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:t.getName("group")},n?{title:n}:{}),r?{style:r}:{}),i?{encode:{update:i}}:{}),t.assembleGroup())})}assembleGroupStyle(){}assembleDefaultLayout(){const t=this.layout.columns;return Object.assign(Object.assign({},t!=null?{columns:t}:{}),{bounds:"full",align:"each"})}}function KFe(e){return e===!1||e===null}const ZFe=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},LB),{labelExpr:1,encode:1}),Oq=U(ZFe);class w3 extends ha{constructor(t={},n={},r=!1){super();this.explicit=t,this.implicit=n,this.mainExtracted=r}clone(){return new w3(ge(this.explicit),ge(this.implicit),this.mainExtracted)}hasAxisPart(t){return t==="axis"?!0:t==="grid"||t==="title"?!!this.get(t):!KFe(this.get(t))}hasOrientSignalRef(){return ie(this.explicit.orient)}}function JFe(e,t,n){var r;const{encoding:i,config:o}=e,a=(r=Nt(i[t]))!==null&&r!==void 0?r:Nt(i[sa(t)]),s=e.axis(t)||{},{format:u,formatType:l}=s;return Bu(l)?Object.assign({text:JC({fieldOrDatumDef:a,field:"datum.value",format:u,formatType:l,config:o})},n):n}function QFe(e){return bo.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[ake(n,e)]),t),{})}const eke={bottom:"top",top:"bottom",left:"right",right:"left"};function tke(e){var t;const{axes:n,resolve:r}=e.component,i={top:0,bottom:0,right:0,left:0};for(const o of e.children){o.parseAxesAndHeaders();for(const a of U(o.component.axes))r.axis[a]=n3(e.component.resolve,a),r.axis[a]==="shared"&&(n[a]=nke(n[a],o.component.axes[a]),n[a]||(r.axis[a]="independent",delete n[a]))}for(const o of bo){for(const a of e.children)if(!!a.component.axes[o]){if(r.axis[o]==="independent"){n[o]=((t=n[o])!==null&&t!==void 0?t:[]).concat(a.component.axes[o]);for(const s of a.component.axes[o]){const{value:u,explicit:l}=s.getWithExplicit("orient");if(!ie(u)){if(i[u]>0&&!l){const c=eke[u];i[u]>i[c]&&s.set("orient",c,!1)}i[u]++}}}delete a.component.axes[o]}if(r.axis[o]==="independent"&&n[o]&&n[o].length>1)for(const a of n[o])!!a.get("grid")&&!a.explicit.grid&&(a.implicit.grid=!1)}}function nke(e,t){if(e){if(e.length!==t.length)return;const n=e.length;for(let r=0;r<n;r++){const i=e[r],o=t[r];if(!!i!=!!o)return;if(i&&o){const a=i.getWithExplicit("orient"),s=o.getWithExplicit("orient");if(a.explicit&&s.explicit&&a.value!==s.value)return;e[r]=rke(i,o)}}}else return t.map(n=>n.clone());return e}function rke(e,t){for(const n of Oq){const r=ps(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(i,o)=>{switch(n){case"title":return kI(i,o);case"gridScale":return{explicit:i.explicit,value:$t(i.value,o.value)}}return dv(i,o,n,"axis")});e.setWithExplicit(n,r)}return e}function ike(e,t,n,r,i){if(t==="disable")return n!==void 0;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(ie(n.labelAngle)?n.labelAngle:c0(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===TU(r,i))return!0}return e===n[t]}const oke=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function ake(e,t){var n,r,i;let o=t.axis(e);const a=new w3,s=Nt(t.encoding[e]),{mark:u,config:l}=t,c=(o==null?void 0:o.orient)||((n=l[e==="x"?"axisX":"axisY"])===null||n===void 0?void 0:n.orient)||((r=l.axis)===null||r===void 0?void 0:r.orient)||BOe(e),f=t.getScaleComponent(e).get("type"),d=NOe(e,f,c,t.config),h=o!==void 0?!o:KO("disable",l.style,o==null?void 0:o.style,d).configValue;if(a.set("disable",h,o!==void 0),h)return a;o=o||{};const g=LOe(s,o,e,l.style,d),p={fieldOrDatumDef:s,axis:o,channel:e,model:t,scaleType:f,orient:c,labelAngle:g,mark:u,config:l};for(const v of Oq){const b=v in MU?MU[v](p):jB(v)?o[v]:void 0,x=b!==void 0,w=ike(b,v,o,t,e);if(x&&w)a.set(v,b,w);else{const{configValue:E=void 0,configFrom:_=void 0}=jB(v)&&v!=="values"?KO(v,l.style,o.style,d):{},S=E!==void 0;x&&!S?a.set(v,b,w):(_!=="vgAxisConfig"||oke.has(v)&&S||_0(E)||ie(E))&&a.set(v,E,!1)}}const m=(i=o.encoding)!==null&&i!==void 0?i:{},y=PB.reduce((v,b)=>{var x;if(!a.hasAxisPart(b))return v;const w=zU((x=m[b])!==null&&x!==void 0?x:{},t),E=b==="labels"?JFe(t,e,w):w;return E!==void 0&&!Ge(E)&&(v[b]={update:E}),v},{});return Ge(y)||a.set("encode",y,!!o.encoding||o.labelAngle!==void 0),a}function ske({encoding:e,size:t}){for(const n of bo){const r=Vr(n);So(t[r])&&$o(e[n])&&(delete t[r],q(UI(r)))}return t}function uke(e,t,n){const r=ir(e),i=ze("orient",r,n);if(r.orient=dke(r.type,t,i),i!==void 0&&i!==r.orient&&q(V_e(r.orient,i)),r.type==="bar"&&r.orient){const s=ze("cornerRadiusEnd",r,n);if(s!==void 0){const u=r.orient==="horizontal"&&t.x2||r.orient==="vertical"&&t.y2?["cornerRadius"]:b$e[r.orient];for(const l of u)r[l]=s;r.cornerRadiusEnd!==void 0&&delete r.cornerRadiusEnd}}return ze("opacity",r,n)===void 0&&(r.opacity=cke(r.type,t)),ze("cursor",r,n)===void 0&&(r.cursor=lke(r,t,n)),r}function lke(e,t,n){return t.href||e.href||ze("href",e,n)?"pointer":e.cursor}function cke(e,t){if(ve([Hy,GC,YC,VC],e)&&!uO(t))return .7}function fke(e,t,{graticule:n}){if(n)return!1;const r=Pu("filled",e,t),i=e.type;return $t(r,i!==Hy&&i!==qy&&i!==Wy)}function dke(e,t,n){switch(e){case Hy:case YC:case VC:case oB:case c$e:case l$e:return}const{x:r,y:i,x2:o,y2:a}=t;switch(e){case Uy:if(Y(r)&&(Pn(r.bin)||Y(i)&&i.aggregate&&!r.aggregate))return"vertical";if(Y(i)&&(Pn(i.bin)||Y(r)&&r.aggregate&&!i.aggregate))return"horizontal";if(a||o){if(n)return n;if(!o&&(Y(r)&&r.type===ju&&!Qe(r.bin)||rO(r)))return"horizontal";if(!a&&(Y(i)&&i.type===ju&&!Qe(i.bin)||rO(i)))return"vertical"}case Wy:if(o&&!(Y(r)&&Pn(r.bin))&&a&&!(Y(i)&&Pn(i.bin)))return;case zy:if(a)return Y(i)&&Pn(i.bin)?"horizontal":"vertical";if(o)return Y(r)&&Pn(r.bin)?"vertical":"horizontal";if(e===Wy){if(r&&!i)return"vertical";if(i&&!r)return"horizontal"}case qy:case GC:{const s=$o(r),u=$o(i);if(n)return n;if(s&&!u)return e!=="tick"?"horizontal":"vertical";if(!s&&u)return e!=="tick"?"vertical":"horizontal";if(s&&u){const l=r,c=i,f=l.type===Pc,d=c.type===Pc;return f&&!d?e!=="tick"?"vertical":"horizontal":!f&&d?e!=="tick"?"horizontal":"vertical":!l.aggregate&&c.aggregate?e!=="tick"?"vertical":"horizontal":l.aggregate&&!c.aggregate&&e!=="tick"?"horizontal":"vertical"}else return}}return"vertical"}const hke={vgMark:"arc",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Kr(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),yn("x",e,{defaultPos:"mid"})),yn("y",e,{defaultPos:"mid"})),vs(e,"radius","arc")),vs(e,"theta","arc"))},gke={vgMark:"area",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Kr(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),mv("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"})),mv("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"})),LO(e))},pke={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Kr(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),vs(e,"x","bar")),vs(e,"y","bar"))},mke={vgMark:"shape",encodeEntry:e=>Object.assign({},Kr(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[Object.assign({type:"geoshape",projection:e.projectionName()},n&&Y(n)&&n.type===Lc?{field:G(n,{expr:"datum"})}:{})]}},yke={vgMark:"image",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Kr(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),vs(e,"x","image")),vs(e,"y","image")),RO(e,"url"))},vke={vgMark:"line",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Kr(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),yn("x",e,{defaultPos:"mid"})),yn("y",e,{defaultPos:"mid"})),qt("size",e,{vgChannel:"strokeWidth"})),LO(e))},bke={vgMark:"trail",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Kr(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),yn("x",e,{defaultPos:"mid"})),yn("y",e,{defaultPos:"mid"})),qt("size",e)),LO(e))};function _3(e,t){const{config:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Kr(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),yn("x",e,{defaultPos:"mid"})),yn("y",e,{defaultPos:"mid"})),qt("size",e)),qt("angle",e)),xke(e,n,t))}function xke(e,t,n){return n?{shape:{value:n}}:qt("shape",e)}const wke={vgMark:"symbol",encodeEntry:e=>_3(e)},_ke={vgMark:"symbol",encodeEntry:e=>_3(e,"circle")},Eke={vgMark:"symbol",encodeEntry:e=>_3(e,"square")},$ke={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Kr(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),vs(e,"x","rect")),vs(e,"y","rect"))},Ake={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude?{}:Object.assign(Object.assign(Object.assign(Object.assign({},Kr(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),mv("x",e,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"})),mv("y",e,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"})),qt("size",e,{vgChannel:"strokeWidth"}))}},Ske={vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Kr(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),yn("x",e,{defaultPos:"mid"})),yn("y",e,{defaultPos:"mid"})),RO(e)),qt("size",e,{vgChannel:"fontSize"})),qt("angle",e)),Qz("align",Cke(e.markDef,n,t))),Qz("baseline",Oke(e.markDef,n,t))),yn("radius",e,{defaultPos:null})),yn("theta",e,{defaultPos:null}))}};function Cke(e,t,n){if(ze("align",e,n)===void 0)return"center"}function Oke(e,t,n){if(ze("baseline",e,n)===void 0)return"middle"}const Fke={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,r=n.orient,i=r==="horizontal"?"width":"height",o=r==="horizontal"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Kr(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),yn("x",e,{defaultPos:"mid",vgChannel:"xc"})),yn("y",e,{defaultPos:"mid",vgChannel:"yc"})),qt("size",e,{defaultValue:kke(e),vgChannel:i})),{[o]:ot(ze("thickness",n,t))})}};function kke(e){var t;const{config:n,markDef:r}=e,{orient:i}=r,o=i==="horizontal"?"width":"height",a=e.getScaleComponent(i==="horizontal"?"x":"y"),s=(t=ze("size",r,n,{vgChannel:o}))!==null&&t!==void 0?t:n.tick.bandSize;if(s!==void 0)return s;{const u=a?a.get("range"):void 0;return u&&cs(u)&&Et(u.step)?u.step*3/4:cv(n.view,o)*3/4}}const qv={arc:hke,area:gke,bar:pke,circle:_ke,geoshape:mke,image:yke,line:vke,point:wke,rect:$ke,rule:Ake,square:Eke,text:Ske,tick:Fke,trail:bke};function Mke(e){if(ve([qy,zy,f$e],e.mark)){const t=zB(e.mark,e.encoding);if(t.length>0)return Dke(e,t)}else if(e.mark===Uy){const t=$C.some(n=>ze(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t)return Nke(e)}return E3(e)}const Fq="faceted_path_";function Dke(e,t){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:Fq+e.requestDataName(et.Main),data:e.requestDataName(et.Main),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:E3(e,{fromPrefix:Fq})}]}const kq="stack_group_";function Nke(e){const[t]=E3(e,{fromPrefix:kq}),n=e.scaleName(e.stack.fieldChannel),r=(l={})=>e.vgField(e.stack.fieldChannel,l),i=(l,c)=>{const f=[r({prefix:"min",suffix:"start",expr:c}),r({prefix:"max",suffix:"start",expr:c}),r({prefix:"min",suffix:"end",expr:c}),r({prefix:"max",suffix:"end",expr:c})];return`${l}(${f.map(d=>`scale('${n}',${d})`).join(",")})`};let o,a;e.stack.fieldChannel==="x"?(o=Object.assign(Object.assign({},Mc(t.encode.update,["y","yc","y2","height",...$C])),{x:{signal:i("min","datum")},x2:{signal:i("max","datum")},clip:{value:!0}}),a={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},t.encode.update=Object.assign(Object.assign({},Sr(t.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(o=Object.assign(Object.assign({},Mc(t.encode.update,["x","xc","x2","width"])),{y:{signal:i("min","datum")},y2:{signal:i("max","datum")},clip:{value:!0}}),a={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},t.encode.update=Object.assign(Object.assign({},Sr(t.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(const l of $C){const c=Pu(l,e.markDef,e.config);t.encode.update[l]?(o[l]=t.encode.update[l],delete t.encode.update[l]):c&&(o[l]=ot(c)),c&&(t.encode.update[l]={value:0})}const s=[];if(e.stack.groupbyChannel){const l=e.fieldDef(e.stack.groupbyChannel),c=G(l);c&&s.push(c),((l==null?void 0:l.bin)||(l==null?void 0:l.timeUnit))&&s.push(G(l,{binSuffix:"end"}))}return o=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((l,c)=>{if(t.encode.update[c])return Object.assign(Object.assign({},l),{[c]:t.encode.update[c]});{const f=Pu(c,e.markDef,e.config);return f!==void 0?Object.assign(Object.assign({},l),{[c]:ot(f)}):l}},o),o.stroke&&(o.strokeForeground={value:!0},o.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(et.Main),name:kq+e.requestDataName(et.Main),groupby:s,aggregate:{fields:[r({suffix:"start"}),r({suffix:"start"}),r({suffix:"end"}),r({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:o},marks:[{type:"group",encode:{update:a},marks:[t]}]}]}function Tke(e){var t;const{encoding:n,stack:r,mark:i,markDef:o,config:a}=e,s=n.order;if(!(!Z(s)&&Si(s)&&fC(s.value)||!s&&fC(ze("order",o,a)))){if((Z(s)||Y(s))&&!r)return CI(s,{expr:"datum"});if(fs(i)){const u=o.orient==="horizontal"?"y":"x",l=n[u];if(Y(l)){const c=l.sort;if(Z(c))return{field:G(l,{prefix:u,suffix:"sort_index",expr:"datum"})};if(Eo(c))return{field:G({aggregate:uO(e.encoding)?c.op:void 0,field:c.field},{expr:"datum"})};if(_B(c)){const f=e.fieldDef(c.encoding);return{field:G(f,{expr:"datum"}),order:c.order}}else return c===null?void 0:{field:G(l,{binSuffix:((t=e.stack)===null||t===void 0?void 0:t.impute)?"mid":void 0,expr:"datum"})}}return}}}function E3(e,t={fromPrefix:""}){const{mark:n,markDef:r,encoding:i,config:o}=e,a=$t(r.clip,Rke(e),Pke(e)),s=AI(r),u=i.key,l=Tke(e),c=Lke(e),f=ze("aria",r,o),d=qv[n].postEncodingTransform?qv[n].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:qv[n].vgMark},a?{clip:!0}:{}),s?{style:s}:{}),u?{key:u.field}:{}),l?{sort:l}:{}),c||{}),f===!1?{aria:f}:{}),{from:{data:t.fromPrefix+e.requestDataName(et.Main)},encode:{update:qv[n].encodeEntry(e)}}),d?{transform:d}:{})]}function Rke(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return t&&t.get("selectionExtent")||n&&n.get("selectionExtent")?!0:void 0}function Pke(e){const t=e.component.projection;return t&&!t.isFit?!0:void 0}function Lke(e){if(!e.component.selection)return null;const t=U(e.component.selection).length;let n=t,r=e.parent;for(;r&&n===0;)n=U(r.component.selection).length,r=r.parent;return n?{interactive:t>0||!!e.encoding.tooltip}:null}class Mq extends Eq{constructor(t,n,r,i={},o){var a;super(t,"unit",n,r,o,void 0,az(t)?t.view:void 0);this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[];const s=_o(t.mark)?Object.assign({},t.mark):{type:t.mark},u=s.type;s.filled===void 0&&(s.filled=fke(s,o,{graticule:t.data&&FO(t.data)}));const l=this.encoding=X$e(t.encoding||{},u,s.filled,o);this.markDef=uke(s,l,o),this.size=ske({encoding:l,size:az(t)?Object.assign(Object.assign(Object.assign({},i),t.width?{width:t.width}:{}),t.height?{height:t.height}:{}):i}),this.stack=gz(u,l),this.specifiedScales=this.initScales(u,l),this.specifiedAxes=this.initAxes(l),this.specifiedLegends=this.initLegends(l),this.specifiedProjection=t.projection,this.selection=((a=t.params)!==null&&a!==void 0?a:[]).filter(c=>vO(c))}get hasProjection(){const{encoding:t}=this,n=this.mark===aB,r=t&&Hwe.some(i=>fe(t[i]));return n||r}scaleDomain(t){const n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return Py.reduce((r,i)=>{var o;const a=Nt(n[i]);return a&&(r[i]=this.initScale((o=a.scale)!==null&&o!==void 0?o:{})),r},{})}initScale(t){const{domain:n,range:r}=t,i=ir(t);return Z(n)&&(i.domain=n.map(Cr)),Z(r)&&(i.range=r.map(Cr)),i}initAxes(t){return bo.reduce((n,r)=>{const i=t[r];if(fe(i)||r===ut&&fe(t.x2)||r===Mt&&fe(t.y2)){const o=fe(i)?i.axis:void 0;n[r]=o&&this.initAxis(Object.assign({},o))}return n},{})}initAxis(t){const n=U(t),r={};for(const i of n){const o=t[i];r[i]=_0(o)?_I(o):Cr(o)}return r}initLegends(t){return Qwe.reduce((n,r)=>{const i=Nt(t[r]);if(i&&t_e(r)){const o=i.legend;n[r]=o&&ir(o)}return n},{})}parseData(){this.component.data=Uv(this)}parseLayoutSize(){HFe(this)}parseSelections(){this.component.selection=FOe(this,this.selection)}parseMarkGroup(){this.component.mark=Mke(this)}parseAxesAndHeaders(){this.component.axes=QFe(this)}assembleSelectionTopLevelSignals(t){return zSe(this,t)}assembleSignals(){return[...FU(this),...ISe(this,[])]}assembleSelectionData(t){return USe(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return t3(this)}assembleMarks(){var t;let n=(t=this.component.mark)!==null&&t!==void 0?t:[];return(!this.parent||!tf(this.parent))&&(n=Uz(this,n)),n.map(this.correctDataNames)}assembleGroupStyle(){const{style:t}=this.view||{};if(t!==void 0)return t;if(this.encoding.x||this.encoding.y)return"cell"}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return Uu(this.encoding,t)}fieldDef(t){const n=this.encoding[t];return Ao(n)}typedFieldDef(t){const n=this.fieldDef(t);return Xr(n)?n:null}}class $3 extends v3{constructor(t,n,r,i,o){super(t,"layer",n,r,o,t.resolve,t.view);const a=Object.assign(Object.assign(Object.assign({},i),t.width?{width:t.width}:{}),t.height?{height:t.height}:{});this.children=t.layer.map((s,u)=>{if(fv(s))return new $3(s,this,this.getName(`layer_${u}`),a,o);if(fa(s))return new Mq(s,this,this.getName(`layer_${u}`),a,o);throw new Error(SC(s))})}parseData(){this.component.data=Uv(this);for(const t of this.children)t.parseData()}parseLayoutSize(){UFe(this)}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of U(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){tke(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),FU(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),t3(this))}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleGroupStyle(){const t=new Set;for(const r of this.children)for(const i of gt(r.assembleGroupStyle()))t.add(i);const n=Array.from(t);return n.length>1?n:n.length===1?n[0]:void 0}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return qSe(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),JU(this))}}function A3(e,t,n,r,i){if(Xy(e))return new H0(e,t,n,i);if(fv(e))return new $3(e,t,n,r,i);if(fa(e))return new Mq(e,t,n,r,i);if(xAe(e))return new XFe(e,t,n,i);throw new Error(SC(e))}var jke=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function Ike(e,t={}){t.logger&&bEe(t.logger),t.fieldTitle&&DB(t.fieldTitle);try{const n=dz(eI(t.config,e.config)),r=Fz(e,n),i=A3(r,null,"",void 0,n);return i.parse(),J3e(i.component.data,i),{spec:zke(i,Bke(e,r.autosize,n,i),e.datasets,e.usermeta),normalized:r}}finally{t.logger&&xEe(),t.fieldTitle&&I$e()}}function Bke(e,t,n,r){const i=r.component.layoutSize.get("width"),o=r.component.layoutSize.get("height");if(t===void 0?(t={type:"pad"},r.hasAxisOrientSignalRef()&&(t.resize=!0)):he(t)&&(t={type:t}),i&&o&&$Se(t.type)){if(i==="step"&&o==="step")q(NI()),t.type="pad";else if(i==="step"||o==="step"){const a=i==="step"?"width":"height";q(NI(Ry(a)));const s=a==="width"?"height":"width";t.type=ASe(s)}}return Object.assign(Object.assign(Object.assign({},U(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t}),Mz(n,!1)),Mz(e,!0))}function zke(e,t,n={},r){const i=e.config?RAe(e.config):void 0,o=[].concat(e.assembleSelectionData([]),jFe(e.component.data,n)),a=e.assembleProjections(),s=e.assembleTitle(),u=e.assembleGroupStyle(),l=e.assembleGroupEncodeEntry(!0);let c=e.assembleLayoutSignals();c=c.filter(h=>(h.name==="width"||h.name==="height")&&h.value!==void 0?(t[h.name]=+h.value,!1):!0);const{params:f}=t,d=jke(t,["params"]);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),d),s?{title:s}:{}),u?{style:u}:{}),l?{encode:{update:l}}:{}),{data:o}),a.length>0?{projections:a}:{}),e.assembleGroup([...c,...e.assembleSelectionTopLevelSignals([]),...oz(f)])),i?{config:i}:{}),r?{usermeta:r}:{})}const Uke=wwe.version;var qke=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",version:Uke,compile:Ike,normalize:Fz,deepEqual:co,duplicate:ge,pick:Mc,omit:Sr,stringify:Je,hash:Ce,isNullOrFalse:fC,contains:ve,some:Dc,every:dC,mergeDeep:nI,unique:fo,isEqual:jwe,setEqual:rI,hasIntersection:hC,prefixGenerator:gC,fieldIntersection:pC,isEmpty:Ge,keys:U,vals:pn,entries:es,isBoolean:s0,varName:it,logicalExpr:u0,deleteNestedProperty:Oy,titleCase:l0,accessPathWithDatum:mC,flatAccessWithDatum:iI,replacePathInField:Wr,replaceAll:Mu,removePathFromField:yC,accessPathDepth:Nc,getFirstDefined:$t,uniqueId:aI,resetIdCounter:Bwe,internalField:sI,isInternalField:uI,normalizeAngle:c0,isNumeric:Fy});function Dq(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}}var Hke="vega-themes",Wke="2.10.0",Gke="Themes for stylized Vega and Vega-Lite visualizations.",Yke=["vega","vega-lite","themes","style"],Vke="BSD-3-Clause",Xke={name:"UW Interactive Data Lab",url:"https://idl.cs.washington.edu"},Kke=[{name:"Emily Gu",url:"https://github.com/emilygu"},{name:"Arvind Satyanarayan",url:"http://arvindsatya.com"},{name:"Jeffrey Heer",url:"https://idl.cs.washington.edu"},{name:"Dominik Moritz",url:"https://www.domoritz.de"}],Zke="build/vega-themes.js",Jke="build/vega-themes.module.js",Qke="build/vega-themes.min.js",eMe="build/vega-themes.min.js",tMe="build/vega-themes.module.d.ts",nMe={type:"git",url:"https://github.com/vega/vega-themes.git"},rMe=["src","build"],iMe={prebuild:"yarn clean",build:"rollup -c",clean:"rimraf build && rimraf examples/build","copy:data":"rsync -r node_modules/vega-datasets/data/* examples/data","copy:build":"rsync -r build/* examples/build","deploy:gh":"yarn build && mkdir -p examples/build && rsync -r build/* examples/build && gh-pages -d examples",prepublishOnly:"yarn clean && yarn build",preversion:"yarn lint",serve:"browser-sync start -s -f build examples --serveStatic examples",start:"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'",prepare:"beemo create-config",eslintbase:"beemo eslint .",format:"yarn eslintbase --fix",lint:"yarn eslintbase"},oMe={"@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^11.2.0","@wessberg/rollup-plugin-ts":"^1.3.8","browser-sync":"^2.26.14",concurrently:"^6.0.0","gh-pages":"^3.1.0",rollup:"^2.39.1","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-terser":"^7.0.2",typescript:"^4.2.2",vega:"^5.19.1","vega-lite":"^5.0.0","vega-lite-dev-config":"^0.16.1"},aMe={vega:"*","vega-lite":"*"},sMe={name:Hke,version:Wke,description:Gke,keywords:Yke,license:Vke,author:Xke,contributors:Kke,main:Zke,module:Jke,unpkg:Qke,jsdelivr:eMe,types:tMe,repository:nMe,files:rMe,scripts:iMe,devDependencies:oMe,peerDependencies:aMe};const rf="#fff",uMe="#888",lMe={background:"#333",title:{color:rf,subtitleColor:rf},style:{"guide-label":{fill:rf},"guide-title":{fill:rf}},axis:{domainColor:rf,gridColor:uMe,tickColor:rf}},Zu="#4572a7",cMe={background:"#fff",arc:{fill:Zu},area:{fill:Zu},line:{stroke:Zu,strokeWidth:2},path:{stroke:Zu},rect:{fill:Zu},shape:{stroke:Zu},symbol:{fill:Zu,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},Ju="#30a2da",S3="#cbcbcb",fMe="#999",dMe="#333",Nq="#f0f0f0",Tq="#333",hMe={arc:{fill:Ju},area:{fill:Ju},axis:{domainColor:S3,grid:!0,gridColor:S3,gridWidth:1,labelColor:fMe,labelFontSize:10,titleColor:dMe,tickColor:S3,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:Nq,group:{fill:Nq},legend:{labelColor:Tq,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:Tq,titleFontSize:14,titlePadding:10},line:{stroke:Ju,strokeWidth:2},path:{stroke:Ju,strokeWidth:.5},rect:{fill:Ju},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:Ju},bar:{binSpacing:2,fill:Ju,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},Qu="#000",gMe={group:{fill:"#e5e5e5"},arc:{fill:Qu},area:{fill:Qu},line:{stroke:Qu},path:{stroke:Qu},rect:{fill:Qu},shape:{stroke:Qu},symbol:{fill:Qu,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},pMe=22,mMe="normal",Rq="Benton Gothic, sans-serif",Pq=11.5,yMe="normal",el="#82c6df",C3="Benton Gothic Bold, sans-serif",Lq="normal",jq=13,W0={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},vMe={background:"#ffffff",title:{anchor:"start",color:"#000000",font:C3,fontSize:pMe,fontWeight:mMe},arc:{fill:el},area:{fill:el},line:{stroke:el,strokeWidth:2},path:{stroke:el},rect:{fill:el},shape:{stroke:el},symbol:{fill:el,size:30},axis:{labelFont:Rq,labelFontSize:Pq,labelFontWeight:yMe,titleFont:C3,titleFontSize:jq,titleFontWeight:Lq},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:Rq,labelFontSize:Pq,symbolType:"square",titleFont:C3,titleFontSize:jq,titleFontWeight:Lq},range:{category:W0["category-6"],diverging:W0["fireandice-6"],heatmap:W0["fire-7"],ordinal:W0["fire-7"],ramp:W0["fire-7"]}},tl="#ab5787",Hv="#979797",bMe={background:"#f9f9f9",arc:{fill:tl},area:{fill:tl},line:{stroke:tl},path:{stroke:tl},rect:{fill:tl},shape:{stroke:tl},symbol:{fill:tl,size:30},axis:{domainColor:Hv,domainWidth:.5,gridWidth:.2,labelColor:Hv,tickColor:Hv,tickWidth:.2,titleColor:Hv},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},nl="#3e5c69",xMe={background:"#fff",arc:{fill:nl},area:{fill:nl},line:{stroke:nl},path:{stroke:nl},rect:{fill:nl},shape:{stroke:nl},symbol:{fill:nl},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},Zr="#1696d2",Iq="#000000",wMe="#FFFFFF",Wv="Lato",O3="Lato",_Me="Lato",EMe="#DEDDDD",$Me=18,G0={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},AMe={background:wMe,title:{anchor:"start",fontSize:$Me,font:Wv},axisX:{domain:!0,domainColor:Iq,domainWidth:1,grid:!1,labelFontSize:12,labelFont:O3,labelAngle:0,tickColor:Iq,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:Wv},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:EMe,gridWidth:1,labelFontSize:12,labelFont:O3,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:Wv,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:O3,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:Wv,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:G0["six-groups-cat-1"],diverging:G0["diverging-colors"],heatmap:G0["diverging-colors"],ordinal:G0["six-groups-seq"],ramp:G0["shades-blue"]},area:{fill:Zr},rect:{fill:Zr},line:{color:Zr,stroke:Zr,strokeWidth:5},trail:{color:Zr,stroke:Zr,strokeWidth:0,size:1},path:{stroke:Zr,strokeWidth:.5},point:{filled:!0},text:{font:_Me,color:Zr,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:Zr,stroke:null}},arc:{fill:Zr},shape:{stroke:Zr},symbol:{fill:Zr,size:30}},rl="#3366CC",Bq="#ccc",Gv="Arial, sans-serif",SMe={arc:{fill:rl},area:{fill:rl},path:{stroke:rl},rect:{fill:rl},shape:{stroke:rl},symbol:{stroke:rl},circle:{fill:rl},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:Gv,fontSize:12},"guide-title":{font:Gv,fontSize:12},"group-title":{font:Gv,fontSize:12}},title:{font:Gv,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:Bq,tickColor:Bq,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},CMe=sMe.version;var OMe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",dark:lMe,excel:cMe,fivethirtyeight:hMe,ggplot2:gMe,googlecharts:SMe,latimes:vMe,quartz:bMe,urbaninstitute:AMe,version:CMe,vox:xMe});/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function FMe(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function kMe(e,t,n){if(ee(e))return`[${e.map(r=>t(Me(r)?r:zq(r,n))).join(", ")}]`;if(le(e)){let r="";const i=e,{title:o,image:a}=i,s=FMe(i,["title","image"]);o&&(r+=`<h2>${t(o)}</h2>`),a&&(r+=`<img src="${t(a)}">`);const u=Object.keys(s);if(u.length>0){r+="<table>";for(const l of u){let c=s[l];c!==void 0&&(le(c)&&(c=zq(c,n)),r+=`<tr><td class="key">${t(l)}:</td><td class="value">${t(c)}</td></tr>`)}r+="</table>"}return r||"{}"}return t(e)}function MMe(e){const t=[];return function(n,r){if(typeof r!="object"||r===null)return r;const i=t.indexOf(this)+1;return t.length=i,t.length>e?"[Object]":t.indexOf(r)>=0?"[Circular]":(t.push(r),r)}}function zq(e,t){return JSON.stringify(e,MMe(t))}var DMe=`#vg-tooltip-element {
  visibility: hidden;
  padding: 8px;
  position: fixed;
  z-index: 1000;
  font-family: sans-serif;
  font-size: 11px;
  border-radius: 3px;
  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  /* The default theme is the light theme. */
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid #d9d9d9;
  color: black; }
  #vg-tooltip-element.visible {
    visibility: visible; }
  #vg-tooltip-element h2 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 13px; }
  #vg-tooltip-element img {
    max-width: 200px;
    max-height: 200px; }
  #vg-tooltip-element table {
    border-spacing: 0; }
    #vg-tooltip-element table tr {
      border: none; }
      #vg-tooltip-element table tr td {
        overflow: hidden;
        text-overflow: ellipsis;
        padding-top: 2px;
        padding-bottom: 2px; }
        #vg-tooltip-element table tr td.key {
          color: #808080;
          max-width: 150px;
          text-align: right;
          padding-right: 4px; }
        #vg-tooltip-element table tr td.value {
          display: block;
          max-width: 300px;
          max-height: 7em;
          text-align: left; }
  #vg-tooltip-element.dark-theme {
    background-color: rgba(32, 32, 32, 0.9);
    border: 1px solid #f5f5f5;
    color: white; }
    #vg-tooltip-element.dark-theme td.key {
      color: #bfbfbf; }
`;const Uq="vg-tooltip-element",NMe={offsetX:10,offsetY:10,id:Uq,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:TMe,maxDepth:2,formatTooltip:kMe};function TMe(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function RMe(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return DMe.toString().replace(Uq,e)}function PMe(e,t,n,r){let i=e.clientX+n;i+t.width>window.innerWidth&&(i=+e.clientX-n-t.width);let o=e.clientY+r;return o+t.height>window.innerHeight&&(o=+e.clientY-r-t.height),{x:i,y:o}}class LMe{constructor(t){this.options=Object.assign(Object.assign({},NMe),t);const n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const r=document.createElement("style");r.setAttribute("id",this.options.styleId),r.innerHTML=RMe(n);const i=document.head;i.childNodes.length>0?i.insertBefore(r,i.childNodes[0]):i.appendChild(r)}}tooltipHandler(t,n,r,i){var o;if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el)),((o=document.fullscreenElement)!==null&&o!==void 0?o:document.body).appendChild(this.el),i==null||i===""){this.el.classList.remove("visible",`${this.options.theme}-theme`);return}this.el.innerHTML=this.options.formatTooltip(i,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:s,y:u}=PMe(n,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${u}px; left: ${s}px`)}}function jMe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qq(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(l){n(l);return}s.done?t(u):Promise.resolve(u).then(r,i)}function Yv(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(u){qq(o,r,i,a,s,"next",u)}function s(u){qq(o,r,i,a,s,"throw",u)}a(void 0)})}}var Hq=Object.prototype,il=Hq.hasOwnProperty,ko,F3=typeof Symbol=="function"?Symbol:{},Vv=F3.iterator||"@@iterator",IMe=F3.asyncIterator||"@@asyncIterator",Xv=F3.toStringTag||"@@toStringTag";function Wq(e,t,n,r){var i=t&&t.prototype instanceof M3?t:M3,o=Object.create(i.prototype),a=new R3(r||[]);return o._invoke=HMe(e,n,a),o}function k3(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(r){return{type:"throw",arg:r}}}var Gq="suspendedStart",BMe="suspendedYield",Yq="executing",Kv="completed",Mi={};function M3(){}function Zv(){}function of(){}var D3={};D3[Vv]=function(){return this};var N3=Object.getPrototypeOf,Jv=N3&&N3(N3(P3([])));Jv&&Jv!==Hq&&il.call(Jv,Vv)&&(D3=Jv);var af=of.prototype=M3.prototype=Object.create(D3);Zv.prototype=af.constructor=of;of.constructor=Zv;of[Xv]=Zv.displayName="GeneratorFunction";function Vq(e){["next","throw","return"].forEach(function(t){e[t]=function(n){return this._invoke(t,n)}})}function Xq(e){var t=typeof e=="function"&&e.constructor;return t?t===Zv||(t.displayName||t.name)==="GeneratorFunction":!1}function zMe(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,of):(e.__proto__=of,Xv in e||(e[Xv]="GeneratorFunction")),e.prototype=Object.create(af),e}function UMe(e){return{__await:e}}function Qv(e,t){function n(o,a,s,u){var l=k3(e[o],e,a);if(l.type==="throw")u(l.arg);else{var c=l.arg,f=c.value;return f&&typeof f=="object"&&il.call(f,"__await")?t.resolve(f.__await).then(function(d){n("next",d,s,u)},function(d){n("throw",d,s,u)}):t.resolve(f).then(function(d){c.value=d,s(c)},function(d){return n("throw",d,s,u)})}}var r;function i(o,a){function s(){return new t(function(u,l){n(o,a,u,l)})}return r=r?r.then(s,s):s()}this._invoke=i}Vq(Qv.prototype);Qv.prototype[IMe]=function(){return this};function qMe(e,t,n,r,i){i===void 0&&(i=Promise);var o=new Qv(Wq(e,t,n,r),i);return Xq(t)?o:o.next().then(function(a){return a.done?a.value:o.next()})}function HMe(e,t,n){var r=Gq;return function(o,a){if(r===Yq)throw new Error("Generator is already running");if(r===Kv){if(o==="throw")throw a;return Zq()}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=Kq(s,n);if(u){if(u===Mi)continue;return u}}if(n.method==="next")n.sent=n._sent=n.arg;else if(n.method==="throw"){if(r===Gq)throw r=Kv,n.arg;n.dispatchException(n.arg)}else n.method==="return"&&n.abrupt("return",n.arg);r=Yq;var l=k3(e,t,n);if(l.type==="normal"){if(r=n.done?Kv:BMe,l.arg===Mi)continue;return{value:l.arg,done:n.done}}else l.type==="throw"&&(r=Kv,n.method="throw",n.arg=l.arg)}}}function Kq(e,t){var n=e.iterator[t.method];if(n===ko){if(t.delegate=null,t.method==="throw"){if(e.iterator.return&&(t.method="return",t.arg=ko,Kq(e,t),t.method==="throw"))return Mi;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return Mi}var r=k3(n,e.iterator,t.arg);if(r.type==="throw")return t.method="throw",t.arg=r.arg,t.delegate=null,Mi;var i=r.arg;if(!i)return t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,Mi;if(i.done)t[e.resultName]=i.value,t.next=e.nextLoc,t.method!=="return"&&(t.method="next",t.arg=ko);else return i;return t.delegate=null,Mi}Vq(af);af[Xv]="Generator";af[Vv]=function(){return this};af.toString=function(){return"[object Generator]"};function WMe(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T3(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function R3(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(WMe,this),this.reset(!0)}function GMe(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function r(){for(;t.length;){var i=t.pop();if(i in e)return r.value=i,r.done=!1,r}return r.done=!0,r}}function P3(e){if(e){var t=e[Vv];if(t)return t.call(e);if(typeof e.next=="function")return e;if(!isNaN(e.length)){var n=-1,r=function i(){for(;++n<e.length;)if(il.call(e,n))return i.value=e[n],i.done=!1,i;return i.value=ko,i.done=!0,i};return r.next=r}}return{next:Zq}}function Zq(){return{value:ko,done:!0}}R3.prototype={constructor:R3,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=ko,this.done=!1,this.delegate=null,this.method="next",this.arg=ko,this.tryEntries.forEach(T3),!t)for(var n in this)n.charAt(0)==="t"&&il.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=ko)},stop:function(){this.done=!0;var t=this.tryEntries[0],n=t.completion;if(n.type==="throw")throw n.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(l,c){return a.type="throw",a.arg=t,n.next=l,c&&(n.method="next",n.arg=ko),!!c}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if(o.tryLoc==="root")return r("end");if(o.tryLoc<=this.prev){var s=il.call(o,"catchLoc"),u=il.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else if(u){if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(t,n){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&il.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&(t==="break"||t==="continue")&&o.tryLoc<=n&&n<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=n,o?(this.method="next",this.next=o.finallyLoc,Mi):this.complete(a)},complete:function(t,n){if(t.type==="throw")throw t.arg;return t.type==="break"||t.type==="continue"?this.next=t.arg:t.type==="return"?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):t.type==="normal"&&n&&(this.next=n),Mi},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T3(r),Mi}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc===t){var i=r.completion;if(i.type==="throw"){var o=i.arg;T3(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:P3(t),resultName:n,nextLoc:r},this.method==="next"&&(this.arg=ko),Mi}};var Es={wrap:Wq,isGeneratorFunction:Xq,AsyncIterator:Qv,mark:zMe,awrap:UMe,async:qMe,keys:GMe,values:P3};function YMe(e,t,n){var r=e.open(t),i=1e4,o=250,a=new URL(t),s=a.origin,u=~~(i/o);function l(f){f.source===r&&(u=0,e.removeEventListener("message",l,!1))}e.addEventListener("message",l,!1);function c(){u<=0||(r.postMessage(n,s),setTimeout(c,o),u-=1)}setTimeout(c,o)}var VMe=`.vega-embed {
  position: relative;
  display: inline-block;
  box-sizing: border-box; }
  .vega-embed.has-actions {
    padding-right: 38px; }
  .vega-embed details:not([open]) > :not(summary) {
    display: none !important; }
  .vega-embed summary {
    list-style: none;
    position: absolute;
    top: 0;
    right: 0;
    padding: 6px;
    z-index: 1000;
    background: white;
    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
    color: #1b1e23;
    border: 1px solid #aaa;
    border-radius: 999px;
    opacity: 0.2;
    transition: opacity 0.4s ease-in;
    outline: none;
    cursor: pointer;
    line-height: 0px; }
    .vega-embed summary::-webkit-details-marker {
      display: none; }
    .vega-embed summary:active {
      box-shadow: #aaa 0px 0px 0px 1px inset; }
    .vega-embed summary svg {
      width: 14px;
      height: 14px; }
  .vega-embed details[open] summary {
    opacity: 0.7; }
  .vega-embed:hover summary,
  .vega-embed:focus summary {
    opacity: 1 !important;
    transition: opacity 0.2s ease; }
  .vega-embed .vega-actions {
    position: absolute;
    z-index: 1001;
    top: 35px;
    right: -9px;
    display: flex;
    flex-direction: column;
    padding-bottom: 8px;
    padding-top: 8px;
    border-radius: 4px;
    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
    border: 1px solid #d9d9d9;
    background: white;
    animation-duration: 0.15s;
    animation-name: scale-in;
    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
    text-align: left; }
    .vega-embed .vega-actions a {
      padding: 8px 16px;
      font-family: sans-serif;
      font-size: 14px;
      font-weight: 600;
      white-space: nowrap;
      color: #434a56;
      text-decoration: none; }
      .vega-embed .vega-actions a:hover {
        background-color: #f7f7f9;
        color: black; }
    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
      content: "";
      display: inline-block;
      position: absolute; }
    .vega-embed .vega-actions::before {
      left: auto;
      right: 14px;
      top: -16px;
      border: 8px solid #0000;
      border-bottom-color: #d9d9d9; }
    .vega-embed .vega-actions::after {
      left: auto;
      right: 15px;
      top: -14px;
      border: 7px solid #0000;
      border-bottom-color: #fff; }
  .vega-embed .chart-wrapper.fit-x {
    width: 100%; }
  .vega-embed .chart-wrapper.fit-y {
    height: 100%; }

.vega-embed-wrapper {
  max-width: 100%;
  overflow: auto;
  padding-right: 14px; }

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6); }
  to {
    opacity: 1;
    transform: scale(1); } }
`;String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e});function Jq(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var i=0,o=n;i<o.length;i++){var a=o[i];XMe(e,a)}return e}function XMe(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var i=r[n];Df(e,i,t[i],!0)}}var L3;function Qq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function $s(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Qq(Object(n),!0).forEach(function(r){jMe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var As=U2e,Y0=qke,eb=typeof window!="undefined"?window:void 0;Y0===void 0&&eb!==null&&eb!==void 0&&(L3=eb.vl)!==null&&L3!==void 0&&L3.compile&&(Y0=eb.vl);var KMe={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},ZMe={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},V0={vega:"Vega","vega-lite":"Vega-Lite"},tb={vega:As.version,"vega-lite":Y0?Y0.version:"not available"},JMe={vega:e=>e,"vega-lite":(e,t)=>Y0.compile(e,{config:t}).spec},QMe=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,eDe="chart-wrapper";function tDe(e){return typeof e=="function"}function eH(e,t,n,r){var i="<html><head>".concat(t,'</head><body><pre><code class="json">'),o="</code></pre>".concat(n,"</body></html>"),a=window.open("");a.document.write(i+e+o),a.document.title="".concat(V0[r]," JSON Source")}function nDe(e,t){if(e.$schema){var n=Dq(e.$schema);if(t&&t!==n.library){var r;console.warn("The given visualization spec is written in ".concat(V0[n.library],", but mode argument sets ").concat((r=V0[t])!==null&&r!==void 0?r:t,"."))}var i=n.library;return iM.satisfies(tb[i],"^".concat(n.version.slice(1)))||console.warn("The input spec uses ".concat(V0[i]," ").concat(n.version,", but the current version of ").concat(V0[i]," is v").concat(tb[i],".")),i}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":t!=null?t:"vega"}function rDe(e){return!!(e&&"load"in e)}function tH(e){return rDe(e)?e:As.loader(e)}function nH(e){var t;return(t=e.usermeta&&e.usermeta.embedOptions)!==null&&t!==void 0?t:{}}function fDe(e,t){return j3.apply(this,arguments)}function j3(){return j3=Yv(Es.mark(function e(t,n){var r,i,o,a,s,u,l,c,f,d,h=arguments;return Es.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(o=h.length>2&&h[2]!==void 0?h[2]:{},!Me(n)){p.next=10;break}return s=tH(o.loader),p.t0=JSON,p.next=6,s.load(n);case 6:p.t1=p.sent,a=p.t0.parse.call(p.t0,p.t1),p.next=11;break;case 10:a=n;case 11:return u=nH(a).loader,(!s||u)&&(s=tH((l=o.loader)!==null&&l!==void 0?l:u)),p.next=15,rH(nH(a),s);case 15:return c=p.sent,p.next=18,rH(o,s);case 18:return f=p.sent,d=$s($s({},Jq(f,c)),{},{config:Ug((r=f.config)!==null&&r!==void 0?r:{},(i=c.config)!==null&&i!==void 0?i:{})}),p.next=22,oDe(t,a,d,s);case 22:return p.abrupt("return",p.sent);case 23:case"end":return p.stop()}},e)})),j3.apply(this,arguments)}function rH(e,t){return I3.apply(this,arguments)}function I3(){return I3=Yv(Es.mark(function e(t,n){var r,i,o;return Es.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!Me(t.config)){s.next=8;break}return s.t1=JSON,s.next=4,n.load(t.config);case 4:s.t2=s.sent,s.t0=s.t1.parse.call(s.t1,s.t2),s.next=9;break;case 8:s.t0=(r=t.config)!==null&&r!==void 0?r:{};case 9:if(i=s.t0,!Me(t.patch)){s.next=18;break}return s.t4=JSON,s.next=14,n.load(t.patch);case 14:s.t5=s.sent,s.t3=s.t4.parse.call(s.t4,s.t5),s.next=19;break;case 18:s.t3=t.patch;case 19:return o=s.t3,s.abrupt("return",$s($s($s({},t),o?{patch:o}:{}),i?{config:i}:{}));case 21:case"end":return s.stop()}},e)})),I3.apply(this,arguments)}function iDe(e){var t=e.getRootNode?e.getRootNode():document;if(t instanceof ShadowRoot)return{root:t,rootContainer:t};var n;return{root:document,rootContainer:(n=document.head)!==null&&n!==void 0?n:document.body}}function oDe(e,t){return B3.apply(this,arguments)}function B3(){return B3=Yv(Es.mark(function e(t,n){var r,i,o,a,s,u,l,c,f,d,h,g,p,m,y,v,b,x,w,E,_,S,C,O,$,M,F,N,A,k,T,L,z,Q,oe,ue,ce,xe,_e,Wt,ur,Bn,P,W,V,D,Ee,X,ke,$e=arguments;return Es.wrap(function(kr){for(;;)switch(kr.prev=kr.next){case 0:if(ke=function(){ue&&document.removeEventListener("click",ue),k.finalize()},c=$e.length>2&&$e[2]!==void 0?$e[2]:{},f=$e.length>3?$e[3]:void 0,d=c.theme?Ug(OMe[c.theme],(r=c.config)!==null&&r!==void 0?r:{}):c.config,h=$x(c.actions)?c.actions:Jq({},KMe,(i=c.actions)!==null&&i!==void 0?i:{}),g=$s($s({},ZMe),c.i18n),p=(o=c.renderer)!==null&&o!==void 0?o:"canvas",m=(a=c.logLevel)!==null&&a!==void 0?a:As.Warn,y=(s=c.downloadFileName)!==null&&s!==void 0?s:"visualization",v=typeof t=="string"?document.querySelector(t):t,v){kr.next=12;break}throw new Error("".concat(t," does not exist"));case 12:return c.defaultStyle!==!1&&(b="vega-embed-style",x=iDe(v),w=x.root,E=x.rootContainer,w.getElementById(b)||(_=document.createElement("style"),_.id=b,_.innerText=c.defaultStyle===void 0||c.defaultStyle===!0?VMe.toString():c.defaultStyle,E.appendChild(_))),S=nDe(n,c.mode),C=JMe[S](n,d),S==="vega-lite"&&C.$schema&&(O=Dq(C.$schema),iM.satisfies(tb.vega,"^".concat(O.version.slice(1)))||console.warn("The compiled spec uses Vega ".concat(O.version,", but current version is v").concat(tb.vega,"."))),v.classList.add("vega-embed"),h&&v.classList.add("has-actions"),v.innerHTML="",$=v,h&&(M=document.createElement("div"),M.classList.add(eDe),v.appendChild(M),$=M),F=c.patch,F&&(F instanceof Function?C=F(C):C=Sg(C,F,!0,!1).newDocument),c.formatLocale&&As.formatLocale(c.formatLocale),c.timeFormatLocale&&As.timeFormatLocale(c.timeFormatLocale),N=c.ast,A=As.parse(C,S==="vega-lite"?{}:d,{ast:N}),k=new(c.viewClass||As.View)(A,$s({loader:f,logLevel:m,renderer:p},N?{expr:(u=(l=As.expressionInterpreter)!==null&&l!==void 0?l:c.expr)!==null&&u!==void 0?u:J2e}:{})),k.addSignalListener("autosize",(Di,zn)=>{var lr=zn.type;lr=="fit-x"?($.classList.add("fit-x"),$.classList.remove("fit-y")):lr=="fit-y"?($.classList.remove("fit-x"),$.classList.add("fit-y")):lr=="fit"?$.classList.add("fit-x","fit-y"):$.classList.remove("fit-x","fit-y")}),c.tooltip!==!1&&(tDe(c.tooltip)?T=c.tooltip:T=new LMe(c.tooltip===!0?{}:c.tooltip).call,k.tooltip(T)),L=c.hover,L===void 0&&(L=S==="vega"),L&&(z=typeof L=="boolean"?{}:L,Q=z.hoverSet,oe=z.updateSet,k.hover(Q,oe)),c&&(c.width!=null&&k.width(c.width),c.height!=null&&k.height(c.height),c.padding!=null&&k.padding(c.padding)),kr.next=36,k.initialize($,c.bind).runAsync();case 36:if(h!==!1){if(ce=v,c.defaultStyle!==!1&&(xe=document.createElement("details"),xe.title=g.CLICK_TO_VIEW_ACTIONS,v.append(xe),ce=xe,_e=document.createElement("summary"),_e.innerHTML=QMe,xe.append(_e),ue=Di=>{xe.contains(Di.target)||xe.removeAttribute("open")},document.addEventListener("click",ue)),Wt=document.createElement("div"),ce.append(Wt),Wt.classList.add("vega-actions"),h===!0||h.export!==!1)for(ur=function(){var zn=P[Bn];if(h===!0||h.export===!0||h.export[zn]){var lr=g["".concat(zn.toUpperCase(),"_ACTION")],ol=document.createElement("a");ol.text=lr,ol.href="#",ol.target="_blank",ol.download="".concat(y,".").concat(zn),ol.addEventListener("mousedown",function(){var iH=Yv(Es.mark(function z3(oH){var U3;return Es.wrap(function(sf){for(;;)switch(sf.prev=sf.next){case 0:return oH.preventDefault(),sf.next=3,k.toImageURL(zn,c.scaleFactor);case 3:U3=sf.sent,this.href=U3;case 5:case"end":return sf.stop()}},z3,this)}));return function(z3){return iH.apply(this,arguments)}}()),Wt.append(ol)}},Bn=0,P=["svg","png"];Bn<P.length;Bn++)ur();(h===!0||h.source!==!1)&&(W=document.createElement("a"),W.text=g.SOURCE_ACTION,W.href="#",W.addEventListener("click",function(Di){var zn,lr;eH(tx(n),(zn=c.sourceHeader)!==null&&zn!==void 0?zn:"",(lr=c.sourceFooter)!==null&&lr!==void 0?lr:"",S),Di.preventDefault()}),Wt.append(W)),S==="vega-lite"&&(h===!0||h.compiled!==!1)&&(V=document.createElement("a"),V.text=g.COMPILED_ACTION,V.href="#",V.addEventListener("click",function(Di){var zn,lr;eH(tx(C),(zn=c.sourceHeader)!==null&&zn!==void 0?zn:"",(lr=c.sourceFooter)!==null&&lr!==void 0?lr:"","vega"),Di.preventDefault()}),Wt.append(V)),(h===!0||h.editor!==!1)&&(Ee=(D=c.editorUrl)!==null&&D!==void 0?D:"https://vega.github.io/editor/",X=document.createElement("a"),X.text=g.EDITOR_ACTION,X.href="#",X.addEventListener("click",function(Di){YMe(window,Ee,{config:d,mode:S,renderer:p,spec:tx(n)}),Di.preventDefault()}),Wt.append(X))}return kr.abrupt("return",{view:k,spec:n,vgSpec:C,finalize:ke});case 38:case"end":return kr.stop()}},e)})),B3.apply(this,arguments)}export{fDe as e,lDe as i,uDe as j,BV as l,cDe as m,sDe as s};
