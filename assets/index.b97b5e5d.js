const w=function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))c(e);new MutationObserver(e=>{for(const a of e)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&c(s)}).observe(document,{childList:!0,subtree:!0});function n(e){const a={};return e.integrity&&(a.integrity=e.integrity),e.referrerpolicy&&(a.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?a.credentials="include":e.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function c(e){if(e.ep)return;e.ep=!0;const a=n(e);fetch(e.href,a)}};w();var k=650,A=400,N=1,u=26e4,S=["Debris and open burning","Arson/incendiarism","Equipment and vehicle use","Recreation and ceremony","Misuse of fire by a minor","Smoking","Railroad operations and maintenance","Power generation/transmission/distribution","Fireworks","Other causes","Firearms and explosives use"],p=d3.geoMercator().center([-96,37]).scale(588).translate([k/2,A/2]),L=new Date("2000-01-01"),I=new Date("2018-12-31"),g=d3.timeFormat("%Y"),C=d3.timeFormat("%b %Y");d3.timeParse("%m/%d/%y");var o=d3.scaleTime().domain([L,I]).range([0,600]).clamp(!0),R=d3.scaleOrdinal().domain(S).range(d3.schemeSet2),m=2018,i=d3.scaleLinear().domain([N,u]).range([2,25]);d3.csv("assets/firedata.csv").then(v=>{d3.json("assets/geojson/USA.geojson").then(function(l){var n=d3.select("#my_dataviz").append("svg").attr("width",k).attr("height",A);n.append("g").selectAll("path").data(l.features).enter().append("path").attr("fill","#b8b8b8").attr("d",d3.geoPath().projection(p)).style("stroke","black").style("opacity",.3);var c=d3.select("#slider").append("svg").attr("width",650).attr("height",50),e=c.append("g").attr("class","slider").attr("transform","translate("+10+","+50/4+")");e.append("line").attr("class","track").attr("x1",o.range()[0]).attr("x2",o.range()[1]).select(function(){return this.parentNode.appendChild(this.cloneNode(!0))}).attr("class","track-inset").select(function(){return this.parentNode.appendChild(this.cloneNode(!0))}).attr("class","track-overlay").call(d3.drag().on("start.interrupt",function(){e.interrupt()}).on("start drag",function(){D(o.invert(d3.event.x),v)})),e.append("g",".track-overlay").attr("class","ticks").attr("transform","translate(0,"+18+")").selectAll("text").data(o.ticks(10)).enter().append("text").attr("x",o).attr("y",10).attr("text-anchor","middle").text(function(t){return g(t)});var a=e.insert("circle",".track-overlay").attr("class","handle").attr("r",9),s=e.append("text").attr("class","label").attr("text-anchor","middle").text(C(L)).attr("transform","translate(0,"+-25+")");function D(t,x){a.attr("cx",o(t)),s.attr("x",o(t)),console.log("In the update function"),console.log(g(t)),m=g(t),console.log("Table before filter"),console.log(x.slice(0,15));var b=x.filter(function(r){return r.FIRE_YEAR==m});console.log("Table after filter"),console.log(b.slice(0,15)),console.log("In the DrawData function"),console.log(m);var E=n.selectAll("circle").data(b);E.enter().append("circle").attr("class",r=>r.NWCG_GENERAL_CAUSE).attr("cx",function(r){return p([r.LONGITUDE,r.LATITUDE])[0]}).attr("cy",function(r){return p([r.LONGITUDE,r.LATITUDE])[1]}).attr("r",function(r){return i(r.FIRE_SIZE)}).style("fill",function(r){return R(r.NWCG_GENERAL_CAUSE)}).attr("stroke",function(r){return R(r.NWCG_GENERAL_CAUSE)}).attr("stroke-width",3).attr("fill-opacity",.4),E.exit().remove()}var f=[N,u/2,u],h=50,y=100,d=380;n.selectAll("legend").data(f).enter().append("circle").attr("cx",h).attr("cy",function(t){return d-i(t)}).attr("r",function(t){return i(t)}).style("fill","none").attr("stroke","black"),n.selectAll("legend").data(f).enter().append("line").attr("x1",function(t){return h+i(t)}).attr("x2",y).attr("y1",function(t){return d-i(t)*1.5}).attr("y2",function(t){return d-i(t)*1.5}).attr("stroke","black").style("stroke-dasharray","2,2"),n.selectAll("legend").data(f).enter().append("text").attr("x",y).attr("y",function(t){return d-i(t)*1.5}).text(function(t){return t==u?t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" acres":t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}).style("font-size",12).attr("alignment-baseline","middle")})});
