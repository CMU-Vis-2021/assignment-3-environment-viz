import*as e from"https://unpkg.com/d3?module";const j=function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))u(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const h of o.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&u(h)}).observe(document,{childList:!0,subtree:!0});function g(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerpolicy&&(o.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?o.credentials="include":r.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function u(r){if(r.ep)return;r.ep=!0;const o=g(r);fetch(r.href,o)}};j();var k=650,x=400,U=450,L=250,f={top:20,right:30,bottom:100,left:130},y="2000",D=["#7c0202","#b64d24","#b86213","#e18820","#de9b10","#f3c523","#7c5201","#fac45a","#fd860b","#ffdc6c","#ff4901","#a43407"],G=["0","1","2","3","4","5","6","7","8","9","10","11"],V=["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virgina","Washington","West Virginia","Wisconsin","Wyoming"],B=1,E=26e4,N=e.geoMercator().center([-96,37]).scale(588).translate([k/2,x/2]),v=e.select("#my_dataviz").append("div").attr("class","tooltip").style("opacity",0).style("background-color","white").style("border","solid").style("border-width","2px").style("border-radius","5px").style("padding","5px"),i=e.select("#my_dataviz").append("svg").attr("width",k).attr("height",x),A=e.scaleOrdinal().domain(G).range(D),s=e.scaleLinear().domain([B,E]).range([2,25]);e.csv("assets/firesfinaldata.csv").then(b=>{e.json("assets/geojson/USA.geojson").then(function(c){i.append("g").selectAll("path").data(c.features).enter().append("path").attr("fill","#b8b8b8").attr("d",e.geoPath().projection(N)).style("stroke","black").style("opacity",.3),i.selectAll("myCircles").data(b).enter().append("circle").attr("class",t=>"year"+t.FIRE_YEAR+" dataCircles val"+t.VALUE+""+t.FIRE_YEAR).attr("cx",function(t){return N([t.LONGITUDE,t.LATITUDE])[0]}).attr("cy",function(t){return N([t.LONGITUDE,t.LATITUDE])[1]}).attr("r",function(t){return s(t.FIRE_SIZE)}).style("fill",function(t){return A(t.VALUE)}).attr("stroke",function(t){return A(t.VALUE)}).attr("stroke-width",3).attr("fill-opacity",.4).on("mouseover",function(t,n){v.style("opacity",1),v.style("display","block")}).on("mousemove",function(t,n){v.html("Fire year: "+n.FIRE_YEAR+"<br>Acres burned: "+n.FIRE_SIZE+"<br>Cause of fire: "+n.NWCG_GENERAL_CAUSE+"<br>State: "+n.STATE+"<br>County: "+n.FIPS_NAME).style("left",t.x+30+"px").style("top",t.y-30+"px")}).on("mouseleave",function(t,n){v.style("opacity",0),v.style("display","none")});var g=e.select("#my_dataviz").append("svg").attr("width",U+f.left+f.right).attr("height",L+f.top+f.bottom).append("g").attr("transform","translate("+f.left+","+f.top+")"),u=e.scaleLinear().range([0,U]);const r=g.append("g").attr("transform","translate(0,"+L+")");var o=e.scaleBand().range([0,L]).padding(.1);const h=g.append("g");function R(t){let n=b.filter(function(a){return a.FIRE_YEAR==t});o.domain(n.map(function(a){return a.NWCG_GENERAL_CAUSE})),h.transition().duration(1e3).call(e.axisLeft(o)),u.domain([0,e.max(n,function(a){return a.FIRE_SIZE})]),r.transition().duration(1e3).call(e.axisBottom(u));var l=g.selectAll("rect").data(n);l.join("rect").transition().duration(1e3).attr("class",function(a){return"fire"+a.FIRE_SIZE}).attr("x",u(0)).attr("y",a=>o(a.NWCG_GENERAL_CAUSE)).attr("width",a=>u(a.FIRE_SIZE)).attr("height",o.bandwidth()).style("fill",function(a){return A(a.VALUE)}).attr("stroke",function(a){return A(a.VALUE)}).attr("stroke-width",3).attr("fill-opacity",.4)}R(2e3);function w(){e.selectAll(".slider").each(function(t){let l=e.select(this).property("value"),a="year"+l;y=l,R(y);let d=document.getElementsByClassName("button");for(let p=0;p<=d.length-1;p++)d[p].classList.remove("active");i.selectAll(".dataCircles").transition().duration(1e3).style("opacity",0).attr("r",0),i.selectAll("."+a).transition().duration(1e3).style("opacity",1).attr("r",function(p){return s(p.FIRE_SIZE)})})}function O(t){e.selectAll(".checkbox").each(function(n){let l=e.select(this);console.log(l);let a=l.property("value"),d="val"+a;console.log("group"),console.log(d),console.log("map year"),console.log(y),l.property("checked")?(console.log("SELECTED","."+d+""+y),i.selectAll("."+d+""+y).transition().duration(1e3).style("opacity",1).attr("r",function(p){return s(p.FIRE_SIZE)})):(console.log("NOT SELECTED"),i.selectAll("."+d+""+y).transition().duration(1e3).style("opacity",0).attr("r",0))})}e.selectAll(".slider").on("change",w),e.selectAll(".checkbox").on("change",O),w();var I=[B,E/2,E],C=50,_=100,m=380;i.selectAll("legend").data(I).enter().append("circle").attr("cx",C).attr("cy",function(t){return m-s(t)}).attr("r",function(t){return s(t)}).style("fill","none").attr("stroke","black"),i.selectAll("legend").data(I).enter().append("line").attr("x1",function(t){return C+s(t)}).attr("x2",_).attr("y1",function(t){return m-s(t)*1.5}).attr("y2",function(t){return m-s(t)*1.5}).attr("stroke","black").style("stroke-dasharray","2,2"),i.selectAll("legend").data(I).enter().append("text").attr("x",_).attr("y",function(t){return m-s(t)*1.5}).text(function(t){return t==E?t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" acres":t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}).style("font-size",12).attr("alignment-baseline","middle");var M=e.select("#state").append("svg").attr("width",440).attr("height",300);e.select("#stateSelect").selectAll("myStates").data(V).enter().append("option").text(function(t){return t}).attr("value",function(t){return t});var T=e.geoMercator().center([-86,27]).scale(200).translate([k/2,x/2]);console.log(c.features),state.features=c.features.filter(function(t){return t.properties.NAME=="Alabama"}),console.log(state.features);var S=M.selectAll("path").data(state.features);S.join("path").transition().duration(1e3).attr("fill","#b8b8b8").attr("d",e.geoPath().projection(T)).style("stroke","black").style("opacity",.3);function F(t){state.features=c.features.filter(function(n){return n.properties.NAME==t}),S=M.selectAll("path").data(state.features),S.join("path").transition().duration(1e3).attr("fill","#b8b8b8").attr("d",e.geoPath().projection(T)).style("stroke","black").style("opacity",.3)}F("Alabama"),e.select("#stateSelect").on("change",function(t,n){const l=e.select(this).property("value");console.log(n),console.log(t),F(l)})})});var P=document.getElementById("yearShown");myRange.oninput=function(){P.innerHTML=this.value};
