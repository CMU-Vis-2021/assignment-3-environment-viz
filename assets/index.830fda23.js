import*as e from"https://unpkg.com/d3?module";const B=function(){const f=document.createElement("link").relList;if(f&&f.supports&&f.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))y(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const v of i.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&y(v)}).observe(document,{childList:!0,subtree:!0});function m(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function y(o){if(o.ep)return;o.ep=!0;const i=m(o);fetch(o.href,i)}};B();var b=650,T=400,F=450,L=250,h={top:20,right:30,bottom:100,left:130},A="2000",G=["#7c0202","#b64d24","#b86213","#e18820","#de9b10","#f3c523","#7c5201","#fac45a","#fd860b","#ffdc6c","#ff4901","#a43407"],Y=["0","1","2","3","4","5","6","7","8","9","10","11"],C={Alabama:"AL",Alaska:"AK",Arizona:"AZ",Arkansas:"AR",California:"CA",Colorado:"CO",Connecticut:"CT",Delaware:"DE",Florida:"FL",Georgia:"GA",Hawaii:"HI",Idaho:"ID",Illinois:"IL",Indiana:"IN",Iowa:"IA",Kansas:"KS",Kentucky:"KY",Louisiana:"LA",Maine:"ME",Maryland:"MD",Massachusetts:"MA",Michigan:"MI",Minnesota:"MN",Mississippi:"MS",Missouri:"MO",MT:"Montana",NE:"Nebraska",NV:"Nevada",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",NY:"New York",NC:"North Carolina",ND:"North Dakota",OH:"Ohio",OK:"Oklahoma",OR:"Oregon",PA:"Pennsylvania",RI:"Rhode Island",SC:"South Carolina",SD:"South Dakota",TN:"Tennessee",Texas:"TX",UT:"Utah",VT:"Vermont",VA:"Virgina",WA:"Washington",WV:"West Virginia",WI:"Wisconsin",WY:"Wyoming"},P=["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virgina","Washington","West Virginia","Wisconsin","Wyoming"],E={Alabama:[-85,30,1e3],Alaska:[-150,60,400],Arizona:[-107,32,1e3],Arkansas:[-90,30,1e3],California:[-113,34,1e3],Colorado:[],Connecticut:[],Delaware:[],Florida:[],Georgia:[],Hawaii:[],Idaho:[],Illinois:[],Indiana:[],Iowa:[],Kansas:[],Kentucky:[],Louisiana:[],Maine:[],Maryland:[],Massachusetts:[],Michigan:[],Minnesota:[],Mississippi:[],Missouri:[],Montana:[],Nebraska:[],Nevada:[-115,35,1e3],"New Hampshire":[],"New Jersey":[],"New Mexico":[-103,30,1e3],"New York":[],"North Carolina":[],"North Dakota":[],Ohio:[],Oklahoma:[],Oregon:[],Pennsylvania:[],"Rhode Island":[],"South Carolina":[],"South Dakota":[],Tennessee:[],Texas:[-95,27,1e3],Utah:[],Vermont:[],Virgina:[],Washington:[],"West Virginia":[],Wisconsin:[],Wyoming:[]},V=1,k=26e4,w=e.geoMercator().center([-96,37]).scale(588).translate([b/2,T/2]),c=e.select("#my_dataviz").append("div").attr("class","tooltip").style("opacity",0).style("background-color","white").style("border","solid").style("border-width","2px").style("border-radius","5px").style("padding","5px"),d=e.select("#my_dataviz").append("svg").attr("width",b).attr("height",T),p=e.scaleOrdinal().domain(Y).range(G),u=e.scaleLinear().domain([V,k]).range([2,25]);e.csv("assets/firesfinaldata.csv").then(I=>{e.json("assets/geojson/USA.geojson").then(function(f){d.append("g").selectAll("path").data(f.features).enter().append("path").attr("fill","#b8b8b8").attr("d",e.geoPath().projection(w)).style("stroke","black").style("opacity",.3),d.selectAll("myCircles").data(I).enter().append("circle").attr("class",t=>"year"+t.FIRE_YEAR+" dataCircles val"+t.VALUE+""+t.FIRE_YEAR).attr("cx",function(t){return w([t.LONGITUDE,t.LATITUDE])[0]}).attr("cy",function(t){return w([t.LONGITUDE,t.LATITUDE])[1]}).attr("r",function(t){return u(t.FIRE_SIZE)}).style("fill",function(t){return p(t.VALUE)}).attr("stroke",function(t){return p(t.VALUE)}).attr("stroke-width",3).attr("fill-opacity",.4).on("mouseover",function(t,a){c.style("opacity",1),c.style("display","block")}).on("mousemove",function(t,a){c.html("Fire year: "+a.FIRE_YEAR+"<br>Acres burned: "+a.FIRE_SIZE+"<br>Cause of fire: "+a.NWCG_GENERAL_CAUSE+"<br>State: "+a.STATE+"<br>County: "+a.FIPS_NAME).style("left",t.x+30+"px").style("top",t.y-30+"px")}).on("mouseleave",function(t,a){c.style("opacity",0),c.style("display","none")});var m=e.select("#my_dataviz").append("svg").attr("width",F+h.left+h.right).attr("height",L+h.top+h.bottom).append("g").attr("transform","translate("+h.left+","+h.top+")"),y=e.scaleLinear().range([0,F]);const o=m.append("g").attr("transform","translate(0,"+L+")");var i=e.scaleBand().range([0,L]).padding(.1);const v=m.append("g");function R(t){let a=I.filter(function(n){return n.FIRE_YEAR==t});i.domain(a.map(function(n){return n.NWCG_GENERAL_CAUSE})),v.transition().duration(1e3).call(e.axisLeft(i)),y.domain([0,e.max(a,function(n){return n.FIRE_SIZE})]),o.transition().duration(1e3).call(e.axisBottom(y));var s=m.selectAll("rect").data(a);s.join("rect").transition().duration(1e3).attr("class",function(n){return"fire"+n.FIRE_SIZE}).attr("x",y(0)).attr("y",n=>i(n.NWCG_GENERAL_CAUSE)).attr("width",n=>y(n.FIRE_SIZE)).attr("height",i.bandwidth()).style("fill",function(n){return p(n.VALUE)}).attr("stroke",function(n){return p(n.VALUE)}).attr("stroke-width",3).attr("fill-opacity",.4)}R(2e3);function U(){e.selectAll(".slider").each(function(t){let s=e.select(this).property("value"),n="year"+s;A=s,R(A);let l=document.getElementsByClassName("button");for(let r=0;r<=l.length-1;r++)l[r].classList.remove("active");d.selectAll(".dataCircles").transition().duration(1e3).style("opacity",0).attr("r",0),d.selectAll("."+n).transition().duration(1e3).style("opacity",1).attr("r",function(r){return u(r.FIRE_SIZE)})})}function W(t){e.selectAll(".checkbox").each(function(a){let s=e.select(this);console.log(s);let n=s.property("value"),l="val"+n;console.log("group"),console.log(l),console.log("map year"),console.log(A),s.property("checked")?(console.log("SELECTED","."+l+""+A),d.selectAll("."+l+""+A).transition().duration(1e3).style("opacity",1).attr("r",function(r){return u(r.FIRE_SIZE)})):(console.log("NOT SELECTED"),d.selectAll("."+l+""+A).transition().duration(1e3).style("opacity",0).attr("r",0))})}e.selectAll(".slider").on("change",U),e.selectAll(".checkbox").on("change",W),U();var S=[V,k/2,k],D=50,O=100,N=380;d.selectAll("legend").data(S).enter().append("circle").attr("cx",D).attr("cy",function(t){return N-u(t)}).attr("r",function(t){return u(t)}).style("fill","none").attr("stroke","black"),d.selectAll("legend").data(S).enter().append("line").attr("x1",function(t){return D+u(t)}).attr("x2",O).attr("y1",function(t){return N-u(t)*1.5}).attr("y2",function(t){return N-u(t)*1.5}).attr("stroke","black").style("stroke-dasharray","2,2"),d.selectAll("legend").data(S).enter().append("text").attr("x",O).attr("y",function(t){return N-u(t)*1.5}).text(function(t){return t==k?t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" acres":t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}).style("font-size",12).attr("alignment-baseline","middle");var g=e.select("#state").append("svg").attr("width",440).attr("height",300);e.select("#stateSelect").selectAll("myStates").data(P).enter().append("option").text(function(t){return t}).attr("value",function(t){return t});let j=document.getElementById("stateSelect");j.value="Texas";var M=e.geoMercator().center([E.Texas[0],E.Texas[1]]).scale(E.Texas[2]).translate([b/2,T/2]);console.log(f.features),state.features=f.features.filter(function(t){return t.properties.NAME=="Texas"}),console.log(state.features),g.selectAll("path").data(state.features).join("path").transition().duration(1e3).attr("fill","#b8b8b8").attr("d",e.geoPath().projection(M)).style("stroke","black").style("opacity",.3),g.selectAll("myCircles").data(I).join("circle").attr("class",t=>"state"+t.STATE).attr("cx",function(t){return M([t.LONGITUDE,t.LATITUDE])[0]}).attr("cy",function(t){return M([t.LONGITUDE,t.LATITUDE])[1]}).attr("r",0).style("fill",function(t){return p(t.VALUE)}).attr("stroke",function(t){return p(t.VALUE)}).attr("stroke-width",3).attr("fill-opacity",.4).on("mouseover",function(t,a){c.style("opacity",1),c.style("display","block")}).on("mousemove",function(t,a){c.html("Fire year: "+a.FIRE_YEAR+"<br>Acres burned: "+a.FIRE_SIZE+"<br>Cause of fire: "+a.NWCG_GENERAL_CAUSE+"<br>State: "+a.STATE+"<br>County: "+a.FIPS_NAME).style("left",t.x+5+"px").style("top",t.y-5+"px")}).on("mouseleave",function(t,a){c.style("opacity",0),c.style("display","none")});var x="Texas";function _(t){state.features=f.features.filter(function(r){return r.properties.NAME==t});var a=e.geoMercator().center([E[t][0],E[t][1]]).scale(E[t][2]).translate([b/2,T/2]);g.selectAll("path").data(state.features).join("path").transition().duration(1e3).attr("fill","#b8b8b8").attr("d",e.geoPath().projection(a)).style("stroke","black").style("opacity",.3),console.log(t);var s=document.getElementById("stateSelect"),n=s.value;console.log(n);let l=C[t];g.selectAll("myCircles").attr("class",r=>"state"+r.STATE).attr("r",0).style("fill",function(r){return p(r.VALUE)}).attr("stroke",function(r){return p(r.VALUE)}).attr("stroke-width",3).attr("fill-opacity",.4),console.log("group"),console.log(l),g.selectAll(".state"+l).attr("cx",function(r){return a([r.LONGITUDE,r.LATITUDE])[0]}).attr("cy",function(r){return a([r.LONGITUDE,r.LATITUDE])[1]}).transition().duration(1e3).style("opacity",1).attr("r",function(r){return u(r.FIRE_SIZE)})}_("Texas"),e.select("#stateSelect").on("change",function(t,a){console.log("In on change"),console.log("currentselection is"),console.log(C[x]),g.selectAll(".state"+C[x]).transition().duration(1e3).style("opacity",0).attr("r",0);const s=e.select(this).property("value");console.log(a),console.log(t),console.log("leaving on change"),x=s,_(s)})})});var K=document.getElementById("yearShown");myRange.oninput=function(){K.innerHTML=this.value};
