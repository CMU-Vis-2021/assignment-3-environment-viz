/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var oB=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o])},e(t,n)};return function(t,n){e(t,n);function i(){this.constructor=t}t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}(),aB=Object.prototype.hasOwnProperty;function Oy(e,t){return aB.call(e,t)}function Cy(e){if(Array.isArray(e)){for(var n=new Array(e.length),t=0;t<n.length;t++)n[t]=""+t;return n}if(Object.keys)return Object.keys(e);var n=[];for(var i in e)Oy(e,i)&&n.push(i);return n}function ii(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function Fy(e){for(var t=0,n=e.length,i;t<n;){if(i=e.charCodeAt(t),i>=48&&i<=57){t++;continue}return!1}return!0}function is(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function EO(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function ky(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(ky(e[t]))return!0}else if(typeof e=="object"){for(var i=Cy(e),r=i.length,t=0;t<r;t++)if(ky(e[i[t]]))return!0}}return!1}function _O(e,t){var n=[e];for(var i in t){var r=typeof t[i]=="object"?JSON.stringify(t[i],null,2):t[i];typeof r!="undefined"&&n.push(i+": "+r)}return n.join(`
`)}var AO=function(e){oB(t,e);function t(n,i,r,o,a){var s=this.constructor,u=e.call(this,_O(n,{name:i,index:r,operation:o,tree:a}))||this;return u.name=i,u.index=r,u.operation=o,u.tree=a,Object.setPrototypeOf(u,s.prototype),u.message=_O(n,{name:i,index:r,operation:o,tree:a}),u}return t}(Error),st=AO,sB=ii,Mu={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var i=e[t];return delete e[t],{newDocument:n,removed:i}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:function(e,t,n){var i=Kh(n,this.path);i&&(i=ii(i));var r=rs(n,{op:"remove",path:this.from}).removed;return rs(n,{op:"add",path:this.path,value:r}),{newDocument:n,removed:i}},copy:function(e,t,n){var i=Kh(n,this.from);return rs(n,{op:"add",path:this.path,value:ii(i)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:Ac(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},uB={add:function(e,t,n){return Fy(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var i=e.splice(t,1);return{newDocument:n,removed:i[0]}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:Mu.move,copy:Mu.copy,test:Mu.test,_get:Mu._get};function Kh(e,t){if(t=="")return e;var n={op:"_get",path:t};return rs(e,n),n.value}function rs(e,t,n,i,r,o){if(n===void 0&&(n=!1),i===void 0&&(i=!0),r===void 0&&(r=!0),o===void 0&&(o=0),n&&(typeof n=="function"?n(t,0,e,t.path):Zh(t,0)),t.path===""){var a={newDocument:e};if(t.op==="add")return a.newDocument=t.value,a;if(t.op==="replace")return a.newDocument=t.value,a.removed=e,a;if(t.op==="move"||t.op==="copy")return a.newDocument=Kh(e,t.from),t.op==="move"&&(a.removed=e),a;if(t.op==="test"){if(a.test=Ac(e,t.value),a.test===!1)throw new st("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a.newDocument=e,a}else{if(t.op==="remove")return a.removed=e,a.newDocument=null,a;if(t.op==="_get")return t.value=e,a;if(n)throw new st("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",o,t,e);return a}}else{i||(e=ii(e));var s=t.path||"",u=s.split("/"),l=e,c=1,f=u.length,d=void 0,h=void 0,g=void 0;for(typeof n=="function"?g=n:g=Zh;;){if(h=u[c],h&&h.indexOf("~")!=-1&&(h=EO(h)),r&&h=="__proto__")throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&d===void 0&&(l[h]===void 0?d=u.slice(0,c).join("/"):c==f-1&&(d=t.path),d!==void 0&&g(t,0,e,d)),c++,Array.isArray(l)){if(h==="-")h=l.length;else{if(n&&!Fy(h))throw new st("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",o,t,e);Fy(h)&&(h=~~h)}if(c>=f){if(n&&t.op==="add"&&h>l.length)throw new st("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",o,t,e);var a=uB[t.op].call(t,l,h,e);if(a.test===!1)throw new st("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a}}else if(c>=f){var a=Mu[t.op].call(t,l,h,e);if(a.test===!1)throw new st("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a}if(l=l[h],n&&c<f&&(!l||typeof l!="object"))throw new st("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",o,t,e)}}}function Jh(e,t,n,i,r){if(i===void 0&&(i=!0),r===void 0&&(r=!0),n&&!Array.isArray(t))throw new st("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");i||(e=ii(e));for(var o=new Array(t.length),a=0,s=t.length;a<s;a++)o[a]=rs(e,t[a],n,!0,r,a),e=o[a].newDocument;return o.newDocument=e,o}function lB(e,t,n){var i=rs(e,t);if(i.test===!1)throw new st("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return i.newDocument}function Zh(e,t,n,i){if(typeof e!="object"||e===null||Array.isArray(e))throw new st("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(Mu[e.op]){if(typeof e.path!="string")throw new st("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new st('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new st("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new st("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&ky(e.value))throw new st("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var r=e.path.split("/").length,o=i.split("/").length;if(r!==o+1&&r!==o)throw new st("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==i)throw new st("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var a={op:"_get",path:e.from,value:void 0},s=$O([a],n);if(s&&s.name==="OPERATION_PATH_UNRESOLVABLE")throw new st("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new st("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function $O(e,t,n){try{if(!Array.isArray(e))throw new st("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)Jh(ii(t),ii(e),n||!0);else{n=n||Zh;for(var i=0;i<e.length;i++)n(e[i],i,t,void 0)}}catch(r){if(r instanceof st)return r;throw r}}function Ac(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),i=Array.isArray(t),r,o,a;if(n&&i){if(o=e.length,o!=t.length)return!1;for(r=o;r--!=0;)if(!Ac(e[r],t[r]))return!1;return!0}if(n!=i)return!1;var s=Object.keys(e);if(o=s.length,o!==Object.keys(t).length)return!1;for(r=o;r--!=0;)if(!t.hasOwnProperty(s[r]))return!1;for(r=o;r--!=0;)if(a=s[r],!Ac(e[a],t[a]))return!1;return!0}return e!==e&&t!==t}var cB=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",JsonPatchError:st,deepClone:sB,getValueByPointer:Kh,applyOperation:rs,applyPatch:Jh,applyReducer:lB,validator:Zh,validate:$O,_areEquals:Ac});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var Dy=new WeakMap,fB=function(){function e(t){this.observers=new Map,this.obj=t}return e}(),dB=function(){function e(t,n){this.callback=t,this.observer=n}return e}();function hB(e){return Dy.get(e)}function gB(e,t){return e.observers.get(t)}function pB(e,t){e.observers.delete(t.callback)}function mB(e,t){t.unobserve()}function yB(e,t){var n=[],i,r=hB(e);if(!r)r=new fB(e),Dy.set(e,r);else{var o=gB(r,t);i=o&&o.observer}if(i)return i;if(i={},r.value=ii(e),t){i.callback=t,i.next=null;var a=function(){My(i)},s=function(){clearTimeout(i.next),i.next=setTimeout(a)};typeof window!="undefined"&&(window.addEventListener("mouseup",s),window.addEventListener("keyup",s),window.addEventListener("mousedown",s),window.addEventListener("keydown",s),window.addEventListener("change",s))}return i.patches=n,i.object=e,i.unobserve=function(){My(i),clearTimeout(i.next),pB(r,i),typeof window!="undefined"&&(window.removeEventListener("mouseup",s),window.removeEventListener("keyup",s),window.removeEventListener("mousedown",s),window.removeEventListener("keydown",s),window.removeEventListener("change",s))},r.observers.set(t,new dB(t,i)),i}function My(e,t){t===void 0&&(t=!1);var n=Dy.get(e.object);Ty(n.value,e.object,e.patches,"",t),e.patches.length&&Jh(n.value,e.patches);var i=e.patches;return i.length>0&&(e.patches=[],e.callback&&e.callback(i)),i}function Ty(e,t,n,i,r){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var o=Cy(t),a=Cy(e),s=!1,u=a.length-1;u>=0;u--){var l=a[u],c=e[l];if(Oy(t,l)&&!(t[l]===void 0&&c!==void 0&&Array.isArray(t)===!1)){var f=t[l];typeof c=="object"&&c!=null&&typeof f=="object"&&f!=null&&Array.isArray(c)===Array.isArray(f)?Ty(c,f,n,i+"/"+is(l),r):c!==f&&(r&&n.push({op:"test",path:i+"/"+is(l),value:ii(c)}),n.push({op:"replace",path:i+"/"+is(l),value:ii(f)}))}else Array.isArray(e)===Array.isArray(t)?(r&&n.push({op:"test",path:i+"/"+is(l),value:ii(c)}),n.push({op:"remove",path:i+"/"+is(l)}),s=!0):(r&&n.push({op:"test",path:i,value:e}),n.push({op:"replace",path:i,value:t}))}if(!(!s&&o.length==a.length))for(var u=0;u<o.length;u++){var l=o[u];!Oy(e,l)&&t[l]!==void 0&&n.push({op:"add",path:i+"/"+is(l),value:ii(t[l])})}}}function vB(e,t,n){n===void 0&&(n=!1);var i=[];return Ty(e,t,i,"",n),i}var bB=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",unobserve:mB,observe:yB,generate:My,compare:vB});Object.assign({},cB,bB,{JsonPatchError:AO,deepClone:ii,escapePathComponent:is,unescapePathComponent:EO});var xB=/("(?:[^\\"]|\\.)*")|[:,]/g,Ny=function(t,n){var i,r,o;return n=n||{},i=JSON.stringify([1],void 0,n.indent===void 0?2:n.indent).slice(2,-3),r=i===""?1/0:n.maxLength===void 0?80:n.maxLength,o=n.replacer,function a(s,u,l){var c,f,d,h,g,p,m,y,v,b,x,w;if(s&&typeof s.toJSON=="function"&&(s=s.toJSON()),x=JSON.stringify(s,o),x===void 0)return x;if(m=r-u.length-l,x.length<=m&&(v=x.replace(xB,function(_,E){return E||_+" "}),v.length<=m))return v;if(o!=null&&(s=JSON.parse(x),o=void 0),typeof s=="object"&&s!==null){if(y=u+i,d=[],f=0,Array.isArray(s))for(b="[",c="]",m=s.length;f<m;f++)d.push(a(s[f],y,f===m-1?0:1)||"null");else for(b="{",c="}",p=Object.keys(s),m=p.length;f<m;f++)h=p[f],g=JSON.stringify(h)+": ",w=a(s[h],y,g.length+(f===m-1?0:1)),w!==void 0&&d.push(g+w);if(d.length>0)return[b,i+d.join(`,
`+y),c].join(`
`+u)}return x}(t,"",0)},Xo={exports:{}};const wB="2.0.0",EB=256,_B=Number.MAX_SAFE_INTEGER||9007199254740991,AB=16;var Qh={SEMVER_SPEC_VERSION:wB,MAX_LENGTH:EB,MAX_SAFE_INTEGER:_B,MAX_SAFE_COMPONENT_LENGTH:AB};const $B=typeof process=="object"&&process.env&&{}.NODE_DEBUG&&/\bsemver\b/i.test({}.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};var e0=$B;(function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n}=Qh,i=e0;t=e.exports={};const r=t.re=[],o=t.src=[],a=t.t={};let s=0;const u=(l,c,f)=>{const d=s++;i(d,c),a[l]=d,o[d]=c,r[d]=new RegExp(c,f?"g":void 0)};u("NUMERICIDENTIFIER","0|[1-9]\\d*"),u("NUMERICIDENTIFIERLOOSE","[0-9]+"),u("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),u("MAINVERSION",`(${o[a.NUMERICIDENTIFIER]})\\.(${o[a.NUMERICIDENTIFIER]})\\.(${o[a.NUMERICIDENTIFIER]})`),u("MAINVERSIONLOOSE",`(${o[a.NUMERICIDENTIFIERLOOSE]})\\.(${o[a.NUMERICIDENTIFIERLOOSE]})\\.(${o[a.NUMERICIDENTIFIERLOOSE]})`),u("PRERELEASEIDENTIFIER",`(?:${o[a.NUMERICIDENTIFIER]}|${o[a.NONNUMERICIDENTIFIER]})`),u("PRERELEASEIDENTIFIERLOOSE",`(?:${o[a.NUMERICIDENTIFIERLOOSE]}|${o[a.NONNUMERICIDENTIFIER]})`),u("PRERELEASE",`(?:-(${o[a.PRERELEASEIDENTIFIER]}(?:\\.${o[a.PRERELEASEIDENTIFIER]})*))`),u("PRERELEASELOOSE",`(?:-?(${o[a.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${o[a.PRERELEASEIDENTIFIERLOOSE]})*))`),u("BUILDIDENTIFIER","[0-9A-Za-z-]+"),u("BUILD",`(?:\\+(${o[a.BUILDIDENTIFIER]}(?:\\.${o[a.BUILDIDENTIFIER]})*))`),u("FULLPLAIN",`v?${o[a.MAINVERSION]}${o[a.PRERELEASE]}?${o[a.BUILD]}?`),u("FULL",`^${o[a.FULLPLAIN]}$`),u("LOOSEPLAIN",`[v=\\s]*${o[a.MAINVERSIONLOOSE]}${o[a.PRERELEASELOOSE]}?${o[a.BUILD]}?`),u("LOOSE",`^${o[a.LOOSEPLAIN]}$`),u("GTLT","((?:<|>)?=?)"),u("XRANGEIDENTIFIERLOOSE",`${o[a.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),u("XRANGEIDENTIFIER",`${o[a.NUMERICIDENTIFIER]}|x|X|\\*`),u("XRANGEPLAIN",`[v=\\s]*(${o[a.XRANGEIDENTIFIER]})(?:\\.(${o[a.XRANGEIDENTIFIER]})(?:\\.(${o[a.XRANGEIDENTIFIER]})(?:${o[a.PRERELEASE]})?${o[a.BUILD]}?)?)?`),u("XRANGEPLAINLOOSE",`[v=\\s]*(${o[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[a.XRANGEIDENTIFIERLOOSE]})(?:${o[a.PRERELEASELOOSE]})?${o[a.BUILD]}?)?)?`),u("XRANGE",`^${o[a.GTLT]}\\s*${o[a.XRANGEPLAIN]}$`),u("XRANGELOOSE",`^${o[a.GTLT]}\\s*${o[a.XRANGEPLAINLOOSE]}$`),u("COERCE",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?(?:$|[^\\d])`),u("COERCERTL",o[a.COERCE],!0),u("LONETILDE","(?:~>?)"),u("TILDETRIM",`(\\s*)${o[a.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",u("TILDE",`^${o[a.LONETILDE]}${o[a.XRANGEPLAIN]}$`),u("TILDELOOSE",`^${o[a.LONETILDE]}${o[a.XRANGEPLAINLOOSE]}$`),u("LONECARET","(?:\\^)"),u("CARETTRIM",`(\\s*)${o[a.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",u("CARET",`^${o[a.LONECARET]}${o[a.XRANGEPLAIN]}$`),u("CARETLOOSE",`^${o[a.LONECARET]}${o[a.XRANGEPLAINLOOSE]}$`),u("COMPARATORLOOSE",`^${o[a.GTLT]}\\s*(${o[a.LOOSEPLAIN]})$|^$`),u("COMPARATOR",`^${o[a.GTLT]}\\s*(${o[a.FULLPLAIN]})$|^$`),u("COMPARATORTRIM",`(\\s*)${o[a.GTLT]}\\s*(${o[a.LOOSEPLAIN]}|${o[a.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",u("HYPHENRANGE",`^\\s*(${o[a.XRANGEPLAIN]})\\s+-\\s+(${o[a.XRANGEPLAIN]})\\s*$`),u("HYPHENRANGELOOSE",`^\\s*(${o[a.XRANGEPLAINLOOSE]})\\s+-\\s+(${o[a.XRANGEPLAINLOOSE]})\\s*$`),u("STAR","(<|>)?=?\\s*\\*"),u("GTE0","^\\s*>=\\s*0.0.0\\s*$"),u("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")})(Xo,Xo.exports);const SB=["includePrerelease","loose","rtl"],OB=e=>e?typeof e!="object"?{loose:!0}:SB.filter(t=>e[t]).reduce((t,n)=>(t[n]=!0,t),{}):{};var t0=OB;const SO=/^[0-9]+$/,OO=(e,t)=>{const n=SO.test(e),i=SO.test(t);return n&&i&&(e=+e,t=+t),e===t?0:n&&!i?-1:i&&!n?1:e<t?-1:1},CB=(e,t)=>OO(t,e);var Ry={compareIdentifiers:OO,rcompareIdentifiers:CB};const n0=e0,{MAX_LENGTH:CO,MAX_SAFE_INTEGER:i0}=Qh,{re:FO,t:kO}=Xo.exports,FB=t0,{compareIdentifiers:$c}=Ry;class Bi{constructor(t,n){if(n=FB(n),t instanceof Bi){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid Version: ${t}`);if(t.length>CO)throw new TypeError(`version is longer than ${CO} characters`);n0("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;const i=t.trim().match(n.loose?FO[kO.LOOSE]:FO[kO.FULL]);if(!i)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>i0||this.major<0)throw new TypeError("Invalid major version");if(this.minor>i0||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>i0||this.patch<0)throw new TypeError("Invalid patch version");i[4]?this.prerelease=i[4].split(".").map(r=>{if(/^[0-9]+$/.test(r)){const o=+r;if(o>=0&&o<i0)return o}return r}):this.prerelease=[],this.build=i[5]?i[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(n0("SemVer.compare",this.version,this.options,t),!(t instanceof Bi)){if(typeof t=="string"&&t===this.version)return 0;t=new Bi(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof Bi||(t=new Bi(t,this.options)),$c(this.major,t.major)||$c(this.minor,t.minor)||$c(this.patch,t.patch)}comparePre(t){if(t instanceof Bi||(t=new Bi(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let n=0;do{const i=this.prerelease[n],r=t.prerelease[n];if(n0("prerelease compare",n,i,r),i===void 0&&r===void 0)return 0;if(r===void 0)return 1;if(i===void 0)return-1;if(i===r)continue;return $c(i,r)}while(++n)}compareBuild(t){t instanceof Bi||(t=new Bi(t,this.options));let n=0;do{const i=this.build[n],r=t.build[n];if(n0("prerelease compare",n,i,r),i===void 0&&r===void 0)return 0;if(r===void 0)return 1;if(i===void 0)return-1;if(i===r)continue;return $c(i,r)}while(++n)}inc(t,n){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n),this.inc("pre",n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",n),this.inc("pre",n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{let i=this.prerelease.length;for(;--i>=0;)typeof this.prerelease[i]=="number"&&(this.prerelease[i]++,i=-2);i===-1&&this.prerelease.push(0)}n&&(this.prerelease[0]===n?isNaN(this.prerelease[1])&&(this.prerelease=[n,0]):this.prerelease=[n,0]);break;default:throw new Error(`invalid increment argument: ${t}`)}return this.format(),this.raw=this.version,this}}var pn=Bi;const{MAX_LENGTH:kB}=Qh,{re:DO,t:MO}=Xo.exports,TO=pn,DB=t0,MB=(e,t)=>{if(t=DB(t),e instanceof TO)return e;if(typeof e!="string"||e.length>kB||!(t.loose?DO[MO.LOOSE]:DO[MO.FULL]).test(e))return null;try{return new TO(e,t)}catch(i){return null}};var Tu=MB;const TB=Tu,NB=(e,t)=>{const n=TB(e,t);return n?n.version:null};var RB=NB;const jB=Tu,LB=(e,t)=>{const n=jB(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null};var PB=LB;const IB=pn,BB=(e,t,n,i)=>{typeof n=="string"&&(i=n,n=void 0);try{return new IB(e,n).inc(t,i).version}catch(r){return null}};var zB=BB;const NO=pn,UB=(e,t,n)=>new NO(e,n).compare(new NO(t,n));var zi=UB;const qB=zi,HB=(e,t,n)=>qB(e,t,n)===0;var jy=HB;const RO=Tu,WB=jy,GB=(e,t)=>{if(WB(e,t))return null;{const n=RO(e),i=RO(t),r=n.prerelease.length||i.prerelease.length,o=r?"pre":"",a=r?"prerelease":"";for(const s in n)if((s==="major"||s==="minor"||s==="patch")&&n[s]!==i[s])return o+s;return a}};var YB=GB;const VB=pn,XB=(e,t)=>new VB(e,t).major;var KB=XB;const JB=pn,ZB=(e,t)=>new JB(e,t).minor;var QB=ZB;const ez=pn,tz=(e,t)=>new ez(e,t).patch;var nz=tz;const iz=Tu,rz=(e,t)=>{const n=iz(e,t);return n&&n.prerelease.length?n.prerelease:null};var oz=rz;const az=zi,sz=(e,t,n)=>az(t,e,n);var uz=sz;const lz=zi,cz=(e,t)=>lz(e,t,!0);var fz=cz;const jO=pn,dz=(e,t,n)=>{const i=new jO(e,n),r=new jO(t,n);return i.compare(r)||i.compareBuild(r)};var Ly=dz;const hz=Ly,gz=(e,t)=>e.sort((n,i)=>hz(n,i,t));var pz=gz;const mz=Ly,yz=(e,t)=>e.sort((n,i)=>mz(i,n,t));var vz=yz;const bz=zi,xz=(e,t,n)=>bz(e,t,n)>0;var r0=xz;const wz=zi,Ez=(e,t,n)=>wz(e,t,n)<0;var Py=Ez;const _z=zi,Az=(e,t,n)=>_z(e,t,n)!==0;var LO=Az;const $z=zi,Sz=(e,t,n)=>$z(e,t,n)>=0;var Iy=Sz;const Oz=zi,Cz=(e,t,n)=>Oz(e,t,n)<=0;var By=Cz;const Fz=jy,kz=LO,Dz=r0,Mz=Iy,Tz=Py,Nz=By,Rz=(e,t,n,i)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e===n;case"!==":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e!==n;case"":case"=":case"==":return Fz(e,n,i);case"!=":return kz(e,n,i);case">":return Dz(e,n,i);case">=":return Mz(e,n,i);case"<":return Tz(e,n,i);case"<=":return Nz(e,n,i);default:throw new TypeError(`Invalid operator: ${t}`)}};var PO=Rz;const jz=pn,Lz=Tu,{re:o0,t:a0}=Xo.exports,Pz=(e,t)=>{if(e instanceof jz)return e;if(typeof e=="number"&&(e=String(e)),typeof e!="string")return null;t=t||{};let n=null;if(!t.rtl)n=e.match(o0[a0.COERCE]);else{let i;for(;(i=o0[a0.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length);)(!n||i.index+i[0].length!==n.index+n[0].length)&&(n=i),o0[a0.COERCERTL].lastIndex=i.index+i[1].length+i[2].length;o0[a0.COERCERTL].lastIndex=-1}return n===null?null:Lz(`${n[2]}.${n[3]||"0"}.${n[4]||"0"}`,t)};var Iz=Pz,Bz=function(e){e.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}},zz=De;De.Node=os;De.create=De;function De(e){var t=this;if(t instanceof De||(t=new De),t.tail=null,t.head=null,t.length=0,e&&typeof e.forEach=="function")e.forEach(function(r){t.push(r)});else if(arguments.length>0)for(var n=0,i=arguments.length;n<i;n++)t.push(arguments[n]);return t}De.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t};De.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}};De.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}};De.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)qz(this,arguments[e]);return this.length};De.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)Hz(this,arguments[e]);return this.length};De.prototype.pop=function(){if(!!this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}};De.prototype.shift=function(){if(!!this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}};De.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,i=0;n!==null;i++)e.call(t,n.value,i,this),n=n.next};De.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,i=this.length-1;n!==null;i--)e.call(t,n.value,i,this),n=n.prev};De.prototype.get=function(e){for(var t=0,n=this.head;n!==null&&t<e;t++)n=n.next;if(t===e&&n!==null)return n.value};De.prototype.getReverse=function(e){for(var t=0,n=this.tail;n!==null&&t<e;t++)n=n.prev;if(t===e&&n!==null)return n.value};De.prototype.map=function(e,t){t=t||this;for(var n=new De,i=this.head;i!==null;)n.push(e.call(t,i.value,this)),i=i.next;return n};De.prototype.mapReverse=function(e,t){t=t||this;for(var n=new De,i=this.tail;i!==null;)n.push(e.call(t,i.value,this)),i=i.prev;return n};De.prototype.reduce=function(e,t){var n,i=this.head;if(arguments.length>1)n=t;else if(this.head)i=this.head.next,n=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var r=0;i!==null;r++)n=e(n,i.value,r),i=i.next;return n};De.prototype.reduceReverse=function(e,t){var n,i=this.tail;if(arguments.length>1)n=t;else if(this.tail)i=this.tail.prev,n=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var r=this.length-1;i!==null;r--)n=e(n,i.value,r),i=i.prev;return n};De.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;n!==null;t++)e[t]=n.value,n=n.next;return e};De.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;n!==null;t++)e[t]=n.value,n=n.prev;return e};De.prototype.slice=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new De;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=0,r=this.head;r!==null&&i<e;i++)r=r.next;for(;r!==null&&i<t;i++,r=r.next)n.push(r.value);return n};De.prototype.sliceReverse=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new De;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=this.length,r=this.tail;r!==null&&i>t;i--)r=r.prev;for(;r!==null&&i>e;i--,r=r.prev)n.push(r.value);return n};De.prototype.splice=function(e,t,...n){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var i=0,r=this.head;r!==null&&i<e;i++)r=r.next;for(var o=[],i=0;r&&i<t;i++)o.push(r.value),r=this.removeNode(r);r===null&&(r=this.tail),r!==this.head&&r!==this.tail&&(r=r.prev);for(var i=0;i<n.length;i++)r=Uz(this,r,n[i]);return o};De.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;n!==null;n=n.prev){var i=n.prev;n.prev=n.next,n.next=i}return this.head=t,this.tail=e,this};function Uz(e,t,n){var i=t===e.head?new os(n,null,t,e):new os(n,t,t.next,e);return i.next===null&&(e.tail=i),i.prev===null&&(e.head=i),e.length++,i}function qz(e,t){e.tail=new os(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function Hz(e,t){e.head=new os(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function os(e,t,n,i){if(!(this instanceof os))return new os(e,t,n,i);this.list=i,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}try{Bz(De)}catch(e){}const Wz=zz,as=Symbol("max"),co=Symbol("length"),Nu=Symbol("lengthCalculator"),Sc=Symbol("allowStale"),ss=Symbol("maxAge"),fo=Symbol("dispose"),IO=Symbol("noDisposeOnSet"),Ct=Symbol("lruList"),Ui=Symbol("cache"),BO=Symbol("updateAgeOnGet"),zy=()=>1;class Gz{constructor(t){if(typeof t=="number"&&(t={max:t}),t||(t={}),t.max&&(typeof t.max!="number"||t.max<0))throw new TypeError("max must be a non-negative number");this[as]=t.max||1/0;const n=t.length||zy;if(this[Nu]=typeof n!="function"?zy:n,this[Sc]=t.stale||!1,t.maxAge&&typeof t.maxAge!="number")throw new TypeError("maxAge must be a number");this[ss]=t.maxAge||0,this[fo]=t.dispose,this[IO]=t.noDisposeOnSet||!1,this[BO]=t.updateAgeOnGet||!1,this.reset()}set max(t){if(typeof t!="number"||t<0)throw new TypeError("max must be a non-negative number");this[as]=t||1/0,Oc(this)}get max(){return this[as]}set allowStale(t){this[Sc]=!!t}get allowStale(){return this[Sc]}set maxAge(t){if(typeof t!="number")throw new TypeError("maxAge must be a non-negative number");this[ss]=t,Oc(this)}get maxAge(){return this[ss]}set lengthCalculator(t){typeof t!="function"&&(t=zy),t!==this[Nu]&&(this[Nu]=t,this[co]=0,this[Ct].forEach(n=>{n.length=this[Nu](n.value,n.key),this[co]+=n.length})),Oc(this)}get lengthCalculator(){return this[Nu]}get length(){return this[co]}get itemCount(){return this[Ct].length}rforEach(t,n){n=n||this;for(let i=this[Ct].tail;i!==null;){const r=i.prev;zO(this,t,i,n),i=r}}forEach(t,n){n=n||this;for(let i=this[Ct].head;i!==null;){const r=i.next;zO(this,t,i,n),i=r}}keys(){return this[Ct].toArray().map(t=>t.key)}values(){return this[Ct].toArray().map(t=>t.value)}reset(){this[fo]&&this[Ct]&&this[Ct].length&&this[Ct].forEach(t=>this[fo](t.key,t.value)),this[Ui]=new Map,this[Ct]=new Wz,this[co]=0}dump(){return this[Ct].map(t=>s0(this,t)?!1:{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[Ct]}set(t,n,i){if(i=i||this[ss],i&&typeof i!="number")throw new TypeError("maxAge must be a number");const r=i?Date.now():0,o=this[Nu](n,t);if(this[Ui].has(t)){if(o>this[as])return Ru(this,this[Ui].get(t)),!1;const u=this[Ui].get(t).value;return this[fo]&&(this[IO]||this[fo](t,u.value)),u.now=r,u.maxAge=i,u.value=n,this[co]+=o-u.length,u.length=o,this.get(t),Oc(this),!0}const a=new Yz(t,n,o,r,i);return a.length>this[as]?(this[fo]&&this[fo](t,n),!1):(this[co]+=a.length,this[Ct].unshift(a),this[Ui].set(t,this[Ct].head),Oc(this),!0)}has(t){if(!this[Ui].has(t))return!1;const n=this[Ui].get(t).value;return!s0(this,n)}get(t){return Uy(this,t,!0)}peek(t){return Uy(this,t,!1)}pop(){const t=this[Ct].tail;return t?(Ru(this,t),t.value):null}del(t){Ru(this,this[Ui].get(t))}load(t){this.reset();const n=Date.now();for(let i=t.length-1;i>=0;i--){const r=t[i],o=r.e||0;if(o===0)this.set(r.k,r.v);else{const a=o-n;a>0&&this.set(r.k,r.v,a)}}}prune(){this[Ui].forEach((t,n)=>Uy(this,n,!1))}}const Uy=(e,t,n)=>{const i=e[Ui].get(t);if(i){const r=i.value;if(s0(e,r)){if(Ru(e,i),!e[Sc])return}else n&&(e[BO]&&(i.value.now=Date.now()),e[Ct].unshiftNode(i));return r.value}},s0=(e,t)=>{if(!t||!t.maxAge&&!e[ss])return!1;const n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[ss]&&n>e[ss]},Oc=e=>{if(e[co]>e[as])for(let t=e[Ct].tail;e[co]>e[as]&&t!==null;){const n=t.prev;Ru(e,t),t=n}},Ru=(e,t)=>{if(t){const n=t.value;e[fo]&&e[fo](n.key,n.value),e[co]-=n.length,e[Ui].delete(n.key),e[Ct].removeNode(t)}};class Yz{constructor(t,n,i,r,o){this.key=t,this.value=n,this.length=i,this.now=r,this.maxAge=o||0}}const zO=(e,t,n,i)=>{let r=n.value;s0(e,r)&&(Ru(e,n),e[Sc]||(r=void 0)),r&&t.call(i,r.value,r.key,e)};var Vz=Gz;class Cc{constructor(t,n){if(n=Kz(n),t instanceof Cc)return t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease?t:new Cc(t.raw,n);if(t instanceof qy)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease,this.raw=t,this.set=t.split(/\s*\|\|\s*/).map(i=>this.parseRange(i.trim())).filter(i=>i.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${t}`);if(this.set.length>1){const i=this.set[0];if(this.set=this.set.filter(r=>!qO(r[0])),this.set.length===0)this.set=[i];else if(this.set.length>1){for(const r of this.set)if(r.length===1&&tU(r[0])){this.set=[r];break}}}this.format()}format(){return this.range=this.set.map(t=>t.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(t){t=t.trim();const i=`parseRange:${Object.keys(this.options).join(",")}:${t}`,r=UO.get(i);if(r)return r;const o=this.options.loose,a=o?Vt[Bt.HYPHENRANGELOOSE]:Vt[Bt.HYPHENRANGE];t=t.replace(a,fU(this.options.includePrerelease)),dt("hyphen replace",t),t=t.replace(Vt[Bt.COMPARATORTRIM],Zz),dt("comparator trim",t,Vt[Bt.COMPARATORTRIM]),t=t.replace(Vt[Bt.TILDETRIM],Qz),t=t.replace(Vt[Bt.CARETTRIM],eU),t=t.split(/\s+/).join(" ");const s=o?Vt[Bt.COMPARATORLOOSE]:Vt[Bt.COMPARATOR],u=t.split(" ").map(f=>nU(f,this.options)).join(" ").split(/\s+/).map(f=>cU(f,this.options)).filter(this.options.loose?f=>!!f.match(s):()=>!0).map(f=>new qy(f,this.options));u.length;const l=new Map;for(const f of u){if(qO(f))return[f];l.set(f.value,f)}l.size>1&&l.has("")&&l.delete("");const c=[...l.values()];return UO.set(i,c),c}intersects(t,n){if(!(t instanceof Cc))throw new TypeError("a Range is required");return this.set.some(i=>HO(i,n)&&t.set.some(r=>HO(r,n)&&i.every(o=>r.every(a=>o.intersects(a,n)))))}test(t){if(!t)return!1;if(typeof t=="string")try{t=new Jz(t,this.options)}catch(n){return!1}for(let n=0;n<this.set.length;n++)if(dU(this.set[n],t,this.options))return!0;return!1}}var qi=Cc;const Xz=Vz,UO=new Xz({max:1e3}),Kz=t0,qy=l0,dt=e0,Jz=pn,{re:Vt,t:Bt,comparatorTrimReplace:Zz,tildeTrimReplace:Qz,caretTrimReplace:eU}=Xo.exports,qO=e=>e.value==="<0.0.0-0",tU=e=>e.value==="",HO=(e,t)=>{let n=!0;const i=e.slice();let r=i.pop();for(;n&&i.length;)n=i.every(o=>r.intersects(o,t)),r=i.pop();return n},nU=(e,t)=>(dt("comp",e,t),e=oU(e,t),dt("caret",e),e=iU(e,t),dt("tildes",e),e=sU(e,t),dt("xrange",e),e=lU(e,t),dt("stars",e),e),mn=e=>!e||e.toLowerCase()==="x"||e==="*",iU=(e,t)=>e.trim().split(/\s+/).map(n=>rU(n,t)).join(" "),rU=(e,t)=>{const n=t.loose?Vt[Bt.TILDELOOSE]:Vt[Bt.TILDE];return e.replace(n,(i,r,o,a,s)=>{dt("tilde",e,i,r,o,a,s);let u;return mn(r)?u="":mn(o)?u=`>=${r}.0.0 <${+r+1}.0.0-0`:mn(a)?u=`>=${r}.${o}.0 <${r}.${+o+1}.0-0`:s?(dt("replaceTilde pr",s),u=`>=${r}.${o}.${a}-${s} <${r}.${+o+1}.0-0`):u=`>=${r}.${o}.${a} <${r}.${+o+1}.0-0`,dt("tilde return",u),u})},oU=(e,t)=>e.trim().split(/\s+/).map(n=>aU(n,t)).join(" "),aU=(e,t)=>{dt("caret",e,t);const n=t.loose?Vt[Bt.CARETLOOSE]:Vt[Bt.CARET],i=t.includePrerelease?"-0":"";return e.replace(n,(r,o,a,s,u)=>{dt("caret",e,r,o,a,s,u);let l;return mn(o)?l="":mn(a)?l=`>=${o}.0.0${i} <${+o+1}.0.0-0`:mn(s)?o==="0"?l=`>=${o}.${a}.0${i} <${o}.${+a+1}.0-0`:l=`>=${o}.${a}.0${i} <${+o+1}.0.0-0`:u?(dt("replaceCaret pr",u),o==="0"?a==="0"?l=`>=${o}.${a}.${s}-${u} <${o}.${a}.${+s+1}-0`:l=`>=${o}.${a}.${s}-${u} <${o}.${+a+1}.0-0`:l=`>=${o}.${a}.${s}-${u} <${+o+1}.0.0-0`):(dt("no pr"),o==="0"?a==="0"?l=`>=${o}.${a}.${s}${i} <${o}.${a}.${+s+1}-0`:l=`>=${o}.${a}.${s}${i} <${o}.${+a+1}.0-0`:l=`>=${o}.${a}.${s} <${+o+1}.0.0-0`),dt("caret return",l),l})},sU=(e,t)=>(dt("replaceXRanges",e,t),e.split(/\s+/).map(n=>uU(n,t)).join(" ")),uU=(e,t)=>{e=e.trim();const n=t.loose?Vt[Bt.XRANGELOOSE]:Vt[Bt.XRANGE];return e.replace(n,(i,r,o,a,s,u)=>{dt("xRange",e,i,r,o,a,s,u);const l=mn(o),c=l||mn(a),f=c||mn(s),d=f;return r==="="&&d&&(r=""),u=t.includePrerelease?"-0":"",l?r===">"||r==="<"?i="<0.0.0-0":i="*":r&&d?(c&&(a=0),s=0,r===">"?(r=">=",c?(o=+o+1,a=0,s=0):(a=+a+1,s=0)):r==="<="&&(r="<",c?o=+o+1:a=+a+1),r==="<"&&(u="-0"),i=`${r+o}.${a}.${s}${u}`):c?i=`>=${o}.0.0${u} <${+o+1}.0.0-0`:f&&(i=`>=${o}.${a}.0${u} <${o}.${+a+1}.0-0`),dt("xRange return",i),i})},lU=(e,t)=>(dt("replaceStars",e,t),e.trim().replace(Vt[Bt.STAR],"")),cU=(e,t)=>(dt("replaceGTE0",e,t),e.trim().replace(Vt[t.includePrerelease?Bt.GTE0PRE:Bt.GTE0],"")),fU=e=>(t,n,i,r,o,a,s,u,l,c,f,d,h)=>(mn(i)?n="":mn(r)?n=`>=${i}.0.0${e?"-0":""}`:mn(o)?n=`>=${i}.${r}.0${e?"-0":""}`:a?n=`>=${n}`:n=`>=${n}${e?"-0":""}`,mn(l)?u="":mn(c)?u=`<${+l+1}.0.0-0`:mn(f)?u=`<${l}.${+c+1}.0-0`:d?u=`<=${l}.${c}.${f}-${d}`:e?u=`<${l}.${c}.${+f+1}-0`:u=`<=${u}`,`${n} ${u}`.trim()),dU=(e,t,n)=>{for(let i=0;i<e.length;i++)if(!e[i].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(let i=0;i<e.length;i++)if(dt(e[i].semver),e[i].semver!==qy.ANY&&e[i].semver.prerelease.length>0){const r=e[i].semver;if(r.major===t.major&&r.minor===t.minor&&r.patch===t.patch)return!0}return!1}return!0},Fc=Symbol("SemVer ANY");class u0{static get ANY(){return Fc}constructor(t,n){if(n=hU(n),t instanceof u0){if(t.loose===!!n.loose)return t;t=t.value}Wy("comparator",t,n),this.options=n,this.loose=!!n.loose,this.parse(t),this.semver===Fc?this.value="":this.value=this.operator+this.semver.version,Wy("comp",this)}parse(t){const n=this.options.loose?WO[GO.COMPARATORLOOSE]:WO[GO.COMPARATOR],i=t.match(n);if(!i)throw new TypeError(`Invalid comparator: ${t}`);this.operator=i[1]!==void 0?i[1]:"",this.operator==="="&&(this.operator=""),i[2]?this.semver=new YO(i[2],this.options.loose):this.semver=Fc}toString(){return this.value}test(t){if(Wy("Comparator.test",t,this.options.loose),this.semver===Fc||t===Fc)return!0;if(typeof t=="string")try{t=new YO(t,this.options)}catch(n){return!1}return Hy(t,this.operator,this.semver,this.options)}intersects(t,n){if(!(t instanceof u0))throw new TypeError("a Comparator is required");if((!n||typeof n!="object")&&(n={loose:!!n,includePrerelease:!1}),this.operator==="")return this.value===""?!0:new VO(t.value,n).test(this.value);if(t.operator==="")return t.value===""?!0:new VO(this.value,n).test(t.semver);const i=(this.operator===">="||this.operator===">")&&(t.operator===">="||t.operator===">"),r=(this.operator==="<="||this.operator==="<")&&(t.operator==="<="||t.operator==="<"),o=this.semver.version===t.semver.version,a=(this.operator===">="||this.operator==="<=")&&(t.operator===">="||t.operator==="<="),s=Hy(this.semver,"<",t.semver,n)&&(this.operator===">="||this.operator===">")&&(t.operator==="<="||t.operator==="<"),u=Hy(this.semver,">",t.semver,n)&&(this.operator==="<="||this.operator==="<")&&(t.operator===">="||t.operator===">");return i||r||o&&a||s||u}}var l0=u0;const hU=t0,{re:WO,t:GO}=Xo.exports,Hy=PO,Wy=e0,YO=pn,VO=qi,gU=qi,pU=(e,t,n)=>{try{t=new gU(t,n)}catch(i){return!1}return t.test(e)};var c0=pU;const mU=qi,yU=(e,t)=>new mU(e,t).set.map(n=>n.map(i=>i.value).join(" ").trim().split(" "));var vU=yU;const bU=pn,xU=qi,wU=(e,t,n)=>{let i=null,r=null,o=null;try{o=new xU(t,n)}catch(a){return null}return e.forEach(a=>{o.test(a)&&(!i||r.compare(a)===-1)&&(i=a,r=new bU(i,n))}),i};var EU=wU;const _U=pn,AU=qi,$U=(e,t,n)=>{let i=null,r=null,o=null;try{o=new AU(t,n)}catch(a){return null}return e.forEach(a=>{o.test(a)&&(!i||r.compare(a)===1)&&(i=a,r=new _U(i,n))}),i};var SU=$U;const Gy=pn,OU=qi,XO=r0,CU=(e,t)=>{e=new OU(e,t);let n=new Gy("0.0.0");if(e.test(n)||(n=new Gy("0.0.0-0"),e.test(n)))return n;n=null;for(let i=0;i<e.set.length;++i){const r=e.set[i];let o=null;r.forEach(a=>{const s=new Gy(a.semver.version);switch(a.operator){case">":s.prerelease.length===0?s.patch++:s.prerelease.push(0),s.raw=s.format();case"":case">=":(!o||XO(s,o))&&(o=s);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${a.operator}`)}}),o&&(!n||XO(n,o))&&(n=o)}return n&&e.test(n)?n:null};var FU=CU;const kU=qi,DU=(e,t)=>{try{return new kU(e,t).range||"*"}catch(n){return null}};var MU=DU;const TU=pn,KO=l0,{ANY:NU}=KO,RU=qi,jU=c0,JO=r0,ZO=Py,LU=By,PU=Iy,IU=(e,t,n,i)=>{e=new TU(e,i),t=new RU(t,i);let r,o,a,s,u;switch(n){case">":r=JO,o=LU,a=ZO,s=">",u=">=";break;case"<":r=ZO,o=PU,a=JO,s="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(jU(e,t,i))return!1;for(let l=0;l<t.set.length;++l){const c=t.set[l];let f=null,d=null;if(c.forEach(h=>{h.semver===NU&&(h=new KO(">=0.0.0")),f=f||h,d=d||h,r(h.semver,f.semver,i)?f=h:a(h.semver,d.semver,i)&&(d=h)}),f.operator===s||f.operator===u||(!d.operator||d.operator===s)&&o(e,d.semver))return!1;if(d.operator===u&&a(e,d.semver))return!1}return!0};var Yy=IU;const BU=Yy,zU=(e,t,n)=>BU(e,t,">",n);var UU=zU;const qU=Yy,HU=(e,t,n)=>qU(e,t,"<",n);var WU=HU;const QO=qi,GU=(e,t,n)=>(e=new QO(e,n),t=new QO(t,n),e.intersects(t));var YU=GU;const VU=c0,XU=zi;var KU=(e,t,n)=>{const i=[];let r=null,o=null;const a=e.sort((c,f)=>XU(c,f,n));for(const c of a)VU(c,t,n)?(o=c,r||(r=c)):(o&&i.push([r,o]),o=null,r=null);r&&i.push([r,null]);const s=[];for(const[c,f]of i)c===f?s.push(c):!f&&c===a[0]?s.push("*"):f?c===a[0]?s.push(`<=${f}`):s.push(`${c} - ${f}`):s.push(`>=${c}`);const u=s.join(" || "),l=typeof t.raw=="string"?t.raw:String(t);return u.length<l.length?u:t};const eC=qi,f0=l0,{ANY:Vy}=f0,kc=c0,Xy=zi,JU=(e,t,n={})=>{if(e===t)return!0;e=new eC(e,n),t=new eC(t,n);let i=!1;e:for(const r of e.set){for(const o of t.set){const a=ZU(r,o,n);if(i=i||a!==null,a)continue e}if(i)return!1}return!0},ZU=(e,t,n)=>{if(e===t)return!0;if(e.length===1&&e[0].semver===Vy){if(t.length===1&&t[0].semver===Vy)return!0;n.includePrerelease?e=[new f0(">=0.0.0-0")]:e=[new f0(">=0.0.0")]}if(t.length===1&&t[0].semver===Vy){if(n.includePrerelease)return!0;t=[new f0(">=0.0.0")]}const i=new Set;let r,o;for(const h of e)h.operator===">"||h.operator===">="?r=tC(r,h,n):h.operator==="<"||h.operator==="<="?o=nC(o,h,n):i.add(h.semver);if(i.size>1)return null;let a;if(r&&o){if(a=Xy(r.semver,o.semver,n),a>0)return null;if(a===0&&(r.operator!==">="||o.operator!=="<="))return null}for(const h of i){if(r&&!kc(h,String(r),n)||o&&!kc(h,String(o),n))return null;for(const g of t)if(!kc(h,String(g),n))return!1;return!0}let s,u,l,c,f=o&&!n.includePrerelease&&o.semver.prerelease.length?o.semver:!1,d=r&&!n.includePrerelease&&r.semver.prerelease.length?r.semver:!1;f&&f.prerelease.length===1&&o.operator==="<"&&f.prerelease[0]===0&&(f=!1);for(const h of t){if(c=c||h.operator===">"||h.operator===">=",l=l||h.operator==="<"||h.operator==="<=",r){if(d&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===d.major&&h.semver.minor===d.minor&&h.semver.patch===d.patch&&(d=!1),h.operator===">"||h.operator===">="){if(s=tC(r,h,n),s===h&&s!==r)return!1}else if(r.operator===">="&&!kc(r.semver,String(h),n))return!1}if(o){if(f&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===f.major&&h.semver.minor===f.minor&&h.semver.patch===f.patch&&(f=!1),h.operator==="<"||h.operator==="<="){if(u=nC(o,h,n),u===h&&u!==o)return!1}else if(o.operator==="<="&&!kc(o.semver,String(h),n))return!1}if(!h.operator&&(o||r)&&a!==0)return!1}return!(r&&l&&!o&&a!==0||o&&c&&!r&&a!==0||d||f)},tC=(e,t,n)=>{if(!e)return t;const i=Xy(e.semver,t.semver,n);return i>0?e:i<0||t.operator===">"&&e.operator===">="?t:e},nC=(e,t,n)=>{if(!e)return t;const i=Xy(e.semver,t.semver,n);return i<0?e:i>0||t.operator==="<"&&e.operator==="<="?t:e};var QU=JU;const Ky=Xo.exports;var iC={re:Ky.re,src:Ky.src,tokens:Ky.t,SEMVER_SPEC_VERSION:Qh.SEMVER_SPEC_VERSION,SemVer:pn,compareIdentifiers:Ry.compareIdentifiers,rcompareIdentifiers:Ry.rcompareIdentifiers,parse:Tu,valid:RB,clean:PB,inc:zB,diff:YB,major:KB,minor:QB,patch:nz,prerelease:oz,compare:zi,rcompare:uz,compareLoose:fz,compareBuild:Ly,sort:pz,rsort:vz,gt:r0,lt:Py,eq:jy,neq:LO,gte:Iy,lte:By,cmp:PO,coerce:Iz,Comparator:l0,Range:qi,satisfies:c0,toComparators:vU,maxSatisfying:EU,minSatisfying:SU,minVersion:FU,validRange:MU,outside:Yy,gtr:UU,ltr:WU,intersects:YU,simplifyRange:KU,subset:QU};function jn(e,t,n){return e.fields=t||[],e.fname=n,e}function ut(e){return e==null?null:e.fname}function Xt(e){return e==null?null:e.fields}function rC(e){return e.length===1?eq(e[0]):tq(e)}const eq=e=>function(t){return t[e]},tq=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function I(e){throw Error(e)}function d0(e){const t=[],n=e.length;let i=null,r=0,o="",a,s,u;e=e+"";function l(){t.push(o+e.substring(a,s)),o="",a=s+1}for(a=s=0;s<n;++s)if(u=e[s],u==="\\")o+=e.substring(a,s),o+=e.substring(++s,++s),a=s;else if(u===i)l(),i=null,r=-1;else{if(i)continue;a===r&&u==='"'||a===r&&u==="'"?(a=s+1,i=u):u==="."&&!r?s>a?l():a=s+1:u==="["?(s>a&&l(),r=a=s+1):u==="]"&&(r||I("Access path missing open bracket: "+e),r>0&&l(),r=0,a=s+1)}return r&&I("Access path missing closing bracket: "+e),i&&I("Access path missing closing quote: "+e),s>a&&(s++,l()),t}function Ln(e,t,n){const i=d0(e);return e=i.length===1?i[0]:e,jn((n&&n.get||rC)(i),[e],t||e)}const Dc=Ln("id"),yn=jn(e=>e,[],"identity"),Ko=jn(()=>0,[],"zero"),ju=jn(()=>1,[],"one"),xi=jn(()=>!0,[],"true"),Jo=jn(()=>!1,[],"false");function nq(e,t,n){const i=[t].concat([].slice.call(n));console[e].apply(console,i)}const oC=0,Jy=1,aC=2,sC=3,uC=4;function lC(e,t,n=nq){let i=e||oC;return{level(r){return arguments.length?(i=+r,this):i},error(){return i>=Jy&&n(t||"error","ERROR",arguments),this},warn(){return i>=aC&&n(t||"warn","WARN",arguments),this},info(){return i>=sC&&n(t||"log","INFO",arguments),this},debug(){return i>=uC&&n(t||"log","DEBUG",arguments),this}}}var Q=Array.isArray;function se(e){return e===Object(e)}const cC=e=>e!=="__proto__";function h0(...e){return e.reduce((t,n)=>{for(const i in n)if(i==="signals")t.signals=iq(t.signals,n.signals);else{const r=i==="legend"?{layout:1}:i==="style"?!0:null;Mc(t,i,n[i],r)}return t},{})}function Mc(e,t,n,i){if(!cC(t))return;let r,o;if(se(n)&&!Q(n)){o=se(e[t])?e[t]:e[t]={};for(r in n)i&&(i===!0||i[r])?Mc(o,r,n[r]):cC(r)&&(o[r]=n[r])}else e[t]=n}function iq(e,t){if(e==null)return t;const n={},i=[];function r(o){n[o.name]||(n[o.name]=1,i.push(o))}return t.forEach(r),e.forEach(r),i}function Ee(e){return e[e.length-1]}function Kt(e){return e==null||e===""?null:+e}const fC=e=>t=>e*Math.exp(t),dC=e=>t=>Math.log(e*t),hC=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),gC=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,g0=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function p0(e,t,n,i){const r=n(e[0]),o=n(Ee(e)),a=(o-r)*t;return[i(r-a),i(o-a)]}function pC(e,t){return p0(e,t,Kt,yn)}function mC(e,t){var n=Math.sign(e[0]);return p0(e,t,dC(n),fC(n))}function yC(e,t,n){return p0(e,t,g0(n),g0(1/n))}function vC(e,t,n){return p0(e,t,hC(n),gC(n))}function m0(e,t,n,i,r){const o=i(e[0]),a=i(Ee(e)),s=t!=null?i(t):(o+a)/2;return[r(s+(o-s)*n),r(s+(a-s)*n)]}function Zy(e,t,n){return m0(e,t,n,Kt,yn)}function Qy(e,t,n){const i=Math.sign(e[0]);return m0(e,t,n,dC(i),fC(i))}function y0(e,t,n,i){return m0(e,t,n,g0(i),g0(1/i))}function ev(e,t,n,i){return m0(e,t,n,hC(i),gC(i))}function bC(e){return 1+~~(new Date(e).getMonth()/3)}function xC(e){return 1+~~(new Date(e).getUTCMonth()/3)}function oe(e){return e!=null?Q(e)?e:[e]:[]}function wC(e,t,n){let i=e[0],r=e[1],o;return r<i&&(o=r,r=i,i=o),o=r-i,o>=n-t?[t,n]:[i=Math.min(Math.max(i,t),n-o),i+o]}function me(e){return typeof e=="function"}const rq="descending";function tv(e,t,n){n=n||{},t=oe(t)||[];const i=[],r=[],o={},a=n.comparator||oq;return oe(e).forEach((s,u)=>{s!=null&&(i.push(t[u]===rq?-1:1),r.push(s=me(s)?s:Ln(s,null,n)),(Xt(s)||[]).forEach(l=>o[l]=1))}),r.length===0?null:jn(a(r,i),Object.keys(o))}const v0=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),oq=(e,t)=>e.length===1?aq(e[0],t[0]):sq(e,t,e.length),aq=(e,t)=>function(n,i){return v0(e(n),e(i))*t},sq=(e,t,n)=>(t.push(0),function(i,r){let o,a=0,s=-1;for(;a===0&&++s<n;)o=e[s],a=v0(o(i),o(r));return a*t[s]});function Jt(e){return me(e)?e:()=>e}function nv(e,t){let n;return i=>{n&&clearTimeout(n),n=setTimeout(()=>(t(i),n=null),e)}}function ge(e){for(let t,n,i=1,r=arguments.length;i<r;++i){t=arguments[i];for(n in t)e[n]=t[n]}return e}function vr(e,t){let n=0,i,r,o,a;if(e&&(i=e.length))if(t==null){for(r=e[n];n<i&&(r==null||r!==r);r=e[++n]);for(o=a=r;n<i;++n)r=e[n],r!=null&&(r<o&&(o=r),r>a&&(a=r))}else{for(r=t(e[n]);n<i&&(r==null||r!==r);r=t(e[++n]));for(o=a=r;n<i;++n)r=t(e[n]),r!=null&&(r<o&&(o=r),r>a&&(a=r))}return[o,a]}function EC(e,t){const n=e.length;let i=-1,r,o,a,s,u;if(t==null){for(;++i<n;)if(o=e[i],o!=null&&o>=o){r=a=o;break}if(i===n)return[-1,-1];for(s=u=i;++i<n;)o=e[i],o!=null&&(r>o&&(r=o,s=i),a<o&&(a=o,u=i))}else{for(;++i<n;)if(o=t(e[i],i,e),o!=null&&o>=o){r=a=o;break}if(i===n)return[-1,-1];for(s=u=i;++i<n;)o=t(e[i],i,e),o!=null&&(r>o&&(r=o,s=i),a<o&&(a=o,u=i))}return[s,u]}const uq=Object.prototype.hasOwnProperty;function ae(e,t){return uq.call(e,t)}const b0={};function Lu(e){let t={},n;function i(o){return ae(t,o)&&t[o]!==b0}const r={size:0,empty:0,object:t,has:i,get(o){return i(o)?t[o]:void 0},set(o,a){return i(o)||(++r.size,t[o]===b0&&--r.empty),t[o]=a,this},delete(o){return i(o)&&(--r.size,++r.empty,t[o]=b0),this},clear(){r.size=r.empty=0,r.object=t={}},test(o){return arguments.length?(n=o,r):n},clean(){const o={};let a=0;for(const s in t){const u=t[s];u!==b0&&(!n||!n(u))&&(o[s]=u,++a)}r.size=a,r.empty=0,r.object=t=o}};return e&&Object.keys(e).forEach(o=>{r.set(o,e[o])}),r}function _C(e,t,n,i,r,o){if(!n&&n!==0)return o;const a=+n;let s=e[0],u=Ee(e),l;u<s&&(l=s,s=u,u=l),l=Math.abs(t-s);const c=Math.abs(u-t);return l<c&&l<=a?i:c<=a?r:o}function q(e,t,n){const i=e.prototype=Object.create(t.prototype);return Object.defineProperty(i,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),ge(i,n)}function Pu(e,t,n,i){let r=t[0],o=t[t.length-1],a;return r>o&&(a=r,r=o,o=a),n=n===void 0||n,i=i===void 0||i,(n?r<=e:r<e)&&(i?e<=o:e<o)}function iv(e){return typeof e=="boolean"}function Zo(e){return Object.prototype.toString.call(e)==="[object Date]"}function AC(e){return e&&me(e[Symbol.iterator])}function Qo(e){return typeof e=="number"}function $C(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function Fe(e){return typeof e=="string"}function rv(e,t,n){e&&(e=t?oe(e).map(s=>s.replace(/\\(.)/g,"$1")):oe(e));const i=e&&e.length,r=n&&n.get||rC,o=s=>r(t?[s]:d0(s));let a;if(!i)a=function(){return""};else if(i===1){const s=o(e[0]);a=function(u){return""+s(u)}}else{const s=e.map(o);a=function(u){let l=""+s[0](u),c=0;for(;++c<i;)l+="|"+s[c](u);return l}}return jn(a,e,"key")}function SC(e,t){const n=e[0],i=Ee(e),r=+t;return r?r===1?i:n+r*(i-n):n}const lq=1e4;function OC(e){e=+e||lq;let t,n,i;const r=()=>{t={},n={},i=0},o=(a,s)=>(++i>e&&(n=t,t={},i=1),t[a]=s);return r(),{clear:r,has:a=>ae(t,a)||ae(n,a),get:a=>ae(t,a)?t[a]:ae(n,a)?o(a,n[a]):void 0,set:(a,s)=>ae(t,a)?t[a]=s:o(a,s)}}function CC(e,t,n,i){const r=t.length,o=n.length;if(!o)return t;if(!r)return n;const a=i||new t.constructor(r+o);let s=0,u=0,l=0;for(;s<r&&u<o;++l)a[l]=e(t[s],n[u])>0?n[u++]:t[s++];for(;s<r;++s,++l)a[l]=t[s];for(;u<o;++u,++l)a[l]=n[u];return a}function Tc(e,t){let n="";for(;--t>=0;)n+=e;return n}function FC(e,t,n,i){const r=n||" ",o=e+"",a=t-o.length;return a<=0?o:i==="left"?Tc(r,a)+o:i==="center"?Tc(r,~~(a/2))+o+Tc(r,Math.ceil(a/2)):o+Tc(r,a)}function Nc(e){return e&&Ee(e)-e[0]||0}function ne(e){return Q(e)?"["+e.map(ne)+"]":se(e)||Fe(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function ov(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const cq=e=>Qo(e)||Zo(e)?e:Date.parse(e);function av(e,t){return t=t||cq,e==null||e===""?null:t(e)}function sv(e){return e==null||e===""?null:e+""}function Hi(e){const t={},n=e.length;for(let i=0;i<n;++i)t[e[i]]=!0;return t}function kC(e,t,n,i){const r=i!=null?i:"\u2026",o=e+"",a=o.length,s=Math.max(0,t-r.length);return a<=t?o:n==="left"?r+o.slice(a-s):n==="center"?o.slice(0,Math.ceil(s/2))+r+o.slice(a-~~(s/2)):o.slice(0,s)+r}function ea(e,t,n){if(e)if(t){const i=e.length;for(let r=0;r<i;++r){const o=t(e[r]);o&&n(o,r,e)}}else e.forEach(n)}var DC={},uv={},lv=34,Rc=10,cv=13;function MC(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function fq(e,t){var n=MC(e);return function(i,r){return t(n(i),r,e)}}function TC(e){var t=Object.create(null),n=[];return e.forEach(function(i){for(var r in i)r in t||n.push(t[r]=r)}),n}function Pn(e,t){var n=e+"",i=n.length;return i<t?new Array(t-i+1).join(0)+n:n}function dq(e){return e<0?"-"+Pn(-e,6):e>9999?"+"+Pn(e,6):Pn(e,4)}function hq(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),i=e.getUTCSeconds(),r=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":dq(e.getUTCFullYear())+"-"+Pn(e.getUTCMonth()+1,2)+"-"+Pn(e.getUTCDate(),2)+(r?"T"+Pn(t,2)+":"+Pn(n,2)+":"+Pn(i,2)+"."+Pn(r,3)+"Z":i?"T"+Pn(t,2)+":"+Pn(n,2)+":"+Pn(i,2)+"Z":n||t?"T"+Pn(t,2)+":"+Pn(n,2)+"Z":"")}function gq(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function i(f,d){var h,g,p=r(f,function(m,y){if(h)return h(m,y-1);g=m,h=d?fq(m,d):MC(m)});return p.columns=g||[],p}function r(f,d){var h=[],g=f.length,p=0,m=0,y,v=g<=0,b=!1;f.charCodeAt(g-1)===Rc&&--g,f.charCodeAt(g-1)===cv&&--g;function x(){if(v)return uv;if(b)return b=!1,DC;var _,E=p,$;if(f.charCodeAt(E)===lv){for(;p++<g&&f.charCodeAt(p)!==lv||f.charCodeAt(++p)===lv;);return(_=p)>=g?v=!0:($=f.charCodeAt(p++))===Rc?b=!0:$===cv&&(b=!0,f.charCodeAt(p)===Rc&&++p),f.slice(E+1,_-1).replace(/""/g,'"')}for(;p<g;){if(($=f.charCodeAt(_=p++))===Rc)b=!0;else if($===cv)b=!0,f.charCodeAt(p)===Rc&&++p;else if($!==n)continue;return f.slice(E,_)}return v=!0,f.slice(E,g)}for(;(y=x())!==uv;){for(var w=[];y!==DC&&y!==uv;)w.push(y),y=x();d&&(w=d(w,m++))==null||h.push(w)}return h}function o(f,d){return f.map(function(h){return d.map(function(g){return c(h[g])}).join(e)})}function a(f,d){return d==null&&(d=TC(f)),[d.map(c).join(e)].concat(o(f,d)).join(`
`)}function s(f,d){return d==null&&(d=TC(f)),o(f,d).join(`
`)}function u(f){return f.map(l).join(`
`)}function l(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?hq(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:i,parseRows:r,format:a,formatBody:s,formatRows:u,formatRow:l,formatValue:c}}function pq(e){return e}function mq(e){if(e==null)return pq;var t,n,i=e.scale[0],r=e.scale[1],o=e.translate[0],a=e.translate[1];return function(s,u){u||(t=n=0);var l=2,c=s.length,f=new Array(c);for(f[0]=(t+=s[0])*i+o,f[1]=(n+=s[1])*r+a;l<c;)f[l]=s[l],++l;return f}}function yq(e,t){for(var n,i=e.length,r=i-t;r<--i;)n=e[r],e[r++]=e[i],e[i]=n}function vq(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return NC(e,n)})}:NC(e,t)}function NC(e,t){var n=t.id,i=t.bbox,r=t.properties==null?{}:t.properties,o=RC(e,t);return n==null&&i==null?{type:"Feature",properties:r,geometry:o}:i==null?{type:"Feature",id:n,properties:r,geometry:o}:{type:"Feature",id:n,bbox:i,properties:r,geometry:o}}function RC(e,t){var n=mq(e.transform),i=e.arcs;function r(c,f){f.length&&f.pop();for(var d=i[c<0?~c:c],h=0,g=d.length;h<g;++h)f.push(n(d[h],h));c<0&&yq(f,g)}function o(c){return n(c)}function a(c){for(var f=[],d=0,h=c.length;d<h;++d)r(c[d],f);return f.length<2&&f.push(f[0]),f}function s(c){for(var f=a(c);f.length<4;)f.push(f[0]);return f}function u(c){return c.map(s)}function l(c){var f=c.type,d;switch(f){case"GeometryCollection":return{type:f,geometries:c.geometries.map(l)};case"Point":d=o(c.coordinates);break;case"MultiPoint":d=c.coordinates.map(o);break;case"LineString":d=a(c.arcs);break;case"MultiLineString":d=c.arcs.map(a);break;case"Polygon":d=u(c.arcs);break;case"MultiPolygon":d=c.arcs.map(u);break;default:return null}return{type:f,coordinates:d}}return l(t)}function bq(e,t){var n={},i={},r={},o=[],a=-1;t.forEach(function(l,c){var f=e.arcs[l<0?~l:l],d;f.length<3&&!f[1][0]&&!f[1][1]&&(d=t[++a],t[a]=l,t[c]=d)}),t.forEach(function(l){var c=s(l),f=c[0],d=c[1],h,g;if(h=r[f])if(delete r[h.end],h.push(l),h.end=d,g=i[d]){delete i[g.start];var p=g===h?h:h.concat(g);i[p.start=h.start]=r[p.end=g.end]=p}else i[h.start]=r[h.end]=h;else if(h=i[d])if(delete i[h.start],h.unshift(l),h.start=f,g=r[f]){delete r[g.end];var m=g===h?h:g.concat(h);i[m.start=g.start]=r[m.end=h.end]=m}else i[h.start]=r[h.end]=h;else h=[l],i[h.start=f]=r[h.end=d]=h});function s(l){var c=e.arcs[l<0?~l:l],f=c[0],d;return e.transform?(d=[0,0],c.forEach(function(h){d[0]+=h[0],d[1]+=h[1]})):d=c[c.length-1],l<0?[d,f]:[f,d]}function u(l,c){for(var f in l){var d=l[f];delete c[d.start],delete d.start,delete d.end,d.forEach(function(h){n[h<0?~h:h]=1}),o.push(d)}}return u(r,i),u(i,r),t.forEach(function(l){n[l<0?~l:l]||o.push([l])}),o}function xq(e){return RC(e,wq.apply(this,arguments))}function wq(e,t,n){var i,r,o;if(arguments.length>1)i=Eq(e,t,n);else for(r=0,i=new Array(o=e.arcs.length);r<o;++r)i[r]=r;return{type:"MultiLineString",arcs:bq(e,i)}}function Eq(e,t,n){var i=[],r=[],o;function a(f){var d=f<0?~f:f;(r[d]||(r[d]=[])).push({i:f,g:o})}function s(f){f.forEach(a)}function u(f){f.forEach(s)}function l(f){f.forEach(u)}function c(f){switch(o=f,f.type){case"GeometryCollection":f.geometries.forEach(c);break;case"LineString":s(f.arcs);break;case"MultiLineString":case"Polygon":u(f.arcs);break;case"MultiPolygon":l(f.arcs);break}}return c(t),r.forEach(n==null?function(f){i.push(f[0].i)}:function(f){n(f[0].g,f[f.length-1].g)&&i.push(f[0].i)}),i}var _q=Math.sqrt(50),Aq=Math.sqrt(10),$q=Math.sqrt(2);function Sq(e,t,n){var i=Math.abs(t-e)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),o=i/r;return o>=_q?r*=10:o>=Aq?r*=5:o>=$q&&(r*=2),t<e?-r:r}function Oq(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function x0(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,i=e.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+e.slice(n+1)]}function Iu(e){return e=x0(Math.abs(e)),e?e[1]:NaN}function Cq(e,t){return function(n,i){for(var r=n.length,o=[],a=0,s=e[0],u=0;r>0&&s>0&&(u+s+1>i&&(s=Math.max(1,i-u)),o.push(n.substring(r-=s,r+s)),!((u+=s+1)>i));)s=e[a=(a+1)%e.length];return o.reverse().join(t)}}function Fq(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var kq=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function jc(e){if(!(t=kq.exec(e)))throw new Error("invalid format: "+e);var t;return new fv({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}jc.prototype=fv.prototype;function fv(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}fv.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Dq(e){e:for(var t=e.length,n=1,i=-1,r;n<t;++n)switch(e[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+e[n])break e;i>0&&(i=0);break}return i>0?e.slice(0,i)+e.slice(r+1):e}var jC;function Mq(e,t){var n=x0(e,t);if(!n)return e+"";var i=n[0],r=n[1],o=r-(jC=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,a=i.length;return o===a?i:o>a?i+new Array(o-a+1).join("0"):o>0?i.slice(0,o)+"."+i.slice(o):"0."+new Array(1-o).join("0")+x0(e,Math.max(0,t+o-1))[0]}function LC(e,t){var n=x0(e,t);if(!n)return e+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}var PC={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Oq,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>LC(e*100,t),r:LC,s:Mq,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function IC(e){return e}var BC=Array.prototype.map,zC=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function UC(e){var t=e.grouping===void 0||e.thousands===void 0?IC:Cq(BC.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",i=e.currency===void 0?"":e.currency[1]+"",r=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?IC:Fq(BC.call(e.numerals,String)),a=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"\u2212":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function l(f){f=jc(f);var d=f.fill,h=f.align,g=f.sign,p=f.symbol,m=f.zero,y=f.width,v=f.comma,b=f.precision,x=f.trim,w=f.type;w==="n"?(v=!0,w="g"):PC[w]||(b===void 0&&(b=12),x=!0,w="g"),(m||d==="0"&&h==="=")&&(m=!0,d="0",h="=");var _=p==="$"?n:p==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",E=p==="$"?i:/[%p]/.test(w)?a:"",$=PC[w],O=/[defgprs%]/.test(w);b=b===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function C(A){var D=_,F=E,T,S,M;if(w==="c")F=$(A)+F,A="";else{A=+A;var P=A<0||1/A<0;if(A=isNaN(A)?u:$(Math.abs(A),b),x&&(A=Dq(A)),P&&+A==0&&g!=="+"&&(P=!1),D=(P?g==="("?g:s:g==="-"||g==="("?"":g)+D,F=(w==="s"?zC[8+jC/3]:"")+F+(P&&g==="("?")":""),O){for(T=-1,S=A.length;++T<S;)if(M=A.charCodeAt(T),48>M||M>57){F=(M===46?r+A.slice(T+1):A.slice(T))+F,A=A.slice(0,T);break}}}v&&!m&&(A=t(A,1/0));var B=D.length+A.length+F.length,H=B<y?new Array(y-B+1).join(d):"";switch(v&&m&&(A=t(H+A,H.length?y-F.length:1/0),H=""),h){case"<":A=D+A+F+H;break;case"=":A=D+H+A+F;break;case"^":A=H.slice(0,B=H.length>>1)+D+A+F+H.slice(B);break;default:A=H+D+A+F;break}return o(A)}return C.toString=function(){return f+""},C}function c(f,d){var h=l((f=jc(f),f.type="f",f)),g=Math.max(-8,Math.min(8,Math.floor(Iu(d)/3)))*3,p=Math.pow(10,-g),m=zC[8+g/3];return function(y){return h(p*y)+m}}return{format:l,formatPrefix:c}}var w0,qC,HC;Tq({thousands:",",grouping:[3],currency:["$",""]});function Tq(e){return w0=UC(e),qC=w0.format,HC=w0.formatPrefix,w0}function Nq(e){return Math.max(0,-Iu(Math.abs(e)))}function Rq(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Iu(t)/3)))*3-Iu(Math.abs(e)))}function jq(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Iu(t)-Iu(e))+1}var dv=new Date,hv=new Date;function Ft(e,t,n,i){function r(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return r.floor=function(o){return e(o=new Date(+o)),o},r.ceil=function(o){return e(o=new Date(o-1)),t(o,1),e(o),o},r.round=function(o){var a=r(o),s=r.ceil(o);return o-a<s-o?a:s},r.offset=function(o,a){return t(o=new Date(+o),a==null?1:Math.floor(a)),o},r.range=function(o,a,s){var u=[],l;if(o=r.ceil(o),s=s==null?1:Math.floor(s),!(o<a)||!(s>0))return u;do u.push(l=new Date(+o)),t(o,s),e(o);while(l<o&&o<a);return u},r.filter=function(o){return Ft(function(a){if(a>=a)for(;e(a),!o(a);)a.setTime(a-1)},function(a,s){if(a>=a)if(s<0)for(;++s<=0;)for(;t(a,-1),!o(a););else for(;--s>=0;)for(;t(a,1),!o(a););})},n&&(r.count=function(o,a){return dv.setTime(+o),hv.setTime(+a),e(dv),e(hv),Math.floor(n(dv,hv))},r.every=function(o){return o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?r.filter(i?function(a){return i(a)%o==0}:function(a){return r.count(0,a)%o==0}):r}),r}var gv=Ft(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});gv.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Ft(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):gv};var WC=gv;const Lc=1e3,ta=Lc*60,Pc=ta*60,pv=Pc*24,GC=pv*7;var Lq=Ft(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*Lc)},function(e,t){return(t-e)/Lc},function(e){return e.getUTCSeconds()}),YC=Lq,Pq=Ft(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Lc)},function(e,t){e.setTime(+e+t*ta)},function(e,t){return(t-e)/ta},function(e){return e.getMinutes()}),Iq=Pq,Bq=Ft(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Lc-e.getMinutes()*ta)},function(e,t){e.setTime(+e+t*Pc)},function(e,t){return(t-e)/Pc},function(e){return e.getHours()}),zq=Bq,Uq=Ft(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*ta)/pv,e=>e.getDate()-1),E0=Uq;function us(e){return Ft(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+n*7)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*ta)/GC})}var VC=us(0);us(1);us(2);us(3);us(4);us(5);us(6);var qq=Ft(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()}),XC=qq,KC=Ft(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});KC.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:Ft(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)})};var Hq=KC,Wq=Ft(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*ta)},function(e,t){return(t-e)/ta},function(e){return e.getUTCMinutes()}),Gq=Wq,Yq=Ft(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*Pc)},function(e,t){return(t-e)/Pc},function(e){return e.getUTCHours()}),Vq=Yq,Xq=Ft(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/pv},function(e){return e.getUTCDate()-1}),_0=Xq;function ls(e){return Ft(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n*7)},function(t,n){return(n-t)/GC})}var JC=ls(0);ls(1);ls(2);ls(3);ls(4);ls(5);ls(6);var Kq=Ft(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12},function(e){return e.getUTCMonth()}),ZC=Kq,QC=Ft(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});QC.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:Ft(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})};var Jq=QC;function Zq(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Qq(e){let t=e,n=e;e.length===1&&(t=(a,s)=>e(a)-s,n=eH(e));function i(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)<0?u=c+1:l=c}return u}function r(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)>0?l=c:u=c+1}return u}function o(a,s,u,l){u==null&&(u=0),l==null&&(l=a.length);const c=i(a,s,u,l-1);return c>u&&t(a[c-1],s)>-t(a[c],s)?c-1:c}return{left:i,center:o,right:r}}function eH(e){return(t,n)=>Zq(e(t),n)}var tH=Math.sqrt(50),nH=Math.sqrt(10),iH=Math.sqrt(2);function eF(e,t,n){var i=Math.abs(t-e)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),o=i/r;return o>=tH?r*=10:o>=nH?r*=5:o>=iH&&(r*=2),t<e?-r:r}const zt="year",In="quarter",Zt="month",xt="week",Bn="date",Qt="day",br="dayofyear",ri="hours",oi="minutes",wi="seconds",Wi="milliseconds",mv=[zt,In,Zt,xt,Bn,Qt,br,ri,oi,wi,Wi],yv=mv.reduce((e,t,n)=>(e[t]=1+n,e),{});function vv(e){const t=oe(e).slice(),n={};return t.length||I("Missing time unit."),t.forEach(r=>{ae(yv,r)?n[r]=1:I("Invalid time unit: ".concat(r,"."))}),(n[xt]||n[Qt]?1:0)+(n[In]||n[Zt]||n[Bn]?1:0)+(n[br]?1:0)>1&&I("Incompatible time units: ".concat(e)),t.sort((r,o)=>yv[r]-yv[o]),t}const rH={[zt]:"%Y ",[In]:"Q%q ",[Zt]:"%b ",[Bn]:"%d ",[xt]:"W%U ",[Qt]:"%a ",[br]:"%j ",[ri]:"%H:00",[oi]:"00:%M",[wi]:":%S",[Wi]:".%L",["".concat(zt,"-").concat(Zt)]:"%Y-%m ",["".concat(zt,"-").concat(Zt,"-").concat(Bn)]:"%Y-%m-%d ",["".concat(ri,"-").concat(oi)]:"%H:%M"};function tF(e,t){const n=ge({},rH,t),i=vv(e),r=i.length;let o="",a=0,s,u;for(a=0;a<r;)for(s=i.length;s>a;--s)if(u=i.slice(a,s).join("-"),n[u]!=null){o+=n[u],a=s;break}return o.trim()}const cs=new Date;function bv(e){return cs.setFullYear(e),cs.setMonth(0),cs.setDate(1),cs.setHours(0,0,0,0),cs}function nF(e){return rF(new Date(e))}function iF(e){return xv(new Date(e))}function rF(e){return E0.count(bv(e.getFullYear())-1,e)}function xv(e){return VC.count(bv(e.getFullYear())-1,e)}function wv(e){return bv(e).getDay()}function oH(e,t,n,i,r,o,a){if(0<=e&&e<100){const s=new Date(-1,t,n,i,r,o,a);return s.setFullYear(e),s}return new Date(e,t,n,i,r,o,a)}function oF(e){return sF(new Date(e))}function aF(e){return Ev(new Date(e))}function sF(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return _0.count(t-1,e)}function Ev(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return JC.count(t-1,e)}function _v(e){return cs.setTime(Date.UTC(e,0,1)),cs.getUTCDay()}function aH(e,t,n,i,r,o,a){if(0<=e&&e<100){const s=new Date(Date.UTC(-1,t,n,i,r,o,a));return s.setUTCFullYear(n.y),s}return new Date(Date.UTC(e,t,n,i,r,o,a))}function uF(e,t,n,i,r){const o=t||1,a=Ee(e),s=(y,v,b)=>(b=b||y,sH(n[b],i[b],y===a&&o,v)),u=new Date,l=Hi(e),c=l[zt]?s(zt):Jt(2012),f=l[Zt]?s(Zt):l[In]?s(In):Ko,d=l[xt]&&l[Qt]?s(Qt,1,xt+Qt):l[xt]?s(xt,1):l[Qt]?s(Qt,1):l[Bn]?s(Bn,1):l[br]?s(br,1):ju,h=l[ri]?s(ri):Ko,g=l[oi]?s(oi):Ko,p=l[wi]?s(wi):Ko,m=l[Wi]?s(Wi):Ko;return function(y){u.setTime(+y);const v=c(u);return r(v,f(u),d(u,v),h(u),g(u),p(u),m(u))}}function sH(e,t,n,i){const r=n<=1?e:i?(o,a)=>i+n*Math.floor((e(o,a)-i)/n):(o,a)=>n*Math.floor(e(o,a)/n);return t?(o,a)=>t(r(o,a),a):r}function Bu(e,t,n){return t+e*7-(n+6)%7}const uH={[zt]:e=>e.getFullYear(),[In]:e=>Math.floor(e.getMonth()/3),[Zt]:e=>e.getMonth(),[Bn]:e=>e.getDate(),[ri]:e=>e.getHours(),[oi]:e=>e.getMinutes(),[wi]:e=>e.getSeconds(),[Wi]:e=>e.getMilliseconds(),[br]:e=>rF(e),[xt]:e=>xv(e),[xt+Qt]:(e,t)=>Bu(xv(e),e.getDay(),wv(t)),[Qt]:(e,t)=>Bu(1,e.getDay(),wv(t))},lH={[In]:e=>3*e,[xt]:(e,t)=>Bu(e,0,wv(t))};function lF(e,t){return uF(e,t||1,uH,lH,oH)}const cH={[zt]:e=>e.getUTCFullYear(),[In]:e=>Math.floor(e.getUTCMonth()/3),[Zt]:e=>e.getUTCMonth(),[Bn]:e=>e.getUTCDate(),[ri]:e=>e.getUTCHours(),[oi]:e=>e.getUTCMinutes(),[wi]:e=>e.getUTCSeconds(),[Wi]:e=>e.getUTCMilliseconds(),[br]:e=>sF(e),[xt]:e=>Ev(e),[Qt]:(e,t)=>Bu(1,e.getUTCDay(),_v(t)),[xt+Qt]:(e,t)=>Bu(Ev(e),e.getUTCDay(),_v(t))},fH={[In]:e=>3*e,[xt]:(e,t)=>Bu(e,0,_v(t))};function cF(e,t){return uF(e,t||1,cH,fH,aH)}const dH={[zt]:Hq,[In]:XC.every(3),[Zt]:XC,[xt]:VC,[Bn]:E0,[Qt]:E0,[br]:E0,[ri]:zq,[oi]:Iq,[wi]:YC,[Wi]:WC},hH={[zt]:Jq,[In]:ZC.every(3),[Zt]:ZC,[xt]:JC,[Bn]:_0,[Qt]:_0,[br]:_0,[ri]:Vq,[oi]:Gq,[wi]:YC,[Wi]:WC};function zu(e){return dH[e]}function Uu(e){return hH[e]}function fF(e,t,n){return e?e.offset(t,n):void 0}function dF(e,t,n){return fF(zu(e),t,n)}function hF(e,t,n){return fF(Uu(e),t,n)}function gF(e,t,n,i){return e?e.range(t,n,i):void 0}function pF(e,t,n,i){return gF(zu(e),t,n,i)}function mF(e,t,n,i){return gF(Uu(e),t,n,i)}const Ic=1e3,Bc=Ic*60,zc=Bc*60,A0=zc*24,gH=A0*7,yF=A0*30,Av=A0*365,vF=[zt,Zt,Bn,ri,oi,wi,Wi],Uc=vF.slice(0,-1),qc=Uc.slice(0,-1),Hc=qc.slice(0,-1),pH=Hc.slice(0,-1),mH=[zt,xt],bF=[zt,Zt],xF=[zt],Wc=[[Uc,1,Ic],[Uc,5,5*Ic],[Uc,15,15*Ic],[Uc,30,30*Ic],[qc,1,Bc],[qc,5,5*Bc],[qc,15,15*Bc],[qc,30,30*Bc],[Hc,1,zc],[Hc,3,3*zc],[Hc,6,6*zc],[Hc,12,12*zc],[pH,1,A0],[mH,1,gH],[bF,1,yF],[bF,3,3*yF],[xF,1,Av]];function wF(e){const t=e.extent,n=e.maxbins||40,i=Math.abs(Nc(t))/n;let r=Qq(s=>s[2]).right(Wc,i),o,a;return r===Wc.length?(o=xF,a=eF(t[0]/Av,t[1]/Av,n)):r?(r=Wc[i/Wc[r-1][2]<Wc[r][2]/i?r-1:r],o=r[0],a=r[1]):(o=vF,a=Math.max(eF(t[0],t[1],n),1)),{units:o,step:a}}var $v=new Date,Sv=new Date;function ho(e,t,n,i){function r(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return r.floor=function(o){return e(o=new Date(+o)),o},r.ceil=function(o){return e(o=new Date(o-1)),t(o,1),e(o),o},r.round=function(o){var a=r(o),s=r.ceil(o);return o-a<s-o?a:s},r.offset=function(o,a){return t(o=new Date(+o),a==null?1:Math.floor(a)),o},r.range=function(o,a,s){var u=[],l;if(o=r.ceil(o),s=s==null?1:Math.floor(s),!(o<a)||!(s>0))return u;do u.push(l=new Date(+o)),t(o,s),e(o);while(l<o&&o<a);return u},r.filter=function(o){return ho(function(a){if(a>=a)for(;e(a),!o(a);)a.setTime(a-1)},function(a,s){if(a>=a)if(s<0)for(;++s<=0;)for(;t(a,-1),!o(a););else for(;--s>=0;)for(;t(a,1),!o(a););})},n&&(r.count=function(o,a){return $v.setTime(+o),Sv.setTime(+a),e($v),e(Sv),Math.floor(n($v,Sv))},r.every=function(o){return o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?r.filter(i?function(a){return i(a)%o==0}:function(a){return r.count(0,a)%o==0}):r}),r}const yH=1e3,Ov=yH*60,vH=Ov*60,Cv=vH*24,EF=Cv*7;var bH=ho(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ov)/Cv,e=>e.getDate()-1),_F=bH;function fs(e){return ho(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+n*7)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Ov)/EF})}var xH=fs(0),Fv=fs(1);fs(2);fs(3);var Gc=fs(4);fs(5);fs(6);var AF=ho(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});AF.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:ho(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)})};var Yc=AF,wH=ho(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/Cv},function(e){return e.getUTCDate()-1}),$F=wH;function ds(e){return ho(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n*7)},function(t,n){return(n-t)/EF})}var EH=ds(0),kv=ds(1);ds(2);ds(3);var Vc=ds(4);ds(5);ds(6);var SF=ho(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});SF.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:ho(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})};var Xc=SF;function Dv(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Mv(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Kc(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function OF(e){var t=e.dateTime,n=e.date,i=e.time,r=e.periods,o=e.days,a=e.shortDays,s=e.months,u=e.shortMonths,l=Jc(r),c=Zc(r),f=Jc(o),d=Zc(o),h=Jc(a),g=Zc(a),p=Jc(s),m=Zc(s),y=Jc(u),v=Zc(u),b={a:P,A:B,b:H,B:re,c:null,d:TF,e:TF,f:WH,g:tW,G:iW,H:UH,I:qH,j:HH,L:NF,m:GH,M:YH,p:le,q:he,Q:BF,s:zF,S:VH,u:XH,U:KH,V:JH,w:ZH,W:QH,x:null,X:null,y:eW,Y:nW,Z:rW,"%":IF},x={a:Ae,A:$e,b:Pe,B:It,c:null,d:jF,e:jF,f:uW,g:vW,G:xW,H:oW,I:aW,j:sW,L:LF,m:lW,M:cW,p:ti,q:Nn,Q:BF,s:zF,S:fW,u:dW,U:hW,V:gW,w:pW,W:mW,x:null,X:null,y:yW,Y:bW,Z:wW,"%":IF},w={a:C,A,b:D,B:F,c:T,d:DF,e:DF,f:PH,g:kF,G:FF,H:MF,I:MF,j:NH,L:LH,m:TH,M:RH,p:O,q:MH,Q:BH,s:zH,S:jH,u:OH,U:CH,V:FH,w:SH,W:kH,x:S,X:M,y:kF,Y:FF,Z:DH,"%":IH};b.x=_(n,b),b.X=_(i,b),b.c=_(t,b),x.x=_(n,x),x.X=_(i,x),x.c=_(t,x);function _(R,W){return function(V){var k=[],xe=-1,X=0,Ce=R.length,we,Yt,bi;for(V instanceof Date||(V=new Date(+V));++xe<Ce;)R.charCodeAt(xe)===37&&(k.push(R.slice(X,xe)),(Yt=CF[we=R.charAt(++xe)])!=null?we=R.charAt(++xe):Yt=we==="e"?" ":"0",(bi=W[we])&&(we=bi(V,Yt)),k.push(we),X=xe+1);return k.push(R.slice(X,xe)),k.join("")}}function E(R,W){return function(V){var k=Kc(1900,void 0,1),xe=$(k,R,V+="",0),X,Ce;if(xe!=V.length)return null;if("Q"in k)return new Date(k.Q);if("s"in k)return new Date(k.s*1e3+("L"in k?k.L:0));if(W&&!("Z"in k)&&(k.Z=0),"p"in k&&(k.H=k.H%12+k.p*12),k.m===void 0&&(k.m="q"in k?k.q:0),"V"in k){if(k.V<1||k.V>53)return null;"w"in k||(k.w=1),"Z"in k?(X=Mv(Kc(k.y,0,1)),Ce=X.getUTCDay(),X=Ce>4||Ce===0?kv.ceil(X):kv(X),X=$F.offset(X,(k.V-1)*7),k.y=X.getUTCFullYear(),k.m=X.getUTCMonth(),k.d=X.getUTCDate()+(k.w+6)%7):(X=Dv(Kc(k.y,0,1)),Ce=X.getDay(),X=Ce>4||Ce===0?Fv.ceil(X):Fv(X),X=_F.offset(X,(k.V-1)*7),k.y=X.getFullYear(),k.m=X.getMonth(),k.d=X.getDate()+(k.w+6)%7)}else("W"in k||"U"in k)&&("w"in k||(k.w="u"in k?k.u%7:"W"in k?1:0),Ce="Z"in k?Mv(Kc(k.y,0,1)).getUTCDay():Dv(Kc(k.y,0,1)).getDay(),k.m=0,k.d="W"in k?(k.w+6)%7+k.W*7-(Ce+5)%7:k.w+k.U*7-(Ce+6)%7);return"Z"in k?(k.H+=k.Z/100|0,k.M+=k.Z%100,Mv(k)):Dv(k)}}function $(R,W,V,k){for(var xe=0,X=W.length,Ce=V.length,we,Yt;xe<X;){if(k>=Ce)return-1;if(we=W.charCodeAt(xe++),we===37){if(we=W.charAt(xe++),Yt=w[we in CF?W.charAt(xe++):we],!Yt||(k=Yt(R,V,k))<0)return-1}else if(we!=V.charCodeAt(k++))return-1}return k}function O(R,W,V){var k=l.exec(W.slice(V));return k?(R.p=c.get(k[0].toLowerCase()),V+k[0].length):-1}function C(R,W,V){var k=h.exec(W.slice(V));return k?(R.w=g.get(k[0].toLowerCase()),V+k[0].length):-1}function A(R,W,V){var k=f.exec(W.slice(V));return k?(R.w=d.get(k[0].toLowerCase()),V+k[0].length):-1}function D(R,W,V){var k=y.exec(W.slice(V));return k?(R.m=v.get(k[0].toLowerCase()),V+k[0].length):-1}function F(R,W,V){var k=p.exec(W.slice(V));return k?(R.m=m.get(k[0].toLowerCase()),V+k[0].length):-1}function T(R,W,V){return $(R,t,W,V)}function S(R,W,V){return $(R,n,W,V)}function M(R,W,V){return $(R,i,W,V)}function P(R){return a[R.getDay()]}function B(R){return o[R.getDay()]}function H(R){return u[R.getMonth()]}function re(R){return s[R.getMonth()]}function le(R){return r[+(R.getHours()>=12)]}function he(R){return 1+~~(R.getMonth()/3)}function Ae(R){return a[R.getUTCDay()]}function $e(R){return o[R.getUTCDay()]}function Pe(R){return u[R.getUTCMonth()]}function It(R){return s[R.getUTCMonth()]}function ti(R){return r[+(R.getUTCHours()>=12)]}function Nn(R){return 1+~~(R.getUTCMonth()/3)}return{format:function(R){var W=_(R+="",b);return W.toString=function(){return R},W},parse:function(R){var W=E(R+="",!1);return W.toString=function(){return R},W},utcFormat:function(R){var W=_(R+="",x);return W.toString=function(){return R},W},utcParse:function(R){var W=E(R+="",!0);return W.toString=function(){return R},W}}}var CF={"-":"",_:" ","0":"0"},kt=/^\s*\d+/,_H=/^%/,AH=/[\\^$*+?|[\]().{}]/g;function Me(e,t,n){var i=e<0?"-":"",r=(i?-e:e)+"",o=r.length;return i+(o<n?new Array(n-o+1).join(t)+r:r)}function $H(e){return e.replace(AH,"\\$&")}function Jc(e){return new RegExp("^(?:"+e.map($H).join("|")+")","i")}function Zc(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function SH(e,t,n){var i=kt.exec(t.slice(n,n+1));return i?(e.w=+i[0],n+i[0].length):-1}function OH(e,t,n){var i=kt.exec(t.slice(n,n+1));return i?(e.u=+i[0],n+i[0].length):-1}function CH(e,t,n){var i=kt.exec(t.slice(n,n+2));return i?(e.U=+i[0],n+i[0].length):-1}function FH(e,t,n){var i=kt.exec(t.slice(n,n+2));return i?(e.V=+i[0],n+i[0].length):-1}function kH(e,t,n){var i=kt.exec(t.slice(n,n+2));return i?(e.W=+i[0],n+i[0].length):-1}function FF(e,t,n){var i=kt.exec(t.slice(n,n+4));return i?(e.y=+i[0],n+i[0].length):-1}function kF(e,t,n){var i=kt.exec(t.slice(n,n+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function DH(e,t,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function MH(e,t,n){var i=kt.exec(t.slice(n,n+1));return i?(e.q=i[0]*3-3,n+i[0].length):-1}function TH(e,t,n){var i=kt.exec(t.slice(n,n+2));return i?(e.m=i[0]-1,n+i[0].length):-1}function DF(e,t,n){var i=kt.exec(t.slice(n,n+2));return i?(e.d=+i[0],n+i[0].length):-1}function NH(e,t,n){var i=kt.exec(t.slice(n,n+3));return i?(e.m=0,e.d=+i[0],n+i[0].length):-1}function MF(e,t,n){var i=kt.exec(t.slice(n,n+2));return i?(e.H=+i[0],n+i[0].length):-1}function RH(e,t,n){var i=kt.exec(t.slice(n,n+2));return i?(e.M=+i[0],n+i[0].length):-1}function jH(e,t,n){var i=kt.exec(t.slice(n,n+2));return i?(e.S=+i[0],n+i[0].length):-1}function LH(e,t,n){var i=kt.exec(t.slice(n,n+3));return i?(e.L=+i[0],n+i[0].length):-1}function PH(e,t,n){var i=kt.exec(t.slice(n,n+6));return i?(e.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function IH(e,t,n){var i=_H.exec(t.slice(n,n+1));return i?n+i[0].length:-1}function BH(e,t,n){var i=kt.exec(t.slice(n));return i?(e.Q=+i[0],n+i[0].length):-1}function zH(e,t,n){var i=kt.exec(t.slice(n));return i?(e.s=+i[0],n+i[0].length):-1}function TF(e,t){return Me(e.getDate(),t,2)}function UH(e,t){return Me(e.getHours(),t,2)}function qH(e,t){return Me(e.getHours()%12||12,t,2)}function HH(e,t){return Me(1+_F.count(Yc(e),e),t,3)}function NF(e,t){return Me(e.getMilliseconds(),t,3)}function WH(e,t){return NF(e,t)+"000"}function GH(e,t){return Me(e.getMonth()+1,t,2)}function YH(e,t){return Me(e.getMinutes(),t,2)}function VH(e,t){return Me(e.getSeconds(),t,2)}function XH(e){var t=e.getDay();return t===0?7:t}function KH(e,t){return Me(xH.count(Yc(e)-1,e),t,2)}function RF(e){var t=e.getDay();return t>=4||t===0?Gc(e):Gc.ceil(e)}function JH(e,t){return e=RF(e),Me(Gc.count(Yc(e),e)+(Yc(e).getDay()===4),t,2)}function ZH(e){return e.getDay()}function QH(e,t){return Me(Fv.count(Yc(e)-1,e),t,2)}function eW(e,t){return Me(e.getFullYear()%100,t,2)}function tW(e,t){return e=RF(e),Me(e.getFullYear()%100,t,2)}function nW(e,t){return Me(e.getFullYear()%1e4,t,4)}function iW(e,t){var n=e.getDay();return e=n>=4||n===0?Gc(e):Gc.ceil(e),Me(e.getFullYear()%1e4,t,4)}function rW(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Me(t/60|0,"0",2)+Me(t%60,"0",2)}function jF(e,t){return Me(e.getUTCDate(),t,2)}function oW(e,t){return Me(e.getUTCHours(),t,2)}function aW(e,t){return Me(e.getUTCHours()%12||12,t,2)}function sW(e,t){return Me(1+$F.count(Xc(e),e),t,3)}function LF(e,t){return Me(e.getUTCMilliseconds(),t,3)}function uW(e,t){return LF(e,t)+"000"}function lW(e,t){return Me(e.getUTCMonth()+1,t,2)}function cW(e,t){return Me(e.getUTCMinutes(),t,2)}function fW(e,t){return Me(e.getUTCSeconds(),t,2)}function dW(e){var t=e.getUTCDay();return t===0?7:t}function hW(e,t){return Me(EH.count(Xc(e)-1,e),t,2)}function PF(e){var t=e.getUTCDay();return t>=4||t===0?Vc(e):Vc.ceil(e)}function gW(e,t){return e=PF(e),Me(Vc.count(Xc(e),e)+(Xc(e).getUTCDay()===4),t,2)}function pW(e){return e.getUTCDay()}function mW(e,t){return Me(kv.count(Xc(e)-1,e),t,2)}function yW(e,t){return Me(e.getUTCFullYear()%100,t,2)}function vW(e,t){return e=PF(e),Me(e.getUTCFullYear()%100,t,2)}function bW(e,t){return Me(e.getUTCFullYear()%1e4,t,4)}function xW(e,t){var n=e.getUTCDay();return e=n>=4||n===0?Vc(e):Vc.ceil(e),Me(e.getUTCFullYear()%1e4,t,4)}function wW(){return"+0000"}function IF(){return"%"}function BF(e){return+e}function zF(e){return Math.floor(+e/1e3)}var qu,UF,qF,HF,WF;EW({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function EW(e){return qu=OF(e),UF=qu.format,qF=qu.parse,HF=qu.utcFormat,WF=qu.utcParse,qu}function Qc(e){const t={};return n=>t[n]||(t[n]=e(n))}function _W(e,t){return n=>{const i=e(n),r=i.indexOf(t);if(r<0)return i;let o=AW(i,r);const a=o<i.length?i.slice(o):"";for(;--o>r;)if(i[o]!=="0"){++o;break}return i.slice(0,o)+a}}function AW(e,t){let n=e.lastIndexOf("e"),i;if(n>0)return n;for(n=e.length;--n>t;)if(i=e.charCodeAt(n),i>=48&&i<=57)return n+1}function GF(e){const t=Qc(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(i){const r=jc(i||",");if(r.precision==null){switch(r.precision=12,r.type){case"%":r.precision-=2;break;case"e":r.precision-=1;break}return _W(t(r),t(".1f")(1)[1])}else return t(r)},formatSpan(i,r,o,a){a=jc(a==null?",f":a);const s=Sq(i,r,o),u=Math.max(Math.abs(i),Math.abs(r));let l;if(a.precision==null)switch(a.type){case"s":return isNaN(l=Rq(s,u))||(a.precision=l),n(a,u);case"":case"e":case"g":case"p":case"r":{isNaN(l=jq(s,u))||(a.precision=l-(a.type==="e"));break}case"f":case"%":{isNaN(l=Nq(s))||(a.precision=l-(a.type==="%")*2);break}}return t(a)}}}let Tv;YF();function YF(){return Tv=GF({format:qC,formatPrefix:HC})}function VF(e){return GF(UC(e))}function $0(e){return arguments.length?Tv=VF(e):Tv}function XF(e,t,n){n=n||{},se(n)||I("Invalid time multi-format specifier: ".concat(n));const i=t(wi),r=t(oi),o=t(ri),a=t(Bn),s=t(xt),u=t(Zt),l=t(In),c=t(zt),f=e(n[Wi]||".%L"),d=e(n[wi]||":%S"),h=e(n[oi]||"%I:%M"),g=e(n[ri]||"%I %p"),p=e(n[Bn]||n[Qt]||"%a %d"),m=e(n[xt]||"%b %d"),y=e(n[Zt]||"%B"),v=e(n[In]||"%B"),b=e(n[zt]||"%Y");return x=>(i(x)<x?f:r(x)<x?d:o(x)<x?h:a(x)<x?g:u(x)<x?s(x)<x?p:m:c(x)<x?l(x)<x?y:v:b)(x)}function KF(e){const t=Qc(e.format),n=Qc(e.utcFormat);return{timeFormat:i=>Fe(i)?t(i):XF(t,zu,i),utcFormat:i=>Fe(i)?n(i):XF(n,Uu,i),timeParse:Qc(e.parse),utcParse:Qc(e.utcParse)}}let Nv;JF();function JF(){return Nv=KF({format:UF,parse:qF,utcFormat:HF,utcParse:WF})}function ZF(e){return KF(OF(e))}function ef(e){return arguments.length?Nv=ZF(e):Nv}const Rv=(e,t)=>ge({},e,t);function QF(e,t){const n=e?VF(e):$0(),i=t?ZF(t):ef();return Rv(n,i)}function jv(e,t){const n=arguments.length;return n&&n!==2&&I("defaultLocale expects either zero or two arguments."),n?Rv($0(e),ef(t)):Rv($0(),ef())}function $W(){return YF(),JF(),jv()}const SW=/^(data:|([A-Za-z]+:)?\/\/)/,OW=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,CW=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,e3="file://";function FW(e,t){return n=>({options:n||{},sanitize:DW,load:kW,fileAccess:!!t,file:MW(t),http:NW(e)})}async function kW(e,t){const n=await this.sanitize(e,t),i=n.href;return n.localFile?this.file(i):this.http(i,t)}async function DW(e,t){t=ge({},this.options,t);const n=this.fileAccess,i={href:null};let r,o,a;const s=OW.test(e.replace(CW,""));(e==null||typeof e!="string"||!s)&&I("Sanitize failure, invalid URI: "+ne(e));const u=SW.test(e);return(a=t.baseURL)&&!u&&(!e.startsWith("/")&&!a.endsWith("/")&&(e="/"+e),e=a+e),o=(r=e.startsWith(e3))||t.mode==="file"||t.mode!=="http"&&!u&&n,r?e=e.slice(e3.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),o=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(i,"localFile",{value:!!o}),i.href=e,t.target&&(i.target=t.target+""),t.rel&&(i.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(i.crossOrigin=t.crossOrigin+""),i}function MW(e){return e?t=>new Promise((n,i)=>{e.readFile(t,(r,o)=>{r?i(r):n(o)})}):TW}async function TW(){I("No file system access.")}function NW(e){return e?async function(t,n){const i=ge({},this.options.http,n),r=n&&n.response,o=await e(t,i);return o.ok?me(o[r])?o[r]():o.text():I(o.status+""+o.statusText)}:RW}async function RW(){I("No HTTP fetch method available.")}const jW=e=>e!=null&&e===e,LW=e=>e==="true"||e==="false"||e===!0||e===!1,PW=e=>!Number.isNaN(Date.parse(e)),t3=e=>!Number.isNaN(+e)&&!(e instanceof Date),IW=e=>t3(e)&&Number.isInteger(+e),Lv={boolean:ov,integer:Kt,number:Kt,date:av,string:sv,unknown:yn},S0=[LW,IW,t3,PW],BW=["boolean","integer","number","date"];function n3(e,t){if(!e||!e.length)return"unknown";const n=e.length,i=S0.length,r=S0.map((o,a)=>a+1);for(let o=0,a=0,s,u;o<n;++o)for(u=t?e[o][t]:e[o],s=0;s<i;++s)if(r[s]&&jW(u)&&!S0[s](u)&&(r[s]=0,++a,a===S0.length))return"string";return BW[r.reduce((o,a)=>o===0?a:o,0)-1]}function i3(e,t){return t.reduce((n,i)=>(n[i]=n3(e,i),n),{})}function r3(e){const t=function(n,i){const r={delimiter:e};return Pv(n,i?ge(i,r):r)};return t.responseType="text",t}function Pv(e,t){return t.header&&(e=t.header.map(ne).join(t.delimiter)+`
`+e),gq(t.delimiter).parse(e+"")}Pv.responseType="text";function zW(e){return typeof Buffer=="function"&&me(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function Iv(e,t){const n=t&&t.property?Ln(t.property):yn;return se(e)&&!zW(e)?UW(n(e),t):n(JSON.parse(e))}Iv.responseType="json";function UW(e,t){return!Q(e)&&AC(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}const qW={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function o3(e,t){let n,i,r,o;return e=Iv(e,t),t&&t.feature?(n=vq,r=t.feature):t&&t.mesh?(n=xq,r=t.mesh,o=qW[t.filter]):I("Missing TopoJSON feature or mesh parameter."),i=(i=e.objects[r])?n(e,i,o):I("Invalid TopoJSON object: "+r),i&&i.features||[i]}o3.responseType="json";const O0={dsv:Pv,csv:r3(","),tsv:r3("	"),json:Iv,topojson:o3};function Bv(e,t){return arguments.length>1?(O0[e]=t,this):ae(O0,e)?O0[e]:null}function a3(e){const t=Bv(e);return t&&t.responseType||"text"}function s3(e,t,n,i){t=t||{};const r=Bv(t.type||"json");return r||I("Unknown data format type: "+t.type),e=r(e,t),t.parse&&HW(e,t.parse,n,i),ae(e,"columns")&&delete e.columns,e}function HW(e,t,n,i){if(!e.length)return;const r=ef();n=n||r.timeParse,i=i||r.utcParse;let o=e.columns||Object.keys(e[0]),a,s,u,l,c,f;t==="auto"&&(t=i3(e,o)),o=Object.keys(t);const d=o.map(h=>{const g=t[h];let p,m;if(g&&(g.startsWith("date:")||g.startsWith("utc:")))return p=g.split(/:(.+)?/,2),m=p[1],(m[0]==="'"&&m[m.length-1]==="'"||m[0]==='"'&&m[m.length-1]==='"')&&(m=m.slice(1,-1)),(p[0]==="utc"?i:n)(m);if(!Lv[g])throw Error("Illegal format pattern: "+h+":"+g);return Lv[g]});for(u=0,c=e.length,f=o.length;u<c;++u)for(a=e[u],l=0;l<f;++l)s=o[l],a[s]=d[l](a[s])}const C0=FW(typeof fetch!="undefined"&&fetch,null);function F0(e){const t=e||yn,n=[],i={};return n.add=r=>{const o=t(r);return i[o]||(i[o]=1,n.push(r)),n},n.remove=r=>{const o=t(r);if(i[o]){i[o]=0;const a=n.indexOf(r);a>=0&&n.splice(a,1)}return n},n}async function k0(e,t){try{await t(e)}catch(n){e.error(n)}}const u3=Symbol("vega_id");let WW=1;function D0(e){return!!(e&&ee(e))}function ee(e){return e[u3]}function l3(e,t){return e[u3]=t,e}function Le(e){const t=e===Object(e)?e:{data:e};return ee(t)?t:l3(t,WW++)}function zv(e){return M0(e,Le({}))}function M0(e,t){for(const n in e)t[n]=e[n];return t}function c3(e,t){return l3(t,ee(e))}function hs(e,t){return e?t?(n,i)=>e(n,i)||ee(t(n))-ee(t(i)):(n,i)=>e(n,i)||ee(n)-ee(i):null}function f3(e){return e&&e.constructor===gs}function gs(){const e=[],t=[],n=[],i=[],r=[];let o=null,a=!1;return{constructor:gs,insert(s){const u=oe(s),l=u.length;for(let c=0;c<l;++c)e.push(u[c]);return this},remove(s){const u=me(s)?i:t,l=oe(s),c=l.length;for(let f=0;f<c;++f)u.push(l[f]);return this},modify(s,u,l){const c={field:u,value:Jt(l)};return me(s)?(c.filter=s,r.push(c)):(c.tuple=s,n.push(c)),this},encode(s,u){return me(s)?r.push({filter:s,field:u}):n.push({tuple:s,field:u}),this},clean(s){return o=s,this},reflow(){return a=!0,this},pulse(s,u){const l={},c={};let f,d,h,g,p,m;for(f=0,d=u.length;f<d;++f)l[ee(u[f])]=1;for(f=0,d=t.length;f<d;++f)p=t[f],l[ee(p)]=-1;for(f=0,d=i.length;f<d;++f)g=i[f],u.forEach(v=>{g(v)&&(l[ee(v)]=-1)});for(f=0,d=e.length;f<d;++f)p=e[f],m=ee(p),l[m]?l[m]=1:s.add.push(Le(e[f]));for(f=0,d=u.length;f<d;++f)p=u[f],l[ee(p)]<0&&s.rem.push(p);function y(v,b,x){x?v[b]=x(v):s.encode=b,a||(c[ee(v)]=v)}for(f=0,d=n.length;f<d;++f)h=n[f],p=h.tuple,g=h.field,m=l[ee(p)],m>0&&(y(p,g,h.value),s.modifies(g));for(f=0,d=r.length;f<d;++f)h=r[f],g=h.filter,u.forEach(v=>{g(v)&&l[ee(v)]>0&&y(v,h.field,h.value)}),s.modifies(h.field);if(a)s.mod=t.length||i.length?u.filter(v=>l[ee(v)]>0):u.slice();else for(m in c)s.mod.push(c[m]);return(o||o==null&&(t.length||i.length))&&s.clean(!0),s}}}const T0="_:mod:_";function N0(){Object.defineProperty(this,T0,{writable:!0,value:{}})}N0.prototype={set(e,t,n,i){const r=this,o=r[e],a=r[T0];return t!=null&&t>=0?(o[t]!==n||i)&&(o[t]=n,a[t+":"+e]=-1,a[e]=-1):(o!==n||i)&&(r[e]=n,a[e]=Q(n)?1+n.length:-1),r},modified(e,t){const n=this[T0];if(arguments.length){if(Q(e)){for(let i=0;i<e.length;++i)if(n[e[i]])return!0;return!1}}else{for(const i in n)if(n[i])return!0;return!1}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[T0]={},this}};let GW=0;const YW="pulse",VW=new N0,XW=1,KW=2;function Ye(e,t,n,i){this.id=++GW,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,i)}function d3(e){return function(t){const n=this.flags;return arguments.length===0?!!(n&e):(this.flags=t?n|e:n&~e,this)}}Ye.prototype={targets(){return this._targets||(this._targets=F0(Dc))},set(e){return this.value!==e?(this.value=e,1):0},skip:d3(XW),modified:d3(KW),parameters(e,t,n){t=t!==!1;const i=this._argval=this._argval||new N0,r=this._argops=this._argops||[],o=[];let a,s,u,l;const c=(f,d,h)=>{h instanceof Ye?(h!==this&&(t&&h.targets().add(this),o.push(h)),r.push({op:h,name:f,index:d})):i.set(f,d,h)};for(a in e)if(s=e[a],a===YW)oe(s).forEach(f=>{f instanceof Ye?f!==this&&(f.targets().add(this),o.push(f)):I("Pulse parameters must be operator instances.")}),this.source=s;else if(Q(s))for(i.set(a,-1,Array(u=s.length)),l=0;l<u;++l)c(a,l,s[l]);else c(a,-1,s);return this.marshall().clear(),n&&(r.initonly=!0),o},marshall(e){const t=this._argval||VW,n=this._argops;let i,r,o,a;if(n){const s=n.length;for(r=0;r<s;++r)i=n[r],o=i.op,a=o.modified()&&o.stamp===e,t.set(i.name,i.index,o.value,a);if(n.initonly){for(r=0;r<s;++r)i=n[r],i.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,i,r;if(e)for(t=0,n=e.length;t<n;++t)i=e[t],r=i.op,r._targets&&r._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),i=t.call(this,n,e);if(n.clear(),i!==this.value)this.value=i;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};function JW(e,t,n,i){let r=1,o;return e instanceof Ye?o=e:e&&e.prototype instanceof Ye?o=new e:me(e)?o=new Ye(null,e):(r=0,o=new Ye(e,t)),this.rank(o),r&&(i=n,n=t),n&&this.connect(o,o.parameters(n,i)),this.touch(o),o}function ZW(e,t){const n=e.rank,i=t.length;for(let r=0;r<i;++r)if(n<t[r].rank){this.rerank(e);return}}let QW=0;function R0(e,t,n){this.id=++QW,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function na(e,t,n){return new R0(e,t,n)}R0.prototype={_filter:xi,_apply:yn,targets(){return this._targets||(this._targets=F0(Dc))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,i=n?n.length:0;for(let r=0;r<i;++r)n[r].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=na(e);return this.targets().add(t),t},apply(e){const t=na(null,e);return this.targets().add(t),t},merge(){const e=na();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=na();return this.targets().add(na(null,null,nv(e,n=>{const i=n.dataflow;t.receive(n),i&&i.run&&i.run()}))),t},between(e,t){let n=!1;return e.targets().add(na(null,null,()=>n=!0)),t.targets().add(na(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=xi,this._targets=null}};function eG(e,t,n,i){const r=this,o=na(n,i),a=function(l){l.dataflow=r;try{o.receive(l)}catch(c){r.error(c)}finally{r.run()}};let s;typeof e=="string"&&typeof document!="undefined"?s=document.querySelectorAll(e):s=oe(e);const u=s.length;for(let l=0;l<u;++l)s[l].addEventListener(t,a);return o}function tG(e,t){const n=this.locale();return s3(e,t,n.timeParse,n.utcParse)}function nG(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))}async function iG(e,t){const n=this;let i=0,r;try{r=await n.loader().load(e,{context:"dataflow",response:a3(t&&t.type)});try{r=n.parse(r,t)}catch(o){i=-2,n.warn("Data ingestion failed",e,o)}}catch(o){i=-1,n.warn("Loading failed",e,o)}return{data:r,status:i}}async function rG(e,t,n){const i=this,r=i._pending||oG(i);r.requests+=1;const o=await i.request(t,n);return i.pulse(e,i.changeset().remove(xi).insert(o.data||[])),r.done(),o}function oG(e){let t;const n=new Promise(i=>t=i);return n.requests=0,n.done=()=>{--n.requests==0&&(e._pending=null,t(e))},e._pending=n}const aG={skip:!0};function sG(e,t,n,i,r){return(e instanceof Ye?lG:uG)(this,e,t,n,i,r),this}function uG(e,t,n,i,r,o){const a=ge({},o,aG);let s,u;me(n)||(n=Jt(n)),i===void 0?s=l=>e.touch(n(l)):me(i)?(u=new Ye(null,i,r,!1),s=l=>{u.evaluate(l);const c=n(l),f=u.value;f3(f)?e.pulse(c,f,o):e.update(c,f,a)}):s=l=>e.update(n(l),i,a),t.apply(s)}function lG(e,t,n,i,r,o){if(i===void 0)t.targets().add(n);else{const a=o||{},s=new Ye(null,cG(n,i),r,!1);s.modified(a.force),s.rank=t.rank,t.targets().add(s),n&&(s.skip(!0),s.value=n.value,s.targets().add(n),e.connect(n,[s]))}}function cG(e,t){return t=me(t)?t:Jt(t),e?function(n,i){const r=t(n,i);return e.skip()||(e.skip(r!==this.value).value=r),r}:t}function fG(e){e.rank=++this._rank}function dG(e){const t=[e];let n,i,r;for(;t.length;)if(this.rank(n=t.pop()),i=n._targets)for(r=i.length;--r>=0;)t.push(n=i[r]),n===e&&I("Cycle detected in dataflow graph.")}const j0={},xr=1<<0,ia=1<<1,go=1<<2,hG=xr|ia,h3=xr|go,Hu=xr|ia|go,g3=1<<3,tf=1<<4,p3=1<<5,m3=1<<6;function ra(e,t,n){this.dataflow=e,this.stamp=t==null?-1:t,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function Uv(e,t){const n=[];return ea(e,t,i=>n.push(i)),n}function y3(e,t){const n={};return e.visit(t,i=>{n[ee(i)]=1}),i=>n[ee(i)]?null:i}function L0(e,t){return e?(n,i)=>e(n,i)&&t(n,i):t}ra.prototype={StopPropagation:j0,ADD:xr,REM:ia,MOD:go,ADD_REM:hG,ADD_MOD:h3,ALL:Hu,REFLOW:g3,SOURCE:tf,NO_SOURCE:p3,NO_FIELDS:m3,fork(e){return new ra(this.dataflow).init(this,e)},clone(){const e=this.fork(Hu);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(Hu|tf)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new ra(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(t&m3)&&(n.fields=e.fields),t&xr?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&ia?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&go?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&p3?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||Hu;return t&xr&&this.add.length||t&ia&&this.rem.length||t&go&&this.mod.length},reflow(e){if(e)return this.fork(Hu).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(go,y3(this,xr))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return Q(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return(t||this.mod.length)&&n?arguments.length?Q(e)?e.some(i=>n[i]):n[e]:!!n:!1},filter(e,t){const n=this;return e&xr&&(n.addF=L0(n.addF,t)),e&ia&&(n.remF=L0(n.remF,t)),e&go&&(n.modF=L0(n.modF,t)),e&tf&&(n.srcF=L0(n.srcF,t)),n},materialize(e){e=e||Hu;const t=this;return e&xr&&t.addF&&(t.add=Uv(t.add,t.addF),t.addF=null),e&ia&&t.remF&&(t.rem=Uv(t.rem,t.remF),t.remF=null),e&go&&t.modF&&(t.mod=Uv(t.mod,t.modF),t.modF=null),e&tf&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,i=t;if(e&tf)return ea(n.source,n.srcF,i),n;e&xr&&ea(n.add,n.addF,i),e&ia&&ea(n.rem,n.remF,i),e&go&&ea(n.mod,n.modF,i);const r=n.source;if(e&g3&&r){const o=n.add.length+n.mod.length;o===r.length||(o?ea(r,y3(n,h3),i):ea(r,n.srcF,i))}return n}};function qv(e,t,n,i){const r=this,o=n.length;let a=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=i||null,this.pulses=n;for(let s=0;s<o;++s){const u=n[s];if(u.stamp===t){if(u.fields){const l=r.fields||(r.fields={});for(const c in u.fields)l[c]=1}u.changed(r.ADD)&&(a|=r.ADD),u.changed(r.REM)&&(a|=r.REM),u.changed(r.MOD)&&(a|=r.MOD)}}this.changes=a}q(qv,ra,{fork(e){const t=new ra(this.dataflow).init(this,e&this.NO_FIELDS);return e!==void 0&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?Q(e)?e.some(i=>n[i]):n[e]:0},filter(){I("MultiPulse does not support filtering.")},materialize(){I("MultiPulse does not support materialization.")},visit(e,t){const n=this,i=n.pulses,r=i.length;let o=0;if(e&n.SOURCE)for(;o<r;++o)i[o].visit(e,t);else for(;o<r;++o)i[o].stamp===n.stamp&&i[o].visit(e,t);return n}});async function gG(e,t,n){const i=this,r=[];if(i._pulse)return v3(i);if(i._pending&&await i._pending,t&&await k0(i,t),!i._touched.length)return i.debug("Dataflow invoked, but nothing to do."),i;const o=++i._clock;i._pulse=new ra(i,o,e),i._touched.forEach(c=>i._enqueue(c,!0)),i._touched=F0(Dc);let a=0,s,u,l;try{for(;i._heap.size()>0;){if(s=i._heap.pop(),s.rank!==s.qrank){i._enqueue(s,!0);continue}u=s.run(i._getPulse(s,e)),u.then?u=await u:u.async&&(r.push(u.async),u=j0),u!==j0&&s._targets&&s._targets.forEach(c=>i._enqueue(c)),++a}}catch(c){i._heap.clear(),l=c}if(i._input={},i._pulse=null,i.debug(`Pulse ${o}: ${a} operators`),l&&(i._postrun=[],i.error(l)),i._postrun.length){const c=i._postrun.sort((f,d)=>d.priority-f.priority);i._postrun=[];for(let f=0;f<c.length;++f)await k0(i,c[f].callback)}return n&&await k0(i,n),r.length&&Promise.all(r).then(c=>i.runAsync(null,()=>{c.forEach(f=>{try{f(i)}catch(d){i.error(d)}})})),i}async function pG(e,t,n){for(;this._running;)await this._running;const i=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(i,i),this._running}function mG(e,t,n){return this._pulse?v3(this):(this.evaluate(e,t,n),this)}function yG(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(i){this.error(i)}}function v3(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function vG(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function bG(e,t){const n=e.source,i=this._clock;return n&&Q(n)?new qv(this,i,n.map(r=>r.pulse),t):this._input[e.id]||xG(this._pulse,n&&n.pulse)}function xG(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==j0&&(e.source=t.source),e)}const Hv={skip:!1,force:!1};function wG(e,t){const n=t||Hv;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function EG(e,t,n){const i=n||Hv;return(e.set(t)||i.force)&&this.touch(e,i),this}function _G(e,t,n){this.touch(e,n||Hv);const i=new ra(this,this._clock+(this._pulse?0:1)),r=e.pulse&&e.pulse.source||[];return i.target=e,this._input[e.id]=t.pulse(i,r),this}function AG(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),b3(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let i;return t.length?(i=t[0],t[0]=n,$G(t,0,e)):i=n,i}}}function b3(e,t,n,i){let r,o;const a=e[n];for(;n>t;){if(o=n-1>>1,r=e[o],i(a,r)<0){e[n]=r,n=o;continue}break}return e[n]=a}function $G(e,t,n){const i=t,r=e.length,o=e[t];let a=(t<<1)+1,s;for(;a<r;)s=a+1,s<r&&n(e[a],e[s])>=0&&(a=s),e[t]=e[a],t=a,a=(t<<1)+1;return e[t]=o,b3(e,i,t,n)}function Wu(){this.logger(lC()),this.logLevel(Jy),this._clock=0,this._rank=0,this._locale=jv();try{this._loader=C0()}catch(e){}this._touched=F0(Dc),this._input={},this._pulse=null,this._heap=AG((e,t)=>e.qrank-t.qrank),this._postrun=[]}function nf(e){return function(){return this._log[e].apply(this,arguments)}}Wu.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:nf("error"),warn:nf("warn"),info:nf("info"),debug:nf("debug"),logLevel:nf("level"),cleanThreshold:1e4,add:JW,connect:ZW,rank:fG,rerank:dG,pulse:_G,touch:wG,update:EG,changeset:gs,ingest:nG,parse:tG,preload:rG,request:iG,events:eG,on:sG,evaluate:gG,run:mG,runAsync:pG,runAfter:yG,_enqueue:vG,_getPulse:bG};function N(e,t){Ye.call(this,e,null,t)}q(N,Ye,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const Gu={};function x3(e){const t=w3(e);return t&&t.Definition||null}function w3(e){return e=e&&e.toLowerCase(),ae(Gu,e)?Gu[e]:null}function Wv(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function SG(e){return e===null?NaN:+e}function*OG(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)(i=t(i,++n,e))!=null&&(i=+i)>=i&&(yield i)}}function CG(e,t){let n=0,i,r=0,o=0;if(t===void 0)for(let a of e)a!=null&&(a=+a)>=a&&(i=a-r,r+=i/++n,o+=i*(a-r));else{let a=-1;for(let s of e)(s=t(s,++a,e))!=null&&(s=+s)>=s&&(i=s-r,r+=i/++n,o+=i*(s-r))}if(n>1)return o/(n-1)}function FG(e,t){const n=CG(e,t);return n&&Math.sqrt(n)}function E3(e,t){let n;if(t===void 0)for(const i of e)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of e)(r=t(r,++i,e))!=null&&(n<r||n===void 0&&r>=r)&&(n=r)}return n}function _3(e,t){let n;if(t===void 0)for(const i of e)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of e)(r=t(r,++i,e))!=null&&(n>r||n===void 0&&r>=r)&&(n=r)}return n}function A3(e,t,n=0,i=e.length-1,r=Wv){for(;i>n;){if(i-n>600){const u=i-n+1,l=t-n+1,c=Math.log(u),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(u-f)/u)*(l-u/2<0?-1:1),h=Math.max(n,Math.floor(t-l*f/u+d)),g=Math.min(i,Math.floor(t+(u-l)*f/u+d));A3(e,t,h,g,r)}const o=e[t];let a=n,s=i;for(rf(e,n,t),r(e[i],o)>0&&rf(e,n,i);a<s;){for(rf(e,a,s),++a,--s;r(e[a],o)<0;)++a;for(;r(e[s],o)>0;)--s}r(e[n],o)===0?rf(e,n,s):(++s,rf(e,s,i)),s<=t&&(n=s+1),t<=s&&(i=s-1)}return e}function rf(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function Gv(e,t,n){if(e=Float64Array.from(OG(e,n)),!!(i=e.length)){if((t=+t)<=0||i<2)return _3(e);if(t>=1)return E3(e);var i,r=(i-1)*t,o=Math.floor(r),a=E3(A3(e,o).subarray(0,o+1)),s=_3(e.subarray(o+1));return a+(s-a)*(r-o)}}function kG(e,t,n=SG){if(!!(i=e.length)){if((t=+t)<=0||i<2)return+n(e[0],0,e);if(t>=1)return+n(e[i-1],i-1,e);var i,r=(i-1)*t,o=Math.floor(r),a=+n(e[o],o,e),s=+n(e[o+1],o+1,e);return a+(s-a)*(r-o)}}function DG(e,t){return Gv(e,.5,t)}function*$3(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)i=t(i,++n,e),i!=null&&i!==""&&(i=+i)>=i&&(yield i)}}function Yv(e,t,n){const i=Float64Array.from($3(e,n));return i.sort(Wv),t.map(r=>kG(i,r))}function Vv(e,t){return Yv(e,[.25,.5,.75],t)}function Xv(e,t){const n=e.length,i=FG(e,t),r=Vv(e,t),o=(r[2]-r[0])/1.34,a=Math.min(i,o)||i||Math.abs(r[0])||1;return 1.06*a*Math.pow(n,-.2)}function S3(e){const t=e.maxbins||20,n=e.base||10,i=Math.log(n),r=e.divide||[5,2];let o=e.extent[0],a=e.extent[1],s,u,l,c,f,d;const h=e.span||a-o||Math.abs(o)||1;if(e.step)s=e.step;else if(e.steps){for(c=h/t,f=0,d=e.steps.length;f<d&&e.steps[f]<c;++f);s=e.steps[Math.max(0,f-1)]}else{for(u=Math.ceil(Math.log(t)/i),l=e.minstep||0,s=Math.max(l,Math.pow(n,Math.round(Math.log(h)/i)-u));Math.ceil(h/s)>t;)s*=n;for(f=0,d=r.length;f<d;++f)c=s/r[f],c>=l&&h/c<=t&&(s=c)}c=Math.log(s);const g=c>=0?0:~~(-c/i)+1,p=Math.pow(n,-g-1);return(e.nice||e.nice===void 0)&&(c=Math.floor(o/s+p)*s,o=o<c?c-s:c,a=Math.ceil(a/s)*s),{start:o,stop:a===o?o+s:a,step:s}}var Ei=Math.random;function MG(e){Ei=e}function O3(e,t,n,i){if(!e.length)return[void 0,void 0];const r=Float64Array.from($3(e,i)),o=r.length,a=t;let s,u,l,c;for(l=0,c=Array(a);l<a;++l){for(s=0,u=0;u<o;++u)s+=r[~~(Ei()*o)];c[l]=s/o}return c.sort(Wv),[Gv(c,n/2),Gv(c,1-n/2)]}function C3(e,t,n,i){i=i||(d=>d);const r=e.length,o=new Float64Array(r);let a=0,s=1,u=i(e[0]),l=u,c=u+t,f;for(;s<r;++s){if(f=i(e[s]),f>=c){for(l=(u+l)/2;a<s;++a)o[a]=l;c=f+t,u=f}l=f}for(l=(u+l)/2;a<s;++a)o[a]=l;return n?TG(o,t+t/4):o}function TG(e,t){const n=e.length;let i=0,r=1,o,a;for(;e[i]===e[r];)++r;for(;r<n;){for(o=r+1;e[r]===e[o];)++o;if(e[r]-e[r-1]<t){for(a=r+(i+o-r-r>>1);a<r;)e[a++]=e[r];for(;a>r;)e[a--]=e[i]}i=r,r=o}return e}function NG(e){return function(){return e=(1103515245*e+12345)%2147483647,e/2147483647}}function RG(e,t){t==null&&(t=e,e=0);let n,i,r;const o={min(a){return arguments.length?(n=a||0,r=i-n,o):n},max(a){return arguments.length?(i=a||0,r=i-n,o):i},sample(){return n+Math.floor(r*Ei())},pdf(a){return a===Math.floor(a)&&a>=n&&a<i?1/r:0},cdf(a){const s=Math.floor(a);return s<n?0:s>=i?1:(s-n+1)/r},icdf(a){return a>=0&&a<=1?n-1+Math.floor(a*r):NaN}};return o.min(e).max(t)}const F3=Math.sqrt(2*Math.PI),jG=Math.SQRT2;let of=NaN;function P0(e,t){e=e||0,t=t==null?1:t;let n=0,i=0,r,o;if(of===of)n=of,of=NaN;else{do n=Ei()*2-1,i=Ei()*2-1,r=n*n+i*i;while(r===0||r>1);o=Math.sqrt(-2*Math.log(r)/r),n*=o,of=i*o}return e+n*t}function Kv(e,t,n){n=n==null?1:n;const i=(e-(t||0))/n;return Math.exp(-.5*i*i)/(n*F3)}function I0(e,t,n){t=t||0,n=n==null?1:n;const i=(e-t)/n,r=Math.abs(i);let o;if(r>37)o=0;else{const a=Math.exp(-r*r/2);let s;r<7.07106781186547?(s=.0352624965998911*r+.700383064443688,s=s*r+6.37396220353165,s=s*r+33.912866078383,s=s*r+112.079291497871,s=s*r+221.213596169931,s=s*r+220.206867912376,o=a*s,s=.0883883476483184*r+1.75566716318264,s=s*r+16.064177579207,s=s*r+86.7807322029461,s=s*r+296.564248779674,s=s*r+637.333633378831,s=s*r+793.826512519948,s=s*r+440.413735824752,o=o/s):(s=r+.65,s=r+4/s,s=r+3/s,s=r+2/s,s=r+1/s,o=a/s/2.506628274631)}return i>0?1-o:o}function B0(e,t,n){return e<0||e>1?NaN:(t||0)+(n==null?1:n)*jG*LG(2*e-1)}function LG(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function Jv(e,t){let n,i;const r={mean(o){return arguments.length?(n=o||0,r):n},stdev(o){return arguments.length?(i=o==null?1:o,r):i},sample:()=>P0(n,i),pdf:o=>Kv(o,n,i),cdf:o=>I0(o,n,i),icdf:o=>B0(o,n,i)};return r.mean(e).stdev(t)}function Zv(e,t){const n=Jv();let i=0;const r={data(o){return arguments.length?(e=o,i=o?o.length:0,r.bandwidth(t)):e},bandwidth(o){return arguments.length?(t=o,!t&&e&&(t=Xv(e)),r):t},sample(){return e[~~(Ei()*i)]+t*n.sample()},pdf(o){let a=0,s=0;for(;s<i;++s)a+=n.pdf((o-e[s])/t);return a/t/i},cdf(o){let a=0,s=0;for(;s<i;++s)a+=n.cdf((o-e[s])/t);return a/i},icdf(){throw Error("KDE icdf not supported.")}};return r.data(e)}function Qv(e,t){return e=e||0,t=t==null?1:t,Math.exp(e+P0()*t)}function eb(e,t,n){if(e<=0)return 0;t=t||0,n=n==null?1:n;const i=(Math.log(e)-t)/n;return Math.exp(-.5*i*i)/(n*F3*e)}function tb(e,t,n){return I0(Math.log(e),t,n)}function nb(e,t,n){return Math.exp(B0(e,t,n))}function k3(e,t){let n,i;const r={mean(o){return arguments.length?(n=o||0,r):n},stdev(o){return arguments.length?(i=o==null?1:o,r):i},sample:()=>Qv(n,i),pdf:o=>eb(o,n,i),cdf:o=>tb(o,n,i),icdf:o=>nb(o,n,i)};return r.mean(e).stdev(t)}function D3(e,t){let n=0,i;function r(a){const s=[];let u=0,l;for(l=0;l<n;++l)u+=s[l]=a[l]==null?1:+a[l];for(l=0;l<n;++l)s[l]/=u;return s}const o={weights(a){return arguments.length?(i=r(t=a||[]),o):t},distributions(a){return arguments.length?(a?(n=a.length,e=a):(n=0,e=[]),o.weights(t)):e},sample(){const a=Ei();let s=e[n-1],u=i[0],l=0;for(;l<n-1;u+=i[++l])if(a<u){s=e[l];break}return s.sample()},pdf(a){let s=0,u=0;for(;u<n;++u)s+=i[u]*e[u].pdf(a);return s},cdf(a){let s=0,u=0;for(;u<n;++u)s+=i[u]*e[u].cdf(a);return s},icdf(){throw Error("Mixture icdf not supported.")}};return o.distributions(e).weights(t)}function ib(e,t){return t==null&&(t=e==null?1:e,e=0),e+(t-e)*Ei()}function rb(e,t,n){return n==null&&(n=t==null?1:t,t=0),e>=t&&e<=n?1/(n-t):0}function ob(e,t,n){return n==null&&(n=t==null?1:t,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function ab(e,t,n){return n==null&&(n=t==null?1:t,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function M3(e,t){let n,i;const r={min(o){return arguments.length?(n=o||0,r):n},max(o){return arguments.length?(i=o==null?1:o,r):i},sample:()=>ib(n,i),pdf:o=>rb(o,n,i),cdf:o=>ob(o,n,i),icdf:o=>ab(o,n,i)};return t==null&&(t=e==null?1:e,e=0),r.min(e).max(t)}function af(e,t,n,i){const r=i-e*e,o=Math.abs(r)<1e-24?0:(n-e*t)/r;return[t-o*e,o]}function z0(e,t,n,i){e=e.filter(h=>{let g=t(h),p=n(h);return g!=null&&(g=+g)>=g&&p!=null&&(p=+p)>=p}),i&&e.sort((h,g)=>t(h)-t(g));const r=e.length,o=new Float64Array(r),a=new Float64Array(r);let s=0,u=0,l=0,c,f,d;for(d of e)o[s]=c=+t(d),a[s]=f=+n(d),++s,u+=(c-u)/s,l+=(f-l)/s;for(s=0;s<r;++s)o[s]-=u,a[s]-=l;return[o,a,u,l]}function sf(e,t,n,i){let r=-1,o,a;for(const s of e)o=t(s),a=n(s),o!=null&&(o=+o)>=o&&a!=null&&(a=+a)>=a&&i(o,a,++r)}function Yu(e,t,n,i,r){let o=0,a=0;return sf(e,t,n,(s,u)=>{const l=u-r(s),c=u-i;o+=l*l,a+=c*c}),1-o/a}function sb(e,t,n){let i=0,r=0,o=0,a=0,s=0;sf(e,t,n,(c,f)=>{++s,i+=(c-i)/s,r+=(f-r)/s,o+=(c*f-o)/s,a+=(c*c-a)/s});const u=af(i,r,o,a),l=c=>u[0]+u[1]*c;return{coef:u,predict:l,rSquared:Yu(e,t,n,r,l)}}function T3(e,t,n){let i=0,r=0,o=0,a=0,s=0;sf(e,t,n,(c,f)=>{++s,c=Math.log(c),i+=(c-i)/s,r+=(f-r)/s,o+=(c*f-o)/s,a+=(c*c-a)/s});const u=af(i,r,o,a),l=c=>u[0]+u[1]*Math.log(c);return{coef:u,predict:l,rSquared:Yu(e,t,n,r,l)}}function N3(e,t,n){const[i,r,o,a]=z0(e,t,n);let s=0,u=0,l=0,c=0,f=0,d,h,g;sf(e,t,n,(v,b)=>{d=i[f++],h=Math.log(b),g=d*b,s+=(b*h-s)/f,u+=(g-u)/f,l+=(g*h-l)/f,c+=(d*g-c)/f});const[p,m]=af(u/a,s/a,l/a,c/a),y=v=>Math.exp(p+m*(v-o));return{coef:[Math.exp(p-m*o),m],predict:y,rSquared:Yu(e,t,n,a,y)}}function R3(e,t,n){let i=0,r=0,o=0,a=0,s=0,u=0;sf(e,t,n,(f,d)=>{const h=Math.log(f),g=Math.log(d);++u,i+=(h-i)/u,r+=(g-r)/u,o+=(h*g-o)/u,a+=(h*h-a)/u,s+=(d-s)/u});const l=af(i,r,o,a),c=f=>l[0]*Math.pow(f,l[1]);return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:Yu(e,t,n,s,c)}}function ub(e,t,n){const[i,r,o,a]=z0(e,t,n),s=i.length;let u=0,l=0,c=0,f=0,d=0,h,g,p,m;for(h=0;h<s;)g=i[h],p=r[h++],m=g*g,u+=(m-u)/h,l+=(m*g-l)/h,c+=(m*m-c)/h,f+=(g*p-f)/h,d+=(m*p-d)/h;const y=c-u*u,v=u*y-l*l,b=(d*u-f*l)/v,x=(f*y-d*l)/v,w=-b*u,_=E=>(E=E-o,b*E*E+x*E+w+a);return{coef:[w-x*o+b*o*o+a,x-2*b*o,b],predict:_,rSquared:Yu(e,t,n,a,_)}}function j3(e,t,n,i){if(i===1)return sb(e,t,n);if(i===2)return ub(e,t,n);const[r,o,a,s]=z0(e,t,n),u=r.length,l=[],c=[],f=i+1;let d,h,g,p,m;for(d=0;d<f;++d){for(g=0,p=0;g<u;++g)p+=Math.pow(r[g],d)*o[g];for(l.push(p),m=new Float64Array(f),h=0;h<f;++h){for(g=0,p=0;g<u;++g)p+=Math.pow(r[g],d+h);m[h]=p}c.push(m)}c.push(l);const y=IG(c),v=b=>{b-=a;let x=s+y[0]+y[1]*b+y[2]*b*b;for(d=3;d<f;++d)x+=y[d]*Math.pow(b,d);return x};return{coef:PG(f,y,-a,s),predict:v,rSquared:Yu(e,t,n,s,v)}}function PG(e,t,n,i){const r=Array(e);let o,a,s,u;for(o=0;o<e;++o)r[o]=0;for(o=e-1;o>=0;--o)for(s=t[o],u=1,r[o]+=s,a=1;a<=o;++a)u*=(o+1-a)/a,r[o-a]+=s*Math.pow(n,a)*u;return r[0]+=i,r}function IG(e){const t=e.length-1,n=[];let i,r,o,a,s;for(i=0;i<t;++i){for(a=i,r=i+1;r<t;++r)Math.abs(e[i][r])>Math.abs(e[i][a])&&(a=r);for(o=i;o<t+1;++o)s=e[o][i],e[o][i]=e[o][a],e[o][a]=s;for(r=i+1;r<t;++r)for(o=t;o>=i;o--)e[o][r]-=e[o][i]*e[i][r]/e[i][i]}for(r=t-1;r>=0;--r){for(s=0,o=r+1;o<t;++o)s+=e[o][r]*n[o];n[r]=(e[t][r]-s)/e[r][r]}return n}const L3=2,P3=1e-12;function I3(e,t,n,i){const[r,o,a,s]=z0(e,t,n,!0),u=r.length,l=Math.max(2,~~(i*u)),c=new Float64Array(u),f=new Float64Array(u),d=new Float64Array(u).fill(1);for(let h=-1;++h<=L3;){const g=[0,l-1];for(let m=0;m<u;++m){const y=r[m],v=g[0],b=g[1],x=y-r[v]>r[b]-y?v:b;let w=0,_=0,E=0,$=0,O=0;const C=1/Math.abs(r[x]-y||1);for(let F=v;F<=b;++F){const T=r[F],S=o[F],M=BG(Math.abs(y-T)*C)*d[F],P=T*M;w+=M,_+=P,E+=S*M,$+=S*P,O+=T*P}const[A,D]=af(_/w,E/w,$/w,O/w);c[m]=A+D*y,f[m]=Math.abs(o[m]-c[m]),zG(r,m+1,g)}if(h===L3)break;const p=DG(f);if(Math.abs(p)<P3)break;for(let m=0,y,v;m<u;++m)y=f[m]/(6*p),d[m]=y>=1?P3:(v=1-y*y)*v}return UG(r,c,a,s)}function BG(e){return(e=1-e*e*e)*e*e}function zG(e,t,n){const i=e[t];let r=n[0],o=n[1]+1;if(!(o>=e.length))for(;t>r&&e[o]-i<=i-e[r];)n[0]=++r,n[1]=o,++o}function UG(e,t,n,i){const r=e.length,o=[];let a=0,s=0,u=[],l;for(;a<r;++a)l=e[a]+n,u[0]===l?u[1]+=(t[a]-u[1])/++s:(s=0,u[1]+=i,u=[l,t[a]],o.push(u));return u[1]+=i,o}const qG=.5*Math.PI/180;function U0(e,t,n,i){n=n||25,i=Math.max(n,i||200);const r=p=>[p,e(p)],o=t[0],a=t[1],s=a-o,u=s/i,l=[r(o)],c=[];if(n===i){for(let p=1;p<i;++p)l.push(r(o+p/n*s));return l.push(r(a)),l}else{c.push(r(a));for(let p=n;--p>0;)c.push(r(o+p/n*s))}let f=l[0],d=c[c.length-1];const h=1/s,g=HG(f[1],c);for(;d;){const p=r((f[0]+d[0])/2);p[0]-f[0]>=u&&WG(f,p,d,h,g)>qG?c.push(p):(f=d,l.push(d),c.pop()),d=c[c.length-1]}return l}function HG(e,t){let n=e,i=e;const r=t.length;for(let o=0;o<r;++o){const a=t[o][1];a<n&&(n=a),a>i&&(i=a)}return 1/(i-n)}function WG(e,t,n,i,r){const o=Math.atan2(r*(n[1]-e[1]),i*(n[0]-e[0])),a=Math.atan2(r*(t[1]-e[1]),i*(t[0]-e[0]));return Math.abs(o-a)}function B3(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function GG(e){let t=e,n=e;e.length===1&&(t=(a,s)=>e(a)-s,n=YG(e));function i(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)<0?u=c+1:l=c}return u}function r(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)>0?l=c:u=c+1}return u}function o(a,s,u,l){u==null&&(u=0),l==null&&(l=a.length);const c=i(a,s,u,l-1);return c>u&&t(a[c-1],s)>-t(a[c],s)?c-1:c}return{left:i,center:o,right:r}}function YG(e){return(t,n)=>B3(e(t),n)}function*VG(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)(i=t(i,++n,e))!=null&&(i=+i)>=i&&(yield i)}}function lb(e,t){let n;if(t===void 0)for(const i of e)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of e)(r=t(r,++i,e))!=null&&(n<r||n===void 0&&r>=r)&&(n=r)}return n}function cb(e,t){let n;if(t===void 0)for(const i of e)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of e)(r=t(r,++i,e))!=null&&(n>r||n===void 0&&r>=r)&&(n=r)}return n}function z3(e,t,n=0,i=e.length-1,r=B3){for(;i>n;){if(i-n>600){const u=i-n+1,l=t-n+1,c=Math.log(u),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(u-f)/u)*(l-u/2<0?-1:1),h=Math.max(n,Math.floor(t-l*f/u+d)),g=Math.min(i,Math.floor(t+(u-l)*f/u+d));z3(e,t,h,g,r)}const o=e[t];let a=n,s=i;for(uf(e,n,t),r(e[i],o)>0&&uf(e,n,i);a<s;){for(uf(e,a,s),++a,--s;r(e[a],o)<0;)++a;for(;r(e[s],o)>0;)--s}r(e[n],o)===0?uf(e,n,s):(++s,uf(e,s,i)),s<=t&&(n=s+1),t<=s&&(i=s-1)}return e}function uf(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function XG(e,t,n){if(e=Float64Array.from(VG(e,n)),!!(i=e.length)){if((t=+t)<=0||i<2)return cb(e);if(t>=1)return lb(e);var i,r=(i-1)*t,o=Math.floor(r),a=lb(z3(e,o).subarray(0,o+1)),s=cb(e.subarray(o+1));return a+(s-a)*(r-o)}}function KG(e,t){let n=0,i=0;if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(++n,i+=r);else{let r=-1;for(let o of e)(o=t(o,++r,e))!=null&&(o=+o)>=o&&(++n,i+=o)}if(n)return i/n}function JG(e,t){return XG(e,.5,t)}function U3(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(r);++i<r;)o[i]=e+i*n;return o}function ZG(e){return t=>{const n=e.length;let i=1,r=String(e[0](t));for(;i<n;++i)r+="|"+e[i](t);return r}}function fb(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:ZG(e)}function q3(e,t,n){return n||e+(t?"_"+t:"")}const db=()=>{},QG={init:db,add:db,rem:db,idx:0},lf={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.sum,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||e.min===void 0)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||e.max===void 0)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},cf=Object.keys(lf);function eY(e,t){return n=>ge({name:e,out:n||e},QG,t)}cf.forEach(e=>{lf[e]=eY(e,lf[e])});function H3(e,t){return lf[e](t)}function W3(e,t){return e.idx-t.idx}function tY(e){const t={};e.forEach(i=>t[i.name]=i);const n=i=>{!i.req||i.req.forEach(r=>{t[r]||n(t[r]=lf[r]())})};return e.forEach(n),Object.values(t).sort(W3)}function nY(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.init(this))}function iY(e,t){if(e==null||e===""){++this.missing;return}e===e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t)))}function rY(e,t){if(e==null||e===""){--this.missing;return}e===e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t)))}function oY(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function G3(e,t){const n=t||yn,i=tY(e),r=e.slice().sort(W3);function o(a){this._ops=i,this._out=r,this.cell=a,this.init()}return o.prototype.init=nY,o.prototype.add=iY,o.prototype.rem=rY,o.prototype.set=oY,o.prototype.get=n,o.fields=e.map(a=>a.out),o}function hb(e){this._key=e?Ln(e):ee,this.reset()}const Ut=hb.prototype;Ut.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null};Ut.add=function(e){this._add.push(e)};Ut.rem=function(e){this._rem.push(e)};Ut.values=function(){if(this._get=null,this._rem.length===0)return this._add;const e=this._add,t=this._rem,n=this._key,i=e.length,r=t.length,o=Array(i-r),a={};let s,u,l;for(s=0;s<r;++s)a[n(t[s])]=1;for(s=0,u=0;s<i;++s)a[n(l=e[s])]?a[n(l)]=0:o[u++]=l;return this._rem=[],this._add=o};Ut.distinct=function(e){const t=this.values(),n={};let i=t.length,r=0,o;for(;--i>=0;)o=e(t[i])+"",ae(n,o)||(n[o]=1,++r);return r};Ut.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=EC(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext};Ut.argmin=function(e){return this.extent(e)[0]||{}};Ut.argmax=function(e){return this.extent(e)[1]||{}};Ut.min=function(e){const t=this.extent(e)[0];return t!=null?e(t):void 0};Ut.max=function(e){const t=this.extent(e)[1];return t!=null?e(t):void 0};Ut.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=Vv(this.values(),e),this._get=e),this._q};Ut.q1=function(e){return this.quartile(e)[0]};Ut.q2=function(e){return this.quartile(e)[1]};Ut.q3=function(e){return this.quartile(e)[2]};Ut.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=O3(this.values(),1e3,.05,e),this._get=e),this._ci};Ut.ci0=function(e){return this.ci(e)[0]};Ut.ci1=function(e){return this.ci(e)[1]};function oa(e){N.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}oa.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:cf},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};q(oa,N,{transform(e,t){const n=this,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.modified();return n.stamp=i.stamp,n.value&&(r||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=r?n.init(e):{},t.visit(t.SOURCE,o=>n.add(o))):(n.value=n.value||n.init(e),t.visit(t.REM,o=>n.rem(o)),t.visit(t.ADD,o=>n.add(o))),i.modifies(n._outputs),n._drop=e.drop!==!1,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&i.clean(!0).runAfter(()=>this.clean()),n.changes(i)},cross(){const e=this,t=e.value,n=e._dnames,i=n.map(()=>({})),r=n.length;function o(s){let u,l,c,f;for(u in s)for(c=s[u].tuple,l=0;l<r;++l)i[l][f=c[n[l]]]=f}o(e._prev),o(t);function a(s,u,l){const c=n[l],f=i[l++];for(const d in f){const h=s?s+"|"+d:d;u[c]=f[d],l<r?a(h,u,l):t[h]||e.cell(h,u)}}a("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],i={};function r(m){const y=oe(Xt(m)),v=y.length;let b=0,x;for(;b<v;++b)i[x=y[b]]||(i[x]=1,t.push(x))}this._dims=oe(e.groupby),this._dnames=this._dims.map(m=>{const y=ut(m);return r(m),n.push(y),y}),this.cellkey=e.key?e.key:fb(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const o=e.fields||[null],a=e.ops||["count"],s=e.as||[],u=o.length,l={};let c,f,d,h,g,p;for(u!==a.length&&I("Unmatched number of fields and aggregate ops."),p=0;p<u;++p){if(c=o[p],f=a[p],c==null&&f!=="count"&&I("Null aggregate field specified."),h=ut(c),g=q3(f,h,s[p]),n.push(g),f==="count"){this._counts.push(g);continue}d=l[h],d||(r(c),d=l[h]=[],d.field=c,this._measures.push(d)),f!=="count"&&(this._countOnly=!1),d.push(H3(f,g))}return this._measures=this._measures.map(m=>G3(m,m.field)),{}},cellkey:fb(),cell(e,t){let n=this.value[e];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const i=this._measures,r=i.length;n.agg=Array(r);for(let o=0;o<r;++o)n.agg[o]=new i[o](n)}return n.store&&(n.data=new hb),n},newtuple(e,t){const n=this._dnames,i=this._dims,r=i.length,o={};for(let a=0;a<r;++a)o[n[a]]=i[a](e);return t?c3(t.tuple,o):Le(o)},clean(){const e=this.value;for(const t in e)e[t].num===0&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const i=n.agg;for(let r=0,o=i.length;r<o;++r)i[r].add(i[r].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const i=n.agg;for(let r=0,o=i.length;r<o;++r)i[r].rem(i[r].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let i=0,r=n.length;i<r;++i)t[n[i]]=e.num;if(!this._countOnly){const i=e.agg;for(let r=0,o=i.length;r<o;++r)i[r].set(t)}return t},changes(e){const t=this._adds,n=this._mods,i=this._prev,r=this._drop,o=e.add,a=e.rem,s=e.mod;let u,l,c,f;if(i)for(l in i)u=i[l],(!r||u.num)&&a.push(u.tuple);for(c=0,f=this._alen;c<f;++c)o.push(this.celltuple(t[c])),t[c]=null;for(c=0,f=this._mlen;c<f;++c)u=n[c],(u.num===0&&r?a:s).push(this.celltuple(u)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}});const aY=1e-14;function gb(e){N.call(this,null,e)}gb.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};q(gb,N,{transform(e,t){const n=e.interval!==!1,i=this._bins(e),r=i.start,o=i.step,a=e.as||["bin0","bin1"],s=a[0],u=a[1];let l;return e.modified()?(t=t.reflow(!0),l=t.SOURCE):l=t.modified(Xt(e.field))?t.ADD_MOD:t.ADD,t.visit(l,n?c=>{const f=i(c);c[s]=f,c[u]=f==null?null:r+o*(1+(f-r)/o)}:c=>c[s]=i(c)),t.modifies(n?a:s)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=S3(e),i=n.step;let r=n.start,o=r+Math.ceil((n.stop-r)/i)*i,a,s;(a=e.anchor)!=null&&(s=a-(r+i*Math.floor((a-r)/i)),r+=s,o+=s);const u=function(l){let c=Kt(t(l));return c==null?null:c<r?-1/0:c>o?1/0:(c=Math.max(r,Math.min(c,o-i)),r+i*Math.floor(aY+(c-r)/i))};return u.start=r,u.stop=n.stop,u.step=i,this.value=jn(u,Xt(t),e.name||"bin_"+ut(t))}});function Y3(e,t,n){const i=e;let r=t||[],o=n||[],a={},s=0;return{add:u=>o.push(u),remove:u=>a[i(u)]=++s,size:()=>r.length,data:(u,l)=>(s&&(r=r.filter(c=>!a[i(c)]),a={},s=0),l&&u&&r.sort(u),o.length&&(r=u?CC(u,r,o.sort(u)):r.concat(o),o=[]),r)}}function pb(e){N.call(this,[],e)}pb.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]};q(pb,N,{transform(e,t){const n=t.fork(t.ALL),i=Y3(ee,this.value,n.materialize(n.ADD).add),r=e.sort,o=t.changed()||r&&(e.modified("sort")||t.modified(r.fields));return n.visit(n.REM,i.remove),this.modified(o),this.value=n.source=i.data(hs(r),o),t.source&&t.source.root&&(this.value.root=t.source.root),n}});function V3(e){Ye.call(this,null,sY,e)}q(V3,Ye);function sY(e){return this.value&&!e.modified()?this.value:tv(e.fields,e.orders)}function mb(e){N.call(this,null,e)}mb.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function uY(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}q(mb,N,{transform(e,t){const n=f=>d=>{for(var h=uY(s(d),e.case,o)||[],g,p=0,m=h.length;p<m;++p)a.test(g=h[p])||f(g)},i=this._parameterCheck(e,t),r=this._counts,o=this._match,a=this._stop,s=e.field,u=e.as||["text","count"],l=n(f=>r[f]=1+(r[f]||0)),c=n(f=>r[f]-=1);return i?t.visit(t.SOURCE,l):(t.visit(t.ADD,l),t.visit(t.REM,c)),this._finish(t,u)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,i=this._tuples||(this._tuples={}),r=t[0],o=t[1],a=e.fork(e.NO_SOURCE|e.NO_FIELDS);let s,u,l;for(s in n)u=i[s],l=n[s]||0,!u&&l?(i[s]=u=Le({}),u[r]=s,u[o]=l,a.add.push(u)):l===0?(u&&a.rem.push(u),n[s]=null,i[s]=null):u[o]!==l&&(u[o]=l,a.mod.push(u));return a.modifies(t)}});function yb(e){N.call(this,null,e)}yb.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]};q(yb,N,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.as||["a","b"],r=i[0],o=i[1],a=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let s=this.value;return a?(s&&(n.rem=s),s=t.materialize(t.SOURCE).source,n.add=this.value=lY(s,r,o,e.filter||xi)):n.mod=s,n.source=this.value,n.modifies(i)}});function lY(e,t,n,i){for(var r=[],o={},a=e.length,s=0,u,l;s<a;++s)for(o[t]=l=e[s],u=0;u<a;++u)o[n]=e[u],i(o)&&(r.push(Le(o)),o={},o[t]=l);return r}const X3={kde:Zv,mixture:D3,normal:Jv,lognormal:k3,uniform:M3},cY="distributions",K3="function",fY="field";function J3(e,t){const n=e[K3];ae(X3,n)||I("Unknown distribution function: "+n);const i=X3[n]();for(const r in e)r===fY?i.data((e.from||t()).map(e[r])):r===cY?i[r](e[r].map(o=>J3(o,t))):typeof i[r]===K3&&i[r](e[r]);return i}function vb(e){N.call(this,null,e)}const Z3=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],dY={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:Z3},{name:"weights",type:"number",array:!0}]};vb.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:Z3.concat(dY)},{name:"as",type:"string",array:!0,default:["value","density"]}]};q(vb,N,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=J3(e.distribution,hY(t)),r=e.steps||e.minsteps||25,o=e.steps||e.maxsteps||200;let a=e.method||"pdf";a!=="pdf"&&a!=="cdf"&&I("Invalid density method: "+a),!e.extent&&!i.data&&I("Missing density extent parameter."),a=i[a];const s=e.as||["value","density"],u=e.extent||vr(i.data()),l=U0(a,u,r,o).map(c=>{const f={};return f[s[0]]=c[0],f[s[1]]=c[1],Le(f)});this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function hY(e){return()=>e.materialize(e.SOURCE).source}function Q3(e,t){return e?e.map((n,i)=>t[i]||ut(n)):null}function bb(e,t,n){const i=[],r=f=>f(u);let o,a,s,u,l,c;if(t==null)i.push(e.map(n));else for(o={},a=0,s=e.length;a<s;++a)u=e[a],l=t.map(r),c=o[l],c||(o[l]=c=[],c.dims=l,i.push(c)),c.push(n(u));return i}const ek="bin";function xb(e){N.call(this,null,e)}xb.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:ek}]};const gY=(e,t)=>Nc(vr(e,t))/30;q(xb,N,{transform(e,t){if(this.value&&!(e.modified()||t.changed()))return t;const n=t.materialize(t.SOURCE).source,i=bb(t.source,e.groupby,yn),r=e.smooth||!1,o=e.field,a=e.step||gY(n,o),s=hs((g,p)=>o(g)-o(p)),u=e.as||ek,l=i.length;let c=1/0,f=-1/0,d=0,h;for(;d<l;++d){const g=i[d].sort(s);h=-1;for(const p of C3(g,a,r,o))p<c&&(c=p),p>f&&(f=p),g[++h][u]=p}return this.value={start:c,stop:f,step:a},t.reflow(!0).modifies(u)}});function tk(e){Ye.call(this,null,pY,e),this.modified(!0)}q(tk,Ye);function pY(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:jn(n=>t(n,e),Xt(t),ut(t))}function wb(e){N.call(this,[void 0,void 0],e)}wb.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]};q(wb,N,{transform(e,t){const n=this.value,i=e.field,r=t.changed()||t.modified(i.fields)||e.modified("field");let o=n[0],a=n[1];if((r||o==null)&&(o=1/0,a=-1/0),t.visit(r?t.SOURCE:t.ADD,s=>{const u=Kt(i(s));u!=null&&(u<o&&(o=u),u>a&&(a=u))}),!Number.isFinite(o)||!Number.isFinite(a)){let s=ut(i);s&&(s=` for field "${s}"`),t.dataflow.warn(`Infinite extent${s}: [${o}, ${a}]`),o=a=void 0}this.value=[o,a]}});function Eb(e,t){Ye.call(this,e),this.parent=t,this.count=0}q(Eb,Ye,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}});function q0(e){N.call(this,{},e),this._keys=Lu();const t=this._targets=[];t.active=0,t.forEach=n=>{for(let i=0,r=t.active;i<r;++i)n(t[i],i,t)}}q(q0,N,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,i){const r=this.value;let o=ae(r,e)&&r[e],a,s;return o?o.value.stamp<n.stamp&&(o.init(n),this.activate(o)):(s=i||(s=this._group[e])&&s.tuple,a=n.dataflow,o=new Eb(n.fork(n.NO_SOURCE),this),a.add(o).connect(t(a,e,s)),r[e]=o,this.activate(o)),o},clean(){const e=this.value;let t=0;for(const n in e)if(e[n].count===0){const i=e[n].detachSubflow;i&&i(),delete e[n],++t}if(t){const n=this._targets.filter(i=>i&&i.count>0);this.initTargets(n)}},initTargets(e){const t=this._targets,n=t.length,i=e?e.length:0;let r=0;for(;r<i;++r)t[r]=e[r];for(;r<n&&t[r]!=null;++r)t[r]=null;t.active=i},transform(e,t){const n=t.dataflow,i=e.key,r=e.subflow,o=this._keys,a=e.modified("key"),s=u=>this.subflow(u,r,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,u=>{const l=ee(u),c=o.get(l);c!==void 0&&(o.delete(l),s(c).rem(u))}),t.visit(t.ADD,u=>{const l=i(u);o.set(ee(u),l),s(l).add(u)}),a||t.modified(i.fields)?t.visit(t.MOD,u=>{const l=ee(u),c=o.get(l),f=i(u);c===f?s(f).mod(u):(o.set(l,f),s(c).rem(u),s(f).add(u))}):t.changed(t.MOD)&&t.visit(t.MOD,u=>{s(o.get(ee(u))).mod(u)}),a&&t.visit(t.REFLOW,u=>{const l=ee(u),c=o.get(l),f=i(u);c!==f&&(o.set(l,f),s(c).rem(u),s(f).add(u))}),t.clean()?n.runAfter(()=>{this.clean(),o.clean()}):o.empty>n.cleanThreshold&&n.runAfter(o.clean),t}});function nk(e){Ye.call(this,null,mY,e)}q(nk,Ye);function mY(e){return this.value&&!e.modified()?this.value:Q(e.name)?oe(e.name).map(t=>Ln(t)):Ln(e.name,e.as)}function _b(e){N.call(this,Lu(),e)}_b.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]};q(_b,N,{transform(e,t){const n=t.dataflow,i=this.value,r=t.fork(),o=r.add,a=r.rem,s=r.mod,u=e.expr;let l=!0;t.visit(t.REM,f=>{const d=ee(f);i.has(d)?i.delete(d):a.push(f)}),t.visit(t.ADD,f=>{u(f,e)?o.push(f):i.set(ee(f),1)});function c(f){const d=ee(f),h=u(f,e),g=i.get(d);h&&g?(i.delete(d),o.push(f)):!h&&!g?(i.set(d,1),a.push(f)):l&&h&&!g&&s.push(f)}return t.visit(t.MOD,c),e.modified()&&(l=!1,t.visit(t.REFLOW,c)),i.empty>n.cleanThreshold&&n.runAfter(i.clean),r}});function Ab(e){N.call(this,[],e)}Ab.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]};q(Ab,N,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=Q3(i,e.as||[]),o=e.index||null,a=r.length;return n.rem=this.value,t.visit(t.SOURCE,s=>{const u=i.map(g=>g(s)),l=u.reduce((g,p)=>Math.max(g,p.length),0);let c=0,f,d,h;for(;c<l;++c){for(d=zv(s),f=0;f<a;++f)d[r[f]]=(h=u[f][c])==null?null:h;o&&(d[o]=c),n.add.push(d)}}),this.value=n.source=n.add,o&&n.modifies(o),n.modifies(r)}});function $b(e){N.call(this,[],e)}$b.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]};q($b,N,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=i.map(ut),o=e.as||["key","value"],a=o[0],s=o[1],u=i.length;return n.rem=this.value,t.visit(t.SOURCE,l=>{for(let c=0,f;c<u;++c)f=zv(l),f[a]=r[c],f[s]=i[c](l),n.add.push(f)}),this.value=n.source=n.add,n.modifies(o)}});function Sb(e){N.call(this,null,e)}Sb.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]};q(Sb,N,{transform(e,t){const n=e.expr,i=e.as,r=e.modified(),o=e.initonly?t.ADD:r?t.SOURCE:t.modified(n.fields)||t.modified(i)?t.ADD_MOD:t.ADD;return r&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(i),t.visit(o,a=>a[i]=n(a,e))}});function ik(e){N.call(this,[],e)}q(ik,N,{transform(e,t){const n=t.fork(t.ALL),i=e.generator;let r=this.value,o=e.size-r.length,a,s,u;if(o>0){for(a=[];--o>=0;)a.push(u=Le(i(e))),r.push(u);n.add=n.add.length?n.materialize(n.ADD).add.concat(a):a}else s=r.slice(0,-o),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(s):s,r=r.slice(-o);return n.source=this.value=r,n}});const H0={value:"value",median:JG,mean:KG,min:cb,max:lb},yY=[];function Ob(e){N.call(this,[],e)}Ob.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function vY(e){var t=e.method||H0.value,n;if(H0[t]==null)I("Unrecognized imputation method: "+t);else return t===H0.value?(n=e.value!==void 0?e.value:0,()=>n):H0[t]}function bY(e){const t=e.field;return n=>n?t(n):NaN}q(Ob,N,{transform(e,t){var n=t.fork(t.ALL),i=vY(e),r=bY(e),o=ut(e.field),a=ut(e.key),s=(e.groupby||[]).map(ut),u=xY(t.source,e.groupby,e.key,e.keyvals),l=[],c=this.value,f=u.domain.length,d,h,g,p,m,y,v,b,x,w;for(m=0,b=u.length;m<b;++m)for(d=u[m],g=d.values,h=NaN,v=0;v<f;++v)if(d[v]==null){for(p=u.domain[v],w={_impute:!0},y=0,x=g.length;y<x;++y)w[s[y]]=g[y];w[a]=p,w[o]=Number.isNaN(h)?h=i(d,r):h,l.push(Le(w))}return l.length&&(n.add=n.materialize(n.ADD).add.concat(l)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=l,n}});function xY(e,t,n,i){var r=y=>y(m),o=[],a=i?i.slice():[],s={},u={},l,c,f,d,h,g,p,m;for(a.forEach((y,v)=>s[y]=v+1),d=0,p=e.length;d<p;++d)m=e[d],g=n(m),h=s[g]||(s[g]=a.push(g)),c=(l=t?t.map(r):yY)+"",(f=u[c])||(f=u[c]=[],o.push(f),f.values=l),f[h-1]=m;return o.domain=a,o}function Cb(e){oa.call(this,e)}Cb.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:cf},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};q(Cb,oa,{transform(e,t){const n=this,i=e.modified();let r;return n.value&&(i||t.modified(n._inputs,!0))?(r=n.value=i?n.init(e):{},t.visit(t.SOURCE,o=>n.add(o))):(r=n.value=n.value||this.init(e),t.visit(t.REM,o=>n.rem(o)),t.visit(t.ADD,o=>n.add(o))),n.changes(),t.visit(t.SOURCE,o=>{ge(o,r[n.cellkey(o)].tuple)}),t.reflow(i).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,i;for(n=0,i=this._alen;n<i;++n)this.celltuple(e[n]),e[n]=null;for(n=0,i=this._mlen;n<i;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}});function Fb(e){N.call(this,null,e)}Fb.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]};q(Fb,N,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=bb(i,e.groupby,e.field),o=(e.groupby||[]).map(ut),a=e.bandwidth,s=e.cumulative?"cdf":"pdf",u=e.as||["value","density"],l=[];let c=e.extent,f=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;s!=="pdf"&&s!=="cdf"&&I("Invalid density method: "+s),e.resolve==="shared"&&(c||(c=vr(i,e.field)),f=d=e.steps||d),r.forEach(h=>{const g=Zv(h,a)[s],p=e.counts?h.length:1,m=c||vr(h);U0(g,m,f,d).forEach(y=>{const v={};for(let b=0;b<o.length;++b)v[o[b]]=h.dims[b];v[u[0]]=y[0],v[u[1]]=y[1]*p,l.push(Le(v))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function rk(e){Ye.call(this,null,wY,e)}q(rk,Ye);function wY(e){return this.value&&!e.modified()?this.value:rv(e.fields,e.flat)}function ok(e){N.call(this,[],e),this._pending=null}q(ok,N,{transform(e,t){const n=t.dataflow;return this._pending?kb(this,t,this._pending):EY(e)?t.StopPropagation:e.values?kb(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(r=>(this._pending=oe(r.data),o=>o.touch(this)))}:n.request(e.url,e.format).then(i=>kb(this,t,oe(i.data)))}});function EY(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function kb(e,t,n){n.forEach(Le);const i=t.fork(t.NO_FIELDS&t.NO_SOURCE);return i.rem=e.value,e.value=i.source=i.add=n,e._pending=null,i.rem.length&&i.clean(!0),i}function Db(e){N.call(this,{},e)}Db.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]};q(Db,N,{transform(e,t){const n=e.fields,i=e.index,r=e.values,o=e.default==null?null:e.default,a=e.modified(),s=n.length;let u=a?t.SOURCE:t.ADD,l=t,c=e.as,f,d,h;return r?(d=r.length,s>1&&!c&&I('Multi-field lookup requires explicit "as" parameter.'),c&&c.length!==s*d&&I('The "as" parameter has too few output field names.'),c=c||r.map(ut),f=function(g){for(var p=0,m=0,y,v;p<s;++p)if(v=i.get(n[p](g)),v==null)for(y=0;y<d;++y,++m)g[c[m]]=o;else for(y=0;y<d;++y,++m)g[c[m]]=r[y](v)}):(c||I("Missing output field names."),f=function(g){for(var p=0,m;p<s;++p)m=i.get(n[p](g)),g[c[p]]=m==null?o:m}),a?l=t.reflow(!0):(h=n.some(g=>t.modified(g.fields)),u|=h?t.MOD:0),t.visit(u,f),l.modifies(c)}});function ak(e){Ye.call(this,null,_Y,e)}q(ak,Ye);function _Y(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let i=1/0,r=-1/0,o,a;for(o=0;o<n;++o)a=t[o],a[0]<i&&(i=a[0]),a[1]>r&&(r=a[1]);return[i,r]}function sk(e){Ye.call(this,null,AY,e)}q(sk,Ye);function AY(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function uk(e){N.call(this,null,e)}q(uk,N,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Mb(e){oa.call(this,e)}Mb.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:cf,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};q(Mb,oa,{_transform:oa.prototype.transform,transform(e,t){return this._transform($Y(e,t),t)}});function $Y(e,t){const n=e.field,i=e.value,r=(e.op==="count"?"__count__":e.op)||"sum",o=Xt(n).concat(Xt(i)),a=OY(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:a.map(()=>r),fields:a.map(s=>SY(s,n,i,o)),as:a.map(s=>s+""),modified:e.modified.bind(e)}}function SY(e,t,n,i){return jn(r=>t(r)===e?n(r):NaN,i,e+"")}function OY(e,t,n){const i={},r=[];return n.visit(n.SOURCE,o=>{const a=e(o);i[a]||(i[a]=1,r.push(a))}),r.sort(v0),t?r.slice(0,t):r}function lk(e){q0.call(this,e)}q(lk,q0,{transform(e,t){const n=e.subflow,i=e.field,r=o=>this.subflow(ee(o),n,t,o);return(e.modified("field")||i&&t.modified(Xt(i)))&&I("PreFacet does not support field modification."),this.initTargets(),i?(t.visit(t.MOD,o=>{const a=r(o);i(o).forEach(s=>a.mod(s))}),t.visit(t.ADD,o=>{const a=r(o);i(o).forEach(s=>a.add(Le(s)))}),t.visit(t.REM,o=>{const a=r(o);i(o).forEach(s=>a.rem(s))})):(t.visit(t.MOD,o=>r(o).mod(o)),t.visit(t.ADD,o=>r(o).add(o)),t.visit(t.REM,o=>r(o).rem(o))),t.clean()&&t.runAfter(()=>this.clean()),t}});function Tb(e){N.call(this,null,e)}Tb.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]};q(Tb,N,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=Q3(e.fields,e.as||[]),o=i?(s,u)=>CY(s,u,i,r):M0;let a;return this.value?a=this.value:(t=t.addAll(),a=this.value={}),t.visit(t.REM,s=>{const u=ee(s);n.rem.push(a[u]),a[u]=null}),t.visit(t.ADD,s=>{const u=o(s,Le({}));a[ee(s)]=u,n.add.push(u)}),t.visit(t.MOD,s=>{n.mod.push(o(s,a[ee(s)]))}),n}});function CY(e,t,n,i){for(let r=0,o=n.length;r<o;++r)t[i[r]]=n[r](e);return t}function ck(e){N.call(this,null,e)}q(ck,N,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function Nb(e){N.call(this,null,e)}Nb.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const FY=1e-14;q(Nb,N,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const r=t.materialize(t.SOURCE).source,o=bb(r,e.groupby,e.field),a=(e.groupby||[]).map(ut),s=[],u=e.step||.01,l=e.probs||U3(u/2,1-FY,u),c=l.length;return o.forEach(f=>{const d=Yv(f,l);for(let h=0;h<c;++h){const g={};for(let p=0;p<a.length;++p)g[a[p]]=f.dims[p];g[i[0]]=l[h],g[i[1]]=d[h],s.push(Le(g))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=s,n}});function fk(e){N.call(this,null,e)}q(fk,N,{transform(e,t){let n,i;return this.value?i=this.value:(n=t=t.addAll(),i=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,r=>{const o=ee(r);n.rem.push(i[o]),i[o]=null}),t.visit(t.ADD,r=>{const o=zv(r);i[ee(r)]=o,n.add.push(o)}),t.visit(t.MOD,r=>{const o=i[ee(r)];for(const a in r)o[a]=r[a],n.modifies(a);n.mod.push(o)})),n}});function Rb(e){N.call(this,[],e),this.count=0}Rb.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};q(Rb,N,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.modified("size"),r=e.size,o=this.value.reduce((c,f)=>(c[ee(f)]=1,c),{});let a=this.value,s=this.count,u=0;function l(c){let f,d;a.length<r?a.push(c):(d=~~((s+1)*Ei()),d<a.length&&d>=u&&(f=a[d],o[ee(f)]&&n.rem.push(f),a[d]=c)),++s}if(t.rem.length&&(t.visit(t.REM,c=>{const f=ee(c);o[f]&&(o[f]=-1,n.rem.push(c)),--s}),a=a.filter(c=>o[ee(c)]!==-1)),(t.rem.length||i)&&a.length<r&&t.source&&(u=s=a.length,t.visit(t.SOURCE,c=>{o[ee(c)]||l(c)}),u=-1),i&&a.length>r){const c=a.length-r;for(let f=0;f<c;++f)o[ee(a[f])]=-1,n.rem.push(a[f]);a=a.slice(c)}return t.mod.length&&t.visit(t.MOD,c=>{o[ee(c)]&&n.mod.push(c)}),t.add.length&&t.visit(t.ADD,l),(t.add.length||u<0)&&(n.add=a.filter(c=>!o[ee(c)])),this.count=s,this.value=n.source=a,n}});function jb(e){N.call(this,null,e)}jb.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};q(jb,N,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),i=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=U3(e.start,e.stop,e.step||1).map(r=>{const o={};return o[i]=r,Le(o)}),n.add=t.add.concat(this.value),n}});function dk(e){N.call(this,null,e),this.modified(!0)}q(dk,N,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function Lb(e){N.call(this,null,e)}const hk=["unit0","unit1"];Lb.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:mv,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:hk}]};q(Lb,N,{transform(e,t){const n=e.field,i=e.interval!==!1,r=e.timezone==="utc",o=this._floor(e,t),a=(r?Uu:zu)(o.unit).offset,s=e.as||hk,u=s[0],l=s[1],c=o.step;let f=o.start||1/0,d=o.stop||-1/0,h=t.ADD;return(e.modified()||t.modified(Xt(n)))&&(t=t.reflow(!0),h=t.SOURCE,f=1/0,d=-1/0),t.visit(h,g=>{const p=n(g);let m,y;p==null?(g[u]=null,i&&(g[l]=null)):(g[u]=m=y=o(p),i&&(g[l]=y=a(m,c)),m<f&&(f=m),y>d&&(d=y))}),o.start=f,o.stop=d,t.modifies(i?s:u)},_floor(e,t){const n=e.timezone==="utc",{units:i,step:r}=e.units?{units:e.units,step:e.step||1}:wF({extent:e.extent||vr(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),o=vv(i),a=this.value||{},s=(n?cF:lF)(o,r);return s.unit=Ee(o),s.units=o,s.step=r,s.start=a.start,s.stop=a.stop,this.value=s}});function gk(e){N.call(this,Lu(),e)}q(gk,N,{transform(e,t){const n=t.dataflow,i=e.field,r=this.value,o=s=>r.set(i(s),s);let a=!0;return e.modified("field")||t.modified(i.fields)?(r.clear(),t.visit(t.SOURCE,o)):t.changed()?(t.visit(t.REM,s=>r.delete(i(s))),t.visit(t.ADD,o)):a=!1,this.modified(a),r.empty>n.cleanThreshold&&n.runAfter(r.clean),t.fork()}});function pk(e){N.call(this,null,e)}q(pk,N,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(hs(e.sort)):t.source).map(e.field))}});function kY(e,t,n,i){const r=ff[e](t,n);return{init:r.init||Ko,update:function(o,a){a[i]=r.next(o)}}}const ff={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?++e:e}}},percent_rank:function(){const e=ff.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,i=t.compare;let r=t.index;if(e<r){for(;r+1<n.length&&!i(n[r],n[r+1]);)++r;e=r}return(1+e)/n.length}}},ntile:function(e,t){t=+t,t>0||I("ntile num must be greater than zero.");const n=ff.cume_dist(),i=n.next;return{init:n.init,next:r=>Math.ceil(t*i(r))}},lag:function(e,t){return t=+t||1,{next:n=>{const i=n.index-t;return i>=0?e(n.data[i]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const i=n.index+t,r=n.data;return i<r.length?e(r[i]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return t=+t,t>0||I("nth_value nth must be greater than zero."),{next:n=>{const i=n.i0+(t-1);return i<n.i1?e(n.data[i]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const i=e(n.data[n.index]);return i!=null?t=i:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:i=>{const r=i.data;return i.index<=n?t:(n=DY(e,r,i.index))<0?(n=r.length,t=null):t=e(r[n])}}}};function DY(e,t,n){for(let i=t.length;n<i;++n)if(e(t[n])!=null)return n;return-1}const MY=Object.keys(ff);function mk(e){const t=oe(e.ops),n=oe(e.fields),i=oe(e.params),r=oe(e.as),o=this.outputs=[],a=this.windows=[],s={},u={},l=[],c=[];let f=!0;function d(h){oe(Xt(h)).forEach(g=>s[g]=1)}d(e.sort),t.forEach((h,g)=>{const p=n[g],m=ut(p),y=q3(h,m,r[g]);if(d(p),o.push(y),ae(ff,h))a.push(kY(h,n[g],i[g],y));else{if(p==null&&h!=="count"&&I("Null aggregate field specified."),h==="count"){l.push(y);return}f=!1;let v=u[m];v||(v=u[m]=[],v.field=p,c.push(v)),v.push(H3(h,y))}}),(l.length||c.length)&&(this.cell=TY(c,l,f)),this.inputs=Object.keys(s)}const yk=mk.prototype;yk.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()};yk.update=function(e,t){const n=this.cell,i=this.windows,r=e.data,o=i&&i.length;let a;if(n){for(a=e.p0;a<e.i0;++a)n.rem(r[a]);for(a=e.p1;a<e.i1;++a)n.add(r[a]);n.set(t)}for(a=0;a<o;++a)i[a].update(e,t)};function TY(e,t,n){e=e.map(u=>G3(u,u.field));const i={num:0,agg:null,store:!1,count:t};if(!n)for(var r=e.length,o=i.agg=Array(r),a=0;a<r;++a)o[a]=new e[a](i);if(i.store)var s=i.data=new hb;return i.add=function(u){if(i.num+=1,!n){s&&s.add(u);for(let l=0;l<r;++l)o[l].add(o[l].get(u),u)}},i.rem=function(u){if(i.num-=1,!n){s&&s.rem(u);for(let l=0;l<r;++l)o[l].rem(o[l].get(u),u)}},i.set=function(u){let l,c;for(s&&s.values(),l=0,c=t.length;l<c;++l)u[t[l]]=i.num;if(!n)for(l=0,c=o.length;l<c;++l)o[l].set(u)},i.init=function(){i.num=0,s&&s.reset();for(let u=0;u<r;++u)o[u].init()},i}function Pb(e){N.call(this,{},e),this._mlen=0,this._mods=[]}Pb.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:MY.concat(cf)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};q(Pb,N,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),i=hs(e.sort),r=fb(e.groupby),o=s=>this.group(r(s));let a=this.state;(!a||n)&&(a=this.state=new mk(e)),n||t.modified(a.inputs)?(this.value={},t.visit(t.SOURCE,s=>o(s).add(s))):(t.visit(t.REM,s=>o(s).remove(s)),t.visit(t.ADD,s=>o(s).add(s)));for(let s=0,u=this._mlen;s<u;++s)NY(this._mods[s],a,i,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(a.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=Y3(ee),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});function NY(e,t,n,i){const r=i.sort,o=r&&!i.ignorePeers,a=i.frame||[null,0],s=e.data(n),u=s.length,l=o?GG(r):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:s,compare:r||Jt(-1)};t.init();for(let f=0;f<u;++f)RY(c,a,f,u),o&&jY(c,l),t.update(c,s[f])}function RY(e,t,n,i){e.p0=e.i0,e.p1=e.i1,e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0])),e.i1=t[1]==null?i:Math.min(i,n+Math.abs(t[1])+1),e.index=n}function jY(e,t){const n=e.i0,i=e.i1-1,r=e.compare,o=e.data,a=o.length-1;n>0&&!r(o[n],o[n-1])&&(e.i0=t.left(o,o[n])),i<a&&!r(o[i],o[i+1])&&(e.i1=t.right(o,o[i]))}var LY=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",aggregate:oa,bin:gb,collect:pb,compare:V3,countpattern:mb,cross:yb,density:vb,dotbin:xb,expression:tk,extent:wb,facet:q0,field:nk,filter:_b,flatten:Ab,fold:$b,formula:Sb,generate:ik,impute:Ob,joinaggregate:Cb,kde:Fb,key:rk,load:ok,lookup:Db,multiextent:ak,multivalues:sk,params:uk,pivot:Mb,prefacet:lk,project:Tb,proxy:ck,quantile:Nb,relay:fk,sample:Rb,sequence:jb,sieve:dk,subflow:Eb,timeunit:Lb,tupleindex:gk,values:pk,window:Pb});const Ib=Math.PI,Bb=2*Ib,ps=1e-6,PY=Bb-ps;function zb(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function ms(){return new zb}zb.prototype=ms.prototype={constructor:zb,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,i){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(e,t,n,i,r,o){this._+="C"+ +e+","+ +t+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+o)},arcTo:function(e,t,n,i,r){e=+e,t=+t,n=+n,i=+i,r=+r;var o=this._x1,a=this._y1,s=n-e,u=i-t,l=o-e,c=a-t,f=l*l+c*c;if(r<0)throw new Error("negative radius: "+r);if(this._x1===null)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>ps)if(!(Math.abs(c*s-u*l)>ps)||!r)this._+="L"+(this._x1=e)+","+(this._y1=t);else{var d=n-o,h=i-a,g=s*s+u*u,p=d*d+h*h,m=Math.sqrt(g),y=Math.sqrt(f),v=r*Math.tan((Ib-Math.acos((g+f-p)/(2*m*y)))/2),b=v/y,x=v/m;Math.abs(b-1)>ps&&(this._+="L"+(e+b*l)+","+(t+b*c)),this._+="A"+r+","+r+",0,0,"+ +(c*d>l*h)+","+(this._x1=e+x*s)+","+(this._y1=t+x*u)}},arc:function(e,t,n,i,r,o){e=+e,t=+t,n=+n,o=!!o;var a=n*Math.cos(i),s=n*Math.sin(i),u=e+a,l=t+s,c=1^o,f=o?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+u+","+l:(Math.abs(this._x1-u)>ps||Math.abs(this._y1-l)>ps)&&(this._+="L"+u+","+l),!!n&&(f<0&&(f=f%Bb+Bb),f>PY?this._+="A"+n+","+n+",0,1,"+c+","+(e-a)+","+(t-s)+"A"+n+","+n+",0,1,"+c+","+(this._x1=u)+","+(this._y1=l):f>ps&&(this._+="A"+n+","+n+",0,"+ +(f>=Ib)+","+c+","+(this._x1=e+n*Math.cos(r))+","+(this._y1=t+n*Math.sin(r))))},rect:function(e,t,n,i){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};function Ie(e){return function(){return e}}var vk=Math.abs,en=Math.atan2,ys=Math.cos,IY=Math.max,Ub=Math.min,wr=Math.sin,Vu=Math.sqrt,tn=1e-12,Xu=Math.PI,W0=Xu/2,bk=2*Xu;function BY(e){return e>1?0:e<-1?Xu:Math.acos(e)}function xk(e){return e>=1?W0:e<=-1?-W0:Math.asin(e)}function zY(e){return e.innerRadius}function UY(e){return e.outerRadius}function qY(e){return e.startAngle}function HY(e){return e.endAngle}function WY(e){return e&&e.padAngle}function GY(e,t,n,i,r,o,a,s){var u=n-e,l=i-t,c=a-r,f=s-o,d=f*u-c*l;if(!(d*d<tn))return d=(c*(t-o)-f*(e-r))/d,[e+d*u,t+d*l]}function G0(e,t,n,i,r,o,a){var s=e-n,u=t-i,l=(a?o:-o)/Vu(s*s+u*u),c=l*u,f=-l*s,d=e+c,h=t+f,g=n+c,p=i+f,m=(d+g)/2,y=(h+p)/2,v=g-d,b=p-h,x=v*v+b*b,w=r-o,_=d*p-g*h,E=(b<0?-1:1)*Vu(IY(0,w*w*x-_*_)),$=(_*b-v*E)/x,O=(-_*v-b*E)/x,C=(_*b+v*E)/x,A=(-_*v+b*E)/x,D=$-m,F=O-y,T=C-m,S=A-y;return D*D+F*F>T*T+S*S&&($=C,O=A),{cx:$,cy:O,x01:-c,y01:-f,x11:$*(r/w-1),y11:O*(r/w-1)}}function YY(){var e=zY,t=UY,n=Ie(0),i=null,r=qY,o=HY,a=WY,s=null;function u(){var l,c,f=+e.apply(this,arguments),d=+t.apply(this,arguments),h=r.apply(this,arguments)-W0,g=o.apply(this,arguments)-W0,p=vk(g-h),m=g>h;if(s||(s=l=ms()),d<f&&(c=d,d=f,f=c),!(d>tn))s.moveTo(0,0);else if(p>bk-tn)s.moveTo(d*ys(h),d*wr(h)),s.arc(0,0,d,h,g,!m),f>tn&&(s.moveTo(f*ys(g),f*wr(g)),s.arc(0,0,f,g,h,m));else{var y=h,v=g,b=h,x=g,w=p,_=p,E=a.apply(this,arguments)/2,$=E>tn&&(i?+i.apply(this,arguments):Vu(f*f+d*d)),O=Ub(vk(d-f)/2,+n.apply(this,arguments)),C=O,A=O,D,F;if($>tn){var T=xk($/f*wr(E)),S=xk($/d*wr(E));(w-=T*2)>tn?(T*=m?1:-1,b+=T,x-=T):(w=0,b=x=(h+g)/2),(_-=S*2)>tn?(S*=m?1:-1,y+=S,v-=S):(_=0,y=v=(h+g)/2)}var M=d*ys(y),P=d*wr(y),B=f*ys(x),H=f*wr(x);if(O>tn){var re=d*ys(v),le=d*wr(v),he=f*ys(b),Ae=f*wr(b),$e;if(p<Xu&&($e=GY(M,P,he,Ae,re,le,B,H))){var Pe=M-$e[0],It=P-$e[1],ti=re-$e[0],Nn=le-$e[1],R=1/wr(BY((Pe*ti+It*Nn)/(Vu(Pe*Pe+It*It)*Vu(ti*ti+Nn*Nn)))/2),W=Vu($e[0]*$e[0]+$e[1]*$e[1]);C=Ub(O,(f-W)/(R-1)),A=Ub(O,(d-W)/(R+1))}}_>tn?A>tn?(D=G0(he,Ae,M,P,d,A,m),F=G0(re,le,B,H,d,A,m),s.moveTo(D.cx+D.x01,D.cy+D.y01),A<O?s.arc(D.cx,D.cy,A,en(D.y01,D.x01),en(F.y01,F.x01),!m):(s.arc(D.cx,D.cy,A,en(D.y01,D.x01),en(D.y11,D.x11),!m),s.arc(0,0,d,en(D.cy+D.y11,D.cx+D.x11),en(F.cy+F.y11,F.cx+F.x11),!m),s.arc(F.cx,F.cy,A,en(F.y11,F.x11),en(F.y01,F.x01),!m))):(s.moveTo(M,P),s.arc(0,0,d,y,v,!m)):s.moveTo(M,P),!(f>tn)||!(w>tn)?s.lineTo(B,H):C>tn?(D=G0(B,H,re,le,f,-C,m),F=G0(M,P,he,Ae,f,-C,m),s.lineTo(D.cx+D.x01,D.cy+D.y01),C<O?s.arc(D.cx,D.cy,C,en(D.y01,D.x01),en(F.y01,F.x01),!m):(s.arc(D.cx,D.cy,C,en(D.y01,D.x01),en(D.y11,D.x11),!m),s.arc(0,0,f,en(D.cy+D.y11,D.cx+D.x11),en(F.cy+F.y11,F.cx+F.x11),m),s.arc(F.cx,F.cy,C,en(F.y11,F.x11),en(F.y01,F.x01),!m))):s.arc(0,0,f,x,b,m)}if(s.closePath(),l)return s=null,l+""||null}return u.centroid=function(){var l=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,c=(+r.apply(this,arguments)+ +o.apply(this,arguments))/2-Xu/2;return[ys(c)*l,wr(c)*l]},u.innerRadius=function(l){return arguments.length?(e=typeof l=="function"?l:Ie(+l),u):e},u.outerRadius=function(l){return arguments.length?(t=typeof l=="function"?l:Ie(+l),u):t},u.cornerRadius=function(l){return arguments.length?(n=typeof l=="function"?l:Ie(+l),u):n},u.padRadius=function(l){return arguments.length?(i=l==null?null:typeof l=="function"?l:Ie(+l),u):i},u.startAngle=function(l){return arguments.length?(r=typeof l=="function"?l:Ie(+l),u):r},u.endAngle=function(l){return arguments.length?(o=typeof l=="function"?l:Ie(+l),u):o},u.padAngle=function(l){return arguments.length?(a=typeof l=="function"?l:Ie(+l),u):a},u.context=function(l){return arguments.length?(s=l==null?null:l,u):s},u}function wk(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Ek(e){this._context=e}Ek.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function qb(e){return new Ek(e)}function _k(e){return e[0]}function Ak(e){return e[1]}function $k(e,t){var n=Ie(!0),i=null,r=qb,o=null;e=typeof e=="function"?e:e===void 0?_k:Ie(e),t=typeof t=="function"?t:t===void 0?Ak:Ie(t);function a(s){var u,l=(s=wk(s)).length,c,f=!1,d;for(i==null&&(o=r(d=ms())),u=0;u<=l;++u)!(u<l&&n(c=s[u],u,s))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+e(c,u,s),+t(c,u,s));if(d)return o=null,d+""||null}return a.x=function(s){return arguments.length?(e=typeof s=="function"?s:Ie(+s),a):e},a.y=function(s){return arguments.length?(t=typeof s=="function"?s:Ie(+s),a):t},a.defined=function(s){return arguments.length?(n=typeof s=="function"?s:Ie(!!s),a):n},a.curve=function(s){return arguments.length?(r=s,i!=null&&(o=r(i)),a):r},a.context=function(s){return arguments.length?(s==null?i=o=null:o=r(i=s),a):i},a}function Sk(e,t,n){var i=null,r=Ie(!0),o=null,a=qb,s=null;e=typeof e=="function"?e:e===void 0?_k:Ie(+e),t=typeof t=="function"?t:Ie(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?Ak:Ie(+n);function u(c){var f,d,h,g=(c=wk(c)).length,p,m=!1,y,v=new Array(g),b=new Array(g);for(o==null&&(s=a(y=ms())),f=0;f<=g;++f){if(!(f<g&&r(p=c[f],f,c))===m)if(m=!m)d=f,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),h=f-1;h>=d;--h)s.point(v[h],b[h]);s.lineEnd(),s.areaEnd()}m&&(v[f]=+e(p,f,c),b[f]=+t(p,f,c),s.point(i?+i(p,f,c):v[f],n?+n(p,f,c):b[f]))}if(y)return s=null,y+""||null}function l(){return $k().defined(r).curve(a).context(o)}return u.x=function(c){return arguments.length?(e=typeof c=="function"?c:Ie(+c),i=null,u):e},u.x0=function(c){return arguments.length?(e=typeof c=="function"?c:Ie(+c),u):e},u.x1=function(c){return arguments.length?(i=c==null?null:typeof c=="function"?c:Ie(+c),u):i},u.y=function(c){return arguments.length?(t=typeof c=="function"?c:Ie(+c),n=null,u):t},u.y0=function(c){return arguments.length?(t=typeof c=="function"?c:Ie(+c),u):t},u.y1=function(c){return arguments.length?(n=c==null?null:typeof c=="function"?c:Ie(+c),u):n},u.lineX0=u.lineY0=function(){return l().x(e).y(t)},u.lineY1=function(){return l().x(e).y(n)},u.lineX1=function(){return l().x(i).y(t)},u.defined=function(c){return arguments.length?(r=typeof c=="function"?c:Ie(!!c),u):r},u.curve=function(c){return arguments.length?(a=c,o!=null&&(s=a(o)),u):a},u.context=function(c){return arguments.length?(c==null?o=s=null:s=a(o=c),u):o},u}var VY={draw:function(e,t){var n=Math.sqrt(t/Xu);e.moveTo(n,0),e.arc(0,0,n,0,bk)}};function XY(e,t){var n=null;e=typeof e=="function"?e:Ie(e||VY),t=typeof t=="function"?t:Ie(t===void 0?64:+t);function i(){var r;if(n||(n=r=ms()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),r)return n=null,r+""||null}return i.type=function(r){return arguments.length?(e=typeof r=="function"?r:Ie(r),i):e},i.size=function(r){return arguments.length?(t=typeof r=="function"?r:Ie(+r),i):t},i.context=function(r){return arguments.length?(n=r==null?null:r,i):n},i}function aa(){}function Y0(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function V0(e){this._context=e}V0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Y0(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Y0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function KY(e){return new V0(e)}function Ok(e){this._context=e}Ok.prototype={areaStart:aa,areaEnd:aa,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Y0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function JY(e){return new Ok(e)}function Ck(e){this._context=e}Ck.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,i=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:Y0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function ZY(e){return new Ck(e)}function Fk(e,t){this._basis=new V0(e),this._beta=t}Fk.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var i=e[0],r=t[0],o=e[n]-i,a=t[n]-r,s=-1,u;++s<=n;)u=s/n,this._basis.point(this._beta*e[s]+(1-this._beta)*(i+u*o),this._beta*t[s]+(1-this._beta)*(r+u*a));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var QY=function e(t){function n(i){return t===1?new V0(i):new Fk(i,t)}return n.beta=function(i){return e(+i)},n}(.85);function X0(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function Hb(e,t){this._context=e,this._k=(1-t)/6}Hb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:X0(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:X0(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var eV=function e(t){function n(i){return new Hb(i,t)}return n.tension=function(i){return e(+i)},n}(0);function Wb(e,t){this._context=e,this._k=(1-t)/6}Wb.prototype={areaStart:aa,areaEnd:aa,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:X0(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var tV=function e(t){function n(i){return new Wb(i,t)}return n.tension=function(i){return e(+i)},n}(0);function Gb(e,t){this._context=e,this._k=(1-t)/6}Gb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:X0(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var nV=function e(t){function n(i){return new Gb(i,t)}return n.tension=function(i){return e(+i)},n}(0);function Yb(e,t,n){var i=e._x1,r=e._y1,o=e._x2,a=e._y2;if(e._l01_a>tn){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,u=3*e._l01_a*(e._l01_a+e._l12_a);i=(i*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/u,r=(r*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/u}if(e._l23_a>tn){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);o=(o*l+e._x1*e._l23_2a-t*e._l12_2a)/c,a=(a*l+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(i,r,o,a,e._x2,e._y2)}function kk(e,t){this._context=e,this._alpha=t}kk.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:Yb(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var iV=function e(t){function n(i){return t?new kk(i,t):new Hb(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function Dk(e,t){this._context=e,this._alpha=t}Dk.prototype={areaStart:aa,areaEnd:aa,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Yb(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var rV=function e(t){function n(i){return t?new Dk(i,t):new Wb(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function Mk(e,t){this._context=e,this._alpha=t}Mk.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Yb(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var oV=function e(t){function n(i){return t?new Mk(i,t):new Gb(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function Tk(e){this._context=e}Tk.prototype={areaStart:aa,areaEnd:aa,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function aV(e){return new Tk(e)}function Nk(e){return e<0?-1:1}function Rk(e,t,n){var i=e._x1-e._x0,r=t-e._x1,o=(e._y1-e._y0)/(i||r<0&&-0),a=(n-e._y1)/(r||i<0&&-0),s=(o*r+a*i)/(i+r);return(Nk(o)+Nk(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function jk(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function Vb(e,t,n){var i=e._x0,r=e._y0,o=e._x1,a=e._y1,s=(o-i)/3;e._context.bezierCurveTo(i+s,r+s*t,o-s,a-s*n,o,a)}function K0(e){this._context=e}K0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Vb(this,this._t0,jk(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Vb(this,jk(this,n=Rk(this,e,t)),n);break;default:Vb(this,this._t0,n=Rk(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function Lk(e){this._context=new Pk(e)}(Lk.prototype=Object.create(K0.prototype)).point=function(e,t){K0.prototype.point.call(this,t,e)};function Pk(e){this._context=e}Pk.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,i,r,o){this._context.bezierCurveTo(t,e,i,n,o,r)}};function sV(e){return new K0(e)}function uV(e){return new Lk(e)}function Ik(e){this._context=e}Ik.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var i=Bk(e),r=Bk(t),o=0,a=1;a<n;++o,++a)this._context.bezierCurveTo(i[0][o],r[0][o],i[1][o],r[1][o],e[a],t[a]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function Bk(e){var t,n=e.length-1,i,r=new Array(n),o=new Array(n),a=new Array(n);for(r[0]=0,o[0]=2,a[0]=e[0]+2*e[1],t=1;t<n-1;++t)r[t]=1,o[t]=4,a[t]=4*e[t]+2*e[t+1];for(r[n-1]=2,o[n-1]=7,a[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)i=r[t]/o[t-1],o[t]-=i,a[t]-=i*a[t-1];for(r[n-1]=a[n-1]/o[n-1],t=n-2;t>=0;--t)r[t]=(a[t]-r[t+1])/o[t];for(o[n-1]=(e[n]+r[n-1])/2,t=0;t<n-1;++t)o[t]=2*e[t+1]-r[t+1];return[r,o]}function lV(e){return new Ik(e)}function J0(e,t){this._context=e,this._t=t}J0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function cV(e){return new J0(e,.5)}function fV(e){return new J0(e,0)}function dV(e){return new J0(e,1)}function Ku(e,t){if(typeof document!="undefined"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}const hV=()=>typeof Image!="undefined"?Image:null;function Xb(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Kb(e){let t=e,n=e;e.length===1&&(t=(a,s)=>e(a)-s,n=gV(e));function i(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)<0?u=c+1:l=c}return u}function r(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)>0?l=c:u=c+1}return u}function o(a,s,u,l){u==null&&(u=0),l==null&&(l=a.length);const c=i(a,s,u,l-1);return c>u&&t(a[c-1],s)>-t(a[c],s)?c-1:c}return{left:i,center:o,right:r}}function gV(e){return(t,n)=>Xb(e(t),n)}function zk(e){return e===null?NaN:+e}const pV=Kb(Xb),Jb=pV.right;Kb(zk).center;var df=Jb,Zb=Math.sqrt(50),Qb=Math.sqrt(10),ex=Math.sqrt(2);function tx(e,t,n){var i,r=-1,o,a,s;if(t=+t,e=+e,n=+n,e===t&&n>0)return[e];if((i=t<e)&&(o=e,e=t,t=o),(s=Uk(e,t,n))===0||!isFinite(s))return[];if(s>0){let u=Math.round(e/s),l=Math.round(t/s);for(u*s<e&&++u,l*s>t&&--l,a=new Array(o=l-u+1);++r<o;)a[r]=(u+r)*s}else{s=-s;let u=Math.round(e*s),l=Math.round(t*s);for(u/s<e&&++u,l/s>t&&--l,a=new Array(o=l-u+1);++r<o;)a[r]=(u+r)/s}return i&&a.reverse(),a}function Uk(e,t,n){var i=(t-e)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),o=i/Math.pow(10,r);return r>=0?(o>=Zb?10:o>=Qb?5:o>=ex?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(o>=Zb?10:o>=Qb?5:o>=ex?2:1)}function nx(e,t,n){var i=Math.abs(t-e)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),o=i/r;return o>=Zb?r*=10:o>=Qb?r*=5:o>=ex&&(r*=2),t<e?-r:r}function mV(e,t,n=zk){if(!!(i=e.length)){if((t=+t)<=0||i<2)return+n(e[0],0,e);if(t>=1)return+n(e[i-1],i-1,e);var i,r=(i-1)*t,o=Math.floor(r),a=+n(e[o],o,e),s=+n(e[o+1],o+1,e);return a+(s-a)*(r-o)}}function yV(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(r);++i<r;)o[i]=e+i*n;return o}function Er(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function sa(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const ix=Symbol("implicit");function rx(){var e=new Map,t=[],n=[],i=ix;function r(o){var a=o+"",s=e.get(a);if(!s){if(i!==ix)return i;e.set(a,s=t.push(o))}return n[(s-1)%n.length]}return r.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new Map;for(const a of o){const s=a+"";e.has(s)||e.set(s,t.push(a))}return r},r.range=function(o){return arguments.length?(n=Array.from(o),r):n.slice()},r.unknown=function(o){return arguments.length?(i=o,r):i},r.copy=function(){return rx(t,n).unknown(i)},Er.apply(r,arguments),r}function Ju(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function hf(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function ua(){}var vs=.7,Zu=1/vs,Qu="\\s*([+-]?\\d+)\\s*",gf="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",_r="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",vV=/^#([0-9a-f]{3,8})$/,bV=new RegExp("^rgb\\("+[Qu,Qu,Qu]+"\\)$"),xV=new RegExp("^rgb\\("+[_r,_r,_r]+"\\)$"),wV=new RegExp("^rgba\\("+[Qu,Qu,Qu,gf]+"\\)$"),EV=new RegExp("^rgba\\("+[_r,_r,_r,gf]+"\\)$"),_V=new RegExp("^hsl\\("+[gf,_r,_r]+"\\)$"),AV=new RegExp("^hsla\\("+[gf,_r,_r,gf]+"\\)$"),qk={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ju(ua,pf,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:Hk,formatHex:Hk,formatHsl:$V,formatRgb:Wk,toString:Wk});function Hk(){return this.rgb().formatHex()}function $V(){return Kk(this).formatHsl()}function Wk(){return this.rgb().formatRgb()}function pf(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=vV.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Gk(t):n===3?new qt(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Z0(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Z0(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=bV.exec(e))?new qt(t[1],t[2],t[3],1):(t=xV.exec(e))?new qt(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=wV.exec(e))?Z0(t[1],t[2],t[3],t[4]):(t=EV.exec(e))?Z0(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=_V.exec(e))?Xk(t[1],t[2]/100,t[3]/100,1):(t=AV.exec(e))?Xk(t[1],t[2]/100,t[3]/100,t[4]):qk.hasOwnProperty(e)?Gk(qk[e]):e==="transparent"?new qt(NaN,NaN,NaN,0):null}function Gk(e){return new qt(e>>16&255,e>>8&255,e&255,1)}function Z0(e,t,n,i){return i<=0&&(e=t=n=NaN),new qt(e,t,n,i)}function ox(e){return e instanceof ua||(e=pf(e)),e?(e=e.rgb(),new qt(e.r,e.g,e.b,e.opacity)):new qt}function Q0(e,t,n,i){return arguments.length===1?ox(e):new qt(e,t,n,i==null?1:i)}function qt(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}Ju(qt,Q0,hf(ua,{brighter:function(e){return e=e==null?Zu:Math.pow(Zu,e),new qt(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?vs:Math.pow(vs,e),new qt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Yk,formatHex:Yk,formatRgb:Vk,toString:Vk}));function Yk(){return"#"+ax(this.r)+ax(this.g)+ax(this.b)}function Vk(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function ax(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function Xk(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Ar(e,t,n,i)}function Kk(e){if(e instanceof Ar)return new Ar(e.h,e.s,e.l,e.opacity);if(e instanceof ua||(e=pf(e)),!e)return new Ar;if(e instanceof Ar)return e;e=e.rgb();var t=e.r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),o=Math.max(t,n,i),a=NaN,s=o-r,u=(o+r)/2;return s?(t===o?a=(n-i)/s+(n<i)*6:n===o?a=(i-t)/s+2:a=(t-n)/s+4,s/=u<.5?o+r:2-o-r,a*=60):s=u>0&&u<1?0:a,new Ar(a,s,u,e.opacity)}function sx(e,t,n,i){return arguments.length===1?Kk(e):new Ar(e,t,n,i==null?1:i)}function Ar(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}Ju(Ar,sx,hf(ua,{brighter:function(e){return e=e==null?Zu:Math.pow(Zu,e),new Ar(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?vs:Math.pow(vs,e),new Ar(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,r=2*n-i;return new qt(ux(e>=240?e-240:e+120,r,i),ux(e,r,i),ux(e<120?e+240:e-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function ux(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Jk=Math.PI/180,Zk=180/Math.PI,eg=18,Qk=.96422,eD=1,tD=.82521,nD=4/29,el=6/29,iD=3*el*el,SV=el*el*el;function rD(e){if(e instanceof $r)return new $r(e.l,e.a,e.b,e.opacity);if(e instanceof po)return oD(e);e instanceof qt||(e=ox(e));var t=hx(e.r),n=hx(e.g),i=hx(e.b),r=cx((.2225045*t+.7168786*n+.0606169*i)/eD),o,a;return t===n&&n===i?o=a=r:(o=cx((.4360747*t+.3850649*n+.1430804*i)/Qk),a=cx((.0139322*t+.0971045*n+.7141733*i)/tD)),new $r(116*r-16,500*(o-r),200*(r-a),e.opacity)}function lx(e,t,n,i){return arguments.length===1?rD(e):new $r(e,t,n,i==null?1:i)}function $r(e,t,n,i){this.l=+e,this.a=+t,this.b=+n,this.opacity=+i}Ju($r,lx,hf(ua,{brighter:function(e){return new $r(this.l+eg*(e==null?1:e),this.a,this.b,this.opacity)},darker:function(e){return new $r(this.l-eg*(e==null?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=Qk*fx(t),e=eD*fx(e),n=tD*fx(n),new qt(dx(3.1338561*t-1.6168667*e-.4906146*n),dx(-.9787684*t+1.9161415*e+.033454*n),dx(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function cx(e){return e>SV?Math.pow(e,1/3):e/iD+nD}function fx(e){return e>el?e*e*e:iD*(e-nD)}function dx(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function hx(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function OV(e){if(e instanceof po)return new po(e.h,e.c,e.l,e.opacity);if(e instanceof $r||(e=rD(e)),e.a===0&&e.b===0)return new po(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*Zk;return new po(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function gx(e,t,n,i){return arguments.length===1?OV(e):new po(e,t,n,i==null?1:i)}function po(e,t,n,i){this.h=+e,this.c=+t,this.l=+n,this.opacity=+i}function oD(e){if(isNaN(e.h))return new $r(e.l,0,0,e.opacity);var t=e.h*Jk;return new $r(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Ju(po,gx,hf(ua,{brighter:function(e){return new po(this.h,this.c,this.l+eg*(e==null?1:e),this.opacity)},darker:function(e){return new po(this.h,this.c,this.l-eg*(e==null?1:e),this.opacity)},rgb:function(){return oD(this).rgb()}}));var aD=-.14861,px=1.78277,mx=-.29227,tg=-.90649,mf=1.97294,sD=mf*tg,uD=mf*px,lD=px*mx-tg*aD;function CV(e){if(e instanceof bs)return new bs(e.h,e.s,e.l,e.opacity);e instanceof qt||(e=ox(e));var t=e.r/255,n=e.g/255,i=e.b/255,r=(lD*i+sD*t-uD*n)/(lD+sD-uD),o=i-r,a=(mf*(n-r)-mx*o)/tg,s=Math.sqrt(a*a+o*o)/(mf*r*(1-r)),u=s?Math.atan2(a,o)*Zk-120:NaN;return new bs(u<0?u+360:u,s,r,e.opacity)}function yx(e,t,n,i){return arguments.length===1?CV(e):new bs(e,t,n,i==null?1:i)}function bs(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}Ju(bs,yx,hf(ua,{brighter:function(e){return e=e==null?Zu:Math.pow(Zu,e),new bs(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?vs:Math.pow(vs,e),new bs(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*Jk,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),i=Math.cos(e),r=Math.sin(e);return new qt(255*(t+n*(aD*i+px*r)),255*(t+n*(mx*i+tg*r)),255*(t+n*(mf*i)),this.opacity)}}));function cD(e,t,n,i,r){var o=e*e,a=o*e;return((1-3*e+3*o-a)*t+(4-6*o+3*a)*n+(1+3*e+3*o-3*a)*i+a*r)/6}function fD(e){var t=e.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),r=e[i],o=e[i+1],a=i>0?e[i-1]:2*r-o,s=i<t-1?e[i+2]:2*o-r;return cD((n-i/t)*t,a,r,o,s)}}function dD(e){var t=e.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*t),r=e[(i+t-1)%t],o=e[i%t],a=e[(i+1)%t],s=e[(i+2)%t];return cD((n-i/t)*t,r,o,a,s)}}var ng=e=>()=>e;function hD(e,t){return function(n){return e+n*t}}function FV(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}function ig(e,t){var n=t-e;return n?hD(e,n>180||n<-180?n-360*Math.round(n/360):n):ng(isNaN(e)?t:e)}function kV(e){return(e=+e)==1?Dt:function(t,n){return n-t?FV(t,n,e):ng(isNaN(t)?n:t)}}function Dt(e,t){var n=t-e;return n?hD(e,n):ng(isNaN(e)?t:e)}var vx=function e(t){var n=kV(t);function i(r,o){var a=n((r=Q0(r)).r,(o=Q0(o)).r),s=n(r.g,o.g),u=n(r.b,o.b),l=Dt(r.opacity,o.opacity);return function(c){return r.r=a(c),r.g=s(c),r.b=u(c),r.opacity=l(c),r+""}}return i.gamma=e,i}(1);function gD(e){return function(t){var n=t.length,i=new Array(n),r=new Array(n),o=new Array(n),a,s;for(a=0;a<n;++a)s=Q0(t[a]),i[a]=s.r||0,r[a]=s.g||0,o[a]=s.b||0;return i=e(i),r=e(r),o=e(o),s.opacity=1,function(u){return s.r=i(u),s.g=r(u),s.b=o(u),s+""}}}var DV=gD(fD),MV=gD(dD);function bx(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,i=t.slice(),r;return function(o){for(r=0;r<n;++r)i[r]=e[r]*(1-o)+t[r]*o;return i}}function pD(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function TV(e,t){return(pD(t)?bx:mD)(e,t)}function mD(e,t){var n=t?t.length:0,i=e?Math.min(n,e.length):0,r=new Array(i),o=new Array(n),a;for(a=0;a<i;++a)r[a]=xs(e[a],t[a]);for(;a<n;++a)o[a]=t[a];return function(s){for(a=0;a<i;++a)o[a]=r[a](s);return o}}function yD(e,t){var n=new Date;return e=+e,t=+t,function(i){return n.setTime(e*(1-i)+t*i),n}}function Gi(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function vD(e,t){var n={},i={},r;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(r in t)r in e?n[r]=xs(e[r],t[r]):i[r]=t[r];return function(o){for(r in n)i[r]=n[r](o);return i}}var xx=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,wx=new RegExp(xx.source,"g");function NV(e){return function(){return e}}function RV(e){return function(t){return e(t)+""}}function bD(e,t){var n=xx.lastIndex=wx.lastIndex=0,i,r,o,a=-1,s=[],u=[];for(e=e+"",t=t+"";(i=xx.exec(e))&&(r=wx.exec(t));)(o=r.index)>n&&(o=t.slice(n,o),s[a]?s[a]+=o:s[++a]=o),(i=i[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,u.push({i:a,x:Gi(i,r)})),n=wx.lastIndex;return n<t.length&&(o=t.slice(n),s[a]?s[a]+=o:s[++a]=o),s.length<2?u[0]?RV(u[0].x):NV(t):(t=u.length,function(l){for(var c=0,f;c<t;++c)s[(f=u[c]).i]=f.x(l);return s.join("")})}function xs(e,t){var n=typeof t,i;return t==null||n==="boolean"?ng(t):(n==="number"?Gi:n==="string"?(i=pf(t))?(t=i,vx):bD:t instanceof pf?vx:t instanceof Date?yD:pD(t)?bx:Array.isArray(t)?mD:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?vD:Gi)(e,t)}function jV(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function LV(e,t){var n=ig(+e,+t);return function(i){var r=n(i);return r-360*Math.floor(r/360)}}function rg(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var xD=180/Math.PI,Ex={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function wD(e,t,n,i,r,o){var a,s,u;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(u=e*n+t*i)&&(n-=e*u,i-=t*u),(s=Math.sqrt(n*n+i*i))&&(n/=s,i/=s,u/=s),e*i<t*n&&(e=-e,t=-t,u=-u,a=-a),{translateX:r,translateY:o,rotate:Math.atan2(t,e)*xD,skewX:Math.atan(u)*xD,scaleX:a,scaleY:s}}var og;function PV(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Ex:wD(t.a,t.b,t.c,t.d,t.e,t.f)}function IV(e){return e==null||(og||(og=document.createElementNS("http://www.w3.org/2000/svg","g")),og.setAttribute("transform",e),!(e=og.transform.baseVal.consolidate()))?Ex:(e=e.matrix,wD(e.a,e.b,e.c,e.d,e.e,e.f))}function ED(e,t,n,i){function r(l){return l.length?l.pop()+" ":""}function o(l,c,f,d,h,g){if(l!==f||c!==d){var p=h.push("translate(",null,t,null,n);g.push({i:p-4,x:Gi(l,f)},{i:p-2,x:Gi(c,d)})}else(f||d)&&h.push("translate("+f+t+d+n)}function a(l,c,f,d){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),d.push({i:f.push(r(f)+"rotate(",null,i)-2,x:Gi(l,c)})):c&&f.push(r(f)+"rotate("+c+i)}function s(l,c,f,d){l!==c?d.push({i:f.push(r(f)+"skewX(",null,i)-2,x:Gi(l,c)}):c&&f.push(r(f)+"skewX("+c+i)}function u(l,c,f,d,h,g){if(l!==f||c!==d){var p=h.push(r(h)+"scale(",null,",",null,")");g.push({i:p-4,x:Gi(l,f)},{i:p-2,x:Gi(c,d)})}else(f!==1||d!==1)&&h.push(r(h)+"scale("+f+","+d+")")}return function(l,c){var f=[],d=[];return l=e(l),c=e(c),o(l.translateX,l.translateY,c.translateX,c.translateY,f,d),a(l.rotate,c.rotate,f,d),s(l.skewX,c.skewX,f,d),u(l.scaleX,l.scaleY,c.scaleX,c.scaleY,f,d),l=c=null,function(h){for(var g=-1,p=d.length,m;++g<p;)f[(m=d[g]).i]=m.x(h);return f.join("")}}}var BV=ED(PV,"px, ","px)","deg)"),zV=ED(IV,", ",")",")"),UV=1e-12;function _D(e){return((e=Math.exp(e))+1/e)/2}function qV(e){return((e=Math.exp(e))-1/e)/2}function HV(e){return((e=Math.exp(2*e))-1)/(e+1)}var WV=function e(t,n,i){function r(o,a){var s=o[0],u=o[1],l=o[2],c=a[0],f=a[1],d=a[2],h=c-s,g=f-u,p=h*h+g*g,m,y;if(p<UV)y=Math.log(d/l)/t,m=function(E){return[s+E*h,u+E*g,l*Math.exp(t*E*y)]};else{var v=Math.sqrt(p),b=(d*d-l*l+i*p)/(2*l*n*v),x=(d*d-l*l-i*p)/(2*d*n*v),w=Math.log(Math.sqrt(b*b+1)-b),_=Math.log(Math.sqrt(x*x+1)-x);y=(_-w)/t,m=function(E){var $=E*y,O=_D(w),C=l/(n*v)*(O*HV(t*$+w)-qV(w));return[s+C*h,u+C*g,l*O/_D(t*$+w)]}}return m.duration=y*1e3*t/Math.SQRT2,m}return r.rho=function(o){var a=Math.max(.001,+o),s=a*a,u=s*s;return e(a,s,u)},r}(Math.SQRT2,2,4);function AD(e){return function(t,n){var i=e((t=sx(t)).h,(n=sx(n)).h),r=Dt(t.s,n.s),o=Dt(t.l,n.l),a=Dt(t.opacity,n.opacity);return function(s){return t.h=i(s),t.s=r(s),t.l=o(s),t.opacity=a(s),t+""}}}var GV=AD(ig),YV=AD(Dt);function VV(e,t){var n=Dt((e=lx(e)).l,(t=lx(t)).l),i=Dt(e.a,t.a),r=Dt(e.b,t.b),o=Dt(e.opacity,t.opacity);return function(a){return e.l=n(a),e.a=i(a),e.b=r(a),e.opacity=o(a),e+""}}function $D(e){return function(t,n){var i=e((t=gx(t)).h,(n=gx(n)).h),r=Dt(t.c,n.c),o=Dt(t.l,n.l),a=Dt(t.opacity,n.opacity);return function(s){return t.h=i(s),t.c=r(s),t.l=o(s),t.opacity=a(s),t+""}}}var XV=$D(ig),KV=$D(Dt);function SD(e){return function t(n){n=+n;function i(r,o){var a=e((r=yx(r)).h,(o=yx(o)).h),s=Dt(r.s,o.s),u=Dt(r.l,o.l),l=Dt(r.opacity,o.opacity);return function(c){return r.h=a(c),r.s=s(c),r.l=u(Math.pow(c,n)),r.opacity=l(c),r+""}}return i.gamma=t,i}(1)}var JV=SD(ig),ZV=SD(Dt);function _x(e,t){t===void 0&&(t=e,e=xs);for(var n=0,i=t.length-1,r=t[0],o=new Array(i<0?0:i);n<i;)o[n]=e(r,r=t[++n]);return function(a){var s=Math.max(0,Math.min(i-1,Math.floor(a*=i)));return o[s](a-s)}}function QV(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e(i/(t-1));return n}var eX=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",interpolate:xs,interpolateArray:TV,interpolateBasis:fD,interpolateBasisClosed:dD,interpolateDate:yD,interpolateDiscrete:jV,interpolateHue:LV,interpolateNumber:Gi,interpolateNumberArray:bx,interpolateObject:vD,interpolateRound:rg,interpolateString:bD,interpolateTransformCss:BV,interpolateTransformSvg:zV,interpolateZoom:WV,interpolateRgb:vx,interpolateRgbBasis:DV,interpolateRgbBasisClosed:MV,interpolateHsl:GV,interpolateHslLong:YV,interpolateLab:VV,interpolateHcl:XV,interpolateHclLong:KV,interpolateCubehelix:JV,interpolateCubehelixLong:ZV,piecewise:_x,quantize:QV});function tX(e){return function(){return e}}function Ax(e){return+e}var OD=[0,1];function zn(e){return e}function $x(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:tX(isNaN(t)?NaN:.5)}function nX(e,t){var n;return e>t&&(n=e,e=t,t=n),function(i){return Math.max(e,Math.min(t,i))}}function iX(e,t,n){var i=e[0],r=e[1],o=t[0],a=t[1];return r<i?(i=$x(r,i),o=n(a,o)):(i=$x(i,r),o=n(o,a)),function(s){return o(i(s))}}function rX(e,t,n){var i=Math.min(e.length,t.length)-1,r=new Array(i),o=new Array(i),a=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<i;)r[a]=$x(e[a],e[a+1]),o[a]=n(t[a],t[a+1]);return function(s){var u=df(e,s,1,i)-1;return o[u](r[u](s))}}function yf(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function ag(){var e=OD,t=OD,n=xs,i,r,o,a=zn,s,u,l;function c(){var d=Math.min(e.length,t.length);return a!==zn&&(a=nX(e[0],e[d-1])),s=d>2?rX:iX,u=l=null,f}function f(d){return d==null||isNaN(d=+d)?o:(u||(u=s(e.map(i),t,n)))(i(a(d)))}return f.invert=function(d){return a(r((l||(l=s(t,e.map(i),Gi)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,Ax),c()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),c()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),n=rg,c()},f.clamp=function(d){return arguments.length?(a=d?!0:zn,c()):a!==zn},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(o=d,f):o},function(d,h){return i=d,r=h,c()}}function CD(){return ag()(zn,zn)}function oX(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function sg(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,i=e.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+e.slice(n+1)]}function tl(e){return e=sg(Math.abs(e)),e?e[1]:NaN}function aX(e,t){return function(n,i){for(var r=n.length,o=[],a=0,s=e[0],u=0;r>0&&s>0&&(u+s+1>i&&(s=Math.max(1,i-u)),o.push(n.substring(r-=s,r+s)),!((u+=s+1)>i));)s=e[a=(a+1)%e.length];return o.reverse().join(t)}}function sX(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var uX=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ug(e){if(!(t=uX.exec(e)))throw new Error("invalid format: "+e);var t;return new Sx({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}ug.prototype=Sx.prototype;function Sx(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Sx.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function lX(e){e:for(var t=e.length,n=1,i=-1,r;n<t;++n)switch(e[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+e[n])break e;i>0&&(i=0);break}return i>0?e.slice(0,i)+e.slice(r+1):e}var FD;function cX(e,t){var n=sg(e,t);if(!n)return e+"";var i=n[0],r=n[1],o=r-(FD=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,a=i.length;return o===a?i:o>a?i+new Array(o-a+1).join("0"):o>0?i.slice(0,o)+"."+i.slice(o):"0."+new Array(1-o).join("0")+sg(e,Math.max(0,t+o-1))[0]}function kD(e,t){var n=sg(e,t);if(!n)return e+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}var DD={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:oX,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>kD(e*100,t),r:kD,s:cX,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function MD(e){return e}var TD=Array.prototype.map,ND=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function fX(e){var t=e.grouping===void 0||e.thousands===void 0?MD:aX(TD.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",i=e.currency===void 0?"":e.currency[1]+"",r=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?MD:sX(TD.call(e.numerals,String)),a=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"\u2212":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function l(f){f=ug(f);var d=f.fill,h=f.align,g=f.sign,p=f.symbol,m=f.zero,y=f.width,v=f.comma,b=f.precision,x=f.trim,w=f.type;w==="n"?(v=!0,w="g"):DD[w]||(b===void 0&&(b=12),x=!0,w="g"),(m||d==="0"&&h==="=")&&(m=!0,d="0",h="=");var _=p==="$"?n:p==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",E=p==="$"?i:/[%p]/.test(w)?a:"",$=DD[w],O=/[defgprs%]/.test(w);b=b===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function C(A){var D=_,F=E,T,S,M;if(w==="c")F=$(A)+F,A="";else{A=+A;var P=A<0||1/A<0;if(A=isNaN(A)?u:$(Math.abs(A),b),x&&(A=lX(A)),P&&+A==0&&g!=="+"&&(P=!1),D=(P?g==="("?g:s:g==="-"||g==="("?"":g)+D,F=(w==="s"?ND[8+FD/3]:"")+F+(P&&g==="("?")":""),O){for(T=-1,S=A.length;++T<S;)if(M=A.charCodeAt(T),48>M||M>57){F=(M===46?r+A.slice(T+1):A.slice(T))+F,A=A.slice(0,T);break}}}v&&!m&&(A=t(A,1/0));var B=D.length+A.length+F.length,H=B<y?new Array(y-B+1).join(d):"";switch(v&&m&&(A=t(H+A,H.length?y-F.length:1/0),H=""),h){case"<":A=D+A+F+H;break;case"=":A=D+H+A+F;break;case"^":A=H.slice(0,B=H.length>>1)+D+A+F+H.slice(B);break;default:A=H+D+A+F;break}return o(A)}return C.toString=function(){return f+""},C}function c(f,d){var h=l((f=ug(f),f.type="f",f)),g=Math.max(-8,Math.min(8,Math.floor(tl(d)/3)))*3,p=Math.pow(10,-g),m=ND[8+g/3];return function(y){return h(p*y)+m}}return{format:l,formatPrefix:c}}var lg,Ox,RD;dX({thousands:",",grouping:[3],currency:["$",""]});function dX(e){return lg=fX(e),Ox=lg.format,RD=lg.formatPrefix,lg}function hX(e){return Math.max(0,-tl(Math.abs(e)))}function gX(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(tl(t)/3)))*3-tl(Math.abs(e)))}function pX(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,tl(t)-tl(e))+1}function jD(e,t,n,i){var r=nx(e,t,n),o;switch(i=ug(i==null?",f":i),i.type){case"s":{var a=Math.max(Math.abs(e),Math.abs(t));return i.precision==null&&!isNaN(o=gX(r,a))&&(i.precision=o),RD(i,a)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(o=pX(r,Math.max(Math.abs(e),Math.abs(t))))&&(i.precision=o-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(o=hX(r))&&(i.precision=o-(i.type==="%")*2);break}}return Ox(i)}function ws(e){var t=e.domain;return e.ticks=function(n){var i=t();return tx(i[0],i[i.length-1],n==null?10:n)},e.tickFormat=function(n,i){var r=t();return jD(r[0],r[r.length-1],n==null?10:n,i)},e.nice=function(n){n==null&&(n=10);var i=t(),r=0,o=i.length-1,a=i[r],s=i[o],u,l,c=10;for(s<a&&(l=a,a=s,s=l,l=r,r=o,o=l);c-- >0;){if(l=Uk(a,s,n),l===u)return i[r]=a,i[o]=s,t(i);if(l>0)a=Math.floor(a/l)*l,s=Math.ceil(s/l)*l;else if(l<0)a=Math.ceil(a*l)/l,s=Math.floor(s*l)/l;else break;u=l}return e},e}function LD(){var e=CD();return e.copy=function(){return yf(e,LD())},Er.apply(e,arguments),ws(e)}function PD(e){var t;function n(i){return i==null||isNaN(i=+i)?t:i}return n.invert=n,n.domain=n.range=function(i){return arguments.length?(e=Array.from(i,Ax),n):e.slice()},n.unknown=function(i){return arguments.length?(t=i,n):t},n.copy=function(){return PD(e).unknown(t)},e=arguments.length?Array.from(e,Ax):[0,1],ws(n)}function ID(e,t){e=e.slice();var n=0,i=e.length-1,r=e[n],o=e[i],a;return o<r&&(a=n,n=i,i=a,a=r,r=o,o=a),e[n]=t.floor(r),e[i]=t.ceil(o),e}function BD(e){return Math.log(e)}function zD(e){return Math.exp(e)}function mX(e){return-Math.log(-e)}function yX(e){return-Math.exp(-e)}function vX(e){return isFinite(e)?+("1e"+e):e<0?0:e}function bX(e){return e===10?vX:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function xX(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function UD(e){return function(t){return-e(-t)}}function Cx(e){var t=e(BD,zD),n=t.domain,i=10,r,o;function a(){return r=xX(i),o=bX(i),n()[0]<0?(r=UD(r),o=UD(o),e(mX,yX)):e(BD,zD),t}return t.base=function(s){return arguments.length?(i=+s,a()):i},t.domain=function(s){return arguments.length?(n(s),a()):n()},t.ticks=function(s){var u=n(),l=u[0],c=u[u.length-1],f;(f=c<l)&&(d=l,l=c,c=d);var d=r(l),h=r(c),g,p,m,y=s==null?10:+s,v=[];if(!(i%1)&&h-d<y){if(d=Math.floor(d),h=Math.ceil(h),l>0){for(;d<=h;++d)for(p=1,g=o(d);p<i;++p)if(m=g*p,!(m<l)){if(m>c)break;v.push(m)}}else for(;d<=h;++d)for(p=i-1,g=o(d);p>=1;--p)if(m=g*p,!(m<l)){if(m>c)break;v.push(m)}v.length*2<y&&(v=tx(l,c,y))}else v=tx(d,h,Math.min(h-d,y)).map(o);return f?v.reverse():v},t.tickFormat=function(s,u){if(u==null&&(u=i===10?".0e":","),typeof u!="function"&&(u=Ox(u)),s===1/0)return u;s==null&&(s=10);var l=Math.max(1,i*s/t.ticks().length);return function(c){var f=c/o(Math.round(r(c)));return f*i<i-.5&&(f*=i),f<=l?u(c):""}},t.nice=function(){return n(ID(n(),{floor:function(s){return o(Math.floor(r(s)))},ceil:function(s){return o(Math.ceil(r(s)))}}))},t}function qD(){var e=Cx(ag()).domain([1,10]);return e.copy=function(){return yf(e,qD()).base(e.base())},Er.apply(e,arguments),e}function HD(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function WD(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Fx(e){var t=1,n=e(HD(t),WD(t));return n.constant=function(i){return arguments.length?e(HD(t=+i),WD(t)):t},ws(n)}function GD(){var e=Fx(ag());return e.copy=function(){return yf(e,GD()).constant(e.constant())},Er.apply(e,arguments)}function YD(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function wX(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function EX(e){return e<0?-e*e:e*e}function kx(e){var t=e(zn,zn),n=1;function i(){return n===1?e(zn,zn):n===.5?e(wX,EX):e(YD(n),YD(1/n))}return t.exponent=function(r){return arguments.length?(n=+r,i()):n},ws(t)}function Dx(){var e=kx(ag());return e.copy=function(){return yf(e,Dx()).exponent(e.exponent())},Er.apply(e,arguments),e}function _X(){return Dx.apply(null,arguments).exponent(.5)}function VD(){var e=[],t=[],n=[],i;function r(){var a=0,s=Math.max(1,t.length);for(n=new Array(s-1);++a<s;)n[a-1]=mV(e,a/s);return o}function o(a){return a==null||isNaN(a=+a)?i:t[df(n,a)]}return o.invertExtent=function(a){var s=t.indexOf(a);return s<0?[NaN,NaN]:[s>0?n[s-1]:e[0],s<n.length?n[s]:e[e.length-1]]},o.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let s of a)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(Xb),r()},o.range=function(a){return arguments.length?(t=Array.from(a),r()):t.slice()},o.unknown=function(a){return arguments.length?(i=a,o):i},o.quantiles=function(){return n.slice()},o.copy=function(){return VD().domain(e).range(t).unknown(i)},Er.apply(o,arguments)}function XD(){var e=0,t=1,n=1,i=[.5],r=[0,1],o;function a(u){return u!=null&&u<=u?r[df(i,u,0,n)]:o}function s(){var u=-1;for(i=new Array(n);++u<n;)i[u]=((u+1)*t-(u-n)*e)/(n+1);return a}return a.domain=function(u){return arguments.length?([e,t]=u,e=+e,t=+t,s()):[e,t]},a.range=function(u){return arguments.length?(n=(r=Array.from(u)).length-1,s()):r.slice()},a.invertExtent=function(u){var l=r.indexOf(u);return l<0?[NaN,NaN]:l<1?[e,i[0]]:l>=n?[i[n-1],t]:[i[l-1],i[l]]},a.unknown=function(u){return arguments.length&&(o=u),a},a.thresholds=function(){return i.slice()},a.copy=function(){return XD().domain([e,t]).range(r).unknown(o)},Er.apply(ws(a),arguments)}function KD(){var e=[.5],t=[0,1],n,i=1;function r(o){return o!=null&&o<=o?t[df(e,o,0,i)]:n}return r.domain=function(o){return arguments.length?(e=Array.from(o),i=Math.min(e.length,t.length-1),r):e.slice()},r.range=function(o){return arguments.length?(t=Array.from(o),i=Math.min(e.length,t.length-1),r):t.slice()},r.invertExtent=function(o){var a=t.indexOf(o);return[e[a-1],e[a]]},r.unknown=function(o){return arguments.length?(n=o,r):n},r.copy=function(){return KD().domain(e).range(t).unknown(n)},Er.apply(r,arguments)}var Mx=new Date,Tx=new Date;function Mt(e,t,n,i){function r(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return r.floor=function(o){return e(o=new Date(+o)),o},r.ceil=function(o){return e(o=new Date(o-1)),t(o,1),e(o),o},r.round=function(o){var a=r(o),s=r.ceil(o);return o-a<s-o?a:s},r.offset=function(o,a){return t(o=new Date(+o),a==null?1:Math.floor(a)),o},r.range=function(o,a,s){var u=[],l;if(o=r.ceil(o),s=s==null?1:Math.floor(s),!(o<a)||!(s>0))return u;do u.push(l=new Date(+o)),t(o,s),e(o);while(l<o&&o<a);return u},r.filter=function(o){return Mt(function(a){if(a>=a)for(;e(a),!o(a);)a.setTime(a-1)},function(a,s){if(a>=a)if(s<0)for(;++s<=0;)for(;t(a,-1),!o(a););else for(;--s>=0;)for(;t(a,1),!o(a););})},n&&(r.count=function(o,a){return Mx.setTime(+o),Tx.setTime(+a),e(Mx),e(Tx),Math.floor(n(Mx,Tx))},r.every=function(o){return o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?r.filter(i?function(a){return i(a)%o==0}:function(a){return r.count(0,a)%o==0}):r}),r}var Nx=Mt(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});Nx.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Mt(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):Nx};var AX=Nx;const mo=1e3,_i=mo*60,yo=_i*60,Es=yo*24,Rx=Es*7,JD=Es*30,jx=Es*365;var $X=Mt(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*mo)},function(e,t){return(t-e)/mo},function(e){return e.getUTCSeconds()}),nl=$X,SX=Mt(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*mo)},function(e,t){e.setTime(+e+t*_i)},function(e,t){return(t-e)/_i},function(e){return e.getMinutes()}),ZD=SX,OX=Mt(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*mo-e.getMinutes()*_i)},function(e,t){e.setTime(+e+t*yo)},function(e,t){return(t-e)/yo},function(e){return e.getHours()}),QD=OX,CX=Mt(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*_i)/Es,e=>e.getDate()-1),cg=CX;function _s(e){return Mt(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+n*7)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*_i)/Rx})}var Lx=_s(0),Px=_s(1);_s(2);_s(3);var vf=_s(4);_s(5);_s(6);var FX=Mt(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()}),eM=FX,tM=Mt(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});tM.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:Mt(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)})};var As=tM,kX=Mt(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*_i)},function(e,t){return(t-e)/_i},function(e){return e.getUTCMinutes()}),nM=kX,DX=Mt(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*yo)},function(e,t){return(t-e)/yo},function(e){return e.getUTCHours()}),iM=DX,MX=Mt(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/Es},function(e){return e.getUTCDate()-1}),fg=MX;function $s(e){return Mt(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n*7)},function(t,n){return(n-t)/Rx})}var Ix=$s(0),Bx=$s(1);$s(2);$s(3);var bf=$s(4);$s(5);$s(6);var TX=Mt(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12},function(e){return e.getUTCMonth()}),rM=TX,oM=Mt(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});oM.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:Mt(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})};var Ss=oM;function aM(e,t,n,i,r,o){const a=[[nl,1,mo],[nl,5,5*mo],[nl,15,15*mo],[nl,30,30*mo],[o,1,_i],[o,5,5*_i],[o,15,15*_i],[o,30,30*_i],[r,1,yo],[r,3,3*yo],[r,6,6*yo],[r,12,12*yo],[i,1,Es],[i,2,2*Es],[n,1,Rx],[t,1,JD],[t,3,3*JD],[e,1,jx]];function s(l,c,f){const d=c<l;d&&([l,c]=[c,l]);const h=f&&typeof f.range=="function"?f:u(l,c,f),g=h?h.range(l,+c+1):[];return d?g.reverse():g}function u(l,c,f){const d=Math.abs(c-l)/f,h=Kb(([,,m])=>m).right(a,d);if(h===a.length)return e.every(nx(l/jx,c/jx,f));if(h===0)return AX.every(Math.max(nx(l,c,f),1));const[g,p]=a[d/a[h-1][2]<a[h][2]/d?h-1:h];return g.every(p)}return[s,u]}const[NX,RX]=aM(Ss,rM,Ix,fg,iM,nM),[jX,LX]=aM(As,eM,Lx,cg,QD,ZD);function zx(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Ux(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function xf(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function PX(e){var t=e.dateTime,n=e.date,i=e.time,r=e.periods,o=e.days,a=e.shortDays,s=e.months,u=e.shortMonths,l=wf(r),c=Ef(r),f=wf(o),d=Ef(o),h=wf(a),g=Ef(a),p=wf(s),m=Ef(s),y=wf(u),v=Ef(u),b={a:P,A:B,b:H,B:re,c:null,d:dM,e:dM,f:sK,g:yK,G:bK,H:rK,I:oK,j:aK,L:hM,m:uK,M:lK,p:le,q:he,Q:bM,s:xM,S:cK,u:fK,U:dK,V:hK,w:gK,W:pK,x:null,X:null,y:mK,Y:vK,Z:xK,"%":vM},x={a:Ae,A:$e,b:Pe,B:It,c:null,d:pM,e:pM,f:AK,g:NK,G:jK,H:wK,I:EK,j:_K,L:mM,m:$K,M:SK,p:ti,q:Nn,Q:bM,s:xM,S:OK,u:CK,U:FK,V:kK,w:DK,W:MK,x:null,X:null,y:TK,Y:RK,Z:LK,"%":vM},w={a:C,A,b:D,B:F,c:T,d:cM,e:cM,f:eK,g:lM,G:uM,H:fM,I:fM,j:KX,L:QX,m:XX,M:JX,p:O,q:VX,Q:nK,s:iK,S:ZX,u:qX,U:HX,V:WX,w:UX,W:GX,x:S,X:M,y:lM,Y:uM,Z:YX,"%":tK};b.x=_(n,b),b.X=_(i,b),b.c=_(t,b),x.x=_(n,x),x.X=_(i,x),x.c=_(t,x);function _(R,W){return function(V){var k=[],xe=-1,X=0,Ce=R.length,we,Yt,bi;for(V instanceof Date||(V=new Date(+V));++xe<Ce;)R.charCodeAt(xe)===37&&(k.push(R.slice(X,xe)),(Yt=sM[we=R.charAt(++xe)])!=null?we=R.charAt(++xe):Yt=we==="e"?" ":"0",(bi=W[we])&&(we=bi(V,Yt)),k.push(we),X=xe+1);return k.push(R.slice(X,xe)),k.join("")}}function E(R,W){return function(V){var k=xf(1900,void 0,1),xe=$(k,R,V+="",0),X,Ce;if(xe!=V.length)return null;if("Q"in k)return new Date(k.Q);if("s"in k)return new Date(k.s*1e3+("L"in k?k.L:0));if(W&&!("Z"in k)&&(k.Z=0),"p"in k&&(k.H=k.H%12+k.p*12),k.m===void 0&&(k.m="q"in k?k.q:0),"V"in k){if(k.V<1||k.V>53)return null;"w"in k||(k.w=1),"Z"in k?(X=Ux(xf(k.y,0,1)),Ce=X.getUTCDay(),X=Ce>4||Ce===0?Bx.ceil(X):Bx(X),X=fg.offset(X,(k.V-1)*7),k.y=X.getUTCFullYear(),k.m=X.getUTCMonth(),k.d=X.getUTCDate()+(k.w+6)%7):(X=zx(xf(k.y,0,1)),Ce=X.getDay(),X=Ce>4||Ce===0?Px.ceil(X):Px(X),X=cg.offset(X,(k.V-1)*7),k.y=X.getFullYear(),k.m=X.getMonth(),k.d=X.getDate()+(k.w+6)%7)}else("W"in k||"U"in k)&&("w"in k||(k.w="u"in k?k.u%7:"W"in k?1:0),Ce="Z"in k?Ux(xf(k.y,0,1)).getUTCDay():zx(xf(k.y,0,1)).getDay(),k.m=0,k.d="W"in k?(k.w+6)%7+k.W*7-(Ce+5)%7:k.w+k.U*7-(Ce+6)%7);return"Z"in k?(k.H+=k.Z/100|0,k.M+=k.Z%100,Ux(k)):zx(k)}}function $(R,W,V,k){for(var xe=0,X=W.length,Ce=V.length,we,Yt;xe<X;){if(k>=Ce)return-1;if(we=W.charCodeAt(xe++),we===37){if(we=W.charAt(xe++),Yt=w[we in sM?W.charAt(xe++):we],!Yt||(k=Yt(R,V,k))<0)return-1}else if(we!=V.charCodeAt(k++))return-1}return k}function O(R,W,V){var k=l.exec(W.slice(V));return k?(R.p=c.get(k[0].toLowerCase()),V+k[0].length):-1}function C(R,W,V){var k=h.exec(W.slice(V));return k?(R.w=g.get(k[0].toLowerCase()),V+k[0].length):-1}function A(R,W,V){var k=f.exec(W.slice(V));return k?(R.w=d.get(k[0].toLowerCase()),V+k[0].length):-1}function D(R,W,V){var k=y.exec(W.slice(V));return k?(R.m=v.get(k[0].toLowerCase()),V+k[0].length):-1}function F(R,W,V){var k=p.exec(W.slice(V));return k?(R.m=m.get(k[0].toLowerCase()),V+k[0].length):-1}function T(R,W,V){return $(R,t,W,V)}function S(R,W,V){return $(R,n,W,V)}function M(R,W,V){return $(R,i,W,V)}function P(R){return a[R.getDay()]}function B(R){return o[R.getDay()]}function H(R){return u[R.getMonth()]}function re(R){return s[R.getMonth()]}function le(R){return r[+(R.getHours()>=12)]}function he(R){return 1+~~(R.getMonth()/3)}function Ae(R){return a[R.getUTCDay()]}function $e(R){return o[R.getUTCDay()]}function Pe(R){return u[R.getUTCMonth()]}function It(R){return s[R.getUTCMonth()]}function ti(R){return r[+(R.getUTCHours()>=12)]}function Nn(R){return 1+~~(R.getUTCMonth()/3)}return{format:function(R){var W=_(R+="",b);return W.toString=function(){return R},W},parse:function(R){var W=E(R+="",!1);return W.toString=function(){return R},W},utcFormat:function(R){var W=_(R+="",x);return W.toString=function(){return R},W},utcParse:function(R){var W=E(R+="",!0);return W.toString=function(){return R},W}}}var sM={"-":"",_:" ","0":"0"},Tt=/^\s*\d+/,IX=/^%/,BX=/[\\^$*+?|[\]().{}]/g;function Te(e,t,n){var i=e<0?"-":"",r=(i?-e:e)+"",o=r.length;return i+(o<n?new Array(n-o+1).join(t)+r:r)}function zX(e){return e.replace(BX,"\\$&")}function wf(e){return new RegExp("^(?:"+e.map(zX).join("|")+")","i")}function Ef(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function UX(e,t,n){var i=Tt.exec(t.slice(n,n+1));return i?(e.w=+i[0],n+i[0].length):-1}function qX(e,t,n){var i=Tt.exec(t.slice(n,n+1));return i?(e.u=+i[0],n+i[0].length):-1}function HX(e,t,n){var i=Tt.exec(t.slice(n,n+2));return i?(e.U=+i[0],n+i[0].length):-1}function WX(e,t,n){var i=Tt.exec(t.slice(n,n+2));return i?(e.V=+i[0],n+i[0].length):-1}function GX(e,t,n){var i=Tt.exec(t.slice(n,n+2));return i?(e.W=+i[0],n+i[0].length):-1}function uM(e,t,n){var i=Tt.exec(t.slice(n,n+4));return i?(e.y=+i[0],n+i[0].length):-1}function lM(e,t,n){var i=Tt.exec(t.slice(n,n+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function YX(e,t,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function VX(e,t,n){var i=Tt.exec(t.slice(n,n+1));return i?(e.q=i[0]*3-3,n+i[0].length):-1}function XX(e,t,n){var i=Tt.exec(t.slice(n,n+2));return i?(e.m=i[0]-1,n+i[0].length):-1}function cM(e,t,n){var i=Tt.exec(t.slice(n,n+2));return i?(e.d=+i[0],n+i[0].length):-1}function KX(e,t,n){var i=Tt.exec(t.slice(n,n+3));return i?(e.m=0,e.d=+i[0],n+i[0].length):-1}function fM(e,t,n){var i=Tt.exec(t.slice(n,n+2));return i?(e.H=+i[0],n+i[0].length):-1}function JX(e,t,n){var i=Tt.exec(t.slice(n,n+2));return i?(e.M=+i[0],n+i[0].length):-1}function ZX(e,t,n){var i=Tt.exec(t.slice(n,n+2));return i?(e.S=+i[0],n+i[0].length):-1}function QX(e,t,n){var i=Tt.exec(t.slice(n,n+3));return i?(e.L=+i[0],n+i[0].length):-1}function eK(e,t,n){var i=Tt.exec(t.slice(n,n+6));return i?(e.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function tK(e,t,n){var i=IX.exec(t.slice(n,n+1));return i?n+i[0].length:-1}function nK(e,t,n){var i=Tt.exec(t.slice(n));return i?(e.Q=+i[0],n+i[0].length):-1}function iK(e,t,n){var i=Tt.exec(t.slice(n));return i?(e.s=+i[0],n+i[0].length):-1}function dM(e,t){return Te(e.getDate(),t,2)}function rK(e,t){return Te(e.getHours(),t,2)}function oK(e,t){return Te(e.getHours()%12||12,t,2)}function aK(e,t){return Te(1+cg.count(As(e),e),t,3)}function hM(e,t){return Te(e.getMilliseconds(),t,3)}function sK(e,t){return hM(e,t)+"000"}function uK(e,t){return Te(e.getMonth()+1,t,2)}function lK(e,t){return Te(e.getMinutes(),t,2)}function cK(e,t){return Te(e.getSeconds(),t,2)}function fK(e){var t=e.getDay();return t===0?7:t}function dK(e,t){return Te(Lx.count(As(e)-1,e),t,2)}function gM(e){var t=e.getDay();return t>=4||t===0?vf(e):vf.ceil(e)}function hK(e,t){return e=gM(e),Te(vf.count(As(e),e)+(As(e).getDay()===4),t,2)}function gK(e){return e.getDay()}function pK(e,t){return Te(Px.count(As(e)-1,e),t,2)}function mK(e,t){return Te(e.getFullYear()%100,t,2)}function yK(e,t){return e=gM(e),Te(e.getFullYear()%100,t,2)}function vK(e,t){return Te(e.getFullYear()%1e4,t,4)}function bK(e,t){var n=e.getDay();return e=n>=4||n===0?vf(e):vf.ceil(e),Te(e.getFullYear()%1e4,t,4)}function xK(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Te(t/60|0,"0",2)+Te(t%60,"0",2)}function pM(e,t){return Te(e.getUTCDate(),t,2)}function wK(e,t){return Te(e.getUTCHours(),t,2)}function EK(e,t){return Te(e.getUTCHours()%12||12,t,2)}function _K(e,t){return Te(1+fg.count(Ss(e),e),t,3)}function mM(e,t){return Te(e.getUTCMilliseconds(),t,3)}function AK(e,t){return mM(e,t)+"000"}function $K(e,t){return Te(e.getUTCMonth()+1,t,2)}function SK(e,t){return Te(e.getUTCMinutes(),t,2)}function OK(e,t){return Te(e.getUTCSeconds(),t,2)}function CK(e){var t=e.getUTCDay();return t===0?7:t}function FK(e,t){return Te(Ix.count(Ss(e)-1,e),t,2)}function yM(e){var t=e.getUTCDay();return t>=4||t===0?bf(e):bf.ceil(e)}function kK(e,t){return e=yM(e),Te(bf.count(Ss(e),e)+(Ss(e).getUTCDay()===4),t,2)}function DK(e){return e.getUTCDay()}function MK(e,t){return Te(Bx.count(Ss(e)-1,e),t,2)}function TK(e,t){return Te(e.getUTCFullYear()%100,t,2)}function NK(e,t){return e=yM(e),Te(e.getUTCFullYear()%100,t,2)}function RK(e,t){return Te(e.getUTCFullYear()%1e4,t,4)}function jK(e,t){var n=e.getUTCDay();return e=n>=4||n===0?bf(e):bf.ceil(e),Te(e.getUTCFullYear()%1e4,t,4)}function LK(){return"+0000"}function vM(){return"%"}function bM(e){return+e}function xM(e){return Math.floor(+e/1e3)}var dg,wM,EM;PK({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function PK(e){return dg=PX(e),wM=dg.format,EM=dg.utcFormat,dg}function IK(e){return new Date(e)}function BK(e){return e instanceof Date?+e:+new Date(+e)}function qx(e,t,n,i,r,o,a,s,u,l){var c=CD(),f=c.invert,d=c.domain,h=l(".%L"),g=l(":%S"),p=l("%I:%M"),m=l("%I %p"),y=l("%a %d"),v=l("%b %d"),b=l("%B"),x=l("%Y");function w(_){return(u(_)<_?h:s(_)<_?g:a(_)<_?p:o(_)<_?m:i(_)<_?r(_)<_?y:v:n(_)<_?b:x)(_)}return c.invert=function(_){return new Date(f(_))},c.domain=function(_){return arguments.length?d(Array.from(_,BK)):d().map(IK)},c.ticks=function(_){var E=d();return e(E[0],E[E.length-1],_==null?10:_)},c.tickFormat=function(_,E){return E==null?w:l(E)},c.nice=function(_){var E=d();return(!_||typeof _.range!="function")&&(_=t(E[0],E[E.length-1],_==null?10:_)),_?d(ID(E,_)):c},c.copy=function(){return yf(c,qx(e,t,n,i,r,o,a,s,u,l))},c}function zK(){return Er.apply(qx(jX,LX,As,eM,Lx,cg,QD,ZD,nl,wM).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function UK(){return Er.apply(qx(NX,RX,Ss,rM,Ix,fg,iM,nM,nl,EM).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function hg(){var e=0,t=1,n,i,r,o,a=zn,s=!1,u;function l(f){return f==null||isNaN(f=+f)?u:a(r===0?.5:(f=(o(f)-n)*r,s?Math.max(0,Math.min(1,f)):f))}l.domain=function(f){return arguments.length?([e,t]=f,n=o(e=+e),i=o(t=+t),r=n===i?0:1/(i-n),l):[e,t]},l.clamp=function(f){return arguments.length?(s=!!f,l):s},l.interpolator=function(f){return arguments.length?(a=f,l):a};function c(f){return function(d){var h,g;return arguments.length?([h,g]=d,a=f(h,g),l):[a(0),a(1)]}}return l.range=c(xs),l.rangeRound=c(rg),l.unknown=function(f){return arguments.length?(u=f,l):u},function(f){return o=f,n=f(e),i=f(t),r=n===i?0:1/(i-n),l}}function la(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Hx(){var e=ws(hg()(zn));return e.copy=function(){return la(e,Hx())},sa.apply(e,arguments)}function _M(){var e=Cx(hg()).domain([1,10]);return e.copy=function(){return la(e,_M()).base(e.base())},sa.apply(e,arguments)}function AM(){var e=Fx(hg());return e.copy=function(){return la(e,AM()).constant(e.constant())},sa.apply(e,arguments)}function Wx(){var e=kx(hg());return e.copy=function(){return la(e,Wx()).exponent(e.exponent())},sa.apply(e,arguments)}function qK(){return Wx.apply(null,arguments).exponent(.5)}function gg(){var e=0,t=.5,n=1,i=1,r,o,a,s,u,l=zn,c,f=!1,d;function h(p){return isNaN(p=+p)?d:(p=.5+((p=+c(p))-o)*(i*p<i*o?s:u),l(f?Math.max(0,Math.min(1,p)):p))}h.domain=function(p){return arguments.length?([e,t,n]=p,r=c(e=+e),o=c(t=+t),a=c(n=+n),s=r===o?0:.5/(o-r),u=o===a?0:.5/(a-o),i=o<r?-1:1,h):[e,t,n]},h.clamp=function(p){return arguments.length?(f=!!p,h):f},h.interpolator=function(p){return arguments.length?(l=p,h):l};function g(p){return function(m){var y,v,b;return arguments.length?([y,v,b]=m,l=_x(p,[y,v,b]),h):[l(0),l(.5),l(1)]}}return h.range=g(xs),h.rangeRound=g(rg),h.unknown=function(p){return arguments.length?(d=p,h):d},function(p){return c=p,r=p(e),o=p(t),a=p(n),s=r===o?0:.5/(o-r),u=o===a?0:.5/(a-o),i=o<r?-1:1,h}}function $M(){var e=ws(gg()(zn));return e.copy=function(){return la(e,$M())},sa.apply(e,arguments)}function SM(){var e=Cx(gg()).domain([.1,1,10]);return e.copy=function(){return la(e,SM()).base(e.base())},sa.apply(e,arguments)}function OM(){var e=Fx(gg());return e.copy=function(){return la(e,OM()).constant(e.constant())},sa.apply(e,arguments)}function Gx(){var e=kx(gg());return e.copy=function(){return la(e,Gx()).exponent(e.exponent())},sa.apply(e,arguments)}function HK(){return Gx.apply(null,arguments).exponent(.5)}function Yx(e,t,n){const i=e-t+n*2;return e?i>0?i:1:0}const WK="identity",il="linear",vo="log",_f="pow",Af="sqrt",pg="symlog",Os="time",Cs="utc",Sr="sequential",rl="diverging",ol="quantile",mg="quantize",yg="threshold",Vx="ordinal",Xx="point",CM="band",Kx="bin-ordinal",wt="continuous",$f="discrete",Sf="discretizing",Ai="interpolating",Jx="temporal";function GK(e){return function(t){let n=t[0],i=t[1],r;return i<n&&(r=n,n=i,i=r),[e.invert(n),e.invert(i)]}}function YK(e){return function(t){const n=e.range();let i=t[0],r=t[1],o=-1,a,s,u,l;for(r<i&&(s=i,i=r,r=s),u=0,l=n.length;u<l;++u)n[u]>=i&&n[u]<=r&&(o<0&&(o=u),a=u);if(!(o<0))return i=e.invertExtent(n[o]),r=e.invertExtent(n[a]),[i[0]===void 0?i[1]:i[0],r[1]===void 0?r[0]:r[1]]}}function Zx(){const e=rx().unknown(void 0),t=e.domain,n=e.range;let i=[0,1],r,o,a=!1,s=0,u=0,l=.5;delete e.unknown;function c(){const f=t().length,d=i[1]<i[0],h=i[1-d],g=Yx(f,s,u);let p=i[d-0];r=(h-p)/(g||1),a&&(r=Math.floor(r)),p+=(h-p-r*(f-s))*l,o=r*(1-s),a&&(p=Math.round(p),o=Math.round(o));const m=yV(f).map(y=>p+r*y);return n(d?m.reverse():m)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(i=[+f[0],+f[1]],c()):i.slice()},e.rangeRound=function(f){return i=[+f[0],+f[1]],a=!0,c()},e.bandwidth=function(){return o},e.step=function(){return r},e.round=function(f){return arguments.length?(a=!!f,c()):a},e.padding=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),s=u,c()):s},e.paddingInner=function(f){return arguments.length?(s=Math.max(0,Math.min(1,f)),c()):s},e.paddingOuter=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.align=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const d=i[1]<i[0],h=d?n().reverse():n(),g=h.length-1;let p=+f[0],m=+f[1],y,v,b;if(!(p!==p||m!==m)&&(m<p&&(b=p,p=m,m=b),!(m<h[0]||p>i[1-d])))return y=Math.max(0,Jb(h,p)-1),v=p===m?y:Jb(h,m)-1,p-h[y]>o+1e-10&&++y,d&&(b=y,y=g-v,v=g-b),y>v?void 0:t().slice(y,v+1)},e.invert=function(f){const d=e.invertRange([f,f]);return d&&d[0]},e.copy=function(){return Zx().domain(t()).range(i).round(a).paddingInner(s).paddingOuter(u).align(l)},c()}function FM(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return FM(t())},e}function VK(){return FM(Zx().paddingInner(1))}var XK=Array.prototype.map;function KK(e){return XK.call(e,Kt)}const JK=Array.prototype.slice;function kM(){let e=[],t=[];function n(i){return i==null||i!==i?void 0:t[(df(e,i)-1)%t.length]}return n.domain=function(i){return arguments.length?(e=KK(i),n):e.slice()},n.range=function(i){return arguments.length?(t=JK.call(i),n):t.slice()},n.tickFormat=function(i,r){return jD(e[0],Ee(e),i==null?10:i,r)},n.copy=function(){return kM().domain(n.domain()).range(n.range())},n}const vg={};function ZK(e,t,n){const i=function(){const o=t();return o.invertRange||(o.invertRange=o.invert?GK(o):o.invertExtent?YK(o):void 0),o.type=e,o};return i.metadata=Hi(oe(n)),i}function Ne(e,t,n){return arguments.length>1?(vg[e]=ZK(e,t,n),this):DM(e)?vg[e]:void 0}Ne(WK,PD);Ne(il,LD,wt);Ne(vo,qD,[wt,vo]);Ne(_f,Dx,wt);Ne(Af,_X,wt);Ne(pg,GD,wt);Ne(Os,zK,[wt,Jx]);Ne(Cs,UK,[wt,Jx]);Ne(Sr,Hx,[wt,Ai]);Ne("".concat(Sr,"-").concat(il),Hx,[wt,Ai]);Ne("".concat(Sr,"-").concat(vo),_M,[wt,Ai,vo]);Ne("".concat(Sr,"-").concat(_f),Wx,[wt,Ai]);Ne("".concat(Sr,"-").concat(Af),qK,[wt,Ai]);Ne("".concat(Sr,"-").concat(pg),AM,[wt,Ai]);Ne("".concat(rl,"-").concat(il),$M,[wt,Ai]);Ne("".concat(rl,"-").concat(vo),SM,[wt,Ai,vo]);Ne("".concat(rl,"-").concat(_f),Gx,[wt,Ai]);Ne("".concat(rl,"-").concat(Af),HK,[wt,Ai]);Ne("".concat(rl,"-").concat(pg),OM,[wt,Ai]);Ne(ol,VD,[Sf,ol]);Ne(mg,XD,Sf);Ne(yg,KD,Sf);Ne(Kx,kM,[$f,Sf]);Ne(Vx,rx,$f);Ne(CM,Zx,$f);Ne(Xx,VK,$f);function DM(e){return ae(vg,e)}function Fs(e,t){const n=vg[e];return n&&n.metadata[t]}function Qx(e){return Fs(e,wt)}function al(e){return Fs(e,$f)}function e2(e){return Fs(e,Sf)}function MM(e){return Fs(e,vo)}function QK(e){return Fs(e,Jx)}function TM(e){return Fs(e,Ai)}function NM(e){return Fs(e,ol)}const eJ=["clamp","base","constant","exponent"];function RM(e,t){const n=t[0],i=Ee(t)-n;return function(r){return e(n+r*i)}}function bg(e,t,n){return _x(t2(t||"rgb",n),e)}function jM(e,t){const n=new Array(t),i=t+1;for(let r=0;r<t;)n[r]=e(++r/i);return n}function LM(e,t,n){const i=n-t;let r,o,a;return!i||!Number.isFinite(i)?Jt(.5):(r=(o=e.type).indexOf("-"),o=r<0?o:o.slice(r+1),a=Ne(o)().domain([t,n]).range([0,1]),eJ.forEach(s=>e[s]?a[s](e[s]()):0),a)}function t2(e,t){const n=eX[tJ(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function tJ(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const nJ={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},iJ={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function PM(e){const t=e.length/6|0,n=new Array(t);for(let i=0;i<t;)n[i]="#"+e.slice(i*6,++i*6);return n}function IM(e,t){for(const n in e)n2(n,t(e[n]))}const BM={};IM(iJ,PM);IM(nJ,e=>bg(PM(e)));function n2(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(BM[e]=t,this):BM[e]}const xg="symbol",rJ="discrete",oJ="gradient",aJ=e=>Q(e)?e.map(t=>String(t)):String(e),sJ=(e,t)=>e[1]-t[1],uJ=(e,t)=>t[1]-e[1];function i2(e,t,n){let i;return Qo(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),n!=null&&(t=Math.min(t,Math.floor(Nc(e.domain())/n||1)))),se(t)&&(i=t.step,t=t.interval),Fe(t)&&(t=e.type===Os?zu(t):e.type==Cs?Uu(t):I("Only time and utc scales accept interval strings."),i&&(t=t.every(i))),t}function zM(e,t,n){let i=e.range(),r=i[0],o=Ee(i),a=sJ;if(r>o&&(i=o,o=r,r=i,a=uJ),r=Math.floor(r),o=Math.ceil(o),t=t.map(s=>[s,e(s)]).filter(s=>r<=s[1]&&s[1]<=o).sort(a).map(s=>s[0]),n>0&&t.length>1){const s=[t[0],Ee(t)];for(;t.length>n&&t.length>=3;)t=t.filter((u,l)=>!(l%2));t.length<3&&(t=s)}return t}function r2(e,t){return e.bins?zM(e,e.bins):e.ticks?e.ticks(t):e.domain()}function UM(e,t,n,i,r,o){const a=t.type;let s=aJ;if(a===Os||r===Os)s=e.timeFormat(i);else if(a===Cs||r===Cs)s=e.utcFormat(i);else if(MM(a)){const u=e.formatFloat(i);if(o||t.bins)s=u;else{const l=qM(t,n,!1);s=c=>l(c)?u(c):""}}else if(t.tickFormat){const u=t.domain();s=e.formatSpan(u[0],u[u.length-1],n,i)}else i&&(s=e.format(i));return s}function qM(e,t,n){const i=r2(e,t),r=e.base(),o=Math.log(r),a=Math.max(1,r*t/i.length),s=u=>{let l=u/Math.pow(r,Math.round(Math.log(u)/o));return l*r<r-.5&&(l*=r),l<=a};return n?i.filter(s):s}const o2={[ol]:"quantiles",[mg]:"thresholds",[yg]:"domain"},HM={[ol]:"quantiles",[mg]:"domain"};function WM(e,t){return e.bins?fJ(e.bins):e.type===vo?qM(e,t,!0):o2[e.type]?cJ(e[o2[e.type]]()):r2(e,t)}function lJ(e,t,n){const i=t[HM[t.type]](),r=i.length;let o=r>1?i[1]-i[0]:i[0],a;for(a=1;a<r;++a)o=Math.min(o,i[a]-i[a-1]);return e.formatSpan(0,o,3*10,n)}function cJ(e){const t=[-1/0].concat(e);return t.max=1/0,t}function fJ(e){const t=e.slice(0,-1);return t.max=Ee(e),t}const dJ=e=>o2[e.type]||e.bins;function GM(e,t,n,i,r,o,a){const s=HM[t.type]&&o!==Os&&o!==Cs?lJ(e,t,r):UM(e,t,n,r,o,a);return i===xg&&dJ(t)?hJ(s):i===rJ?gJ(s):pJ(s)}const hJ=e=>(t,n,i)=>{const r=YM(i[n+1],YM(i.max,1/0)),o=VM(t,e),a=VM(r,e);return o&&a?o+" \u2013 "+a:a?"< "+a:"\u2265 "+o},YM=(e,t)=>e!=null?e:t,gJ=e=>(t,n)=>n?e(t):null,pJ=e=>t=>e(t),VM=(e,t)=>Number.isFinite(e)?t(e):null;function mJ(e){const t=e.domain(),n=t.length-1;let i=+t[0],r=+Ee(t),o=r-i;if(e.type===yg){const a=n?o/n:.1;i-=a,r+=a,o=r-i}return a=>(a-i)/o}function yJ(e,t,n,i){const r=i||t.type;return Fe(n)&&QK(r)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&r===Os?e.timeFormat("%A, %d %B %Y, %X"):!n&&r===Cs?e.utcFormat("%A, %d %B %Y, %X UTC"):GM(e,t,5,null,n,i,!0)}function XM(e,t,n){n=n||{};const i=Math.max(3,n.maxlen||7),r=yJ(e,t,n.format,n.formatType);if(e2(t.type)){const o=WM(t).slice(1).map(r),a=o.length;return"".concat(a," boundar").concat(a===1?"y":"ies",": ").concat(o.join(", "))}else if(al(t.type)){const o=t.domain(),a=o.length,s=a>i?o.slice(0,i-2).map(r).join(", ")+", ending with "+o.slice(-1).map(r):o.map(r).join(", ");return"".concat(a," value").concat(a===1?"":"s",": ").concat(s)}else{const o=t.domain();return"values from ".concat(r(o[0])," to ").concat(r(Ee(o)))}}let KM=0;function vJ(){KM=0}const wg="p_";function a2(e){return e&&e.gradient}function JM(e,t,n){const i=e.gradient;let r=e.id,o=i==="radial"?wg:"";return r||(r=e.id="gradient_"+KM++,i==="radial"?(e.x1=Or(e.x1,.5),e.y1=Or(e.y1,.5),e.r1=Or(e.r1,0),e.x2=Or(e.x2,.5),e.y2=Or(e.y2,.5),e.r2=Or(e.r2,.5),o=wg):(e.x1=Or(e.x1,0),e.y1=Or(e.y1,0),e.x2=Or(e.x2,1),e.y2=Or(e.y2,0))),t[r]=e,"url("+(n||"")+"#"+o+r+")"}function Or(e,t){return e!=null?e:t}function ZM(e,t){var n=[],i;return i={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(r,o){return n.push({offset:r,color:o}),i}}}const QM={basis:{curve:KY},"basis-closed":{curve:JY},"basis-open":{curve:ZY},bundle:{curve:QY,tension:"beta",value:.85},cardinal:{curve:eV,tension:"tension",value:0},"cardinal-open":{curve:nV,tension:"tension",value:0},"cardinal-closed":{curve:tV,tension:"tension",value:0},"catmull-rom":{curve:iV,tension:"alpha",value:.5},"catmull-rom-closed":{curve:rV,tension:"alpha",value:.5},"catmull-rom-open":{curve:oV,tension:"alpha",value:.5},linear:{curve:qb},"linear-closed":{curve:aV},monotone:{horizontal:uV,vertical:sV},natural:{curve:lV},step:{curve:cV},"step-after":{curve:dV},"step-before":{curve:fV}};function s2(e,t,n){var i=ae(QM,e)&&QM[e],r=null;return i&&(r=i.curve||i[t||"vertical"],i.tension&&n!=null&&(r=r[i.tension](n))),r}const bJ={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},Of=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function sl(e){const t=[];let n,i,r,o,a,s,u,l,c,f;const d=e.slice().replace(Of[0],"###$1").split(Of[1]).slice(1);for(u=0,c=d.length;u<c;++u){for(n=d[u],i=n.slice(1).trim().replace(Of[2],"$1###$2").replace(Of[3],"$1###$2").split(Of[4]),a=n.charAt(0),r=[a],l=0,f=i.length;l<f;++l)(o=+i[l])===o&&r.push(o);if(s=bJ[a.toLowerCase()],r.length-1>s){const h=r.length;for(l=1,t.push([a].concat(r.slice(l,l+=s))),a=a==="M"?"L":a==="m"?"l":a;l<h;l+=s)t.push([a].concat(r.slice(l,l+s)))}else t.push(r)}return t}const ca=Math.PI/180,xJ=1e-14,ks=Math.PI/2,Cr=Math.PI*2,ul=Math.sqrt(3)/2;var u2={},l2={},e5=[].join;function wJ(e,t,n,i,r,o,a,s,u){const l=e5.call(arguments);if(u2[l])return u2[l];const c=a*ca,f=Math.sin(c),d=Math.cos(c);n=Math.abs(n),i=Math.abs(i);const h=d*(s-e)*.5+f*(u-t)*.5,g=d*(u-t)*.5-f*(s-e)*.5;let p=h*h/(n*n)+g*g/(i*i);p>1&&(p=Math.sqrt(p),n*=p,i*=p);const m=d/n,y=f/n,v=-f/i,b=d/i,x=m*s+y*u,w=v*s+b*u,_=m*e+y*t,E=v*e+b*t,$=(_-x)*(_-x)+(E-w)*(E-w);let O=1/$-.25;O<0&&(O=0);let C=Math.sqrt(O);o==r&&(C=-C);const A=.5*(x+_)-C*(E-w),D=.5*(w+E)+C*(_-x),F=Math.atan2(w-D,x-A);let S=Math.atan2(E-D,_-A)-F;S<0&&o===1?S+=Cr:S>0&&o===0&&(S-=Cr);const M=Math.ceil(Math.abs(S/(ks+.001))),P=[];for(let B=0;B<M;++B){const H=F+B*S/M,re=F+(B+1)*S/M;P[B]=[A,D,H,re,n,i,f,d]}return u2[l]=P}function EJ(e){const t=e5.call(e);if(l2[t])return l2[t];var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7];const c=l*a,f=-u*s,d=u*a,h=l*s,g=Math.cos(r),p=Math.sin(r),m=Math.cos(o),y=Math.sin(o),v=.5*(o-r),b=Math.sin(v*.5),x=8/3*b*b/Math.sin(v),w=n+g-x*p,_=i+p+x*g,E=n+m,$=i+y,O=E+x*y,C=$-x*m;return l2[t]=[c*w+f*_,d*w+h*_,c*O+f*C,d*O+h*C,c*E+f*$,d*E+h*$]}const $i=["l",0,0,0,0,0,0,0];function _J(e,t,n){const i=$i[0]=e[0];if(i==="a"||i==="A")$i[1]=t*e[1],$i[2]=n*e[2],$i[3]=e[3],$i[4]=e[4],$i[5]=e[5],$i[6]=t*e[6],$i[7]=n*e[7];else if(i==="h"||i==="H")$i[1]=t*e[1];else if(i==="v"||i==="V")$i[1]=n*e[1];else for(var r=1,o=e.length;r<o;++r)$i[r]=(r%2==1?t:n)*e[r];return $i}function Cf(e,t,n,i,r,o){var a,s=null,u=0,l=0,c=0,f=0,d,h,g,p;n==null&&(n=0),i==null&&(i=0),r==null&&(r=1),o==null&&(o=r),e.beginPath&&e.beginPath();for(var m=0,y=t.length;m<y;++m){switch(a=t[m],(r!==1||o!==1)&&(a=_J(a,r,o)),a[0]){case"l":u+=a[1],l+=a[2],e.lineTo(u+n,l+i);break;case"L":u=a[1],l=a[2],e.lineTo(u+n,l+i);break;case"h":u+=a[1],e.lineTo(u+n,l+i);break;case"H":u=a[1],e.lineTo(u+n,l+i);break;case"v":l+=a[1],e.lineTo(u+n,l+i);break;case"V":l=a[1],e.lineTo(u+n,l+i);break;case"m":u+=a[1],l+=a[2],e.moveTo(u+n,l+i);break;case"M":u=a[1],l=a[2],e.moveTo(u+n,l+i);break;case"c":d=u+a[5],h=l+a[6],c=u+a[3],f=l+a[4],e.bezierCurveTo(u+a[1]+n,l+a[2]+i,c+n,f+i,d+n,h+i),u=d,l=h;break;case"C":u=a[5],l=a[6],c=a[3],f=a[4],e.bezierCurveTo(a[1]+n,a[2]+i,c+n,f+i,u+n,l+i);break;case"s":d=u+a[3],h=l+a[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+i,u+a[1]+n,l+a[2]+i,d+n,h+i),c=u+a[1],f=l+a[2],u=d,l=h;break;case"S":d=a[3],h=a[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+i,a[1]+n,a[2]+i,d+n,h+i),u=d,l=h,c=a[1],f=a[2];break;case"q":d=u+a[3],h=l+a[4],c=u+a[1],f=l+a[2],e.quadraticCurveTo(c+n,f+i,d+n,h+i),u=d,l=h;break;case"Q":d=a[3],h=a[4],e.quadraticCurveTo(a[1]+n,a[2]+i,d+n,h+i),u=d,l=h,c=a[1],f=a[2];break;case"t":d=u+a[1],h=l+a[2],s[0].match(/[QqTt]/)===null?(c=u,f=l):s[0]==="t"?(c=2*u-g,f=2*l-p):s[0]==="q"&&(c=2*u-c,f=2*l-f),g=c,p=f,e.quadraticCurveTo(c+n,f+i,d+n,h+i),u=d,l=h,c=u+a[1],f=l+a[2];break;case"T":d=a[1],h=a[2],c=2*u-c,f=2*l-f,e.quadraticCurveTo(c+n,f+i,d+n,h+i),u=d,l=h;break;case"a":t5(e,u+n,l+i,[a[1],a[2],a[3],a[4],a[5],a[6]+u+n,a[7]+l+i]),u+=a[6],l+=a[7];break;case"A":t5(e,u+n,l+i,[a[1],a[2],a[3],a[4],a[5],a[6]+n,a[7]+i]),u=a[6],l=a[7];break;case"z":case"Z":e.closePath();break}s=a}}function t5(e,t,n,i){const r=wJ(i[5],i[6],i[0],i[1],i[3],i[4],i[2],t,n);for(let o=0;o<r.length;++o){const a=EJ(r[o]);e.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5])}}const n5=.5773502691896257,i5={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,Cr)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/2.5;e.moveTo(-n,-i),e.lineTo(-n,i),e.lineTo(-i,i),e.lineTo(-i,n),e.lineTo(i,n),e.lineTo(i,i),e.lineTo(n,i),e.lineTo(n,-i),e.lineTo(i,-i),e.lineTo(i,-n),e.lineTo(-i,-n),e.lineTo(-i,-i),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),i=-n/2;e.rect(i,i,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/7,r=n/2.5,o=n/8;e.moveTo(-i,n),e.lineTo(i,n),e.lineTo(i,-o),e.lineTo(r,-o),e.lineTo(0,-n),e.lineTo(-r,-o),e.lineTo(-i,-o),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,i=ul*n,r=i-n*n5,o=n/4;e.moveTo(0,-i-r),e.lineTo(-o,i-r),e.lineTo(o,i-r),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,i=ul*n,r=i-n*n5;e.moveTo(0,-i-r),e.lineTo(-n,i-r),e.lineTo(n,i-r),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,i=ul*n;e.moveTo(0,-i),e.lineTo(-n,i),e.lineTo(n,i),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,i=ul*n;e.moveTo(0,i),e.lineTo(-n,-i),e.lineTo(n,-i),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,i=ul*n;e.moveTo(i,0),e.lineTo(-i,-n),e.lineTo(-i,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,i=ul*n;e.moveTo(-i,0),e.lineTo(i,-n),e.lineTo(i,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function r5(e){return ae(i5,e)?i5[e]:AJ(e)}var c2={};function AJ(e){if(!ae(c2,e)){const t=sl(e);c2[e]={draw:function(n,i){Cf(n,t,0,0,Math.sqrt(i)/2)}}}return c2[e]}const fa=.448084975506;function $J(e){return e.x}function SJ(e){return e.y}function OJ(e){return e.width}function CJ(e){return e.height}function bo(e){return typeof e=="function"?e:()=>+e}function Eg(e,t,n){return Math.max(t,Math.min(e,n))}function o5(){var e=$J,t=SJ,n=OJ,i=CJ,r=bo(0),o=r,a=r,s=r,u=null;function l(c,f,d){var h,g=f!=null?f:+e.call(this,c),p=d!=null?d:+t.call(this,c),m=+n.call(this,c),y=+i.call(this,c),v=Math.min(m,y)/2,b=Eg(+r.call(this,c),0,v),x=Eg(+o.call(this,c),0,v),w=Eg(+a.call(this,c),0,v),_=Eg(+s.call(this,c),0,v);if(u||(u=h=ms()),b<=0&&x<=0&&w<=0&&_<=0)u.rect(g,p,m,y);else{var E=g+m,$=p+y;u.moveTo(g+b,p),u.lineTo(E-x,p),u.bezierCurveTo(E-fa*x,p,E,p+fa*x,E,p+x),u.lineTo(E,$-_),u.bezierCurveTo(E,$-fa*_,E-fa*_,$,E-_,$),u.lineTo(g+w,$),u.bezierCurveTo(g+fa*w,$,g,$-fa*w,g,$-w),u.lineTo(g,p+b),u.bezierCurveTo(g,p+fa*b,g+fa*b,p,g+b,p),u.closePath()}if(h)return u=null,h+""||null}return l.x=function(c){return arguments.length?(e=bo(c),l):e},l.y=function(c){return arguments.length?(t=bo(c),l):t},l.width=function(c){return arguments.length?(n=bo(c),l):n},l.height=function(c){return arguments.length?(i=bo(c),l):i},l.cornerRadius=function(c,f,d,h){return arguments.length?(r=bo(c),o=f!=null?bo(f):r,s=d!=null?bo(d):r,a=h!=null?bo(h):o,l):r},l.context=function(c){return arguments.length?(u=c==null?null:c,l):u},l}function a5(){var e,t,n,i,r=null,o,a,s,u;function l(f,d,h){const g=h/2;if(o){var p=s-d,m=f-a;if(p||m){var y=Math.sqrt(p*p+m*m),v=(p/=y)*u,b=(m/=y)*u,x=Math.atan2(m,p);r.moveTo(a-v,s-b),r.lineTo(f-p*g,d-m*g),r.arc(f,d,g,x-Math.PI,x),r.lineTo(a+v,s+b),r.arc(a,s,u,x,x+Math.PI)}else r.arc(f,d,g,0,Cr);r.closePath()}else o=1;a=f,s=d,u=g}function c(f){var d,h=f.length,g,p=!1,m;for(r==null&&(r=m=ms()),d=0;d<=h;++d)!(d<h&&i(g=f[d],d,f))===p&&(p=!p)&&(o=0),p&&l(+e(g,d,f),+t(g,d,f),+n(g,d,f));if(m)return r=null,m+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(i=f,c):i},c.context=function(f){return arguments.length?(f==null?r=null:r=f,c):r},c}function Ff(e,t){return e!=null?e:t}const kf=e=>e.x||0,Df=e=>e.y||0,FJ=e=>e.width||0,kJ=e=>e.height||0,DJ=e=>(e.x||0)+(e.width||0),MJ=e=>(e.y||0)+(e.height||0),TJ=e=>e.startAngle||0,NJ=e=>e.endAngle||0,RJ=e=>e.padAngle||0,jJ=e=>e.innerRadius||0,LJ=e=>e.outerRadius||0,PJ=e=>e.cornerRadius||0,IJ=e=>Ff(e.cornerRadiusTopLeft,e.cornerRadius)||0,BJ=e=>Ff(e.cornerRadiusTopRight,e.cornerRadius)||0,zJ=e=>Ff(e.cornerRadiusBottomRight,e.cornerRadius)||0,UJ=e=>Ff(e.cornerRadiusBottomLeft,e.cornerRadius)||0,qJ=e=>Ff(e.size,64),HJ=e=>e.size||1,_g=e=>e.defined!==!1,WJ=e=>r5(e.shape||"circle"),GJ=YY().startAngle(TJ).endAngle(NJ).padAngle(RJ).innerRadius(jJ).outerRadius(LJ).cornerRadius(PJ),YJ=Sk().x(kf).y1(Df).y0(MJ).defined(_g),VJ=Sk().y(Df).x1(kf).x0(DJ).defined(_g),XJ=$k().x(kf).y(Df).defined(_g),KJ=o5().x(kf).y(Df).width(FJ).height(kJ).cornerRadius(IJ,BJ,zJ,UJ),JJ=XY().type(WJ).size(qJ),ZJ=a5().x(kf).y(Df).defined(_g).size(HJ);function f2(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function QJ(e,t){return GJ.context(e)(t)}function eZ(e,t){const n=t[0],i=n.interpolate||"linear";return(n.orient==="horizontal"?VJ:YJ).curve(s2(i,n.orient,n.tension)).context(e)(t)}function tZ(e,t){const n=t[0],i=n.interpolate||"linear";return XJ.curve(s2(i,n.orient,n.tension)).context(e)(t)}function ll(e,t,n,i){return KJ.context(e)(t,n,i)}function nZ(e,t){return(t.mark.shape||t.shape).context(e)(t)}function iZ(e,t){return JJ.context(e)(t)}function rZ(e,t){return ZJ.context(e)(t)}var s5=1;function u5(){s5=1}function d2(e,t,n){var i=t.clip,r=e._defs,o=t.clip_id||(t.clip_id="clip"+s5++),a=r.clipping[o]||(r.clipping[o]={id:o});return me(i)?a.path=i(null):f2(n)?a.path=ll(null,n,0,0):(a.width=n.width||0,a.height=n.height||0),"url(#"+o+")"}function Et(e){this.clear(),e&&this.union(e)}Et.prototype={clone(){return new Et(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,i){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),i<t?(this.y2=t,this.y1=i):(this.y1=t,this.y2=i),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const i=this.rotatedPoints(e,t,n);return this.clear().add(i[0],i[1]).add(i[2],i[3]).add(i[4],i[5]).add(i[6],i[7])},rotatedPoints(e,t,n){var{x1:i,y1:r,x2:o,y2:a}=this,s=Math.cos(e),u=Math.sin(e),l=t-t*s+n*u,c=n-t*u-n*s;return[s*i-u*r+l,u*i+s*r+c,s*i-u*a+l,u*i+s*a+c,s*o-u*r+l,u*o+s*r+c,s*o-u*a+l,u*o+s*a+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function Ag(e){this.mark=e,this.bounds=this.bounds||new Et}function $g(e){Ag.call(this,e),this.items=this.items||[]}q($g,Ag);function h2(e){this._pending=0,this._loader=e||C0()}function l5(e){e._pending+=1}function Mf(e){e._pending-=1}h2.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return l5(t),t._loader.sanitize(e,{context:"href"}).then(n=>(Mf(t),n)).catch(()=>(Mf(t),null))},loadImage(e){const t=this,n=hV();return l5(t),t._loader.sanitize(e,{context:"image"}).then(i=>{const r=i.href;if(!r||!n)throw{url:r};const o=new n,a=ae(i,"crossOrigin")?i.crossOrigin:"anonymous";return a!=null&&(o.crossOrigin=a),o.onload=()=>Mf(t),o.onerror=()=>Mf(t),o.src=r,o}).catch(i=>(Mf(t),{complete:!1,width:0,height:0,src:i&&i.url||""}))},ready(){const e=this;return new Promise(t=>{function n(i){e.pending()?setTimeout(()=>{n(!0)},10):t(i)}n(!1)})}};function xo(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const i=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(i+(n?oZ(t,i):0))}return e}function oZ(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const aZ=Cr-1e-8;let Sg,Og,Cg,Ds,g2,Fg,p2,m2;const da=(e,t)=>Sg.add(e,t),kg=(e,t)=>da(Og=e,Cg=t),c5=e=>da(e,Sg.y1),f5=e=>da(Sg.x1,e),Ms=(e,t)=>g2*e+p2*t,Ts=(e,t)=>Fg*e+m2*t,y2=(e,t)=>da(Ms(e,t),Ts(e,t)),v2=(e,t)=>kg(Ms(e,t),Ts(e,t));function Tf(e,t){return Sg=e,t?(Ds=t*ca,g2=m2=Math.cos(Ds),Fg=Math.sin(Ds),p2=-Fg):(g2=m2=1,Ds=Fg=p2=0),sZ}const sZ={beginPath(){},closePath(){},moveTo:v2,lineTo:v2,rect(e,t,n,i){Ds?(y2(e+n,t),y2(e+n,t+i),y2(e,t+i),v2(e,t)):(da(e+n,t+i),kg(e,t))},quadraticCurveTo(e,t,n,i){const r=Ms(e,t),o=Ts(e,t),a=Ms(n,i),s=Ts(n,i);d5(Og,r,a,c5),d5(Cg,o,s,f5),kg(a,s)},bezierCurveTo(e,t,n,i,r,o){const a=Ms(e,t),s=Ts(e,t),u=Ms(n,i),l=Ts(n,i),c=Ms(r,o),f=Ts(r,o);h5(Og,a,u,c,c5),h5(Cg,s,l,f,f5),kg(c,f)},arc(e,t,n,i,r,o){if(i+=Ds,r+=Ds,Og=n*Math.cos(r)+e,Cg=n*Math.sin(r)+t,Math.abs(r-i)>aZ)da(e-n,t-n),da(e+n,t+n);else{const a=l=>da(n*Math.cos(l)+e,n*Math.sin(l)+t);let s,u;if(a(i),a(r),r!==i)if(i=i%Cr,i<0&&(i+=Cr),r=r%Cr,r<0&&(r+=Cr),r<i&&(o=!o,s=i,i=r,r=s),o)for(r-=Cr,s=i-i%ks,u=0;u<4&&s>r;++u,s-=ks)a(s);else for(s=i-i%ks+ks,u=0;u<4&&s<r;++u,s=s+ks)a(s)}}};function d5(e,t,n,i){const r=(e-t)/(e+n-2*t);0<r&&r<1&&i(e+(t-e)*r)}function h5(e,t,n,i,r){const o=i-e+3*t-3*n,a=e+n-2*t,s=e-t;let u=0,l=0,c;Math.abs(o)>xJ?(c=a*a+s*o,c>=0&&(c=Math.sqrt(c),u=(-a+c)/o,l=(-a-c)/o)):u=.5*s/a,0<u&&u<1&&r(g5(u,e,t,n,i)),0<l&&l<1&&r(g5(l,e,t,n,i))}function g5(e,t,n,i,r){const o=1-e,a=o*o,s=e*e;return a*o*t+3*a*e*n+3*o*s*i+s*e*r}var ha=(ha=Ku(1,1))?ha.getContext("2d"):null;const b2=new Et;function x2(e){return function(t,n){if(!ha)return!0;e(ha,t),b2.clear().union(t.bounds).intersect(n).round();const{x1:i,y1:r,x2:o,y2:a}=b2;for(let s=r;s<=a;++s)for(let u=i;u<=o;++u)if(ha.isPointInPath(u,s))return!0;return!1}}function w2(e,t){return t.contains(e.x||0,e.y||0)}function p5(e,t){const n=e.x||0,i=e.y||0,r=e.width||0,o=e.height||0;return t.intersects(b2.set(n,i,n+r,i+o))}function m5(e,t){const n=e.x||0,i=e.y||0,r=e.x2!=null?e.x2:n,o=e.y2!=null?e.y2:i;return cl(t,n,i,r,o)}function cl(e,t,n,i,r){const{x1:o,y1:a,x2:s,y2:u}=e,l=i-t,c=r-n;let f=0,d=1,h,g,p,m;for(m=0;m<4;++m){if(m===0&&(h=-l,g=-(o-t)),m===1&&(h=l,g=s-t),m===2&&(h=-c,g=-(a-n)),m===3&&(h=c,g=u-n),Math.abs(h)<1e-10&&g<0)return!1;if(p=g/h,h<0){if(p>d)return!1;p>f&&(f=p)}else if(h>0){if(p<f)return!1;p<d&&(d=p)}}return!0}function fl(e,t){e.globalCompositeOperation=t.blend||"source-over"}function Yi(e,t){return e==null?t:e}function y5(e,t){const n=t.length;for(let i=0;i<n;++i)e.addColorStop(t[i].offset,t[i].color);return e}function uZ(e,t,n){const i=n.width(),r=n.height();let o;if(t.gradient==="radial")o=e.createRadialGradient(n.x1+Yi(t.x1,.5)*i,n.y1+Yi(t.y1,.5)*r,Math.max(i,r)*Yi(t.r1,0),n.x1+Yi(t.x2,.5)*i,n.y1+Yi(t.y2,.5)*r,Math.max(i,r)*Yi(t.r2,.5));else{const a=Yi(t.x1,0),s=Yi(t.y1,0),u=Yi(t.x2,1),l=Yi(t.y2,0);if(a===u||s===l||i===r)o=e.createLinearGradient(n.x1+a*i,n.y1+s*r,n.x1+u*i,n.y1+l*r);else{const c=Ku(Math.ceil(i),Math.ceil(r)),f=c.getContext("2d");return f.scale(i,r),f.fillStyle=y5(f.createLinearGradient(a,s,u,l),t.stops),f.fillRect(0,0,i,r),e.createPattern(c,"no-repeat")}}return y5(o,t.stops)}function v5(e,t,n){return a2(n)?uZ(e,n,t.bounds):n}function Dg(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=v5(e,t,t.fill),!0):!1}var lZ=[];function dl(e,t,n){var i=(i=t.strokeWidth)!=null?i:1;return i<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=v5(e,t,t.stroke),e.lineWidth=i,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||lZ),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function cZ(e,t){return e.zindex-t.zindex||e.index-t.index}function E2(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],i,r,o;for(r=0,o=t.length;r<o;++r)i=t[r],i.index=r,i.zindex&&n.push(i);return e.zdirty=!1,e.zitems=n.sort(cZ)}function Vi(e,t){var n=e.items,i,r;if(!n||!n.length)return;const o=E2(e);if(o&&o.length){for(i=0,r=n.length;i<r;++i)n[i].zindex||t(n[i]);n=o}for(i=0,r=n.length;i<r;++i)t(n[i])}function Mg(e,t){var n=e.items,i,r;if(!n||!n.length)return null;const o=E2(e);for(o&&o.length&&(n=o),r=n.length;--r>=0;)if(i=t(n[r]))return i;if(n===o){for(n=e.items,r=n.length;--r>=0;)if(!n[r].zindex&&(i=t(n[r])))return i}return null}function _2(e){return function(t,n,i){Vi(n,r=>{(!i||i.intersects(r.bounds))&&b5(e,t,r,r)})}}function fZ(e){return function(t,n,i){n.items.length&&(!i||i.intersects(n.bounds))&&b5(e,t,n.items[0],n.items)}}function b5(e,t,n,i){var r=n.opacity==null?1:n.opacity;r!==0&&(e(t,i)||(fl(t,n),n.fill&&Dg(t,n,r)&&t.fill(),n.stroke&&dl(t,n,r)&&t.stroke()))}function Tg(e){return e=e||xi,function(t,n,i,r,o,a){return i*=t.pixelRatio,r*=t.pixelRatio,Mg(n,s=>{const u=s.bounds;if(!(u&&!u.contains(o,a)||!u)&&e(t,s,i,r,o,a))return s})}}function Nf(e,t){return function(n,i,r,o){var a=Array.isArray(i)?i[0]:i,s=t==null?a.fill:t,u=a.stroke&&n.isPointInStroke,l,c;return u&&(l=a.strokeWidth,c=a.strokeCap,n.lineWidth=l!=null?l:1,n.lineCap=c!=null?c:"butt"),e(n,i)?!1:s&&n.isPointInPath(r,o)||u&&n.isPointInStroke(r,o)}}function A2(e){return Tg(Nf(e))}function Ns(e,t){return"translate("+e+","+t+")"}function $2(e){return"rotate("+e+")"}function dZ(e,t){return"scale("+e+","+t+")"}function x5(e){return Ns(e.x||0,e.y||0)}function hZ(e){return Ns(e.x||0,e.y||0)+(e.angle?" "+$2(e.angle):"")}function gZ(e){return Ns(e.x||0,e.y||0)+(e.angle?" "+$2(e.angle):"")+(e.scaleX||e.scaleY?" "+dZ(e.scaleX||1,e.scaleY||1):"")}function S2(e,t,n){function i(a,s){a("transform",hZ(s)),a("d",t(null,s))}function r(a,s){return t(Tf(a,s.angle),s),xo(a,s).translate(s.x||0,s.y||0)}function o(a,s){var u=s.x||0,l=s.y||0,c=s.angle||0;a.translate(u,l),c&&a.rotate(c*=ca),a.beginPath(),t(a,s),c&&a.rotate(-c),a.translate(-u,-l)}return{type:e,tag:"path",nested:!1,attr:i,bound:r,draw:_2(o),pick:A2(o),isect:n||x2(o)}}var pZ=S2("arc",QJ);function mZ(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],i=e[0].orient==="horizontal"?"y":"x",r=e.length,o=1/0,a,s;--r>=0;)e[r].defined!==!1&&(s=Math.abs(e[r][i]-n),s<o&&(o=s,a=e[r]));return a}function yZ(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),i=e.length,r,o,a;--i>=0;)if(e[i].defined!==!1&&(r=e[i].x-t[0],o=e[i].y-t[1],a=r*r+o*o,a<n))return e[i];return null}function vZ(e,t){for(var n=e.length,i,r,o;--n>=0;)if(e[n].defined!==!1&&(i=e[n].x-t[0],r=e[n].y-t[1],o=i*i+r*r,i=e[n].size||1,o<i*i))return e[n];return null}function O2(e,t,n){function i(u,l){var c=l.mark.items;c.length&&u("d",t(null,c))}function r(u,l){var c=l.items;return c.length===0?u:(t(Tf(u),c),xo(u,c[0]))}function o(u,l){u.beginPath(),t(u,l)}const a=Nf(o);function s(u,l,c,f,d,h){var g=l.items,p=l.bounds;return!g||!g.length||p&&!p.contains(d,h)?null:(c*=u.pixelRatio,f*=u.pixelRatio,a(u,g,c,f)?g[0]:null)}return{type:e,tag:"path",nested:!0,attr:i,bound:r,draw:fZ(o),pick:s,isect:w2,tip:n}}var bZ=O2("area",eZ,mZ);function xZ(e,t){var n=t.clip;e.save(),me(n)?(e.beginPath(),n(e),e.clip()):w5(e,t.group)}function w5(e,t){e.beginPath(),f2(t)?ll(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function E5(e){const t=Yi(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function wZ(e,t){e("transform",x5(t))}function _5(e,t){const n=E5(t);e("d",ll(null,t,n,n))}function EZ(e,t){e("class","background"),e("aria-hidden",!0),_5(e,t)}function _Z(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?_5(e,t):e("d","")}function AZ(e,t,n){const i=t.clip?d2(n,t,t):null;e("clip-path",i)}function $Z(e,t){if(!t.clip&&t.items){const n=t.items,i=n.length;for(let r=0;r<i;++r)e.union(n[r].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),xo(e,t),e.translate(t.x||0,t.y||0)}function Rf(e,t,n,i){const r=E5(t);e.beginPath(),ll(e,t,(n||0)+r,(i||0)+r)}const SZ=Nf(Rf),OZ=Nf(Rf,!1),CZ=Nf(Rf,!0);function FZ(e,t,n){Vi(t,i=>{const r=i.x||0,o=i.y||0,a=i.strokeForeground,s=i.opacity==null?1:i.opacity;(i.stroke||i.fill)&&s&&(Rf(e,i,r,o),fl(e,i),i.fill&&Dg(e,i,s)&&e.fill(),i.stroke&&!a&&dl(e,i,s)&&e.stroke()),e.save(),e.translate(r,o),i.clip&&w5(e,i),n&&n.translate(-r,-o),Vi(i,u=>{this.draw(e,u,n)}),n&&n.translate(r,o),e.restore(),a&&i.stroke&&s&&(Rf(e,i,r,o),fl(e,i),dl(e,i,s)&&e.stroke())})}function kZ(e,t,n,i,r,o){if(t.bounds&&!t.bounds.contains(r,o)||!t.items)return null;const a=n*e.pixelRatio,s=i*e.pixelRatio;return Mg(t,u=>{let l,c,f;const d=u.bounds;if(d&&!d.contains(r,o))return;c=u.x||0,f=u.y||0;const h=c+(u.width||0),g=f+(u.height||0),p=u.clip;if(p&&(r<c||r>h||o<f||o>g))return;if(e.save(),e.translate(c,f),c=r-c,f=o-f,p&&f2(u)&&!CZ(e,u,a,s))return e.restore(),null;const m=u.strokeForeground,y=t.interactive!==!1;return y&&m&&u.stroke&&OZ(e,u,a,s)?(e.restore(),u):(l=Mg(u,v=>DZ(v,c,f)?this.pick(v,n,i,c,f):null),!l&&y&&(u.fill||!m&&u.stroke)&&SZ(e,u,a,s)&&(l=u),e.restore(),l||null)})}function DZ(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var MZ={type:"group",tag:"g",nested:!1,attr:wZ,bound:$Z,draw:FZ,pick:kZ,isect:p5,content:AZ,background:EZ,foreground:_Z},jf={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function C2(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(i=>{e.image=i,e.image.url=e.url})),n}function F2(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function k2(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function Ng(e,t){return e==="center"?t/2:e==="right"?t:0}function Rg(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function TZ(e,t,n){const i=C2(t,n),r=F2(t,i),o=k2(t,i),a=(t.x||0)-Ng(t.align,r),s=(t.y||0)-Rg(t.baseline,o),u=!i.src&&i.toDataURL?i.toDataURL():i.src||"";e("href",u,jf["xmlns:xlink"],"xlink:href"),e("transform",Ns(a,s)),e("width",r),e("height",o),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function NZ(e,t){const n=t.image,i=F2(t,n),r=k2(t,n),o=(t.x||0)-Ng(t.align,i),a=(t.y||0)-Rg(t.baseline,r);return e.set(o,a,o+i,a+r)}function RZ(e,t,n){Vi(t,i=>{if(n&&!n.intersects(i.bounds))return;const r=C2(i,this);let o=F2(i,r),a=k2(i,r);if(o===0||a===0)return;let s=(i.x||0)-Ng(i.align,o),u=(i.y||0)-Rg(i.baseline,a),l,c,f,d;i.aspect!==!1&&(c=r.width/r.height,f=i.width/i.height,c===c&&f===f&&c!==f&&(f<c?(d=o/c,u+=(a-d)/2,a=d):(d=a*c,s+=(o-d)/2,o=d))),(r.complete||r.toDataURL)&&(fl(e,i),e.globalAlpha=(l=i.opacity)!=null?l:1,e.imageSmoothingEnabled=i.smooth!==!1,e.drawImage(r,s,u,o,a))})}var jZ={type:"image",tag:"image",nested:!1,attr:TZ,bound:NZ,draw:RZ,pick:Tg(),isect:xi,get:C2,xOffset:Ng,yOffset:Rg},LZ=O2("line",tZ,yZ);function PZ(e,t){var n=t.scaleX||1,i=t.scaleY||1;(n!==1||i!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",gZ(t)),e("d",t.path)}function jg(e,t){var n=t.path;if(n==null)return!0;var i=t.x||0,r=t.y||0,o=t.scaleX||1,a=t.scaleY||1,s=(t.angle||0)*ca,u=t.pathCache;(!u||u.path!==n)&&((t.pathCache=u=sl(n)).path=n),s&&e.rotate&&e.translate?(e.translate(i,r),e.rotate(s),Cf(e,u,0,0,o,a),e.rotate(-s),e.translate(-i,-r)):Cf(e,u,i,r,o,a)}function IZ(e,t){return jg(Tf(e,t.angle),t)?e.set(0,0,0,0):xo(e,t,!0)}var BZ={type:"path",tag:"path",nested:!1,attr:PZ,bound:IZ,draw:_2(jg),pick:A2(jg),isect:x2(jg)};function zZ(e,t){e("d",ll(null,t))}function UZ(e,t){var n,i;return xo(e.set(n=t.x||0,i=t.y||0,n+t.width||0,i+t.height||0),t)}function A5(e,t){e.beginPath(),ll(e,t)}var qZ={type:"rect",tag:"path",nested:!1,attr:zZ,bound:UZ,draw:_2(A5),pick:A2(A5),isect:p5};function HZ(e,t){e("transform",x5(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function WZ(e,t){var n,i;return xo(e.set(n=t.x||0,i=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:i),t)}function $5(e,t,n){var i,r,o,a;return t.stroke&&dl(e,t,n)?(i=t.x||0,r=t.y||0,o=t.x2!=null?t.x2:i,a=t.y2!=null?t.y2:r,e.beginPath(),e.moveTo(i,r),e.lineTo(o,a),!0):!1}function GZ(e,t,n){Vi(t,i=>{if(!(n&&!n.intersects(i.bounds))){var r=i.opacity==null?1:i.opacity;r&&$5(e,i,r)&&(fl(e,i),e.stroke())}})}function YZ(e,t,n,i){return e.isPointInStroke?$5(e,t,1)&&e.isPointInStroke(n,i):!1}var VZ={type:"rule",tag:"line",nested:!1,attr:HZ,bound:WZ,draw:GZ,pick:Tg(YZ),isect:m5},XZ=S2("shape",nZ),KZ=S2("symbol",iZ,w2);const S5=OC();var Fr={height:kr,measureWidth:M2,estimateWidth:D2,width:D2,canvas:O5};O5(!0);function O5(e){Fr.width=e&&ha?M2:D2}function D2(e,t){return C5(pa(e,t),kr(e))}function C5(e,t){return~~(.8*e.length*t)}function M2(e,t){return kr(e)<=0||!(t=pa(e,t))?0:F5(t,Lg(e))}function F5(e,t){const n=`(${t}) ${e}`;let i=S5.get(n);return i===void 0&&(ha.font=t,i=ha.measureText(e).width,S5.set(n,i)),i}function kr(e){return e.fontSize!=null?+e.fontSize||0:11}function ga(e){return e.lineHeight!=null?e.lineHeight:kr(e)+2}function JZ(e){return Q(e)?e.length>1?e:e[0]:e}function Lf(e){return JZ(e.lineBreak&&e.text&&!Q(e.text)?e.text.split(e.lineBreak):e.text)}function T2(e){const t=Lf(e);return(Q(t)?t.length-1:0)*ga(e)}function pa(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?QZ(e,n):n}function ZZ(e){if(Fr.width===M2){const t=Lg(e);return n=>F5(n,t)}else{const t=kr(e);return n=>C5(n,t)}}function QZ(e,t){var n=+e.limit,i=ZZ(e);if(i(t)<n)return t;var r=e.ellipsis||"\u2026",o=e.dir==="rtl",a=0,s=t.length,u;if(n-=i(r),o){for(;a<s;)u=a+s>>>1,i(t.slice(u))>n?a=u+1:s=u;return r+t.slice(a)}else{for(;a<s;)u=1+(a+s>>>1),i(t.slice(0,u))<n?a=u:s=u-1;return t.slice(0,a)+r}}function Pf(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function Lg(e,t){return""+(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+kr(e)+"px "+Pf(e,t)}function N2(e){var t=e.baseline,n=kr(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*ga(e):t==="line-bottom"?.29*n-.5*ga(e):0)}const eQ={left:"start",center:"middle",right:"end"},If=new Et;function Pg(e){var t=e.x||0,n=e.y||0,i=e.radius||0,r;return i&&(r=(e.theta||0)-ks,t+=i*Math.cos(r),n+=i*Math.sin(r)),If.x1=t,If.y1=n,If}function tQ(e,t){var n=t.dx||0,i=(t.dy||0)+N2(t),r=Pg(t),o=r.x1,a=r.y1,s=t.angle||0,u;e("text-anchor",eQ[t.align]||"start"),s?(u=Ns(o,a)+" "+$2(s),(n||i)&&(u+=" "+Ns(n,i))):u=Ns(o+n,a+i),e("transform",u)}function R2(e,t,n){var i=Fr.height(t),r=t.align,o=Pg(t),a=o.x1,s=o.y1,u=t.dx||0,l=(t.dy||0)+N2(t)-Math.round(.8*i),c=Lf(t),f;if(Q(c)?(i+=ga(t)*(c.length-1),f=c.reduce((d,h)=>Math.max(d,Fr.width(t,h)),0)):f=Fr.width(t,c),r==="center"?u-=f/2:r==="right"&&(u-=f),e.set(u+=a,l+=s,u+f,l+i),t.angle&&!n)e.rotate(t.angle*ca,a,s);else if(n===2)return e.rotatedPoints(t.angle*ca,a,s);return e}function nQ(e,t,n){Vi(t,i=>{var r=i.opacity==null?1:i.opacity,o,a,s,u,l,c,f;if(!(n&&!n.intersects(i.bounds)||r===0||i.fontSize<=0||i.text==null||i.text.length===0)){if(e.font=Lg(i),e.textAlign=i.align||"left",o=Pg(i),a=o.x1,s=o.y1,i.angle&&(e.save(),e.translate(a,s),e.rotate(i.angle*ca),a=s=0),a+=i.dx||0,s+=(i.dy||0)+N2(i),c=Lf(i),fl(e,i),Q(c))for(l=ga(i),u=0;u<c.length;++u)f=pa(i,c[u]),i.fill&&Dg(e,i,r)&&e.fillText(f,a,s),i.stroke&&dl(e,i,r)&&e.strokeText(f,a,s),s+=l;else f=pa(i,c),i.fill&&Dg(e,i,r)&&e.fillText(f,a,s),i.stroke&&dl(e,i,r)&&e.strokeText(f,a,s);i.angle&&e.restore()}})}function iQ(e,t,n,i,r,o){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var a=Pg(t),s=a.x1,u=a.y1,l=R2(If,t,1),c=-t.angle*ca,f=Math.cos(c),d=Math.sin(c),h=f*r-d*o+(s-f*s+d*u),g=d*r+f*o+(u-d*s-f*u);return l.contains(h,g)}function rQ(e,t){const n=R2(If,e,2);return cl(t,n[0],n[1],n[2],n[3])||cl(t,n[0],n[1],n[4],n[5])||cl(t,n[4],n[5],n[6],n[7])||cl(t,n[2],n[3],n[6],n[7])}var oQ={type:"text",tag:"text",nested:!1,attr:tQ,bound:R2,draw:nQ,pick:Tg(iQ),isect:rQ},aQ=O2("trail",rZ,vZ),ai={arc:pZ,area:bZ,group:MZ,image:jZ,line:LZ,path:BZ,rect:qZ,rule:VZ,shape:XZ,symbol:KZ,text:oQ,trail:aQ};function j2(e,t,n){var i=ai[e.mark.marktype],r=t||i.bound;return i.nested&&(e=e.mark),r(e.bounds||(e.bounds=new Et),e,n)}var k5={mark:null};function D5(e,t,n){var i=ai[e.marktype],r=i.bound,o=e.items,a=o&&o.length,s,u,l,c;if(i.nested)return a?l=o[0]:(k5.mark=e,l=k5),c=j2(l,r,n),t=t&&t.union(c)||c,t;if(t=t||e.bounds&&e.bounds.clear()||new Et,a)for(s=0,u=o.length;s<u;++s)t.union(j2(o[s],r,n));return e.bounds=t}const sQ=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function M5(e,t){return JSON.stringify(e,sQ,t)}function T5(e){const t=typeof e=="string"?JSON.parse(e):e;return N5(t)}function N5(e){var t=e.marktype,n=e.items,i,r,o;if(n)for(r=0,o=n.length;r<o;++r)i=t?"mark":"group",n[r][i]=e,n[r].zindex&&(n[r][i].zdirty=!0),(t||i)==="group"&&N5(n[r]);return t&&D5(e),e}function L2(e){arguments.length?this.root=T5(e):(this.root=R5({marktype:"group",name:"root",role:"frame"}),this.root.items=[new $g(this.root)])}L2.prototype={toJSON(e){return M5(this.root,e||0)},mark(e,t,n){t=t||this.root.items[0];const i=R5(e,t);return t.items[n]=i,i.zindex&&(i.group.zdirty=!0),i}};function R5(e,t){const n={bounds:new Et,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function ma(e,t,n){return!e&&typeof document!="undefined"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function P2(e,t){t=t.toLowerCase();for(var n=e.childNodes,i=0,r=n.length;i<r;++i)if(n[i].tagName.toLowerCase()===t)return n[i]}function Un(e,t,n,i){var r=e.childNodes[t],o;return(!r||r.tagName.toLowerCase()!==n.toLowerCase())&&(o=r||null,r=ma(e.ownerDocument,n,i),e.insertBefore(r,o)),r}function Xi(e,t){for(var n=e.childNodes,i=n.length;i>t;)e.removeChild(n[--i]);return e}function j5(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function Ig(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function uQ(e,t,n,i){var r=e&&e.mark,o,a;if(r&&(o=ai[r.marktype]).tip){for(a=Ig(t,n),a[0]-=i[0],a[1]-=i[1];e=e.mark.group;)a[0]-=e.x||0,a[1]-=e.y||0;e=o.tip(r.items,a)}return e}function ya(e,t){this._active=null,this._handlers={},this._loader=e||C0(),this._tooltip=t||lQ}function lQ(e,t,n,i){e.element().setAttribute("title",i||"")}ya.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let i=e?e.length:0;--i>=0;)if(e[i].type===t&&(!n||e[i].handler===n))return i;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const i in t)n.push(...t[i]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then(i=>{const r=new MouseEvent(e.type,e),o=ma(null,"a");for(const a in i)o.setAttribute(a,i[a]);o.dispatchEvent(r)}).catch(()=>{})},handleTooltip(e,t,n){if(t&&t.tooltip!=null){t=uQ(t,e,this.canvas(),this._origin);const i=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,i)}},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),i=this._origin,r=e.bounds,o=r.width(),a=r.height();let s=r.x1+i[0]+n.left,u=r.y1+i[1]+n.top;for(;e.mark&&(e=e.mark.group);)s+=e.x||0,u+=e.y||0;return{x:s,y:u,width:o,height:a,left:s,top:u,right:s+o,bottom:u+a}}};function Dr(e){this._el=null,this._bgcolor=null,this._loader=new h2(e)}Dr.prototype={initialize(e,t,n,i,r){return this._el=e,this.resize(t,n,i,r)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return arguments.length===0?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,i){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=i||1,this},dirty(){},render(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){const t=this.render(e);return this._ready?this._ready.then(()=>t):Promise.resolve(t)},_load(e,t){var n=this,i=n._loader[e](t);if(!n._ready){const r=n._call;n._ready=n._loader.ready().then(o=>{o&&r(),n._ready=null})}return i},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const cQ="keydown",fQ="keypress",dQ="keyup",L5="dragenter",Bg="dragleave",P5="dragover",I2="mousedown",hQ="mouseup",zg="mousemove",Bf="mouseout",I5="mouseover",Ug="click",gQ="dblclick",pQ="wheel",B5="mousewheel",qg="touchstart",Hg="touchmove",Wg="touchend",mQ=[cQ,fQ,dQ,L5,Bg,P5,I2,hQ,zg,Bf,I5,Ug,gQ,pQ,B5,qg,Hg,Wg],B2=zg,zf=Bf,z2=Ug;function Uf(e,t){ya.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}const yQ=e=>e===qg||e===Hg||e===Wg?[qg,Hg,Wg]:[e];function z5(e,t){yQ(t).forEach(n=>vQ(e,n))}function vQ(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?i=>e[t](i):i=>e.fire(t,i)))}function U5(e,t,n){return function(i){const r=this._active,o=this.pickEvent(i);o===r?this.fire(e,i):((!r||!r.exit)&&this.fire(n,i),this._active=o,this.fire(t,i),this.fire(e,i))}}function q5(e){return function(t){this.fire(e,t),this._active=null}}q(Uf,ya,{initialize(e,t,n){return this._canvas=e&&P2(e,"canvas"),[Ug,I2,zg,Bf,Bg].forEach(i=>z5(this,i)),ya.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:mQ,DOMMouseScroll(e){this.fire(B5,e)},mousemove:U5(zg,I5,Bf),dragover:U5(P5,L5,Bg),mouseout:q5(Bf),dragleave:q5(Bg),mousedown(e){this._down=this._active,this.fire(I2,e)},click(e){this._down===this._active&&(this.fire(Ug,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(qg,e,!0)},touchmove(e){this.fire(Hg,e,!0)},touchend(e){this.fire(Wg,e,!0),this._touch=null},fire(e,t,n){const i=n?this._touch:this._active,r=this._handlers[e];if(t.vegaType=e,e===z2&&i&&i.href?this.handleHref(t,i,i.href):(e===B2||e===zf)&&this.handleTooltip(t,i,e!==zf),r)for(let o=0,a=r.length;o<a;++o)r[o].handler.call(this._obj,t,i)},on(e,t){const n=this.eventName(e),i=this._handlers;return this._handlerIndex(i[n],e,t)<0&&(z5(this,e),(i[n]||(i[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),i=this._handlers[n],r=this._handlerIndex(i,e,t);return r>=0&&i.splice(r,1),this},pickEvent(e){const t=Ig(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,i,r){const o=this.context();return ai[e.marktype].pick.call(this,o,e,t,n,i,r)}});function bQ(){return typeof window!="undefined"&&window.devicePixelRatio||1}var xQ=bQ();function wQ(e,t,n,i,r,o){const a=typeof HTMLElement!="undefined"&&e instanceof HTMLElement&&e.parentNode!=null,s=e.getContext("2d"),u=a?xQ:r;e.width=t*u,e.height=n*u;for(const l in o)s[l]=o[l];return a&&u!==1&&(e.style.width=t+"px",e.style.height=n+"px"),s.pixelRatio=u,s.setTransform(u,0,0,u,u*i[0],u*i[1]),e}function Gg(e){Dr.call(this,e),this._options={},this._redraw=!1,this._dirty=new Et,this._tempb=new Et}const H5=Dr.prototype,EQ=(e,t,n)=>new Et().set(0,0,t,n).translate(-e[0],-e[1]);function _Q(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}q(Gg,Dr,{initialize(e,t,n,i,r,o){return this._options=o||{},this._canvas=this._options.externalContext?null:Ku(1,1,this._options.type),e&&this._canvas&&(Xi(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),H5.initialize.call(this,e,t,n,i,r)},resize(e,t,n,i){if(H5.resize.call(this,e,t,n,i),this._canvas)wQ(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const r=this._options.externalContext;r||I("CanvasRenderer is missing a valid canvas or context"),r.scale(this._scale,this._scale),r.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,i=this._width,r=this._height,o=this._dirty,a=EQ(n,i,r);t.save();const s=this._redraw||o.empty()?(this._redraw=!1,a.expand(1)):_Q(t,a.intersect(o),n);return this.clear(-n[0],-n[1],i,r),this.draw(t,e,s),t.restore(),o.clear(),this},draw(e,t,n){const i=ai[t.marktype];t.clip&&xZ(e,t),i.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,i){const r=this._options,o=this.context();r.type!=="pdf"&&!r.externalContext&&o.clearRect(e,t,n,i),this._bgcolor!=null&&(o.fillStyle=this._bgcolor,o.fillRect(e,t,n,i))}});function U2(e,t){ya.call(this,e,t);const n=this;n._hrefHandler=q2(n,(i,r)=>{r&&r.href&&n.handleHref(i,r,r.href)}),n._tooltipHandler=q2(n,(i,r)=>{n.handleTooltip(i,r,i.type!==zf)})}const q2=(e,t)=>n=>{let i=n.target.__data__;i=Array.isArray(i)?i[0]:i,n.vegaType=n.type,t.call(e._obj,n,i)};q(U2,ya,{initialize(e,t,n){let i=this._svg;return i&&(i.removeEventListener(z2,this._hrefHandler),i.removeEventListener(B2,this._tooltipHandler),i.removeEventListener(zf,this._tooltipHandler)),this._svg=i=e&&P2(e,"svg"),i&&(i.addEventListener(z2,this._hrefHandler),i.addEventListener(B2,this._tooltipHandler),i.addEventListener(zf,this._tooltipHandler)),ya.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),i=this._handlers;if(this._handlerIndex(i[n],e,t)<0){const o={type:e,handler:t,listener:q2(this,t)};(i[n]||(i[n]=[])).push(o),this._svg&&this._svg.addEventListener(n,o.listener)}return this},off(e,t){const n=this.eventName(e),i=this._handlers[n],r=this._handlerIndex(i,e,t);return r>=0&&(this._svg&&this._svg.removeEventListener(n,i[r].listener),i.splice(r,1)),this}});const W5="aria-hidden",H2="aria-label",W2="role",G2="aria-roledescription",G5="graphics-object",Y2="graphics-symbol",Y5=(e,t,n)=>({[W2]:e,[G2]:t,[H2]:n||void 0}),AQ=Hi(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),V5={axis:{desc:"axis",caption:OQ},legend:{desc:"legend",caption:CQ},"title-text":{desc:"title",caption:e=>`Title text '${Z5(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${Z5(e)}'`}},X5={ariaRole:W2,ariaRoleDescription:G2,description:H2};function K5(e,t){const n=t.aria===!1;if(e(W5,n||void 0),n||t.description==null)for(const i in X5)e(X5[i],void 0);else{const i=t.mark.marktype;e(H2,t.description),e(W2,t.ariaRole||(i==="group"?G5:Y2)),e(G2,t.ariaRoleDescription||`${i} mark`)}}function J5(e){return e.aria===!1?{[W5]:!0}:AQ[e.role]?null:V5[e.role]?SQ(e,V5[e.role]):$Q(e)}function $Q(e){const t=e.marktype,n=t==="group"||t==="text"||e.items.some(i=>i.description!=null&&i.aria!==!1);return Y5(n?G5:Y2,`${t} mark container`,e.description)}function SQ(e,t){try{const n=e.items[0],i=t.caption||(()=>"");return Y5(t.role||Y2,t.desc,n.description||i(n))}catch(n){return null}}function Z5(e){return oe(e.text).join(" ")}function OQ(e){const t=e.datum,n=e.orient,i=t.title?Q5(e):null,r=e.context,o=r.scales[t.scale].value,a=r.dataflow.locale(),s=o.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(i?` titled '${i}'`:"")+` for a ${al(s)?"discrete":s} scale with ${XM(a,o,e)}`}function CQ(e){const t=e.datum,n=t.title?Q5(e):null,i=`${t.type||""} legend`.trim(),r=t.scales,o=Object.keys(r),a=e.context,s=a.scales[r[o[0]]].value,u=a.dataflow.locale();return kQ(i)+(n?` titled '${n}'`:"")+` for ${FQ(o)} with ${XM(u,s,e)}`}function Q5(e){try{return oe(Ee(e.items).items[0].text).join(" ")}catch(t){return null}}function FQ(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+Ee(e)}function kQ(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const eT=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),DQ=e=>eT(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function V2(){let e="",t="",n="";const i=[],r=()=>t=n="",o=u=>{t&&(e+=`${t}>${n}`,r()),i.push(u)},a=(u,l)=>(l!=null&&(t+=` ${u}="${DQ(l)}"`),s),s={open(u,...l){o(u),t="<"+u;for(const c of l)for(const f in c)a(f,c[f]);return s},close(){const u=i.pop();return t?e+=t+(n?`>${n}</${u}>`:"/>"):e+=`</${u}>`,r(),s},attr:a,text:u=>(n+=eT(u),s),toString:()=>e};return s}const tT=e=>nT(V2(),e)+"";function nT(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,i=n.length;for(let r=0;r<i;++r)e.attr(n[r].name,n[r].value)}if(t.hasChildNodes()){const n=t.childNodes,i=n.length;for(let r=0;r<i;r++){const o=n[r];o.nodeType===3?e.text(o.nodeValue):nT(e,o)}}return e.close()}const Yg={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},iT={fill:"none","stroke-miterlimit":10},qf=0,rT="http://www.w3.org/2000/xmlns/",_t=jf.xmlns;function X2(e){Dr.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const K2=Dr.prototype;q(X2,Dr,{initialize(e,t,n,i,r){return this._defs={},this._clearDefs(),e&&(this._svg=Un(e,0,"svg",_t),this._svg.setAttributeNS(rT,"xmlns",_t),this._svg.setAttributeNS(rT,"xmlns:xlink",jf["xmlns:xlink"]),this._svg.setAttribute("version",jf.version),this._svg.setAttribute("class","marks"),Xi(e,1),this._root=Un(this._svg,qf,"g",_t),va(this._root,iT),Xi(this._svg,qf+1)),this.background(this._bgcolor),K2.initialize.call(this,e,t,n,i,r)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),K2.background.apply(this,arguments)},resize(e,t,n,i){return K2.resize.call(this,e,t,n,i),this._svg&&(va(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=Un(e,qf,"rect",_t),va(n,{width:this._width,height:this._height,fill:t}));const i=tT(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),i},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),Xi(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,i,r,o,a,s,u;for(a=0,s=e.length;a<s;++a)if(n=e[a],i=n.mark,i.marktype!==r&&(r=i.marktype,o=ai[r]),i.zdirty&&i.dirty!==t&&(this._dirtyAll=!1,oT(n,t),i.items.forEach(l=>{l.dirty=t})),!i.zdirty){if(n.exit){o.nested&&i.items.length?(u=i.items[0],u._svg&&this._update(o,u._svg,u)):n._svg&&(u=n._svg.parentNode,u&&u.removeChild(n._svg)),n._svg=null;continue}n=o.nested?i.items[0]:n,n._update!==t&&(!n._svg||!n._svg.ownerSVGElement?(this._dirtyAll=!1,oT(n,t)):this._update(o,n._svg,n),n._update=t)}return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;const i=this._svg,r=ai[t.marktype],o=t.interactive===!1?"none":null,a=r.tag==="g";let s=null,u=0;const l=aT(t,e,n,"g",i);l.setAttribute("class",j5(t));const c=J5(t);for(const d in c)vn(l,d,c[d]);a||vn(l,"pointer-events",o),vn(l,"clip-path",t.clip?d2(this,t,t.group):null);const f=d=>{const h=this.isDirty(d),g=aT(d,l,s,r.tag,i);h&&(this._update(r,g,d),a&&NQ(this,g,d)),s=g,++u};return r.nested?t.items.length&&f(t.items[0]):Vi(t,f),Xi(l,u),l},_update(e,t,n){wo=t,nn=t.__values__,K5(Hf,n),e.attr(Hf,n,this);const i=jQ[e.type];i&&i.call(this,e,t,n),wo&&this.style(wo,n)},style(e,t){if(t!=null)for(const n in Yg){let i=n==="font"?Pf(t):t[n];if(i===nn[n])continue;const r=Yg[n];i==null?e.removeAttribute(r):(a2(i)&&(i=JM(i,this._defs.gradient,sT())),e.setAttribute(r,i+"")),nn[n]=i}},defs(){const e=this._svg,t=this._defs;let n=t.el,i=0;for(const r in t.gradient)n||(t.el=n=Un(e,qf+1,"defs",_t)),i=MQ(n,t.gradient[r],i);for(const r in t.clipping)n||(t.el=n=Un(e,qf+1,"defs",_t)),i=TQ(n,t.clipping[r],i);n&&(i===0?(e.removeChild(n),t.el=null):Xi(n,i))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});function oT(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function MQ(e,t,n){let i,r,o;if(t.gradient==="radial"){let a=Un(e,n++,"pattern",_t);va(a,{id:wg+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),a=Un(a,0,"rect",_t),va(a,{width:1,height:1,fill:`url(${sT()}#${t.id})`}),e=Un(e,n++,"radialGradient",_t),va(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=Un(e,n++,"linearGradient",_t),va(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(i=0,r=t.stops.length;i<r;++i)o=Un(e,i,"stop",_t),o.setAttribute("offset",t.stops[i].offset),o.setAttribute("stop-color",t.stops[i].color);return Xi(e,i),n}function TQ(e,t,n){let i;return e=Un(e,n,"clipPath",_t),e.setAttribute("id",t.id),t.path?(i=Un(e,0,"path",_t),i.setAttribute("d",t.path)):(i=Un(e,0,"rect",_t),va(i,{x:0,y:0,width:t.width,height:t.height})),Xi(e,1),n+1}function NQ(e,t,n){t=t.lastChild.previousSibling;let i,r=0;Vi(n,o=>{i=e.mark(t,o,i),++r}),Xi(t,1+r)}function aT(e,t,n,i,r){let o=e._svg,a;if(!o&&(a=t.ownerDocument,o=ma(a,i,_t),e._svg=o,e.mark&&(o.__data__=e,o.__values__={fill:"default"},i==="g"))){const s=ma(a,"path",_t);o.appendChild(s),s.__data__=e;const u=ma(a,"g",_t);o.appendChild(u),u.__data__=e;const l=ma(a,"path",_t);o.appendChild(l),l.__data__=e,l.__values__={fill:"default"}}return(o.ownerSVGElement!==r||RQ(o,n))&&t.insertBefore(o,n?n.nextSibling:t.firstChild),o}function RQ(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}let wo=null,nn=null;const jQ={group(e,t,n){const i=wo=t.childNodes[2];nn=i.__values__,e.foreground(Hf,n,this),nn=t.__values__,wo=t.childNodes[1],e.content(Hf,n,this);const r=wo=t.childNodes[0];e.background(Hf,n,this);const o=n.mark.interactive===!1?"none":null;if(o!==nn.events&&(vn(i,"pointer-events",o),vn(r,"pointer-events",o),nn.events=o),n.strokeForeground&&n.stroke){const a=n.fill;vn(i,"display",null),this.style(r,n),vn(r,"stroke",null),a&&(n.fill=null),nn=i.__values__,this.style(i,n),a&&(n.fill=a),wo=null}else vn(i,"display","none")},image(e,t,n){n.smooth===!1?(J2(t,"image-rendering","optimizeSpeed"),J2(t,"image-rendering","pixelated")):J2(t,"image-rendering",null)},text(e,t,n){const i=Lf(n);let r,o,a,s;Q(i)?(o=i.map(u=>pa(n,u)),r=o.join(`
`),r!==nn.text&&(Xi(t,0),a=t.ownerDocument,s=ga(n),o.forEach((u,l)=>{const c=ma(a,"tspan",_t);c.__data__=n,c.textContent=u,l&&(c.setAttribute("x",0),c.setAttribute("dy",s)),t.appendChild(c)}),nn.text=r)):(o=pa(n,i),o!==nn.text&&(t.textContent=o,nn.text=o)),vn(t,"font-family",Pf(n)),vn(t,"font-size",kr(n)+"px"),vn(t,"font-style",n.fontStyle),vn(t,"font-variant",n.fontVariant),vn(t,"font-weight",n.fontWeight)}};function Hf(e,t,n){t!==nn[e]&&(n?LQ(wo,e,t,n):vn(wo,e,t),nn[e]=t)}function J2(e,t,n){n!==nn[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),nn[t]=n)}function va(e,t){for(const n in t)vn(e,n,t[n])}function vn(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function LQ(e,t,n,i){n!=null?e.setAttributeNS(i,t,n):e.removeAttributeNS(i,t)}function sT(){let e;return typeof window=="undefined"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function Z2(e){Dr.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}q(Z2,Dr,{svg(){return this._text},_render(e){const t=V2();t.open("svg",ge({},jf,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&n!=="transparent"&&n!=="none"&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",iT,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=ai[t.marktype],i=n.tag,r=[K5,n.attr];e.open("g",{class:j5(t),"clip-path":t.clip?d2(this,t,t.group):null},J5(t),{"pointer-events":i!=="g"&&t.interactive===!1?"none":null});const o=a=>{const s=this.href(a);if(s&&e.open("a",s),e.open(i,this.attr(t,a,r,i!=="g"?i:null)),i==="text"){const u=Lf(a);if(Q(u)){const l={x:0,dy:ga(a)};for(let c=0;c<u.length;++c)e.open("tspan",c?l:null).text(pa(a,u[c])).close()}else e.text(pa(a,u))}else if(i==="g"){const u=a.strokeForeground,l=a.fill,c=a.stroke;u&&c&&(a.stroke=null),e.open("path",this.attr(t,a,n.background,"bgrect")).close(),e.open("g",this.attr(t,a,n.content)),Vi(a,f=>this.mark(e,f)),e.close(),u&&c?(l&&(a.fill=null),a.stroke=c,e.open("path",this.attr(t,a,n.foreground,"bgrect")).close(),l&&(a.fill=l)):e.open("path",this.attr(t,a,n.foreground,"bgfore")).close()}e.close(),s&&e.close()};return n.nested?t.items&&t.items.length&&o(t.items[0]):Vi(t,o),e.close()},href(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then(i=>{i["xlink:href"]=i.href,i.href=null,(this._hrefs||(this._hrefs={}))[t]=i})}return null},attr(e,t,n,i){const r={},o=(a,s,u,l)=>{r[l||a]=s};return Array.isArray(n)?n.forEach(a=>a(o,t,this)):n(o,t,this),i&&PQ(r,t,e,i,this._defs),r},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(Object.keys(t).length+Object.keys(n).length!==0){e.open("defs");for(const r in t){const o=t[r],a=o.stops;o.gradient==="radial"?(e.open("pattern",{id:wg+r,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+r+")"}).close(),e.close(),e.open("radialGradient",{id:r,fx:o.x1,fy:o.y1,fr:o.r1,cx:o.x2,cy:o.y2,r:o.r2})):e.open("linearGradient",{id:r,x1:o.x1,x2:o.x2,y1:o.y1,y2:o.y2});for(let s=0;s<a.length;++s)e.open("stop",{offset:a[s].offset,"stop-color":a[s].color}).close();e.close()}for(const r in n){const o=n[r];e.open("clipPath",{id:r}),o.path?e.open("path",{d:o.path}).close():e.open("rect",{x:0,y:0,width:o.width,height:o.height}).close(),e.close()}e.close()}}});function PQ(e,t,n,i,r){if(t==null||(i==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),i==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;i==="image"&&t.smooth===!1&&(e.style="image-rendering: optimizeSpeed; image-rendering: pixelated;"),i==="text"&&(e["font-family"]=Pf(t),e["font-size"]=kr(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const o in Yg){let a=t[o];const s=Yg[o];a==="transparent"&&(s==="fill"||s==="stroke")||a!=null&&(a2(a)&&(a=JM(a,r.gradient,"")),e[s]=a)}return e}const uT="canvas",lT="png",cT="svg",fT="none",ba={Canvas:uT,PNG:lT,SVG:cT,None:fT},hl={};hl[uT]=hl[lT]={renderer:Gg,headless:Gg,handler:Uf};hl[cT]={renderer:X2,headless:Z2,handler:U2};hl[fT]={};function Vg(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(hl[e]=t,this):hl[e]}function dT(e,t,n){const i=[],r=new Et().union(t),o=e.marktype;return o?hT(e,r,n,i):o==="group"?gT(e,r,n,i):I("Intersect scene must be mark node or group item.")}function hT(e,t,n,i){if(IQ(e,t,n)){const r=e.items,o=e.marktype,a=r.length;let s=0;if(o==="group")for(;s<a;++s)gT(r[s],t,n,i);else for(const u=ai[o].isect;s<a;++s){const l=r[s];pT(l,t,u)&&i.push(l)}}return i}function IQ(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function gT(e,t,n,i){n&&n(e.mark)&&pT(e,t,ai.group.isect)&&i.push(e);const r=e.items,o=r&&r.length;if(o){const a=e.x||0,s=e.y||0;t.translate(-a,-s);for(let u=0;u<o;++u)hT(r[u],t,n,i);t.translate(a,s)}return i}function pT(e,t,n){const i=e.bounds;return t.encloses(i)||t.intersects(i)&&n(e,t)}const Q2=new Et;function mT(e){const t=e.clip;if(me(t))t(Tf(Q2.clear()));else if(t)Q2.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(Q2)}const BQ=1e-9;function ew(e,t,n){return e===t?!0:n==="path"?yT(e,t):e instanceof Date&&t instanceof Date?+e==+t:Qo(e)&&Qo(t)?Math.abs(e-t)<=BQ:!e||!t||!se(e)&&!se(t)?e==t:zQ(e,t)}function yT(e,t){return ew(sl(e),sl(t))}function zQ(e,t){var n=Object.keys(e),i=Object.keys(t),r,o;if(n.length!==i.length)return!1;for(n.sort(),i.sort(),o=n.length-1;o>=0;o--)if(n[o]!=i[o])return!1;for(o=n.length-1;o>=0;o--)if(r=n[o],!ew(e[r],t[r],r))return!1;return typeof e==typeof t}function UQ(){u5(),vJ()}const gl="top",Ki="left",Ji="right",xa="bottom",qQ="top-left",HQ="top-right",WQ="bottom-left",GQ="bottom-right",tw="start",nw="middle",bn="end",YQ="x",VQ="y",Xg="group",iw="axis",rw="title",XQ="frame",KQ="scope",ow="legend",vT="row-header",bT="row-footer",xT="row-title",wT="column-header",ET="column-footer",_T="column-title",JQ="padding",ZQ="symbol",AT="fit",QQ="fit-x",eee="fit-y",tee="pad",aw="none",Kg="all",sw="each",uw="flush",wa="column",Ea="row";function $T(e){N.call(this,null,e)}q($T,N,{transform(e,t){const n=t.dataflow,i=e.mark,r=i.marktype,o=ai[r],a=o.bound;let s=i.bounds,u;if(o.nested)i.items.length&&n.dirty(i.items[0]),s=Jg(i,a),i.items.forEach(l=>{l.bounds.clear().union(s)});else if(r===Xg||e.modified())switch(t.visit(t.MOD,l=>n.dirty(l)),s.clear(),i.items.forEach(l=>s.union(Jg(l,a))),i.role){case iw:case ow:case rw:t.reflow()}else u=t.changed(t.REM),t.visit(t.ADD,l=>{s.union(Jg(l,a))}),t.visit(t.MOD,l=>{u=u||s.alignsWith(l.bounds),n.dirty(l),s.union(Jg(l,a))}),u&&(s.clear(),i.items.forEach(l=>s.union(l.bounds)));return mT(i),t.modifies("bounds")}});function Jg(e,t,n){return t(e.bounds.clear(),e,n)}const ST=":vega_identifier:";function lw(e){N.call(this,0,e)}lw.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]};q(lw,N,{transform(e,t){const n=nee(t.dataflow),i=e.as;let r=n.value;return t.visit(t.ADD,o=>o[i]=o[i]||++r),n.set(this.value=r),t}});function nee(e){return e._signals[ST]||(e._signals[ST]=e.add(0))}function OT(e){N.call(this,null,e)}q(OT,N,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,iee(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const i=n.marktype===Xg?$g:Ag;return t.visit(t.ADD,r=>i.call(r,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});function iee(e){const t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function CT(e){N.call(this,null,e)}const FT={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((i,r)=>!r||!kT(n.bounds,i.bounds,t)?(n=i,1):i.opacity=0)}},kT=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),DT=(e,t)=>{for(var n=1,i=e.length,r=e[0].bounds,o;n<i;r=o,++n)if(kT(r,o=e[n].bounds,t))return!0},ree=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},oee=(e,t,n)=>{var i=e.range(),r=new Et;return t===gl||t===xa?r.set(i[0],-1/0,i[1],1/0):r.set(-1/0,i[0],1/0,i[1]),r.expand(n||1),o=>r.encloses(o.bounds)},MT=e=>(e.forEach(t=>t.opacity=1),e),TT=(e,t)=>e.reflow(t.modified()).modifies("opacity");q(CT,N,{transform(e,t){const n=FT[e.method]||FT.parity,i=e.separation||0;let r=t.materialize(t.SOURCE).source,o,a;if(!r||!r.length)return;if(!e.method)return e.modified("method")&&(MT(r),t=TT(t,e)),t;if(r=r.filter(ree),!r.length)return;if(e.sort&&(r=r.slice().sort(e.sort)),o=MT(r),t=TT(t,e),o.length>=3&&DT(o,i)){do o=n(o,i);while(o.length>=3&&DT(o,i));o.length<3&&!Ee(r).opacity&&(o.length>1&&(Ee(o).opacity=0),Ee(r).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(a=oee(e.boundScale,e.boundOrient,+e.boundTolerance),r.forEach(u=>{a(u)||(u.opacity=0)}));const s=o[0].mark.bounds.clear();return r.forEach(u=>{u.opacity&&s.union(u.bounds)}),t}});function NT(e){N.call(this,null,e)}q(NT,N,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,i=>n.dirty(i)),t.fields&&t.fields.zindex){const i=t.source&&t.source[0];i&&(i.mark.zdirty=!0)}}});const rn=new Et;function pl(e,t,n){return e[t]===n?0:(e[t]=n,1)}function aee(e){var t=e.items[0].orient;return t===Ki||t===Ji}function see(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function uee(e,t,n,i){var r=t.items[0],o=r.datum,a=r.translate!=null?r.translate:.5,s=r.orient,u=see(o),l=r.range,c=r.offset,f=r.position,d=r.minExtent,h=r.maxExtent,g=o.title&&r.items[u[2]].items[0],p=r.titlePadding,m=r.bounds,y=g&&T2(g),v=0,b=0,x,w;switch(rn.clear().union(m),m.clear(),(x=u[0])>-1&&m.union(r.items[x].bounds),(x=u[1])>-1&&m.union(r.items[x].bounds),s){case gl:v=f||0,b=-c,w=Math.max(d,Math.min(h,-m.y1)),m.add(0,-w).add(l,0),g&&Zg(e,g,w,p,y,0,-1,m);break;case Ki:v=-c,b=f||0,w=Math.max(d,Math.min(h,-m.x1)),m.add(-w,0).add(0,l),g&&Zg(e,g,w,p,y,1,-1,m);break;case Ji:v=n+c,b=f||0,w=Math.max(d,Math.min(h,m.x2)),m.add(0,0).add(w,l),g&&Zg(e,g,w,p,y,1,1,m);break;case xa:v=f||0,b=i+c,w=Math.max(d,Math.min(h,m.y2)),m.add(0,0).add(l,w),g&&Zg(e,g,w,p,0,0,1,m);break;default:v=r.x,b=r.y}return xo(m.translate(v,b),r),pl(r,"x",v+a)|pl(r,"y",b+a)&&(r.bounds=rn,e.dirty(r),r.bounds=m,e.dirty(r)),r.mark.bounds.clear().union(m)}function Zg(e,t,n,i,r,o,a,s){const u=t.bounds;if(t.auto){const l=a*(n+r+i);let c=0,f=0;e.dirty(t),o?c=(t.x||0)-(t.x=l):f=(t.y||0)-(t.y=l),t.mark.bounds.clear().union(u.translate(-c,-f)),e.dirty(t)}s.union(u)}const RT=(e,t)=>Math.floor(Math.min(e,t)),jT=(e,t)=>Math.ceil(Math.max(e,t));function lee(e){var t=e.items,n=t.length,i=0,r,o;const a={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;i<n;++i)if(r=t[i],o=r.items,r.marktype===Xg)switch(r.role){case iw:case ow:case rw:break;case vT:a.rowheaders.push(...o);break;case bT:a.rowfooters.push(...o);break;case wT:a.colheaders.push(...o);break;case ET:a.colfooters.push(...o);break;case xT:a.rowtitle=o[0];break;case _T:a.coltitle=o[0];break;default:a.marks.push(...o)}return a}function cee(e){return new Et().set(0,0,e.width||0,e.height||0)}function fee(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function tt(e,t,n){const i=se(e)?e[t]:e;return i!=null?i:n!==void 0?n:0}function LT(e){return e<0?Math.ceil(-e):0}function PT(e,t,n){var i=!n.nodirty,r=n.bounds===uw?cee:fee,o=rn.set(0,0,0,0),a=tt(n.align,wa),s=tt(n.align,Ea),u=tt(n.padding,wa),l=tt(n.padding,Ea),c=n.columns||t.length,f=c<=0?1:Math.ceil(t.length/c),d=t.length,h=Array(d),g=Array(c),p=0,m=Array(d),y=Array(f),v=0,b=Array(d),x=Array(d),w=Array(d),_,E,$,O,C,A,D,F,T,S,M;for(E=0;E<c;++E)g[E]=0;for(E=0;E<f;++E)y[E]=0;for(E=0;E<d;++E)A=t[E],C=w[E]=r(A),A.x=A.x||0,b[E]=0,A.y=A.y||0,x[E]=0,$=E%c,O=~~(E/c),p=Math.max(p,D=Math.ceil(C.x2)),v=Math.max(v,F=Math.ceil(C.y2)),g[$]=Math.max(g[$],D),y[O]=Math.max(y[O],F),h[E]=u+LT(C.x1),m[E]=l+LT(C.y1),i&&e.dirty(t[E]);for(E=0;E<d;++E)E%c==0&&(h[E]=0),E<c&&(m[E]=0);if(a===sw)for($=1;$<c;++$){for(M=0,E=$;E<d;E+=c)M<h[E]&&(M=h[E]);for(E=$;E<d;E+=c)h[E]=M+g[$-1]}else if(a===Kg){for(M=0,E=0;E<d;++E)E%c&&M<h[E]&&(M=h[E]);for(E=0;E<d;++E)E%c&&(h[E]=M+p)}else for(a=!1,$=1;$<c;++$)for(E=$;E<d;E+=c)h[E]+=g[$-1];if(s===sw)for(O=1;O<f;++O){for(M=0,E=O*c,_=E+c;E<_;++E)M<m[E]&&(M=m[E]);for(E=O*c;E<_;++E)m[E]=M+y[O-1]}else if(s===Kg){for(M=0,E=c;E<d;++E)M<m[E]&&(M=m[E]);for(E=c;E<d;++E)m[E]=M+v}else for(s=!1,O=1;O<f;++O)for(E=O*c,_=E+c;E<_;++E)m[E]+=y[O-1];for(T=0,E=0;E<d;++E)T=h[E]+(E%c?T:0),b[E]+=T-t[E].x;for($=0;$<c;++$)for(S=0,E=$;E<d;E+=c)S+=m[E],x[E]+=S-t[E].y;if(a&&tt(n.center,wa)&&f>1)for(E=0;E<d;++E)C=a===Kg?p:g[E%c],T=C-w[E].x2-t[E].x-b[E],T>0&&(b[E]+=T/2);if(s&&tt(n.center,Ea)&&c!==1)for(E=0;E<d;++E)C=s===Kg?v:y[~~(E/c)],S=C-w[E].y2-t[E].y-x[E],S>0&&(x[E]+=S/2);for(E=0;E<d;++E)o.union(w[E].translate(b[E],x[E]));switch(T=tt(n.anchor,YQ),S=tt(n.anchor,VQ),tt(n.anchor,wa)){case bn:T-=o.width();break;case nw:T-=o.width()/2}switch(tt(n.anchor,Ea)){case bn:S-=o.height();break;case nw:S-=o.height()/2}for(T=Math.round(T),S=Math.round(S),o.clear(),E=0;E<d;++E)t[E].mark.bounds.clear();for(E=0;E<d;++E)A=t[E],A.x+=b[E]+=T,A.y+=x[E]+=S,o.union(A.mark.bounds.union(A.bounds.translate(b[E],x[E]))),i&&e.dirty(A);return o}function dee(e,t,n){var i=lee(t),r=i.marks,o=n.bounds===uw?hee:gee,a=n.offset,s=n.columns||r.length,u=s<=0?1:Math.ceil(r.length/s),l=u*s,c,f,d,h,g,p,m;const y=PT(e,r,n);y.empty()&&y.set(0,0,0,0),i.rowheaders&&(p=tt(n.headerBand,Ea,null),c=Qg(e,i.rowheaders,r,s,u,-tt(a,"rowHeader"),RT,0,o,"x1",0,s,1,p)),i.colheaders&&(p=tt(n.headerBand,wa,null),f=Qg(e,i.colheaders,r,s,s,-tt(a,"columnHeader"),RT,1,o,"y1",0,1,s,p)),i.rowfooters&&(p=tt(n.footerBand,Ea,null),d=Qg(e,i.rowfooters,r,s,u,tt(a,"rowFooter"),jT,0,o,"x2",s-1,s,1,p)),i.colfooters&&(p=tt(n.footerBand,wa,null),h=Qg(e,i.colfooters,r,s,s,tt(a,"columnFooter"),jT,1,o,"y2",l-s,1,s,p)),i.rowtitle&&(g=tt(n.titleAnchor,Ea),m=tt(a,"rowTitle"),m=g===bn?d+m:c-m,p=tt(n.titleBand,Ea,.5),IT(e,i.rowtitle,m,0,y,p)),i.coltitle&&(g=tt(n.titleAnchor,wa),m=tt(a,"columnTitle"),m=g===bn?h+m:f-m,p=tt(n.titleBand,wa,.5),IT(e,i.coltitle,m,1,y,p))}function hee(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):void 0}function gee(e,t){return e.bounds[t]}function Qg(e,t,n,i,r,o,a,s,u,l,c,f,d,h){var g=n.length,p=0,m=0,y,v,b,x,w,_,E,$,O;if(!g)return p;for(y=c;y<g;y+=f)n[y]&&(p=a(p,u(n[y],l)));if(!t.length)return p;for(t.length>r&&(e.warn("Grid headers exceed limit: "+r),t=t.slice(0,r)),p+=o,v=0,x=t.length;v<x;++v)e.dirty(t[v]),t[v].mark.bounds.clear();for(y=c,v=0,x=t.length;v<x;++v,y+=f){for(_=t[v],w=_.mark.bounds,b=y;b>=0&&(E=n[b])==null;b-=d);s?($=h==null?E.x:Math.round(E.bounds.x1+h*E.bounds.width()),O=p):($=p,O=h==null?E.y:Math.round(E.bounds.y1+h*E.bounds.height())),w.union(_.bounds.translate($-(_.x||0),O-(_.y||0))),_.x=$,_.y=O,e.dirty(_),m=a(m,w[l])}return m}function IT(e,t,n,i,r,o){if(!!t){e.dirty(t);var a=n,s=n;i?a=Math.round(r.x1+o*r.width()):s=Math.round(r.y1+o*r.height()),t.bounds.translate(a-(t.x||0),s-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=a,t.y=s,e.dirty(t)}}function pee(e,t){const n=e[t]||{};return(i,r)=>n[i]!=null?n[i]:e[i]!=null?e[i]:r}function mee(e,t){let n=-1/0;return e.forEach(i=>{i.offset!=null&&(n=Math.max(n,i.offset))}),n>-1/0?n:t}function yee(e,t,n,i,r,o,a){const s=pee(n,t),u=mee(e,s("offset",0)),l=s("anchor",tw),c=l===bn?1:l===nw?.5:0,f={align:sw,bounds:s("bounds",uw),columns:s("direction")==="vertical"?1:e.length,padding:s("margin",8),center:s("center"),nodirty:!0};switch(t){case Ki:f.anchor={x:Math.floor(i.x1)-u,column:bn,y:c*(a||i.height()+2*i.y1),row:l};break;case Ji:f.anchor={x:Math.ceil(i.x2)+u,y:c*(a||i.height()+2*i.y1),row:l};break;case gl:f.anchor={y:Math.floor(r.y1)-u,row:bn,x:c*(o||r.width()+2*r.x1),column:l};break;case xa:f.anchor={y:Math.ceil(r.y2)+u,x:c*(o||r.width()+2*r.x1),column:l};break;case qQ:f.anchor={x:u,y:u};break;case HQ:f.anchor={x:o-u,y:u,column:bn};break;case WQ:f.anchor={x:u,y:a-u,row:bn};break;case GQ:f.anchor={x:o-u,y:a-u,column:bn,row:bn};break}return f}function vee(e,t){var n=t.items[0],i=n.datum,r=n.orient,o=n.bounds,a=n.x,s=n.y,u,l;return n._bounds?n._bounds.clear().union(o):n._bounds=o.clone(),o.clear(),xee(e,n,n.items[0].items[0]),o=bee(n,o),u=2*n.padding,l=2*n.padding,o.empty()||(u=Math.ceil(o.width()+u),l=Math.ceil(o.height()+l)),i.type===ZQ&&wee(n.items[0].items[0].items[0].items),r!==aw&&(n.x=a=0,n.y=s=0),n.width=u,n.height=l,xo(o.set(a,s,a+u,s+l),n),n.mark.bounds.clear().union(o),n}function bee(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}function xee(e,t,n){var i=t.padding,r=i-n.x,o=i-n.y;if(!t.datum.title)(r||o)&&Wf(e,n,r,o);else{var a=t.items[1].items[0],s=a.anchor,u=t.titlePadding||0,l=i-a.x,c=i-a.y;switch(a.orient){case Ki:r+=Math.ceil(a.bounds.width())+u;break;case Ji:case xa:break;default:o+=a.bounds.height()+u}switch((r||o)&&Wf(e,n,r,o),a.orient){case Ki:c+=ml(t,n,a,s,1,1);break;case Ji:l+=ml(t,n,a,bn,0,0)+u,c+=ml(t,n,a,s,1,1);break;case xa:l+=ml(t,n,a,s,0,0),c+=ml(t,n,a,bn,-1,0,1)+u;break;default:l+=ml(t,n,a,s,0,0)}(l||c)&&Wf(e,a,l,c),(l=Math.round(a.bounds.x1-i))<0&&(Wf(e,n,-l,0),Wf(e,a,-l,0))}}function ml(e,t,n,i,r,o,a){const s=e.datum.type!=="symbol",u=n.datum.vgrad,l=s&&(o||!u)&&!a?t.items[0]:t,c=l.bounds[r?"y2":"x2"]-e.padding,f=u&&o?c:0,d=u&&o?0:c,h=r<=0?0:T2(n);return Math.round(i===tw?f:i===bn?d-h:.5*(c-h))}function Wf(e,t,n,i){t.x+=n,t.y+=i,t.bounds.translate(n,i),t.mark.bounds.translate(n,i),e.dirty(t)}function wee(e){const t=e.reduce((n,i)=>(n[i.column]=Math.max(i.bounds.x2-i.x,n[i.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}function Eee(e,t,n,i,r){var o=t.items[0],a=o.frame,s=o.orient,u=o.anchor,l=o.offset,c=o.padding,f=o.items[0].items[0],d=o.items[1]&&o.items[1].items[0],h=s===Ki||s===Ji?i:n,g=0,p=0,m=0,y=0,v=0,b;if(a!==Xg?s===Ki?(g=r.y2,h=r.y1):s===Ji?(g=r.y1,h=r.y2):(g=r.x1,h=r.x2):s===Ki&&(g=i,h=0),b=u===tw?g:u===bn?h:(g+h)/2,d&&d.text){switch(s){case gl:case xa:v=f.bounds.height()+c;break;case Ki:y=f.bounds.width()+c;break;case Ji:y=-f.bounds.width()-c;break}rn.clear().union(d.bounds),rn.translate(y-(d.x||0),v-(d.y||0)),pl(d,"x",y)|pl(d,"y",v)&&(e.dirty(d),d.bounds.clear().union(rn),d.mark.bounds.clear().union(rn),e.dirty(d)),rn.clear().union(d.bounds)}else rn.clear();switch(rn.union(f.bounds),s){case gl:p=b,m=r.y1-rn.height()-l;break;case Ki:p=r.x1-rn.width()-l,m=b;break;case Ji:p=r.x2+rn.width()+l,m=b;break;case xa:p=b,m=r.y2+l;break;default:p=o.x,m=o.y}return pl(o,"x",p)|pl(o,"y",m)&&(rn.translate(p,m),e.dirty(o),o.bounds.clear().union(rn),t.bounds.clear().union(rn),e.dirty(o)),o.bounds}function BT(e){N.call(this,null,e)}q(BT,N,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(i=>{e.layout&&dee(n,i,e.layout),Aee(n,i,e)}),_ee(e.mark.group)?t.reflow():t}});function _ee(e){return e&&e.mark.role!=="legend-entry"}function Aee(e,t,n){var i=t.items,r=Math.max(0,t.width||0),o=Math.max(0,t.height||0),a=new Et().set(0,0,r,o),s=a.clone(),u=a.clone(),l=[],c,f,d,h,g,p;for(g=0,p=i.length;g<p;++g)switch(f=i[g],f.role){case iw:h=aee(f)?s:u,h.union(uee(e,f,r,o));break;case rw:c=f;break;case ow:l.push(vee(e,f));break;case XQ:case KQ:case vT:case bT:case xT:case wT:case ET:case _T:s.union(f.bounds),u.union(f.bounds);break;default:a.union(f.bounds)}if(l.length){const m={};l.forEach(y=>{d=y.orient||Ji,d!==aw&&(m[d]||(m[d]=[])).push(y)});for(const y in m){const v=m[y];PT(e,v,yee(v,y,n.legends,s,u,r,o))}l.forEach(y=>{const v=y.bounds;if(v.equals(y._bounds)||(y.bounds=y._bounds,e.dirty(y),y.bounds=v,e.dirty(y)),n.autosize&&n.autosize.type===AT)switch(y.orient){case Ki:case Ji:a.add(v.x1,0).add(v.x2,0);break;case gl:case xa:a.add(0,v.y1).add(0,v.y2)}else a.union(v)})}a.union(s).union(u),c&&a.union(Eee(e,c,r,o,a)),t.clip&&a.set(0,0,t.width||0,t.height||0),$ee(e,t,a,n)}function $ee(e,t,n,i){const r=i.autosize||{},o=r.type;if(e._autosize<1||!o)return;let a=e._width,s=e._height,u=Math.max(0,t.width||0),l=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-u)),h=Math.max(0,Math.ceil(n.y2-c));if(r.contains===JQ){const g=e.padding();a-=g.left+g.right,s-=g.top+g.bottom}o===aw?(l=0,f=0,u=a,c=s):o===AT?(u=Math.max(0,a-l-d),c=Math.max(0,s-f-h)):o===QQ?(u=Math.max(0,a-l-d),s=c+f+h):o===eee?(a=u+l+d,c=Math.max(0,s-f-h)):o===tee&&(a=u+l+d,s=c+f+h),e._resizeView(a,s,u,c,[l,f],r.resize)}var See=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",bound:$T,identifier:lw,mark:OT,overlap:CT,render:NT,viewlayout:BT});function zT(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(r);++i<r;)o[i]=e+i*n;return o}function Oee(e,t){let n=0;if(t===void 0)for(let i of e)(i=+i)&&(n+=i);else{let i=-1;for(let r of e)(r=+t(r,++i,e))&&(n+=r)}return n}function cw(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function UT(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function Gf(){}var Yf=.7,ep=1/Yf,yl="\\s*([+-]?\\d+)\\s*",Vf="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Mr="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Cee=/^#([0-9a-f]{3,8})$/,Fee=new RegExp("^rgb\\("+[yl,yl,yl]+"\\)$"),kee=new RegExp("^rgb\\("+[Mr,Mr,Mr]+"\\)$"),Dee=new RegExp("^rgba\\("+[yl,yl,yl,Vf]+"\\)$"),Mee=new RegExp("^rgba\\("+[Mr,Mr,Mr,Vf]+"\\)$"),Tee=new RegExp("^hsl\\("+[Vf,Mr,Mr]+"\\)$"),Nee=new RegExp("^hsla\\("+[Vf,Mr,Mr,Vf]+"\\)$"),qT={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};cw(Gf,Xf,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:HT,formatHex:HT,formatHsl:Ree,formatRgb:WT,toString:WT});function HT(){return this.rgb().formatHex()}function Ree(){return KT(this).formatHsl()}function WT(){return this.rgb().formatRgb()}function Xf(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Cee.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?GT(t):n===3?new si(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?tp(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?tp(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Fee.exec(e))?new si(t[1],t[2],t[3],1):(t=kee.exec(e))?new si(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Dee.exec(e))?tp(t[1],t[2],t[3],t[4]):(t=Mee.exec(e))?tp(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Tee.exec(e))?XT(t[1],t[2]/100,t[3]/100,1):(t=Nee.exec(e))?XT(t[1],t[2]/100,t[3]/100,t[4]):qT.hasOwnProperty(e)?GT(qT[e]):e==="transparent"?new si(NaN,NaN,NaN,0):null}function GT(e){return new si(e>>16&255,e>>8&255,e&255,1)}function tp(e,t,n,i){return i<=0&&(e=t=n=NaN),new si(e,t,n,i)}function jee(e){return e instanceof Gf||(e=Xf(e)),e?(e=e.rgb(),new si(e.r,e.g,e.b,e.opacity)):new si}function fw(e,t,n,i){return arguments.length===1?jee(e):new si(e,t,n,i==null?1:i)}function si(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}cw(si,fw,UT(Gf,{brighter:function(e){return e=e==null?ep:Math.pow(ep,e),new si(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?Yf:Math.pow(Yf,e),new si(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:YT,formatHex:YT,formatRgb:VT,toString:VT}));function YT(){return"#"+dw(this.r)+dw(this.g)+dw(this.b)}function VT(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function dw(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function XT(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Tr(e,t,n,i)}function KT(e){if(e instanceof Tr)return new Tr(e.h,e.s,e.l,e.opacity);if(e instanceof Gf||(e=Xf(e)),!e)return new Tr;if(e instanceof Tr)return e;e=e.rgb();var t=e.r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),o=Math.max(t,n,i),a=NaN,s=o-r,u=(o+r)/2;return s?(t===o?a=(n-i)/s+(n<i)*6:n===o?a=(i-t)/s+2:a=(t-n)/s+4,s/=u<.5?o+r:2-o-r,a*=60):s=u>0&&u<1?0:a,new Tr(a,s,u,e.opacity)}function Lee(e,t,n,i){return arguments.length===1?KT(e):new Tr(e,t,n,i==null?1:i)}function Tr(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}cw(Tr,Lee,UT(Gf,{brighter:function(e){return e=e==null?ep:Math.pow(ep,e),new Tr(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Yf:Math.pow(Yf,e),new Tr(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,r=2*n-i;return new si(hw(e>=240?e-240:e+120,r,i),hw(e,r,i),hw(e<120?e+240:e-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function hw(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}var gw=e=>()=>e;function Pee(e,t){return function(n){return e+n*t}}function Iee(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}function Bee(e){return(e=+e)==1?JT:function(t,n){return n-t?Iee(t,n,e):gw(isNaN(t)?n:t)}}function JT(e,t){var n=t-e;return n?Pee(e,n):gw(isNaN(e)?t:e)}var ZT=function e(t){var n=Bee(t);function i(r,o){var a=n((r=fw(r)).r,(o=fw(o)).r),s=n(r.g,o.g),u=n(r.b,o.b),l=JT(r.opacity,o.opacity);return function(c){return r.r=a(c),r.g=s(c),r.b=u(c),r.opacity=l(c),r+""}}return i.gamma=e,i}(1);function zee(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,i=t.slice(),r;return function(o){for(r=0;r<n;++r)i[r]=e[r]*(1-o)+t[r]*o;return i}}function Uee(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function qee(e,t){var n=t?t.length:0,i=e?Math.min(n,e.length):0,r=new Array(i),o=new Array(n),a;for(a=0;a<i;++a)r[a]=vw(e[a],t[a]);for(;a<n;++a)o[a]=t[a];return function(s){for(a=0;a<i;++a)o[a]=r[a](s);return o}}function Hee(e,t){var n=new Date;return e=+e,t=+t,function(i){return n.setTime(e*(1-i)+t*i),n}}function pw(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Wee(e,t){var n={},i={},r;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(r in t)r in e?n[r]=vw(e[r],t[r]):i[r]=t[r];return function(o){for(r in n)i[r]=n[r](o);return i}}var mw=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,yw=new RegExp(mw.source,"g");function Gee(e){return function(){return e}}function Yee(e){return function(t){return e(t)+""}}function Vee(e,t){var n=mw.lastIndex=yw.lastIndex=0,i,r,o,a=-1,s=[],u=[];for(e=e+"",t=t+"";(i=mw.exec(e))&&(r=yw.exec(t));)(o=r.index)>n&&(o=t.slice(n,o),s[a]?s[a]+=o:s[++a]=o),(i=i[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,u.push({i:a,x:pw(i,r)})),n=yw.lastIndex;return n<t.length&&(o=t.slice(n),s[a]?s[a]+=o:s[++a]=o),s.length<2?u[0]?Yee(u[0].x):Gee(t):(t=u.length,function(l){for(var c=0,f;c<t;++c)s[(f=u[c]).i]=f.x(l);return s.join("")})}function vw(e,t){var n=typeof t,i;return t==null||n==="boolean"?gw(t):(n==="number"?pw:n==="string"?(i=Xf(t))?(t=i,ZT):Vee:t instanceof Xf?ZT:t instanceof Date?Hee:Uee(t)?zee:Array.isArray(t)?qee:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Wee:pw)(e,t)}function Xee(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function QT(e){N.call(this,null,e)}q(QT,N,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,o=e.scale,a=e.count==null?e.values?e.values.length:10:e.count,s=i2(o,a,e.minstep),u=e.format||UM(n,o,s,e.formatSpecifier,e.formatType,!!e.values),l=e.values?zM(o,e.values,s):r2(o,s);return r&&(i.rem=r),r=l.map((c,f)=>Le({index:f/(l.length-1||1),value:c,label:u(c)})),e.extra&&r.length&&r.push(Le({index:-1,extra:{value:r[0].value},label:""})),i.source=r,i.add=r,this.value=r,i}});function e6(e){N.call(this,null,e)}function Kee(){return Le({})}function Jee(e){const t=Lu().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}q(e6,N,{transform(e,t){var n=t.dataflow,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.item||Kee,o=e.key||ee,a=this.value;return Q(i.encode)&&(i.encode=null),a&&(e.modified("key")||t.modified(o))&&I("DataJoin does not support modified key function or fields."),a||(t=t.addAll(),this.value=a=Jee(o)),t.visit(t.ADD,s=>{const u=o(s);let l=a.get(u);l?l.exit?(a.empty--,i.add.push(l)):i.mod.push(l):(l=r(s),a.set(u,l),i.add.push(l)),l.datum=s,l.exit=!1}),t.visit(t.MOD,s=>{const u=o(s),l=a.get(u);l&&(l.datum=s,i.mod.push(l))}),t.visit(t.REM,s=>{const u=o(s),l=a.get(u);s===l.datum&&!l.exit&&(i.rem.push(l),l.exit=!0,++a.empty)}),t.changed(t.ADD_MOD)&&i.modifies("datum"),(t.clean()||e.clean&&a.empty>n.cleanThreshold)&&n.runAfter(a.clean),i}});function t6(e){N.call(this,null,e)}q(t6,N,{transform(e,t){var n=t.fork(t.ADD_REM),i=e.mod||!1,r=e.encoders,o=t.encode;if(Q(o))if(n.changed()||o.every(f=>r[f]))o=o[0],n.encode=null;else return t.StopPropagation;var a=o==="enter",s=r.update||Jo,u=r.enter||Jo,l=r.exit||Jo,c=(o&&!a?r[o]:s)||Jo;if(t.changed(t.ADD)&&(t.visit(t.ADD,f=>{u(f,e),s(f,e)}),n.modifies(u.output),n.modifies(s.output),c!==Jo&&c!==s&&(t.visit(t.ADD,f=>{c(f,e)}),n.modifies(c.output))),t.changed(t.REM)&&l!==Jo&&(t.visit(t.REM,f=>{l(f,e)}),n.modifies(l.output)),a||c!==Jo){const f=t.MOD|(e.modified()?t.REFLOW:0);a?(t.visit(f,d=>{const h=u(d,e)||i;(c(d,e)||h)&&n.mod.push(d)}),n.mod.length&&n.modifies(u.output)):t.visit(f,d=>{(c(d,e)||i)&&n.mod.push(d)}),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}});function n6(e){N.call(this,[],e)}q(n6,N,{transform(e,t){if(this.value!=null&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,o=e.type||xg,a=e.scale,s=+e.limit,u=i2(a,e.count==null?5:e.count,e.minstep),l=!!e.values||o===xg,c=e.format||GM(n,a,u,o,e.formatSpecifier,e.formatType,l),f=e.values||WM(a,u),d,h,g,p,m;return r&&(i.rem=r),o===xg?(s&&f.length>s?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),r=f.slice(0,s-1),m=!0):r=f,me(g=e.size)?(!e.values&&a(r[0])===0&&(r=r.slice(1)),p=r.reduce((y,v)=>Math.max(y,g(v,e)),0)):g=Jt(p=g||8),r=r.map((y,v)=>Le({index:v,label:c(y,v,r),value:y,offset:p,size:g(y,e)})),m&&(m=f[r.length],r.push(Le({index:r.length,label:"\u2026".concat(f.length-r.length," entries"),value:m,offset:p,size:g(m,e)})))):o===oJ?(d=a.domain(),h=LM(a,d[0],Ee(d)),f.length<3&&!e.values&&d[0]!==Ee(d)&&(f=[d[0],Ee(d)]),r=f.map((y,v)=>Le({index:v,label:c(y,v,f),value:y,perc:h(y)}))):(g=f.length-1,h=mJ(a),r=f.map((y,v)=>Le({index:v,label:c(y,v,f),value:y,perc:v?h(y):0,perc2:v===g?1:h(f[v+1])}))),i.source=r,i.add=r,this.value=r,i}});const Zee=e=>e.source.x,Qee=e=>e.source.y,ete=e=>e.target.x,tte=e=>e.target.y;function bw(e){N.call(this,{},e)}bw.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};q(bw,N,{transform(e,t){var n=e.sourceX||Zee,i=e.sourceY||Qee,r=e.targetX||ete,o=e.targetY||tte,a=e.as||"path",s=e.orient||"vertical",u=e.shape||"line",l=a6.get(u+"-"+s)||a6.get(u);return l||I("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,c=>{c[a]=l(n(c),i(c),r(c),o(c))}),t.reflow(e.modified()).modifies(a)}});const i6=(e,t,n,i)=>"M"+e+","+t+"L"+n+","+i,nte=(e,t,n,i)=>i6(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),r6=(e,t,n,i)=>{var r=n-e,o=i-t,a=Math.sqrt(r*r+o*o)/2,s=180*Math.atan2(o,r)/Math.PI;return"M"+e+","+t+"A"+a+","+a+" "+s+" 0 1 "+n+","+i},ite=(e,t,n,i)=>r6(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),o6=(e,t,n,i)=>{const r=n-e,o=i-t,a=.2*(r+o),s=.2*(o-r);return"M"+e+","+t+"C"+(e+a)+","+(t+s)+" "+(n+s)+","+(i-a)+" "+n+","+i},rte=(e,t,n,i)=>o6(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),ote=(e,t,n,i)=>"M"+e+","+t+"V"+i+"H"+n,ate=(e,t,n,i)=>"M"+e+","+t+"H"+n+"V"+i,ste=(e,t,n,i)=>{const r=Math.cos(e),o=Math.sin(e),a=Math.cos(n),s=Math.sin(n),u=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*r+","+t*o+"A"+t+","+t+" 0 0,"+(u?1:0)+" "+t*a+","+t*s+"L"+i*a+","+i*s},ute=(e,t,n,i)=>{const r=(e+n)/2;return"M"+e+","+t+"C"+r+","+t+" "+r+","+i+" "+n+","+i},lte=(e,t,n,i)=>{const r=(t+i)/2;return"M"+e+","+t+"C"+e+","+r+" "+n+","+r+" "+n+","+i},cte=(e,t,n,i)=>{const r=Math.cos(e),o=Math.sin(e),a=Math.cos(n),s=Math.sin(n),u=(t+i)/2;return"M"+t*r+","+t*o+"C"+u*r+","+u*o+" "+u*a+","+u*s+" "+i*a+","+i*s},a6=Lu({line:i6,"line-radial":nte,arc:r6,"arc-radial":ite,curve:o6,"curve-radial":rte,"orthogonal-horizontal":ote,"orthogonal-vertical":ate,"orthogonal-radial":ste,"diagonal-horizontal":ute,"diagonal-vertical":lte,"diagonal-radial":cte});function xw(e){N.call(this,null,e)}xw.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]};q(xw,N,{transform(e,t){var n=e.as||["startAngle","endAngle"],i=n[0],r=n[1],o=e.field||ju,a=e.startAngle||0,s=e.endAngle!=null?e.endAngle:2*Math.PI,u=t.source,l=u.map(o),c=l.length,f=a,d=(s-a)/Oee(l),h=zT(c),g,p,m;for(e.sort&&h.sort((y,v)=>l[y]-l[v]),g=0;g<c;++g)m=l[h[g]],p=u[h[g]],p[i]=f,p[r]=f+=m*d;return this.value=l,t.reflow(e.modified()).modifies(n)}});const fte=5;function dte(e){const t=e.type;return!e.bins&&(t===il||t===_f||t===Af)}function s6(e){return Qx(e)&&e!==Sr}const hte=Hi(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function u6(e){N.call(this,null,e),this.modified(!0)}q(u6,N,{transform(e,t){var n=t.dataflow,i=this.value,r=gte(e);(!i||r!==i.type)&&(this.value=i=Ne(r)());for(r in e)if(!hte[r]){if(r==="padding"&&s6(i.type))continue;me(i[r])?i[r](e[r]):n.warn("Unsupported scale property: "+r)}return xte(i,e,bte(i,e,mte(i,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function gte(e){var t=e.type,n="",i;return t===Sr?Sr+"-"+il:(pte(e)&&(i=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0,n=i===2?Sr+"-":i===3?rl+"-":""),(n+t||il).toLowerCase())}function pte(e){const t=e.type;return Qx(t)&&t!==Os&&t!==Cs&&(e.scheme||e.range&&e.range.length&&e.range.every(Fe))}function mte(e,t,n){const i=yte(e,t.domainRaw,n);if(i>-1)return i;var r=t.domain,o=e.type,a=t.zero||t.zero===void 0&&dte(e),s,u;if(!r)return 0;if(s6(o)&&t.padding&&r[0]!==Ee(r)&&(r=vte(o,r,t.range,t.padding,t.exponent,t.constant)),(a||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null)&&(s=(r=r.slice()).length-1||1,a&&(r[0]>0&&(r[0]=0),r[s]<0&&(r[s]=0)),t.domainMin!=null&&(r[0]=t.domainMin),t.domainMax!=null&&(r[s]=t.domainMax),t.domainMid!=null)){u=t.domainMid;const l=u>r[s]?s+1:u<r[0]?0:s;l!==s&&n.warn("Scale domainMid exceeds domain min or max.",u),r.splice(l,0,u)}return e.domain(l6(o,r,n)),o===Vx&&e.unknown(t.domainImplicit?ix:void 0),t.nice&&e.nice&&e.nice(t.nice!==!0&&i2(e,t.nice)||null),r.length}function yte(e,t,n){return t?(e.domain(l6(e.type,t,n)),t.length):-1}function vte(e,t,n,i,r,o){var a=Math.abs(Ee(n)-n[0]),s=a/(a-2*i),u=e===vo?Qy(t,null,s):e===Af?y0(t,null,s,.5):e===_f?y0(t,null,s,r||1):e===pg?ev(t,null,s,o||1):Zy(t,null,s);return t=t.slice(),t[0]=u[0],t[t.length-1]=u[1],t}function l6(e,t,n){if(MM(e)){var i=Math.abs(t.reduce((r,o)=>r+(o<0?-1:o>0?1:0),0));i!==t.length&&n.warn("Log scale domain includes zero: "+ne(t))}return t}function bte(e,t,n){let i=t.bins;if(i&&!Q(i)){const r=e.domain(),o=r[0],a=Ee(r),s=i.step;let u=i.start==null?o:i.start,l=i.stop==null?a:i.stop;s||I("Scale bins parameter missing step property."),u<o&&(u=s*Math.ceil(o/s)),l>a&&(l=s*Math.floor(a/s)),i=zT(u,l+s/2,s)}return i?e.bins=i:e.bins&&delete e.bins,e.type===Kx&&(i?!t.domain&&!t.domainRaw&&(e.domain(i),n=i.length):e.bins=e.domain()),n}function xte(e,t,n){var i=e.type,r=t.round||!1,o=t.range;if(t.rangeStep!=null)o=wte(i,t,n);else if(t.scheme&&(o=Ete(i,t,n),me(o))){if(e.interpolator)return e.interpolator(o);I("Scale type ".concat(i," does not support interpolating color schemes."))}if(o&&TM(i))return e.interpolator(bg(ww(o,t.reverse),t.interpolate,t.interpolateGamma));o&&t.interpolate&&e.interpolate?e.interpolate(t2(t.interpolate,t.interpolateGamma)):me(e.round)?e.round(r):me(e.rangeRound)&&e.interpolate(r?Xee:vw),o&&e.range(ww(o,t.reverse))}function wte(e,t,n){e!==CM&&e!==Xx&&I("Only band and point scales support rangeStep.");var i=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,r=e===Xx?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*Yx(n,r,i)]}function Ete(e,t,n){var i=t.schemeExtent,r,o;return Q(t.scheme)?o=bg(t.scheme,t.interpolate,t.interpolateGamma):(r=t.scheme.toLowerCase(),o=n2(r),o||I("Unrecognized scheme name: ".concat(t.scheme))),n=e===yg?n+1:e===Kx?n-1:e===ol||e===mg?+t.schemeCount||fte:n,TM(e)?c6(o,i,t.reverse):me(o)?jM(c6(o,i),n):e===Vx?o:o.slice(0,n)}function c6(e,t,n){return me(e)&&(t||n)?RM(e,ww(t||[0,1],n)):e}function ww(e,t){return t?e.slice().reverse():e}function f6(e){N.call(this,null,e)}q(f6,N,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(hs(e.sort)),this.modified(n),t}});const d6="zero",h6="center",g6="normalize",p6=["y0","y1"];function Ew(e){N.call(this,null,e)}Ew.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:d6,values:[d6,h6,g6]},{name:"as",type:"string",array:!0,length:2,default:p6}]};q(Ew,N,{transform(e,t){var n=e.as||p6,i=n[0],r=n[1],o=hs(e.sort),a=e.field||ju,s=e.offset===h6?_te:e.offset===g6?Ate:$te,u,l,c,f;for(u=Ste(t.source,e.groupby,o,a),l=0,c=u.length,f=u.max;l<c;++l)s(u[l],f,a,i,r);return t.reflow(e.modified()).modifies(n)}});function _te(e,t,n,i,r){for(var o=(t-e.sum)/2,a=e.length,s=0,u;s<a;++s)u=e[s],u[i]=o,u[r]=o+=Math.abs(n(u))}function Ate(e,t,n,i,r){for(var o=1/e.sum,a=0,s=e.length,u=0,l=0,c;u<s;++u)c=e[u],c[i]=a,c[r]=a=o*(l+=Math.abs(n(c)))}function $te(e,t,n,i,r){for(var o=0,a=0,s=e.length,u=0,l,c;u<s;++u)c=e[u],l=+n(c),l<0?(c[i]=a,c[r]=a+=l):(c[i]=o,c[r]=o+=l)}function Ste(e,t,n,i){var r=[],o=p=>p(c),a,s,u,l,c,f,d,h,g;if(t==null)r.push(e.slice());else for(a={},s=0,u=e.length;s<u;++s)c=e[s],f=t.map(o),d=a[f],d||(a[f]=d=[],r.push(d)),d.push(c);for(f=0,g=0,l=r.length;f<l;++f){for(d=r[f],s=0,h=0,u=d.length;s<u;++s)h+=Math.abs(i(d[s]));d.sum=h,h>g&&(g=h),n&&d.sort(n)}return r.max=g,r}var Ote=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",axisticks:QT,datajoin:e6,encode:t6,legendentries:n6,linkpath:bw,pie:xw,scale:u6,sortitems:f6,stack:Ew}),Cte=Math.sqrt(50),Fte=Math.sqrt(10),kte=Math.sqrt(2);function Dte(e,t,n){var i=Math.abs(t-e)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),o=i/r;return o>=Cte?r*=10:o>=Fte?r*=5:o>=kte&&(r*=2),t<e?-r:r}function np(e,t){let n;if(t===void 0)for(const i of e)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of e)(r=t(r,++i,e))!=null&&(n<r||n===void 0&&r>=r)&&(n=r)}return n}function Rs(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(r);++i<r;)o[i]=e+i*n;return o}function Mte(e,t){let n=0;if(t===void 0)for(let i of e)(i=+i)&&(n+=i);else{let i=-1;for(let r of e)(r=+t(r,++i,e))&&(n+=r)}return n}class js{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const o=n[r],a=t+o,s=Math.abs(t)<Math.abs(o)?t-(a-o):o-(a-t);s&&(n[i++]=s),t=a}return n[i]=t,this._n=i+1,this}valueOf(){const t=this._partials;let n=this._n,i,r,o,a=0;if(n>0){for(a=t[--n];n>0&&(i=a,r=t[--n],a=i+r,o=r-(a-i),!o););n>0&&(o<0&&t[n-1]<0||o>0&&t[n-1]>0)&&(r=o*2,i=a+r,r==i-a&&(a=i))}return a}}function*Tte(e){for(const t of e)yield*t}function m6(e){return Array.from(Tte(e))}var pe=1e-6,y6=1e-12,be=Math.PI,lt=be/2,v6=be/4,ui=be*2,on=180/be,rt=be/180,ze=Math.abs,vl=Math.atan,Eo=Math.atan2,ve=Math.cos,b6=Math.exp,ip=Math.log,_w=Math.pow,ce=Math.sin,Si=Math.sign||function(e){return e>0?1:e<0?-1:0},qn=Math.sqrt,Aw=Math.tan;function x6(e){return e>1?0:e<-1?be:Math.acos(e)}function Oi(e){return e>1?lt:e<-1?-lt:Math.asin(e)}function Ci(){}function rp(e,t){e&&E6.hasOwnProperty(e.type)&&E6[e.type](e,t)}var w6={Feature:function(e,t){rp(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,i=-1,r=n.length;++i<r;)rp(n[i].geometry,t)}},E6={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)e=n[i],t.point(e[0],e[1],e[2])},LineString:function(e,t){$w(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)$w(n[i],t,0)},Polygon:function(e,t){_6(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)_6(n[i],t)},GeometryCollection:function(e,t){for(var n=e.geometries,i=-1,r=n.length;++i<r;)rp(n[i],t)}};function $w(e,t,n){var i=-1,r=e.length-n,o;for(t.lineStart();++i<r;)o=e[i],t.point(o[0],o[1],o[2]);t.lineEnd()}function _6(e,t){var n=-1,i=e.length;for(t.polygonStart();++n<i;)$w(e[n],t,1);t.polygonEnd()}function bl(e,t){e&&w6.hasOwnProperty(e.type)?w6[e.type](e,t):rp(e,t)}function Sw(e){return[Eo(e[1],e[0]),Oi(e[2])]}function xl(e){var t=e[0],n=e[1],i=ve(n);return[i*ve(t),i*ce(t),ce(n)]}function op(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function ap(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Ow(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function sp(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Cw(e){var t=qn(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function Fw(e,t){function n(i,r){return i=e(i,r),t(i[0],i[1])}return e.invert&&t.invert&&(n.invert=function(i,r){return i=t.invert(i,r),i&&e.invert(i[0],i[1])}),n}function kw(e,t){return[ze(e)>be?e+Math.round(-e/ui)*ui:e,t]}kw.invert=kw;function A6(e,t,n){return(e%=ui)?t||n?Fw(S6(e),O6(t,n)):S6(e):t||n?O6(t,n):kw}function $6(e){return function(t,n){return t+=e,[t>be?t-ui:t<-be?t+ui:t,n]}}function S6(e){var t=$6(e);return t.invert=$6(-e),t}function O6(e,t){var n=ve(e),i=ce(e),r=ve(t),o=ce(t);function a(s,u){var l=ve(u),c=ve(s)*l,f=ce(s)*l,d=ce(u),h=d*n+c*i;return[Eo(f*r-h*o,c*n-d*i),Oi(h*r+f*o)]}return a.invert=function(s,u){var l=ve(u),c=ve(s)*l,f=ce(s)*l,d=ce(u),h=d*r-f*o;return[Eo(f*r+d*o,c*n+h*i),Oi(h*n-c*i)]},a}function Nte(e){e=A6(e[0]*rt,e[1]*rt,e.length>2?e[2]*rt:0);function t(n){return n=e(n[0]*rt,n[1]*rt),n[0]*=on,n[1]*=on,n}return t.invert=function(n){return n=e.invert(n[0]*rt,n[1]*rt),n[0]*=on,n[1]*=on,n},t}function Rte(e,t,n,i,r,o){if(!!n){var a=ve(t),s=ce(t),u=i*n;r==null?(r=t+i*ui,o=t-u/2):(r=C6(a,r),o=C6(a,o),(i>0?r<o:r>o)&&(r+=i*ui));for(var l,c=r;i>0?c>o:c<o;c-=u)l=Sw([a,-s*ve(c),-s*ce(c)]),e.point(l[0],l[1])}}function C6(e,t){t=xl(t),t[0]-=e,Cw(t);var n=x6(-t[1]);return((-t[2]<0?-n:n)+ui-pe)%ui}function F6(){var e=[],t;return{point:function(n,i,r){t.push([n,i,r])},lineStart:function(){e.push(t=[])},lineEnd:Ci,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function up(e,t){return ze(e[0]-t[0])<pe&&ze(e[1]-t[1])<pe}function lp(e,t,n,i){this.x=e,this.z=t,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function k6(e,t,n,i,r){var o=[],a=[],s,u;if(e.forEach(function(g){if(!((p=g.length-1)<=0)){var p,m=g[0],y=g[p],v;if(up(m,y)){if(!m[2]&&!y[2]){for(r.lineStart(),s=0;s<p;++s)r.point((m=g[s])[0],m[1]);r.lineEnd();return}y[0]+=2*pe}o.push(v=new lp(m,g,null,!0)),a.push(v.o=new lp(m,null,v,!1)),o.push(v=new lp(y,g,null,!1)),a.push(v.o=new lp(y,null,v,!0))}}),!!o.length){for(a.sort(t),D6(o),D6(a),s=0,u=a.length;s<u;++s)a[s].e=n=!n;for(var l=o[0],c,f;;){for(var d=l,h=!0;d.v;)if((d=d.n)===l)return;c=d.z,r.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(s=0,u=c.length;s<u;++s)r.point((f=c[s])[0],f[1]);else i(d.x,d.n.x,1,r);d=d.n}else{if(h)for(c=d.p.z,s=c.length-1;s>=0;--s)r.point((f=c[s])[0],f[1]);else i(d.x,d.p.x,-1,r);d=d.p}d=d.o,c=d.z,h=!h}while(!d.v);r.lineEnd()}}}function D6(e){if(!!(t=e.length)){for(var t,n=0,i=e[0],r;++n<t;)i.n=r=e[n],r.p=i,i=r;i.n=r=e[0],r.p=i}}function Dw(e){return ze(e[0])<=be?e[0]:Si(e[0])*((ze(e[0])+be)%ui-be)}function jte(e,t){var n=Dw(t),i=t[1],r=ce(i),o=[ce(n),-ve(n),0],a=0,s=0,u=new js;r===1?i=lt+pe:r===-1&&(i=-lt-pe);for(var l=0,c=e.length;l<c;++l)if(!!(d=(f=e[l]).length))for(var f,d,h=f[d-1],g=Dw(h),p=h[1]/2+v6,m=ce(p),y=ve(p),v=0;v<d;++v,g=x,m=_,y=E,h=b){var b=f[v],x=Dw(b),w=b[1]/2+v6,_=ce(w),E=ve(w),$=x-g,O=$>=0?1:-1,C=O*$,A=C>be,D=m*_;if(u.add(Eo(D*O*ce(C),y*E+D*ve(C))),a+=A?$+O*ui:$,A^g>=n^x>=n){var F=ap(xl(h),xl(b));Cw(F);var T=ap(o,F);Cw(T);var S=(A^$>=0?-1:1)*Oi(T[2]);(i>S||i===S&&(F[0]||F[1]))&&(s+=A^$>=0?1:-1)}}return(a<-pe||a<pe&&u<-y6)^s&1}function M6(e,t,n,i){return function(r){var o=t(r),a=F6(),s=t(a),u=!1,l,c,f,d={point:h,lineStart:p,lineEnd:m,polygonStart:function(){d.point=y,d.lineStart=v,d.lineEnd=b,c=[],l=[]},polygonEnd:function(){d.point=h,d.lineStart=p,d.lineEnd=m,c=m6(c);var x=jte(l,i);c.length?(u||(r.polygonStart(),u=!0),k6(c,Pte,x,n,r)):x&&(u||(r.polygonStart(),u=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),u&&(r.polygonEnd(),u=!1),c=l=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function h(x,w){e(x,w)&&r.point(x,w)}function g(x,w){o.point(x,w)}function p(){d.point=g,o.lineStart()}function m(){d.point=h,o.lineEnd()}function y(x,w){f.push([x,w]),s.point(x,w)}function v(){s.lineStart(),f=[]}function b(){y(f[0][0],f[0][1]),s.lineEnd();var x=s.clean(),w=a.result(),_,E=w.length,$,O,C;if(f.pop(),l.push(f),f=null,!!E){if(x&1){if(O=w[0],($=O.length-1)>0){for(u||(r.polygonStart(),u=!0),r.lineStart(),_=0;_<$;++_)r.point((C=O[_])[0],C[1]);r.lineEnd()}return}E>1&&x&2&&w.push(w.pop().concat(w.shift())),c.push(w.filter(Lte))}}return d}}function Lte(e){return e.length>1}function Pte(e,t){return((e=e.x)[0]<0?e[1]-lt-pe:lt-e[1])-((t=t.x)[0]<0?t[1]-lt-pe:lt-t[1])}var T6=M6(function(){return!0},Ite,zte,[-be,-lt]);function Ite(e){var t=NaN,n=NaN,i=NaN,r;return{lineStart:function(){e.lineStart(),r=1},point:function(o,a){var s=o>0?be:-be,u=ze(o-t);ze(u-be)<pe?(e.point(t,n=(n+a)/2>0?lt:-lt),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(s,n),e.point(o,n),r=0):i!==s&&u>=be&&(ze(t-i)<pe&&(t-=i*pe),ze(o-s)<pe&&(o-=s*pe),n=Bte(t,n,o,a),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(s,n),r=0),e.point(t=o,n=a),i=s},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-r}}}function Bte(e,t,n,i){var r,o,a=ce(e-n);return ze(a)>pe?vl((ce(t)*(o=ve(i))*ce(n)-ce(i)*(r=ve(t))*ce(e))/(r*o*a)):(t+i)/2}function zte(e,t,n,i){var r;if(e==null)r=n*lt,i.point(-be,r),i.point(0,r),i.point(be,r),i.point(be,0),i.point(be,-r),i.point(0,-r),i.point(-be,-r),i.point(-be,0),i.point(-be,r);else if(ze(e[0]-t[0])>pe){var o=e[0]<t[0]?be:-be;r=n*o/2,i.point(-o,r),i.point(0,r),i.point(o,r)}else i.point(t[0],t[1])}function Ute(e){var t=ve(e),n=6*rt,i=t>0,r=ze(t)>pe;function o(c,f,d,h){Rte(h,e,n,d,c,f)}function a(c,f){return ve(c)*ve(f)>t}function s(c){var f,d,h,g,p;return{lineStart:function(){g=h=!1,p=1},point:function(m,y){var v=[m,y],b,x=a(m,y),w=i?x?0:l(m,y):x?l(m+(m<0?be:-be),y):0;if(!f&&(g=h=x)&&c.lineStart(),x!==h&&(b=u(f,v),(!b||up(f,b)||up(v,b))&&(v[2]=1)),x!==h)p=0,x?(c.lineStart(),b=u(v,f),c.point(b[0],b[1])):(b=u(f,v),c.point(b[0],b[1],2),c.lineEnd()),f=b;else if(r&&f&&i^x){var _;!(w&d)&&(_=u(v,f,!0))&&(p=0,i?(c.lineStart(),c.point(_[0][0],_[0][1]),c.point(_[1][0],_[1][1]),c.lineEnd()):(c.point(_[1][0],_[1][1]),c.lineEnd(),c.lineStart(),c.point(_[0][0],_[0][1],3)))}x&&(!f||!up(f,v))&&c.point(v[0],v[1]),f=v,h=x,d=w},lineEnd:function(){h&&c.lineEnd(),f=null},clean:function(){return p|(g&&h)<<1}}}function u(c,f,d){var h=xl(c),g=xl(f),p=[1,0,0],m=ap(h,g),y=op(m,m),v=m[0],b=y-v*v;if(!b)return!d&&c;var x=t*y/b,w=-t*v/b,_=ap(p,m),E=sp(p,x),$=sp(m,w);Ow(E,$);var O=_,C=op(E,O),A=op(O,O),D=C*C-A*(op(E,E)-1);if(!(D<0)){var F=qn(D),T=sp(O,(-C-F)/A);if(Ow(T,E),T=Sw(T),!d)return T;var S=c[0],M=f[0],P=c[1],B=f[1],H;M<S&&(H=S,S=M,M=H);var re=M-S,le=ze(re-be)<pe,he=le||re<pe;if(!le&&B<P&&(H=P,P=B,B=H),he?le?P+B>0^T[1]<(ze(T[0]-S)<pe?P:B):P<=T[1]&&T[1]<=B:re>be^(S<=T[0]&&T[0]<=M)){var Ae=sp(O,(-C+F)/A);return Ow(Ae,E),[T,Sw(Ae)]}}}function l(c,f){var d=i?e:be-e,h=0;return c<-d?h|=1:c>d&&(h|=2),f<-d?h|=4:f>d&&(h|=8),h}return M6(a,s,o,i?[0,-e]:[-be,e-be])}function qte(e,t,n,i,r,o){var a=e[0],s=e[1],u=t[0],l=t[1],c=0,f=1,d=u-a,h=l-s,g;if(g=n-a,!(!d&&g>0)){if(g/=d,d<0){if(g<c)return;g<f&&(f=g)}else if(d>0){if(g>f)return;g>c&&(c=g)}if(g=r-a,!(!d&&g<0)){if(g/=d,d<0){if(g>f)return;g>c&&(c=g)}else if(d>0){if(g<c)return;g<f&&(f=g)}if(g=i-s,!(!h&&g>0)){if(g/=h,h<0){if(g<c)return;g<f&&(f=g)}else if(h>0){if(g>f)return;g>c&&(c=g)}if(g=o-s,!(!h&&g<0)){if(g/=h,h<0){if(g>f)return;g>c&&(c=g)}else if(h>0){if(g<c)return;g<f&&(f=g)}return c>0&&(e[0]=a+c*d,e[1]=s+c*h),f<1&&(t[0]=a+f*d,t[1]=s+f*h),!0}}}}}var Kf=1e9,cp=-Kf;function N6(e,t,n,i){function r(l,c){return e<=l&&l<=n&&t<=c&&c<=i}function o(l,c,f,d){var h=0,g=0;if(l==null||(h=a(l,f))!==(g=a(c,f))||u(l,c)<0^f>0)do d.point(h===0||h===3?e:n,h>1?i:t);while((h=(h+f+4)%4)!==g);else d.point(c[0],c[1])}function a(l,c){return ze(l[0]-e)<pe?c>0?0:3:ze(l[0]-n)<pe?c>0?2:1:ze(l[1]-t)<pe?c>0?1:0:c>0?3:2}function s(l,c){return u(l.x,c.x)}function u(l,c){var f=a(l,1),d=a(c,1);return f!==d?f-d:f===0?c[1]-l[1]:f===1?l[0]-c[0]:f===2?l[1]-c[1]:c[0]-l[0]}return function(l){var c=l,f=F6(),d,h,g,p,m,y,v,b,x,w,_,E={point:$,lineStart:D,lineEnd:F,polygonStart:C,polygonEnd:A};function $(S,M){r(S,M)&&c.point(S,M)}function O(){for(var S=0,M=0,P=h.length;M<P;++M)for(var B=h[M],H=1,re=B.length,le=B[0],he,Ae,$e=le[0],Pe=le[1];H<re;++H)he=$e,Ae=Pe,le=B[H],$e=le[0],Pe=le[1],Ae<=i?Pe>i&&($e-he)*(i-Ae)>(Pe-Ae)*(e-he)&&++S:Pe<=i&&($e-he)*(i-Ae)<(Pe-Ae)*(e-he)&&--S;return S}function C(){c=f,d=[],h=[],_=!0}function A(){var S=O(),M=_&&S,P=(d=m6(d)).length;(M||P)&&(l.polygonStart(),M&&(l.lineStart(),o(null,null,1,l),l.lineEnd()),P&&k6(d,s,S,o,l),l.polygonEnd()),c=l,d=h=g=null}function D(){E.point=T,h&&h.push(g=[]),w=!0,x=!1,v=b=NaN}function F(){d&&(T(p,m),y&&x&&f.rejoin(),d.push(f.result())),E.point=$,x&&c.lineEnd()}function T(S,M){var P=r(S,M);if(h&&g.push([S,M]),w)p=S,m=M,y=P,w=!1,P&&(c.lineStart(),c.point(S,M));else if(P&&x)c.point(S,M);else{var B=[v=Math.max(cp,Math.min(Kf,v)),b=Math.max(cp,Math.min(Kf,b))],H=[S=Math.max(cp,Math.min(Kf,S)),M=Math.max(cp,Math.min(Kf,M))];qte(B,H,e,t,n,i)?(x||(c.lineStart(),c.point(B[0],B[1])),c.point(H[0],H[1]),P||c.lineEnd(),_=!1):P&&(c.lineStart(),c.point(S,M),_=!1)}v=S,b=M,x=P}return E}}var Jf=e=>e,Mw=new js,Tw=new js,R6,j6,Nw,Rw,_a={point:Ci,lineStart:Ci,lineEnd:Ci,polygonStart:function(){_a.lineStart=Hte,_a.lineEnd=Gte},polygonEnd:function(){_a.lineStart=_a.lineEnd=_a.point=Ci,Mw.add(ze(Tw)),Tw=new js},result:function(){var e=Mw/2;return Mw=new js,e}};function Hte(){_a.point=Wte}function Wte(e,t){_a.point=L6,R6=Nw=e,j6=Rw=t}function L6(e,t){Tw.add(Rw*e-Nw*t),Nw=e,Rw=t}function Gte(){L6(R6,j6)}var P6=_a,wl=1/0,fp=wl,Zf=-wl,dp=Zf,Yte={point:Vte,lineStart:Ci,lineEnd:Ci,polygonStart:Ci,polygonEnd:Ci,result:function(){var e=[[wl,fp],[Zf,dp]];return Zf=dp=-(fp=wl=1/0),e}};function Vte(e,t){e<wl&&(wl=e),e>Zf&&(Zf=e),t<fp&&(fp=t),t>dp&&(dp=t)}var hp=Yte,jw=0,Lw=0,Qf=0,gp=0,pp=0,El=0,Pw=0,Iw=0,ed=0,I6,B6,Nr,Rr,Zi={point:Ls,lineStart:z6,lineEnd:U6,polygonStart:function(){Zi.lineStart=Jte,Zi.lineEnd=Zte},polygonEnd:function(){Zi.point=Ls,Zi.lineStart=z6,Zi.lineEnd=U6},result:function(){var e=ed?[Pw/ed,Iw/ed]:El?[gp/El,pp/El]:Qf?[jw/Qf,Lw/Qf]:[NaN,NaN];return jw=Lw=Qf=gp=pp=El=Pw=Iw=ed=0,e}};function Ls(e,t){jw+=e,Lw+=t,++Qf}function z6(){Zi.point=Xte}function Xte(e,t){Zi.point=Kte,Ls(Nr=e,Rr=t)}function Kte(e,t){var n=e-Nr,i=t-Rr,r=qn(n*n+i*i);gp+=r*(Nr+e)/2,pp+=r*(Rr+t)/2,El+=r,Ls(Nr=e,Rr=t)}function U6(){Zi.point=Ls}function Jte(){Zi.point=Qte}function Zte(){q6(I6,B6)}function Qte(e,t){Zi.point=q6,Ls(I6=Nr=e,B6=Rr=t)}function q6(e,t){var n=e-Nr,i=t-Rr,r=qn(n*n+i*i);gp+=r*(Nr+e)/2,pp+=r*(Rr+t)/2,El+=r,r=Rr*e-Nr*t,Pw+=r*(Nr+e),Iw+=r*(Rr+t),ed+=r*3,Ls(Nr=e,Rr=t)}var H6=Zi;function W6(e){this._context=e}W6.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,ui);break}}},result:Ci};var Bw=new js,zw,G6,Y6,td,nd,mp={point:Ci,lineStart:function(){mp.point=ene},lineEnd:function(){zw&&V6(G6,Y6),mp.point=Ci},polygonStart:function(){zw=!0},polygonEnd:function(){zw=null},result:function(){var e=+Bw;return Bw=new js,e}};function ene(e,t){mp.point=V6,G6=td=e,Y6=nd=t}function V6(e,t){td-=e,nd-=t,Bw.add(qn(td*td+nd*nd)),td=e,nd=t}var X6=mp;function K6(){this._string=[]}K6.prototype={_radius:4.5,_circle:J6(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._string.push("M",e,",",t),this._point=1;break}case 1:{this._string.push("L",e,",",t);break}default:{this._circle==null&&(this._circle=J6(this._radius)),this._string.push("M",e,",",t,this._circle);break}}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}else return null}};function J6(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function Z6(e,t){var n=4.5,i,r;function o(a){return a&&(typeof n=="function"&&r.pointRadius(+n.apply(this,arguments)),bl(a,i(r))),r.result()}return o.area=function(a){return bl(a,i(P6)),P6.result()},o.measure=function(a){return bl(a,i(X6)),X6.result()},o.bounds=function(a){return bl(a,i(hp)),hp.result()},o.centroid=function(a){return bl(a,i(H6)),H6.result()},o.projection=function(a){return arguments.length?(i=a==null?(e=null,Jf):(e=a).stream,o):e},o.context=function(a){return arguments.length?(r=a==null?(t=null,new K6):new W6(t=a),typeof n!="function"&&r.pointRadius(n),o):t},o.pointRadius=function(a){return arguments.length?(n=typeof a=="function"?a:(r.pointRadius(+a),+a),o):n},o.projection(e).context(t)}function yp(e){return function(t){var n=new Uw;for(var i in e)n[i]=e[i];return n.stream=t,n}}function Uw(){}Uw.prototype={constructor:Uw,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function qw(e,t,n){var i=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),i!=null&&e.clipExtent(null),bl(n,e.stream(hp)),t(hp.result()),i!=null&&e.clipExtent(i),e}function vp(e,t,n){return qw(e,function(i){var r=t[1][0]-t[0][0],o=t[1][1]-t[0][1],a=Math.min(r/(i[1][0]-i[0][0]),o/(i[1][1]-i[0][1])),s=+t[0][0]+(r-a*(i[1][0]+i[0][0]))/2,u=+t[0][1]+(o-a*(i[1][1]+i[0][1]))/2;e.scale(150*a).translate([s,u])},n)}function Hw(e,t,n){return vp(e,[[0,0],t],n)}function Ww(e,t,n){return qw(e,function(i){var r=+t,o=r/(i[1][0]-i[0][0]),a=(r-o*(i[1][0]+i[0][0]))/2,s=-o*i[0][1];e.scale(150*o).translate([a,s])},n)}function Gw(e,t,n){return qw(e,function(i){var r=+t,o=r/(i[1][1]-i[0][1]),a=-o*i[0][0],s=(r-o*(i[1][1]+i[0][1]))/2;e.scale(150*o).translate([a,s])},n)}var Q6=16,tne=ve(30*rt);function e8(e,t){return+t?ine(e,t):nne(e)}function nne(e){return yp({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function ine(e,t){function n(i,r,o,a,s,u,l,c,f,d,h,g,p,m){var y=l-i,v=c-r,b=y*y+v*v;if(b>4*t&&p--){var x=a+d,w=s+h,_=u+g,E=qn(x*x+w*w+_*_),$=Oi(_/=E),O=ze(ze(_)-1)<pe||ze(o-f)<pe?(o+f)/2:Eo(w,x),C=e(O,$),A=C[0],D=C[1],F=A-i,T=D-r,S=v*F-y*T;(S*S/b>t||ze((y*F+v*T)/b-.5)>.3||a*d+s*h+u*g<tne)&&(n(i,r,o,a,s,u,A,D,O,x/=E,w/=E,_,p,m),m.point(A,D),n(A,D,O,x,w,_,l,c,f,d,h,g,p,m))}}return function(i){var r,o,a,s,u,l,c,f,d,h,g,p,m={point:y,lineStart:v,lineEnd:x,polygonStart:function(){i.polygonStart(),m.lineStart=w},polygonEnd:function(){i.polygonEnd(),m.lineStart=v}};function y($,O){$=e($,O),i.point($[0],$[1])}function v(){f=NaN,m.point=b,i.lineStart()}function b($,O){var C=xl([$,O]),A=e($,O);n(f,d,c,h,g,p,f=A[0],d=A[1],c=$,h=C[0],g=C[1],p=C[2],Q6,i),i.point(f,d)}function x(){m.point=y,i.lineEnd()}function w(){v(),m.point=_,m.lineEnd=E}function _($,O){b(r=$,O),o=f,a=d,s=h,u=g,l=p,m.point=b}function E(){n(f,d,c,h,g,p,o,a,r,s,u,l,Q6,i),m.lineEnd=x,x()}return m}}var rne=yp({point:function(e,t){this.stream.point(e*rt,t*rt)}});function one(e){return yp({point:function(t,n){var i=e(t,n);return this.stream.point(i[0],i[1])}})}function ane(e,t,n,i,r){function o(a,s){return a*=i,s*=r,[t+e*a,n-e*s]}return o.invert=function(a,s){return[(a-t)/e*i,(n-s)/e*r]},o}function t8(e,t,n,i,r,o){if(!o)return ane(e,t,n,i,r);var a=ve(o),s=ce(o),u=a*e,l=s*e,c=a/e,f=s/e,d=(s*n-a*t)/e,h=(s*t+a*n)/e;function g(p,m){return p*=i,m*=r,[u*p-l*m+t,n-l*p-u*m]}return g.invert=function(p,m){return[i*(c*p-f*m+d),r*(h-f*p-c*m)]},g}function _o(e){return n8(function(){return e})()}function n8(e){var t,n=150,i=480,r=250,o=0,a=0,s=0,u=0,l=0,c,f=0,d=1,h=1,g=null,p=T6,m=null,y,v,b,x=Jf,w=.5,_,E,$,O,C;function A(S){return $(S[0]*rt,S[1]*rt)}function D(S){return S=$.invert(S[0],S[1]),S&&[S[0]*on,S[1]*on]}A.stream=function(S){return O&&C===S?O:O=rne(one(c)(p(_(x(C=S)))))},A.preclip=function(S){return arguments.length?(p=S,g=void 0,T()):p},A.postclip=function(S){return arguments.length?(x=S,m=y=v=b=null,T()):x},A.clipAngle=function(S){return arguments.length?(p=+S?Ute(g=S*rt):(g=null,T6),T()):g*on},A.clipExtent=function(S){return arguments.length?(x=S==null?(m=y=v=b=null,Jf):N6(m=+S[0][0],y=+S[0][1],v=+S[1][0],b=+S[1][1]),T()):m==null?null:[[m,y],[v,b]]},A.scale=function(S){return arguments.length?(n=+S,F()):n},A.translate=function(S){return arguments.length?(i=+S[0],r=+S[1],F()):[i,r]},A.center=function(S){return arguments.length?(o=S[0]%360*rt,a=S[1]%360*rt,F()):[o*on,a*on]},A.rotate=function(S){return arguments.length?(s=S[0]%360*rt,u=S[1]%360*rt,l=S.length>2?S[2]%360*rt:0,F()):[s*on,u*on,l*on]},A.angle=function(S){return arguments.length?(f=S%360*rt,F()):f*on},A.reflectX=function(S){return arguments.length?(d=S?-1:1,F()):d<0},A.reflectY=function(S){return arguments.length?(h=S?-1:1,F()):h<0},A.precision=function(S){return arguments.length?(_=e8(E,w=S*S),T()):qn(w)},A.fitExtent=function(S,M){return vp(A,S,M)},A.fitSize=function(S,M){return Hw(A,S,M)},A.fitWidth=function(S,M){return Ww(A,S,M)},A.fitHeight=function(S,M){return Gw(A,S,M)};function F(){var S=t8(n,0,0,d,h,f).apply(null,t(o,a)),M=t8(n,i-S[0],r-S[1],d,h,f);return c=A6(s,u,l),E=Fw(t,M),$=Fw(c,E),_=e8(E,w),T()}function T(){return O=C=null,A}return function(){return t=e.apply(this,arguments),A.invert=t.invert&&D,F()}}function Yw(e){var t=0,n=be/3,i=n8(e),r=i(t,n);return r.parallels=function(o){return arguments.length?i(t=o[0]*rt,n=o[1]*rt):[t*on,n*on]},r}function sne(e){var t=ve(e);function n(i,r){return[i*t,ce(r)/t]}return n.invert=function(i,r){return[i/t,Oi(r*t)]},n}function une(e,t){var n=ce(e),i=(n+ce(t))/2;if(ze(i)<pe)return sne(e);var r=1+n*(2*i-n),o=qn(r)/i;function a(s,u){var l=qn(r-2*i*ce(u))/i;return[l*ce(s*=i),o-l*ve(s)]}return a.invert=function(s,u){var l=o-u,c=Eo(s,ze(l))*Si(l);return l*i<0&&(c-=be*Si(s)*Si(l)),[c/i,Oi((r-(s*s+l*l)*i*i)/(2*i))]},a}function bp(){return Yw(une).scale(155.424).center([0,33.6442])}function i8(){return bp().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function lne(e){var t=e.length;return{point:function(n,i){for(var r=-1;++r<t;)e[r].point(n,i)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function cne(){var e,t,n=i8(),i,r=bp().rotate([154,0]).center([-2,58.5]).parallels([55,65]),o,a=bp().rotate([157,0]).center([-3,19.9]).parallels([8,18]),s,u,l={point:function(d,h){u=[d,h]}};function c(d){var h=d[0],g=d[1];return u=null,i.point(h,g),u||(o.point(h,g),u)||(s.point(h,g),u)}c.invert=function(d){var h=n.scale(),g=n.translate(),p=(d[0]-g[0])/h,m=(d[1]-g[1])/h;return(m>=.12&&m<.234&&p>=-.425&&p<-.214?r:m>=.166&&m<.234&&p>=-.214&&p<-.115?a:n).invert(d)},c.stream=function(d){return e&&t===d?e:e=lne([n.stream(t=d),r.stream(d),a.stream(d)])},c.precision=function(d){return arguments.length?(n.precision(d),r.precision(d),a.precision(d),f()):n.precision()},c.scale=function(d){return arguments.length?(n.scale(d),r.scale(d*.35),a.scale(d),c.translate(n.translate())):n.scale()},c.translate=function(d){if(!arguments.length)return n.translate();var h=n.scale(),g=+d[0],p=+d[1];return i=n.translate(d).clipExtent([[g-.455*h,p-.238*h],[g+.455*h,p+.238*h]]).stream(l),o=r.translate([g-.307*h,p+.201*h]).clipExtent([[g-.425*h+pe,p+.12*h+pe],[g-.214*h-pe,p+.234*h-pe]]).stream(l),s=a.translate([g-.205*h,p+.212*h]).clipExtent([[g-.214*h+pe,p+.166*h+pe],[g-.115*h-pe,p+.234*h-pe]]).stream(l),f()},c.fitExtent=function(d,h){return vp(c,d,h)},c.fitSize=function(d,h){return Hw(c,d,h)},c.fitWidth=function(d,h){return Ww(c,d,h)},c.fitHeight=function(d,h){return Gw(c,d,h)};function f(){return e=t=null,c}return c.scale(1070)}function r8(e){return function(t,n){var i=ve(t),r=ve(n),o=e(i*r);return o===1/0?[2,0]:[o*r*ce(t),o*ce(n)]}}function id(e){return function(t,n){var i=qn(t*t+n*n),r=e(i),o=ce(r),a=ve(r);return[Eo(t*o,i*a),Oi(i&&n*o/i)]}}var o8=r8(function(e){return qn(2/(1+e))});o8.invert=id(function(e){return 2*Oi(e/2)});function fne(){return _o(o8).scale(124.75).clipAngle(180-.001)}var a8=r8(function(e){return(e=x6(e))&&e/ce(e)});a8.invert=id(function(e){return e});function dne(){return _o(a8).scale(79.4188).clipAngle(180-.001)}function xp(e,t){return[e,ip(Aw((lt+t)/2))]}xp.invert=function(e,t){return[e,2*vl(b6(t))-lt]};function hne(){return s8(xp).scale(961/ui)}function s8(e){var t=_o(e),n=t.center,i=t.scale,r=t.translate,o=t.clipExtent,a=null,s,u,l;t.scale=function(f){return arguments.length?(i(f),c()):i()},t.translate=function(f){return arguments.length?(r(f),c()):r()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(f==null?a=s=u=l=null:(a=+f[0][0],s=+f[0][1],u=+f[1][0],l=+f[1][1]),c()):a==null?null:[[a,s],[u,l]]};function c(){var f=be*i(),d=t(Nte(t.rotate()).invert([0,0]));return o(a==null?[[d[0]-f,d[1]-f],[d[0]+f,d[1]+f]]:e===xp?[[Math.max(d[0]-f,a),s],[Math.min(d[0]+f,u),l]]:[[a,Math.max(d[1]-f,s)],[u,Math.min(d[1]+f,l)]])}return c()}function wp(e){return Aw((lt+e)/2)}function gne(e,t){var n=ve(e),i=e===t?ce(e):ip(n/ve(t))/ip(wp(t)/wp(e)),r=n*_w(wp(e),i)/i;if(!i)return xp;function o(a,s){r>0?s<-lt+pe&&(s=-lt+pe):s>lt-pe&&(s=lt-pe);var u=r/_w(wp(s),i);return[u*ce(i*a),r-u*ve(i*a)]}return o.invert=function(a,s){var u=r-s,l=Si(i)*qn(a*a+u*u),c=Eo(a,ze(u))*Si(u);return u*i<0&&(c-=be*Si(a)*Si(u)),[c/i,2*vl(_w(r/l,1/i))-lt]},o}function pne(){return Yw(gne).scale(109.5).parallels([30,30])}function Ep(e,t){return[e,t]}Ep.invert=Ep;function mne(){return _o(Ep).scale(152.63)}function yne(e,t){var n=ve(e),i=e===t?ce(e):(n-ve(t))/(t-e),r=n/i+e;if(ze(i)<pe)return Ep;function o(a,s){var u=r-s,l=i*a;return[u*ce(l),r-u*ve(l)]}return o.invert=function(a,s){var u=r-s,l=Eo(a,ze(u))*Si(u);return u*i<0&&(l-=be*Si(a)*Si(u)),[l/i,r-Si(i)*qn(a*a+u*u)]},o}function vne(){return Yw(yne).scale(131.154).center([0,13.9389])}var rd=1.340264,od=-.081106,ad=893e-6,sd=.003796,_p=qn(3)/2,bne=12;function u8(e,t){var n=Oi(_p*ce(t)),i=n*n,r=i*i*i;return[e*ve(n)/(_p*(rd+3*od*i+r*(7*ad+9*sd*i))),n*(rd+od*i+r*(ad+sd*i))]}u8.invert=function(e,t){for(var n=t,i=n*n,r=i*i*i,o=0,a,s,u;o<bne&&(s=n*(rd+od*i+r*(ad+sd*i))-t,u=rd+3*od*i+r*(7*ad+9*sd*i),n-=a=s/u,i=n*n,r=i*i*i,!(ze(a)<y6));++o);return[_p*e*(rd+3*od*i+r*(7*ad+9*sd*i))/ve(n),Oi(ce(n)/_p)]};function xne(){return _o(u8).scale(177.158)}function l8(e,t){var n=ve(t),i=ve(e)*n;return[n*ce(e)/i,ce(t)/i]}l8.invert=id(vl);function wne(){return _o(l8).scale(144.049).clipAngle(60)}function Ene(){var e=1,t=0,n=0,i=1,r=1,o=0,a,s,u=null,l,c,f,d=1,h=1,g=yp({point:function(x,w){var _=b([x,w]);this.stream.point(_[0],_[1])}}),p=Jf,m,y;function v(){return d=e*i,h=e*r,m=y=null,b}function b(x){var w=x[0]*d,_=x[1]*h;if(o){var E=_*a-w*s;w=w*a+_*s,_=E}return[w+t,_+n]}return b.invert=function(x){var w=x[0]-t,_=x[1]-n;if(o){var E=_*a+w*s;w=w*a-_*s,_=E}return[w/d,_/h]},b.stream=function(x){return m&&y===x?m:m=g(p(y=x))},b.postclip=function(x){return arguments.length?(p=x,u=l=c=f=null,v()):p},b.clipExtent=function(x){return arguments.length?(p=x==null?(u=l=c=f=null,Jf):N6(u=+x[0][0],l=+x[0][1],c=+x[1][0],f=+x[1][1]),v()):u==null?null:[[u,l],[c,f]]},b.scale=function(x){return arguments.length?(e=+x,v()):e},b.translate=function(x){return arguments.length?(t=+x[0],n=+x[1],v()):[t,n]},b.angle=function(x){return arguments.length?(o=x%360*rt,s=ce(o),a=ve(o),v()):o*on},b.reflectX=function(x){return arguments.length?(i=x?-1:1,v()):i<0},b.reflectY=function(x){return arguments.length?(r=x?-1:1,v()):r<0},b.fitExtent=function(x,w){return vp(b,x,w)},b.fitSize=function(x,w){return Hw(b,x,w)},b.fitWidth=function(x,w){return Ww(b,x,w)},b.fitHeight=function(x,w){return Gw(b,x,w)},b}function c8(e,t){var n=t*t,i=n*n;return[e*(.8707-.131979*n+i*(-.013791+i*(.003971*n-.001529*i))),t*(1.007226+n*(.015085+i*(-.044475+.028874*n-.005916*i)))]}c8.invert=function(e,t){var n=t,i=25,r;do{var o=n*n,a=o*o;n-=r=(n*(1.007226+o*(.015085+a*(-.044475+.028874*o-.005916*a)))-t)/(1.007226+o*(.015085*3+a*(-.044475*7+.028874*9*o-.005916*11*a)))}while(ze(r)>pe&&--i>0);return[e/(.8707+(o=n*n)*(-.131979+o*(-.013791+o*o*o*(.003971-.001529*o)))),n]};function _ne(){return _o(c8).scale(175.295)}function f8(e,t){return[ve(t)*ce(e),ce(t)]}f8.invert=id(Oi);function Ane(){return _o(f8).scale(249.5).clipAngle(90+pe)}function d8(e,t){var n=ve(t),i=1+ve(e)*n;return[n*ce(e)/i,ce(t)/i]}d8.invert=id(function(e){return 2*vl(e)});function $ne(){return _o(d8).scale(250).clipAngle(142)}function h8(e,t){return[ip(Aw((lt+t)/2)),-e]}h8.invert=function(e,t){return[-t,2*vl(b6(e))-lt]};function Sne(){var e=s8(h8),t=e.center,n=e.rotate;return e.center=function(i){return arguments.length?t([-i[1],i[0]]):(i=t(),[i[1],-i[0]])},e.rotate=function(i){return arguments.length?n([i[0],i[1],i.length>2?i[2]+90:90]):(i=n(),[i[0],i[1],i[2]-90])},n([0,0,90]).scale(159.155)}class One{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const o=n[r],a=t+o,s=Math.abs(t)<Math.abs(o)?t-(a-o):o-(a-t);s&&(n[i++]=s),t=a}return n[i]=t,this._n=i+1,this}valueOf(){const t=this._partials;let n=this._n,i,r,o,a=0;if(n>0){for(a=t[--n];n>0&&(i=a,r=t[--n],a=i+r,o=r-(a-i),!o););n>0&&(o<0&&t[n-1]<0||o>0&&t[n-1]>0)&&(r=o*2,i=a+r,r==i-a&&(a=i))}return a}}function*Cne(e){for(const t of e)yield*t}function g8(e){return Array.from(Cne(e))}var Xe=1e-6,Fne=1e-12,Se=Math.PI,Fi=Se/2,p8=Se/4,Qi=Se*2,Ao=180/Se,li=Se/180,ht=Math.abs,kne=Math.atan,ud=Math.atan2,gt=Math.cos,pt=Math.sin,Dne=Math.sign||function(e){return e>0?1:e<0?-1:0},Ap=Math.sqrt;function Mne(e){return e>1?0:e<-1?Se:Math.acos(e)}function ld(e){return e>1?Fi:e<-1?-Fi:Math.asin(e)}function cd(){}function $p(e,t){e&&y8.hasOwnProperty(e.type)&&y8[e.type](e,t)}var m8={Feature:function(e,t){$p(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,i=-1,r=n.length;++i<r;)$p(n[i].geometry,t)}},y8={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)e=n[i],t.point(e[0],e[1],e[2])},LineString:function(e,t){Vw(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)Vw(n[i],t,0)},Polygon:function(e,t){v8(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)v8(n[i],t)},GeometryCollection:function(e,t){for(var n=e.geometries,i=-1,r=n.length;++i<r;)$p(n[i],t)}};function Vw(e,t,n){var i=-1,r=e.length-n,o;for(t.lineStart();++i<r;)o=e[i],t.point(o[0],o[1],o[2]);t.lineEnd()}function v8(e,t){var n=-1,i=e.length;for(t.polygonStart();++n<i;)Vw(e[n],t,1);t.polygonEnd()}function Tne(e,t){e&&m8.hasOwnProperty(e.type)?m8[e.type](e,t):$p(e,t)}function Xw(e){return[ud(e[1],e[0]),ld(e[2])]}function _l(e){var t=e[0],n=e[1],i=gt(n);return[i*gt(t),i*pt(t),pt(n)]}function Sp(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Op(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Kw(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Cp(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Jw(e){var t=Ap(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function Zw(e,t){function n(i,r){return i=e(i,r),t(i[0],i[1])}return e.invert&&t.invert&&(n.invert=function(i,r){return i=t.invert(i,r),i&&e.invert(i[0],i[1])}),n}function Qw(e,t){return[ht(e)>Se?e+Math.round(-e/Qi)*Qi:e,t]}Qw.invert=Qw;function Nne(e,t,n){return(e%=Qi)?t||n?Zw(x8(e),w8(t,n)):x8(e):t||n?w8(t,n):Qw}function b8(e){return function(t,n){return t+=e,[t>Se?t-Qi:t<-Se?t+Qi:t,n]}}function x8(e){var t=b8(e);return t.invert=b8(-e),t}function w8(e,t){var n=gt(e),i=pt(e),r=gt(t),o=pt(t);function a(s,u){var l=gt(u),c=gt(s)*l,f=pt(s)*l,d=pt(u),h=d*n+c*i;return[ud(f*r-h*o,c*n-d*i),ld(h*r+f*o)]}return a.invert=function(s,u){var l=gt(u),c=gt(s)*l,f=pt(s)*l,d=pt(u),h=d*r-f*o;return[ud(f*r+d*o,c*n+h*i),ld(h*n-c*i)]},a}function Rne(e,t,n,i,r,o){if(!!n){var a=gt(t),s=pt(t),u=i*n;r==null?(r=t+i*Qi,o=t-u/2):(r=E8(a,r),o=E8(a,o),(i>0?r<o:r>o)&&(r+=i*Qi));for(var l,c=r;i>0?c>o:c<o;c-=u)l=Xw([a,-s*gt(c),-s*pt(c)]),e.point(l[0],l[1])}}function E8(e,t){t=_l(t),t[0]-=e,Jw(t);var n=Mne(-t[1]);return((-t[2]<0?-n:n)+Qi-Xe)%Qi}function _8(){var e=[],t;return{point:function(n,i,r){t.push([n,i,r])},lineStart:function(){e.push(t=[])},lineEnd:cd,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function Fp(e,t){return ht(e[0]-t[0])<Xe&&ht(e[1]-t[1])<Xe}function kp(e,t,n,i){this.x=e,this.z=t,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function A8(e,t,n,i,r){var o=[],a=[],s,u;if(e.forEach(function(g){if(!((p=g.length-1)<=0)){var p,m=g[0],y=g[p],v;if(Fp(m,y)){if(!m[2]&&!y[2]){for(r.lineStart(),s=0;s<p;++s)r.point((m=g[s])[0],m[1]);r.lineEnd();return}y[0]+=2*Xe}o.push(v=new kp(m,g,null,!0)),a.push(v.o=new kp(m,null,v,!1)),o.push(v=new kp(y,g,null,!1)),a.push(v.o=new kp(y,null,v,!0))}}),!!o.length){for(a.sort(t),$8(o),$8(a),s=0,u=a.length;s<u;++s)a[s].e=n=!n;for(var l=o[0],c,f;;){for(var d=l,h=!0;d.v;)if((d=d.n)===l)return;c=d.z,r.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(s=0,u=c.length;s<u;++s)r.point((f=c[s])[0],f[1]);else i(d.x,d.n.x,1,r);d=d.n}else{if(h)for(c=d.p.z,s=c.length-1;s>=0;--s)r.point((f=c[s])[0],f[1]);else i(d.x,d.p.x,-1,r);d=d.p}d=d.o,c=d.z,h=!h}while(!d.v);r.lineEnd()}}}function $8(e){if(!!(t=e.length)){for(var t,n=0,i=e[0],r;++n<t;)i.n=r=e[n],r.p=i,i=r;i.n=r=e[0],r.p=i}}function eE(e){return ht(e[0])<=Se?e[0]:Dne(e[0])*((ht(e[0])+Se)%Qi-Se)}function jne(e,t){var n=eE(t),i=t[1],r=pt(i),o=[pt(n),-gt(n),0],a=0,s=0,u=new One;r===1?i=Fi+Xe:r===-1&&(i=-Fi-Xe);for(var l=0,c=e.length;l<c;++l)if(!!(d=(f=e[l]).length))for(var f,d,h=f[d-1],g=eE(h),p=h[1]/2+p8,m=pt(p),y=gt(p),v=0;v<d;++v,g=x,m=_,y=E,h=b){var b=f[v],x=eE(b),w=b[1]/2+p8,_=pt(w),E=gt(w),$=x-g,O=$>=0?1:-1,C=O*$,A=C>Se,D=m*_;if(u.add(ud(D*O*pt(C),y*E+D*gt(C))),a+=A?$+O*Qi:$,A^g>=n^x>=n){var F=Op(_l(h),_l(b));Jw(F);var T=Op(o,F);Jw(T);var S=(A^$>=0?-1:1)*ld(T[2]);(i>S||i===S&&(F[0]||F[1]))&&(s+=A^$>=0?1:-1)}}return(a<-Xe||a<Xe&&u<-Fne)^s&1}function S8(e,t,n,i){return function(r){var o=t(r),a=_8(),s=t(a),u=!1,l,c,f,d={point:h,lineStart:p,lineEnd:m,polygonStart:function(){d.point=y,d.lineStart=v,d.lineEnd=b,c=[],l=[]},polygonEnd:function(){d.point=h,d.lineStart=p,d.lineEnd=m,c=g8(c);var x=jne(l,i);c.length?(u||(r.polygonStart(),u=!0),A8(c,Pne,x,n,r)):x&&(u||(r.polygonStart(),u=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),u&&(r.polygonEnd(),u=!1),c=l=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function h(x,w){e(x,w)&&r.point(x,w)}function g(x,w){o.point(x,w)}function p(){d.point=g,o.lineStart()}function m(){d.point=h,o.lineEnd()}function y(x,w){f.push([x,w]),s.point(x,w)}function v(){s.lineStart(),f=[]}function b(){y(f[0][0],f[0][1]),s.lineEnd();var x=s.clean(),w=a.result(),_,E=w.length,$,O,C;if(f.pop(),l.push(f),f=null,!!E){if(x&1){if(O=w[0],($=O.length-1)>0){for(u||(r.polygonStart(),u=!0),r.lineStart(),_=0;_<$;++_)r.point((C=O[_])[0],C[1]);r.lineEnd()}return}E>1&&x&2&&w.push(w.pop().concat(w.shift())),c.push(w.filter(Lne))}}return d}}function Lne(e){return e.length>1}function Pne(e,t){return((e=e.x)[0]<0?e[1]-Fi-Xe:Fi-e[1])-((t=t.x)[0]<0?t[1]-Fi-Xe:Fi-t[1])}var O8=S8(function(){return!0},Ine,zne,[-Se,-Fi]);function Ine(e){var t=NaN,n=NaN,i=NaN,r;return{lineStart:function(){e.lineStart(),r=1},point:function(o,a){var s=o>0?Se:-Se,u=ht(o-t);ht(u-Se)<Xe?(e.point(t,n=(n+a)/2>0?Fi:-Fi),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(s,n),e.point(o,n),r=0):i!==s&&u>=Se&&(ht(t-i)<Xe&&(t-=i*Xe),ht(o-s)<Xe&&(o-=s*Xe),n=Bne(t,n,o,a),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(s,n),r=0),e.point(t=o,n=a),i=s},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-r}}}function Bne(e,t,n,i){var r,o,a=pt(e-n);return ht(a)>Xe?kne((pt(t)*(o=gt(i))*pt(n)-pt(i)*(r=gt(t))*pt(e))/(r*o*a)):(t+i)/2}function zne(e,t,n,i){var r;if(e==null)r=n*Fi,i.point(-Se,r),i.point(0,r),i.point(Se,r),i.point(Se,0),i.point(Se,-r),i.point(0,-r),i.point(-Se,-r),i.point(-Se,0),i.point(-Se,r);else if(ht(e[0]-t[0])>Xe){var o=e[0]<t[0]?Se:-Se;r=n*o/2,i.point(-o,r),i.point(0,r),i.point(o,r)}else i.point(t[0],t[1])}function Une(e){var t=gt(e),n=6*li,i=t>0,r=ht(t)>Xe;function o(c,f,d,h){Rne(h,e,n,d,c,f)}function a(c,f){return gt(c)*gt(f)>t}function s(c){var f,d,h,g,p;return{lineStart:function(){g=h=!1,p=1},point:function(m,y){var v=[m,y],b,x=a(m,y),w=i?x?0:l(m,y):x?l(m+(m<0?Se:-Se),y):0;if(!f&&(g=h=x)&&c.lineStart(),x!==h&&(b=u(f,v),(!b||Fp(f,b)||Fp(v,b))&&(v[2]=1)),x!==h)p=0,x?(c.lineStart(),b=u(v,f),c.point(b[0],b[1])):(b=u(f,v),c.point(b[0],b[1],2),c.lineEnd()),f=b;else if(r&&f&&i^x){var _;!(w&d)&&(_=u(v,f,!0))&&(p=0,i?(c.lineStart(),c.point(_[0][0],_[0][1]),c.point(_[1][0],_[1][1]),c.lineEnd()):(c.point(_[1][0],_[1][1]),c.lineEnd(),c.lineStart(),c.point(_[0][0],_[0][1],3)))}x&&(!f||!Fp(f,v))&&c.point(v[0],v[1]),f=v,h=x,d=w},lineEnd:function(){h&&c.lineEnd(),f=null},clean:function(){return p|(g&&h)<<1}}}function u(c,f,d){var h=_l(c),g=_l(f),p=[1,0,0],m=Op(h,g),y=Sp(m,m),v=m[0],b=y-v*v;if(!b)return!d&&c;var x=t*y/b,w=-t*v/b,_=Op(p,m),E=Cp(p,x),$=Cp(m,w);Kw(E,$);var O=_,C=Sp(E,O),A=Sp(O,O),D=C*C-A*(Sp(E,E)-1);if(!(D<0)){var F=Ap(D),T=Cp(O,(-C-F)/A);if(Kw(T,E),T=Xw(T),!d)return T;var S=c[0],M=f[0],P=c[1],B=f[1],H;M<S&&(H=S,S=M,M=H);var re=M-S,le=ht(re-Se)<Xe,he=le||re<Xe;if(!le&&B<P&&(H=P,P=B,B=H),he?le?P+B>0^T[1]<(ht(T[0]-S)<Xe?P:B):P<=T[1]&&T[1]<=B:re>Se^(S<=T[0]&&T[0]<=M)){var Ae=Cp(O,(-C+F)/A);return Kw(Ae,E),[T,Xw(Ae)]}}}function l(c,f){var d=i?e:Se-e,h=0;return c<-d?h|=1:c>d&&(h|=2),f<-d?h|=4:f>d&&(h|=8),h}return S8(a,s,o,i?[0,-e]:[-Se,e-Se])}function qne(e,t,n,i,r,o){var a=e[0],s=e[1],u=t[0],l=t[1],c=0,f=1,d=u-a,h=l-s,g;if(g=n-a,!(!d&&g>0)){if(g/=d,d<0){if(g<c)return;g<f&&(f=g)}else if(d>0){if(g>f)return;g>c&&(c=g)}if(g=r-a,!(!d&&g<0)){if(g/=d,d<0){if(g>f)return;g>c&&(c=g)}else if(d>0){if(g<c)return;g<f&&(f=g)}if(g=i-s,!(!h&&g>0)){if(g/=h,h<0){if(g<c)return;g<f&&(f=g)}else if(h>0){if(g>f)return;g>c&&(c=g)}if(g=o-s,!(!h&&g<0)){if(g/=h,h<0){if(g>f)return;g>c&&(c=g)}else if(h>0){if(g<c)return;g<f&&(f=g)}return c>0&&(e[0]=a+c*d,e[1]=s+c*h),f<1&&(t[0]=a+f*d,t[1]=s+f*h),!0}}}}}var fd=1e9,Dp=-fd;function Hne(e,t,n,i){function r(l,c){return e<=l&&l<=n&&t<=c&&c<=i}function o(l,c,f,d){var h=0,g=0;if(l==null||(h=a(l,f))!==(g=a(c,f))||u(l,c)<0^f>0)do d.point(h===0||h===3?e:n,h>1?i:t);while((h=(h+f+4)%4)!==g);else d.point(c[0],c[1])}function a(l,c){return ht(l[0]-e)<Xe?c>0?0:3:ht(l[0]-n)<Xe?c>0?2:1:ht(l[1]-t)<Xe?c>0?1:0:c>0?3:2}function s(l,c){return u(l.x,c.x)}function u(l,c){var f=a(l,1),d=a(c,1);return f!==d?f-d:f===0?c[1]-l[1]:f===1?l[0]-c[0]:f===2?l[1]-c[1]:c[0]-l[0]}return function(l){var c=l,f=_8(),d,h,g,p,m,y,v,b,x,w,_,E={point:$,lineStart:D,lineEnd:F,polygonStart:C,polygonEnd:A};function $(S,M){r(S,M)&&c.point(S,M)}function O(){for(var S=0,M=0,P=h.length;M<P;++M)for(var B=h[M],H=1,re=B.length,le=B[0],he,Ae,$e=le[0],Pe=le[1];H<re;++H)he=$e,Ae=Pe,le=B[H],$e=le[0],Pe=le[1],Ae<=i?Pe>i&&($e-he)*(i-Ae)>(Pe-Ae)*(e-he)&&++S:Pe<=i&&($e-he)*(i-Ae)<(Pe-Ae)*(e-he)&&--S;return S}function C(){c=f,d=[],h=[],_=!0}function A(){var S=O(),M=_&&S,P=(d=g8(d)).length;(M||P)&&(l.polygonStart(),M&&(l.lineStart(),o(null,null,1,l),l.lineEnd()),P&&A8(d,s,S,o,l),l.polygonEnd()),c=l,d=h=g=null}function D(){E.point=T,h&&h.push(g=[]),w=!0,x=!1,v=b=NaN}function F(){d&&(T(p,m),y&&x&&f.rejoin(),d.push(f.result())),E.point=$,x&&c.lineEnd()}function T(S,M){var P=r(S,M);if(h&&g.push([S,M]),w)p=S,m=M,y=P,w=!1,P&&(c.lineStart(),c.point(S,M));else if(P&&x)c.point(S,M);else{var B=[v=Math.max(Dp,Math.min(fd,v)),b=Math.max(Dp,Math.min(fd,b))],H=[S=Math.max(Dp,Math.min(fd,S)),M=Math.max(Dp,Math.min(fd,M))];qne(B,H,e,t,n,i)?(x||(c.lineStart(),c.point(B[0],B[1])),c.point(H[0],H[1]),P||c.lineEnd(),_=!1):P&&(c.lineStart(),c.point(S,M),_=!1)}v=S,b=M,x=P}return E}}var C8=e=>e,Al=1/0,Mp=Al,dd=-Al,Tp=dd,Wne={point:Gne,lineStart:cd,lineEnd:cd,polygonStart:cd,polygonEnd:cd,result:function(){var e=[[Al,Mp],[dd,Tp]];return dd=Tp=-(Mp=Al=1/0),e}};function Gne(e,t){e<Al&&(Al=e),e>dd&&(dd=e),t<Mp&&(Mp=t),t>Tp&&(Tp=t)}var F8=Wne;function tE(e){return function(t){var n=new nE;for(var i in e)n[i]=e[i];return n.stream=t,n}}function nE(){}nE.prototype={constructor:nE,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function iE(e,t,n){var i=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),i!=null&&e.clipExtent(null),Tne(n,e.stream(F8)),t(F8.result()),i!=null&&e.clipExtent(i),e}function k8(e,t,n){return iE(e,function(i){var r=t[1][0]-t[0][0],o=t[1][1]-t[0][1],a=Math.min(r/(i[1][0]-i[0][0]),o/(i[1][1]-i[0][1])),s=+t[0][0]+(r-a*(i[1][0]+i[0][0]))/2,u=+t[0][1]+(o-a*(i[1][1]+i[0][1]))/2;e.scale(150*a).translate([s,u])},n)}function Yne(e,t,n){return k8(e,[[0,0],t],n)}function Vne(e,t,n){return iE(e,function(i){var r=+t,o=r/(i[1][0]-i[0][0]),a=(r-o*(i[1][0]+i[0][0]))/2,s=-o*i[0][1];e.scale(150*o).translate([a,s])},n)}function Xne(e,t,n){return iE(e,function(i){var r=+t,o=r/(i[1][1]-i[0][1]),a=-o*i[0][0],s=(r-o*(i[1][1]+i[0][1]))/2;e.scale(150*o).translate([a,s])},n)}var D8=16,Kne=gt(30*li);function M8(e,t){return+t?Zne(e,t):Jne(e)}function Jne(e){return tE({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function Zne(e,t){function n(i,r,o,a,s,u,l,c,f,d,h,g,p,m){var y=l-i,v=c-r,b=y*y+v*v;if(b>4*t&&p--){var x=a+d,w=s+h,_=u+g,E=Ap(x*x+w*w+_*_),$=ld(_/=E),O=ht(ht(_)-1)<Xe||ht(o-f)<Xe?(o+f)/2:ud(w,x),C=e(O,$),A=C[0],D=C[1],F=A-i,T=D-r,S=v*F-y*T;(S*S/b>t||ht((y*F+v*T)/b-.5)>.3||a*d+s*h+u*g<Kne)&&(n(i,r,o,a,s,u,A,D,O,x/=E,w/=E,_,p,m),m.point(A,D),n(A,D,O,x,w,_,l,c,f,d,h,g,p,m))}}return function(i){var r,o,a,s,u,l,c,f,d,h,g,p,m={point:y,lineStart:v,lineEnd:x,polygonStart:function(){i.polygonStart(),m.lineStart=w},polygonEnd:function(){i.polygonEnd(),m.lineStart=v}};function y($,O){$=e($,O),i.point($[0],$[1])}function v(){f=NaN,m.point=b,i.lineStart()}function b($,O){var C=_l([$,O]),A=e($,O);n(f,d,c,h,g,p,f=A[0],d=A[1],c=$,h=C[0],g=C[1],p=C[2],D8,i),i.point(f,d)}function x(){m.point=y,i.lineEnd()}function w(){v(),m.point=_,m.lineEnd=E}function _($,O){b(r=$,O),o=f,a=d,s=h,u=g,l=p,m.point=b}function E(){n(f,d,c,h,g,p,o,a,r,s,u,l,D8,i),m.lineEnd=x,x()}return m}}var Qne=tE({point:function(e,t){this.stream.point(e*li,t*li)}});function eie(e){return tE({point:function(t,n){var i=e(t,n);return this.stream.point(i[0],i[1])}})}function tie(e,t,n,i,r){function o(a,s){return a*=i,s*=r,[t+e*a,n-e*s]}return o.invert=function(a,s){return[(a-t)/e*i,(n-s)/e*r]},o}function T8(e,t,n,i,r,o){if(!o)return tie(e,t,n,i,r);var a=gt(o),s=pt(o),u=a*e,l=s*e,c=a/e,f=s/e,d=(s*n-a*t)/e,h=(s*t+a*n)/e;function g(p,m){return p*=i,m*=r,[u*p-l*m+t,n-l*p-u*m]}return g.invert=function(p,m){return[i*(c*p-f*m+d),r*(h-f*p-c*m)]},g}function nie(e){return iie(function(){return e})()}function iie(e){var t,n=150,i=480,r=250,o=0,a=0,s=0,u=0,l=0,c,f=0,d=1,h=1,g=null,p=O8,m=null,y,v,b,x=C8,w=.5,_,E,$,O,C;function A(S){return $(S[0]*li,S[1]*li)}function D(S){return S=$.invert(S[0],S[1]),S&&[S[0]*Ao,S[1]*Ao]}A.stream=function(S){return O&&C===S?O:O=Qne(eie(c)(p(_(x(C=S)))))},A.preclip=function(S){return arguments.length?(p=S,g=void 0,T()):p},A.postclip=function(S){return arguments.length?(x=S,m=y=v=b=null,T()):x},A.clipAngle=function(S){return arguments.length?(p=+S?Une(g=S*li):(g=null,O8),T()):g*Ao},A.clipExtent=function(S){return arguments.length?(x=S==null?(m=y=v=b=null,C8):Hne(m=+S[0][0],y=+S[0][1],v=+S[1][0],b=+S[1][1]),T()):m==null?null:[[m,y],[v,b]]},A.scale=function(S){return arguments.length?(n=+S,F()):n},A.translate=function(S){return arguments.length?(i=+S[0],r=+S[1],F()):[i,r]},A.center=function(S){return arguments.length?(o=S[0]%360*li,a=S[1]%360*li,F()):[o*Ao,a*Ao]},A.rotate=function(S){return arguments.length?(s=S[0]%360*li,u=S[1]%360*li,l=S.length>2?S[2]%360*li:0,F()):[s*Ao,u*Ao,l*Ao]},A.angle=function(S){return arguments.length?(f=S%360*li,F()):f*Ao},A.reflectX=function(S){return arguments.length?(d=S?-1:1,F()):d<0},A.reflectY=function(S){return arguments.length?(h=S?-1:1,F()):h<0},A.precision=function(S){return arguments.length?(_=M8(E,w=S*S),T()):Ap(w)},A.fitExtent=function(S,M){return k8(A,S,M)},A.fitSize=function(S,M){return Yne(A,S,M)},A.fitWidth=function(S,M){return Vne(A,S,M)},A.fitHeight=function(S,M){return Xne(A,S,M)};function F(){var S=T8(n,0,0,d,h,f).apply(null,t(o,a)),M=T8(n,i-S[0],r-S[1],d,h,f);return c=Nne(s,u,l),E=Zw(t,M),$=Zw(c,E),_=M8(E,w),T()}function T(){return O=C=null,A}return function(){return t=e.apply(this,arguments),A.invert=t.invert&&D,F()}}var rie=Math.abs,rE=Math.cos,Np=Math.sin,oie=1e-6,N8=Math.PI,oE=N8/2,R8=aie(2);function j8(e){return e>1?oE:e<-1?-oE:Math.asin(e)}function aie(e){return e>0?Math.sqrt(e):0}function sie(e,t){var n=e*Np(t),i=30,r;do t-=r=(t+Np(t)-n)/(1+rE(t));while(rie(r)>oie&&--i>0);return t/2}function uie(e,t,n){function i(r,o){return[e*r*rE(o=sie(n,o)),t*Np(o)]}return i.invert=function(r,o){return o=j8(o/t),[r/(e*rE(o)),j8((2*o+Np(2*o))/n)]},i}var lie=uie(R8/oE,R8,N8);function cie(){return nie(lie).scale(169.529)}const fie=Z6(),aE=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function die(e,t){return function n(){const i=t();return i.type=e,i.path=Z6().projection(i),i.copy=i.copy||function(){const r=n();return aE.forEach(o=>{i[o]&&r[o](i[o]())}),r.path.pointRadius(i.path.pointRadius()),r},i}}function sE(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(Rp[e]=die(e,t),this):Rp[e]||null}function L8(e){return e&&e.path||fie}const Rp={albers:i8,albersusa:cne,azimuthalequalarea:fne,azimuthalequidistant:dne,conicconformal:pne,conicequalarea:bp,conicequidistant:vne,equalEarth:xne,equirectangular:mne,gnomonic:wne,identity:Ene,mercator:hne,mollweide:cie,naturalEarth1:_ne,orthographic:Ane,stereographic:$ne,transversemercator:Sne};for(const e in Rp)sE(e,Rp[e]);var Aa=1e-6,P8=Math.abs,jp=Math.ceil;function I8(e,t,n){var i=Rs(e,t-Aa,n).concat(t);return function(r){return i.map(function(o){return[r,o]})}}function B8(e,t,n){var i=Rs(e,t-Aa,n).concat(t);return function(r){return i.map(function(o){return[o,r]})}}function hie(){var e,t,n,i,r,o,a,s,u=10,l=u,c=90,f=360,d,h,g,p,m=2.5;function y(){return{type:"MultiLineString",coordinates:v()}}function v(){return Rs(jp(i/c)*c,n,c).map(g).concat(Rs(jp(s/f)*f,a,f).map(p)).concat(Rs(jp(t/u)*u,e,u).filter(function(b){return P8(b%c)>Aa}).map(d)).concat(Rs(jp(o/l)*l,r,l).filter(function(b){return P8(b%f)>Aa}).map(h))}return y.lines=function(){return v().map(function(b){return{type:"LineString",coordinates:b}})},y.outline=function(){return{type:"Polygon",coordinates:[g(i).concat(p(a).slice(1),g(n).reverse().slice(1),p(s).reverse().slice(1))]}},y.extent=function(b){return arguments.length?y.extentMajor(b).extentMinor(b):y.extentMinor()},y.extentMajor=function(b){return arguments.length?(i=+b[0][0],n=+b[1][0],s=+b[0][1],a=+b[1][1],i>n&&(b=i,i=n,n=b),s>a&&(b=s,s=a,a=b),y.precision(m)):[[i,s],[n,a]]},y.extentMinor=function(b){return arguments.length?(t=+b[0][0],e=+b[1][0],o=+b[0][1],r=+b[1][1],t>e&&(b=t,t=e,e=b),o>r&&(b=o,o=r,r=b),y.precision(m)):[[t,o],[e,r]]},y.step=function(b){return arguments.length?y.stepMajor(b).stepMinor(b):y.stepMinor()},y.stepMajor=function(b){return arguments.length?(c=+b[0],f=+b[1],y):[c,f]},y.stepMinor=function(b){return arguments.length?(u=+b[0],l=+b[1],y):[u,l]},y.precision=function(b){return arguments.length?(m=+b,d=I8(o,r,90),h=B8(t,e,m),g=I8(s,a,90),p=B8(i,n,m),y):m},y.extentMajor([[-180,-90+Aa],[180,90-Aa]]).extentMinor([[-180,-80-Aa],[180,80+Aa]])}function uE(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function z8(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function hd(){}var gd=.7,Lp=1/gd,$l="\\s*([+-]?\\d+)\\s*",pd="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",jr="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",gie=/^#([0-9a-f]{3,8})$/,pie=new RegExp("^rgb\\("+[$l,$l,$l]+"\\)$"),mie=new RegExp("^rgb\\("+[jr,jr,jr]+"\\)$"),yie=new RegExp("^rgba\\("+[$l,$l,$l,pd]+"\\)$"),vie=new RegExp("^rgba\\("+[jr,jr,jr,pd]+"\\)$"),bie=new RegExp("^hsl\\("+[pd,jr,jr]+"\\)$"),xie=new RegExp("^hsla\\("+[pd,jr,jr,pd]+"\\)$"),U8={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};uE(hd,lE,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:q8,formatHex:q8,formatHsl:wie,formatRgb:H8,toString:H8});function q8(){return this.rgb().formatHex()}function wie(){return X8(this).formatHsl()}function H8(){return this.rgb().formatRgb()}function lE(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=gie.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?W8(t):n===3?new ci(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Pp(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Pp(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=pie.exec(e))?new ci(t[1],t[2],t[3],1):(t=mie.exec(e))?new ci(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=yie.exec(e))?Pp(t[1],t[2],t[3],t[4]):(t=vie.exec(e))?Pp(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=bie.exec(e))?V8(t[1],t[2]/100,t[3]/100,1):(t=xie.exec(e))?V8(t[1],t[2]/100,t[3]/100,t[4]):U8.hasOwnProperty(e)?W8(U8[e]):e==="transparent"?new ci(NaN,NaN,NaN,0):null}function W8(e){return new ci(e>>16&255,e>>8&255,e&255,1)}function Pp(e,t,n,i){return i<=0&&(e=t=n=NaN),new ci(e,t,n,i)}function Eie(e){return e instanceof hd||(e=lE(e)),e?(e=e.rgb(),new ci(e.r,e.g,e.b,e.opacity)):new ci}function cE(e,t,n,i){return arguments.length===1?Eie(e):new ci(e,t,n,i==null?1:i)}function ci(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}uE(ci,cE,z8(hd,{brighter:function(e){return e=e==null?Lp:Math.pow(Lp,e),new ci(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?gd:Math.pow(gd,e),new ci(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:G8,formatHex:G8,formatRgb:Y8,toString:Y8}));function G8(){return"#"+fE(this.r)+fE(this.g)+fE(this.b)}function Y8(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function fE(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function V8(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Lr(e,t,n,i)}function X8(e){if(e instanceof Lr)return new Lr(e.h,e.s,e.l,e.opacity);if(e instanceof hd||(e=lE(e)),!e)return new Lr;if(e instanceof Lr)return e;e=e.rgb();var t=e.r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),o=Math.max(t,n,i),a=NaN,s=o-r,u=(o+r)/2;return s?(t===o?a=(n-i)/s+(n<i)*6:n===o?a=(i-t)/s+2:a=(t-n)/s+4,s/=u<.5?o+r:2-o-r,a*=60):s=u>0&&u<1?0:a,new Lr(a,s,u,e.opacity)}function _ie(e,t,n,i){return arguments.length===1?X8(e):new Lr(e,t,n,i==null?1:i)}function Lr(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}uE(Lr,_ie,z8(hd,{brighter:function(e){return e=e==null?Lp:Math.pow(Lp,e),new Lr(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?gd:Math.pow(gd,e),new Lr(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,r=2*n-i;return new ci(dE(e>=240?e-240:e+120,r,i),dE(e,r,i),dE(e<120?e+240:e-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function dE(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}function Aie(){}const $o=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function K8(){var e=1,t=1,n=s;function i(u,l){return l.map(c=>r(u,c))}function r(u,l){var c=[],f=[];return o(u,l,d=>{n(d,u,l),$ie(d)>0?c.push([d]):f.push(d)}),f.forEach(d=>{for(var h=0,g=c.length,p;h<g;++h)if(Sie((p=c[h])[0],d)!==-1){p.push(d);return}}),{type:"MultiPolygon",value:l,coordinates:c}}function o(u,l,c){var f=new Array,d=new Array,h,g,p,m,y,v;for(h=g=-1,m=u[0]>=l,$o[m<<1].forEach(b);++h<e-1;)p=m,m=u[h+1]>=l,$o[p|m<<1].forEach(b);for($o[m<<0].forEach(b);++g<t-1;){for(h=-1,m=u[g*e+e]>=l,y=u[g*e]>=l,$o[m<<1|y<<2].forEach(b);++h<e-1;)p=m,m=u[g*e+e+h+1]>=l,v=y,y=u[g*e+h+1]>=l,$o[p|m<<1|y<<2|v<<3].forEach(b);$o[m|y<<3].forEach(b)}for(h=-1,y=u[g*e]>=l,$o[y<<2].forEach(b);++h<e-1;)v=y,y=u[g*e+h+1]>=l,$o[y<<2|v<<3].forEach(b);$o[y<<3].forEach(b);function b(x){var w=[x[0][0]+h,x[0][1]+g],_=[x[1][0]+h,x[1][1]+g],E=a(w),$=a(_),O,C;(O=d[E])?(C=f[$])?(delete d[O.end],delete f[C.start],O===C?(O.ring.push(_),c(O.ring)):f[O.start]=d[C.end]={start:O.start,end:C.end,ring:O.ring.concat(C.ring)}):(delete d[O.end],O.ring.push(_),d[O.end=$]=O):(O=f[$])?(C=d[E])?(delete f[O.start],delete d[C.end],O===C?(O.ring.push(_),c(O.ring)):f[C.start]=d[O.end]={start:C.start,end:O.end,ring:C.ring.concat(O.ring)}):(delete f[O.start],O.ring.unshift(w),f[O.start=E]=O):f[E]=d[$]={start:E,end:$,ring:[w,_]}}}function a(u){return u[0]*2+u[1]*(e+1)*4}function s(u,l,c){u.forEach(f=>{var d=f[0],h=f[1],g=d|0,p=h|0,m,y=l[p*e+g];d>0&&d<e&&g===d&&(m=l[p*e+g-1],f[0]=d+(c-m)/(y-m)-.5),h>0&&h<t&&p===h&&(m=l[(p-1)*e+g],f[1]=h+(c-m)/(y-m)-.5)})}return i.contour=r,i.size=function(u){if(!arguments.length)return[e,t];var l=Math.floor(u[0]),c=Math.floor(u[1]);return l>=0&&c>=0||I("invalid size"),e=l,t=c,i},i.smooth=function(u){return arguments.length?(n=u?s:Aie,i):n===s},i}function $ie(e){for(var t=0,n=e.length,i=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)i+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return i}function Sie(e,t){for(var n=-1,i=t.length,r;++n<i;)if(r=Oie(e,t[n]))return r;return 0}function Oie(e,t){for(var n=t[0],i=t[1],r=-1,o=0,a=e.length,s=a-1;o<a;s=o++){var u=e[o],l=u[0],c=u[1],f=e[s],d=f[0],h=f[1];if(Cie(u,f,t))return 0;c>i!=h>i&&n<(d-l)*(i-c)/(h-c)+l&&(r=-r)}return r}function Cie(e,t,n){var i;return Fie(e,t,n)&&kie(e[i=+(e[0]===t[0])],n[i],t[i])}function Fie(e,t,n){return(t[0]-e[0])*(n[1]-e[1])==(n[0]-e[0])*(t[1]-e[1])}function kie(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function J8(e,t,n){return function(i){var r=vr(i),o=n?Math.min(r[0],0):r[0],a=r[1],s=a-o,u=t?Dte(o,a,e):s/(e+1);return Rs(o+u,a,u)}}function hE(e){N.call(this,null,e)}hE.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]};q(hE,N,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=t.materialize(t.SOURCE).source,r=e.field||yn,o=K8().smooth(e.smooth!==!1),a=e.thresholds||Die(i,r,e),s=e.as===null?null:e.as||"contour",u=[];return i.forEach(l=>{const c=r(l),f=o.size([c.width,c.height])(c.values,Q(a)?a:a(c.values));Mie(f,c,l,e),f.forEach(d=>{u.push(M0(l,Le(s!=null?{[s]:d}:d)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function Die(e,t,n){const i=J8(n.levels||10,n.nice,n.zero!==!1);return n.resolve!=="shared"?i:i(e.map(r=>np(t(r).values)))}function Mie(e,t,n,i){let r=i.scale||t.scale,o=i.translate||t.translate;if(me(r)&&(r=r(n,i)),me(o)&&(o=o(n,i)),(r===1||r==null)&&!o)return;const a=(Qo(r)?r:r[0])||1,s=(Qo(r)?r:r[1])||1,u=o&&o[0]||0,l=o&&o[1]||0;e.forEach(Z8(t,a,s,u,l))}function Z8(e,t,n,i,r){const o=e.x1||0,a=e.y1||0,s=t*n<0;function u(f){f.forEach(l)}function l(f){s&&f.reverse(),f.forEach(c)}function c(f){f[0]=(f[0]-o)*t+i,f[1]=(f[1]-a)*n+r}return function(f){return f.coordinates.forEach(u),f}}function Q8(e,t,n){const i=e>=0?e:Xv(t,n);return Math.round((Math.sqrt(4*i*i+1)-1)/2)}function gE(e){return me(e)?e:Jt(+e)}function eN(){var e=u=>u[0],t=u=>u[1],n=ju,i=[-1,-1],r=960,o=500,a=2;function s(u,l){const c=Q8(i[0],u,e)>>a,f=Q8(i[1],u,t)>>a,d=c?c+2:0,h=f?f+2:0,g=2*d+(r>>a),p=2*h+(o>>a),m=new Float32Array(g*p),y=new Float32Array(g*p);let v=m;u.forEach(x=>{const w=d+(+e(x)>>a),_=h+(+t(x)>>a);w>=0&&w<g&&_>=0&&_<p&&(m[w+_*g]+=+n(x))}),c>0&&f>0?(Sl(g,p,m,y,c),Ol(g,p,y,m,f),Sl(g,p,m,y,c),Ol(g,p,y,m,f),Sl(g,p,m,y,c),Ol(g,p,y,m,f)):c>0?(Sl(g,p,m,y,c),Sl(g,p,y,m,c),Sl(g,p,m,y,c),v=y):f>0&&(Ol(g,p,m,y,f),Ol(g,p,y,m,f),Ol(g,p,m,y,f),v=y);const b=l?Math.pow(2,-2*a):1/Mte(v);for(let x=0,w=g*p;x<w;++x)v[x]*=b;return{values:v,scale:1<<a,width:g,height:p,x1:d,y1:h,x2:d+(r>>a),y2:h+(o>>a)}}return s.x=function(u){return arguments.length?(e=gE(u),s):e},s.y=function(u){return arguments.length?(t=gE(u),s):t},s.weight=function(u){return arguments.length?(n=gE(u),s):n},s.size=function(u){if(!arguments.length)return[r,o];var l=+u[0],c=+u[1];return l>=0&&c>=0||I("invalid size"),r=l,o=c,s},s.cellSize=function(u){return arguments.length?((u=+u)>=1||I("invalid cell size"),a=Math.floor(Math.log(u)/Math.LN2),s):1<<a},s.bandwidth=function(u){return arguments.length?(u=oe(u),u.length===1&&(u=[+u[0],+u[0]]),u.length!==2&&I("invalid bandwidth"),i=u,s):i},s}function Sl(e,t,n,i,r){const o=(r<<1)+1;for(let a=0;a<t;++a)for(let s=0,u=0;s<e+r;++s)s<e&&(u+=n[s+a*e]),s>=r&&(s>=o&&(u-=n[s-o+a*e]),i[s-r+a*e]=u/Math.min(s+1,e-1+o-s,o))}function Ol(e,t,n,i,r){const o=(r<<1)+1;for(let a=0;a<e;++a)for(let s=0,u=0;s<t+r;++s)s<t&&(u+=n[a+s*e]),s>=r&&(s>=o&&(u-=n[a+(s-o)*e]),i[a+(s-r)*e]=u/Math.min(s+1,t-1+o-s,o))}function pE(e){N.call(this,null,e)}pE.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const Tie=["x","y","weight","size","cellSize","bandwidth"];function tN(e,t){return Tie.forEach(n=>t[n]!=null?e[n](t[n]):0),e}q(pE,N,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=t.materialize(t.SOURCE).source,r=Nie(i,e.groupby),o=(e.groupby||[]).map(ut),a=tN(eN(),e),s=e.as||"grid",u=[];function l(c,f){for(let d=0;d<o.length;++d)c[o[d]]=f[d];return c}return u=r.map(c=>Le(l({[s]:a(c,e.counts)},c.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function Nie(e,t){var n=[],i=c=>c(s),r,o,a,s,u,l;if(t==null)n.push(e);else for(r={},o=0,a=e.length;o<a;++o)s=e[o],u=t.map(i),l=r[u],l||(r[u]=l=[],l.dims=u,n.push(l)),l.push(s);return n}function mE(e){N.call(this,null,e)}mE.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]};q(mE,N,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=K8().smooth(e.smooth!==!1),r=e.values,o=e.thresholds||J8(e.count||10,e.nice,!!r),a=e.size,s,u;return r||(r=t.materialize(t.SOURCE).source,s=tN(eN(),e)(r,!0),u=Z8(s,s.scale||1,s.scale||1,0,0),a=[s.width,s.height],r=s.values),o=Q(o)?o:o(r),r=i.size(a)(r,o),u&&r.forEach(u),this.value&&(n.rem=this.value),this.value=n.source=n.add=(r||[]).map(Le),n}});const yE="Feature",vE="FeatureCollection",Rie="MultiPoint";function bE(e){N.call(this,null,e)}bE.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]};q(bE,N,{transform(e,t){var n=this._features,i=this._points,r=e.fields,o=r&&r[0],a=r&&r[1],s=e.geojson||!r&&yn,u=t.ADD,l;l=e.modified()||t.changed(t.REM)||t.modified(Xt(s))||o&&t.modified(Xt(o))||a&&t.modified(Xt(a)),(!this.value||l)&&(u=t.SOURCE,this._features=n=[],this._points=i=[]),s&&t.visit(u,c=>n.push(s(c))),o&&a&&(t.visit(u,c=>{var f=o(c),d=a(c);f!=null&&d!=null&&(f=+f)===f&&(d=+d)===d&&i.push([f,d])}),n=n.concat({type:yE,geometry:{type:Rie,coordinates:i}})),this.value={type:vE,features:n}}});function xE(e){N.call(this,null,e)}xE.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]};q(xE,N,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.field||yn,o=e.as||"path",a=n.SOURCE;!i||e.modified()?(this.value=i=L8(e.projection),n.materialize().reflow()):a=r===yn||t.modified(r.fields)?n.ADD_MOD:n.ADD;const s=jie(i,e.pointRadius);return n.visit(a,u=>u[o]=i(r(u))),i.pointRadius(s),n.modifies(o)}});function jie(e,t){const n=e.pointRadius();return e.context(null),t!=null&&e.pointRadius(t),n}function wE(e){N.call(this,null,e)}wE.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]};q(wE,N,{transform(e,t){var n=e.projection,i=e.fields[0],r=e.fields[1],o=e.as||["x","y"],a=o[0],s=o[1],u;function l(c){const f=n([i(c),r(c)]);f?(c[a]=f[0],c[s]=f[1]):(c[a]=void 0,c[s]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,l):(u=t.modified(i.fields)||t.modified(r.fields),t.visit(u?t.ADD_MOD:t.ADD,l)),t.modifies(o)}});function EE(e){N.call(this,null,e)}EE.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]};q(EE,N,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.as||"shape",o=n.ADD;return(!i||e.modified())&&(this.value=i=Lie(L8(e.projection),e.field||Ln("datum"),e.pointRadius),n.materialize().reflow(),o=n.SOURCE),n.visit(o,a=>a[r]=i),n.modifies(r)}});function Lie(e,t,n){const i=n==null?r=>e(t(r)):r=>{var o=e.pointRadius(),a=e.pointRadius(n)(t(r));return e.pointRadius(o),a};return i.context=r=>(e.context(r),i),i}function _E(e){N.call(this,[],e),this.generator=hie()}_E.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};q(_E,N,{transform(e,t){var n=this.value,i=this.generator,r;if(!n.length||e.modified())for(const o in e)me(i[o])&&i[o](e[o]);return r=i(),n.length?t.mod.push(c3(n[0],r)):t.add.push(Le(r)),n[0]=r,t}});function AE(e){N.call(this,null,e)}AE.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};q(AE,N,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,i=e.resolve==="shared",r=e.field||yn,o=Iie(e.opacity,e),a=Pie(e.color,e),s=e.as||"image",u={$x:0,$y:0,$value:0,$max:i?np(n.map(l=>np(r(l).values))):0};return n.forEach(l=>{const c=r(l),f=ge({},l,u);i||(f.$max=np(c.values||[])),l[s]=Bie(c,f,a.dep?a:Jt(a(f)),o.dep?o:Jt(o(f)))}),t.reflow(!0).modifies(s)}});function Pie(e,t){let n;return me(e)?(n=i=>cE(e(i,t)),n.dep=nN(e)):n=Jt(cE(e||"#888")),n}function Iie(e,t){let n;return me(e)?(n=i=>e(i,t),n.dep=nN(e)):e?n=Jt(e):(n=i=>i.$value/i.$max||0,n.dep=!0),n}function nN(e){if(!me(e))return!1;const t=Hi(Xt(e));return t.$x||t.$y||t.$value||t.$max}function Bie(e,t,n,i){const r=e.width,o=e.height,a=e.x1||0,s=e.y1||0,u=e.x2||r,l=e.y2||o,c=e.values,f=c?m=>c[m]:Ko,d=Ku(u-a,l-s),h=d.getContext("2d"),g=h.getImageData(0,0,u-a,l-s),p=g.data;for(let m=s,y=0;m<l;++m){t.$y=m-s;for(let v=a,b=m*r;v<u;++v,y+=4){t.$x=v-a,t.$value=f(v+b);const x=n(t);p[y+0]=x.r,p[y+1]=x.g,p[y+2]=x.b,p[y+3]=~~(255*i(t))}}return h.putImageData(g,0,0),d}function iN(e){N.call(this,null,e),this.modified(!0)}q(iN,N,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=Uie(e.type),aE.forEach(i=>{e[i]!=null&&rN(n,i,e[i])})):aE.forEach(i=>{e.modified(i)&&rN(n,i,e[i])}),e.pointRadius!=null&&n.path.pointRadius(e.pointRadius),e.fit&&zie(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function zie(e,t){const n=qie(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function Uie(e){const t=sE((e||"mercator").toLowerCase());return t||I("Unrecognized projection type: "+e),t()}function rN(e,t,n){me(e[t])&&e[t](n)}function qie(e){return e=oe(e),e.length===1?e[0]:{type:vE,features:e.reduce((t,n)=>t.concat(Hie(n)),[])}}function Hie(e){return e.type===vE?e.features:oe(e).filter(t=>t!=null).map(t=>t.type===yE?t:{type:yE,geometry:t})}var Wie=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",contour:mE,geojson:bE,geopath:xE,geopoint:wE,geoshape:EE,graticule:_E,heatmap:AE,isocontour:hE,kde2d:pE,projection:iN});function Gie(e,t){var n,i=1;e==null&&(e=0),t==null&&(t=0);function r(){var o,a=n.length,s,u=0,l=0;for(o=0;o<a;++o)s=n[o],u+=s.x,l+=s.y;for(u=(u/a-e)*i,l=(l/a-t)*i,o=0;o<a;++o)s=n[o],s.x-=u,s.y-=l}return r.initialize=function(o){n=o},r.x=function(o){return arguments.length?(e=+o,r):e},r.y=function(o){return arguments.length?(t=+o,r):t},r.strength=function(o){return arguments.length?(i=+o,r):i},r}function Yie(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return oN(this.cover(t,n),t,n,e)}function oN(e,t,n,i){if(isNaN(t)||isNaN(n))return e;var r,o=e._root,a={data:i},s=e._x0,u=e._y0,l=e._x1,c=e._y1,f,d,h,g,p,m,y,v;if(!o)return e._root=a,e;for(;o.length;)if((p=t>=(f=(s+l)/2))?s=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d,r=o,!(o=o[y=m<<1|p]))return r[y]=a,e;if(h=+e._x.call(null,o.data),g=+e._y.call(null,o.data),t===h&&n===g)return a.next=o,r?r[y]=a:e._root=a,e;do r=r?r[y]=new Array(4):e._root=new Array(4),(p=t>=(f=(s+l)/2))?s=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d;while((y=m<<1|p)==(v=(g>=d)<<1|h>=f));return r[v]=o,r[y]=a,e}function Vie(e){var t,n,i=e.length,r,o,a=new Array(i),s=new Array(i),u=1/0,l=1/0,c=-1/0,f=-1/0;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(o=+this._y.call(null,t))||(a[n]=r,s[n]=o,r<u&&(u=r),r>c&&(c=r),o<l&&(l=o),o>f&&(f=o));if(u>c||l>f)return this;for(this.cover(u,l).cover(c,f),n=0;n<i;++n)oN(this,a[n],s[n],e[n]);return this}function Xie(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,i=this._y0,r=this._x1,o=this._y1;if(isNaN(n))r=(n=Math.floor(e))+1,o=(i=Math.floor(t))+1;else{for(var a=r-n||1,s=this._root,u,l;n>e||e>=r||i>t||t>=o;)switch(l=(t<i)<<1|e<n,u=new Array(4),u[l]=s,s=u,a*=2,l){case 0:r=n+a,o=i+a;break;case 1:n=r-a,o=i+a;break;case 2:r=n+a,i=o-a;break;case 3:n=r-a,i=o-a;break}this._root&&this._root.length&&(this._root=s)}return this._x0=n,this._y0=i,this._x1=r,this._y1=o,this}function Kie(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function Jie(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function xn(e,t,n,i,r){this.node=e,this.x0=t,this.y0=n,this.x1=i,this.y1=r}function Zie(e,t,n){var i,r=this._x0,o=this._y0,a,s,u,l,c=this._x1,f=this._y1,d=[],h=this._root,g,p;for(h&&d.push(new xn(h,r,o,c,f)),n==null?n=1/0:(r=e-n,o=t-n,c=e+n,f=t+n,n*=n);g=d.pop();)if(!(!(h=g.node)||(a=g.x0)>c||(s=g.y0)>f||(u=g.x1)<r||(l=g.y1)<o))if(h.length){var m=(a+u)/2,y=(s+l)/2;d.push(new xn(h[3],m,y,u,l),new xn(h[2],a,y,m,l),new xn(h[1],m,s,u,y),new xn(h[0],a,s,m,y)),(p=(t>=y)<<1|e>=m)&&(g=d[d.length-1],d[d.length-1]=d[d.length-1-p],d[d.length-1-p]=g)}else{var v=e-+this._x.call(null,h.data),b=t-+this._y.call(null,h.data),x=v*v+b*b;if(x<n){var w=Math.sqrt(n=x);r=e-w,o=t-w,c=e+w,f=t+w,i=h.data}}return i}function Qie(e){if(isNaN(c=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,n=this._root,i,r,o,a=this._x0,s=this._y0,u=this._x1,l=this._y1,c,f,d,h,g,p,m,y;if(!n)return this;if(n.length)for(;;){if((g=c>=(d=(a+u)/2))?a=d:u=d,(p=f>=(h=(s+l)/2))?s=h:l=h,t=n,!(n=n[m=p<<1|g]))return this;if(!n.length)break;(t[m+1&3]||t[m+2&3]||t[m+3&3])&&(i=t,y=m)}for(;n.data!==e;)if(r=n,!(n=n.next))return this;return(o=n.next)&&delete n.next,r?(o?r.next=o:delete r.next,this):t?(o?t[m]=o:delete t[m],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(i?i[y]=n:this._root=n),this):(this._root=o,this)}function ere(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function tre(){return this._root}function nre(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function ire(e){var t=[],n,i=this._root,r,o,a,s,u;for(i&&t.push(new xn(i,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(i=n.node,o=n.x0,a=n.y0,s=n.x1,u=n.y1)&&i.length){var l=(o+s)/2,c=(a+u)/2;(r=i[3])&&t.push(new xn(r,l,c,s,u)),(r=i[2])&&t.push(new xn(r,o,c,l,u)),(r=i[1])&&t.push(new xn(r,l,a,s,c)),(r=i[0])&&t.push(new xn(r,o,a,l,c))}return this}function rre(e){var t=[],n=[],i;for(this._root&&t.push(new xn(this._root,this._x0,this._y0,this._x1,this._y1));i=t.pop();){var r=i.node;if(r.length){var o,a=i.x0,s=i.y0,u=i.x1,l=i.y1,c=(a+u)/2,f=(s+l)/2;(o=r[0])&&t.push(new xn(o,a,s,c,f)),(o=r[1])&&t.push(new xn(o,c,s,u,f)),(o=r[2])&&t.push(new xn(o,a,f,c,l)),(o=r[3])&&t.push(new xn(o,c,f,u,l))}n.push(i)}for(;i=n.pop();)e(i.node,i.x0,i.y0,i.x1,i.y1);return this}function ore(e){return e[0]}function are(e){return arguments.length?(this._x=e,this):this._x}function sre(e){return e[1]}function ure(e){return arguments.length?(this._y=e,this):this._y}function $E(e,t,n){var i=new SE(t==null?ore:t,n==null?sre:n,NaN,NaN,NaN,NaN);return e==null?i:i.addAll(e)}function SE(e,t,n,i,r,o){this._x=e,this._y=t,this._x0=n,this._y0=i,this._x1=r,this._y1=o,this._root=void 0}function aN(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var wn=$E.prototype=SE.prototype;wn.copy=function(){var e=new SE(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,i;if(!t)return e;if(!t.length)return e._root=aN(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var r=0;r<4;++r)(i=t.source[r])&&(i.length?n.push({source:i,target:t.target[r]=new Array(4)}):t.target[r]=aN(i));return e};wn.add=Yie;wn.addAll=Vie;wn.cover=Xie;wn.data=Kie;wn.extent=Jie;wn.find=Zie;wn.remove=Qie;wn.removeAll=ere;wn.root=tre;wn.size=nre;wn.visit=ire;wn.visitAfter=rre;wn.x=are;wn.y=ure;function En(e){return function(){return e}}function $a(e){return(e()-.5)*1e-6}function lre(e){return e.x+e.vx}function cre(e){return e.y+e.vy}function fre(e){var t,n,i,r=1,o=1;typeof e!="function"&&(e=En(e==null?1:+e));function a(){for(var l,c=t.length,f,d,h,g,p,m,y=0;y<o;++y)for(f=$E(t,lre,cre).visitAfter(s),l=0;l<c;++l)d=t[l],p=n[d.index],m=p*p,h=d.x+d.vx,g=d.y+d.vy,f.visit(v);function v(b,x,w,_,E){var $=b.data,O=b.r,C=p+O;if($){if($.index>d.index){var A=h-$.x-$.vx,D=g-$.y-$.vy,F=A*A+D*D;F<C*C&&(A===0&&(A=$a(i),F+=A*A),D===0&&(D=$a(i),F+=D*D),F=(C-(F=Math.sqrt(F)))/F*r,d.vx+=(A*=F)*(C=(O*=O)/(m+O)),d.vy+=(D*=F)*C,$.vx-=A*(C=1-C),$.vy-=D*C)}return}return x>h+C||_<h-C||w>g+C||E<g-C}}function s(l){if(l.data)return l.r=n[l.data.index];for(var c=l.r=0;c<4;++c)l[c]&&l[c].r>l.r&&(l.r=l[c].r)}function u(){if(!!t){var l,c=t.length,f;for(n=new Array(c),l=0;l<c;++l)f=t[l],n[f.index]=+e(f,l,t)}}return a.initialize=function(l,c){t=l,i=c,u()},a.iterations=function(l){return arguments.length?(o=+l,a):o},a.strength=function(l){return arguments.length?(r=+l,a):r},a.radius=function(l){return arguments.length?(e=typeof l=="function"?l:En(+l),u(),a):e},a}function dre(e){return e.index}function sN(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function hre(e){var t=dre,n=f,i,r=En(30),o,a,s,u,l,c=1;e==null&&(e=[]);function f(m){return 1/Math.min(s[m.source.index],s[m.target.index])}function d(m){for(var y=0,v=e.length;y<c;++y)for(var b=0,x,w,_,E,$,O,C;b<v;++b)x=e[b],w=x.source,_=x.target,E=_.x+_.vx-w.x-w.vx||$a(l),$=_.y+_.vy-w.y-w.vy||$a(l),O=Math.sqrt(E*E+$*$),O=(O-o[b])/O*m*i[b],E*=O,$*=O,_.vx-=E*(C=u[b]),_.vy-=$*C,w.vx+=E*(C=1-C),w.vy+=$*C}function h(){if(!!a){var m,y=a.length,v=e.length,b=new Map(a.map((w,_)=>[t(w,_,a),w])),x;for(m=0,s=new Array(y);m<v;++m)x=e[m],x.index=m,typeof x.source!="object"&&(x.source=sN(b,x.source)),typeof x.target!="object"&&(x.target=sN(b,x.target)),s[x.source.index]=(s[x.source.index]||0)+1,s[x.target.index]=(s[x.target.index]||0)+1;for(m=0,u=new Array(v);m<v;++m)x=e[m],u[m]=s[x.source.index]/(s[x.source.index]+s[x.target.index]);i=new Array(v),g(),o=new Array(v),p()}}function g(){if(!!a)for(var m=0,y=e.length;m<y;++m)i[m]=+n(e[m],m,e)}function p(){if(!!a)for(var m=0,y=e.length;m<y;++m)o[m]=+r(e[m],m,e)}return d.initialize=function(m,y){a=m,l=y,h()},d.links=function(m){return arguments.length?(e=m,h(),d):e},d.id=function(m){return arguments.length?(t=m,d):t},d.iterations=function(m){return arguments.length?(c=+m,d):c},d.strength=function(m){return arguments.length?(n=typeof m=="function"?m:En(+m),g(),d):n},d.distance=function(m){return arguments.length?(r=typeof m=="function"?m:En(+m),p(),d):r},d}var gre={value:()=>{}};function uN(){for(var e=0,t=arguments.length,n={},i;e<t;++e){if(!(i=arguments[e]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new Ip(n)}function Ip(e){this._=e}function pre(e,t){return e.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}Ip.prototype=uN.prototype={constructor:Ip,on:function(e,t){var n=this._,i=pre(e+"",n),r,o=-1,a=i.length;if(arguments.length<2){for(;++o<a;)if((r=(e=i[o]).type)&&(r=mre(n[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<a;)if(r=(e=i[o]).type)n[r]=lN(n[r],e.name,t);else if(t==null)for(r in n)n[r]=lN(n[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Ip(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,o;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],i=0,r=o.length;i<r;++i)o[i].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],r=0,o=i.length;r<o;++r)i[r].value.apply(t,n)}};function mre(e,t){for(var n=0,i=e.length,r;n<i;++n)if((r=e[n]).name===t)return r.value}function lN(e,t,n){for(var i=0,r=e.length;i<r;++i)if(e[i].name===t){e[i]=gre,e=e.slice(0,i).concat(e.slice(i+1));break}return n!=null&&e.push({name:t,value:n}),e}var Cl=0,md=0,yd=0,cN=1e3,Bp,vd,zp=0,Ps=0,Up=0,bd=typeof performance=="object"&&performance.now?performance:Date,fN=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function dN(){return Ps||(fN(yre),Ps=bd.now()+Up)}function yre(){Ps=0}function OE(){this._call=this._time=this._next=null}OE.prototype=hN.prototype={constructor:OE,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?dN():+n)+(t==null?0:+t),!this._next&&vd!==this&&(vd?vd._next=this:Bp=this,vd=this),this._call=e,this._time=n,CE()},stop:function(){this._call&&(this._call=null,this._time=1/0,CE())}};function hN(e,t,n){var i=new OE;return i.restart(e,t,n),i}function vre(){dN(),++Cl;for(var e=Bp,t;e;)(t=Ps-e._time)>=0&&e._call.call(null,t),e=e._next;--Cl}function gN(){Ps=(zp=bd.now())+Up,Cl=md=0;try{vre()}finally{Cl=0,xre(),Ps=0}}function bre(){var e=bd.now(),t=e-zp;t>cN&&(Up-=t,zp=e)}function xre(){for(var e,t=Bp,n,i=1/0;t;)t._call?(i>t._time&&(i=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Bp=n);vd=e,CE(i)}function CE(e){if(!Cl){md&&(md=clearTimeout(md));var t=e-Ps;t>24?(e<1/0&&(md=setTimeout(gN,e-bd.now()-Up)),yd&&(yd=clearInterval(yd))):(yd||(zp=bd.now(),yd=setInterval(bre,cN)),Cl=1,fN(gN))}}const wre=1664525,Ere=1013904223,pN=4294967296;function _re(){let e=1;return()=>(e=(wre*e+Ere)%pN)/pN}function Are(e){return e.x}function $re(e){return e.y}var Sre=10,Ore=Math.PI*(3-Math.sqrt(5));function Cre(e){var t,n=1,i=.001,r=1-Math.pow(i,1/300),o=0,a=.6,s=new Map,u=hN(f),l=uN("tick","end"),c=_re();e==null&&(e=[]);function f(){d(),l.call("tick",t),n<i&&(u.stop(),l.call("end",t))}function d(p){var m,y=e.length,v;p===void 0&&(p=1);for(var b=0;b<p;++b)for(n+=(o-n)*r,s.forEach(function(x){x(n)}),m=0;m<y;++m)v=e[m],v.fx==null?v.x+=v.vx*=a:(v.x=v.fx,v.vx=0),v.fy==null?v.y+=v.vy*=a:(v.y=v.fy,v.vy=0);return t}function h(){for(var p=0,m=e.length,y;p<m;++p){if(y=e[p],y.index=p,y.fx!=null&&(y.x=y.fx),y.fy!=null&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var v=Sre*Math.sqrt(.5+p),b=p*Ore;y.x=v*Math.cos(b),y.y=v*Math.sin(b)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function g(p){return p.initialize&&p.initialize(e,c),p}return h(),t={tick:d,restart:function(){return u.restart(f),t},stop:function(){return u.stop(),t},nodes:function(p){return arguments.length?(e=p,h(),s.forEach(g),t):e},alpha:function(p){return arguments.length?(n=+p,t):n},alphaMin:function(p){return arguments.length?(i=+p,t):i},alphaDecay:function(p){return arguments.length?(r=+p,t):+r},alphaTarget:function(p){return arguments.length?(o=+p,t):o},velocityDecay:function(p){return arguments.length?(a=1-p,t):1-a},randomSource:function(p){return arguments.length?(c=p,s.forEach(g),t):c},force:function(p,m){return arguments.length>1?(m==null?s.delete(p):s.set(p,g(m)),t):s.get(p)},find:function(p,m,y){var v=0,b=e.length,x,w,_,E,$;for(y==null?y=1/0:y*=y,v=0;v<b;++v)E=e[v],x=p-E.x,w=m-E.y,_=x*x+w*w,_<y&&($=E,y=_);return $},on:function(p,m){return arguments.length>1?(l.on(p,m),t):l.on(p)}}}function Fre(){var e,t,n,i,r=En(-30),o,a=1,s=1/0,u=.81;function l(h){var g,p=e.length,m=$E(e,Are,$re).visitAfter(f);for(i=h,g=0;g<p;++g)t=e[g],m.visit(d)}function c(){if(!!e){var h,g=e.length,p;for(o=new Array(g),h=0;h<g;++h)p=e[h],o[p.index]=+r(p,h,e)}}function f(h){var g=0,p,m,y=0,v,b,x;if(h.length){for(v=b=x=0;x<4;++x)(p=h[x])&&(m=Math.abs(p.value))&&(g+=p.value,y+=m,v+=m*p.x,b+=m*p.y);h.x=v/y,h.y=b/y}else{p=h,p.x=p.data.x,p.y=p.data.y;do g+=o[p.data.index];while(p=p.next)}h.value=g}function d(h,g,p,m){if(!h.value)return!0;var y=h.x-t.x,v=h.y-t.y,b=m-g,x=y*y+v*v;if(b*b/u<x)return x<s&&(y===0&&(y=$a(n),x+=y*y),v===0&&(v=$a(n),x+=v*v),x<a&&(x=Math.sqrt(a*x)),t.vx+=y*h.value*i/x,t.vy+=v*h.value*i/x),!0;if(h.length||x>=s)return;(h.data!==t||h.next)&&(y===0&&(y=$a(n),x+=y*y),v===0&&(v=$a(n),x+=v*v),x<a&&(x=Math.sqrt(a*x)));do h.data!==t&&(b=o[h.data.index]*i/x,t.vx+=y*b,t.vy+=v*b);while(h=h.next)}return l.initialize=function(h,g){e=h,n=g,c()},l.strength=function(h){return arguments.length?(r=typeof h=="function"?h:En(+h),c(),l):r},l.distanceMin=function(h){return arguments.length?(a=h*h,l):Math.sqrt(a)},l.distanceMax=function(h){return arguments.length?(s=h*h,l):Math.sqrt(s)},l.theta=function(h){return arguments.length?(u=h*h,l):Math.sqrt(u)},l}function kre(e){var t=En(.1),n,i,r;typeof e!="function"&&(e=En(e==null?0:+e));function o(s){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vx+=(r[u]-c.x)*i[u]*s}function a(){if(!!n){var s,u=n.length;for(i=new Array(u),r=new Array(u),s=0;s<u;++s)i[s]=isNaN(r[s]=+e(n[s],s,n))?0:+t(n[s],s,n)}}return o.initialize=function(s){n=s,a()},o.strength=function(s){return arguments.length?(t=typeof s=="function"?s:En(+s),a(),o):t},o.x=function(s){return arguments.length?(e=typeof s=="function"?s:En(+s),a(),o):e},o}function Dre(e){var t=En(.1),n,i,r;typeof e!="function"&&(e=En(e==null?0:+e));function o(s){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vy+=(r[u]-c.y)*i[u]*s}function a(){if(!!n){var s,u=n.length;for(i=new Array(u),r=new Array(u),s=0;s<u;++s)i[s]=isNaN(r[s]=+e(n[s],s,n))?0:+t(n[s],s,n)}}return o.initialize=function(s){n=s,a()},o.strength=function(s){return arguments.length?(t=typeof s=="function"?s:En(+s),a(),o):t},o.y=function(s){return arguments.length?(e=typeof s=="function"?s:En(+s),a(),o):e},o}const mN={center:Gie,collide:fre,nbody:Fre,link:hre,x:kre,y:Dre},xd="forces",FE=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],Mre=["static","iterations"],yN=["x","y","vx","vy"];function kE(e){N.call(this,null,e)}kE.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:yN}]};q(kE,N,{transform(e,t){var n=this.value,i=t.changed(t.ADD_REM),r=e.modified(FE),o=e.iterations||300;if(n?(i&&(t.modifies("index"),n.nodes(t.source)),(r||t.changed(t.MOD))&&vN(n,e,0,t)):(this.value=n=Nre(t.source,e),n.on("tick",Tre(t.dataflow,this)),e.static||(i=!0,n.tick()),t.modifies("index")),r||i||e.modified(Mre)||t.changed()&&e.restart){if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/o)),e.static)for(n.stop();--o>=0;)n.tick();else if(n.stopped()&&n.restart(),!i)return t.StopPropagation}return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let s=this._argops,u=0,l=s.length,c;u<l;++u)if(c=s[u],!(c.name!==xd||c.op._argval.force!=="link")){for(var i=c.op._argops,r=0,o=i.length,a;r<o;++r)if(i[r].name==="links"&&(a=i[r].op.source)){n.pulse(a,n.changeset().reflow());break}}return t.reflow(e.modified()).modifies(yN)}});function Tre(e,t){return()=>e.touch(t).run()}function Nre(e,t){const n=Cre(e),i=n.stop,r=n.restart;let o=!1;return n.stopped=()=>o,n.restart=()=>(o=!1,r()),n.stop=()=>(o=!0,i()),vN(n,t,!0).on("end",()=>o=!0)}function vN(e,t,n,i){var r=oe(t.forces),o,a,s,u;for(o=0,a=FE.length;o<a;++o)s=FE[o],s!==xd&&t.modified(s)&&e[s](t[s]);for(o=0,a=r.length;o<a;++o)u=xd+o,s=n||t.modified(xd,o)?jre(r[o]):i&&Rre(r[o],i)?e.force(u):null,s&&e.force(u,s);for(a=e.numForces||0;o<a;++o)e.force(xd+o,null);return e.numForces=r.length,e}function Rre(e,t){var n,i;for(n in e)if(me(i=e[n])&&t.modified(Xt(i)))return 1;return 0}function jre(e){var t,n;ae(mN,e.force)||I("Unrecognized force: "+e.force),t=mN[e.force]();for(n in e)me(t[n])&&Lre(t[n],e[n],e);return t}function Lre(e,t,n){e(me(t)?i=>t(i,n):t)}var Pre=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",force:kE});function Ire(e,t){return e.parent===t.parent?1:2}function Bre(e){return e.reduce(zre,0)/e.length}function zre(e,t){return e+t.x}function Ure(e){return 1+e.reduce(qre,0)}function qre(e,t){return Math.max(e,t.y)}function Hre(e){for(var t;t=e.children;)e=t[0];return e}function Wre(e){for(var t;t=e.children;)e=t[t.length-1];return e}function Gre(){var e=Ire,t=1,n=1,i=!1;function r(o){var a,s=0;o.eachAfter(function(d){var h=d.children;h?(d.x=Bre(h),d.y=Ure(h)):(d.x=a?s+=e(d,a):0,d.y=0,a=d)});var u=Hre(o),l=Wre(o),c=u.x-e(u,l)/2,f=l.x+e(l,u)/2;return o.eachAfter(i?function(d){d.x=(d.x-o.x)*t,d.y=(o.y-d.y)*n}:function(d){d.x=(d.x-c)/(f-c)*t,d.y=(1-(o.y?d.y/o.y:1))*n})}return r.separation=function(o){return arguments.length?(e=o,r):e},r.size=function(o){return arguments.length?(i=!1,t=+o[0],n=+o[1],r):i?null:[t,n]},r.nodeSize=function(o){return arguments.length?(i=!0,t=+o[0],n=+o[1],r):i?[t,n]:null},r}function Yre(e){var t=0,n=e.children,i=n&&n.length;if(!i)t=1;else for(;--i>=0;)t+=n[i].value;e.value=t}function Vre(){return this.eachAfter(Yre)}function Xre(e,t){let n=-1;for(const i of this)e.call(t,i,++n,this);return this}function Kre(e,t){for(var n=this,i=[n],r,o,a=-1;n=i.pop();)if(e.call(t,n,++a,this),r=n.children)for(o=r.length-1;o>=0;--o)i.push(r[o]);return this}function Jre(e,t){for(var n=this,i=[n],r=[],o,a,s,u=-1;n=i.pop();)if(r.push(n),o=n.children)for(a=0,s=o.length;a<s;++a)i.push(o[a]);for(;n=r.pop();)e.call(t,n,++u,this);return this}function Zre(e,t){let n=-1;for(const i of this)if(e.call(t,i,++n,this))return i}function Qre(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,i=t.children,r=i&&i.length;--r>=0;)n+=i[r].value;t.value=n})}function eoe(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function toe(e){for(var t=this,n=noe(t,e),i=[t];t!==n;)t=t.parent,i.push(t);for(var r=i.length;e!==n;)i.splice(r,0,e),e=e.parent;return i}function noe(e,t){if(e===t)return e;var n=e.ancestors(),i=t.ancestors(),r=null;for(e=n.pop(),t=i.pop();e===t;)r=e,e=n.pop(),t=i.pop();return r}function ioe(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function roe(){return Array.from(this)}function ooe(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function aoe(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*soe(){var e=this,t,n=[e],i,r,o;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,i=e.children)for(r=0,o=i.length;r<o;++r)n.push(i[r]);while(n.length)}function DE(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=coe)):t===void 0&&(t=loe);for(var n=new Fl(e),i,r=[n],o,a,s,u;i=r.pop();)if((a=t(i.data))&&(u=(a=Array.from(a)).length))for(i.children=a,s=u-1;s>=0;--s)r.push(o=a[s]=new Fl(a[s])),o.parent=i,o.depth=i.depth+1;return n.eachBefore(bN)}function uoe(){return DE(this).eachBefore(foe)}function loe(e){return e.children}function coe(e){return Array.isArray(e)?e[1]:null}function foe(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function bN(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function Fl(e){this.data=e,this.depth=this.height=0,this.parent=null}Fl.prototype=DE.prototype={constructor:Fl,count:Vre,each:Xre,eachAfter:Jre,eachBefore:Kre,find:Zre,sum:Qre,sort:eoe,path:toe,ancestors:ioe,descendants:roe,leaves:ooe,links:aoe,copy:uoe,[Symbol.iterator]:soe};function doe(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function hoe(e){for(var t=e.length,n,i;t;)i=Math.random()*t--|0,n=e[t],e[t]=e[i],e[i]=n;return e}function goe(e){for(var t=0,n=(e=hoe(Array.from(e))).length,i=[],r,o;t<n;)r=e[t],o&&xN(o,r)?++t:(o=moe(i=poe(i,r)),t=0);return o}function poe(e,t){var n,i;if(ME(t,e))return[t];for(n=0;n<e.length;++n)if(qp(t,e[n])&&ME(wd(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(i=n+1;i<e.length;++i)if(qp(wd(e[n],e[i]),t)&&qp(wd(e[n],t),e[i])&&qp(wd(e[i],t),e[n])&&ME(wN(e[n],e[i],t),e))return[e[n],e[i],t];throw new Error}function qp(e,t){var n=e.r-t.r,i=t.x-e.x,r=t.y-e.y;return n<0||n*n<i*i+r*r}function xN(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function ME(e,t){for(var n=0;n<t.length;++n)if(!xN(e,t[n]))return!1;return!0}function moe(e){switch(e.length){case 1:return yoe(e[0]);case 2:return wd(e[0],e[1]);case 3:return wN(e[0],e[1],e[2])}}function yoe(e){return{x:e.x,y:e.y,r:e.r}}function wd(e,t){var n=e.x,i=e.y,r=e.r,o=t.x,a=t.y,s=t.r,u=o-n,l=a-i,c=s-r,f=Math.sqrt(u*u+l*l);return{x:(n+o+u/f*c)/2,y:(i+a+l/f*c)/2,r:(f+r+s)/2}}function wN(e,t,n){var i=e.x,r=e.y,o=e.r,a=t.x,s=t.y,u=t.r,l=n.x,c=n.y,f=n.r,d=i-a,h=i-l,g=r-s,p=r-c,m=u-o,y=f-o,v=i*i+r*r-o*o,b=v-a*a-s*s+u*u,x=v-l*l-c*c+f*f,w=h*g-d*p,_=(g*x-p*b)/(w*2)-i,E=(p*m-g*y)/w,$=(h*b-d*x)/(w*2)-r,O=(d*y-h*m)/w,C=E*E+O*O-1,A=2*(o+_*E+$*O),D=_*_+$*$-o*o,F=-(C?(A+Math.sqrt(A*A-4*C*D))/(2*C):D/A);return{x:i+_+E*F,y:r+$+O*F,r:F}}function EN(e,t,n){var i=e.x-t.x,r,o,a=e.y-t.y,s,u,l=i*i+a*a;l?(o=t.r+n.r,o*=o,u=e.r+n.r,u*=u,o>u?(r=(l+u-o)/(2*l),s=Math.sqrt(Math.max(0,u/l-r*r)),n.x=e.x-r*i-s*a,n.y=e.y-r*a+s*i):(r=(l+o-u)/(2*l),s=Math.sqrt(Math.max(0,o/l-r*r)),n.x=t.x+r*i-s*a,n.y=t.y+r*a+s*i)):(n.x=t.x+n.r,n.y=t.y)}function _N(e,t){var n=e.r+t.r-1e-6,i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function AN(e){var t=e._,n=e.next._,i=t.r+n.r,r=(t.x*n.r+n.x*t.r)/i,o=(t.y*n.r+n.y*t.r)/i;return r*r+o*o}function Hp(e){this._=e,this.next=null,this.previous=null}function voe(e){if(!(r=(e=doe(e)).length))return 0;var t,n,i,r,o,a,s,u,l,c,f;if(t=e[0],t.x=0,t.y=0,!(r>1))return t.r;if(n=e[1],t.x=-n.r,n.x=t.r,n.y=0,!(r>2))return t.r+n.r;EN(n,t,i=e[2]),t=new Hp(t),n=new Hp(n),i=new Hp(i),t.next=i.previous=n,n.next=t.previous=i,i.next=n.previous=t;e:for(s=3;s<r;++s){EN(t._,n._,i=e[s]),i=new Hp(i),u=n.next,l=t.previous,c=n._.r,f=t._.r;do if(c<=f){if(_N(u._,i._)){n=u,t.next=n,n.previous=t,--s;continue e}c+=u._.r,u=u.next}else{if(_N(l._,i._)){t=l,t.next=n,n.previous=t,--s;continue e}f+=l._.r,l=l.previous}while(u!==l.next);for(i.previous=t,i.next=n,t.next=n.previous=n=i,o=AN(t);(i=i.next)!==n;)(a=AN(i))<o&&(t=i,o=a);n=t.next}for(t=[n._],i=n;(i=i.next)!==n;)t.push(i._);for(i=goe(t),s=0;s<r;++s)t=e[s],t.x-=i.x,t.y-=i.y;return i.r}function boe(e){return e==null?null:Wp(e)}function Wp(e){if(typeof e!="function")throw new Error;return e}function Is(){return 0}function kl(e){return function(){return e}}function xoe(e){return Math.sqrt(e.value)}function woe(){var e=null,t=1,n=1,i=Is;function r(o){return o.x=t/2,o.y=n/2,e?o.eachBefore($N(e)).eachAfter(TE(i,.5)).eachBefore(SN(1)):o.eachBefore($N(xoe)).eachAfter(TE(Is,1)).eachAfter(TE(i,o.r/Math.min(t,n))).eachBefore(SN(Math.min(t,n)/(2*o.r))),o}return r.radius=function(o){return arguments.length?(e=boe(o),r):e},r.size=function(o){return arguments.length?(t=+o[0],n=+o[1],r):[t,n]},r.padding=function(o){return arguments.length?(i=typeof o=="function"?o:kl(+o),r):i},r}function $N(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function TE(e,t){return function(n){if(i=n.children){var i,r,o=i.length,a=e(n)*t||0,s;if(a)for(r=0;r<o;++r)i[r].r+=a;if(s=voe(i),a)for(r=0;r<o;++r)i[r].r-=a;n.r=s+a}}}function SN(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function ON(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function Ed(e,t,n,i,r){for(var o=e.children,a,s=-1,u=o.length,l=e.value&&(i-t)/e.value;++s<u;)a=o[s],a.y0=n,a.y1=r,a.x0=t,a.x1=t+=a.value*l}function Eoe(){var e=1,t=1,n=0,i=!1;function r(a){var s=a.height+1;return a.x0=a.y0=n,a.x1=e,a.y1=t/s,a.eachBefore(o(t,s)),i&&a.eachBefore(ON),a}function o(a,s){return function(u){u.children&&Ed(u,u.x0,a*(u.depth+1)/s,u.x1,a*(u.depth+2)/s);var l=u.x0,c=u.y0,f=u.x1-n,d=u.y1-n;f<l&&(l=f=(l+f)/2),d<c&&(c=d=(c+d)/2),u.x0=l,u.y0=c,u.x1=f,u.y1=d}}return r.round=function(a){return arguments.length?(i=!!a,r):i},r.size=function(a){return arguments.length?(e=+a[0],t=+a[1],r):[e,t]},r.padding=function(a){return arguments.length?(n=+a,r):n},r}var _oe={depth:-1},CN={};function Aoe(e){return e.id}function $oe(e){return e.parentId}function FN(){var e=Aoe,t=$oe;function n(i){var r=Array.from(i),o=r.length,a,s,u,l,c,f,d,h=new Map;for(s=0;s<o;++s)a=r[s],c=r[s]=new Fl(a),(f=e(a,s,i))!=null&&(f+="")&&(d=c.id=f,h.set(d,h.has(d)?CN:c)),(f=t(a,s,i))!=null&&(f+="")&&(c.parent=f);for(s=0;s<o;++s)if(c=r[s],f=c.parent){if(l=h.get(f),!l)throw new Error("missing: "+f);if(l===CN)throw new Error("ambiguous: "+f);l.children?l.children.push(c):l.children=[c],c.parent=l}else{if(u)throw new Error("multiple roots");u=c}if(!u)throw new Error("no root");if(u.parent=_oe,u.eachBefore(function(g){g.depth=g.parent.depth+1,--o}).eachBefore(bN),u.parent=null,o>0)throw new Error("cycle");return u}return n.id=function(i){return arguments.length?(e=Wp(i),n):e},n.parentId=function(i){return arguments.length?(t=Wp(i),n):t},n}function Soe(e,t){return e.parent===t.parent?1:2}function NE(e){var t=e.children;return t?t[0]:e.t}function RE(e){var t=e.children;return t?t[t.length-1]:e.t}function Ooe(e,t,n){var i=n/(t.i-e.i);t.c-=i,t.s+=n,e.c+=i,t.z+=n,t.m+=n}function Coe(e){for(var t=0,n=0,i=e.children,r=i.length,o;--r>=0;)o=i[r],o.z+=t,o.m+=t,t+=o.s+(n+=o.c)}function Foe(e,t,n){return e.a.parent===t.parent?e.a:n}function Gp(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}Gp.prototype=Object.create(Fl.prototype);function koe(e){for(var t=new Gp(e,0),n,i=[t],r,o,a,s;n=i.pop();)if(o=n._.children)for(n.children=new Array(s=o.length),a=s-1;a>=0;--a)i.push(r=n.children[a]=new Gp(o[a],a)),r.parent=n;return(t.parent=new Gp(null,0)).children=[t],t}function Doe(){var e=Soe,t=1,n=1,i=null;function r(l){var c=koe(l);if(c.eachAfter(o),c.parent.m=-c.z,c.eachBefore(a),i)l.eachBefore(u);else{var f=l,d=l,h=l;l.eachBefore(function(v){v.x<f.x&&(f=v),v.x>d.x&&(d=v),v.depth>h.depth&&(h=v)});var g=f===d?1:e(f,d)/2,p=g-f.x,m=t/(d.x+g+p),y=n/(h.depth||1);l.eachBefore(function(v){v.x=(v.x+p)*m,v.y=v.depth*y})}return l}function o(l){var c=l.children,f=l.parent.children,d=l.i?f[l.i-1]:null;if(c){Coe(l);var h=(c[0].z+c[c.length-1].z)/2;d?(l.z=d.z+e(l._,d._),l.m=l.z-h):l.z=h}else d&&(l.z=d.z+e(l._,d._));l.parent.A=s(l,d,l.parent.A||f[0])}function a(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function s(l,c,f){if(c){for(var d=l,h=l,g=c,p=d.parent.children[0],m=d.m,y=h.m,v=g.m,b=p.m,x;g=RE(g),d=NE(d),g&&d;)p=NE(p),h=RE(h),h.a=l,x=g.z+v-d.z-m+e(g._,d._),x>0&&(Ooe(Foe(g,l,f),l,x),m+=x,y+=x),v+=g.m,m+=d.m,b+=p.m,y+=h.m;g&&!RE(h)&&(h.t=g,h.m+=v-y),d&&!NE(p)&&(p.t=d,p.m+=m-b,f=l)}return f}function u(l){l.x*=t,l.y=l.depth*n}return r.separation=function(l){return arguments.length?(e=l,r):e},r.size=function(l){return arguments.length?(i=!1,t=+l[0],n=+l[1],r):i?null:[t,n]},r.nodeSize=function(l){return arguments.length?(i=!0,t=+l[0],n=+l[1],r):i?[t,n]:null},r}function Yp(e,t,n,i,r){for(var o=e.children,a,s=-1,u=o.length,l=e.value&&(r-n)/e.value;++s<u;)a=o[s],a.x0=t,a.x1=i,a.y0=n,a.y1=n+=a.value*l}var kN=(1+Math.sqrt(5))/2;function DN(e,t,n,i,r,o){for(var a=[],s=t.children,u,l,c=0,f=0,d=s.length,h,g,p=t.value,m,y,v,b,x,w,_;c<d;){h=r-n,g=o-i;do m=s[f++].value;while(!m&&f<d);for(y=v=m,w=Math.max(g/h,h/g)/(p*e),_=m*m*w,x=Math.max(v/_,_/y);f<d;++f){if(m+=l=s[f].value,l<y&&(y=l),l>v&&(v=l),_=m*m*w,b=Math.max(v/_,_/y),b>x){m-=l;break}x=b}a.push(u={value:m,dice:h<g,children:s.slice(c,f)}),u.dice?Ed(u,n,i,r,p?i+=g*m/p:o):Yp(u,n,i,p?n+=h*m/p:r,o),p-=m,c=f}return a}var MN=function e(t){function n(i,r,o,a,s){DN(t,i,r,o,a,s)}return n.ratio=function(i){return e((i=+i)>1?i:1)},n}(kN);function Moe(){var e=MN,t=!1,n=1,i=1,r=[0],o=Is,a=Is,s=Is,u=Is,l=Is;function c(d){return d.x0=d.y0=0,d.x1=n,d.y1=i,d.eachBefore(f),r=[0],t&&d.eachBefore(ON),d}function f(d){var h=r[d.depth],g=d.x0+h,p=d.y0+h,m=d.x1-h,y=d.y1-h;m<g&&(g=m=(g+m)/2),y<p&&(p=y=(p+y)/2),d.x0=g,d.y0=p,d.x1=m,d.y1=y,d.children&&(h=r[d.depth+1]=o(d)/2,g+=l(d)-h,p+=a(d)-h,m-=s(d)-h,y-=u(d)-h,m<g&&(g=m=(g+m)/2),y<p&&(p=y=(p+y)/2),e(d,g,p,m,y))}return c.round=function(d){return arguments.length?(t=!!d,c):t},c.size=function(d){return arguments.length?(n=+d[0],i=+d[1],c):[n,i]},c.tile=function(d){return arguments.length?(e=Wp(d),c):e},c.padding=function(d){return arguments.length?c.paddingInner(d).paddingOuter(d):c.paddingInner()},c.paddingInner=function(d){return arguments.length?(o=typeof d=="function"?d:kl(+d),c):o},c.paddingOuter=function(d){return arguments.length?c.paddingTop(d).paddingRight(d).paddingBottom(d).paddingLeft(d):c.paddingTop()},c.paddingTop=function(d){return arguments.length?(a=typeof d=="function"?d:kl(+d),c):a},c.paddingRight=function(d){return arguments.length?(s=typeof d=="function"?d:kl(+d),c):s},c.paddingBottom=function(d){return arguments.length?(u=typeof d=="function"?d:kl(+d),c):u},c.paddingLeft=function(d){return arguments.length?(l=typeof d=="function"?d:kl(+d),c):l},c}function Toe(e,t,n,i,r){var o=e.children,a,s=o.length,u,l=new Array(s+1);for(l[0]=u=a=0;a<s;++a)l[a+1]=u+=o[a].value;c(0,s,e.value,t,n,i,r);function c(f,d,h,g,p,m,y){if(f>=d-1){var v=o[f];v.x0=g,v.y0=p,v.x1=m,v.y1=y;return}for(var b=l[f],x=h/2+b,w=f+1,_=d-1;w<_;){var E=w+_>>>1;l[E]<x?w=E+1:_=E}x-l[w-1]<l[w]-x&&f+1<w&&--w;var $=l[w]-b,O=h-$;if(m-g>y-p){var C=h?(g*O+m*$)/h:m;c(f,w,$,g,p,C,y),c(w,d,O,C,p,m,y)}else{var A=h?(p*O+y*$)/h:y;c(f,w,$,g,p,m,A),c(w,d,O,g,A,m,y)}}}function Noe(e,t,n,i,r){(e.depth&1?Yp:Ed)(e,t,n,i,r)}var Roe=function e(t){function n(i,r,o,a,s){if((u=i._squarify)&&u.ratio===t)for(var u,l,c,f,d=-1,h,g=u.length,p=i.value;++d<g;){for(l=u[d],c=l.children,f=l.value=0,h=c.length;f<h;++f)l.value+=c[f].value;l.dice?Ed(l,r,o,a,p?o+=(s-o)*l.value/p:s):Yp(l,r,o,p?r+=(a-r)*l.value/p:a,s),p-=l.value}else i._squarify=u=DN(t,i,r,o,a,s),u.ratio=t}return n.ratio=function(i){return e((i=+i)>1?i:1)},n}(kN);function jE(e,t,n){const i={};return e.each(r=>{const o=r.data;n(o)&&(i[t(o)]=r)}),e.lookup=i,e}function LE(e){N.call(this,null,e)}LE.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const joe=e=>e.values;q(LE,N,{transform(e,t){t.source||I("Nest transform requires an upstream data source.");var n=e.generate,i=e.modified(),r=t.clone(),o=this.value;return(!o||i||t.changed())&&(o&&o.each(a=>{a.children&&D0(a.data)&&r.rem.push(a.data)}),this.value=o=DE({values:oe(e.keys).reduce((a,s)=>(a.key(s),a),Loe()).entries(r.source)},joe),n&&o.each(a=>{a.children&&(a=Le(a.data),r.add.push(a),r.source.push(a))}),jE(o,ee,ee)),r.source.root=o,r}});function Loe(){const e=[],t={entries:r=>i(n(r,0),0),key:r=>(e.push(r),t)};function n(r,o){if(o>=e.length)return r;const a=r.length,s=e[o++],u={},l={};let c=-1,f,d,h;for(;++c<a;)f=s(d=r[c])+"",(h=u[f])?h.push(d):u[f]=[d];for(f in u)l[f]=n(u[f],o);return l}function i(r,o){if(++o>e.length)return r;const a=[];for(const s in r)a.push({key:s,values:i(r[s],o)});return a}return t}function So(e){N.call(this,null,e)}const Poe=(e,t)=>e.parent===t.parent?1:2;q(So,N,{transform(e,t){(!t.source||!t.source.root)&&I(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),i=this.fields,r=t.source.root,o=e.as||i;e.field?r.sum(e.field):r.count(),e.sort&&r.sort(hs(e.sort,a=>a.data)),Ioe(n,this.params,e),n.separation&&n.separation(e.separation!==!1?Poe:ju);try{this.value=n(r)}catch(a){I(a)}return r.each(a=>Boe(a,i,o)),t.reflow(e.modified()).modifies(o).modifies("leaf")}});function Ioe(e,t,n){for(let i,r=0,o=t.length;r<o;++r)i=t[r],i in n&&e[i](n[i])}function Boe(e,t,n){const i=e.data,r=t.length-1;for(let o=0;o<r;++o)i[n[o]]=e[t[o]];i[n[r]]=e.children?e.children.length:0}const PE=["x","y","r","depth","children"];function IE(e){So.call(this,e)}IE.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:PE.length,default:PE}]};q(IE,So,{layout:woe,params:["radius","size","padding"],fields:PE});const BE=["x0","y0","x1","y1","depth","children"];function zE(e){So.call(this,e)}zE.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:BE.length,default:BE}]};q(zE,So,{layout:Eoe,params:["size","round","padding"],fields:BE});function UE(e){N.call(this,null,e)}UE.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]};q(UE,N,{transform(e,t){t.source||I("Stratify transform requires an upstream data source.");let n=this.value;const i=e.modified(),r=t.fork(t.ALL).materialize(t.SOURCE),o=!n||i||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return r.source=r.source.slice(),o&&(n=r.source.length?jE(FN().id(e.key).parentId(e.parentKey)(r.source),e.key,xi):jE(FN()([{}]),e.key,e.key)),r.source.root=this.value=n,r}});const TN={tidy:Doe,cluster:Gre},qE=["x","y","depth","children"];function HE(e){So.call(this,e)}HE.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:qE.length,default:qE}]};q(HE,So,{layout(e){const t=e||"tidy";if(ae(TN,t))return TN[t]();I("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:qE});function WE(e){N.call(this,[],e)}WE.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]};q(WE,N,{transform(e,t){const n=this.value,i=t.source&&t.source.root,r=t.fork(t.NO_SOURCE),o={};return i||I("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(r.rem=n,t.visit(t.SOURCE,a=>o[ee(a)]=1),i.each(a=>{const s=a.data,u=a.parent&&a.parent.data;u&&o[ee(s)]&&o[ee(u)]&&r.add.push(Le({source:u,target:s}))}),this.value=r.add):t.changed(t.MOD)&&(t.visit(t.MOD,a=>o[ee(a)]=1),n.forEach(a=>{(o[ee(a.source)]||o[ee(a.target)])&&r.mod.push(a)})),r}});const NN={binary:Toe,dice:Ed,slice:Yp,slicedice:Noe,squarify:MN,resquarify:Roe},GE=["x0","y0","x1","y1","depth","children"];function YE(e){So.call(this,e)}YE.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:GE.length,default:GE}]};q(YE,So,{layout(){const e=Moe();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{ae(NN,t)?e.tile(NN[t]):I("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:GE});var zoe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",nest:LE,pack:IE,partition:zE,stratify:UE,tree:HE,treelinks:WE,treemap:YE});const Uoe=4278190080,qoe=268435456,Hoe=.0625;function Woe(e,t){const n=e.bitmap();return(t||[]).forEach(i=>n.set(e(i.boundary[0]),e(i.boundary[3]))),[n,void 0]}function Goe(e,t,n,i){const r=e.width,o=e.height,a=n||i,s=Ku(r,o).getContext("2d");t.forEach(m=>RN(s,m,a));const u=new Uint32Array(s.getImageData(0,0,r,o).data.buffer),l=e.bitmap(),c=a&&e.bitmap();let f,d,h,g,p;for(d=0;d<o;++d)for(f=0;f<r;++f)p=u[d*r+f]&Uoe,p&&(h=e(f),g=e(d),i||l.set(h,g),a&&p^qoe&&c.set(h,g));return[l,c]}function RN(e,t,n){if(!t.length)return;const i=t[0].mark.marktype;i==="group"?t.forEach(r=>{r.items.forEach(o=>RN(e,o.items,n))}):ai[i].draw(e,{items:n?t.map(Yoe):t})}function Yoe(e){const t=M0(e,{});return t.stroke&&(t.strokeOpacity=1),t.fill&&(t.fillOpacity=Hoe,t.stroke="#000",t.strokeOpacity=1,t.strokeWidth=2),t}const Oo=5,_n=31,_d=32,Sa=new Uint32Array(_d+1),er=new Uint32Array(_d+1);er[0]=0;Sa[0]=~er[0];for(let e=1;e<=_d;++e)er[e]=er[e-1]<<1|1,Sa[e]=~er[e];function Voe(e,t){const n=new Uint32Array(~~((e*t+_d)/_d));function i(o,a){n[o]|=a}function r(o,a){n[o]&=a}return{array:n,get:(o,a)=>{const s=a*e+o;return n[s>>>Oo]&1<<(s&_n)},set:(o,a)=>{const s=a*e+o;i(s>>>Oo,1<<(s&_n))},clear:(o,a)=>{const s=a*e+o;r(s>>>Oo,~(1<<(s&_n)))},getRange:(o,a,s,u)=>{let l=u,c,f,d,h;for(;l>=a;--l)if(c=l*e+o,f=l*e+s,d=c>>>Oo,h=f>>>Oo,d===h){if(n[d]&Sa[c&_n]&er[(f&_n)+1])return!0}else{if(n[d]&Sa[c&_n]||n[h]&er[(f&_n)+1])return!0;for(let g=d+1;g<h;++g)if(n[g])return!0}return!1},setRange:(o,a,s,u)=>{let l,c,f,d,h;for(;a<=u;++a)if(l=a*e+o,c=a*e+s,f=l>>>Oo,d=c>>>Oo,f===d)i(f,Sa[l&_n]&er[(c&_n)+1]);else for(i(f,Sa[l&_n]),i(d,er[(c&_n)+1]),h=f+1;h<d;++h)i(h,4294967295)},clearRange:(o,a,s,u)=>{let l,c,f,d,h;for(;a<=u;++a)if(l=a*e+o,c=a*e+s,f=l>>>Oo,d=c>>>Oo,f===d)r(f,er[l&_n]|Sa[(c&_n)+1]);else for(r(f,er[l&_n]),r(d,Sa[(c&_n)+1]),h=f+1;h<d;++h)r(h,0)},outOfBounds:(o,a,s,u)=>o<0||a<0||u>=t||s>=e}}function Xoe(e,t,n){const i=Math.max(1,Math.sqrt(e*t/1e6)),r=~~((e+2*n+i)/i),o=~~((t+2*n+i)/i),a=s=>~~((s+n)/i);return a.invert=s=>s*i-n,a.bitmap=()=>Voe(r,o),a.ratio=i,a.padding=n,a.width=e,a.height=t,a}function Koe(e,t,n,i){const r=e.width,o=e.height;return function(a){const s=a.datum.datum.items[i].items,u=s.length,l=a.datum.fontSize,c=Fr.width(a.datum,a.datum.text);let f=0,d,h,g,p,m,y,v;for(let b=0;b<u;++b)d=s[b].x,g=s[b].y,h=s[b].x2===void 0?d:s[b].x2,p=s[b].y2===void 0?g:s[b].y2,m=(d+h)/2,y=(g+p)/2,v=Math.abs(h-d+p-g),v>=f&&(f=v,a.x=m,a.y=y);return m=c/2,y=l/2,d=a.x-m,h=a.x+m,g=a.y-y,p=a.y+y,a.align="center",d<0&&h<=r?a.align="left":0<=d&&r<h&&(a.align="right"),a.baseline="middle",g<0&&p<=o?a.baseline="top":0<=g&&o<p&&(a.baseline="bottom"),!0}}function Joe(e,t,n,i,r,o){let a=n/2;return e-a<0||e+a>r||t-(a=i/2)<0||t+a>o}function Zoe(){return!1}function Qoe(e,t,n,i,r,o,a,s){const u=r*o/(i*2),l=e(t-u),c=e(t+u),f=e(n-(o=o/2)),d=e(n+o);return a.outOfBounds(l,f,c,d)||a.getRange(l,f,c,d)||s&&s.getRange(l,f,c,d)}function eae(e,t,n,i,r,o,a,s){const u=r*o/(i*2);let l=e(t-u),c=e(t+u),f=e(n-(o=o/2)),d=e(n+o);return l=l>0?l:0,f=f>0?f:0,c=c<e.width?c:e.width-1,d=d<e.height?d:e.height-1,a.getRange(l,f,c,d)||s&&s.getRange(l,f,c,d)}function jN(e){return e?[eae,Zoe]:[Qoe,Joe]}function tae(e,t,n,i,r){const o=e.width,a=e.height,[s,u]=jN(r),l=t[0],c=t[1];function f(d,h,g,p,m){const y=e.invert(d),v=e.invert(h);let b=g,x=a,w;if(!u(y,v,p,m,o,a)&&!s(e,y,v,m,p,b,l,c)&&!s(e,y,v,m,p,m,l,null)){for(;x-b>=1;)w=(b+x)/2,s(e,y,v,m,p,w,l,c)?x=w:b=w;if(b>g)return[y,v,b,!0]}}return function(d){const h=d.datum.datum.items[i].items,g=h.length,p=d.datum.fontSize,m=Fr.width(d.datum,d.datum.text);let y=n?p:0,v=!1,b=!1,x=0,w,_,E,$,O,C,A,D,F,T,S,M,P,B,H,re,le;for(let he=0;he<g;++he){for(w=h[he].x,E=h[he].y,_=h[he].x2===void 0?w:h[he].x2,$=h[he].y2===void 0?E:h[he].y2,w>_&&(le=w,w=_,_=le),E>$&&(le=E,E=$,$=le),F=e(w),S=e(_),T=~~((F+S)/2),M=e(E),B=e($),P=~~((M+B)/2),A=T;A>=F;--A)for(D=P;D>=M;--D)re=f(A,D,y,m,p),re&&([d.x,d.y,y,v]=re);for(A=T;A<=S;++A)for(D=P;D<=B;++D)re=f(A,D,y,m,p),re&&([d.x,d.y,y,v]=re);!v&&!n&&(H=Math.abs(_-w+$-E),O=(w+_)/2,C=(E+$)/2,H>=x&&!u(O,C,m,p,o,a)&&!s(e,O,C,p,m,p,l,null)&&(x=H,d.x=O,d.y=C,b=!0))}return v||b?(O=m/2,C=p/2,l.setRange(e(d.x-O),e(d.y-C),e(d.x+O),e(d.y+C)),d.align="center",d.baseline="middle",!0):!1}}const nae=[-1,-1,1,1],iae=[-1,1,-1,1];function rae(e,t,n,i,r){const o=e.width,a=e.height,[s,u]=jN(r),l=t[0],c=t[1],f=e.bitmap();return function(d){const h=d.datum.datum.items[i].items,g=h.length,p=d.datum.fontSize,m=Fr.width(d.datum,d.datum.text),y=[];let v=n?p:0,b=!1,x=!1,w=0,_,E,$,O,C,A,D,F,T,S,M,P;for(let B=0;B<g;++B){for(_=h[B].x,$=h[B].y,E=h[B].x2===void 0?_:h[B].x2,O=h[B].y2===void 0?$:h[B].y2,y.push([e((_+E)/2),e(($+O)/2)]);y.length;)if([D,F]=y.pop(),!(l.get(D,F)||c.get(D,F)||f.get(D,F))){f.set(D,F);for(let H=0;H<4;++H)C=D+nae[H],A=F+iae[H],f.outOfBounds(C,A,C,A)||y.push([C,A]);if(C=e.invert(D),A=e.invert(F),T=v,S=a,!u(C,A,m,p,o,a)&&!s(e,C,A,p,m,T,l,c)&&!s(e,C,A,p,m,p,l,null)){for(;S-T>=1;)M=(T+S)/2,s(e,C,A,p,m,M,l,c)?S=M:T=M;T>v&&(d.x=C,d.y=A,v=T,b=!0)}}!b&&!n&&(P=Math.abs(E-_+O-$),C=(_+E)/2,A=($+O)/2,P>=w&&!u(C,A,m,p,o,a)&&!s(e,C,A,p,m,p,l,null)&&(w=P,d.x=C,d.y=A,x=!0))}return b||x?(C=m/2,A=p/2,l.setRange(e(d.x-C),e(d.y-A),e(d.x+C),e(d.y+A)),d.align="center",d.baseline="middle",!0):!1}}const oae=["right","center","left"],aae=["bottom","middle","top"];function sae(e,t,n,i,r){const o=e.width,a=e.height,s=t[0],u=t[1],l=i.length;return function(c){const f=c.boundary,d=c.datum.fontSize;if(!r&&(f[2]<0||f[5]<0||f[0]>o||f[3]>a))return!1;let h=0,g,p,m,y,v,b,x,w,_,E,$,O,C,A,D;for(let F=0;F<l;++F){if(g=(n[F]&3)-1,p=(n[F]>>>2&3)-1,m=g===0&&p===0||i[F]<0,y=g&&p?Math.SQRT1_2:1,v=i[F]<0?-1:1,b=f[1+g]+i[F]*g*y,$=f[4+p]+v*d*p/2+i[F]*p*y,w=$-d/2,_=$+d/2,O=e(b),A=e(w),D=e(_),r&&(O=O<0?0:O,A=A<0?0:A,D=D>=e.height?e.height-1:D),!h)if(LN(O,O,A,D,s,u,b,b,w,_,f,m))h=Fr.width(c.datum,c.datum.text);else continue;if(E=b+v*h*g/2,b=E-h/2,x=E+h/2,O=e(b),C=e(x),r&&(O=O<0?0:O,C=C>=e.width?e.width-1:C),LN(O,C,A,D,s,u,b,x,w,_,f,m))return c.x=g?g*v<0?x:b:E,c.y=p?p*v<0?_:w:$,c.align=oae[g*v+1],c.baseline=aae[p*v+1],s.setRange(O,A,C,D),!0}return!1}}function LN(e,t,n,i,r,o,a,s,u,l,c,f){return!(r.outOfBounds(e,n,t,i)||(f&&o?o.getRange(e,n,t,i)||!uae(a,u,s,l,c):r.getRange(e,n,t,i)))}function uae(e,t,n,i,r){return r[0]<=e&&n<=r[2]&&r[3]<=t&&i<=r[5]}const VE=0,XE=4,KE=8,JE=0,ZE=1,QE=2,lae={"top-left":VE+JE,top:VE+ZE,"top-right":VE+QE,left:XE+JE,middle:XE+ZE,right:XE+QE,"bottom-left":KE+JE,bottom:KE+ZE,"bottom-right":KE+QE},cae={naive:Koe,"reduced-search":tae,floodfill:rae};function fae(e,t,n,i,r,o,a,s,u,l,c){if(!e.length)return e;const f=Math.max(i.length,r.length),d=dae(i,f),h=hae(r,f),g=gae(e[0].datum),p=g==="group"&&e[0].datum.items[u].marktype,m=p==="area",y=pae(g,p,s,u),v=l===null||l===1/0,b=Xoe(t[0],t[1],v?0:l),x=m&&c==="naive",w=e.map($=>({datum:$,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:y($)}));let _;if(!x){n&&w.sort((O,C)=>n(O.datum,C.datum));let $=!1;for(let O=0;O<h.length&&!$;++O)$=h[O]===5||d[O]<0;g&&(a||m)&&(o=[e.map(O=>O.datum)].concat(o)),_=o.length?Goe(b,o,$,m):Woe(b,a&&w)}const E=m?cae[c](b,_,a,u,v):sae(b,_,h,d,v);return w.forEach($=>$.opacity=+E($)),w}function dae(e,t){const n=new Float64Array(t),i=e.length;for(let r=0;r<i;++r)n[r]=e[r]||0;for(let r=i;r<t;++r)n[r]=n[i-1];return n}function hae(e,t){const n=new Int8Array(t),i=e.length;for(let r=0;r<i;++r)n[r]|=lae[e[r]];for(let r=i;r<t;++r)n[r]=n[i-1];return n}function gae(e){return e&&e.mark&&e.mark.marktype}function pae(e,t,n,i){const r=o=>[o.x,o.x,o.x,o.y,o.y,o.y];return e?e==="line"||e==="area"?o=>r(o.datum):t==="line"?o=>{const a=o.datum.items[i].items;return r(a.length?a[n==="start"?0:a.length-1]:{x:NaN,y:NaN})}:o=>{const a=o.datum.bounds;return[a.x1,(a.x1+a.x2)/2,a.x2,a.y1,(a.y1+a.y2)/2,a.y2]}:r}const e_=["x","y","opacity","align","baseline"],PN=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function t_(e){N.call(this,null,e)}t_.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:PN},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:e_.length,default:e_}]};q(t_,N,{transform(e,t){function n(o){const a=e[o];return me(a)&&t.modified(a.fields)}const i=e.modified();if(!(i||t.changed(t.ADD_REM)||n("sort")))return;(!e.size||e.size.length!==2)&&I("Size parameter should be specified as a [width, height] array.");const r=e.as||e_;return fae(t.materialize(t.SOURCE).source||[],e.size,e.sort,oe(e.offset==null?1:e.offset),oe(e.anchor||PN),e.avoidMarks||[],e.avoidBaseMark!==!1,e.lineAnchor||"end",e.markIndex||0,e.padding===void 0?0:e.padding,e.method||"naive").forEach(o=>{const a=o.datum;a[r[0]]=o.x,a[r[1]]=o.y,a[r[2]]=o.opacity,a[r[3]]=o.align,a[r[4]]=o.baseline}),t.reflow(i).modifies(r)}});var mae=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",label:t_});function IN(e,t){var n=[],i=function(c){return c(s)},r,o,a,s,u,l;if(t==null)n.push(e);else for(r={},o=0,a=e.length;o<a;++o)s=e[o],u=t.map(i),l=r[u],l||(r[u]=l=[],l.dims=u,n.push(l)),l.push(s);return n}function n_(e){N.call(this,null,e)}n_.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]};q(n_,N,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=IN(i,e.groupby),o=(e.groupby||[]).map(ut),a=o.length,s=e.as||[ut(e.x),ut(e.y)],u=[];r.forEach(l=>{I3(l,e.x,e.y,e.bandwidth||.3).forEach(c=>{const f={};for(let d=0;d<a;++d)f[o[d]]=l.dims[d];f[s[0]]=c[0],f[s[1]]=c[1],u.push(Le(f))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});const i_={linear:sb,log:T3,exp:N3,pow:R3,quad:ub,poly:j3},yae=(e,t)=>e==="poly"?t:e==="quad"?2:1;function r_(e){N.call(this,null,e)}r_.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(i_)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]};q(r_,N,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=IN(i,e.groupby),o=(e.groupby||[]).map(ut),a=e.method||"linear",s=e.order||3,u=yae(a,s),l=e.as||[ut(e.x),ut(e.y)],c=i_[a],f=[];let d=e.extent;ae(i_,a)||I("Invalid regression method: "+a),d!=null&&a==="log"&&d[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),d=null),r.forEach(h=>{if(h.length<=u){t.dataflow.warn("Skipping regression with more parameters than data points.");return}const p=c(h,e.x,e.y,s);if(e.params){f.push(Le({keys:h.dims,coef:p.coef,rSquared:p.rSquared}));return}const m=d||vr(h,e.x),y=v=>{const b={};for(let x=0;x<o.length;++x)b[o[x]]=h.dims[x];b[l[0]]=v[0],b[l[1]]=v[1],f.push(Le(b))};a==="linear"?m.forEach(v=>y([v,p.predict(v)])):U0(p.predict,m,25,200).forEach(y)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=f}return n}});var vae=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",loess:n_,regression:r_});const BN=Math.pow(2,-52),Vp=new Uint32Array(512);class Xp{static from(t,n=_ae,i=Aae){const r=t.length,o=new Float64Array(r*2);for(let a=0;a<r;a++){const s=t[a];o[2*a]=n(s),o[2*a+1]=i(s)}return new Xp(o)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const i=Math.max(2*n-5,0);this._triangles=new Uint32Array(i*3),this._halfedges=new Int32Array(i*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:i,_hullTri:r,_hullHash:o}=this,a=t.length>>1;let s=1/0,u=1/0,l=-1/0,c=-1/0;for(let C=0;C<a;C++){const A=t[2*C],D=t[2*C+1];A<s&&(s=A),D<u&&(u=D),A>l&&(l=A),D>c&&(c=D),this._ids[C]=C}const f=(s+l)/2,d=(u+c)/2;let h=1/0,g,p,m;for(let C=0;C<a;C++){const A=o_(f,d,t[2*C],t[2*C+1]);A<h&&(g=C,h=A)}const y=t[2*g],v=t[2*g+1];h=1/0;for(let C=0;C<a;C++){if(C===g)continue;const A=o_(y,v,t[2*C],t[2*C+1]);A<h&&A>0&&(p=C,h=A)}let b=t[2*p],x=t[2*p+1],w=1/0;for(let C=0;C<a;C++){if(C===g||C===p)continue;const A=wae(y,v,b,x,t[2*C],t[2*C+1]);A<w&&(m=C,w=A)}let _=t[2*m],E=t[2*m+1];if(w===1/0){for(let D=0;D<a;D++)this._dists[D]=t[2*D]-t[0]||t[2*D+1]-t[1];Dl(this._ids,this._dists,0,a-1);const C=new Uint32Array(a);let A=0;for(let D=0,F=-1/0;D<a;D++){const T=this._ids[D];this._dists[T]>F&&(C[A++]=T,F=this._dists[T])}this.hull=C.subarray(0,A),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(Kp(y,v,b,x,_,E)){const C=p,A=b,D=x;p=m,b=_,x=E,m=C,_=A,E=D}const $=Eae(y,v,b,x,_,E);this._cx=$.x,this._cy=$.y;for(let C=0;C<a;C++)this._dists[C]=o_(t[2*C],t[2*C+1],$.x,$.y);Dl(this._ids,this._dists,0,a-1),this._hullStart=g;let O=3;i[g]=n[m]=p,i[p]=n[g]=m,i[m]=n[p]=g,r[g]=0,r[p]=1,r[m]=2,o.fill(-1),o[this._hashKey(y,v)]=g,o[this._hashKey(b,x)]=p,o[this._hashKey(_,E)]=m,this.trianglesLen=0,this._addTriangle(g,p,m,-1,-1,-1);for(let C=0,A,D;C<this._ids.length;C++){const F=this._ids[C],T=t[2*F],S=t[2*F+1];if(C>0&&Math.abs(T-A)<=BN&&Math.abs(S-D)<=BN||(A=T,D=S,F===g||F===p||F===m))continue;let M=0;for(let le=0,he=this._hashKey(T,S);le<this._hashSize&&(M=o[(he+le)%this._hashSize],!(M!==-1&&M!==i[M]));le++);M=n[M];let P=M,B;for(;B=i[P],!Kp(T,S,t[2*P],t[2*P+1],t[2*B],t[2*B+1]);)if(P=B,P===M){P=-1;break}if(P===-1)continue;let H=this._addTriangle(P,F,i[P],-1,-1,r[P]);r[F]=this._legalize(H+2),r[P]=H,O++;let re=i[P];for(;B=i[re],Kp(T,S,t[2*re],t[2*re+1],t[2*B],t[2*B+1]);)H=this._addTriangle(re,F,B,r[F],-1,r[re]),r[F]=this._legalize(H+2),i[re]=re,O--,re=B;if(P===M)for(;B=n[P],Kp(T,S,t[2*B],t[2*B+1],t[2*P],t[2*P+1]);)H=this._addTriangle(B,F,P,-1,r[P],r[B]),this._legalize(H+2),r[B]=H,i[P]=P,O--,P=B;this._hullStart=n[F]=P,i[P]=n[re]=F,i[F]=re,o[this._hashKey(T,S)]=F,o[this._hashKey(t[2*P],t[2*P+1])]=P}this.hull=new Uint32Array(O);for(let C=0,A=this._hullStart;C<O;C++)this.hull[C]=A,A=i[A];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(bae(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:i,coords:r}=this;let o=0,a=0;for(;;){const s=i[t],u=t-t%3;if(a=u+(t+2)%3,s===-1){if(o===0)break;t=Vp[--o];continue}const l=s-s%3,c=u+(t+1)%3,f=l+(s+2)%3,d=n[a],h=n[t],g=n[c],p=n[f];if(xae(r[2*d],r[2*d+1],r[2*h],r[2*h+1],r[2*g],r[2*g+1],r[2*p],r[2*p+1])){n[t]=p,n[s]=d;const y=i[f];if(y===-1){let b=this._hullStart;do{if(this._hullTri[b]===f){this._hullTri[b]=t;break}b=this._hullPrev[b]}while(b!==this._hullStart)}this._link(t,y),this._link(s,i[a]),this._link(a,f);const v=l+(s+1)%3;o<Vp.length&&(Vp[o++]=v)}else{if(o===0)break;t=Vp[--o]}}return a}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,i,r,o,a){const s=this.trianglesLen;return this._triangles[s]=t,this._triangles[s+1]=n,this._triangles[s+2]=i,this._link(s,r),this._link(s+1,o),this._link(s+2,a),this.trianglesLen+=3,s}}function bae(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function o_(e,t,n,i){const r=e-n,o=t-i;return r*r+o*o}function a_(e,t,n,i,r,o){const a=(i-t)*(r-e),s=(n-e)*(o-t);return Math.abs(a-s)>=33306690738754716e-32*Math.abs(a+s)?a-s:0}function Kp(e,t,n,i,r,o){return(a_(r,o,e,t,n,i)||a_(e,t,n,i,r,o)||a_(n,i,r,o,e,t))<0}function xae(e,t,n,i,r,o,a,s){const u=e-a,l=t-s,c=n-a,f=i-s,d=r-a,h=o-s,g=u*u+l*l,p=c*c+f*f,m=d*d+h*h;return u*(f*m-p*h)-l*(c*m-p*d)+g*(c*h-f*d)<0}function wae(e,t,n,i,r,o){const a=n-e,s=i-t,u=r-e,l=o-t,c=a*a+s*s,f=u*u+l*l,d=.5/(a*l-s*u),h=(l*c-s*f)*d,g=(a*f-u*c)*d;return h*h+g*g}function Eae(e,t,n,i,r,o){const a=n-e,s=i-t,u=r-e,l=o-t,c=a*a+s*s,f=u*u+l*l,d=.5/(a*l-s*u),h=e+(l*c-s*f)*d,g=t+(a*f-u*c)*d;return{x:h,y:g}}function Dl(e,t,n,i){if(i-n<=20)for(let r=n+1;r<=i;r++){const o=e[r],a=t[o];let s=r-1;for(;s>=n&&t[e[s]]>a;)e[s+1]=e[s--];e[s+1]=o}else{const r=n+i>>1;let o=n+1,a=i;Ad(e,r,o),t[e[n]]>t[e[i]]&&Ad(e,n,i),t[e[o]]>t[e[i]]&&Ad(e,o,i),t[e[n]]>t[e[o]]&&Ad(e,n,o);const s=e[o],u=t[s];for(;;){do o++;while(t[e[o]]<u);do a--;while(t[e[a]]>u);if(a<o)break;Ad(e,o,a)}e[n+1]=e[a],e[a]=s,i-o+1>=a-n?(Dl(e,t,o,i),Dl(e,t,n,a-1)):(Dl(e,t,n,a-1),Dl(e,t,o,i))}}function Ad(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function _ae(e){return e[0]}function Aae(e){return e[1]}const zN=1e-6;class Bs{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,i){t=+t,n=+n,i=+i;const r=t+i,o=n;if(i<0)throw new Error("negative radius");this._x1===null?this._+=`M${r},${o}`:(Math.abs(this._x1-r)>zN||Math.abs(this._y1-o)>zN)&&(this._+="L"+r+","+o),!!i&&(this._+=`A${i},${i},0,1,1,${t-i},${n}A${i},${i},0,1,1,${this._x1=r},${this._y1=o}`)}rect(t,n,i,r){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+i}v${+r}h${-i}Z`}value(){return this._||null}}class s_{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}class $ae{constructor(t,[n,i,r,o]=[0,0,960,500]){if(!((r=+r)>=(n=+n))||!((o=+o)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=r,this.xmin=n,this.ymax=o,this.ymin=i,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:i},vectors:r}=this,o=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2);for(let h=0,g=0,p=i.length,m,y;h<p;h+=3,g+=2){const v=i[h]*2,b=i[h+1]*2,x=i[h+2]*2,w=t[v],_=t[v+1],E=t[b],$=t[b+1],O=t[x],C=t[x+1],A=E-w,D=$-_,F=O-w,T=C-_,S=A*A+D*D,M=F*F+T*T,P=(A*T-D*F)*2;if(!P)m=(w+O)/2-1e8*T,y=(_+C)/2+1e8*F;else if(Math.abs(P)<1e-8)m=(w+O)/2,y=(_+C)/2;else{const B=1/P;m=w+(T*S-D*M)*B,y=_+(A*M-F*S)*B}o[g]=m,o[g+1]=y}let a=n[n.length-1],s,u=a*4,l,c=t[2*a],f,d=t[2*a+1];r.fill(0);for(let h=0;h<n.length;++h)a=n[h],s=u,l=c,f=d,u=a*4,c=t[2*a],d=t[2*a+1],r[s+2]=r[u]=f-d,r[s+3]=r[u+1]=c-l}render(t){const n=t==null?t=new Bs:void 0,{delaunay:{halfedges:i,inedges:r,hull:o},circumcenters:a,vectors:s}=this;if(o.length<=1)return null;for(let c=0,f=i.length;c<f;++c){const d=i[c];if(d<c)continue;const h=Math.floor(c/3)*2,g=Math.floor(d/3)*2,p=a[h],m=a[h+1],y=a[g],v=a[g+1];this._renderSegment(p,m,y,v,t)}let u,l=o[o.length-1];for(let c=0;c<o.length;++c){u=l,l=o[c];const f=Math.floor(r[l]/3)*2,d=a[f],h=a[f+1],g=u*4,p=this._project(d,h,s[g+2],s[g+3]);p&&this._renderSegment(d,h,p[0],p[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new Bs:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const i=n==null?n=new Bs:void 0,r=this._clip(t);if(r===null||!r.length)return;n.moveTo(r[0],r[1]);let o=r.length;for(;r[0]===r[o-2]&&r[1]===r[o-1]&&o>1;)o-=2;for(let a=2;a<o;a+=2)(r[a]!==r[a-2]||r[a+1]!==r[a-1])&&n.lineTo(r[a],r[a+1]);return n.closePath(),i&&i.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,i=t.length/2;n<i;++n){const r=this.cellPolygon(n);r&&(r.index=n,yield r)}}cellPolygon(t){const n=new s_;return this.renderCell(t,n),n.value()}_renderSegment(t,n,i,r,o){let a;const s=this._regioncode(t,n),u=this._regioncode(i,r);s===0&&u===0?(o.moveTo(t,n),o.lineTo(i,r)):(a=this._clipSegment(t,n,i,r,s,u))&&(o.moveTo(a[0],a[1]),o.lineTo(a[2],a[3]))}contains(t,n,i){return n=+n,n!==n||(i=+i,i!==i)?!1:this.delaunay._step(t,n,i)===t}*neighbors(t){const n=this._clip(t);if(n)for(const i of this.delaunay.neighbors(t)){const r=this._clip(i);if(r)e:for(let o=0,a=n.length;o<a;o+=2)for(let s=0,u=r.length;s<u;s+=2)if(n[o]==r[s]&&n[o+1]==r[s+1]&&n[(o+2)%a]==r[(s+u-2)%u]&&n[(o+3)%a]==r[(s+u-1)%u]){yield i;break e}}}_cell(t){const{circumcenters:n,delaunay:{inedges:i,halfedges:r,triangles:o}}=this,a=i[t];if(a===-1)return null;const s=[];let u=a;do{const l=Math.floor(u/3);if(s.push(n[l*2],n[l*2+1]),u=u%3==2?u-2:u+1,o[u]!==t)break;u=r[u]}while(u!==a&&u!==-1);return s}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:i}=this,r=t*4;return i[r]||i[r+1]?this._clipInfinite(t,n,i[r],i[r+1],i[r+2],i[r+3]):this._clipFinite(t,n)}_clipFinite(t,n){const i=n.length;let r=null,o,a,s=n[i-2],u=n[i-1],l,c=this._regioncode(s,u),f,d;for(let h=0;h<i;h+=2)if(o=s,a=u,s=n[h],u=n[h+1],l=c,c=this._regioncode(s,u),l===0&&c===0)f=d,d=0,r?r.push(s,u):r=[s,u];else{let g,p,m,y,v;if(l===0){if((g=this._clipSegment(o,a,s,u,l,c))===null)continue;[p,m,y,v]=g}else{if((g=this._clipSegment(s,u,o,a,c,l))===null)continue;[y,v,p,m]=g,f=d,d=this._edgecode(p,m),f&&d&&this._edge(t,f,d,r,r.length),r?r.push(p,m):r=[p,m]}f=d,d=this._edgecode(y,v),f&&d&&this._edge(t,f,d,r,r.length),r?r.push(y,v):r=[y,v]}if(r)f=d,d=this._edgecode(r[0],r[1]),f&&d&&this._edge(t,f,d,r,r.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return r}_clipSegment(t,n,i,r,o,a){for(;;){if(o===0&&a===0)return[t,n,i,r];if(o&a)return null;let s,u,l=o||a;l&8?(s=t+(i-t)*(this.ymax-n)/(r-n),u=this.ymax):l&4?(s=t+(i-t)*(this.ymin-n)/(r-n),u=this.ymin):l&2?(u=n+(r-n)*(this.xmax-t)/(i-t),s=this.xmax):(u=n+(r-n)*(this.xmin-t)/(i-t),s=this.xmin),o?(t=s,n=u,o=this._regioncode(t,n)):(i=s,r=u,a=this._regioncode(i,r))}}_clipInfinite(t,n,i,r,o,a){let s=Array.from(n),u;if((u=this._project(s[0],s[1],i,r))&&s.unshift(u[0],u[1]),(u=this._project(s[s.length-2],s[s.length-1],o,a))&&s.push(u[0],u[1]),s=this._clipFinite(t,s))for(let l=0,c=s.length,f,d=this._edgecode(s[c-2],s[c-1]);l<c;l+=2)f=d,d=this._edgecode(s[l],s[l+1]),f&&d&&(l=this._edge(t,f,d,s,l),c=s.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return s}_edge(t,n,i,r,o){for(;n!==i;){let a,s;switch(n){case 5:n=4;continue;case 4:n=6,a=this.xmax,s=this.ymin;break;case 6:n=2;continue;case 2:n=10,a=this.xmax,s=this.ymax;break;case 10:n=8;continue;case 8:n=9,a=this.xmin,s=this.ymax;break;case 9:n=1;continue;case 1:n=5,a=this.xmin,s=this.ymin;break}(r[o]!==a||r[o+1]!==s)&&this.contains(t,a,s)&&(r.splice(o,0,a,s),o+=2)}if(r.length>4)for(let a=0;a<r.length;a+=2){const s=(a+2)%r.length,u=(a+4)%r.length;(r[a]===r[s]&&r[s]===r[u]||r[a+1]===r[s+1]&&r[s+1]===r[u+1])&&(r.splice(s,2),a-=2)}return o}_project(t,n,i,r){let o=1/0,a,s,u;if(r<0){if(n<=this.ymin)return null;(a=(this.ymin-n)/r)<o&&(u=this.ymin,s=t+(o=a)*i)}else if(r>0){if(n>=this.ymax)return null;(a=(this.ymax-n)/r)<o&&(u=this.ymax,s=t+(o=a)*i)}if(i>0){if(t>=this.xmax)return null;(a=(this.xmax-t)/i)<o&&(s=this.xmax,u=n+(o=a)*r)}else if(i<0){if(t<=this.xmin)return null;(a=(this.xmin-t)/i)<o&&(s=this.xmin,u=n+(o=a)*r)}return[s,u]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}}const Sae=2*Math.PI,Ml=Math.pow;function Oae(e){return e[0]}function Cae(e){return e[1]}function Fae(e){const{triangles:t,coords:n}=e;for(let i=0;i<t.length;i+=3){const r=2*t[i],o=2*t[i+1],a=2*t[i+2];if((n[a]-n[r])*(n[o+1]-n[r+1])-(n[o]-n[r])*(n[a+1]-n[r+1])>1e-10)return!1}return!0}function kae(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class u_{static from(t,n=Oae,i=Cae,r){return new u_("length"in t?Dae(t,n,i,r):Float64Array.from(Mae(t,n,i,r)))}constructor(t){this._delaunator=new Xp(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&Fae(t)){this.collinear=Int32Array.from({length:n.length/2},(d,h)=>h).sort((d,h)=>n[2*d]-n[2*h]||n[2*d+1]-n[2*h+1]);const u=this.collinear[0],l=this.collinear[this.collinear.length-1],c=[n[2*u],n[2*u+1],n[2*l],n[2*l+1]],f=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let d=0,h=n.length/2;d<h;++d){const g=kae(n[2*d],n[2*d+1],f);n[2*d]=g[0],n[2*d+1]=g[1]}this._delaunator=new Xp(n)}else delete this.collinear;const i=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,o=this.triangles=this._delaunator.triangles,a=this.inedges.fill(-1),s=this._hullIndex.fill(-1);for(let u=0,l=i.length;u<l;++u){const c=o[u%3==2?u-2:u+1];(i[u]===-1||a[c]===-1)&&(a[c]=u)}for(let u=0,l=r.length;u<l;++u)s[r[u]]=u;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],this.triangles[1]=r[1],this.triangles[2]=r[1],a[r[0]]=1,r.length===2&&(a[r[1]]=0))}voronoi(t){return new $ae(this,t)}*neighbors(t){const{inedges:n,hull:i,_hullIndex:r,halfedges:o,triangles:a,collinear:s}=this;if(s){const f=s.indexOf(t);f>0&&(yield s[f-1]),f<s.length-1&&(yield s[f+1]);return}const u=n[t];if(u===-1)return;let l=u,c=-1;do{if(yield c=a[l],l=l%3==2?l-2:l+1,a[l]!==t)return;if(l=o[l],l===-1){const f=i[(r[t]+1)%i.length];f!==c&&(yield f);return}}while(l!==u)}find(t,n,i=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const r=i;let o;for(;(o=this._step(i,t,n))>=0&&o!==i&&o!==r;)i=o;return o}_step(t,n,i){const{inedges:r,hull:o,_hullIndex:a,halfedges:s,triangles:u,points:l}=this;if(r[t]===-1||!l.length)return(t+1)%(l.length>>1);let c=t,f=Ml(n-l[t*2],2)+Ml(i-l[t*2+1],2);const d=r[t];let h=d;do{let g=u[h];const p=Ml(n-l[g*2],2)+Ml(i-l[g*2+1],2);if(p<f&&(f=p,c=g),h=h%3==2?h-2:h+1,u[h]!==t)break;if(h=s[h],h===-1){if(h=o[(a[t]+1)%o.length],h!==g&&Ml(n-l[h*2],2)+Ml(i-l[h*2+1],2)<f)return h;break}}while(h!==d);return c}render(t){const n=t==null?t=new Bs:void 0,{points:i,halfedges:r,triangles:o}=this;for(let a=0,s=r.length;a<s;++a){const u=r[a];if(u<a)continue;const l=o[a]*2,c=o[u]*2;t.moveTo(i[l],i[l+1]),t.lineTo(i[c],i[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n=2){const i=t==null?t=new Bs:void 0,{points:r}=this;for(let o=0,a=r.length;o<a;o+=2){const s=r[o],u=r[o+1];t.moveTo(s+n,u),t.arc(s,u,n,0,Sae)}return i&&i.value()}renderHull(t){const n=t==null?t=new Bs:void 0,{hull:i,points:r}=this,o=i[0]*2,a=i.length;t.moveTo(r[o],r[o+1]);for(let s=1;s<a;++s){const u=2*i[s];t.lineTo(r[u],r[u+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new s_;return this.renderHull(t),t.value()}renderTriangle(t,n){const i=n==null?n=new Bs:void 0,{points:r,triangles:o}=this,a=o[t*=3]*2,s=o[t+1]*2,u=o[t+2]*2;return n.moveTo(r[a],r[a+1]),n.lineTo(r[s],r[s+1]),n.lineTo(r[u],r[u+1]),n.closePath(),i&&i.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,i=t.length/3;n<i;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new s_;return this.renderTriangle(t,n),n.value()}}function Dae(e,t,n,i){const r=e.length,o=new Float64Array(r*2);for(let a=0;a<r;++a){const s=e[a];o[a*2]=t.call(i,s,a,e),o[a*2+1]=n.call(i,s,a,e)}return o}function*Mae(e,t,n,i){let r=0;for(const o of e)yield t.call(i,o,r,e),yield n.call(i,o,r,e),++r}function l_(e){N.call(this,null,e)}l_.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const Tae=[-1e5,-1e5,1e5,1e5];q(l_,N,{transform(e,t){const n=e.as||"path",i=t.source;if(!i||!i.length)return t;let r=e.size;r=r?[0,0,r[0],r[1]]:(r=e.extent)?[r[0][0],r[0][1],r[1][0],r[1][1]]:Tae;const o=this.value=u_.from(i,e.x,e.y).voronoi(r);for(let a=0,s=i.length;a<s;++a){const u=o.cellPolygon(a);i[a][n]=u?Nae(u):null}return t.reflow(e.modified()).modifies(n)}});function Nae(e){const t=e[0][0],n=e[0][1];let i=e.length-1;for(;e[i][0]===t&&e[i][1]===n;--i);return"M"+e.slice(0,i+1).join("L")+"Z"}var Rae=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",voronoi:l_}),c_=Math.PI/180,$d=1<<11>>5,Jp=1<<11;function jae(){var e=[256,256],t,n,i,r,o,a,s,u=UN,l=[],c=Math.random,f={};f.layout=function(){for(var g=d(Ku()),p=Uae((e[0]>>5)*e[1]),m=null,y=l.length,v=-1,b=[],x=l.map(_=>({text:t(_),font:n(_),style:r(_),weight:o(_),rotate:a(_),size:~~(i(_)+1e-14),padding:s(_),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:_})).sort((_,E)=>E.size-_.size);++v<y;){var w=x[v];w.x=e[0]*(c()+.5)>>1,w.y=e[1]*(c()+.5)>>1,Lae(g,w,x,v),w.hasText&&h(p,w,m)&&(b.push(w),m?Iae(m,w):m=[{x:w.x+w.x0,y:w.y+w.y0},{x:w.x+w.x1,y:w.y+w.y1}],w.x-=e[0]>>1,w.y-=e[1]>>1)}return b};function d(g){g.width=g.height=1;var p=Math.sqrt(g.getContext("2d").getImageData(0,0,1,1).data.length>>2);g.width=($d<<5)/p,g.height=Jp/p;var m=g.getContext("2d");return m.fillStyle=m.strokeStyle="red",m.textAlign="center",{context:m,ratio:p}}function h(g,p,m){for(var y=p.x,v=p.y,b=Math.sqrt(e[0]*e[0]+e[1]*e[1]),x=u(e),w=c()<.5?1:-1,_=-w,E,$,O;(E=x(_+=w))&&($=~~E[0],O=~~E[1],!(Math.min(Math.abs($),Math.abs(O))>=b));)if(p.x=y+$,p.y=v+O,!(p.x+p.x0<0||p.y+p.y0<0||p.x+p.x1>e[0]||p.y+p.y1>e[1])&&(!m||!Pae(p,g,e[0]))&&(!m||Bae(p,m))){for(var C=p.sprite,A=p.width>>5,D=e[0]>>5,F=p.x-(A<<4),T=F&127,S=32-T,M=p.y1-p.y0,P=(p.y+p.y0)*D+(F>>5),B,H=0;H<M;H++){B=0;for(var re=0;re<=A;re++)g[P+re]|=B<<S|(re<A?(B=C[H*A+re])>>>T:0);P+=D}return p.sprite=null,!0}return!1}return f.words=function(g){return arguments.length?(l=g,f):l},f.size=function(g){return arguments.length?(e=[+g[0],+g[1]],f):e},f.font=function(g){return arguments.length?(n=zs(g),f):n},f.fontStyle=function(g){return arguments.length?(r=zs(g),f):r},f.fontWeight=function(g){return arguments.length?(o=zs(g),f):o},f.rotate=function(g){return arguments.length?(a=zs(g),f):a},f.text=function(g){return arguments.length?(t=zs(g),f):t},f.spiral=function(g){return arguments.length?(u=qae[g]||g,f):u},f.fontSize=function(g){return arguments.length?(i=zs(g),f):i},f.padding=function(g){return arguments.length?(s=zs(g),f):s},f.random=function(g){return arguments.length?(c=g,f):c},f}function Lae(e,t,n,i){if(!t.sprite){var r=e.context,o=e.ratio;r.clearRect(0,0,($d<<5)/o,Jp/o);var a=0,s=0,u=0,l=n.length,c,f,d,h,g;for(--i;++i<l;){if(t=n[i],r.save(),r.font=t.style+" "+t.weight+" "+~~((t.size+1)/o)+"px "+t.font,c=r.measureText(t.text+"m").width*o,d=t.size<<1,t.rotate){var p=Math.sin(t.rotate*c_),m=Math.cos(t.rotate*c_),y=c*m,v=c*p,b=d*m,x=d*p;c=Math.max(Math.abs(y+x),Math.abs(y-x))+31>>5<<5,d=~~Math.max(Math.abs(v+b),Math.abs(v-b))}else c=c+31>>5<<5;if(d>u&&(u=d),a+c>=$d<<5&&(a=0,s+=u,u=0),s+d>=Jp)break;r.translate((a+(c>>1))/o,(s+(d>>1))/o),t.rotate&&r.rotate(t.rotate*c_),r.fillText(t.text,0,0),t.padding&&(r.lineWidth=2*t.padding,r.strokeText(t.text,0,0)),r.restore(),t.width=c,t.height=d,t.xoff=a,t.yoff=s,t.x1=c>>1,t.y1=d>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,a+=c}for(var w=r.getImageData(0,0,($d<<5)/o,Jp/o).data,_=[];--i>=0;)if(t=n[i],!!t.hasText){for(c=t.width,f=c>>5,d=t.y1-t.y0,h=0;h<d*f;h++)_[h]=0;if(a=t.xoff,a==null)return;s=t.yoff;var E=0,$=-1;for(g=0;g<d;g++){for(h=0;h<c;h++){var O=f*g+(h>>5),C=w[(s+g)*($d<<5)+(a+h)<<2]?1<<31-h%32:0;_[O]|=C,E|=C}E?$=g:(t.y0++,d--,g--,s++)}t.y1=t.y0+$,t.sprite=_.slice(0,(t.y1-t.y0)*f)}}}function Pae(e,t,n){n>>=5;for(var i=e.sprite,r=e.width>>5,o=e.x-(r<<4),a=o&127,s=32-a,u=e.y1-e.y0,l=(e.y+e.y0)*n+(o>>5),c,f=0;f<u;f++){c=0;for(var d=0;d<=r;d++)if((c<<s|(d<r?(c=i[f*r+d])>>>a:0))&t[l+d])return!0;l+=n}return!1}function Iae(e,t){var n=e[0],i=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>i.x&&(i.x=t.x+t.x1),t.y+t.y1>i.y&&(i.y=t.y+t.y1)}function Bae(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function UN(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function zae(e){var t=4,n=t*e[0]/e[1],i=0,r=0;return function(o){var a=o<0?-1:1;switch(Math.sqrt(1+4*a*o)-a&3){case 0:i+=n;break;case 1:r+=t;break;case 2:i-=n;break;default:r-=t;break}return[i,r]}}function Uae(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function zs(e){return typeof e=="function"?e:function(){return e}}var qae={archimedean:UN,rectangular:zae};const qN=["x","y","font","fontSize","fontStyle","fontWeight","angle"],Hae=["text","font","rotate","fontSize","fontStyle","fontWeight"];function f_(e){N.call(this,jae(),e)}f_.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:qN}]};q(f_,N,{transform(e,t){e.size&&!(e.size[0]&&e.size[1])&&I("Wordcloud size dimensions must be non-zero.");function n(g){const p=e[g];return me(p)&&t.modified(p.fields)}const i=e.modified();if(!(i||t.changed(t.ADD_REM)||Hae.some(n)))return;const r=t.materialize(t.SOURCE).source,o=this.value,a=e.as||qN;let s=e.fontSize||14,u;if(me(s)?u=e.fontSizeRange:s=Jt(s),u){const g=s,p=Ne("sqrt")().domain(vr(r,g)).range(u);s=m=>p(g(m))}r.forEach(g=>{g[a[0]]=NaN,g[a[1]]=NaN,g[a[3]]=0});const l=o.words(r).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(s).random(Ei).layout(),c=o.size(),f=c[0]>>1,d=c[1]>>1,h=l.length;for(let g=0,p,m;g<h;++g)p=l[g],m=p.datum,m[a[0]]=p.x+f,m[a[1]]=p.y+d,m[a[2]]=p.font,m[a[3]]=p.size,m[a[4]]=p.style,m[a[5]]=p.weight,m[a[6]]=p.rotate;return t.reflow(i).modifies(a)}});var Wae=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",wordcloud:f_});function HN(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function WN(e){let t=e,n=e;e.length===1&&(t=(a,s)=>e(a)-s,n=Gae(e));function i(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)<0?u=c+1:l=c}return u}function r(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)>0?l=c:u=c+1}return u}function o(a,s,u,l){u==null&&(u=0),l==null&&(l=a.length);const c=i(a,s,u,l-1);return c>u&&t(a[c-1],s)>-t(a[c],s)?c-1:c}return{left:i,center:o,right:r}}function Gae(e){return(t,n)=>HN(e(t),n)}function Yae(e){return e===null?NaN:+e}const GN=WN(HN),Vae=GN.right,Xae=GN.left;WN(Yae).center;function Kae(e,t){return Array.from(t,n=>e[n])}const Jae=e=>new Uint8Array(e),Zae=e=>new Uint16Array(e),Sd=e=>new Uint32Array(e);function Qae(){let e=8,t=[],n=Sd(0),i=Zp(0,e),r=Zp(0,e);return{data:()=>t,seen:()=>n=ese(n,t.length),add(o){for(let a=0,s=t.length,u=o.length,l;a<u;++a)l=o[a],l._index=s++,t.push(l)},remove(o,a){const s=t.length,u=Array(s-o),l=t;let c,f,d;for(f=0;!a[f]&&f<s;++f)u[f]=t[f],l[f]=f;for(d=f;f<s;++f)c=t[f],a[f]?l[f]=-1:(l[f]=d,i[d]=i[f],r[d]=r[f],u[d]=c,c._index=d++),i[f]=0;return t=u,l},size:()=>t.length,curr:()=>i,prev:()=>r,reset:o=>r[o]=i[o],all:()=>e<257?255:e<65537?65535:4294967295,set(o,a){i[o]|=a},clear(o,a){i[o]&=~a},resize(o,a){const s=i.length;(o>s||a>e)&&(e=Math.max(a,e),i=Zp(o,e,i),r=Zp(o,e))}}}function ese(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function Zp(e,t,n){const i=(t<257?Jae:t<65537?Zae:Sd)(e);return n&&i.set(n),i}function YN(e,t,n){const i=1<<t;return{one:i,zero:~i,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(r,o){const a=this,s=a.bisect(a.range,r.value),u=r.index,l=s[0],c=s[1],f=u.length;let d;for(d=0;d<l;++d)o[u[d]]|=i;for(d=c;d<f;++d)o[u[d]]|=i;return a}}}function VN(){let e=Sd(0),t=[],n=0;function i(s,u,l){if(!u.length)return[];const c=n,f=u.length,d=Sd(f);let h=Array(f),g,p,m;for(m=0;m<f;++m)h[m]=s(u[m]),d[m]=m;if(h=tse(h,d),c)g=t,p=e,t=Array(c+f),e=Sd(c+f),nse(l,g,p,c,h,d,f,t,e);else{if(l>0)for(m=0;m<f;++m)d[m]+=l;t=h,e=d}return n=c+f,{index:d,value:h}}function r(s,u){const l=n;let c,f,d;for(f=0;!u[e[f]]&&f<l;++f);for(d=f;f<l;++f)u[c=e[f]]||(e[d]=c,t[d]=t[f],++d);n=l-s}function o(s){for(let u=0,l=n;u<l;++u)e[u]=s[e[u]]}function a(s,u){let l;return u?l=u.length:(u=t,l=n),[Xae(u,s[0],0,l),Vae(u,s[1],0,l)]}return{insert:i,remove:r,bisect:a,reindex:o,index:()=>e,size:()=>n}}function tse(e,t){return e.sort.call(t,(n,i)=>{const r=e[n],o=e[i];return r<o?-1:r>o?1:0}),Kae(e,t)}function nse(e,t,n,i,r,o,a,s,u){let l=0,c=0,f;for(f=0;l<i&&c<a;++f)t[l]<r[c]?(s[f]=t[l],u[f]=n[l++]):(s[f]=r[c],u[f]=o[c++]+e);for(;l<i;++l,++f)s[f]=t[l],u[f]=n[l];for(;c<a;++c,++f)s[f]=r[c],u[f]=o[c]+e}function d_(e){N.call(this,Qae(),e),this._indices=null,this._dims=null}d_.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};q(d_,N,{transform(e,t){if(this._dims){var n=e.modified("fields")||e.fields.some(i=>t.modified(i.fields));return n?this.reinit(e,t):this.eval(e,t)}else return this.init(e,t)},init(e,t){const n=e.fields,i=e.query,r=this._indices={},o=this._dims=[],a=i.length;let s=0,u,l;for(;s<a;++s)u=n[s].fname,l=r[u]||(r[u]=VN()),o.push(YN(l,s,i[s]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),i=e.fields,r=e.query,o=this._indices,a=this._dims,s=this.value,u=s.curr(),l=s.prev(),c=s.all(),f=n.rem=n.add,d=n.mod,h=r.length,g={};let p,m,y,v,b,x,w,_,E;if(l.set(u),t.rem.length&&(b=this.remove(e,t,n)),t.add.length&&s.add(t.add),t.mod.length)for(x={},v=t.mod,w=0,_=v.length;w<_;++w)x[v[w]._index]=1;for(w=0;w<h;++w)E=i[w],(!a[w]||e.modified("fields",w)||t.modified(E.fields))&&(y=E.fname,(p=g[y])||(o[y]=m=VN(),g[y]=p=m.insert(E,t.source,0)),a[w]=YN(m,w,r[w]).onAdd(p,u));for(w=0,_=s.data().length;w<_;++w)b[w]||(l[w]!==u[w]?f.push(w):x[w]&&u[w]!==c&&d.push(w));return s.mask=(1<<h)-1,n},eval(e,t){const n=t.materialize().fork(),i=this._dims.length;let r=0;return t.rem.length&&(this.remove(e,t,n),r|=(1<<i)-1),e.modified("query")&&!e.modified("fields")&&(r|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),r|=(1<<i)-1),t.mod.length&&(this.modify(t,n),r|=(1<<i)-1),this.value.mask=r,n},insert(e,t,n){const i=t.add,r=this.value,o=this._dims,a=this._indices,s=e.fields,u={},l=n.add,c=r.size()+i.length,f=o.length;let d=r.size(),h,g,p;r.resize(c,f),r.add(i);const m=r.curr(),y=r.prev(),v=r.all();for(h=0;h<f;++h)g=s[h].fname,p=u[g]||(u[g]=a[g].insert(s[h],i,d)),o[h].onAdd(p,m);for(;d<c;++d)y[d]=v,m[d]!==v&&l.push(d)},modify(e,t){const n=t.mod,i=this.value,r=i.curr(),o=i.all(),a=e.mod;let s,u,l;for(s=0,u=a.length;s<u;++s)l=a[s]._index,r[l]!==o&&n.push(l)},remove(e,t,n){const i=this._indices,r=this.value,o=r.curr(),a=r.prev(),s=r.all(),u={},l=n.rem,c=t.rem;let f,d,h,g;for(f=0,d=c.length;f<d;++f)h=c[f]._index,u[h]=1,a[h]=g=o[h],o[h]=s,g!==s&&l.push(h);for(h in i)i[h].remove(d,u);return this.reindex(t,d,u),u},reindex(e,t,n){const i=this._indices,r=this.value;e.runAfter(()=>{const o=r.remove(t,n);for(const a in i)i[a].reindex(o)})},update(e,t,n){const i=this._dims,r=e.query,o=t.stamp,a=i.length;let s=0,u,l;for(n.filters=0,l=0;l<a;++l)e.modified("query",l)&&(u=l,++s);if(s===1)s=i[u].one,this.incrementOne(i[u],r[u],n.add,n.rem);else for(l=0,s=0;l<a;++l)!e.modified("query",l)||(s|=i[l].one,this.incrementAll(i[l],r[l],o,n.add),n.rem=n.add);return s},incrementAll(e,t,n,i){const r=this.value,o=r.seen(),a=r.curr(),s=r.prev(),u=e.index(),l=e.bisect(e.range),c=e.bisect(t),f=c[0],d=c[1],h=l[0],g=l[1],p=e.one;let m,y,v;if(f<h)for(m=f,y=Math.min(h,d);m<y;++m)v=u[m],o[v]!==n&&(s[v]=a[v],o[v]=n,i.push(v)),a[v]^=p;else if(f>h)for(m=h,y=Math.min(f,g);m<y;++m)v=u[m],o[v]!==n&&(s[v]=a[v],o[v]=n,i.push(v)),a[v]^=p;if(d>g)for(m=Math.max(f,g),y=d;m<y;++m)v=u[m],o[v]!==n&&(s[v]=a[v],o[v]=n,i.push(v)),a[v]^=p;else if(d<g)for(m=Math.max(h,d),y=g;m<y;++m)v=u[m],o[v]!==n&&(s[v]=a[v],o[v]=n,i.push(v)),a[v]^=p;e.range=t.slice()},incrementOne(e,t,n,i){const r=this.value,o=r.curr(),a=e.index(),s=e.bisect(e.range),u=e.bisect(t),l=u[0],c=u[1],f=s[0],d=s[1],h=e.one;let g,p,m;if(l<f)for(g=l,p=Math.min(f,c);g<p;++g)m=a[g],o[m]^=h,n.push(m);else if(l>f)for(g=f,p=Math.min(l,d);g<p;++g)m=a[g],o[m]^=h,i.push(m);if(c>d)for(g=Math.max(l,d),p=c;g<p;++g)m=a[g],o[m]^=h,n.push(m);else if(c<d)for(g=Math.max(f,c),p=d;g<p;++g)m=a[g],o[m]^=h,i.push(m);e.range=t.slice()}});function h_(e){N.call(this,null,e)}h_.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};q(h_,N,{transform(e,t){const n=~(e.ignore||0),i=e.filter,r=i.mask;if((r&n)==0)return t.StopPropagation;const o=t.fork(t.ALL),a=i.data(),s=i.curr(),u=i.prev(),l=c=>s[c]&n?null:a[c];return o.filter(o.MOD,l),r&r-1?(o.filter(o.ADD,c=>{const f=s[c]&n;return!f&&f^u[c]&n?a[c]:null}),o.filter(o.REM,c=>{const f=s[c]&n;return f&&!(f^(f^u[c]&n))?a[c]:null})):(o.filter(o.ADD,l),o.filter(o.REM,c=>(s[c]&n)===r?a[c]:null)),o.filter(o.SOURCE,c=>l(c._index))}});var ise=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",crossfilter:d_,resolvefilter:h_}),rse=Math.sqrt(50),ose=Math.sqrt(10),ase=Math.sqrt(2);function sse(e,t,n){var i=Math.abs(t-e)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),o=i/r;return o>=rse?r*=10:o>=ose?r*=5:o>=ase&&(r*=2),t<e?-r:r}const use="RawCode",Us="Literal",lse="Property",cse="Identifier",fse="ArrayExpression",dse="BinaryExpression",XN="CallExpression",hse="ConditionalExpression",gse="LogicalExpression",pse="MemberExpression",mse="ObjectExpression",yse="UnaryExpression";function tr(e){this.type=e}tr.prototype.visit=function(e){let t,n,i;if(e(this))return 1;for(t=vse(this),n=0,i=t.length;n<i;++n)if(t[n].visit(e))return 1};function vse(e){switch(e.type){case fse:return e.elements;case dse:case gse:return[e.left,e.right];case XN:return[e.callee].concat(e.arguments);case hse:return[e.test,e.consequent,e.alternate];case pse:return[e.object,e.property];case mse:return e.properties;case lse:return[e.key,e.value];case yse:return[e.argument];case cse:case Us:case use:default:return[]}}var Pr,K,j,an,Ue,Qp=1,Od=2,qs=3,Oa=4,em=5,Hs=6,Hn=7,Cd=8,bse=9;Pr={};Pr[Qp]="Boolean";Pr[Od]="<end>";Pr[qs]="Identifier";Pr[Oa]="Keyword";Pr[em]="Null";Pr[Hs]="Numeric";Pr[Hn]="Punctuator";Pr[Cd]="String";Pr[bse]="RegularExpression";var xse="ArrayExpression",wse="BinaryExpression",Ese="CallExpression",_se="ConditionalExpression",KN="Identifier",Ase="Literal",$se="LogicalExpression",Sse="MemberExpression",Ose="ObjectExpression",Cse="Property",Fse="UnaryExpression",Nt="Unexpected token %0",kse="Unexpected number",Dse="Unexpected string",Mse="Unexpected identifier",Tse="Unexpected reserved word",Nse="Unexpected end of input",g_="Invalid regular expression",p_="Invalid regular expression: missing /",JN="Octal literals are not allowed in strict mode.",Rse="Duplicate data property in object literal not allowed in strict mode",Ht="ILLEGAL",Fd="Disabled.",jse=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),Lse=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function tm(e,t){if(!e)throw new Error("ASSERT: "+t)}function Co(e){return e>=48&&e<=57}function m_(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function kd(e){return"01234567".indexOf(e)>=0}function Pse(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function Dd(e){return e===10||e===13||e===8232||e===8233}function Md(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&jse.test(String.fromCharCode(e))}function nm(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&Lse.test(String.fromCharCode(e))}const Ise={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function ZN(){for(;j<an;){const e=K.charCodeAt(j);if(Pse(e)||Dd(e))++j;else break}}function y_(e){var t,n,i,r=0;for(n=e==="u"?4:2,t=0;t<n;++t)j<an&&m_(K[j])?(i=K[j++],r=r*16+"0123456789abcdef".indexOf(i.toLowerCase())):Re({},Nt,Ht);return String.fromCharCode(r)}function Bse(){var e,t,n,i;for(e=K[j],t=0,e==="}"&&Re({},Nt,Ht);j<an&&(e=K[j++],!!m_(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&Re({},Nt,Ht),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,i=(t-65536&1023)+56320,String.fromCharCode(n,i))}function QN(){var e,t;for(e=K.charCodeAt(j++),t=String.fromCharCode(e),e===92&&(K.charCodeAt(j)!==117&&Re({},Nt,Ht),++j,e=y_("u"),(!e||e==="\\"||!Md(e.charCodeAt(0)))&&Re({},Nt,Ht),t=e);j<an&&(e=K.charCodeAt(j),!!nm(e));)++j,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),K.charCodeAt(j)!==117&&Re({},Nt,Ht),++j,e=y_("u"),(!e||e==="\\"||!nm(e.charCodeAt(0)))&&Re({},Nt,Ht),t+=e);return t}function zse(){var e,t;for(e=j++;j<an;){if(t=K.charCodeAt(j),t===92)return j=e,QN();if(nm(t))++j;else break}return K.slice(e,j)}function Use(){var e,t,n;return e=j,t=K.charCodeAt(j)===92?QN():zse(),t.length===1?n=qs:Ise.hasOwnProperty(t)?n=Oa:t==="null"?n=em:t==="true"||t==="false"?n=Qp:n=qs,{type:n,value:t,start:e,end:j}}function v_(){var e=j,t=K.charCodeAt(j),n,i=K[j],r,o,a;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++j,{type:Hn,value:String.fromCharCode(t),start:e,end:j};default:if(n=K.charCodeAt(j+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return j+=2,{type:Hn,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:j};case 33:case 61:return j+=2,K.charCodeAt(j)===61&&++j,{type:Hn,value:K.slice(e,j),start:e,end:j}}}if(a=K.substr(j,4),a===">>>=")return j+=4,{type:Hn,value:a,start:e,end:j};if(o=a.substr(0,3),o===">>>"||o==="<<="||o===">>=")return j+=3,{type:Hn,value:o,start:e,end:j};if(r=o.substr(0,2),i===r[1]&&"+-<>&|".indexOf(i)>=0||r==="=>")return j+=2,{type:Hn,value:r,start:e,end:j};if(r==="//"&&Re({},Nt,Ht),"<>=!+-*%&|^/".indexOf(i)>=0)return++j,{type:Hn,value:i,start:e,end:j};Re({},Nt,Ht)}function qse(e){let t="";for(;j<an&&m_(K[j]);)t+=K[j++];return t.length===0&&Re({},Nt,Ht),Md(K.charCodeAt(j))&&Re({},Nt,Ht),{type:Hs,value:parseInt("0x"+t,16),start:e,end:j}}function Hse(e){let t="0"+K[j++];for(;j<an&&kd(K[j]);)t+=K[j++];return(Md(K.charCodeAt(j))||Co(K.charCodeAt(j)))&&Re({},Nt,Ht),{type:Hs,value:parseInt(t,8),octal:!0,start:e,end:j}}function e4(){var e,t,n;if(n=K[j],tm(Co(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=j,e="",n!=="."){if(e=K[j++],n=K[j],e==="0"){if(n==="x"||n==="X")return++j,qse(t);if(kd(n))return Hse(t);n&&Co(n.charCodeAt(0))&&Re({},Nt,Ht)}for(;Co(K.charCodeAt(j));)e+=K[j++];n=K[j]}if(n==="."){for(e+=K[j++];Co(K.charCodeAt(j));)e+=K[j++];n=K[j]}if(n==="e"||n==="E")if(e+=K[j++],n=K[j],(n==="+"||n==="-")&&(e+=K[j++]),Co(K.charCodeAt(j)))for(;Co(K.charCodeAt(j));)e+=K[j++];else Re({},Nt,Ht);return Md(K.charCodeAt(j))&&Re({},Nt,Ht),{type:Hs,value:parseFloat(e),start:t,end:j}}function Wse(){var e="",t,n,i,r,o=!1;for(t=K[j],tm(t==="'"||t==='"',"String literal must starts with a quote"),n=j,++j;j<an;)if(i=K[j++],i===t){t="";break}else if(i==="\\")if(i=K[j++],!i||!Dd(i.charCodeAt(0)))switch(i){case"u":case"x":K[j]==="{"?(++j,e+=Bse()):e+=y_(i);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:kd(i)?(r="01234567".indexOf(i),r!==0&&(o=!0),j<an&&kd(K[j])&&(o=!0,r=r*8+"01234567".indexOf(K[j++]),"0123".indexOf(i)>=0&&j<an&&kd(K[j])&&(r=r*8+"01234567".indexOf(K[j++]))),e+=String.fromCharCode(r)):e+=i;break}else i==="\r"&&K[j]===`
`&&++j;else{if(Dd(i.charCodeAt(0)))break;e+=i}return t!==""&&Re({},Nt,Ht),{type:Cd,value:e,octal:o,start:n,end:j}}function Gse(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(i,r)=>{if(parseInt(r,16)<=1114111)return"x";Re({},g_)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(i){Re({},g_)}try{return new RegExp(e,t)}catch(i){return null}}function Yse(){var e,t,n,i,r;for(e=K[j],tm(e==="/","Regular expression literal must start with a slash"),t=K[j++],n=!1,i=!1;j<an;)if(e=K[j++],t+=e,e==="\\")e=K[j++],Dd(e.charCodeAt(0))&&Re({},p_),t+=e;else if(Dd(e.charCodeAt(0)))Re({},p_);else if(n)e==="]"&&(n=!1);else if(e==="/"){i=!0;break}else e==="["&&(n=!0);return i||Re({},p_),r=t.substr(1,t.length-2),{value:r,literal:t}}function Vse(){var e,t,n;for(t="",n="";j<an&&(e=K[j],!!nm(e.charCodeAt(0)));)++j,e==="\\"&&j<an?Re({},Nt,Ht):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&Re({},g_,n),{value:n,literal:t}}function Xse(){var e,t,n,i;return Ue=null,ZN(),e=j,t=Yse(),n=Vse(),i=Gse(t.value,n.value),{literal:t.literal+n.literal,value:i,regex:{pattern:t.value,flags:n.value},start:e,end:j}}function Kse(e){return e.type===qs||e.type===Oa||e.type===Qp||e.type===em}function t4(){if(ZN(),j>=an)return{type:Od,start:j,end:j};const e=K.charCodeAt(j);return Md(e)?Use():e===40||e===41||e===59?v_():e===39||e===34?Wse():e===46?Co(K.charCodeAt(j+1))?e4():v_():Co(e)?e4():v_()}function Wn(){const e=Ue;return j=e.end,Ue=t4(),j=e.end,e}function n4(){const e=j;Ue=t4(),j=e}function Jse(e){const t=new tr(xse);return t.elements=e,t}function i4(e,t,n){const i=new tr(e==="||"||e==="&&"?$se:wse);return i.operator=e,i.left=t,i.right=n,i}function Zse(e,t){const n=new tr(Ese);return n.callee=e,n.arguments=t,n}function Qse(e,t,n){const i=new tr(_se);return i.test=e,i.consequent=t,i.alternate=n,i}function b_(e){const t=new tr(KN);return t.name=e,t}function Td(e){const t=new tr(Ase);return t.value=e.value,t.raw=K.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function r4(e,t,n){const i=new tr(Sse);return i.computed=e==="[",i.object=t,i.property=n,i.computed||(n.member=!0),i}function eue(e){const t=new tr(Ose);return t.properties=e,t}function o4(e,t,n){const i=new tr(Cse);return i.key=t,i.value=n,i.kind=e,i}function tue(e,t){const n=new tr(Fse);return n.operator=e,n.argument=t,n.prefix=!0,n}function Re(e,t){var n,i=Array.prototype.slice.call(arguments,2),r=t.replace(/%(\d)/g,(o,a)=>(tm(a<i.length,"Message reference must be in range"),i[a]));throw n=new Error(r),n.index=j,n.description=r,n}function im(e){e.type===Od&&Re(e,Nse),e.type===Hs&&Re(e,kse),e.type===Cd&&Re(e,Dse),e.type===qs&&Re(e,Mse),e.type===Oa&&Re(e,Tse),Re(e,Nt,e.value)}function sn(e){const t=Wn();(t.type!==Hn||t.value!==e)&&im(t)}function Qe(e){return Ue.type===Hn&&Ue.value===e}function x_(e){return Ue.type===Oa&&Ue.value===e}function nue(){const e=[];for(j=Ue.start,sn("[");!Qe("]");)Qe(",")?(Wn(),e.push(null)):(e.push(Ws()),Qe("]")||sn(","));return Wn(),Jse(e)}function a4(){j=Ue.start;const e=Wn();return e.type===Cd||e.type===Hs?(e.octal&&Re(e,JN),Td(e)):b_(e.value)}function iue(){var e,t,n,i;if(j=Ue.start,e=Ue,e.type===qs)return n=a4(),sn(":"),i=Ws(),o4("init",n,i);if(e.type===Od||e.type===Hn)im(e);else return t=a4(),sn(":"),i=Ws(),o4("init",t,i)}function rue(){var e=[],t,n,i,r={},o=String;for(j=Ue.start,sn("{");!Qe("}");)t=iue(),t.key.type===KN?n=t.key.name:n=o(t.key.value),i="$"+n,Object.prototype.hasOwnProperty.call(r,i)?Re({},Rse):r[i]=!0,e.push(t),Qe("}")||sn(",");return sn("}"),eue(e)}function oue(){sn("(");const e=w_();return sn(")"),e}const aue={if:1};function sue(){var e,t,n;if(Qe("("))return oue();if(Qe("["))return nue();if(Qe("{"))return rue();if(e=Ue.type,j=Ue.start,e===qs||aue[Ue.value])n=b_(Wn().value);else if(e===Cd||e===Hs)Ue.octal&&Re(Ue,JN),n=Td(Wn());else{if(e===Oa)throw new Error(Fd);e===Qp?(t=Wn(),t.value=t.value==="true",n=Td(t)):e===em?(t=Wn(),t.value=null,n=Td(t)):Qe("/")||Qe("/=")?(n=Td(Xse()),n4()):im(Wn())}return n}function uue(){const e=[];if(sn("("),!Qe(")"))for(;j<an&&(e.push(Ws()),!Qe(")"));)sn(",");return sn(")"),e}function lue(){j=Ue.start;const e=Wn();return Kse(e)||im(e),b_(e.value)}function cue(){return sn("."),lue()}function fue(){sn("[");const e=w_();return sn("]"),e}function due(){var e,t,n;for(e=sue();;)if(Qe("."))n=cue(),e=r4(".",e,n);else if(Qe("("))t=uue(),e=Zse(e,t);else if(Qe("["))n=fue(),e=r4("[",e,n);else break;return e}function s4(){const e=due();if(Ue.type===Hn&&(Qe("++")||Qe("--")))throw new Error(Fd);return e}function rm(){var e,t;if(Ue.type!==Hn&&Ue.type!==Oa)t=s4();else{if(Qe("++")||Qe("--"))throw new Error(Fd);if(Qe("+")||Qe("-")||Qe("~")||Qe("!"))e=Wn(),t=rm(),t=tue(e.value,t);else{if(x_("delete")||x_("void")||x_("typeof"))throw new Error(Fd);t=s4()}}return t}function u4(e){let t=0;if(e.type!==Hn&&e.type!==Oa)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function hue(){var e,t,n,i,r,o,a,s,u,l;if(e=Ue,u=rm(),i=Ue,r=u4(i),r===0)return u;for(i.prec=r,Wn(),t=[e,Ue],a=rm(),o=[u,i,a];(r=u4(Ue))>0;){for(;o.length>2&&r<=o[o.length-2].prec;)a=o.pop(),s=o.pop().value,u=o.pop(),t.pop(),n=i4(s,u,a),o.push(n);i=Wn(),i.prec=r,o.push(i),t.push(Ue),n=rm(),o.push(n)}for(l=o.length-1,n=o[l],t.pop();l>1;)t.pop(),n=i4(o[l-1].value,o[l-2],n),l-=2;return n}function Ws(){var e,t,n;return e=hue(),Qe("?")&&(Wn(),t=Ws(),sn(":"),n=Ws(),e=Qse(e,t,n)),e}function w_(){const e=Ws();if(Qe(","))throw new Error(Fd);return e}function l4(e){K=e,j=0,an=K.length,Ue=null,n4();const t=w_();if(Ue.type!==Od)throw new Error("Unexpect token after expression.");return t}var c4={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function f4(e){function t(a,s,u,l){let c=e(s[0]);return u&&(c=u+"("+c+")",u.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+a+(l<0?"":l===0?"()":"("+s.slice(1).map(e).join(",")+")")}function n(a,s,u){return l=>t(a,l,s,u)}const i="new Date",r="String",o="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(a){a.length<3&&I("Missing arguments to clamp function."),a.length>3&&I("Too many arguments to clamp function.");const s=a.map(e);return"Math.max("+s[1]+", Math.min("+s[2]+","+s[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:i,date:n("getDate",i,0),day:n("getDay",i,0),year:n("getFullYear",i,0),month:n("getMonth",i,0),hours:n("getHours",i,0),minutes:n("getMinutes",i,0),seconds:n("getSeconds",i,0),milliseconds:n("getMilliseconds",i,0),time:n("getTime",i,0),timezoneoffset:n("getTimezoneOffset",i,0),utcdate:n("getUTCDate",i,0),utcday:n("getUTCDay",i,0),utcyear:n("getUTCFullYear",i,0),utcmonth:n("getUTCMonth",i,0),utchours:n("getUTCHours",i,0),utcminutes:n("getUTCMinutes",i,0),utcseconds:n("getUTCSeconds",i,0),utcmilliseconds:n("getUTCMilliseconds",i,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",r,0),lower:n("toLowerCase",r,0),substring:n("substring",r),split:n("split",r),trim:n("trim",r,0),regexp:o,test:n("test",o),if:function(a){a.length<3&&I("Missing arguments to if function."),a.length>3&&I("Too many arguments to if function.");const s=a.map(e);return"("+s[0]+"?"+s[1]+":"+s[2]+")"}}}function gue(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function d4(e){e=e||{};const t=e.allowed?Hi(e.allowed):{},n=e.forbidden?Hi(e.forbidden):{},i=e.constants||c4,r=(e.functions||f4)(f),o=e.globalvar,a=e.fieldvar,s=me(o)?o:g=>`${o}["${g}"]`;let u={},l={},c=0;function f(g){if(Fe(g))return g;const p=d[g.type];return p==null&&I("Unsupported type: "+g.type),p(g)}const d={Literal:g=>g.raw,Identifier:g=>{const p=g.name;return c>0?p:ae(n,p)?I("Illegal identifier: "+p):ae(i,p)?i[p]:ae(t,p)?p:(u[p]=1,s(p))},MemberExpression:g=>{const p=!g.computed,m=f(g.object);p&&(c+=1);const y=f(g.property);return m===a&&(l[gue(y)]=1),p&&(c-=1),m+(p?"."+y:"["+y+"]")},CallExpression:g=>{g.callee.type!=="Identifier"&&I("Illegal callee type: "+g.callee.type);const p=g.callee.name,m=g.arguments,y=ae(r,p)&&r[p];return y||I("Unrecognized function: "+p),me(y)?y(m):y+"("+m.map(f).join(",")+")"},ArrayExpression:g=>"["+g.elements.map(f).join(",")+"]",BinaryExpression:g=>"("+f(g.left)+" "+g.operator+" "+f(g.right)+")",UnaryExpression:g=>"("+g.operator+f(g.argument)+")",ConditionalExpression:g=>"("+f(g.test)+"?"+f(g.consequent)+":"+f(g.alternate)+")",LogicalExpression:g=>"("+f(g.left)+g.operator+f(g.right)+")",ObjectExpression:g=>"{"+g.properties.map(f).join(",")+"}",Property:g=>{c+=1;const p=f(g.key);return c-=1,p+":"+f(g.value)}};function h(g){const p={code:f(g),globals:Object.keys(u),fields:Object.keys(l)};return u={},l={},p}return h.functions=r,h.constants=i,h}class Ca{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const o=n[r],a=t+o,s=Math.abs(t)<Math.abs(o)?t-(a-o):o-(a-t);s&&(n[i++]=s),t=a}return n[i]=t,this._n=i+1,this}valueOf(){const t=this._partials;let n=this._n,i,r,o,a=0;if(n>0){for(a=t[--n];n>0&&(i=a,r=t[--n],a=i+r,o=r-(a-i),!o););n>0&&(o<0&&t[n-1]<0||o>0&&t[n-1]>0)&&(r=o*2,i=a+r,r==i-a&&(a=i))}return a}}function pue(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(r);++i<r;)o[i]=e+i*n;return o}var om=1e-6,h4=1e-12,Nd=Math.PI,g4=Nd/2,p4=Nd/4,m4=Nd*2,Rd=180/Nd,un=Nd/180,E_=Math.abs,am=Math.atan2,An=Math.cos,__=Math.hypot,$n=Math.sin,y4=Math.sqrt;function A_(e){return e>1?g4:e<-1?-g4:Math.asin(e)}function jd(){}function sm(e,t){e&&b4.hasOwnProperty(e.type)&&b4[e.type](e,t)}var v4={Feature:function(e,t){sm(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,i=-1,r=n.length;++i<r;)sm(n[i].geometry,t)}},b4={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)e=n[i],t.point(e[0],e[1],e[2])},LineString:function(e,t){$_(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)$_(n[i],t,0)},Polygon:function(e,t){x4(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)x4(n[i],t)},GeometryCollection:function(e,t){for(var n=e.geometries,i=-1,r=n.length;++i<r;)sm(n[i],t)}};function $_(e,t,n){var i=-1,r=e.length-n,o;for(t.lineStart();++i<r;)o=e[i],t.point(o[0],o[1],o[2]);t.lineEnd()}function x4(e,t){var n=-1,i=e.length;for(t.polygonStart();++n<i;)$_(e[n],t,1);t.polygonEnd()}function S_(e,t){e&&v4.hasOwnProperty(e.type)?v4[e.type](e,t):sm(e,t)}var um=new Ca,lm=new Ca,w4,E4,O_,C_,F_,Ir={point:jd,lineStart:jd,lineEnd:jd,polygonStart:function(){um=new Ca,Ir.lineStart=mue,Ir.lineEnd=yue},polygonEnd:function(){var e=+um;lm.add(e<0?m4+e:e),this.lineStart=this.lineEnd=this.point=jd},sphere:function(){lm.add(m4)}};function mue(){Ir.point=vue}function yue(){_4(w4,E4)}function vue(e,t){Ir.point=_4,w4=e,E4=t,e*=un,t*=un,O_=e,C_=An(t=t/2+p4),F_=$n(t)}function _4(e,t){e*=un,t*=un,t=t/2+p4;var n=e-O_,i=n>=0?1:-1,r=i*n,o=An(t),a=$n(t),s=F_*a,u=C_*o+s*An(r),l=s*i*$n(r);um.add(am(l,u)),O_=e,C_=o,F_=a}function bue(e){return lm=new Ca,S_(e,Ir),lm*2}function xue(e){return[am(e[1],e[0]),A_(e[2])]}function wue(e){var t=e[0],n=e[1],i=An(n);return[i*An(t),i*$n(t),$n(n)]}function A4(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Eue(e){var t=y4(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var ot,Gn,ct,fi,Gs,$4,S4,Tl,Ld,Fa,Fo,ko={point:k_,lineStart:C4,lineEnd:F4,polygonStart:function(){ko.point=k4,ko.lineStart=_ue,ko.lineEnd=Aue,Ld=new Ca,Ir.polygonStart()},polygonEnd:function(){Ir.polygonEnd(),ko.point=k_,ko.lineStart=C4,ko.lineEnd=F4,um<0?(ot=-(ct=180),Gn=-(fi=90)):Ld>om?fi=90:Ld<-om&&(Gn=-90),Fo[0]=ot,Fo[1]=ct},sphere:function(){ot=-(ct=180),Gn=-(fi=90)}};function k_(e,t){Fa.push(Fo=[ot=e,ct=e]),t<Gn&&(Gn=t),t>fi&&(fi=t)}function O4(e,t){var n=wue([e*un,t*un]);if(Tl){var i=A4(Tl,n),r=[i[1],-i[0],0],o=A4(r,i);Eue(o),o=xue(o);var a=e-Gs,s=a>0?1:-1,u=o[0]*Rd*s,l,c=E_(a)>180;c^(s*Gs<u&&u<s*e)?(l=o[1]*Rd,l>fi&&(fi=l)):(u=(u+360)%360-180,c^(s*Gs<u&&u<s*e)?(l=-o[1]*Rd,l<Gn&&(Gn=l)):(t<Gn&&(Gn=t),t>fi&&(fi=t))),c?e<Gs?di(ot,e)>di(ot,ct)&&(ct=e):di(e,ct)>di(ot,ct)&&(ot=e):ct>=ot?(e<ot&&(ot=e),e>ct&&(ct=e)):e>Gs?di(ot,e)>di(ot,ct)&&(ct=e):di(e,ct)>di(ot,ct)&&(ot=e)}else Fa.push(Fo=[ot=e,ct=e]);t<Gn&&(Gn=t),t>fi&&(fi=t),Tl=n,Gs=e}function C4(){ko.point=O4}function F4(){Fo[0]=ot,Fo[1]=ct,ko.point=k_,Tl=null}function k4(e,t){if(Tl){var n=e-Gs;Ld.add(E_(n)>180?n+(n>0?360:-360):n)}else $4=e,S4=t;Ir.point(e,t),O4(e,t)}function _ue(){Ir.lineStart()}function Aue(){k4($4,S4),Ir.lineEnd(),E_(Ld)>om&&(ot=-(ct=180)),Fo[0]=ot,Fo[1]=ct,Tl=null}function di(e,t){return(t-=e)<0?t+360:t}function $ue(e,t){return e[0]-t[0]}function D4(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function Sue(e){var t,n,i,r,o,a,s;if(fi=ct=-(ot=Gn=1/0),Fa=[],S_(e,ko),n=Fa.length){for(Fa.sort($ue),t=1,i=Fa[0],o=[i];t<n;++t)r=Fa[t],D4(i,r[0])||D4(i,r[1])?(di(i[0],r[1])>di(i[0],i[1])&&(i[1]=r[1]),di(r[0],i[1])>di(i[0],i[1])&&(i[0]=r[0])):o.push(i=r);for(a=-1/0,n=o.length-1,t=0,i=o[n];t<=n;i=r,++t)r=o[t],(s=di(i[1],r[0]))>a&&(a=s,ot=r[0],ct=i[1])}return Fa=Fo=null,ot===1/0||Gn===1/0?[[NaN,NaN],[NaN,NaN]]:[[ot,Gn],[ct,fi]]}var Pd,cm,fm,dm,hm,gm,pm,mm,D_,M_,T_,M4,T4,Sn,On,Cn,nr={sphere:jd,point:N_,lineStart:N4,lineEnd:R4,polygonStart:function(){nr.lineStart=Fue,nr.lineEnd=kue},polygonEnd:function(){nr.lineStart=N4,nr.lineEnd=R4}};function N_(e,t){e*=un,t*=un;var n=An(t);Id(n*An(e),n*$n(e),$n(t))}function Id(e,t,n){++Pd,fm+=(e-fm)/Pd,dm+=(t-dm)/Pd,hm+=(n-hm)/Pd}function N4(){nr.point=Oue}function Oue(e,t){e*=un,t*=un;var n=An(t);Sn=n*An(e),On=n*$n(e),Cn=$n(t),nr.point=Cue,Id(Sn,On,Cn)}function Cue(e,t){e*=un,t*=un;var n=An(t),i=n*An(e),r=n*$n(e),o=$n(t),a=am(y4((a=On*o-Cn*r)*a+(a=Cn*i-Sn*o)*a+(a=Sn*r-On*i)*a),Sn*i+On*r+Cn*o);cm+=a,gm+=a*(Sn+(Sn=i)),pm+=a*(On+(On=r)),mm+=a*(Cn+(Cn=o)),Id(Sn,On,Cn)}function R4(){nr.point=N_}function Fue(){nr.point=Due}function kue(){j4(M4,T4),nr.point=N_}function Due(e,t){M4=e,T4=t,e*=un,t*=un,nr.point=j4;var n=An(t);Sn=n*An(e),On=n*$n(e),Cn=$n(t),Id(Sn,On,Cn)}function j4(e,t){e*=un,t*=un;var n=An(t),i=n*An(e),r=n*$n(e),o=$n(t),a=On*o-Cn*r,s=Cn*i-Sn*o,u=Sn*r-On*i,l=__(a,s,u),c=A_(l),f=l&&-c/l;D_.add(f*a),M_.add(f*s),T_.add(f*u),cm+=c,gm+=c*(Sn+(Sn=i)),pm+=c*(On+(On=r)),mm+=c*(Cn+(Cn=o)),Id(Sn,On,Cn)}function Mue(e){Pd=cm=fm=dm=hm=gm=pm=mm=0,D_=new Ca,M_=new Ca,T_=new Ca,S_(e,nr);var t=+D_,n=+M_,i=+T_,r=__(t,n,i);return r<h4&&(t=gm,n=pm,i=mm,cm<om&&(t=fm,n=dm,i=hm),r=__(t,n,i),r<h4)?[NaN,NaN]:[am(n,t)*Rd,A_(i/r)*Rd]}function Bd(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function ym(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function Ys(){}var zd=.7,vm=1/zd,Nl="\\s*([+-]?\\d+)\\s*",Ud="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Br="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Tue=/^#([0-9a-f]{3,8})$/,Nue=new RegExp("^rgb\\("+[Nl,Nl,Nl]+"\\)$"),Rue=new RegExp("^rgb\\("+[Br,Br,Br]+"\\)$"),jue=new RegExp("^rgba\\("+[Nl,Nl,Nl,Ud]+"\\)$"),Lue=new RegExp("^rgba\\("+[Br,Br,Br,Ud]+"\\)$"),Pue=new RegExp("^hsl\\("+[Ud,Br,Br]+"\\)$"),Iue=new RegExp("^hsla\\("+[Ud,Br,Br,Ud]+"\\)$"),L4={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Bd(Ys,R_,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:P4,formatHex:P4,formatHsl:Bue,formatRgb:I4,toString:I4});function P4(){return this.rgb().formatHex()}function Bue(){return W4(this).formatHsl()}function I4(){return this.rgb().formatRgb()}function R_(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Tue.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?B4(t):n===3?new Fn(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?bm(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?bm(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Nue.exec(e))?new Fn(t[1],t[2],t[3],1):(t=Rue.exec(e))?new Fn(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=jue.exec(e))?bm(t[1],t[2],t[3],t[4]):(t=Lue.exec(e))?bm(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Pue.exec(e))?H4(t[1],t[2]/100,t[3]/100,1):(t=Iue.exec(e))?H4(t[1],t[2]/100,t[3]/100,t[4]):L4.hasOwnProperty(e)?B4(L4[e]):e==="transparent"?new Fn(NaN,NaN,NaN,0):null}function B4(e){return new Fn(e>>16&255,e>>8&255,e&255,1)}function bm(e,t,n,i){return i<=0&&(e=t=n=NaN),new Fn(e,t,n,i)}function z4(e){return e instanceof Ys||(e=R_(e)),e?(e=e.rgb(),new Fn(e.r,e.g,e.b,e.opacity)):new Fn}function j_(e,t,n,i){return arguments.length===1?z4(e):new Fn(e,t,n,i==null?1:i)}function Fn(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}Bd(Fn,j_,ym(Ys,{brighter:function(e){return e=e==null?vm:Math.pow(vm,e),new Fn(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?zd:Math.pow(zd,e),new Fn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:U4,formatHex:U4,formatRgb:q4,toString:q4}));function U4(){return"#"+L_(this.r)+L_(this.g)+L_(this.b)}function q4(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function L_(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function H4(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new zr(e,t,n,i)}function W4(e){if(e instanceof zr)return new zr(e.h,e.s,e.l,e.opacity);if(e instanceof Ys||(e=R_(e)),!e)return new zr;if(e instanceof zr)return e;e=e.rgb();var t=e.r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),o=Math.max(t,n,i),a=NaN,s=o-r,u=(o+r)/2;return s?(t===o?a=(n-i)/s+(n<i)*6:n===o?a=(i-t)/s+2:a=(t-n)/s+4,s/=u<.5?o+r:2-o-r,a*=60):s=u>0&&u<1?0:a,new zr(a,s,u,e.opacity)}function G4(e,t,n,i){return arguments.length===1?W4(e):new zr(e,t,n,i==null?1:i)}function zr(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}Bd(zr,G4,ym(Ys,{brighter:function(e){return e=e==null?vm:Math.pow(vm,e),new zr(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?zd:Math.pow(zd,e),new zr(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,r=2*n-i;return new Fn(P_(e>=240?e-240:e+120,r,i),P_(e,r,i),P_(e<120?e+240:e-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function P_(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const zue=Math.PI/180,Uue=180/Math.PI,xm=18,Y4=.96422,V4=1,X4=.82521,K4=4/29,Rl=6/29,J4=3*Rl*Rl,que=Rl*Rl*Rl;function Z4(e){if(e instanceof Ur)return new Ur(e.l,e.a,e.b,e.opacity);if(e instanceof Do)return tR(e);e instanceof Fn||(e=z4(e));var t=U_(e.r),n=U_(e.g),i=U_(e.b),r=I_((.2225045*t+.7168786*n+.0606169*i)/V4),o,a;return t===n&&n===i?o=a=r:(o=I_((.4360747*t+.3850649*n+.1430804*i)/Y4),a=I_((.0139322*t+.0971045*n+.7141733*i)/X4)),new Ur(116*r-16,500*(o-r),200*(r-a),e.opacity)}function Q4(e,t,n,i){return arguments.length===1?Z4(e):new Ur(e,t,n,i==null?1:i)}function Ur(e,t,n,i){this.l=+e,this.a=+t,this.b=+n,this.opacity=+i}Bd(Ur,Q4,ym(Ys,{brighter:function(e){return new Ur(this.l+xm*(e==null?1:e),this.a,this.b,this.opacity)},darker:function(e){return new Ur(this.l-xm*(e==null?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=Y4*B_(t),e=V4*B_(e),n=X4*B_(n),new Fn(z_(3.1338561*t-1.6168667*e-.4906146*n),z_(-.9787684*t+1.9161415*e+.033454*n),z_(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function I_(e){return e>que?Math.pow(e,1/3):e/J4+K4}function B_(e){return e>Rl?e*e*e:J4*(e-K4)}function z_(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function U_(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Hue(e){if(e instanceof Do)return new Do(e.h,e.c,e.l,e.opacity);if(e instanceof Ur||(e=Z4(e)),e.a===0&&e.b===0)return new Do(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*Uue;return new Do(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function eR(e,t,n,i){return arguments.length===1?Hue(e):new Do(e,t,n,i==null?1:i)}function Do(e,t,n,i){this.h=+e,this.c=+t,this.l=+n,this.opacity=+i}function tR(e){if(isNaN(e.h))return new Ur(e.l,0,0,e.opacity);var t=e.h*zue;return new Ur(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Bd(Do,eR,ym(Ys,{brighter:function(e){return new Do(this.h,this.c,this.l+xm*(e==null?1:e),this.opacity)},darker:function(e){return new Do(this.h,this.c,this.l-xm*(e==null?1:e),this.opacity)},rgb:function(){return tR(this).rgb()}}));function Wue(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Gue(e){let t=e,n=e;e.length===1&&(t=(a,s)=>e(a)-s,n=Yue(e));function i(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)<0?u=c+1:l=c}return u}function r(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)>0?l=c:u=c+1}return u}function o(a,s,u,l){u==null&&(u=0),l==null&&(l=a.length);const c=i(a,s,u,l-1);return c>u&&t(a[c-1],s)>-t(a[c],s)?c-1:c}return{left:i,center:o,right:r}}function Yue(e){return(t,n)=>Wue(e(t),n)}const q_="intersect",nR="union",Vue="vlMulti",Xue="vlPoint",iR="or",Kue="and",Jue="_vgsid_",Zue="E",Que="R",ele="R-E",tle="R-LE",nle="R-RE",wm="index:unit";function rR(e,t){for(var n=t.fields,i=t.values,r=n.length,o=0,a,s;o<r;++o)if(s=n[o],s.getter=Ln.getter||Ln(s.field),a=s.getter(e),Zo(a)&&(a=Kt(a)),Zo(i[o])&&(i[o]=Kt(i[o])),Zo(i[o][0])&&(i[o]=i[o].map(Kt)),s.type===Zue){if(Q(i[o])?i[o].indexOf(a)<0:a!==i[o])return!1}else if(s.type===Que){if(!Pu(a,i[o]))return!1}else if(s.type===nle){if(!Pu(a,i[o],!0,!1))return!1}else if(s.type===ele){if(!Pu(a,i[o],!1,!1))return!1}else if(s.type===tle&&!Pu(a,i[o],!1,!0))return!1;return!0}function ile(e,t,n){for(var i=this.context.data[e],r=i?i.values.value:[],o=i?i[wm]&&i[wm].value:void 0,a=n===q_,s=r.length,u=0,l,c,f,d,h;u<s;++u)if(l=r[u],o&&a){if(c=c||{},f=c[d=l.unit]||0,f===-1)continue;if(h=rR(t,l),c[d]=h?-1:++f,h&&o.size===1)return!0;if(!h&&f===o.get(d).count)return!1}else if(h=rR(t,l),a^h)return h;return s&&a}const H_=Ln(Jue),oR=Gue(H_),rle=oR.left,ole=oR.right;function ale(e,t,n){const i=this.context.data[e],r=i?i.values.value:[],o=i?i[wm]&&i[wm].value:void 0,a=n===q_,s=H_(t),u=rle(r,s);if(u===r.length||H_(r[u])!==s)return!1;if(o&&a){if(o.size===1)return!0;if(ole(r,s)-u<o.size)return!1}return!0}function sle(e,t){return e.map(n=>ge({values:t.fields.map(i=>(i.getter||(i.getter=Ln(i.field)))(n.datum))},t))}function ule(e,t,n,i){for(var r=this.context.data[e],o=r?r.values.value:[],a={},s={},u={},l,c,f,d,h,g,p,m,y,v=o.length,b=0,x,w;b<v;++b){for(l=o[b],d=l.unit,c=l.fields,f=l.values,x=0,w=c.length;x<w;++x)h=c[x],g=a[h.field]||(a[h.field]={}),p=g[d]||(g[d]=[]),u[h.field]=m=h.type.charAt(0),y=aR[m+"_union"],g[d]=y(p,oe(f[x]));n&&(p=s[d]||(s[d]=[]),p.push(oe(f).reduce((_,E,$)=>(_[c[$].field]=E,_),{})))}if(t=t||nR,Object.keys(a).forEach(_=>{a[_]=Object.keys(a[_]).map(E=>a[_][E]).reduce((E,$)=>E===void 0?$:aR[u[_]+"_"+t](E,$))}),o=Object.keys(s),n&&o.length){const _=i?Xue:Vue;a[_]=t===nR?{[iR]:o.reduce((E,$)=>(E.push(...s[$]),E),[])}:{[Kue]:o.map(E=>({[iR]:s[E]}))}}return a}var aR={E_union:function(e,t){if(!e.length)return t;for(var n=0,i=t.length;n<i;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.indexOf(n)>=0):t},R_union:function(e,t){var n=Kt(t[0]),i=Kt(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<i&&(e[1]=i),e):[n,i]},R_intersect:function(e,t){var n=Kt(t[0]),i=Kt(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?i<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>i&&(e[1]=i),e):[n,i]}};const lle=":",cle="@";function W_(e,t,n,i){t[0].type!==Us&&I("First argument to selection functions must be a string literal.");const r=t[0].value,o=t.length>=2&&Ee(t).value,a="unit",s=cle+a,u=lle+r;o===q_&&!ae(i,s)&&(i[s]=n.getData(r).indataRef(n,a)),ae(i,u)||(i[u]=n.getData(r).tuplesRef())}function sR(e){const t=this.context.data[e];return t?t.values.value:[]}function fle(e,t,n){const i=this.context.data[e]["index:"+t],r=i?i.value.get(n):void 0;return r&&r.count}function dle(e,t){const n=this.context.dataflow,i=this.context.data[e],r=i.input;return n.pulse(r,n.changeset().remove(xi).insert(t)),1}function hle(e,t,n){if(e){const i=this.context.dataflow,r=e.mark.source;i.pulse(r,i.changeset().encode(e,t))}return n!==void 0?n:e}const qd=e=>function(t,n){return this.context.dataflow.locale()[e](n)(t)},gle=qd("format"),uR=qd("timeFormat"),ple=qd("utcFormat"),mle=qd("timeParse"),yle=qd("utcParse"),Em=new Date(2e3,0,1);function _m(e,t,n){return!Number.isInteger(e)||!Number.isInteger(t)?"":(Em.setYear(2e3),Em.setMonth(e),Em.setDate(t),uR.call(this,Em,n))}function vle(e){return _m.call(this,e,1,"%B")}function ble(e){return _m.call(this,e,1,"%b")}function xle(e){return _m.call(this,0,2+e,"%A")}function wle(e){return _m.call(this,0,2+e,"%a")}const Ele=":",_le="@",G_="%",lR="$";function Y_(e,t,n,i){t[0].type!==Us&&I("First argument to data functions must be a string literal.");const r=t[0].value,o=Ele+r;if(!ae(o,i))try{i[o]=n.getData(r).tuplesRef()}catch(a){}}function Ale(e,t,n,i){t[0].type!==Us&&I("First argument to indata must be a string literal."),t[1].type!==Us&&I("Second argument to indata must be a string literal.");const r=t[0].value,o=t[1].value,a=_le+o;ae(a,i)||(i[a]=n.getData(r).indataRef(n,o))}function Yn(e,t,n,i){if(t[0].type===Us)cR(n,i,t[0].value);else for(e in n.scales)cR(n,i,e)}function cR(e,t,n){const i=G_+n;if(!ae(t,i))try{t[i]=e.scaleRef(n)}catch(r){}}function Mo(e,t){let n;return me(e)?e:Fe(e)?(n=t.scales[e])&&n.value:void 0}function $le(e,t,n){t.__bandwidth=r=>r&&r.bandwidth?r.bandwidth():0,n._bandwidth=Yn,n._range=Yn,n._scale=Yn;const i=r=>"_["+(r.type===Us?ne(G_+r.value):ne(G_)+"+"+e(r))+"]";return{_bandwidth:r=>`this.__bandwidth(${i(r[0])})`,_range:r=>`${i(r[0])}.range()`,_scale:r=>`${i(r[0])}(${e(r[1])})`}}function V_(e,t){return function(n,i,r){if(n){const o=Mo(n,(r||this).context);return o&&o.path[e](i)}else return t(i)}}const Sle=V_("area",bue),Ole=V_("bounds",Sue),Cle=V_("centroid",Mue);function Fle(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function X_(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(i){e.warn(i)}return n[n.length-1]}function kle(){return X_(this.context.dataflow,"warn",arguments)}function Dle(){return X_(this.context.dataflow,"info",arguments)}function Mle(){return X_(this.context.dataflow,"debug",arguments)}function K_(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function J_(e){const t=j_(e),n=K_(t.r),i=K_(t.g),r=K_(t.b);return .2126*n+.7152*i+.0722*r}function Tle(e,t){const n=J_(e),i=J_(t),r=Math.max(n,i),o=Math.min(n,i);return(r+.05)/(o+.05)}function Nle(){const e=[].slice.call(arguments);return e.unshift({}),ge(...e)}function fR(e,t){return e===t||e!==e&&t!==t?!0:Q(e)?Q(t)&&e.length===t.length?Rle(e,t):!1:se(e)&&se(t)?dR(e,t):!1}function Rle(e,t){for(let n=0,i=e.length;n<i;++n)if(!fR(e[n],t[n]))return!1;return!0}function dR(e,t){for(const n in e)if(!fR(e[n],t[n]))return!1;return!0}function hR(e){return t=>dR(e,t)}function jle(e,t,n,i,r,o){const a=this.context.dataflow,s=this.context.data[e],u=s.input,l=a.stamp();let c=s.changes,f,d;if(a._trigger===!1||!(u.value.length||t||i))return 0;if((!c||c.stamp<l)&&(s.changes=c=a.changeset(),c.stamp=l,a.runAfter(()=>{s.modified=!0,a.pulse(u,c).run()},!0,1)),n&&(f=n===!0?xi:Q(n)||D0(n)?n:hR(n),c.remove(f)),t&&c.insert(t),i&&(f=hR(i),u.value.some(f)?c.remove(f):c.insert(i)),r)for(d in o)c.modify(r,d,o[d]);return 1}function Lle(e){const t=e.touches,n=t[0].clientX-t[1].clientX,i=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+i*i)}function Ple(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}const gR={};function Ile(e,t){const n=gR[t]||(gR[t]=Ln(t));return Q(e)?e.map(n):n(e)}function Z_(e){return Q(e)||ArrayBuffer.isView(e)?e:null}function Q_(e){return Z_(e)||(Fe(e)?e:null)}function Ble(e,...t){return Z_(e).join(...t)}function zle(e,...t){return Q_(e).indexOf(...t)}function Ule(e,...t){return Q_(e).lastIndexOf(...t)}function qle(e,...t){return Q_(e).slice(...t)}function Hle(e,t,n){return me(n)&&I("Function argument passed to replace."),String(e).replace(t,n)}function Wle(e){return Z_(e).slice().reverse()}function Gle(e,t,n){return Yx(e||0,t||0,n||0)}function Yle(e,t){const n=Mo(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function Vle(e,t){const n=Mo(e,(t||this).context);return n?n.copy():void 0}function Xle(e,t){const n=Mo(e,(t||this).context);return n?n.domain():[]}function Kle(e,t,n){const i=Mo(e,(n||this).context);return i?Q(t)?(i.invertRange||i.invert)(t):(i.invert||i.invertExtent)(t):void 0}function Jle(e,t){const n=Mo(e,(t||this).context);return n&&n.range?n.range():[]}function Zle(e,t,n){const i=Mo(e,(n||this).context);return i?i(t):void 0}function Qle(e,t,n,i,r){e=Mo(e,(r||this).context);const o=ZM(t,n);let a=e.domain(),s=a[0],u=Ee(a),l=yn;return u-s?l=LM(e,s,u):e=(e.interpolator?Ne("sequential")().interpolator(e.interpolator()):Ne("linear")().interpolate(e.interpolate()).range(e.range())).domain([s=0,u=1]),e.ticks&&(a=e.ticks(+i||15),s!==a[0]&&a.unshift(s),u!==Ee(a)&&a.push(u)),a.forEach(c=>o.stop(l(c),e(c))),o}function ece(e,t,n){const i=Mo(e,(n||this).context);return function(r){return i?i.path.context(r)(t):""}}function tce(e){let t=null;return function(n){return n?Cf(n,t=t||sl(e)):e}}const pR=e=>e.data;function mR(e,t){const n=sR.call(t,e);return n.root&&n.root.lookup||{}}function nce(e,t,n){const i=mR(e,this),r=i[t],o=i[n];return r&&o?r.path(o).map(pR):void 0}function ice(e,t){const n=mR(e,this)[t];return n?n.ancestors().map(pR):void 0}const yR=()=>typeof window!="undefined"&&window||null;function rce(){const e=yR();return e?e.screen:{}}function oce(){const e=yR();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function ace(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function sce(e,t,n){if(!e)return[];const[i,r]=e,o=new Et().set(i[0],i[1],r[0],r[1]),a=n||this.context.dataflow.scenegraph().root;return dT(a,o,uce(t))}function uce(e){let t=null;if(e){const n=oe(e.marktype),i=oe(e.markname);t=r=>(!n.length||n.some(o=>r.marktype===o))&&(!i.length||i.some(o=>r.name===o))}return t}const Hd={random(){return Ei()},cumulativeNormal:I0,cumulativeLogNormal:tb,cumulativeUniform:ob,densityNormal:Kv,densityLogNormal:eb,densityUniform:rb,quantileNormal:B0,quantileLogNormal:nb,quantileUniform:ab,sampleNormal:P0,sampleLogNormal:Qv,sampleUniform:ib,isArray:Q,isBoolean:iv,isDate:Zo,isDefined(e){return e!==void 0},isNumber:Qo,isObject:se,isRegExp:$C,isString:Fe,isTuple:D0,isValid(e){return e!=null&&e===e},toBoolean:ov,toDate:av,toNumber:Kt,toString:sv,indexof:zle,join:Ble,lastindexof:Ule,replace:Hle,reverse:Wle,slice:qle,flush:_C,lerp:SC,merge:Nle,pad:FC,peek:Ee,pluck:Ile,span:Nc,inrange:Pu,truncate:kC,rgb:j_,lab:Q4,hcl:eR,hsl:G4,luminance:J_,contrast:Tle,sequence:pue,format:gle,utcFormat:ple,utcParse:yle,utcOffset:hF,utcSequence:mF,timeFormat:uR,timeParse:mle,timeOffset:dF,timeSequence:pF,timeUnitSpecifier:tF,monthFormat:vle,monthAbbrevFormat:ble,dayFormat:xle,dayAbbrevFormat:wle,quarter:bC,utcquarter:xC,week:iF,utcweek:aF,dayofyear:nF,utcdayofyear:oF,warn:kle,info:Dle,debug:Mle,extent:vr,inScope:Fle,intersect:sce,clampRange:wC,pinchDistance:Lle,pinchAngle:Ple,screen:rce,containerSize:ace,windowSize:oce,bandspace:Gle,setdata:dle,pathShape:tce,panLinear:pC,panLog:mC,panPow:yC,panSymlog:vC,zoomLinear:Zy,zoomLog:Qy,zoomPow:y0,zoomSymlog:ev,encode:hle,modify:jle},lce=["view","item","group","xy","x","y"],cce="event.vega.",vR="this.",eA={},bR={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${ne(lR+e)}]`,functions:fce,constants:c4,visitors:eA},tA=d4(bR);function fce(e){const t=f4(e);lce.forEach(n=>t[n]=cce+n);for(const n in Hd)t[n]=vR+n;return ge(t,$le(e,Hd,eA)),t}function mt(e,t,n){return arguments.length===1?Hd[e]:(Hd[e]=t,n&&(eA[e]=n),tA&&(tA.functions[e]=vR+e),this)}mt("bandwidth",Yle,Yn);mt("copy",Vle,Yn);mt("domain",Xle,Yn);mt("range",Jle,Yn);mt("invert",Kle,Yn);mt("scale",Zle,Yn);mt("gradient",Qle,Yn);mt("geoArea",Sle,Yn);mt("geoBounds",Ole,Yn);mt("geoCentroid",Cle,Yn);mt("geoShape",ece,Yn);mt("indata",fle,Ale);mt("data",sR,Y_);mt("treePath",nce,Y_);mt("treeAncestors",ice,Y_);mt("vlSelectionTest",ile,W_);mt("vlSelectionIdTest",ale,W_);mt("vlSelectionResolve",ule,W_);mt("vlSelectionTuples",sle);function qr(e,t){const n={};let i;try{e=Fe(e)?e:ne(e)+"",i=l4(e)}catch(o){I("Expression parse error: "+e)}i.visit(o=>{if(o.type!==XN)return;const a=o.callee.name,s=bR.visitors[a];s&&s(a,o.arguments,t,n)});const r=tA(i);return r.globals.forEach(o=>{const a=lR+o;!ae(n,a)&&t.getSignal(o)&&(n[a]=t.signalRef(o))}),{$expr:ge({code:r.code},t.options.ast?{ast:i}:null),$fields:r.fields,$params:n}}function dce(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(i=>t.parseOperator(i)),n.forEach(i=>t.parseOperatorParameters(i)),(e.streams||[]).forEach(i=>t.parseStream(i)),(e.updates||[]).forEach(i=>t.parseUpdate(i)),t.resolve()}const hce=Hi(["rule"]),xR=Hi(["group","image","rect"]);function gce(e,t){let n="";return hce[t]||(e.x2&&(e.x?(xR[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(xR[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function nA(e){return(e+"").toLowerCase()}function pce(e){return nA(e)==="operator"}function mce(e){return nA(e)==="collect"}function Wd(e,t,n){n[n.length-1]!==";"&&(n="return("+n+");");const i=Function(...t.concat(n));return e&&e.functions?i.bind(e.functions):i}function yce(e,t,n,i){return"((u = ".concat(e,") < (v = ").concat(t,") || u == null) && v != null ? ").concat(n,`
  : (u > v || v == null) && u != null ? `).concat(i,`
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? `).concat(n,`
  : v !== v && u === u ? `).concat(i," : ")}var vce={operator:(e,t)=>Wd(e,["_"],t.code),parameter:(e,t)=>Wd(e,["datum","_"],t.code),event:(e,t)=>Wd(e,["event"],t.code),handler:(e,t)=>{const n="var datum=event.item&&event.item.datum;return ".concat(t.code,";");return Wd(e,["_","event"],n)},encode:(e,t)=>{const{marktype:n,channels:i}=t;let r="var o=item,datum=o.datum,m=0,$;";for(const o in i){const a="o["+ne(o)+"]";r+="$=".concat(i[o].code,";if(").concat(a,"!==$)").concat(a,"=$,m=1;")}return r+=gce(i,n),r+="return m;",Wd(e,["item","_"],r)},codegen:{get(e){const t="[".concat(e.map(ne).join("]["),"]"),n=Function("_","return _".concat(t,";"));return n.path=t,n},comparator(e,t){let n;const i=(o,a)=>{const s=t[a];let u,l;return o.path?(u="a".concat(o.path),l="b".concat(o.path)):((n=n||{})["f"+a]=o,u="this.f".concat(a,"(a)"),l="this.f".concat(a,"(b)")),yce(u,l,-s,s)},r=Function("a","b","var u, v; return "+e.map(i).join("")+"0;");return n?r.bind(n):r}}};function bce(e){const t=this;pce(e.type)||!e.type?t.operator(e,e.update?t.operatorExpression(e.update):null):t.transform(e,e.type)}function xce(e){const t=this;if(e.params){const n=t.get(e.id);n||I("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}}function wce(e,t){t=t||{};const n=this;for(const i in e){const r=e[i];t[i]=Q(r)?r.map(o=>wR(o,n,t)):wR(r,n,t)}return t}function wR(e,t,n){if(!e||!se(e))return e;for(let i=0,r=ER.length,o;i<r;++i)if(o=ER[i],ae(e,o.key))return o.parse(e,t,n);return e}var ER=[{key:"$ref",parse:Ece},{key:"$key",parse:Ace},{key:"$expr",parse:_ce},{key:"$field",parse:$ce},{key:"$encode",parse:Oce},{key:"$compare",parse:Sce},{key:"$context",parse:Cce},{key:"$subflow",parse:Fce},{key:"$tupleid",parse:kce}];function Ece(e,t){return t.get(e.$ref)||I("Operator not defined: "+e.$ref)}function _ce(e,t,n){e.$params&&t.parseParameters(e.$params,n);const i="e:"+e.$expr.code+"_"+e.$name;return t.fn[i]||(t.fn[i]=jn(t.parameterExpression(e.$expr),e.$fields,e.$name))}function Ace(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=rv(e.$key,e.$flat,t.expr.codegen))}function $ce(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=Ln(e.$field,e.$name,t.expr.codegen))}function Sce(e,t){const n="c:"+e.$compare+"_"+e.$order,i=oe(e.$compare).map(r=>r&&r.$tupleid?ee:r);return t.fn[n]||(t.fn[n]=tv(i,e.$order,t.expr.codegen))}function Oce(e,t){const n=e.$encode,i={};for(const r in n){const o=n[r];i[r]=jn(t.encodeExpression(o.$expr),o.$fields),i[r].output=o.$output}return i}function Cce(e,t){return t}function Fce(e,t){const n=e.$subflow;return function(i,r,o){const a=t.fork().parse(n),s=a.get(n.operators[0].id),u=a.signals.parent;return u&&u.set(o),s.detachSubflow=()=>t.detach(a),s}}function kce(){return ee}function Dce(e){var t=this,n=e.filter!=null?t.eventExpression(e.filter):void 0,i=e.stream!=null?t.get(e.stream):void 0,r;e.source?i=t.events(e.source,e.type,n):e.merge&&(r=e.merge.map(o=>t.get(o)),i=r[0].merge.apply(r[0],r.slice(1))),e.between&&(r=e.between.map(o=>t.get(o)),i=i.between(r[0],r[1])),e.filter&&(i=i.filter(n)),e.throttle!=null&&(i=i.throttle(+e.throttle)),e.debounce!=null&&(i=i.debounce(+e.debounce)),i==null&&I("Invalid stream definition: "+JSON.stringify(e)),e.consume&&i.consume(!0),t.stream(e,i)}function Mce(e){var t=this,n=se(n=e.source)?n.$ref:n,i=t.get(n),r=null,o=e.update,a=void 0;i||I("Source not defined: "+e.source),r=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),o&&o.$expr&&(o.$params&&(a=t.parseParameters(o.$params)),o=t.handlerExpression(o.$expr)),t.update(e,i,r,o,a)}const Tce={skip:!0};function Nce(e){var t=this,n={};if(e.signals){var i=n.signals={};Object.keys(t.signals).forEach(o=>{const a=t.signals[o];e.signals(o,a)&&(i[o]=a.value)})}if(e.data){var r=n.data={};Object.keys(t.data).forEach(o=>{const a=t.data[o];e.data(o,a)&&(r[o]=a.input.value)})}return t.subcontext&&e.recurse!==!1&&(n.subcontext=t.subcontext.map(o=>o.getState(e))),n}function Rce(e){var t=this,n=t.dataflow,i=e.data,r=e.signals;Object.keys(r||{}).forEach(o=>{n.update(t.signals[o],r[o],Tce)}),Object.keys(i||{}).forEach(o=>{n.pulse(t.data[o].input,n.changeset().remove(xi).insert(i[o]))}),(e.subcontext||[]).forEach((o,a)=>{const s=t.subcontext[a];s&&s.setState(o)})}function _R(e,t,n,i){return new AR(e,t,n,i)}function AR(e,t,n,i){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=i||vce,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function $R(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}AR.prototype=$R.prototype={fork(){const e=new $R(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,i=n.dataflow,r=e.value;if(n.set(e.id,t),mce(e.type)&&r&&(r.$ingest?i.ingest(t,r.$ingest,r.$format):r.$request?i.preload(t,r.$request,r.$format):i.pulse(t,i.changeset().insert(r))),e.root&&(n.root=t),e.parent){let o=n.get(e.parent.$ref);o?(i.connect(o,[t]),t.targets().add(o)):(n.unresolved=n.unresolved||[]).push(()=>{o=n.get(e.parent.$ref),i.connect(o,[t]),t.targets().add(o)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const o in e.data){const a=n.data[o]||(n.data[o]={});e.data[o].forEach(s=>a[s]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[nA(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,i,r){this.dataflow.on(t,n,i,r,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:dce,parseOperator:bce,parseOperatorParameters:xce,parseParameters:wce,parseStream:Dce,parseUpdate:Mce,getState:Nce,setState:Rce};var jl=0,Gd=0,Yd=0,SR=1e3,Am,Vd,$m=0,Vs=0,Sm=0,Xd=typeof performance=="object"&&performance.now?performance:Date,OR=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function iA(){return Vs||(OR(jce),Vs=Xd.now()+Sm)}function jce(){Vs=0}function rA(){this._call=this._time=this._next=null}rA.prototype={constructor:rA,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?iA():+n)+(t==null?0:+t),!this._next&&Vd!==this&&(Vd?Vd._next=this:Am=this,Vd=this),this._call=e,this._time=n,oA()},stop:function(){this._call&&(this._call=null,this._time=1/0,oA())}};function Lce(){iA(),++jl;for(var e=Am,t;e;)(t=Vs-e._time)>=0&&e._call.call(null,t),e=e._next;--jl}function CR(){Vs=($m=Xd.now())+Sm,jl=Gd=0;try{Lce()}finally{jl=0,Ice(),Vs=0}}function Pce(){var e=Xd.now(),t=e-$m;t>SR&&(Sm-=t,$m=e)}function Ice(){for(var e,t=Am,n,i=1/0;t;)t._call?(i>t._time&&(i=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Am=n);Vd=e,oA(i)}function oA(e){if(!jl){Gd&&(Gd=clearTimeout(Gd));var t=e-Vs;t>24?(e<1/0&&(Gd=setTimeout(CR,e-Xd.now()-Sm)),Yd&&(Yd=clearInterval(Yd))):(Yd||($m=Xd.now(),Yd=setInterval(Pce,SR)),jl=1,OR(CR))}}function Bce(e,t,n){var i=new rA,r=t;return t==null?(i.restart(e,t,n),i):(i._restart=i.restart,i.restart=function(o,a,s){a=+a,s=s==null?iA():+s,i._restart(function u(l){l+=r,i._restart(u,r+=a,s),o(l)},a,s)},i.restart(e,t,n),i)}function zce(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),FR(t,e.description()))}function FR(e,t){e&&(t==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}function Uce(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}const aA="default";function qce(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:aA,item:null}));e.on(e.events("view","mousemove"),t,(n,i)=>{const r=t.value,o=r?Fe(r)?r:r.user:aA,a=i.item&&i.item.cursor||null;return r&&o===r.user&&a==r.item?r:{user:o,item:a}}),e.add(null,function(n){let i=n.cursor,r=this.value;return Fe(i)||(r=i.item,i=i.user),sA(e,i&&i!==aA?i:r||i),r},{cursor:t})}function sA(e,t){const n=e.globalCursor()?typeof document!="undefined"&&document.body:e.container();if(n)return t==null?n.style.removeProperty("cursor"):n.style.cursor=t}function Om(e,t){var n=e._runtime.data;return ae(n,t)||I("Unrecognized data set: "+t),n[t]}function Hce(e,t){return arguments.length<2?Om(this,e).values.value:Cm.call(this,e,gs().remove(xi).insert(t))}function Cm(e,t){f3(t)||I("Second argument to changes must be a changeset.");const n=Om(this,e);return n.modified=!0,this.pulse(n.input,t)}function Wce(e,t){return Cm.call(this,e,gs().insert(t))}function Gce(e,t){return Cm.call(this,e,gs().remove(t))}function kR(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function DR(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function Fm(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function Yce(e){var t=Fm(e),n=kR(e),i=DR(e);e._renderer.background(e.background()),e._renderer.resize(n,i,t),e._handler.origin(t),e._resizeListeners.forEach(r=>{try{r(n,i)}catch(o){e.error(o)}})}function Vce(e,t,n){var i=e._renderer,r=i&&i.canvas(),o,a,s;return r&&(s=Fm(e),a=t.changedTouches?t.changedTouches[0]:t,o=Ig(a,r),o[0]-=s[0],o[1]-=s[1]),t.dataflow=e,t.item=n,t.vega=Xce(e,n,o),t}function Xce(e,t,n){const i=t?t.mark.marktype==="group"?t:t.mark.group:null;function r(a){var s=i,u;if(a){for(u=t;u;u=u.mark.group)if(u.mark.name===a){s=u;break}}return s&&s.mark&&s.mark.interactive?s:{}}function o(a){if(!a)return n;Fe(a)&&(a=r(a));const s=n.slice();for(;a;)s[0]-=a.x||0,s[1]-=a.y||0,a=a.mark&&a.mark.group;return s}return{view:Jt(e),item:Jt(t||{}),group:r,xy:o,x:a=>o(a)[0],y:a=>o(a)[1]}}const MR="view",Kce="timer",Jce="window",Zce={trap:!1};function Qce(e){const t=ge({defaults:{}},e),n=(i,r)=>{r.forEach(o=>{Q(i[o])&&(i[o]=Hi(i[o]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}function TR(e,t,n,i){e._eventListeners.push({type:n,sources:oe(t),handler:i})}function efe(e,t){var n=e._eventConfig.defaults,i=n.prevent,r=n.allow;return i===!1||r===!0?!1:i===!0||r===!1?!0:i?i[t]:r?!r[t]:e.preventDefault()}function km(e,t,n){const i=e._eventConfig&&e._eventConfig[t];return i===!1||se(i)&&!i[n]?(e.warn(`Blocked ${t} ${n} event listener.`),!1):!0}function tfe(e,t,n){var i=this,r=new R0(n),o=function(l,c){i.runAsync(null,()=>{e===MR&&efe(i,t)&&l.preventDefault(),r.receive(Vce(i,l,c))})},a;if(e===Kce)km(i,"timer",t)&&i.timer(o,t);else if(e===MR)km(i,"view",t)&&i.addEventListener(t,o,Zce);else if(e===Jce?km(i,"window",t)&&typeof window!="undefined"&&(a=[window]):typeof document!="undefined"&&km(i,"selector",t)&&(a=document.querySelectorAll(e)),!a)i.warn("Can not resolve event source: "+e);else{for(var s=0,u=a.length;s<u;++s)a[s].addEventListener(t,o);TR(i,a,t,o)}return r}function NR(e){return e.item}function RR(e){return e.item.mark.source}function jR(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function nfe(e,t){return e=[e||"hover"],t=[t||"update",e[0]],this.on(this.events("view","mouseover",NR),RR,jR(e)),this.on(this.events("view","mouseout",NR),RR,jR(t)),this}function ife(){var e=this._tooltip,t=this._timers,n=this._eventListeners,i,r,o;for(i=t.length;--i>=0;)t[i].stop();for(i=n.length;--i>=0;)for(o=n[i],r=o.sources.length;--r>=0;)o.sources[r].removeEventListener(o.type,o.handler);return e&&e.call(this,this._handler,null,null,null),this}function hi(e,t,n){const i=document.createElement(e);for(const r in t)i.setAttribute(r,t[r]);return n!=null&&(i.textContent=n),i}const rfe="vega-bind",ofe="vega-bind-name",afe="vega-bind-radio";function sfe(e,t,n){if(!t)return;const i=n.param;let r=n.state;return r||(r=n.state={elements:null,active:!1,set:null,update:a=>{a!=e.signal(i.signal)&&e.runAsync(null,()=>{r.source=!0,e.signal(i.signal,a)})}},i.debounce&&(r.update=nv(i.debounce,r.update))),(i.input==null&&i.element?ufe:cfe)(r,t,i,e),r.active||(e.on(e._signals[i.signal],null,()=>{r.source?r.source=!1:r.set(e.signal(i.signal))}),r.active=!0),r}function ufe(e,t,n,i){const r=n.event||"input",o=()=>e.update(t.value);i.signal(n.signal,t.value),t.addEventListener(r,o),TR(i,t,r,o),e.set=a=>{t.value=a,t.dispatchEvent(lfe(r))}}function lfe(e){return typeof Event!="undefined"?new Event(e):{type:e}}function cfe(e,t,n,i){const r=i.signal(n.signal),o=hi("div",{class:rfe}),a=n.input==="radio"?o:o.appendChild(hi("label"));a.appendChild(hi("span",{class:ofe},n.name||n.signal)),t.appendChild(o);let s=ffe;switch(n.input){case"checkbox":s=dfe;break;case"select":s=hfe;break;case"radio":s=gfe;break;case"range":s=pfe;break}s(e,a,n,r)}function ffe(e,t,n,i){const r=hi("input");for(const o in n)o!=="signal"&&o!=="element"&&r.setAttribute(o==="input"?"type":o,n[o]);r.setAttribute("name",n.signal),r.value=i,t.appendChild(r),r.addEventListener("input",()=>e.update(r.value)),e.elements=[r],e.set=o=>r.value=o}function dfe(e,t,n,i){const r={type:"checkbox",name:n.signal};i&&(r.checked=!0);const o=hi("input",r);t.appendChild(o),o.addEventListener("change",()=>e.update(o.checked)),e.elements=[o],e.set=a=>o.checked=!!a||null}function hfe(e,t,n,i){const r=hi("select",{name:n.signal}),o=n.labels||[];n.options.forEach((a,s)=>{const u={value:a};Dm(a,i)&&(u.selected=!0),r.appendChild(hi("option",u,(o[s]||a)+""))}),t.appendChild(r),r.addEventListener("change",()=>{e.update(n.options[r.selectedIndex])}),e.elements=[r],e.set=a=>{for(let s=0,u=n.options.length;s<u;++s)if(Dm(n.options[s],a)){r.selectedIndex=s;return}}}function gfe(e,t,n,i){const r=hi("span",{class:afe}),o=n.labels||[];t.appendChild(r),e.elements=n.options.map((a,s)=>{const u={type:"radio",name:n.signal,value:a};Dm(a,i)&&(u.checked=!0);const l=hi("input",u);l.addEventListener("change",()=>e.update(a));const c=hi("label",{},(o[s]||a)+"");return c.prepend(l),r.appendChild(c),l}),e.set=a=>{const s=e.elements,u=s.length;for(let l=0;l<u;++l)Dm(s[l].value,a)&&(s[l].checked=!0)}}function pfe(e,t,n,i){i=i!==void 0?i:(+n.max+ +n.min)/2;const r=n.max!=null?n.max:Math.max(100,+i)||100,o=n.min||Math.min(0,r,+i)||0,a=n.step||sse(o,r,100),s=hi("input",{type:"range",name:n.signal,min:o,max:r,step:a});s.value=i;const u=hi("span",{},+i);t.appendChild(s),t.appendChild(u);const l=()=>{u.textContent=s.value,e.update(+s.value)};s.addEventListener("input",l),s.addEventListener("change",l),e.elements=[s],e.set=c=>{s.value=c,u.textContent=c}}function Dm(e,t){return e===t||e+""==t+""}function LR(e,t,n,i,r,o){return t=t||new i(e.loader()),t.initialize(n,kR(e),DR(e),Fm(e),r,o).background(e.background())}function uA(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function mfe(e,t,n,i){const r=new i(e.loader(),uA(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,Fm(e),e);return t&&t.handlers().forEach(o=>{r.on(o.type,o.handler)}),r}function yfe(e,t){const n=this,i=n._renderType,r=n._eventConfig.bind,o=Vg(i);e=n._el=e?lA(n,e,!0):null,zce(n),o||n.error("Unrecognized renderer type: "+i);const a=o.handler||Uf,s=e?o.renderer:o.headless;return n._renderer=s?LR(n,n._renderer,e,s):null,n._handler=mfe(n,n._handler,e,a),n._redraw=!0,e&&r!=="none"&&(t=t?n._elBind=lA(n,t,!0):e.appendChild(hi("form",{class:"vega-bindings"})),n._bind.forEach(u=>{u.param.element&&r!=="container"&&(u.element=lA(n,u.param.element,!!u.param.input))}),n._bind.forEach(u=>{sfe(n,u.element||t,u)})),n}function lA(e,t,n){if(typeof t=="string")if(typeof document!="undefined"){if(t=document.querySelector(t),!t)return e.error("Signal bind element not found: "+t),null}else return e.error("DOM document instance not found."),null;if(t&&n)try{t.innerHTML=""}catch(i){t=null,e.error(i)}return t}const Kd=e=>+e||0,vfe=e=>({top:e,bottom:e,left:e,right:e});function PR(e){return se(e)?{top:Kd(e.top),bottom:Kd(e.bottom),left:Kd(e.left),right:Kd(e.right)}:vfe(Kd(e))}async function cA(e,t,n,i){const r=Vg(t),o=r&&r.headless;return o||I("Unrecognized renderer type: "+t),await e.runAsync(),LR(e,null,null,o,n,i).renderAsync(e._scenegraph.root)}async function bfe(e,t){e!==ba.Canvas&&e!==ba.SVG&&e!==ba.PNG&&I("Unrecognized image type: "+e);const n=await cA(this,e,t);return e===ba.SVG?xfe(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function xfe(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}async function wfe(e,t){return(await cA(this,ba.Canvas,e,t)).canvas()}async function Efe(e){return(await cA(this,ba.SVG,e)).svg()}function _fe(e,t,n){return _R(e,Gu,Hd,n).parse(t)}function Afe(e){var t=this._runtime.scales;return ae(t,e)||I("Unrecognized scale or projection: "+e),t[e].value}var IR="width",BR="height",fA="padding",zR={skip:!0};function UR(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===fA?i.left+i.right:0)}function qR(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===fA?i.top+i.bottom:0)}function $fe(e){var t=e._signals,n=t[IR],i=t[BR],r=t[fA];function o(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,s=>{e._width=s.size,e._viewWidth=UR(e,s.size),o()},{size:n}),e._resizeHeight=e.add(null,s=>{e._height=s.size,e._viewHeight=qR(e,s.size),o()},{size:i});const a=e.add(null,o,{pad:r});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=i.rank+1,a.rank=r.rank+1}function Sfe(e,t,n,i,r,o){this.runAfter(a=>{let s=0;a._autosize=0,a.width()!==n&&(s=1,a.signal(IR,n,zR),a._resizeWidth.skip(!0)),a.height()!==i&&(s=1,a.signal(BR,i,zR),a._resizeHeight.skip(!0)),a._viewWidth!==e&&(a._resize=1,a._viewWidth=e),a._viewHeight!==t&&(a._resize=1,a._viewHeight=t),(a._origin[0]!==r[0]||a._origin[1]!==r[1])&&(a._resize=1,a._origin=r),s&&a.run("enter"),o&&a.runAfter(u=>u.resize())},!1,1)}function Ofe(e){return this._runtime.getState(e||{data:Cfe,signals:Ffe,recurse:!0})}function Cfe(e,t){return t.modified&&Q(t.input.value)&&e.indexOf("_:vega:_")}function Ffe(e,t){return!(e==="parent"||t instanceof Gu.proxy)}function kfe(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}function Dfe(e,t){function n(i){e({timestamp:Date.now(),elapsed:i})}this._timers.push(Bce(n,t))}function Mfe(e,t,n,i){const r=e.element();r&&r.setAttribute("title",Tfe(i))}function Tfe(e){return e==null?"":Q(e)?HR(e):se(e)&&!Zo(e)?Nfe(e):e+""}function Nfe(e){return Object.keys(e).map(t=>{const n=e[t];return t+": "+(Q(n)?HR(n):WR(n))}).join(`
`)}function HR(e){return"["+e.map(WR).join(", ")+"]"}function WR(e){return Q(e)?"[\u2026]":se(e)&&!Zo(e)?"{\u2026}":e}function GR(e,t){const n=this;if(t=t||{},Wu.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),t.logLevel!=null&&n.logLevel(t.logLevel),t.locale||e.locale){const o=ge({},e.locale,t.locale);n.locale(QF(o.number,o.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||ba.Canvas,n._scenegraph=new L2;const i=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||Mfe,n._redraw=!0,n._handler=new Uf().scene(i),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=Qce(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const r=_fe(n,e,t.expr);n._runtime=r,n._signals=r.signals,n._bind=(e.bindings||[]).map(o=>({state:null,param:ge({},o)})),r.root&&r.root.set(i),i.source=r.data.root.input,n.pulse(r.data.root.input,n.changeset().insert(i.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=UR(n,n._width),n._viewHeight=qR(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,$fe(n),Uce(n),qce(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function Mm(e,t){return ae(e._signals,t)?e._signals[t]:I("Unrecognized signal name: "+ne(t))}function YR(e,t){const n=(e._targets||[]).filter(i=>i._update&&i._update.handler===t);return n.length?n[0]:null}function VR(e,t,n,i){let r=YR(n,i);return r||(r=uA(e,()=>i(t,n.value)),r.handler=i,e.on(n,null,r)),e}function XR(e,t,n){const i=YR(t,n);return i&&t._targets.remove(i),e}q(GR,Wu,{async evaluate(e,t,n){if(await Wu.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,Yce(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(i){this.error(i)}return n&&k0(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=e!=null?e+"":null;return t!==this._desc&&FR(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const i=Mm(this,e);return arguments.length===1?i.value:this.update(i,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",PR(e)):PR(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(Vg(e)||I("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(Wu.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(Mm(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:Sfe,addEventListener(e,t,n){let i=t;return n&&n.trap===!1||(i=uA(this,t),i.raw=t),this._handler.on(e,i),this},removeEventListener(e,t){for(var n=this._handler.handlers(e),i=n.length,r,o;--i>=0;)if(o=n[i].type,r=n[i].handler,e===o&&(t===r||t===r.raw)){this._handler.off(o,r);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return VR(this,e,Mm(this,e),t)},removeSignalListener(e,t){return XR(this,Mm(this,e),t)},addDataListener(e,t){return VR(this,e,Om(this,e).values,t)},removeDataListener(e,t){return XR(this,Om(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=sA(this,null);this._globalCursor=!!e,t&&sA(this,t)}return this}else return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:Dfe,events:tfe,finalize:ife,hover:nfe,data:Hce,change:Cm,insert:Wce,remove:Gce,scale:Afe,initialize:yfe,toImageURL:bfe,toCanvas:wfe,toSVG:Efe,getState:Ofe,setState:kfe});const Rfe="view",Tm="[",Nm="]",KR="{",JR="}",jfe=":",ZR=",",Lfe="@",Pfe=">",Ife=/[[\]{}]/,Bfe={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let QR,e9;function t9(e,t,n){return QR=t||Rfe,e9=n||Bfe,n9(e.trim()).map(dA)}function zfe(e){return e9[e]}function Jd(e,t,n,i,r){const o=e.length;let a=0,s;for(;t<o;++t){if(s=e[t],!a&&s===n)return t;r&&r.indexOf(s)>=0?--a:i&&i.indexOf(s)>=0&&++a}return t}function n9(e){const t=[],n=e.length;let i=0,r=0;for(;r<n;)r=Jd(e,r,ZR,Tm+KR,Nm+JR),t.push(e.substring(i,r).trim()),i=++r;if(t.length===0)throw"Empty event selector: "+e;return t}function dA(e){return e[0]==="["?Ufe(e):qfe(e)}function Ufe(e){const t=e.length;let n=1,i;if(n=Jd(e,n,Nm,Tm,Nm),n===t)throw"Empty between selector: "+e;if(i=n9(e.substring(1,n)),i.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==Pfe)throw"Expected '>' after between selector: "+e;i=i.map(dA);const r=dA(e.slice(1).trim());return r.between?{between:i,stream:r}:(r.between=i,r)}function qfe(e){const t={source:QR},n=[];let i=[0,0],r=0,o=0,a=e.length,s=0,u,l;if(e[a-1]===JR){if(s=e.lastIndexOf(KR),s>=0){try{i=Hfe(e.substring(s+1,a-1))}catch(c){throw"Invalid throttle specification: "+e}e=e.slice(0,s).trim(),a=e.length}else throw"Unmatched right brace: "+e;s=0}if(!a)throw e;if(e[0]===Lfe&&(r=++s),u=Jd(e,s,jfe),u<a&&(n.push(e.substring(o,u).trim()),o=s=++u),s=Jd(e,s,Tm),s===a)n.push(e.substring(o,a).trim());else if(n.push(e.substring(o,s).trim()),l=[],o=++s,o===a)throw"Unmatched left bracket: "+e;for(;s<a;){if(s=Jd(e,s,Nm),s===a)throw"Unmatched left bracket: "+e;if(l.push(e.substring(o,s).trim()),s<a-1&&e[++s]!==Tm)throw"Expected left bracket: "+e;o=++s}if(!(a=n.length)||Ife.test(n[a-1]))throw"Invalid event selector: "+e;return a>1?(t.type=n[1],r?t.markname=n[0].slice(1):zfe(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),l!=null&&(t.filter=l),i[0]&&(t.throttle=i[0]),i[1]&&(t.debounce=i[1]),t}function Hfe(e){const t=e.split(ZR);if(!e.length||t.length>2)throw e;return t.map(n=>{const i=+n;if(i!==i)throw e;return i})}function Wfe(e){return se(e)?e:{type:e||"pad"}}const Zd=e=>+e||0,Gfe=e=>({top:e,bottom:e,left:e,right:e});function Yfe(e){return se(e)?e.signal?e:{top:Zd(e.top),bottom:Zd(e.bottom),left:Zd(e.left),right:Zd(e.right)}:Gfe(Zd(e))}const Rt=e=>se(e)&&!Q(e)?ge({},e):{value:e};function i9(e,t,n,i){return n!=null?(se(n)&&!Q(n)||Q(n)&&n.length&&se(n[0])?e.update[t]=n:e[i||"enter"][t]={value:n},1):0}function Wt(e,t,n){for(const i in t)i9(e,i,t[i]);for(const i in n)i9(e,i,n[i],"update")}function Ll(e,t,n){for(const i in t)n&&ae(n,i)||(e[i]=ge(e[i]||{},t[i]));return e}function Pl(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const hA="mark",gA="frame",pA="scope",Vfe="axis",Xfe="axis-domain",Kfe="axis-grid",Jfe="axis-label",Zfe="axis-tick",Qfe="axis-title",ede="legend",tde="legend-band",nde="legend-entry",ide="legend-gradient",r9="legend-label",rde="legend-symbol",ode="legend-title",ade="title",sde="title-text",ude="title-subtitle";function lde(e,t,n,i,r){const o={},a={};let s,u,l,c;u="lineBreak",t==="text"&&r[u]!=null&&!Pl(u,e)&&mA(o,u,r[u]),(n=="legend"||String(n).startsWith("axis"))&&(n=null),c=n===gA?r.group:n===hA?ge({},r.mark,r[t]):null;for(u in c)l=Pl(u,e)||(u==="fill"||u==="stroke")&&(Pl("fill",e)||Pl("stroke",e)),l||mA(o,u,c[u]);oe(i).forEach(f=>{const d=r.style&&r.style[f];for(const h in d)Pl(h,e)||mA(o,h,d[h])}),e=ge({},e);for(u in o)c=o[u],c.signal?(s=s||{})[u]=c:a[u]=c;return e.enter=ge(a,e.enter),s&&(e.update=ge(s,e.update)),e}function mA(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const o9=e=>Fe(e)?ne(e):e.signal?`(${e.signal})`:a9(e);function Rm(e){if(e.gradient!=null)return fde(e);let t=e.signal?`(${e.signal})`:e.color?cde(e.color):e.field!=null?a9(e.field):e.value!==void 0?ne(e.value):void 0;return e.scale!=null&&(t=dde(e,t)),t===void 0&&(t=null),e.exponent!=null&&(t=`pow(${t},${Lm(e.exponent)})`),e.mult!=null&&(t+=`*${Lm(e.mult)}`),e.offset!=null&&(t+=`+${Lm(e.offset)}`),e.round&&(t=`round(${t})`),t}const jm=(e,t,n,i)=>`(${e}(${[t,n,i].map(Rm).join(",")})+'')`;function cde(e){return e.c?jm("hcl",e.h,e.c,e.l):e.h||e.s?jm("hsl",e.h,e.s,e.l):e.l||e.a?jm("lab",e.l,e.a,e.b):e.r||e.g||e.b?jm("rgb",e.r,e.g,e.b):null}function fde(e){const t=[e.start,e.stop,e.count].map(n=>n==null?null:ne(n));for(;t.length&&Ee(t)==null;)t.pop();return t.unshift(o9(e.gradient)),`gradient(${t.join(",")})`}function Lm(e){return se(e)?"("+Rm(e)+")":e}function a9(e){return s9(se(e)?e:{datum:e})}function s9(e){let t,n,i;if(e.signal)t="datum",i=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(i=e.parent,t+=".datum"):i=e.group}else e.datum?(t="datum",i=e.datum):I("Invalid field reference: "+ne(e));return e.signal||(i=Fe(i)?d0(i).map(ne).join("]["):s9(i)),t+"["+i+"]"}function dde(e,t){const n=o9(e.scale);return e.range!=null?t=`lerp(_range(${n}), ${+e.range})`:(t!==void 0&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(+e.band==1?"":"*"+Lm(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),t==null&&(t="0")),t}function hde(e){let t="";return e.forEach(n=>{const i=Rm(n);t+=n.test?`(${n.test})?${i}:`:i}),Ee(t)===":"&&(t+="null"),t}function u9(e,t,n,i,r,o){const a={};o=o||{},o.encoders={$encode:a},e=lde(e,t,n,i,r.config);for(const s in e)a[s]=gde(e[s],t,o,r);return o}function gde(e,t,n,i){const r={},o={};for(const a in e)e[a]!=null&&(r[a]=mde(pde(e[a]),i,n,o));return{$expr:{marktype:t,channels:r},$fields:Object.keys(o),$output:Object.keys(e)}}function pde(e){return Q(e)?hde(e):Rm(e)}function mde(e,t,n,i){const r=qr(e,t);return r.$fields.forEach(o=>i[o]=1),ge(n,r.$params),r.$expr}const yde="outer",vde=["value","update","init","react","bind"];function l9(e,t){I(e+' for "outer" push: '+ne(t))}function c9(e,t){const n=e.name;if(e.push===yde)t.signals[n]||l9("No prior signal definition",n),vde.forEach(i=>{e[i]!==void 0&&l9("Invalid property ",i)});else{const i=t.addSignal(n,e.value);e.react===!1&&(i.react=!1),e.bind&&t.addBinding(n,e.bind)}}function yA(e,t,n,i){this.id=-1,this.type=e,this.value=t,this.params=n,i&&(this.parent=i)}function Pm(e,t,n,i){return new yA(e,t,n,i)}function Im(e,t){return Pm("operator",e,t)}function te(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function Qd(e,t){return t?{$field:e,$name:t}:{$field:e}}const vA=Qd("key");function f9(e,t){return{$compare:e,$order:t}}function bde(e,t){const n={$key:e};return t&&(n.$flat=!0),n}const xde="ascending",wde="descending";function Ede(e){return se(e)?(e.order===wde?"-":"+")+Bm(e.op,e.field):""}function Bm(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const bA="scope",xA="view";function At(e){return e&&e.signal}function _de(e){return e&&e.expr}function zm(e){if(At(e))return!0;if(se(e)){for(const t in e)if(zm(e[t]))return!0}return!1}function ir(e,t){return e!=null?e:t}function Xs(e){return e&&e.signal||e}const d9="timer";function eh(e,t){return(e.merge?$de:e.stream?Sde:e.type?Ode:I("Invalid stream specification: "+ne(e)))(e,t)}function Ade(e){return e===bA?xA:e||xA}function $de(e,t){const n=e.merge.map(r=>eh(r,t)),i=wA({merge:n},e,t);return t.addStream(i).id}function Sde(e,t){const n=eh(e.stream,t),i=wA({stream:n},e,t);return t.addStream(i).id}function Ode(e,t){let n;e.type===d9?(n=t.event(d9,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(Ade(e.source),e.type);const i=wA({stream:n},e,t);return Object.keys(i).length===1?n:t.addStream(i).id}function wA(e,t,n){let i=t.between;return i&&(i.length!==2&&I('Stream "between" parameter must have 2 entries: '+ne(t)),e.between=[eh(i[0],n),eh(i[1],n)]),i=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&i.push(Cde(t.marktype,t.markname,t.markrole)),t.source===bA&&i.push("inScope(event.item)"),i.length&&(e.filter=qr("("+i.join(")&&(")+")",n).$expr),(i=t.throttle)!=null&&(e.throttle=+i),(i=t.debounce)!=null&&(e.debounce=+i),t.consume&&(e.consume=!0),e}function Cde(e,t,n){const i="event.item";return i+(e&&e!=="*"?"&&"+i+".mark.marktype==='"+e+"'":"")+(n?"&&"+i+".mark.role==='"+n+"'":"")+(t?"&&"+i+".mark.name==='"+t+"'":"")}const Fde={code:"_.$value",ast:{type:"Identifier",value:"value"}};function kde(e,t,n){const i=e.encode,r={target:n};let o=e.events,a=e.update,s=[];o||I("Signal update missing events specification."),Fe(o)&&(o=t9(o,t.isSubscope()?bA:xA)),o=oe(o).filter(u=>u.signal||u.scale?(s.push(u),0):1),s.length>1&&(s=[Mde(s)]),o.length&&s.push(o.length>1?{merge:o}:o[0]),i!=null&&(a&&I("Signal encode and update are mutually exclusive."),a="encode(item(),"+ne(i)+")"),r.update=Fe(a)?qr(a,t):a.expr!=null?qr(a.expr,t):a.value!=null?a.value:a.signal!=null?{$expr:Fde,$params:{$value:t.signalRef(a.signal)}}:I("Invalid signal update specification."),e.force&&(r.options={force:!0}),s.forEach(u=>t.addUpdate(ge(Dde(u,t),r)))}function Dde(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):eh(e,t)}}function Mde(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}function Tde(e,t){const n=t.getSignal(e.name);let i=e.update;e.init&&(i?I("Signals can not include both init and update expressions."):(i=e.init,n.initonly=!0)),i&&(i=qr(i,t),n.update=i.$expr,n.params=i.$params),e.on&&e.on.forEach(r=>kde(r,t,n.id))}const He=e=>(t,n,i)=>Pm(e,n,t||void 0,i),h9=He("aggregate"),Nde=He("axisticks"),g9=He("bound"),rr=He("collect"),p9=He("compare"),Rde=He("datajoin"),m9=He("encode"),jde=He("expression"),Lde=He("facet"),Pde=He("field"),Ide=He("key"),Bde=He("legendentries"),zde=He("load"),Ude=He("mark"),qde=He("multiextent"),Hde=He("multivalues"),Wde=He("overlap"),Gde=He("params"),y9=He("prefacet"),Yde=He("projection"),Vde=He("proxy"),Xde=He("relay"),v9=He("render"),Kde=He("scale"),Ks=He("sieve"),Jde=He("sortitems"),b9=He("viewlayout"),Zde=He("values");let Qde=0;const x9={min:"min",max:"max",count:"sum"};function ehe(e,t){const n=e.type||"linear";DM(n)||I("Unrecognized scale type: "+ne(n)),t.addScale(e.name,{type:n,domain:void 0})}function the(e,t){const n=t.getScale(e.name).params;let i;n.domain=w9(e.domain,e,t),e.range!=null&&(n.range=_9(e,t,n)),e.interpolate!=null&&fhe(e.interpolate,n),e.nice!=null&&(n.nice=che(e.nice)),e.bins!=null&&(n.bins=lhe(e.bins,t));for(i in e)ae(n,i)||i==="name"||(n[i]=ki(e[i],t))}function ki(e,t){return se(e)?e.signal?t.signalRef(e.signal):I("Unsupported object: "+ne(e)):e}function Um(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>ki(n,t))}function qm(e){I("Can not find data set: "+ne(e))}function w9(e,t,n){if(!e){(t.domainMin!=null||t.domainMax!=null)&&I("No scale domain defined for domainMin/domainMax to override.");return}return e.signal?n.signalRef(e.signal):(Q(e)?nhe:e.fields?rhe:ihe)(e,t,n)}function nhe(e,t,n){return e.map(i=>ki(i,n))}function ihe(e,t,n){const i=n.getData(e.data);return i||qm(e.data),al(t.type)?i.valuesRef(n,e.field,E9(e.sort,!1)):NM(t.type)?i.domainRef(n,e.field):i.extentRef(n,e.field)}function rhe(e,t,n){const i=e.data,r=e.fields.reduce((o,a)=>(a=Fe(a)?{data:i,field:a}:Q(a)||a.signal?ohe(a,n):a,o.push(a),o),[]);return(al(t.type)?ahe:NM(t.type)?she:uhe)(e,n,r)}function ohe(e,t){const n="_:vega:_"+Qde++,i=rr({});if(Q(e))i.value={$ingest:e};else if(e.signal){const r="setdata("+ne(n)+","+e.signal+")";i.params.input=t.signalRef(r)}return t.addDataPipeline(n,[i,Ks({})]),{data:n,field:"data"}}function ahe(e,t,n){const i=E9(e.sort,!0);let r,o;const a=n.map(l=>{const c=t.getData(l.data);return c||qm(l.data),c.countsRef(t,l.field,i)}),s={groupby:vA,pulse:a};i&&(r=i.op||"count",o=i.field?Bm(r,i.field):"count",s.ops=[x9[r]],s.fields=[t.fieldRef(o)],s.as=[o]),r=t.add(h9(s));const u=t.add(rr({pulse:te(r)}));return o=t.add(Zde({field:vA,sort:t.sortRef(i),pulse:te(u)})),te(o)}function E9(e,t){return e&&(!e.field&&!e.op?se(e)?e.field="key":e={field:"key"}:!e.field&&e.op!=="count"?I("No field provided for sort aggregate op: "+e.op):t&&e.field&&e.op&&!x9[e.op]&&I("Multiple domain scales can not be sorted using "+e.op)),e}function she(e,t,n){const i=n.map(r=>{const o=t.getData(r.data);return o||qm(r.data),o.domainRef(t,r.field)});return te(t.add(Hde({values:i})))}function uhe(e,t,n){const i=n.map(r=>{const o=t.getData(r.data);return o||qm(r.data),o.extentRef(t,r.field)});return te(t.add(qde({extents:i})))}function lhe(e,t){return e.signal||Q(e)?Um(e,t):t.objectProperty(e)}function che(e){return se(e)?{interval:ki(e.interval),step:ki(e.step)}:ki(e)}function fhe(e,t){t.interpolate=ki(e.type||e),e.gamma!=null&&(t.interpolateGamma=ki(e.gamma))}function _9(e,t,n){const i=t.config.range;let r=e.range;if(r.signal)return t.signalRef(r.signal);if(Fe(r)){if(i&&ae(i,r))return e=ge({},e,{range:i[r]}),_9(e,t,n);r==="width"?r=[0,{signal:"width"}]:r==="height"?r=al(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:I("Unrecognized scale range value: "+ne(r))}else if(r.scheme){n.scheme=Q(r.scheme)?Um(r.scheme,t):ki(r.scheme,t),r.extent&&(n.schemeExtent=Um(r.extent,t)),r.count&&(n.schemeCount=ki(r.count,t));return}else if(r.step){n.rangeStep=ki(r.step,t);return}else{if(al(e.type)&&!Q(r))return w9(r,e,t);Q(r)||I("Unsupported range type: "+ne(r))}return r.map(o=>(Q(o)?Um:ki)(o,t))}function dhe(e,t){const n=t.config.projection||{},i={};for(const r in e)r!=="name"&&(i[r]=EA(e[r],r,t));for(const r in n)i[r]==null&&(i[r]=EA(n[r],r,t));t.addProjection(e.name,i)}function EA(e,t,n){return Q(e)?e.map(i=>EA(i,t,n)):se(e)?e.signal?n.signalRef(e.signal):t==="fit"?e:I("Unsupported parameter object: "+ne(e)):e}const or="top",Il="left",Bl="right",ka="bottom",A9="center",hhe="vertical",ghe="start",phe="middle",mhe="end",_A="index",AA="label",yhe="offset",zl="perc",vhe="perc2",Di="value",th="guide-label",$A="guide-title",bhe="group-title",xhe="group-subtitle",$9="symbol",Hm="gradient",SA="discrete",OA="size",whe="shape",Ehe="fill",_he="stroke",Ahe="strokeWidth",$he="strokeDash",She="opacity",CA=[OA,whe,Ehe,_he,Ahe,$he,She],nh={name:1,style:1,interactive:1},Oe={value:0},Mi={value:1},Wm="group",S9="rect",FA="rule",Ohe="symbol",Js="text";function ih(e){return e.type=Wm,e.interactive=e.interactive||!1,e}function Vn(e,t){const n=(i,r)=>ir(e[i],ir(t[i],r));return n.isVertical=i=>hhe===ir(e.direction,t.direction||(i?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>ir(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>ir(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>ir(e.columns,ir(t.columns,+n.isVertical(!0))),n}function O9(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function Che(e,t,n){const i=t.config.style[n];return i&&i[e]}function Gm(e,t,n){return`item.anchor === '${ghe}' ? ${e} : item.anchor === '${mhe}' ? ${t} : ${n}`}const kA=Gm(ne(Il),ne(Bl),ne(A9));function Fhe(e){const t=e("tickBand");let n=e("tickOffset"),i,r;return t?t.signal?(i={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},r={signal:`(${t.signal}) === 'extent'`},se(n)||(n={signal:`(${t.signal}) === 'extent' ? 0 : ${n}`})):t==="extent"?(i=1,r=!0,n=0):(i=.5,r=!1):(i=e("bandPosition"),r=e("tickExtra")),{extra:r,band:i,offset:n}}function C9(e,t){return t?e?se(e)?Object.assign({},e,{offset:C9(e.offset,t)}):{value:e,offset:t}:t:e}function gi(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=Ll(e.encode,t,nh)):e.interactive=!1,e}function khe(e,t,n,i){const r=Vn(e,n),o=r.isVertical(),a=r.gradientThickness(),s=r.gradientLength();let u,l,c,f,d;o?(l=[0,1],c=[0,0],f=a,d=s):(l=[0,0],c=[1,0],f=s,d=a);const h={enter:u={opacity:Oe,x:Oe,y:Oe,width:Rt(f),height:Rt(d)},update:ge({},u,{opacity:Mi,fill:{gradient:t,start:l,stop:c}}),exit:{opacity:Oe}};return Wt(h,{stroke:r("gradientStrokeColor"),strokeWidth:r("gradientStrokeWidth")},{opacity:r("gradientOpacity")}),gi({type:S9,role:ide,encode:h},i)}function Dhe(e,t,n,i,r){const o=Vn(e,n),a=o.isVertical(),s=o.gradientThickness(),u=o.gradientLength();let l,c,f,d,h="";a?(l="y",f="y2",c="x",d="width",h="1-"):(l="x",f="x2",c="y",d="height");const g={opacity:Oe,fill:{scale:t,field:Di}};g[l]={signal:h+"datum."+zl,mult:u},g[c]=Oe,g[f]={signal:h+"datum."+vhe,mult:u},g[d]=Rt(s);const p={enter:g,update:ge({},g,{opacity:Mi}),exit:{opacity:Oe}};return Wt(p,{stroke:o("gradientStrokeColor"),strokeWidth:o("gradientStrokeWidth")},{opacity:o("gradientOpacity")}),gi({type:S9,role:tde,key:Di,from:r,encode:p},i)}const Mhe=`datum.${zl}<=0?"${Il}":datum.${zl}>=1?"${Bl}":"${A9}"`,The=`datum.${zl}<=0?"${ka}":datum.${zl}>=1?"${or}":"${phe}"`;function F9(e,t,n,i){const r=Vn(e,t),o=r.isVertical(),a=Rt(r.gradientThickness()),s=r.gradientLength();let u=r("labelOverlap"),l,c,f,d,h="";const g={enter:l={opacity:Oe},update:c={opacity:Mi,text:{field:AA}},exit:{opacity:Oe}};return Wt(g,{fill:r("labelColor"),fillOpacity:r("labelOpacity"),font:r("labelFont"),fontSize:r("labelFontSize"),fontStyle:r("labelFontStyle"),fontWeight:r("labelFontWeight"),limit:ir(e.labelLimit,t.gradientLabelLimit)}),o?(l.align={value:"left"},l.baseline=c.baseline={signal:The},f="y",d="x",h="1-"):(l.align=c.align={signal:Mhe},l.baseline={value:"top"},f="x",d="y"),l[f]=c[f]={signal:h+"datum."+zl,mult:s},l[d]=c[d]=a,a.offset=ir(e.labelOffset,t.gradientLabelOffset)||0,u=u?{separation:r("labelSeparation"),method:u,order:"datum."+_A}:void 0,gi({type:Js,role:r9,style:th,key:Di,from:i,encode:g,overlap:u},n)}function Nhe(e,t,n,i,r){const o=Vn(e,t),a=n.entries,s=!!(a&&a.interactive),u=a?a.name:void 0,l=o("clipHeight"),c=o("symbolOffset"),f={data:"value"},d=`(${r}) ? datum.${yhe} : datum.${OA}`,h=l?Rt(l):{field:OA},g=`datum.${_A}`,p=`max(1, ${r})`;let m,y,v,b,x;h.mult=.5,m={enter:y={opacity:Oe,x:{signal:d,mult:.5,offset:c},y:h},update:v={opacity:Mi,x:y.x,y:y.y},exit:{opacity:Oe}};let w=null,_=null;e.fill||(w=t.symbolBaseFillColor,_=t.symbolBaseStrokeColor),Wt(m,{fill:o("symbolFillColor",w),shape:o("symbolType"),size:o("symbolSize"),stroke:o("symbolStrokeColor",_),strokeDash:o("symbolDash"),strokeDashOffset:o("symbolDashOffset"),strokeWidth:o("symbolStrokeWidth")},{opacity:o("symbolOpacity")}),CA.forEach(C=>{e[C]&&(v[C]=y[C]={scale:e[C],field:Di})});const E=gi({type:Ohe,role:rde,key:Di,from:f,clip:l?!0:void 0,encode:m},n.symbols),$=Rt(c);$.offset=o("labelOffset"),m={enter:y={opacity:Oe,x:{signal:d,offset:$},y:h},update:v={opacity:Mi,text:{field:AA},x:y.x,y:y.y},exit:{opacity:Oe}},Wt(m,{align:o("labelAlign"),baseline:o("labelBaseline"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontStyle:o("labelFontStyle"),fontWeight:o("labelFontWeight"),limit:o("labelLimit")});const O=gi({type:Js,role:r9,style:th,key:Di,from:f,encode:m},n.labels);return m={enter:{noBound:{value:!l},width:Oe,height:l?Rt(l):Oe,opacity:Oe},exit:{opacity:Oe},update:v={opacity:Mi,row:{signal:null},column:{signal:null}}},o.isVertical(!0)?(b=`ceil(item.mark.items.length / ${p})`,v.row.signal=`${g}%${b}`,v.column.signal=`floor(${g} / ${b})`,x={field:["row",g]}):(v.row.signal=`floor(${g} / ${p})`,v.column.signal=`${g} % ${p}`,x={field:g}),v.column.signal=`(${r})?${v.column.signal}:${g}`,i={facet:{data:i,name:"value",groupby:_A}},ih({role:pA,from:i,encode:Ll(m,a,nh),marks:[E,O],name:u,interactive:s,sort:x})}function Rhe(e,t){const n=Vn(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const DA='item.orient === "left"',MA='item.orient === "right"',Ym=`(${DA} || ${MA})`,jhe=`datum.vgrad && ${Ym}`,Lhe=Gm('"top"','"bottom"','"middle"'),Phe=Gm('"right"','"left"','"center"'),Ihe=`datum.vgrad && ${MA} ? (${Phe}) : (${Ym} && !(datum.vgrad && ${DA})) ? "left" : ${kA}`,Bhe=`item._anchor || (${Ym} ? "middle" : "start")`,zhe=`${jhe} ? (${DA} ? -90 : 90) : 0`,Uhe=`${Ym} ? (datum.vgrad ? (${MA} ? "bottom" : "top") : ${Lhe}) : "top"`;function qhe(e,t,n,i){const r=Vn(e,t),o={enter:{opacity:Oe},update:{opacity:Mi,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:Oe}};return Wt(o,{orient:r("titleOrient"),_anchor:r("titleAnchor"),anchor:{signal:Bhe},angle:{signal:zhe},align:{signal:Ihe},baseline:{signal:Uhe},text:e.title,fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),baseline:r("titleBaseline")}),gi({type:Js,role:ode,style:$A,from:i,encode:o},n)}function Hhe(e,t){let n;return se(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+k9(e.path)+")":e.sphere&&(n="geoShape("+k9(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function k9(e){return se(e)&&e.signal?e.signal:ne(e)}function D9(e){const t=e.role||"";return!t.indexOf("axis")||!t.indexOf("legend")||!t.indexOf("title")?t:e.type===Wm?pA:t||hA}function Whe(e){return{marktype:e.type,name:e.name||void 0,role:e.role||D9(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function Ghe(e,t){return e&&e.signal?t.signalRef(e.signal):e!==!1}function TA(e,t){const n=x3(e.type);n||I("Unrecognized transform type: "+ne(e.type));const i=Pm(n.type.toLowerCase(),null,M9(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(i)),i.metadata=n.metadata||{},i}function M9(e,t,n){const i={},r=e.params.length;for(let o=0;o<r;++o){const a=e.params[o];i[a.name]=Yhe(a,t,n)}return i}function Yhe(e,t,n){const i=e.type,r=t[e.name];if(i==="index")return Vhe(e,t,n);if(r===void 0){e.required&&I("Missing required "+ne(t.type)+" parameter: "+ne(e.name));return}else{if(i==="param")return Xhe(e,t,n);if(i==="projection")return n.projectionRef(t[e.name])}return e.array&&!At(r)?r.map(o=>T9(e,o,n)):T9(e,r,n)}function T9(e,t,n){const i=e.type;if(At(t))return R9(i)?I("Expression references can not be signals."):NA(i)?n.fieldRef(t):j9(i)?n.compareRef(t):n.signalRef(t.signal);{const r=e.expr||NA(i);return r&&Khe(t)?n.exprRef(t.expr,t.as):r&&Jhe(t)?Qd(t.field,t.as):R9(i)?qr(t,n):Zhe(i)?te(n.getData(t).values):NA(i)?Qd(t):j9(i)?n.compareRef(t):t}}function Vhe(e,t,n){return Fe(t.from)||I('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function Xhe(e,t,n){const i=t[e.name];return e.array?(Q(i)||I("Expected an array of sub-parameters. Instead: "+ne(i)),i.map(r=>N9(e,r,n))):N9(e,i,n)}function N9(e,t,n){const i=e.params.length;let r;for(let a=0;a<i;++a){r=e.params[a];for(const s in r.key)if(r.key[s]!==t[s]){r=null;break}if(r)break}r||I("Unsupported parameter: "+ne(t));const o=ge(M9(r,t,n),r.key);return te(n.add(Gde(o)))}const Khe=e=>e&&e.expr,Jhe=e=>e&&e.field,Zhe=e=>e==="data",R9=e=>e==="expr",NA=e=>e==="field",j9=e=>e==="compare";function Qhe(e,t,n){let i,r,o,a,s;return e?(i=e.facet)&&(t||I("Only group marks can be faceted."),i.field!=null?a=s=Vm(i,n):(e.data?s=te(n.getData(e.data).aggregate):(o=TA(ge({type:"aggregate",groupby:oe(i.groupby)},i.aggregate),n),o.params.key=n.keyRef(i.groupby),o.params.pulse=Vm(i,n),a=s=te(n.add(o))),r=n.keyRef(i.groupby,!0))):a=te(n.add(rr(null,[{}]))),a||(a=Vm(e,n)),{key:r,pulse:a,parent:s}}function Vm(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:te(t.getData(e.data).output)}function Zs(e,t,n,i,r){this.scope=e,this.input=t,this.output=n,this.values=i,this.aggregate=r,this.index={}}Zs.fromEntries=function(e,t){const n=t.length,i=t[n-1],r=t[n-2];let o=t[0],a=null,s=1;for(o&&o.type==="load"&&(o=t[1]),e.add(t[0]);s<n;++s)t[s].params.pulse=te(t[s-1]),e.add(t[s]),t[s].type==="aggregate"&&(a=t[s]);return new Zs(e,o,r,i,a)};function L9(e){return Fe(e)?e:null}function P9(e,t,n){const i=Bm(n.op,n.field);let r;if(t.ops){for(let o=0,a=t.as.length;o<a;++o)if(t.as[o]===i)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((r=n.op.signal)?e.signalRef(r):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(i))}function rh(e,t,n,i,r,o,a){const s=t[n]||(t[n]={}),u=Ede(o);let l=L9(r),c,f;if(l!=null&&(e=t.scope,l=l+(u?"|"+u:""),c=s[l]),!c){const d=o?{field:vA,pulse:t.countsRef(e,r,o)}:{field:e.fieldRef(r),pulse:te(t.output)};u&&(d.sort=e.sortRef(o)),f=e.add(Pm(i,void 0,d)),a&&(t.index[r]=f),c=te(f),l!=null&&(s[l]=c)}return c}Zs.prototype={countsRef(e,t,n){const i=this,r=i.counts||(i.counts={}),o=L9(t);let a,s,u;return o!=null&&(e=i.scope,a=r[o]),a?n&&n.field&&P9(e,a.agg.params,n):(u={groupby:e.fieldRef(t,"key"),pulse:te(i.output)},n&&n.field&&P9(e,u,n),s=e.add(h9(u)),a=e.add(rr({pulse:te(s)})),a={agg:s,ref:te(a)},o!=null&&(r[o]=a)),a.ref},tuplesRef(){return te(this.values)},extentRef(e,t){return rh(e,this,"extent","extent",t,!1)},domainRef(e,t){return rh(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return rh(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return rh(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return rh(e,this,"indata","tupleindex",t,!0,!0)}};function e0e(e,t,n){const i=e.from.facet,r=i.name,o=Vm(i,t);let a;i.name||I("Facet must have a name: "+ne(i)),i.data||I("Facet must reference a data set: "+ne(i)),i.field?a=t.add(y9({field:t.fieldRef(i.field),pulse:o})):i.groupby?a=t.add(Lde({key:t.keyRef(i.groupby),group:te(t.proxy(n.parent)),pulse:o})):I("Facet must specify groupby or field: "+ne(i));const s=t.fork(),u=s.add(rr()),l=s.add(Ks({pulse:te(u)}));s.addData(r,new Zs(s,u,u,l)),s.addSignal("parent",null),a.params.subflow={$subflow:s.parse(e).toRuntime()}}function t0e(e,t,n){const i=t.add(y9({pulse:n.pulse})),r=t.fork();r.add(Ks()),r.addSignal("parent",null),i.params.subflow={$subflow:r.parse(e).toRuntime()}}function I9(e,t,n){const i=e.remove,r=e.insert,o=e.toggle,a=e.modify,s=e.values,u=t.add(Im()),l="if("+e.trigger+',modify("'+n+'",'+[r,i,o,a,s].map(f=>f==null?"null":f).join(",")+"),0)",c=qr(l,t);u.update=c.$expr,u.params=c.$params}function Xm(e,t){const n=D9(e),i=e.type===Wm,r=e.from&&e.from.facet,o=e.overlap;let a=e.layout||n===pA||n===gA,s,u,l,c,f,d,h;const g=n===hA||a||r,p=Qhe(e.from,i,t);u=t.add(Rde({key:p.key||(e.key?Qd(e.key):void 0),pulse:p.pulse,clean:!i}));const m=te(u);u=l=t.add(rr({pulse:m})),u=t.add(Ude({markdef:Whe(e),interactive:Ghe(e.interactive,t),clip:Hhe(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:te(u)}));const y=te(u);u=c=t.add(m9(u9(e.encode,e.type,n,e.style,t,{mod:!1,pulse:y}))),u.params.parent=t.encode(),e.transform&&e.transform.forEach(_=>{const E=TA(_,t),$=E.metadata;($.generates||$.changes)&&I("Mark transforms should not generate new data."),$.nomod||(c.params.mod=!0),E.params.pulse=te(u),t.add(u=E)}),e.sort&&(u=t.add(Jde({sort:t.compareRef(e.sort),pulse:te(u)})));const v=te(u);(r||a)&&(a=t.add(b9({layout:t.objectProperty(e.layout),legends:t.legends,mark:y,pulse:v})),d=te(a));const b=t.add(g9({mark:y,pulse:d||v}));h=te(b),i&&(g&&(s=t.operators,s.pop(),a&&s.pop()),t.pushState(v,d||h,m),r?e0e(e,t,p):g?t0e(e,t,p):t.parse(e),t.popState(),g&&(a&&s.push(a),s.push(b))),o&&(h=n0e(o,h,t));const x=t.add(v9({pulse:h})),w=t.add(Ks({pulse:te(x)},void 0,t.parent()));e.name!=null&&(f=e.name,t.addData(f,new Zs(t,l,x,w)),e.on&&e.on.forEach(_=>{(_.insert||_.remove||_.toggle)&&I("Marks only support modify triggers."),I9(_,t,f)}))}function n0e(e,t,n){const i=e.method,r=e.bound,o=e.separation,a={separation:At(o)?n.signalRef(o.signal):o,method:At(i)?n.signalRef(i.signal):i,pulse:t};if(e.order&&(a.sort=n.compareRef({field:e.order})),r){const s=r.tolerance;a.boundTolerance=At(s)?n.signalRef(s.signal):+s,a.boundScale=n.scaleRef(r.scale),a.boundOrient=r.orient}return te(n.add(Wde(a)))}function i0e(e,t){const n=t.config.legend,i=e.encode||{},r=Vn(e,n),o=i.legend||{},a=o.name||void 0,s=o.interactive,u=o.style,l={};let c=0,f,d,h;CA.forEach(b=>e[b]?(l[b]=e[b],c=c||e[b]):0),c||I("Missing valid scale for legend.");const g=r0e(e,t.scaleType(c)),p={title:e.title!=null,scales:l,type:g,vgrad:g!=="symbol"&&r.isVertical()},m=te(t.add(rr(null,[p]))),y={enter:{x:{value:0},y:{value:0}}},v=te(t.add(Bde(d={type:g,scale:t.scaleRef(c),count:t.objectProperty(r("tickCount")),limit:t.property(r("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return g===Hm?(h=[khe(e,c,n,i.gradient),F9(e,n,i.labels,v)],d.count=d.count||t.signalRef(`max(2,2*floor((${Xs(r.gradientLength())})/100))`)):g===SA?h=[Dhe(e,c,n,i.gradient,v),F9(e,n,i.labels,v)]:(f=Rhe(e,n),h=[Nhe(e,n,i,v,Xs(f.columns))],d.size=s0e(e,t,h[0].marks)),h=[ih({role:nde,from:m,encode:y,marks:h,layout:f,interactive:s})],p.title&&h.push(qhe(e,n,i.title,m)),Xm(ih({role:ede,from:m,encode:Ll(a0e(r,e,n),o,nh),marks:h,aria:r("aria"),description:r("description"),zindex:r("zindex"),name:a,interactive:s,style:u}),t)}function r0e(e,t){let n=e.type||$9;return!e.type&&o0e(e)===1&&(e.fill||e.stroke)&&(n=Qx(t)?Hm:e2(t)?SA:$9),n!==Hm?n:e2(t)?SA:Hm}function o0e(e){return CA.reduce((t,n)=>t+(e[n]?1:0),0)}function a0e(e,t,n){const i={enter:{},update:{}};return Wt(i,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),i}function s0e(e,t,n){const i=Xs(B9("size",e,n)),r=Xs(B9("strokeWidth",e,n)),o=Xs(u0e(n[1].encode,t,th));return qr(`max(ceil(sqrt(${i})+${r}),${o})`,t)}function B9(e,t,n){return t[e]?`scale("${t[e]}",datum)`:O9(e,n[0].encode)}function u0e(e,t,n){return O9("fontSize",e)||Che("fontSize",t,n)}const l0e=`item.orient==="${Il}"?-90:item.orient==="${Bl}"?90:0`;function c0e(e,t){e=Fe(e)?{text:e}:e;const n=Vn(e,t.config.title),i=e.encode||{},r=i.group||{},o=r.name||void 0,a=r.interactive,s=r.style,u=[],l={},c=te(t.add(rr(null,[l])));return u.push(h0e(e,n,f0e(e),c)),e.subtitle&&u.push(g0e(e,n,i.subtitle,c)),Xm(ih({role:ade,from:c,encode:d0e(n,r),marks:u,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:o,interactive:a,style:s}),t)}function f0e(e){const t=e.encode;return t&&t.title||ge({name:e.name,interactive:e.interactive,style:e.style},t)}function d0e(e,t){const n={enter:{},update:{}};return Wt(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:kA},angle:{signal:l0e},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),Ll(n,t,nh)}function h0e(e,t,n,i){const r={value:0},o=e.text,a={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return Wt(a,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),gi({type:Js,role:sde,style:bhe,from:i,encode:a},n)}function g0e(e,t,n,i){const r={value:0},o=e.subtitle,a={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return Wt(a,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),gi({type:Js,role:ude,style:xhe,from:i,encode:a},n)}function p0e(e,t){const n=[];e.transform&&e.transform.forEach(i=>{n.push(TA(i,t))}),e.on&&e.on.forEach(i=>{I9(i,t,e.name)}),t.addDataPipeline(e.name,m0e(e,t,n))}function m0e(e,t,n){const i=[];let r=null,o=!1,a=!1,s,u,l,c,f;for(e.values?At(e.values)||zm(e.format)?(i.push(z9(t,e)),i.push(r=Qs())):i.push(r=Qs({$ingest:e.values,$format:e.format})):e.url?zm(e.url)||zm(e.format)?(i.push(z9(t,e)),i.push(r=Qs())):i.push(r=Qs({$request:e.url,$format:e.format})):e.source&&(r=s=oe(e.source).map(d=>te(t.getData(d).output)),i.push(null)),u=0,l=n.length;u<l;++u)c=n[u],f=c.metadata,!r&&!f.source&&i.push(r=Qs()),i.push(c),f.generates&&(a=!0),f.modifies&&!a&&(o=!0),f.source?r=c:f.changes&&(r=null);return s&&(l=s.length-1,i[0]=Xde({derive:o,pulse:l?s:s[0]}),(o||l)&&i.splice(1,0,Qs())),r||i.push(Qs()),i.push(Ks({})),i}function Qs(e){const t=rr({},e);return t.metadata={source:!0},t}function z9(e,t){return zde({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const U9=e=>e===ka||e===or,Km=(e,t,n)=>At(e)?x0e(e.signal,t,n):e===Il||e===or?t:n,jt=(e,t,n)=>At(e)?v0e(e.signal,t,n):U9(e)?t:n,ar=(e,t,n)=>At(e)?b0e(e.signal,t,n):U9(e)?n:t,q9=(e,t,n)=>At(e)?w0e(e.signal,t,n):e===or?{value:t}:{value:n},y0e=(e,t,n)=>At(e)?E0e(e.signal,t,n):e===Bl?{value:t}:{value:n},v0e=(e,t,n)=>H9(`${e} === '${or}' || ${e} === '${ka}'`,t,n),b0e=(e,t,n)=>H9(`${e} !== '${or}' && ${e} !== '${ka}'`,t,n),x0e=(e,t,n)=>RA(`${e} === '${Il}' || ${e} === '${or}'`,t,n),w0e=(e,t,n)=>RA(`${e} === '${or}'`,t,n),E0e=(e,t,n)=>RA(`${e} === '${Bl}'`,t,n),H9=(e,t,n)=>(t=t!=null?Rt(t):t,n=n!=null?Rt(n):n,W9(t)&&W9(n)?(t=t?t.signal||ne(t.value):null,n=n?n.signal||ne(n.value):null,{signal:`${e} ? (${t}) : (${n})`}):[ge({test:e},t)].concat(n||[])),W9=e=>e==null||Object.keys(e).length===1,RA=(e,t,n)=>({signal:`${e} ? (${Ul(t)}) : (${Ul(n)})`}),_0e=(e,t,n,i,r)=>({signal:(i!=null?`${e} === '${Il}' ? (${Ul(i)}) : `:"")+(n!=null?`${e} === '${ka}' ? (${Ul(n)}) : `:"")+(r!=null?`${e} === '${Bl}' ? (${Ul(r)}) : `:"")+(t!=null?`${e} === '${or}' ? (${Ul(t)}) : `:"")+"(null)"}),Ul=e=>At(e)?e.signal:e==null?null:ne(e),A0e=(e,t)=>t===0?0:At(e)?{signal:`(${e.signal}) * ${t}`}:{value:e*t},ql=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function Hl(e,t,n,i){let r;if(t&&ae(t,e))return t[e];if(ae(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":r="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":r=e[5].toLowerCase()+e.slice(6)}return i[$A][r]}else if(e.startsWith("label")){switch(e){case"labelColor":r="fill";break;case"labelFont":case"labelFontSize":r=e[5].toLowerCase()+e.slice(6)}return i[th][r]}return null}function G9(e){const t={};for(const n of e)if(!!n)for(const i in n)t[i]=1;return Object.keys(t)}function $0e(e,t){var n=t.config,i=n.style,r=n.axis,o=t.scaleType(e.scale)==="band"&&n.axisBand,a=e.orient,s,u,l;if(At(a)){const f=G9([n.axisX,n.axisY]),d=G9([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);s={};for(l of f)s[l]=jt(a,Hl(l,n.axisX,r,i),Hl(l,n.axisY,r,i));u={};for(l of d)u[l]=_0e(a.signal,Hl(l,n.axisTop,r,i),Hl(l,n.axisBottom,r,i),Hl(l,n.axisLeft,r,i),Hl(l,n.axisRight,r,i))}else s=a===or||a===ka?n.axisX:n.axisY,u=n["axis"+a[0].toUpperCase()+a.slice(1)];return s||u||o?ge({},r,s,u,o):r}function S0e(e,t,n,i){const r=Vn(e,t),o=e.orient;let a,s;const u={enter:a={opacity:Oe},update:s={opacity:Mi},exit:{opacity:Oe}};Wt(u,{stroke:r("domainColor"),strokeCap:r("domainCap"),strokeDash:r("domainDash"),strokeDashOffset:r("domainDashOffset"),strokeWidth:r("domainWidth"),strokeOpacity:r("domainOpacity")});const l=Y9(e,0),c=Y9(e,1);return a.x=s.x=jt(o,l,Oe),a.x2=s.x2=jt(o,c),a.y=s.y=ar(o,l,Oe),a.y2=s.y2=ar(o,c),gi({type:FA,role:Xfe,from:i,encode:u},n)}function Y9(e,t){return{scale:e.scale,range:t}}function O0e(e,t,n,i,r){const o=Vn(e,t),a=e.orient,s=e.gridScale,u=Km(a,1,-1),l=C0e(e.offset,u);let c,f,d;const h={enter:c={opacity:Oe},update:d={opacity:Mi},exit:f={opacity:Oe}};Wt(h,{stroke:o("gridColor"),strokeCap:o("gridCap"),strokeDash:o("gridDash"),strokeDashOffset:o("gridDashOffset"),strokeOpacity:o("gridOpacity"),strokeWidth:o("gridWidth")});const g={scale:e.scale,field:Di,band:r.band,extra:r.extra,offset:r.offset,round:o("tickRound")},p=jt(a,{signal:"height"},{signal:"width"}),m=s?{scale:s,range:0,mult:u,offset:l}:{value:0,offset:l},y=s?{scale:s,range:1,mult:u,offset:l}:ge(p,{mult:u,offset:l});return c.x=d.x=jt(a,g,m),c.y=d.y=ar(a,g,m),c.x2=d.x2=ar(a,y),c.y2=d.y2=jt(a,y),f.x=jt(a,g),f.y=ar(a,g),gi({type:FA,role:Kfe,key:Di,from:i,encode:h},n)}function C0e(e,t){if(t!==1)if(!se(e))e=At(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);else{let n=e=ge({},e);for(;n.mult!=null;)if(se(n.mult))n=n.mult=ge({},n.mult);else return n.mult=At(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n.mult=t}return e}function F0e(e,t,n,i,r,o){const a=Vn(e,t),s=e.orient,u=Km(s,-1,1);let l,c,f;const d={enter:l={opacity:Oe},update:f={opacity:Mi},exit:c={opacity:Oe}};Wt(d,{stroke:a("tickColor"),strokeCap:a("tickCap"),strokeDash:a("tickDash"),strokeDashOffset:a("tickDashOffset"),strokeOpacity:a("tickOpacity"),strokeWidth:a("tickWidth")});const h=Rt(r);h.mult=u;const g={scale:e.scale,field:Di,band:o.band,extra:o.extra,offset:o.offset,round:a("tickRound")};return f.y=l.y=jt(s,Oe,g),f.y2=l.y2=jt(s,h),c.x=jt(s,g),f.x=l.x=ar(s,Oe,g),f.x2=l.x2=ar(s,h),c.y=ar(s,g),gi({type:FA,role:Zfe,key:Di,from:i,encode:d},n)}function jA(e,t,n,i,r){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+i+","+r+")"}}function k0e(e,t,n,i,r,o){const a=Vn(e,t),s=e.orient,u=e.scale,l=Km(s,-1,1),c=Xs(a("labelFlush")),f=Xs(a("labelFlushOffset")),d=a("labelAlign"),h=a("labelBaseline");let g=c===0||!!c,p;const m=Rt(r);m.mult=l,m.offset=Rt(a("labelPadding")||0),m.offset.mult=l;const y={scale:u,field:Di,band:.5,offset:C9(o.offset,a("labelOffset"))},v=jt(s,g?jA(u,c,'"left"','"right"','"center"'):{value:"center"},y0e(s,"left","right")),b=jt(s,q9(s,"bottom","top"),g?jA(u,c,'"top"','"bottom"','"middle"'):{value:"middle"}),x=jA(u,c,`-(${f})`,f,0);g=g&&f;const w={opacity:Oe,x:jt(s,y,m),y:ar(s,y,m)},_={enter:w,update:p={opacity:Mi,text:{field:AA},x:w.x,y:w.y,align:v,baseline:b},exit:{opacity:Oe,x:w.x,y:w.y}};Wt(_,{dx:!d&&g?jt(s,x):null,dy:!h&&g?ar(s,x):null}),Wt(_,{angle:a("labelAngle"),fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontWeight:a("labelFontWeight"),fontStyle:a("labelFontStyle"),limit:a("labelLimit"),lineHeight:a("labelLineHeight")},{align:d,baseline:h});const E=a("labelBound");let $=a("labelOverlap");return $=$||E?{separation:a("labelSeparation"),method:$,order:"datum.index",bound:E?{scale:u,orient:s,tolerance:E}:null}:void 0,p.align!==v&&(p.align=ql(p.align,v)),p.baseline!==b&&(p.baseline=ql(p.baseline,b)),gi({type:Js,role:Jfe,style:th,key:Di,from:i,encode:_,overlap:$},n)}function D0e(e,t,n,i){const r=Vn(e,t),o=e.orient,a=Km(o,-1,1);let s,u;const l={enter:s={opacity:Oe,anchor:Rt(r("titleAnchor",null)),align:{signal:kA}},update:u=ge({},s,{opacity:Mi,text:Rt(e.title)}),exit:{opacity:Oe}},c={signal:`lerp(range("${e.scale}"), ${Gm(0,1,.5)})`};return u.x=jt(o,c),u.y=ar(o,c),s.angle=jt(o,Oe,A0e(a,90)),s.baseline=jt(o,q9(o,ka,or),{value:ka}),u.angle=s.angle,u.baseline=s.baseline,Wt(l,{fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),angle:r("titleAngle"),baseline:r("titleBaseline")}),M0e(r,o,l,n),l.update.align=ql(l.update.align,s.align),l.update.angle=ql(l.update.angle,s.angle),l.update.baseline=ql(l.update.baseline,s.baseline),gi({type:Js,role:Qfe,style:$A,from:i,encode:l},n)}function M0e(e,t,n,i){const r=(s,u)=>s!=null?(n.update[u]=ql(Rt(s),n.update[u]),!1):!Pl(u,i),o=r(e("titleX"),"x"),a=r(e("titleY"),"y");n.enter.auto=a===o?Rt(a):jt(t,Rt(a),Rt(o))}function T0e(e,t){const n=$0e(e,t),i=e.encode||{},r=i.axis||{},o=r.name||void 0,a=r.interactive,s=r.style,u=Vn(e,n),l=Fhe(u),c={scale:e.scale,ticks:!!u("ticks"),labels:!!u("labels"),grid:!!u("grid"),domain:!!u("domain"),title:e.title!=null},f=te(t.add(rr({},[c]))),d=te(t.add(Nde({scale:t.scaleRef(e.scale),extra:t.property(l.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),h=[];let g;return c.grid&&h.push(O0e(e,n,i.grid,d,l)),c.ticks&&(g=u("tickSize"),h.push(F0e(e,n,i.ticks,d,g,l))),c.labels&&(g=c.ticks?g:0,h.push(k0e(e,n,i.labels,d,g,l))),c.domain&&h.push(S0e(e,n,i.domain,f)),c.title&&h.push(D0e(e,n,i.title,f)),Xm(ih({role:Vfe,from:f,encode:Ll(N0e(u,e),r,nh),marks:h,aria:u("aria"),description:u("description"),zindex:u("zindex"),name:o,interactive:a,style:s}),t)}function N0e(e,t){const n={enter:{},update:{}};return Wt(n,{orient:e("orient"),offset:e("offset")||0,position:ir(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function V9(e,t,n){const i=oe(e.signals),r=oe(e.scales);return n||i.forEach(o=>c9(o,t)),oe(e.projections).forEach(o=>dhe(o,t)),r.forEach(o=>ehe(o,t)),oe(e.data).forEach(o=>p0e(o,t)),r.forEach(o=>the(o,t)),(n||i).forEach(o=>Tde(o,t)),oe(e.axes).forEach(o=>T0e(o,t)),oe(e.marks).forEach(o=>Xm(o,t)),oe(e.legends).forEach(o=>i0e(o,t)),e.title&&c0e(e.title,t),t.parseLambdas(),t}const R0e=e=>Ll({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function j0e(e,t){const n=t.config,i=te(t.root=t.add(Im())),r=L0e(e,n);r.forEach(l=>c9(l,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const o=t.add(rr()),a=t.add(m9(u9(R0e(e.encode),Wm,gA,e.style,t,{pulse:te(o)}))),s=t.add(b9({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:i,pulse:te(a)}));t.operators.pop(),t.pushState(te(a),te(s),null),V9(e,t,r),t.operators.push(s);let u=t.add(g9({mark:i,pulse:te(s)}));return u=t.add(v9({pulse:te(u)})),u=t.add(Ks({pulse:te(u)})),t.addData("root",new Zs(t,o,o,u)),t}function oh(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function L0e(e,t){const n=a=>ir(e[a],t[a]),i=[oh("background",n("background")),oh("autosize",Wfe(n("autosize"))),oh("padding",Yfe(n("padding"))),oh("width",n("width")||0),oh("height",n("height")||0)],r=i.reduce((a,s)=>(a[s.name]=s,a),{}),o={};return oe(e.signals).forEach(a=>{ae(r,a.name)?a=ge(r[a.name],a):i.push(a),o[a.name]=a}),oe(t.signals).forEach(a=>{!ae(o,a.name)&&!ae(r,a.name)&&i.push(a)}),i}function X9(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function K9(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}X9.prototype=K9.prototype={parse(e){return V9(e,this)},fork(){return new K9(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){const t=e instanceof yA?te(e):e;return this.add(Vde({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;this.root&&(this.root.root=!0);for(e in this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(i,r,o){let a,s;i&&(a=i.data||(i.data={}),s=a[r]||(a[r]=[]),s.push(o))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const i in t.index)n(t.index[i],e,"index:"+i)}return this},pushState(e,t,n){this._encode.push(te(this.add(Ks({pulse:e})))),this._parent.push(t),this._lookup.push(n?te(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return Ee(this._parent)},encode(){return Ee(this._encode)},lookup(){return Ee(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(Fe(e))return Qd(e,t);e.signal||I("Unsupported field reference: "+ne(e));const n=e.signal;let i=this.field[n];if(!i){const r={name:this.signalRef(n)};t&&(r.as=t),this.field[n]=i=te(this.add(Pde(r)))}return i},compareRef(e){let t=!1;const n=o=>At(o)?(t=!0,this.signalRef(o.signal)):_de(o)?(t=!0,this.exprRef(o.expr)):o,i=oe(e.field).map(n),r=oe(e.order).map(n);return t?te(this.add(p9({fields:i,orders:r}))):f9(i,r)},keyRef(e,t){let n=!1;const i=o=>At(o)?(n=!0,te(r[o.signal])):o,r=this.signals;return e=oe(e).map(i),n?te(this.add(Ide({fields:e,flat:t}))):bde(e,t)},sortRef(e){if(!e)return e;const t=Bm(e.op,e.field),n=e.order||xde;return n.signal?te(this.add(p9({fields:t,orders:this.signalRef(n.signal)}))):f9(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const i=this.id();this.streams.push({id:i,source:e,type:t}),this.events[n]=i}return this.events[n]},hasOwnSignal(e){return ae(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&I("Duplicate signal name: "+ne(e));const n=t instanceof yA?t:this.add(Im(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||I("Unrecognized signal name: "+ne(e)),this.signals[e]},signalRef(e){return this.signals[e]?te(this.signals[e]):(ae(this.lambdas,e)||(this.lambdas[e]=this.add(Im(null))),te(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const i=e[t],r=qr(i,this),o=this.lambdas[i];o.params=r.$params,o.update=r.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return!e||!se(e)?e:this.signalRef(e.signal||LA(e))},exprRef(e,t){const n={expr:qr(e,this)};return t&&(n.expr.$name=t),te(this.add(jde(n)))},addBinding(e,t){this.bindings||I("Nested signals do not support binding: "+ne(e)),this.bindings.push(ge({signal:e},t))},addScaleProj(e,t){ae(this.scales,e)&&I("Duplicate scale or projection name: "+ne(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,Kde(t))},addProjection(e,t){this.addScaleProj(e,Yde(t))},getScale(e){return this.scales[e]||I("Unrecognized scale name: "+ne(e)),this.scales[e]},scaleRef(e){return te(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return ae(this.data,e)&&I("Duplicate data set name: "+ne(e)),this.data[e]=t},getData(e){return this.data[e]||I("Undefined data set name: "+ne(e)),this.data[e]},addDataPipeline(e,t){return ae(this.data,e)&&I("Duplicate data set name: "+ne(e)),this.addData(e,Zs.fromEntries(this,t))}};function LA(e){return(Q(e)?P0e:I0e)(e)}function P0e(e){const t=e.length;let n="[";for(let i=0;i<t;++i){const r=e[i];n+=(i>0?",":"")+(se(r)?r.signal||LA(r):ne(r))}return n+"]"}function I0e(e){let t="{",n=0,i,r;for(i in e)r=e[i],t+=(++n>1?",":"")+ne(i)+":"+(se(r)?r.signal||LA(r):ne(r));return t+"}"}function B0e(){const e="sans-serif",t=30,n=2,i="#4c78a8",r="#000",o="#888",a="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:i},area:{fill:i},image:null,line:{stroke:i,strokeWidth:n},path:{stroke:i},rect:{fill:i},rule:{stroke:r},shape:{stroke:i},symbol:{fill:i,size:64},text:{fill:r,font:e,fontSize:11},trail:{fill:i,size:n},style:{"guide-label":{fill:r,font:e,fontSize:10},"guide-title":{fill:r,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:r,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:r,font:e,fontSize:12},point:{size:t,strokeWidth:n,shape:"circle"},circle:{size:t,strokeWidth:n},square:{size:t,strokeWidth:n,shape:"square"},cell:{fill:"transparent",stroke:a}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:o,grid:!1,gridWidth:1,gridColor:a,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:o,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:a,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:o,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function z0e(e,t,n){return se(e)||I("Input Vega specification must be an object."),t=h0(B0e(),t,e.config),j0e(e,new X9(t,n)).toRuntime()}var U0e="vega",q0e="5.21.0",H0e="The Vega visualization grammar.",W0e=["vega","visualization","interaction","dataflow","library","data","d3"],G0e="BSD-3-Clause",Y0e="UW Interactive Data Lab (http://idl.cs.washington.edu)",V0e="build/vega-node.js",X0e="build/vega.module.js",K0e="build/vega.min.js",J0e="build/vega.min.js",Z0e="index.d.ts",Q0e="vega/vega",ege={bundle:"rollup -c --config-bundle",prebuild:"rimraf build && rimraf build-es5",build:"rollup -c --config-core --config-bundle --config-ie",postbuild:"node schema-copy",pretest:"yarn build --config-test",test:"TZ=America/Los_Angeles tape 'test/**/*-test.js'",prepublishOnly:"yarn test && yarn build",postpublish:"./schema-deploy.sh"},tge={"vega-crossfilter":"~4.0.5","vega-dataflow":"~5.7.4","vega-encode":"~4.8.3","vega-event-selector":"~3.0.0","vega-expression":"~5.0.0","vega-force":"~4.0.7","vega-format":"~1.0.4","vega-functions":"~5.12.1","vega-geo":"~4.3.8","vega-hierarchy":"~4.0.9","vega-label":"~1.1.0","vega-loader":"~4.4.1","vega-parser":"~6.1.4","vega-projection":"~1.4.5","vega-regression":"~1.0.9","vega-runtime":"~6.1.3","vega-scale":"~7.1.1","vega-scenegraph":"~4.9.4","vega-statistics":"~1.7.10","vega-time":"~2.0.4","vega-transforms":"~4.9.4","vega-typings":"~0.22.0","vega-util":"~1.17.0","vega-view":"~5.10.1","vega-view-transforms":"~4.5.8","vega-voronoi":"~4.1.5","vega-wordcloud":"~4.1.3"},nge={"vega-schema":"*"},ige="774165e29850b66ec8b79ba52a7955f1ab936ea6",rge={name:U0e,version:q0e,description:H0e,keywords:W0e,license:G0e,author:Y0e,main:V0e,module:X0e,unpkg:K0e,jsdelivr:J0e,types:Z0e,repository:Q0e,scripts:ege,dependencies:tge,devDependencies:nge,gitHead:ige};ge(Gu,LY,See,Ote,Wie,Pre,mae,zoe,vae,Rae,Wae,ise);const oge=rge.version;var age=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",version:oge,Dataflow:Wu,EventStream:R0,MultiPulse:qv,Operator:Ye,Parameters:N0,Pulse:ra,Transform:N,changeset:gs,definition:x3,ingest:Le,isTuple:D0,transform:w3,transforms:Gu,tupleid:ee,interpolate:t2,interpolateColors:bg,interpolateRange:RM,quantizeInterpolator:jM,scale:Ne,scheme:n2,projection:sE,View:GR,defaultLocale:jv,formatLocale:$0,locale:QF,resetDefaultLocale:$W,timeFormatLocale:ef,expressionFunction:mt,parse:z0e,runtimeContext:_R,codegenExpression:d4,parseExpression:l4,parseSelector:t9,Debug:uC,Error:Jy,Info:sC,None:oC,Warn:aC,accessor:jn,accessorFields:Xt,accessorName:ut,array:oe,ascending:v0,clampRange:wC,compare:tv,constant:Jt,debounce:nv,error:I,extend:ge,extent:vr,extentIndex:EC,falsy:Jo,fastmap:Lu,field:Ln,flush:_C,hasOwnProperty:ae,id:Dc,identity:yn,inherits:q,inrange:Pu,isArray:Q,isBoolean:iv,isDate:Zo,isFunction:me,isIterable:AC,isNumber:Qo,isObject:se,isRegExp:$C,isString:Fe,key:rv,lerp:SC,logger:lC,lruCache:OC,merge:CC,mergeConfig:h0,one:ju,pad:FC,panLinear:pC,panLog:mC,panPow:yC,panSymlog:vC,peek:Ee,quarter:bC,repeat:Tc,span:Nc,splitAccessPath:d0,stringValue:ne,toBoolean:ov,toDate:av,toNumber:Kt,toSet:Hi,toString:sv,truncate:kC,truthy:xi,utcquarter:xC,visitArray:ea,writeConfig:Mc,zero:Ko,zoomLinear:Zy,zoomLog:Qy,zoomPow:y0,zoomSymlog:ev,bandwidthNRD:Xv,bin:S3,bootstrapCI:O3,cumulativeLogNormal:tb,cumulativeNormal:I0,cumulativeUniform:ob,densityLogNormal:eb,densityNormal:Kv,densityUniform:rb,dotbin:C3,quantileLogNormal:nb,quantileNormal:B0,quantileUniform:ab,quantiles:Yv,quartiles:Vv,get random(){return Ei},randomInteger:RG,randomKDE:Zv,randomLCG:NG,randomLogNormal:k3,randomMixture:D3,randomNormal:Jv,randomUniform:M3,regressionExp:N3,regressionLinear:sb,regressionLoess:I3,regressionLog:T3,regressionPoly:j3,regressionPow:R3,regressionQuad:ub,sampleCurve:U0,sampleLogNormal:Qv,sampleNormal:P0,sampleUniform:ib,setRandom:MG,DATE:Bn,DAY:Qt,DAYOFYEAR:br,HOURS:ri,MILLISECONDS:Wi,MINUTES:oi,MONTH:Zt,QUARTER:In,SECONDS:wi,TIME_UNITS:mv,WEEK:xt,YEAR:zt,dayofyear:nF,timeBin:wF,timeFloor:lF,timeInterval:zu,timeOffset:dF,timeSequence:pF,timeUnitSpecifier:tF,timeUnits:vv,utcFloor:cF,utcInterval:Uu,utcOffset:hF,utcSequence:mF,utcdayofyear:oF,utcweek:aF,week:iF,format:O0,formats:Bv,inferType:n3,inferTypes:i3,loader:C0,read:s3,responseType:a3,typeParsers:Lv,Bounds:Et,CanvasHandler:Uf,CanvasRenderer:Gg,Gradient:ZM,GroupItem:$g,Handler:ya,Item:Ag,Marks:ai,RenderType:ba,Renderer:Dr,ResourceLoader:h2,SVGHandler:U2,SVGRenderer:X2,SVGStringRenderer:Z2,Scenegraph:L2,boundClip:mT,boundContext:Tf,boundItem:j2,boundMark:D5,boundStroke:xo,domChild:Un,domClear:Xi,domCreate:ma,domFind:P2,font:Lg,fontFamily:Pf,fontSize:kr,intersect:dT,intersectBoxLine:cl,intersectPath:x2,intersectPoint:w2,intersectRule:m5,lineHeight:ga,markup:V2,multiLineOffset:T2,pathCurves:s2,pathEqual:yT,pathParse:sl,pathRectangle:o5,pathRender:Cf,pathSymbols:r5,pathTrail:a5,point:Ig,renderModule:Vg,resetSVGClipId:u5,resetSVGDefIds:UQ,sceneEqual:ew,sceneFromJSON:T5,scenePickVisit:Mg,sceneToJSON:M5,sceneVisit:Vi,sceneZOrder:E2,serializeXML:tT,textMetrics:Fr});function sge(e,t,n){let i;t.x2&&(t.x?(n&&e.x>e.x2&&(i=e.x,e.x=e.x2,e.x2=i),e.width=e.x2-e.x):e.x=e.x2-(e.width||0)),t.xc&&(e.x=e.xc-(e.width||0)/2),t.y2&&(t.y?(n&&e.y>e.y2&&(i=e.y,e.y=e.y2,e.y2=i),e.height=e.y2-e.y):e.y=e.y2-(e.height||0)),t.yc&&(e.y=e.yc-(e.height||0)/2)}var uge={NaN:NaN,E:Math.E,LN2:Math.LN2,LN10:Math.LN10,LOG2E:Math.LOG2E,LOG10E:Math.LOG10E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,MIN_VALUE:Number.MIN_VALUE,MAX_VALUE:Number.MAX_VALUE},lge={"*":(e,t)=>e*t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,">":(e,t)=>e>t,"<":(e,t)=>e<t,"<=":(e,t)=>e<=t,">=":(e,t)=>e>=t,"==":(e,t)=>e==t,"!=":(e,t)=>e!=t,"===":(e,t)=>e===t,"!==":(e,t)=>e!==t,"&":(e,t)=>e&t,"|":(e,t)=>e|t,"^":(e,t)=>e^t,"<<":(e,t)=>e<<t,">>":(e,t)=>e>>t,">>>":(e,t)=>e>>>t},cge={"+":e=>+e,"-":e=>-e,"~":e=>~e,"!":e=>!e};const fge=Array.prototype.slice,eu=(e,t,n)=>{const i=n?n(t[0]):t[0];return i[e].apply(i,fge.call(t,1))},dge=(e,t,n,i,r,o,a)=>new Date(e,t||0,n!=null?n:1,i||0,r||0,o||0,a||0);var hge={isNaN:Number.isNaN,isFinite:Number.isFinite,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:Math.atan2,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,pow:Math.pow,random:Math.random,round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,clamp:(e,t,n)=>Math.max(t,Math.min(n,e)),now:Date.now,utc:Date.UTC,datetime:dge,date:e=>new Date(e).getDate(),day:e=>new Date(e).getDay(),year:e=>new Date(e).getFullYear(),month:e=>new Date(e).getMonth(),hours:e=>new Date(e).getHours(),minutes:e=>new Date(e).getMinutes(),seconds:e=>new Date(e).getSeconds(),milliseconds:e=>new Date(e).getMilliseconds(),time:e=>new Date(e).getTime(),timezoneoffset:e=>new Date(e).getTimezoneOffset(),utcdate:e=>new Date(e).getUTCDate(),utcday:e=>new Date(e).getUTCDay(),utcyear:e=>new Date(e).getUTCFullYear(),utcmonth:e=>new Date(e).getUTCMonth(),utchours:e=>new Date(e).getUTCHours(),utcminutes:e=>new Date(e).getUTCMinutes(),utcseconds:e=>new Date(e).getUTCSeconds(),utcmilliseconds:e=>new Date(e).getUTCMilliseconds(),length:e=>e.length,join:function(){return eu("join",arguments)},indexof:function(){return eu("indexOf",arguments)},lastindexof:function(){return eu("lastIndexOf",arguments)},slice:function(){return eu("slice",arguments)},reverse:e=>e.slice().reverse(),parseFloat,parseInt,upper:e=>String(e).toUpperCase(),lower:e=>String(e).toLowerCase(),substring:function(){return eu("substring",arguments,String)},split:function(){return eu("split",arguments,String)},replace:function(){return eu("replace",arguments,String)},trim:e=>String(e).trim(),regexp:RegExp,test:(e,t)=>RegExp(e).test(t)};const gge=["view","item","group","xy","x","y"],pge={Literal:(e,t)=>t.value,Identifier:(e,t)=>{const n=t.name;return e.memberDepth>0?n:n==="datum"?e.datum:n==="event"?e.event:n==="item"?e.item:uge[n]||e.params["$"+n]},MemberExpression:(e,t)=>{const n=!t.computed,i=e(t.object);n&&(e.memberDepth+=1);const r=e(t.property);return n&&(e.memberDepth-=1),i[r]},CallExpression:(e,t)=>{const n=t.arguments;let i=t.callee.name;return i.startsWith("_")&&(i=i.slice(1)),i==="if"?e(n[0])?e(n[1]):e(n[2]):(e.fn[i]||hge[i]).apply(e.fn,n.map(e))},ArrayExpression:(e,t)=>t.elements.map(e),BinaryExpression:(e,t)=>lge[t.operator](e(t.left),e(t.right)),UnaryExpression:(e,t)=>cge[t.operator](e(t.argument)),ConditionalExpression:(e,t)=>e(t.test)?e(t.consequent):e(t.alternate),LogicalExpression:(e,t)=>t.operator==="&&"?e(t.left)&&e(t.right):e(t.left)||e(t.right),ObjectExpression:(e,t)=>t.properties.reduce((n,i)=>{e.memberDepth+=1;const r=e(i.key);return e.memberDepth-=1,n[r]=e(i.value),n},{})};function ah(e,t,n,i,r,o){const a=s=>pge[s.type](a,s);return a.memberDepth=0,a.fn=Object.create(t),a.params=n,a.datum=i,a.event=r,a.item=o,gge.forEach(s=>a.fn[s]=(...u)=>r.vega[s](...u)),a(e)}var mge={operator(e,t){const n=t.ast,i=e.functions;return r=>ah(n,i,r)},parameter(e,t){const n=t.ast,i=e.functions;return(r,o)=>ah(n,i,o,r)},event(e,t){const n=t.ast,i=e.functions;return r=>ah(n,i,void 0,void 0,r)},handler(e,t){const n=t.ast,i=e.functions;return(r,o)=>{const a=o.item&&o.item.datum;return ah(n,i,r,a,o)}},encode(e,t){const{marktype:n,channels:i}=t,r=e.functions,o=n==="group"||n==="image"||n==="rect";return(a,s)=>{const u=a.datum;let l=0,c;for(const f in i)c=ah(i[f].ast,r,s,u,void 0,a),a[f]!==c&&(a[f]=c,l=1);return n!=="rule"&&sge(a,i,o),l}}};const yge="vega-lite",vge='Dominik Moritz, Kanit "Ham" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer',bge="5.1.1",xge=["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],wge="https://vega.github.io/vega-lite/",Ege="Vega-Lite is a concise high-level language for interactive visualization.",_ge="build/vega-lite.js",Age="build/vega-lite.min.js",$ge="build/vega-lite.min.js",Sge="build/src/index",Oge="build/src/index.d.ts",Cge={vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2pdf:"./bin/vl2pdf",vl2vg:"./bin/vl2vg"},Fge={test:"test"},kge=["bin","build","src","vega-lite*","tsconfig.json"],Dge={changelog:"conventional-changelog -p angular -r 2",prebuild:"yarn clean:build",build:"yarn build:only","build:only":"tsc -p tsconfig.build.json && rollup -c","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"rollup -c site/rollup.config.js","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh",clean:"yarn clean:build && del-cli 'site/data/*' 'examples/compiled/*.png' && find site/examples ! -name 'index.md' ! -name 'data' -type f -delete","clean:build":"del-cli 'build/*' !build/vega-lite-schema.json","predeploy:site":"yarn presite","deploy:site":"gh-pages -d site",data:"rsync -r node_modules/vega-datasets/data/* site/data",schema:"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/",renameschema:"scripts/rename-schema.sh",presite:"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh",site:"yarn site:only","site:only":"pushd site && bundle exec jekyll serve -I -l && popd",prettierbase:"prettier '**/*.{md,css,yml}'",eslintbase:"eslint .",format:"yarn eslintbase --fix && yarn prettierbase --write",lint:"yarn eslintbase && yarn prettierbase --check",jest:"NODE_OPTIONS=--experimental-vm-modules npx jest",test:"yarn jest test/ && yarn lint && yarn schema && yarn jest examples/ && yarn test:runtime","test:cover":"yarn jest --collectCoverage test/","test:inspect":"node --inspect-brk --experimental-vm-modules ./node_modules/.bin/jest --runInBand test","test:runtime":"NODE_OPTIONS=--experimental-vm-modules TZ=America/Los_Angeles npx jest test-runtime/ --config test-runtime/jest-config.json","test:runtime:generate":"yarn build:only && del-cli test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime",watch:"tsc -p tsconfig.build.json -w","watch:site":"yarn build:site -w","watch:test":"yarn jest --watch test/"},Mge={type:"git",url:"https://github.com/vega/vega-lite.git"},Tge="BSD-3-Clause",Nge={url:"https://github.com/vega/vega-lite/issues"},Rge={"@babel/core":"^7.15.0","@babel/preset-env":"^7.15.0","@babel/preset-typescript":"^7.15.0","@rollup/plugin-babel":"^5.3.0","@rollup/plugin-commonjs":"^20.0.0","@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^13.0.4","@types/chai":"^4.2.21","@types/d3":"^7.0.0","@types/jest":"^27.0.1","@types/mkdirp":"^1.0.2","@types/pako":"^1.0.2","@typescript-eslint/eslint-plugin":"^4.29.2","@typescript-eslint/parser":"^4.29.2",ajv:"^8.6.2","ajv-formats":"^2.1.1",chai:"^4.3.4",cheerio:"^1.0.0-rc.10","conventional-changelog-cli":"^2.1.1",d3:"^7.0.1","del-cli":"^4.0.1",eslint:"^7.32.0","eslint-config-prettier":"^8.3.0","eslint-plugin-jest":"^24.4.0","eslint-plugin-prettier":"^4.0.0","gh-pages":"^3.2.3","highlight.js":"^11.2.0",jest:"^27.0.6","jest-dev-server":"^5.0.3",mkdirp:"^1.0.4",pako:"^2.0.4",prettier:"^2.3.2",puppeteer:"^10.2.0",rollup:"^2.56.3","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-sourcemaps":"^0.6.3","rollup-plugin-terser":"^7.0.2",serve:"^12.0.0",terser:"^5.7.1","ts-jest":"^27.0.5","ts-json-schema-generator":"^0.95.0",typescript:"~4.4.2","vega-cli":"^5.20.2","vega-datasets":"~2.2.0","vega-embed":"^6.18.2","vega-tooltip":"^0.27.0","yaml-front-matter":"^4.1.1"},jge={"@types/clone":"~2.1.1","array-flat-polyfill":"^1.0.1",clone:"~2.1.2","fast-deep-equal":"~3.1.3","fast-json-stable-stringify":"~2.1.0","json-stringify-pretty-compact":"~3.0.0",tslib:"~2.3.1","vega-event-selector":"~2.0.6","vega-expression":"~4.0.1","vega-util":"~1.16.1",yargs:"~17.1.1"},Lge={vega:"^5.20.2"},Pge={node:">=12"};var Ige={name:yge,author:vge,version:bge,collaborators:xge,homepage:wge,description:Ege,main:_ge,unpkg:Age,jsdelivr:$ge,module:Sge,types:Oge,bin:Cge,directories:Fge,files:kge,scripts:Dge,repository:Mge,license:Tge,bugs:Nge,devDependencies:Rge,dependencies:jge,peerDependencies:Lge,engines:Pge};function Wl(e,t,n){return e.fields=t||[],e.fname=n,e}function Bge(e){return e.length===1?zge(e[0]):Uge(e)}const zge=e=>function(t){return t[e]},Uge=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function PA(e){throw Error(e)}function tu(e){const t=[],n=e.length;let i=null,r=0,o="",a,s,u;e=e+"";function l(){t.push(o+e.substring(a,s)),o="",a=s+1}for(a=s=0;s<n;++s)if(u=e[s],u==="\\")o+=e.substring(a,s),o+=e.substring(++s,++s),a=s;else if(u===i)l(),i=null,r=-1;else{if(i)continue;a===r&&u==='"'||a===r&&u==="'"?(a=s+1,i=u):u==="."&&!r?s>a?l():a=s+1:u==="["?(s>a&&l(),r=a=s+1):u==="]"&&(r||PA("Access path missing open bracket: "+e),r>0&&l(),r=0,a=s+1)}return r&&PA("Access path missing closing bracket: "+e),i&&PA("Access path missing closing quote: "+e),s>a&&(s++,l()),t}function qge(e,t,n){const i=tu(e);return e=i.length===1?i[0]:e,Wl((n&&n.get||Bge)(i),[e],t||e)}qge("id");const Hge=Wl(e=>e,[],"identity");Wl(()=>0,[],"zero");Wl(()=>1,[],"one");Wl(()=>!0,[],"true");Wl(()=>!1,[],"false");function Jm(e,t,n){const i=[t].concat([].slice.call(n));console[e].apply(console,i)}const Wge=0,Gge=1,J9=2,Yge=3,Vge=4;function Xge(e,t){let n=e||Wge;return{level(i){return arguments.length?(n=+i,this):n},error(){return n>=Gge&&Jm(t||"error","ERROR",arguments),this},warn(){return n>=J9&&Jm(t||"warn","WARN",arguments),this},info(){return n>=Yge&&Jm(t||"log","INFO",arguments),this},debug(){return n>=Vge&&Jm(t||"log","DEBUG",arguments),this}}}var J=Array.isArray;function Ve(e){return e===Object(e)}const Z9=e=>e!=="__proto__";function Q9(...e){return e.reduce((t,n)=>{for(const i in n)if(i==="signals")t.signals=Kge(t.signals,n.signals);else{const r=i==="legend"?{layout:1}:i==="style"?!0:null;IA(t,i,n[i],r)}return t},{})}function IA(e,t,n,i){if(!Z9(t))return;let r,o;if(Ve(n)&&!J(n)){o=Ve(e[t])?e[t]:e[t]={};for(r in n)i&&(i===!0||i[r])?IA(o,r,n[r]):Z9(r)&&(o[r]=n[r])}else e[t]=n}function Kge(e,t){if(e==null)return t;const n={},i=[];function r(o){n[o.name]||(n[o.name]=1,i.push(o))}return t.forEach(r),e.forEach(r),i}function ft(e){return e!=null?J(e)?e:[e]:[]}function Jge(e){return typeof e=="function"}const Zge=Object.prototype.hasOwnProperty;function Gl(e,t){return Zge.call(e,t)}function sh(e){return typeof e=="boolean"}function yt(e){return typeof e=="number"}function fe(e){return typeof e=="string"}function ke(e){return J(e)?"["+e.map(ke)+"]":Ve(e)||fe(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function nu(e){const t={},n=e.length;for(let i=0;i<n;++i)t[e[i]]=!0;return t}Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,function(n,i){return Array.isArray(i)?n.push.apply(n,e.call(i,t-1)):n.push(i),n},[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var e7={exports:{}};(function(e){var t=function(){function n(d,h){return h!=null&&d instanceof h}var i;try{i=Map}catch(d){i=function(){}}var r;try{r=Set}catch(d){r=function(){}}var o;try{o=Promise}catch(d){o=function(){}}function a(d,h,g,p,m){typeof h=="object"&&(g=h.depth,p=h.prototype,m=h.includeNonEnumerable,h=h.circular);var y=[],v=[],b=typeof Buffer!="undefined";typeof h=="undefined"&&(h=!0),typeof g=="undefined"&&(g=1/0);function x(w,_){if(w===null)return null;if(_===0)return w;var E,$;if(typeof w!="object")return w;if(n(w,i))E=new i;else if(n(w,r))E=new r;else if(n(w,o))E=new o(function(P,B){w.then(function(H){P(x(H,_-1))},function(H){B(x(H,_-1))})});else if(a.__isArray(w))E=[];else if(a.__isRegExp(w))E=new RegExp(w.source,f(w)),w.lastIndex&&(E.lastIndex=w.lastIndex);else if(a.__isDate(w))E=new Date(w.getTime());else{if(b&&Buffer.isBuffer(w))return Buffer.allocUnsafe?E=Buffer.allocUnsafe(w.length):E=new Buffer(w.length),w.copy(E),E;n(w,Error)?E=Object.create(w):typeof p=="undefined"?($=Object.getPrototypeOf(w),E=Object.create($)):(E=Object.create(p),$=p)}if(h){var O=y.indexOf(w);if(O!=-1)return v[O];y.push(w),v.push(E)}n(w,i)&&w.forEach(function(P,B){var H=x(B,_-1),re=x(P,_-1);E.set(H,re)}),n(w,r)&&w.forEach(function(P){var B=x(P,_-1);E.add(B)});for(var C in w){var A;$&&(A=Object.getOwnPropertyDescriptor($,C)),!(A&&A.set==null)&&(E[C]=x(w[C],_-1))}if(Object.getOwnPropertySymbols)for(var D=Object.getOwnPropertySymbols(w),C=0;C<D.length;C++){var F=D[C],T=Object.getOwnPropertyDescriptor(w,F);T&&!T.enumerable&&!m||(E[F]=x(w[F],_-1),T.enumerable||Object.defineProperty(E,F,{enumerable:!1}))}if(m)for(var S=Object.getOwnPropertyNames(w),C=0;C<S.length;C++){var M=S[C],T=Object.getOwnPropertyDescriptor(w,M);T&&T.enumerable||(E[M]=x(w[M],_-1),Object.defineProperty(E,M,{enumerable:!1}))}return E}return x(d,g)}a.clonePrototype=function(h){if(h===null)return null;var g=function(){};return g.prototype=h,new g};function s(d){return Object.prototype.toString.call(d)}a.__objToStr=s;function u(d){return typeof d=="object"&&s(d)==="[object Date]"}a.__isDate=u;function l(d){return typeof d=="object"&&s(d)==="[object Array]"}a.__isArray=l;function c(d){return typeof d=="object"&&s(d)==="[object RegExp]"}a.__isRegExp=c;function f(d){var h="";return d.global&&(h+="g"),d.ignoreCase&&(h+="i"),d.multiline&&(h+="m"),h}return a.__getRegExpFlags=f,a}();e.exports&&(e.exports=t)})(e7);var Qge=e7.exports,epe=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var i,r,o;if(Array.isArray(t)){if(i=t.length,i!=n.length)return!1;for(r=i;r--!=0;)if(!e(t[r],n[r]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(o=Object.keys(t),i=o.length,i!==Object.keys(n).length)return!1;for(r=i;r--!=0;)if(!Object.prototype.hasOwnProperty.call(n,o[r]))return!1;for(r=i;r--!=0;){var a=o[r];if(!e(t[a],n[a]))return!1}return!0}return t!==t&&n!==n},BA=function(e,t){t||(t={}),typeof t=="function"&&(t={cmp:t});var n=typeof t.cycles=="boolean"?t.cycles:!1,i=t.cmp&&function(o){return function(a){return function(s,u){var l={key:s,value:a[s]},c={key:u,value:a[u]};return o(l,c)}}}(t.cmp),r=[];return function o(a){if(a&&a.toJSON&&typeof a.toJSON=="function"&&(a=a.toJSON()),a!==void 0){if(typeof a=="number")return isFinite(a)?""+a:"null";if(typeof a!="object")return JSON.stringify(a);var s,u;if(Array.isArray(a)){for(u="[",s=0;s<a.length;s++)s&&(u+=","),u+=o(a[s])||"null";return u+"]"}if(a===null)return"null";if(r.indexOf(a)!==-1){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var l=r.push(a)-1,c=Object.keys(a).sort(i&&i(a));for(u="",s=0;s<c.length;s++){var f=c[s],d=o(a[f]);!d||(u&&(u+=","),u+=JSON.stringify(f)+":"+d)}return r.splice(l,1),"{"+u+"}"}}(e)};function zA(e){return!!e.or}function UA(e){return!!e.and}function qA(e){return!!e.not}function Zm(e,t){if(qA(e))Zm(e.not,t);else if(UA(e))for(const n of e.and)Zm(n,t);else if(zA(e))for(const n of e.or)Zm(n,t);else t(e)}function Yl(e,t){return qA(e)?{not:Yl(e.not,t)}:UA(e)?{and:e.and.map(n=>Yl(n,t))}:zA(e)?{or:e.or.map(n=>Yl(n,t))}:t(e)}const Hr=epe,de=Qge;function Vl(e,t){const n={};for(const i of t)Gl(e,i)&&(n[i]=e[i]);return n}function pi(e,t){const n=Object.assign({},e);for(const i of t)delete n[i];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>BA(e)).join(",")})`};const Ke=BA;function _e(e){if(yt(e))return e;const t=fe(e)?e:BA(e);if(t.length<250)return t;let n=0;for(let i=0;i<t.length;i++){const r=t.charCodeAt(i);n=(n<<5)-n+r,n=n&n}return n}function HA(e){return e===!1||e===null}function ye(e,t){return e.includes(t)}function Xl(e,t){let n=0;for(const[i,r]of e.entries())if(t(r,i,n++))return!0;return!1}function WA(e,t){let n=0;for(const[i,r]of e.entries())if(!t(r,i,n++))return!1;return!0}function t7(e,...t){for(const n of t)tpe(e,n!=null?n:{});return e}function tpe(e,t){for(const n of z(t))IA(e,n,t[n],!0)}function Wr(e,t){const n=[],i={};let r;for(const o of e)r=t(o),!(r in i)&&(i[r]=1,n.push(o));return n}function npe(e,t){const n=z(e),i=z(t);if(n.length!==i.length)return!1;for(const r of n)if(e[r]!==t[r])return!1;return!0}function n7(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function GA(e,t){for(const n of e)if(t.has(n))return!0;return!1}function YA(e){const t=new Set;for(const n of e){const r=tu(n).map((a,s)=>s===0?a:`[${a}]`),o=r.map((a,s)=>r.slice(0,s+1).join(""));for(const a of o)t.add(a)}return t}function VA(e,t){return e===void 0||t===void 0?!0:GA(YA(e),YA(t))}function We(e){return z(e).length===0}const z=Object.keys,ln=Object.values,Da=Object.entries;function uh(e){return e===!0||e===!1}function nt(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function lh(e,t){return qA(e)?`!(${lh(e.not,t)})`:UA(e)?`(${e.and.map(n=>lh(n,t)).join(") && (")})`:zA(e)?`(${e.or.map(n=>lh(n,t)).join(") || (")})`:t(e)}function Qm(e,t){if(t.length===0)return!0;const n=t.shift();return n in e&&Qm(e[n],t)&&delete e[n],We(e)}function ch(e){return e.charAt(0).toUpperCase()+e.substr(1)}function XA(e,t="datum"){const n=tu(e),i=[];for(let r=1;r<=n.length;r++){const o=`[${n.slice(0,r).map(ke).join("][")}]`;i.push(`${t}${o}`)}return i.join(" && ")}function i7(e,t="datum"){return`${t}[${ke(tu(e).join("."))}]`}function ipe(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function Ti(e){return`${tu(e).map(ipe).join("\\.")}`}function iu(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function KA(e){return`${tu(e).join(".")}`}function Kl(e){return e?tu(e).length:0}function vt(...e){for(const t of e)if(t!==void 0)return t}let r7=42;function o7(e){const t=++r7;return e?String(e)+t:t}function rpe(){r7=42}function a7(e){return s7(e)?e:`__${e}`}function s7(e){return e.startsWith("__")}function fh(e){if(e!==void 0)return(e%360+360)%360}function e1(e){return yt(e)?!0:!isNaN(e)&&!isNaN(parseFloat(e))}var dh=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const To="row",No="column",t1="facet",at="x",$t="y",sr="x2",Gr="y2",Yr="radius",Ro="radius2",ur="theta",jo="theta2",Vr="latitude",Xr="longitude",lr="latitude2",Ni="longitude2",Xn="color",Kr="fill",Jr="stroke",Kn="shape",Lo="size",ru="angle",Po="opacity",Ma="fillOpacity",Ta="strokeOpacity",Na="strokeWidth",Ra="strokeDash",hh="text",gh="order",ph="detail",n1="key",ou="tooltip",i1="href",r1="url",o1="description",ope={x:1,y:1,x2:1,y2:1},u7={theta:1,theta2:1,radius:1,radius2:1};function l7(e){return e in u7}const JA={longitude:1,longitude2:1,latitude:1,latitude2:1};function ape(e){switch(e){case Vr:return"y";case lr:return"y2";case Xr:return"x";case Ni:return"x2"}}function spe(e){return e in JA}const upe=z(JA),c7=Object.assign(Object.assign(Object.assign(Object.assign({},ope),u7),JA),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function Jl(e){return e===Xn||e===Kr||e===Jr}const f7={row:1,column:1,facet:1},Ri=z(f7),ZA=Object.assign(Object.assign({},c7),f7),lpe=z(ZA),cpe=dh(ZA,["order","detail","tooltip"]),fpe=dh(cpe,["row","column","facet"]);function dpe(e){return!!fpe[e]}function d7(e){return!!ZA[e]}const hpe=[sr,Gr,lr,Ni,jo,Ro];function h7(e){return au(e)!==e}function au(e){switch(e){case sr:return at;case Gr:return $t;case lr:return Vr;case Ni:return Xr;case jo:return ur;case Ro:return Yr}return e}function ja(e){if(l7(e))switch(e){case ur:return"startAngle";case jo:return"endAngle";case Yr:return"outerRadius";case Ro:return"innerRadius"}return e}function Io(e){switch(e){case at:return sr;case $t:return Gr;case Vr:return lr;case Xr:return Ni;case ur:return jo;case Yr:return Ro}}function ji(e){switch(e){case at:case sr:return"width";case $t:case Gr:return"height"}}function gpe(e){switch(e){case at:return"xOffset";case $t:return"yOffset";case sr:return"x2Offset";case Gr:return"y2Offset";case ur:return"thetaOffset";case Yr:return"radiusOffset";case jo:return"theta2Offset";case Ro:return"radius2Offset"}}const QA=dh(c7,["x","y","x2","y2","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),ppe=z(QA),La={x:1,y:1},Zr=z(La);function Qr(e){return e in La}const e$={theta:1,radius:1},mpe=z(e$);function a1(e){return e==="width"?at:$t}const g7=dh(QA,["text","tooltip","href","url","description","detail","key","order"]),ype=z(g7);function vpe(e){return!!QA[e]}function bpe(e){switch(e){case Xn:case Kr:case Jr:case Lo:case Kn:case Po:case Na:case Ra:return!0;case Ma:case Ta:case ru:return!1}}const p7=Object.assign(Object.assign(Object.assign({},La),e$),g7),s1=z(p7);function Pa(e){return!!p7[e]}function xpe(e,t){return Epe(e)[t]}const m7={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},wpe=dh(m7,["geoshape"]);function Epe(e){switch(e){case Xn:case Kr:case Jr:case o1:case ph:case n1:case ou:case i1:case gh:case Po:case Ma:case Ta:case Na:case t1:case To:case No:return m7;case at:case $t:case Vr:case Xr:return wpe;case sr:case Gr:case lr:case Ni:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case Lo:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case Ra:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case Kn:return{point:"always",geoshape:"always"};case hh:return{text:"always"};case ru:return{point:"always",square:"always",text:"always"};case r1:return{image:"always"};case ur:return{text:"always",arc:"always"};case Yr:return{text:"always",arc:"always"};case jo:case Ro:return{arc:"always"}}}function t$(e){switch(e){case at:case $t:case ur:case Yr:case Lo:case ru:case Na:case Po:case Ma:case Ta:case sr:case Gr:case jo:case Ro:return;case t1:case To:case No:case Kn:case Ra:case hh:case ou:case i1:case r1:case o1:return"discrete";case Xn:case Kr:case Jr:return"flexible";case Vr:case Xr:case lr:case Ni:case ph:case n1:case gh:return}}const _pe={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},Ape={count:1,min:1,max:1};function Bo(e){return!!e&&!!e.argmin}function Ia(e){return!!e&&!!e.argmax}function n$(e){return fe(e)&&!!_pe[e]}const $pe=["count","valid","missing","distinct"];function y7(e){return fe(e)&&ye($pe,e)}function Spe(e){return fe(e)&&ye(["min","max"],e)}const Ope=["count","sum","distinct","valid","missing"],Cpe=["mean","average","median","q1","q3","min","max"],Fpe=nu(Cpe);function v7(e){return sh(e)&&(e=O1(e,void 0)),"bin"+z(e).map(t=>u1(e[t])?nt(`_${t}_${Da(e[t])}`):nt(`_${t}_${e[t]}`)).join("")}function Je(e){return e===!0||su(e)&&!e.binned}function kn(e){return e==="binned"||su(e)&&e.binned===!0}function su(e){return Ve(e)}function u1(e){return e==null?void 0:e.param}function b7(e){switch(e){case To:case No:case Lo:case Xn:case Kr:case Jr:case Na:case Po:case Ma:case Ta:case Kn:return 6;case Ra:return 4;default:return 10}}function mh(e){return e&&!!e.expr}function Jn(e){const t=z(e||{}),n={};for(const i of t)n[i]=mi(e[i]);return n}var kpe=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function x7(e){const{anchor:t,frame:n,offset:i,orient:r,angle:o,limit:a,color:s,subtitleColor:u,subtitleFont:l,subtitleFontSize:c,subtitleFontStyle:f,subtitleFontWeight:d,subtitleLineHeight:h,subtitlePadding:g}=e,p=kpe(e,["anchor","frame","offset","orient","angle","limit","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),m=Object.assign(Object.assign({},p),s?{fill:s}:{}),y=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},t?{anchor:t}:{}),n?{frame:n}:{}),i?{offset:i}:{}),r?{orient:r}:{}),o!==void 0?{angle:o}:{}),a!==void 0?{limit:a}:{}),v=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},u?{subtitleColor:u}:{}),l?{subtitleFont:l}:{}),c?{subtitleFontSize:c}:{}),f?{subtitleFontStyle:f}:{}),d?{subtitleFontWeight:d}:{}),h?{subtitleLineHeight:h}:{}),g?{subtitlePadding:g}:{}),b=Vl(e,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:m,subtitleMarkConfig:b,nonMarkTitleProperties:y,subtitle:v}}function Ba(e){return fe(e)||J(e)&&fe(e[0])}function ie(e){return e&&!!e.signal}function za(e){return!!e.step}function Dpe(e){return J(e)?!1:"fields"in e&&!("data"in e)}function Mpe(e){return J(e)?!1:"fields"in e&&"data"in e}function zo(e){return J(e)?!1:"field"in e&&"data"in e}const Tpe={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1},Npe=z(Tpe),Rpe={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},i$=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];var r$=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function w7(e){const t=J(e.condition)?e.condition.map(E7):E7(e.condition);return Object.assign(Object.assign({},mi(e)),{condition:t})}function mi(e){if(mh(e)){const{expr:t}=e,n=r$(e,["expr"]);return Object.assign({signal:t},n)}return e}function E7(e){if(mh(e)){const{expr:t}=e,n=r$(e,["expr"]);return Object.assign({signal:t},n)}return e}function it(e){if(mh(e)){const{expr:t}=e,n=r$(e,["expr"]);return Object.assign({signal:t},n)}return ie(e)?e:e!==void 0?{value:e}:void 0}function _7(e){return ie(e)?e.signal:ke(e.value)}function Uo(e){return ie(e)?e.signal:e==null?null:ke(e)}function jpe(e,t,n){for(const i of n){const r=uu(i,t.markDef,t.config);r!==void 0&&(e[i]=it(r))}return e}function A7(e){var t;return[].concat(e.type,(t=e.style)!==null&&t!==void 0?t:[])}function Be(e,t,n,i={}){const{vgChannel:r,ignoreVgConfig:o}=i;return r&&t[r]!==void 0?t[r]:t[e]!==void 0?t[e]:o&&(!r||r===e)?void 0:uu(e,t,n,i)}function uu(e,t,n,{vgChannel:i}={}){return vt(i?l1(e,t,n.style):void 0,l1(e,t,n.style),i?n[t.type][i]:void 0,n[t.type][e],i?n.mark[i]:n.mark[e])}function l1(e,t,n){return $7(e,A7(t),n)}function $7(e,t,n){t=ft(t);let i;for(const r of t){const o=n[r];o&&o[e]!==void 0&&(i=o[e])}return i}function S7(e,t){return ft(e).reduce((n,i)=>{var r;return n.field.push(G(i,t)),n.order.push((r=i.sort)!==null&&r!==void 0?r:"ascending"),n},{field:[],order:[]})}function O7(e,t){const n=[...e];return t.forEach(i=>{for(const r of n)if(Hr(r,i))return;n.push(i)}),n}function C7(e,t){return Hr(e,t)||!t?e:e?[...ft(e),...ft(t)].join(", "):t}function F7(e,t){const n=e.value,i=t.value;if(n==null||i===null)return{explicit:e.explicit,value:null};if((Ba(n)||ie(n))&&(Ba(i)||ie(i)))return{explicit:e.explicit,value:C7(n,i)};if(Ba(n)||ie(n))return{explicit:e.explicit,value:n};if(Ba(i)||ie(i))return{explicit:e.explicit,value:i};if(!Ba(n)&&!ie(n)&&!Ba(i)&&!ie(i))return{explicit:e.explicit,value:O7(n,i)};throw new Error("It should never reach here")}function o$(e){return`Invalid specification ${Ke(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const Lpe='Autosize "fit" only works for single views and layered views.';function k7(e){return`${e=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function D7(e){const t=e=="width"?"Width":"Height",n=e=="width"?"x":"y";return`${t} "container" only works well with autosize "fit" or "fit-${n}".`}function M7(e){return e?`Dropping "fit-${e}" because spec has discrete ${ji(e)}.`:'Dropping "fit" because spec has discrete size.'}function a$(e){return`Unknown field for ${e}. Cannot calculate view size.`}function T7(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function Ppe(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function Ipe(e){return`The "nearest" transform is not supported for ${e} marks.`}function N7(e){return`Selection not supported for ${e} yet.`}function Bpe(e){return`Cannot find a selection named "${e}".`}const zpe="Scale bindings are currently only supported for scales with unbinned, continuous domains.",Upe="Legend bindings are only supported for selections over an individual field or encoding channel.";function qpe(e){return`Lookups can only be performed on selection parameters. "${e}" is a variable parameter.`}function Hpe(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}const Wpe="The same selection must be used to override scale domains in a layered view.",Gpe='Interval selections should be initialized using "x" and/or "y" keys.';function Ype(e){return`Unknown repeated value "${e}".`}function R7(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const Vpe="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function Xpe(e){return`Unrecognized parse "${e}".`}function j7(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}const Kpe="Attempt to add the same child twice.";function Jpe(e){return`Ignoring an invalid transform: ${Ke(e)}.`}const Zpe='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function L7(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function Qpe(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${Ke(t)} is overridden by a child projection ${Ke(n)}.`}const eme="Arc marks uses theta channel rather than angle, replacing angle with theta.";function tme(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${Ke(n)}}.`}function P7(e){return`Invalid field type "${e}".`}function nme(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function ime(e){return`Invalid aggregation operator "${e}".`}function I7(e,t){const{fill:n,stroke:i}=t;return`Dropping color ${e} as the plot also has ${n&&i?"fill and stroke":n?"fill":"stroke"}.`}function rme(e){return`Position range does not support relative band size for ${e}.`}function s$(e,t){return`Dropping ${Ke(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}const ome="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function c1(e,t,n){return`${e} dropped as it is incompatible with "${t}"${n?` when ${n}`:""}.`}function ame(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function sme(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function ume(e){return`${e} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`}function lme(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function u$(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${t==="ordinal"?"order":"magnitude"}.`}function cme(e){return`The ${e} for range marks cannot be an expression`}function fme(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function dme(e,t){return`Specified orient "${e}" overridden with "${t}".`}function hme(e){return`Cannot use the scale property "${e}" with non-color channel.`}function gme(e){return`Cannot use the relative band size with ${e} scale.`}function pme(e){return`Using unaggregated domain with raw field has no effect (${Ke(e)}).`}function mme(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function yme(e){return`Unaggregated domain is currently unsupported for log scale (${Ke(e)}).`}function vme(e){return`Cannot apply size to non-oriented mark "${e}".`}function bme(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function xme(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function B7(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function z7(e){return`The step for "${e}" is dropped because the ${e==="width"?"x":"y"} is continuous.`}function wme(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${Ke(n)} and ${Ke(i)}). Using ${Ke(n)}.`}function Eme(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${Ke(n)} and ${Ke(i)}). Using the union of the two domains.`}function _me(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function Ame(e){return`Dropping sort property ${Ke(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const U7="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",$me="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",Sme="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",Ome="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.";function Cme(e){return`Cannot stack "${e}" if there is already "${e}2".`}function Fme(e){return`Cannot stack non-linear scale (${e}).`}function kme(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function f1(e,t){return`Invalid ${e}: ${Ke(t)}.`}function Dme(e){return`Dropping day from datetime ${Ke(e)} as day cannot be combined with other units.`}function Mme(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function Tme(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function Nme(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function q7(e){return`1D error band does not support ${e}.`}function H7(e){return`Channel ${e} is required for "binned" bin.`}function Rme(e){return`Channel ${e} should not be used with "binned" bin.`}function jme(e){return`Domain for ${e} is required for threshold scale.`}const W7=Xge(J9);let Zl=W7;function Lme(e){return Zl=e,Zl}function Pme(){return Zl=W7,Zl}function U(...e){Zl.warn(...e)}function Ime(...e){Zl.debug(...e)}function lu(e){if(e&&Ve(e)){for(const t of c$)if(t in e)return!0}return!1}const G7=["january","february","march","april","may","june","july","august","september","october","november","december"],Bme=G7.map(e=>e.substr(0,3)),Y7=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],zme=Y7.map(e=>e.substr(0,3));function Ume(e){if(e1(e)&&(e=+e),yt(e))return e>4&&U(f1("quarter",e)),e-1;throw new Error(f1("quarter",e))}function qme(e){if(e1(e)&&(e=+e),yt(e))return e-1;{const t=e.toLowerCase(),n=G7.indexOf(t);if(n!==-1)return n;const i=t.substr(0,3),r=Bme.indexOf(i);if(r!==-1)return r;throw new Error(f1("month",e))}}function Hme(e){if(e1(e)&&(e=+e),yt(e))return e%7;{const t=e.toLowerCase(),n=Y7.indexOf(t);if(n!==-1)return n;const i=t.substr(0,3),r=zme.indexOf(i);if(r!==-1)return r;throw new Error(f1("day",e))}}function l$(e,t){const n=[];if(t&&e.day!==void 0&&z(e).length>1&&(U(Dme(e)),e=de(e),delete e.day),e.year!==void 0?n.push(e.year):n.push(2012),e.month!==void 0){const i=t?qme(e.month):e.month;n.push(i)}else if(e.quarter!==void 0){const i=t?Ume(e.quarter):e.quarter;n.push(yt(i)?i*3:`${i}*3`)}else n.push(0);if(e.date!==void 0)n.push(e.date);else if(e.day!==void 0){const i=t?Hme(e.day):e.day;n.push(yt(i)?i+1:`${i}+1`)}else n.push(1);for(const i of["hours","minutes","seconds","milliseconds"]){const r=e[i];n.push(typeof r=="undefined"?0:r)}return n}function yh(e){const n=l$(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function Wme(e){const n=l$(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function Gme(e){const t=l$(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}var Yme=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const V7={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},c$=z(V7);function Vme(e){return!!V7[e]}function f$(e){return e.startsWith("utc")}function Xme(e){return e.substr(3)}const Kme={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function d$(e){return c$.filter(t=>X7(e,t))}function X7(e,t){const n=e.indexOf(t);return!(n<0||n>0&&t==="seconds"&&e.charAt(n-1)==="i"||e.length>n+3&&t==="day"&&e.charAt(n+3)==="o"||n>0&&t==="year"&&e.charAt(n-1)==="f")}function Jme(e,t,{end:n}={end:!1}){const i=XA(t),r=f$(e)?"utc":"";function o(u){return u==="quarter"?`(${r}quarter(${i})-1)`:`${r}${u}(${i})`}let a;const s={};for(const u of c$)X7(e,u)&&(s[u]=o(u),a=u);return n&&(s[a]+="+1"),Wme(s)}function K7(e){if(!e)return;const t=d$(e);return`timeUnitSpecifier(${Ke(t)}, ${Ke(Kme)})`}function Zme(e,t,n){if(!e)return;const i=K7(e);return`${n||f$(e)?"utc":"time"}Format(${t}, ${i})`}function Dn(e){if(!e)return;let t;return fe(e)?t={unit:e}:Ve(e)&&(t=Object.assign(Object.assign({},e),e.unit?{unit:e.unit}:{})),f$(t.unit)&&(t.utc=!0,t.unit=Xme(t.unit)),t}function Qme(e){const t=Dn(e),{utc:n}=t,i=Yme(t,["utc"]);return i.unit?(n?"utc":"")+z(i).map(r=>nt(`${r==="unit"?"":`_${r}_`}${i[r]}`)).join(""):(n?"utc":"")+"timeunit"+z(i).map(r=>nt(`_${r}_${i[r]}`)).join("")}function e1e(e){return e==null?void 0:e.param}function h$(e){return e&&!!e.field&&e.equal!==void 0}function g$(e){return e&&!!e.field&&e.lt!==void 0}function p$(e){return e&&!!e.field&&e.lte!==void 0}function m$(e){return e&&!!e.field&&e.gt!==void 0}function y$(e){return e&&!!e.field&&e.gte!==void 0}function v$(e){if(e==null?void 0:e.field){if(J(e.range)&&e.range.length===2)return!0;if(ie(e.range))return!0}return!1}function b$(e){return e&&!!e.field&&(J(e.oneOf)||J(e.in))}function t1e(e){return e&&!!e.field&&e.valid!==void 0}function J7(e){return b$(e)||h$(e)||v$(e)||g$(e)||m$(e)||p$(e)||y$(e)}function eo(e,t){return C1(e,{timeUnit:t,wrapTime:!0})}function n1e(e,t){return e.map(n=>eo(n,t))}function Z7(e,t=!0){var n;const{field:i}=e,r=(n=Dn(e.timeUnit))===null||n===void 0?void 0:n.unit,o=r?`time(${Jme(r,i)})`:G(e,{expr:"datum"});if(h$(e))return`${o}===${eo(e.equal,r)}`;if(g$(e)){const a=e.lt;return`${o}<${eo(a,r)}`}else if(m$(e)){const a=e.gt;return`${o}>${eo(a,r)}`}else if(p$(e)){const a=e.lte;return`${o}<=${eo(a,r)}`}else if(y$(e)){const a=e.gte;return`${o}>=${eo(a,r)}`}else{if(b$(e))return`indexof([${n1e(e.oneOf,r).join(",")}], ${o}) !== -1`;if(t1e(e))return x$(o,e.valid);if(v$(e)){const{range:a}=e,s=ie(a)?{signal:`${a.signal}[0]`}:a[0],u=ie(a)?{signal:`${a.signal}[1]`}:a[1];if(s!==null&&u!==null&&t)return"inrange("+o+", ["+eo(s,r)+", "+eo(u,r)+"])";const l=[];return s!==null&&l.push(`${o} >= ${eo(s,r)}`),u!==null&&l.push(`${o} <= ${eo(u,r)}`),l.length>0?l.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${Ke(e)}`)}function x$(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function i1e(e){var t;return J7(e)&&e.timeUnit?Object.assign(Object.assign({},e),{timeUnit:(t=Dn(e.timeUnit))===null||t===void 0?void 0:t.unit}):e}const vh={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"},cu=vh.quantitative,w$=vh.ordinal,Ql=vh.temporal,E$=vh.nominal,ec=vh.geojson;function r1e(e){if(e)switch(e=e.toLowerCase(),e){case"q":case cu:return"quantitative";case"t":case Ql:return"temporal";case"o":case w$:return"ordinal";case"n":case E$:return"nominal";case ec:return"geojson"}}var o1e=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const St={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},_$={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};function a1e(e,t){const n=_$[e],i=_$[t];return n===i||n==="ordinal-position"&&i==="time"||i==="ordinal-position"&&n==="time"}const s1e={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function Q7(e){return s1e[e]}const ej=["linear","log","pow","sqrt","symlog","time","utc"],u1e=nu(ej),l1e=["linear","log","pow","sqrt","symlog"],c1e=nu(l1e);function f1e(e){return e in c1e}const d1e=["quantile","quantize","threshold"],h1e=nu(d1e),g1e=ej.concat(["quantile","quantize","threshold","sequential","identity"]),p1e=nu(g1e),m1e=["ordinal","bin-ordinal","point","band"],y1e=nu(m1e);function cn(e){return e in y1e}function yi(e){return e in p1e}function cr(e){return e in u1e}function bh(e){return e in h1e}const v1e={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4};function b1e(e){return!fe(e)&&!!e.name}function tj(e){return e==null?void 0:e.param}function x1e(e){return e&&e.unionWith}function w1e(e){return se(e)&&"field"in e}const E1e={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},_1e=o1e(E1e,["type","domain","range","rangeMax","rangeMin","scheme"]),A1e=z(_1e);function A$(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(e);case"bins":return!["point","band","identity","ordinal"].includes(e);case"round":return cr(e)||e==="band"||e==="point";case"padding":case"rangeMin":case"rangeMax":return cr(e)||["point","band"].includes(e);case"paddingOuter":case"align":return["point","band"].includes(e);case"paddingInner":return e==="band";case"domainMax":case"domainMid":case"domainMin":case"clamp":return cr(e);case"nice":return cr(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return yi(e)&&!ye(["log","time","utc","threshold","quantile"],e)}}function nj(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return Jl(e)?void 0:hme(e);case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}function $1e(e,t){return ye([w$,E$],t)?e===void 0||cn(e):t===Ql?ye([St.TIME,St.UTC,void 0],e):t===cu?ye([St.LOG,St.POW,St.SQRT,St.SYMLOG,St.QUANTILE,St.QUANTIZE,St.THRESHOLD,St.LINEAR,void 0],e):!0}function S1e(e,t){if(!Pa(e))return!1;switch(e){case at:case $t:case ur:case Yr:return cr(t)||ye(["band","point"],t);case Lo:case Na:case Po:case Ma:case Ta:case ru:return cr(t)||bh(t)||ye(["band","point","ordinal"],t);case Xn:case Kr:case Jr:return t!=="band";case Ra:case Kn:return t==="ordinal"||bh(t)}}const Mn={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},ij=Mn.arc,d1=Mn.area,h1=Mn.bar,O1e=Mn.image,g1=Mn.line,p1=Mn.point,C1e=Mn.rect,m1=Mn.rule,rj=Mn.text,$$=Mn.tick,F1e=Mn.trail,S$=Mn.circle,O$=Mn.square,oj=Mn.geoshape;function Ua(e){return["line","area","trail"].includes(e)}function aj(e){return["rect","bar","image","arc"].includes(e)}const sj=z(Mn);function to(e){return e.type}nu(sj);const k1e=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],D1e=["fill","fillOpacity"],M1e=[...k1e,...D1e],T1e={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1},uj=z(T1e),N1e={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]},R1e={color:"#4c78a8",invalid:"filter",timeUnitBandSize:1},j1e={mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1},lj=z(j1e);function tc(e){return e&&e.band!=null}const L1e={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},cj=5,P1e={binSpacing:1,continuousBandSize:cj,timeUnitBandPosition:.5},I1e={binSpacing:0,continuousBandSize:cj,timeUnitBandPosition:.5},B1e={thickness:1};function z1e(e){return to(e)?e.type:e}function C$(e){const{channel:t,channelDef:n,markDef:i,scale:r,config:o}=e,a=dj(e);return Y(n)&&!y7(n.aggregate)&&r&&cr(r.get("type"))&&r.get("zero")===!1?fj({fieldDef:n,channel:t,markDef:i,ref:a,config:o}):a}function fj({fieldDef:e,channel:t,markDef:n,ref:i,config:r}){return Ua(n.type)||Be("invalid",n,r)===null?i:[U1e(e,t),i]}function U1e(e,t){const n=F$(e,!0),r=au(t)==="y"?{field:{group:"height"}}:{value:0};return Object.assign({test:n},r)}function F$(e,t=!0){return x$(fe(e)?e:G(e,{expr:"datum"}),!t)}function q1e(e){const{datum:t}=e;return lu(t)?yh(t):`${Ke(t)}`}function fu(e,t,n,i){const r={};if(t&&(r.scale=t),qa(e)){const{datum:o}=e;lu(o)?r.signal=yh(o):ie(o)?r.signal=o.signal:mh(o)?r.signal=o.expr:r.value=o}else r.field=G(e,n);if(i){const{offset:o,band:a}=i;o&&(r.offset=o),a&&(r.band=a)}return r}function y1({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:i,startSuffix:r,bandPosition:o=.5}){const a=0<o&&o<1?"datum":void 0,s=G(t,{expr:a,suffix:r}),u=n!==void 0?G(n,{expr:a}):G(t,{suffix:"end",expr:a}),l={};if(o===0||o===1){l.scale=e;const c=o===0?s:u;l.field=c}else{const c=ie(o)?`${o.signal} * ${s} + (1-${o.signal}) * ${u}`:`${o} * ${s} + ${1-o} * ${u}`;l.signal=`scale("${e}", ${c})`}return i&&(l.offset=i),l}function dj({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:o,scale:a,stack:s,offset:u,defaultRef:l,bandPosition:c}){var f;if(t){if(ue(t)){if(Li(t)){c!=null||(c=Aj({fieldDef:t,fieldDef2:n,markDef:i,config:r}));const{bin:h,timeUnit:g,type:p}=t;if(Je(h)||c&&g&&p===Ql)return(s==null?void 0:s.impute)?fu(t,o,{binSuffix:"mid"},{offset:u}):c?y1({scaleName:o,fieldOrDatumDef:t,bandPosition:c,offset:u}):fu(t,o,Eh(t,e)?{binSuffix:"range"}:{},{offset:u});if(kn(h)){if(Y(n))return y1({scaleName:o,fieldOrDatumDef:t,fieldOrDatumDef2:n,bandPosition:c,offset:u});U(H7(e===at?sr:Gr))}}const d=a==null?void 0:a.get("type");return fu(t,o,cn(d)?{binSuffix:"range"}:{},{offset:u,band:d==="band"?(f=c!=null?c:t.bandPosition)!==null&&f!==void 0?f:.5:void 0})}else if(fr(t)){const d=t.value,h=u?{offset:u}:{};return Object.assign(Object.assign({},xh(e,d)),h)}}return Jge(l)&&(l=l()),l&&Object.assign(Object.assign({},l),u?{offset:u}:{})}function xh(e,t){return ye(["x","x2"],e)&&t==="width"?{field:{group:"width"}}:ye(["y","y2"],e)&&t==="height"?{field:{group:"height"}}:it(t)}function du(e){return e&&e!=="number"&&e!=="time"}function hj(e,t,n){return`${e}(${t}${n?`, ${Ke(n)}`:""})`}const H1e=" \u2013 ";function k$({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:o}){var a,s;if(du(n))return D$({fieldOrDatumDef:e,format:t,formatType:n,expr:i,config:o});const u=gj(e,i,r);if(rc(e)){const l=G1e(u,Y(e)?(a=Dn(e.timeUnit))===null||a===void 0?void 0:a.unit:void 0,t,o.timeFormat,hu(e)&&((s=e.scale)===null||s===void 0?void 0:s.type)===St.UTC);return l?{signal:l}:void 0}if(t=yj(R$(e),t,o),Y(e)&&Je(e.bin)){const l=G(e,{expr:i,binSuffix:"end"});return{signal:v1(u,l,t,n,o)}}else return t||R$(e)==="quantitative"?{signal:`${vj(u,t)}`}:{signal:`isValid(${u}) ? ${u} : ""+${u}`}}function gj(e,t,n){return Y(e)?n?`${G(e,{expr:t,suffix:"end"})}-${G(e,{expr:t,suffix:"start"})}`:G(e,{expr:t}):q1e(e)}function D$({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:o,field:a}){if(a!=null||(a=gj(e,i,r)),Y(e)&&Je(e.bin)){const s=G(e,{expr:i,binSuffix:"end"});return{signal:v1(a,s,t,n,o)}}return{signal:hj(n,a,t)}}function pj(e,t,n,i,r,o){var a;if(!du(i)){if(rc(e)){const s=Y(e)?(a=Dn(e.timeUnit))===null||a===void 0?void 0:a.unit:void 0;return W1e(n,s,r,o)}return yj(t,n,r)}}function mj(e,t,n){if(e&&(ie(e)||e==="number"||e==="time"))return e;if(rc(t)&&n!=="time"&&n!=="utc")return"time"}function yj(e,t,n){if(fe(t))return t;if(e===cu)return n.numberFormat}function W1e(e,t,n,i){return e||(t?{signal:K7(t)}:i?void 0:n.timeFormat)}function vj(e,t){return`format(${e}, "${t||""}")`}function bj(e,t,n,i){var r;return du(n)?hj(n,e,t):vj(e,(r=fe(t)?t:void 0)!==null&&r!==void 0?r:i.numberFormat)}function v1(e,t,n,i,r){const o=bj(e,n,i,r),a=bj(t,n,i,r);return`${x$(e,!1)} ? "null" : ${o} + "${H1e}" + ${a}`}function G1e(e,t,n,i,r){return!t||n?(n=fe(n)?n:i,`${r?"utc":"time"}Format(${e}, '${n}')`):Zme(t,e,r)}const b1="min",Y1e={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function xj(e){return e in Y1e}function wj(e){return!!e&&!!e.encoding}function no(e){return!!e&&(e.op==="count"||!!e.field)}function Ej(e){return!!e&&J(e)}function wh(e){return"row"in e||"column"in e}function M$(e){return!!e&&"header"in e}function x1(e){return"facet"in e}var T$=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function V1e(e){return e.param}function X1e(e){return e&&!fe(e)&&"repeat"in e}function _j(e){const{field:t,timeUnit:n,bin:i,aggregate:r}=e;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),i?{bin:i}:{}),r?{aggregate:r}:{}),{field:t})}function N$(e){return"sort"in e}function Aj({fieldDef:e,fieldDef2:t,markDef:n,config:i}){if(ue(e)&&e.bandPosition!==void 0)return e.bandPosition;if(Y(e)){const{timeUnit:r,bin:o}=e;if(r&&!t)return aj(n.type)?0:uu("timeUnitBandPosition",n,i);if(Je(o))return .5}}function $j({channel:e,fieldDef:t,fieldDef2:n,markDef:i,config:r,scaleType:o,useVlSizeChannel:a}){var s,u,l;const c=ji(e),f=Be(a?"size":c,i,r,{vgChannel:c});if(f!==void 0)return f;if(Y(t)){const{timeUnit:d,bin:h}=t;if(d&&!n)return{band:uu("timeUnitBandSize",i,r)};if(Je(h)&&!cn(o))return{band:1}}if(aj(i.type))return o?cn(o)?((s=r[i.type])===null||s===void 0?void 0:s.discreteBandSize)||{band:1}:(u=r[i.type])===null||u===void 0?void 0:u.continuousBandSize:(l=r[i.type])===null||l===void 0?void 0:l.discreteBandSize}function Sj(e,t,n,i){return Je(e.bin)||e.timeUnit&&Li(e)&&e.type==="temporal"?Aj({fieldDef:e,fieldDef2:t,markDef:n,config:i})!==void 0:!1}function w1(e){return e&&"condition"in e}function E1(e){const t=e&&e.condition;return!!t&&!J(t)&&Y(t)}function _1(e){const t=e&&e.condition;return!!t&&!J(t)&&ue(t)}function K1e(e){const t=e&&e.condition;return!!t&&(J(t)||fr(t))}function Y(e){return e&&(!!e.field||e.aggregate==="count")}function R$(e){return e&&e.type}function qa(e){return e&&"datum"in e}function io(e){return Li(e)&&!A1(e)||j$(e)}function j$(e){return qa(e)&&yt(e.datum)}function ue(e){return Y(e)||qa(e)}function Li(e){return e&&("field"in e||e.aggregate==="count")&&"type"in e}function fr(e){return e&&"value"in e&&"value"in e}function hu(e){return e&&("scale"in e||"sort"in e)}function L$(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function Oj(e){return e&&"legend"in e}function Cj(e){return e&&("format"in e||"formatType"in e)}function J1e(e){return pi(e,["legend","axis","header","scale"])}function Z1e(e){return"op"in e}function G(e,t={}){var n,i,r;let o=e.field;const a=t.prefix;let s=t.suffix,u="";if(eye(e))o=a7("count");else{let l;if(!t.nofn)if(Z1e(e))l=e.op;else{const{bin:c,aggregate:f,timeUnit:d}=e;Je(c)?(l=v7(c),s=((n=t.binSuffix)!==null&&n!==void 0?n:"")+((i=t.suffix)!==null&&i!==void 0?i:"")):f?Ia(f)?(u=`["${o}"]`,o=`argmax_${f.argmax}`):Bo(f)?(u=`["${o}"]`,o=`argmin_${f.argmin}`):l=String(f):d&&(l=Qme(d),s=(!["range","mid"].includes(t.binSuffix)&&t.binSuffix||"")+((r=t.suffix)!==null&&r!==void 0?r:""))}l&&(o=o?`${l}_${o}`:l)}return s&&(o=`${o}_${s}`),a&&(o=`${a}_${o}`),t.forAs?KA(o):t.expr?i7(o,t.expr)+u:Ti(o)+u}function A1(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return Y(e)&&!!e.bin;case"temporal":return!1}throw new Error(P7(e.type))}function Q1e(e){var t;return hu(e)&&bh((t=e.scale)===null||t===void 0?void 0:t.type)}function eye(e){return e.aggregate==="count"}function tye(e,t){var n;const{field:i,bin:r,timeUnit:o,aggregate:a}=e;if(a==="count")return t.countTitle;if(Je(r))return`${i} (binned)`;if(o){const s=(n=Dn(o))===null||n===void 0?void 0:n.unit;if(s)return`${i} (${d$(s).join("-")})`}else if(a)return Ia(a)?`${i} for max ${a.argmax}`:Bo(a)?`${i} for min ${a.argmin}`:`${ch(a)} of ${i}`;return i}function nye(e){const{aggregate:t,bin:n,timeUnit:i,field:r}=e;if(Ia(t))return`${r} for argmax(${t.argmax})`;if(Bo(t))return`${r} for argmin(${t.argmin})`;const o=Dn(i),a=t||(o==null?void 0:o.unit)||(o==null?void 0:o.maxbins)&&"timeunit"||Je(n)&&"bin";return a?`${a.toUpperCase()}(${r})`:r}const Fj=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return nye(e);default:return tye(e,t)}};let kj=Fj;function Dj(e){kj=e}function iye(){Dj(Fj)}function nc(e,t,{allowDisabling:n,includeDefault:i=!0}){var r,o;const a=(r=P$(e))===null||r===void 0?void 0:r.title;if(!Y(e))return a;const s=e,u=i?I$(s,t):void 0;return n?vt(a,s.title,u):(o=a!=null?a:s.title)!==null&&o!==void 0?o:u}function P$(e){if(L$(e)&&e.axis)return e.axis;if(Oj(e)&&e.legend)return e.legend;if(M$(e)&&e.header)return e.header}function I$(e,t){return kj(e,t)}function $1(e){var t;if(Cj(e)){const{format:n,formatType:i}=e;return{format:n,formatType:i}}else{const n=(t=P$(e))!==null&&t!==void 0?t:{},{format:i,formatType:r}=n;return{format:i,formatType:r}}}function rye(e,t){var n;switch(t){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(N$(e)&&J(e.sort))return"ordinal";const{aggregate:i,bin:r,timeUnit:o}=e;if(o)return"temporal";if(r||i&&!Ia(i)&&!Bo(i))return"quantitative";if(hu(e)&&((n=e.scale)===null||n===void 0?void 0:n.type))switch(_$[e.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}function ro(e){if(Y(e))return e;if(E1(e))return e.condition}function Ot(e){if(ue(e))return e;if(_1(e))return e.condition}function Mj(e,t,n,i={}){if(fe(e)||yt(e)||sh(e)){const r=fe(e)?"string":yt(e)?"number":"boolean";return U(tme(t,r,e)),{value:e}}return ue(e)?S1(e,t,n,i):_1(e)?Object.assign(Object.assign({},e),{condition:S1(e.condition,t,n,i)}):e}function S1(e,t,n,i){if(Cj(e)){const{format:r,formatType:o}=e,a=T$(e,["format","formatType"]);if(du(o)&&!n.customFormatTypes)return U(L7(t)),S1(a,t,n,i)}else{const r=L$(e)?"axis":Oj(e)?"legend":M$(e)?"header":null;if(r&&e[r]){const o=e[r],{format:a,formatType:s}=o,u=T$(o,["format","formatType"]);if(du(s)&&!n.customFormatTypes)return U(L7(t)),S1(Object.assign(Object.assign({},e),{[r]:u}),t,n,i)}}return Y(e)?B$(e,t,i):oye(e)}function oye(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=yt(n)?"quantitative":fe(n)?"nominal":lu(n)?"temporal":void 0,Object.assign(Object.assign({},e),{type:t})}function B$(e,t,{compositeMark:n=!1}={}){const{aggregate:i,timeUnit:r,bin:o,field:a}=e,s=Object.assign({},e);if(!n&&i&&!n$(i)&&!Ia(i)&&!Bo(i)&&(U(ime(i)),delete s.aggregate),r&&(s.timeUnit=Dn(r)),a&&(s.field=`${a}`),Je(o)&&(s.bin=O1(o,t)),kn(o)&&!Qr(t)&&U(Rme(t)),Li(s)){const{type:u}=s,l=r1e(u);u!==l&&(s.type=l),u!=="quantitative"&&y7(i)&&(U(nme(u,i)),s.type="quantitative")}else if(!h7(t)){const u=rye(s,t);s.type=u}if(Li(s)){const{compatible:u,warning:l}=aye(s,t)||{};u===!1&&U(l)}if(N$(s)&&fe(s.sort)){const{sort:u}=s;if(xj(u))return Object.assign(Object.assign({},s),{sort:{encoding:u}});const l=u.substr(1);if(u.charAt(0)==="-"&&xj(l))return Object.assign(Object.assign({},s),{sort:{encoding:l,order:"descending"}})}if(M$(s)){const{header:u}=s;if(u){const{orient:l}=u,c=T$(u,["orient"]);if(l)return Object.assign(Object.assign({},s),{header:Object.assign(Object.assign({},c),{labelOrient:u.labelOrient||l,titleOrient:u.titleOrient||l})})}}return s}function O1(e,t){return sh(e)?{maxbins:b7(t)}:e==="binned"?{binned:!0}:!e.maxbins&&!e.step?Object.assign(Object.assign({},e),{maxbins:b7(t)}):e}const ic={compatible:!0};function aye(e,t){const n=e.type;if(n==="geojson"&&t!=="shape")return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case To:case No:case t1:return A1(e)?ic:{compatible:!1,warning:sme(t)};case at:case $t:case Xn:case Kr:case Jr:case hh:case ph:case n1:case ou:case i1:case r1:case ru:case ur:case Yr:case o1:return ic;case Xr:case Ni:case Vr:case lr:return n!==cu?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:ic;case Po:case Ma:case Ta:case Na:case Lo:case jo:case Ro:case sr:case Gr:return n==="nominal"&&!e.sort?{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`}:ic;case Kn:case Ra:return!A1(e)&&!Q1e(e)?{compatible:!1,warning:ume(t)}:ic;case gh:return e.type==="nominal"&&!("sort"in e)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:ic}}function rc(e){const{formatType:t}=$1(e);return t==="time"||!t&&sye(e)}function sye(e){return e&&(e.type==="temporal"||Y(e)&&!!e.timeUnit)}function C1(e,{timeUnit:t,type:n,wrapTime:i,undefinedIfExprNotRequired:r}){var o;const a=t&&((o=Dn(t))===null||o===void 0?void 0:o.unit);let s=a||n==="temporal",u;return mh(e)?u=e.expr:ie(e)?u=e.signal:lu(e)?(s=!0,u=yh(e)):(fe(e)||yt(e))&&s&&(u=`datetime(${Ke(e)})`,Vme(a)&&(yt(e)&&e<1e4||fe(e)&&isNaN(Date.parse(e)))&&(u=yh({[a]:e}))),u?i&&s?`time(${u})`:u:r?void 0:Ke(e)}function Tj(e,t){const{type:n}=e;return t.map(i=>{const r=C1(i,{timeUnit:Y(e)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return r!==void 0?{signal:r}:i})}function Eh(e,t){return Je(e.bin)?Pa(t)&&["ordinal","nominal"].includes(e.type):(console.warn("Only call this method for binned field defs."),!1)}const Nj={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function _h(e){return e&&e.condition}const Rj=["domain","grid","labels","ticks","title"],uye={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},jj={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},lye=Object.assign(Object.assign({},jj),{style:1,labelExpr:1,encoding:1});function Lj(e){return!!lye[e]}const cye={axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1},Pj=z(cye);function qo(e){return"mark"in e}class F1{constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return qo(t)?z1e(t.mark)===this.name:!1}}var fye=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function gu(e,t){const n=e&&e[t];return n?J(n)?Xl(n,i=>!!i.field):Y(n)||E1(n):!1}function z$(e){return Xl(lpe,t=>{if(gu(e,t)){const n=e[t];if(J(n))return Xl(n,i=>!!i.aggregate);{const i=ro(n);return i&&!!i.aggregate}}return!1})}function Ij(e,t){const n=[],i=[],r=[],o=[],a={};return U$(e,(s,u)=>{if(Y(s)){const{field:l,aggregate:c,bin:f,timeUnit:d}=s,h=fye(s,["field","aggregate","bin","timeUnit"]);if(c||d||f){const g=P$(s),p=g==null?void 0:g.title;let m=G(s,{forAs:!0});const y=Object.assign(Object.assign(Object.assign({},p?[]:{title:nc(s,t,{allowDisabling:!0})}),h),{field:m});if(c){let v;if(Ia(c)?(v="argmax",m=G({op:"argmax",field:c.argmax},{forAs:!0}),y.field=`${m}.${l}`):Bo(c)?(v="argmin",m=G({op:"argmin",field:c.argmin},{forAs:!0}),y.field=`${m}.${l}`):c!=="boxplot"&&c!=="errorbar"&&c!=="errorband"&&(v=c),v){const b={op:v,as:m};l&&(b.field=l),o.push(b)}}else if(n.push(m),Li(s)&&Je(f)){if(i.push({bin:f,field:l,as:m}),n.push(G(s,{binSuffix:"end"})),Eh(s,u)&&n.push(G(s,{binSuffix:"range"})),Qr(u)){const v={field:`${m}_end`};a[`${u}2`]=v}y.bin="binned",h7(u)||(y.type=cu)}else if(d){r.push({timeUnit:d,field:l,as:m});const v=Li(s)&&s.type!==Ql&&"time";v&&(u===hh||u===ou?y.formatType=v:vpe(u)?y.legend=Object.assign({formatType:v},y.legend):Qr(u)&&(y.axis=Object.assign({formatType:v},y.axis)))}a[u]=y}else n.push(l),a[u]=e[u]}else a[u]=e[u]}),{bins:i,timeUnits:r,aggregate:o,groupby:n,encoding:a}}function dye(e,t,n){const i=xpe(t,n);if(i){if(i==="binned"){const r=e[t===sr?at:$t];return!!(Y(r)&&Y(e[t])&&kn(r.bin))}}else return!1;return!0}function hye(e,t,n,i){return z(e).reduce((r,o)=>{if(!d7(o))return U(ame(o)),r;const a=e[o];if(o==="angle"&&t==="arc"&&!e.theta&&(U(eme),o=ur),!dye(e,o,t))return U(c1(o,t)),r;if(o===Lo&&t==="line"){const s=ro(e[o]);if(s==null?void 0:s.aggregate)return U(ome),r}if(o===Xn&&(n?"fill"in e:"stroke"in e))return U(I7("encoding",{fill:"fill"in e,stroke:"stroke"in e})),r;if(o===ph||o===gh&&!J(a)&&!fr(a)||o===ou&&J(a))a&&(r[o]=ft(a).reduce((s,u)=>(Y(u)?s.push(B$(u,o)):U(s$(u,o)),s),[]));else{if(o===ou&&a===null)r[o]=null;else if(!Y(a)&&!qa(a)&&!fr(a)&&!w1(a)&&!ie(a))return U(s$(a,o)),r;r[o]=Mj(a,o,i)}return r},{})}function k1(e,t){const n={};for(const i of z(e)){const r=Mj(e[i],i,t,{compositeMark:!0});n[i]=r}return n}function gye(e){const t=[];for(const n of z(e))if(gu(e,n)){const i=e[n],r=ft(i);for(const o of r)Y(o)?t.push(o):E1(o)&&t.push(o.condition)}return t}function U$(e,t,n){if(!!e)for(const i of z(e)){const r=e[i];if(J(r))for(const o of r)t.call(n,o,i);else t.call(n,r,i)}}function pye(e,t,n,i){return e?z(e).reduce((r,o)=>{const a=e[o];return J(a)?a.reduce((s,u)=>t.call(i,s,u,o),r):t.call(i,r,a,o)},n):n}function Bj(e,t){return z(t).reduce((n,i)=>{switch(i){case at:case $t:case i1:case o1:case r1:case sr:case Gr:case ur:case jo:case Yr:case Ro:case Vr:case Xr:case lr:case Ni:case hh:case Kn:case ru:case ou:return n;case gh:if(e==="line"||e==="trail")return n;case ph:case n1:{const r=t[i];if(J(r)||Y(r))for(const o of ft(r))o.aggregate||n.push(G(o,{}));return n}case Lo:if(e==="trail")return n;case Xn:case Kr:case Jr:case Po:case Ma:case Ta:case Ra:case Na:{const r=ro(t[i]);return r&&!r.aggregate&&n.push(G(r,{})),n}}},[])}var zj=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function mye(e){const{tooltip:t}=e,n=zj(e,["tooltip"]);if(!t)return{filteredEncoding:n};let i,r;if(J(t)){for(const o of t)o.aggregate?(i||(i=[]),i.push(o)):(r||(r=[]),r.push(o));i&&(n.tooltip=i)}else t.aggregate?n.tooltip=t:r=t;return J(r)&&r.length===1&&(r=r[0]),{customTooltipWithoutAggregatedField:r,filteredEncoding:n}}function q$(e,t,n,i=!0){if("tooltip"in n)return{tooltip:n.tooltip};const r=e.map(({fieldPrefix:a,titlePrefix:s})=>{const u=i?` of ${H$(t)}`:"";return{field:a+t.field,type:t.type,title:ie(s)?{signal:`${s}"${escape(u)}"`}:s+u}}),o=gye(n).map(J1e);return{tooltip:[...r,...Wr(o,_e)]}}function H$(e){const{title:t,field:n}=e;return vt(t,n)}function W$(e,t,n,i,r){const{scale:o,axis:a}=n;return({partName:s,mark:u,positionPrefix:l,endPositionPrefix:c=void 0,extraEncoding:f={}})=>{const d=H$(n);return Uj(e,s,r,{mark:u,encoding:Object.assign(Object.assign(Object.assign({[t]:Object.assign(Object.assign(Object.assign({field:`${l}_${n.field}`,type:n.type},d!==void 0?{title:d}:{}),o!==void 0?{scale:o}:{}),a!==void 0?{axis:a}:{})},fe(c)?{[`${t}2`]:{field:`${c}_${n.field}`}}:{}),i),f)})}}function Uj(e,t,n,i){const{clip:r,color:o,opacity:a}=e,s=e.type;return e[t]||e[t]===void 0&&n[t]?[Object.assign(Object.assign({},i),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[t]),r?{clip:r}:{}),o?{color:o}:{}),a?{opacity:a}:{}),to(i.mark)?i.mark:{type:i.mark}),{style:`${s}-${t}`}),sh(e[t])?{}:e[t])})]:[]}function qj(e,t,n){const{encoding:i}=e,r=t==="vertical"?"y":"x",o=i[r],a=i[`${r}2`],s=i[`${r}Error`],u=i[`${r}Error2`];return{continuousAxisChannelDef:D1(o,n),continuousAxisChannelDef2:D1(a,n),continuousAxisChannelDefError:D1(s,n),continuousAxisChannelDefError2:D1(u,n),continuousAxis:r}}function D1(e,t){if(e==null?void 0:e.aggregate){const{aggregate:n}=e,i=zj(e,["aggregate"]);return n!==t&&U(Nme(n,t)),i}else return e}function Hj(e,t){const{mark:n,encoding:i}=e,{x:r,y:o}=i;if(to(n)&&n.orient)return n.orient;if(io(r)){if(io(o)){const a=Y(r)&&r.aggregate,s=Y(o)&&o.aggregate;if(!a&&s===t)return"vertical";if(!s&&a===t)return"horizontal";if(a===t&&s===t)throw new Error("Both x and y cannot have aggregate");return rc(o)&&!rc(r)?"horizontal":"vertical"}return"horizontal"}else{if(io(o))return"vertical";throw new Error(`Need a valid continuous axis for ${t}s`)}}var M1=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const T1="boxplot",yye=["box","median","outliers","rule","ticks"],vye=new F1(T1,Gj);function Wj(e){return yt(e)?"tukey":e}function Gj(e,{config:t}){var n,i;e=Object.assign(Object.assign({},e),{encoding:k1(e.encoding,t)});const{mark:r,encoding:o,params:a,projection:s}=e,u=M1(e,["mark","encoding","params","projection"]),l=to(r)?r:{type:r};a&&U(N7("boxplot"));const c=(n=l.extent)!==null&&n!==void 0?n:t.boxplot.extent,f=Be("size",l,t),d=Wj(c),{bins:h,timeUnits:g,transform:p,continuousAxisChannelDef:m,continuousAxis:y,groupby:v,aggregate:b,encodingWithoutContinuousAxis:x,ticksOrient:w,boxOrient:_,customTooltipWithoutAggregatedField:E}=bye(e,c,t),{color:$,size:O}=x,C=M1(x,["color","size"]),A=we=>W$(l,y,m,we,t.boxplot),D=A(C),F=A(x),T=A(Object.assign(Object.assign({},C),O?{size:O}:{})),S=q$([{fieldPrefix:d==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:d==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],m,x),M={type:"tick",color:"black",opacity:1,orient:w,invalid:null,aria:!1},P=d==="min-max"?S:q$([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],m,x),B=[...D({partName:"rule",mark:{type:"rule",invalid:null,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:P}),...D({partName:"rule",mark:{type:"rule",invalid:null,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:P}),...D({partName:"ticks",mark:M,positionPrefix:"lower_whisker",extraEncoding:P}),...D({partName:"ticks",mark:M,positionPrefix:"upper_whisker",extraEncoding:P})],H=[...d!=="tukey"?B:[],...F({partName:"box",mark:Object.assign(Object.assign({type:"bar"},f?{size:f}:{}),{orient:_,invalid:null,ariaRoleDescription:"box"}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:S}),...T({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},Ve(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{}),f?{size:f}:{}),{orient:w,aria:!1}),positionPrefix:"mid_box",extraEncoding:S})];if(d==="min-max")return Object.assign(Object.assign({},u),{transform:((i=u.transform)!==null&&i!==void 0?i:[]).concat(p),layer:H});const re=`datum["lower_box_${m.field}"]`,le=`datum["upper_box_${m.field}"]`,he=`(${le} - ${re})`,Ae=`${re} - ${c} * ${he}`,$e=`${le} + ${c} * ${he}`,Pe=`datum["${m.field}"]`,It={joinaggregate:Yj(m.field),groupby:v},ti={transform:[{filter:`(${Ae} <= ${Pe}) && (${Pe} <= ${$e})`},{aggregate:[{op:"min",field:m.field,as:`lower_whisker_${m.field}`},{op:"max",field:m.field,as:`upper_whisker_${m.field}`},{op:"min",field:`lower_box_${m.field}`,as:`lower_box_${m.field}`},{op:"max",field:`upper_box_${m.field}`,as:`upper_box_${m.field}`},...b],groupby:v}],layer:B},Nn=M1(C,["tooltip"]),{scale:R,axis:W}=m,V=H$(m),k=pi(W,["title"]),xe=Uj(l,"outliers",t.boxplot,{transform:[{filter:`(${Pe} < ${Ae}) || (${Pe} > ${$e})`}],mark:"point",encoding:Object.assign(Object.assign(Object.assign({[y]:Object.assign(Object.assign(Object.assign({field:m.field,type:m.type},V!==void 0?{title:V}:{}),R!==void 0?{scale:R}:{}),We(k)?{}:{axis:k})},Nn),$?{color:$}:{}),E?{tooltip:E}:{})})[0];let X;const Ce=[...h,...g,It];return xe?X={transform:Ce,layer:[xe,ti]}:(X=ti,X.transform.unshift(...Ce)),Object.assign(Object.assign({},u),{layer:[X,{transform:p,layer:H}]})}function Yj(e){return[{op:"q1",field:e,as:`lower_box_${e}`},{op:"q3",field:e,as:`upper_box_${e}`}]}function bye(e,t,n){const i=Hj(e,T1),{continuousAxisChannelDef:r,continuousAxis:o}=qj(e,i,T1),a=r.field,s=Wj(t),u=[...Yj(a),{op:"median",field:a,as:`mid_box_${a}`},{op:"min",field:a,as:(s==="min-max"?"lower_whisker_":"min_")+a},{op:"max",field:a,as:(s==="min-max"?"upper_whisker_":"max_")+a}],l=s==="min-max"||s==="tukey"?[]:[{calculate:`datum["upper_box_${a}"] - datum["lower_box_${a}"]`,as:`iqr_${a}`},{calculate:`min(datum["upper_box_${a}"] + datum["iqr_${a}"] * ${t}, datum["max_${a}"])`,as:`upper_whisker_${a}`},{calculate:`max(datum["lower_box_${a}"] - datum["iqr_${a}"] * ${t}, datum["min_${a}"])`,as:`lower_whisker_${a}`}],c=e.encoding,f=o;c[f];const d=M1(c,[typeof f=="symbol"?f:f+""]),{customTooltipWithoutAggregatedField:h,filteredEncoding:g}=mye(d),{bins:p,timeUnits:m,aggregate:y,groupby:v,encoding:b}=Ij(g,n),x=i==="vertical"?"horizontal":"vertical",w=i,_=[...p,...m,{aggregate:[...y,...u],groupby:v},...l];return{bins:p,timeUnits:m,transform:_,groupby:v,aggregate:y,continuousAxisChannelDef:r,continuousAxis:o,encodingWithoutContinuousAxis:b,ticksOrient:x,boxOrient:w,customTooltipWithoutAggregatedField:h}}var Vj=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const G$="errorbar",xye=["ticks","rule"],wye=new F1(G$,Xj);function Xj(e,{config:t}){e=Object.assign(Object.assign({},e),{encoding:k1(e.encoding,t)});const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:o,ticksOrient:a,markDef:s,outerSpec:u,tooltipEncoding:l}=Kj(e,G$,t);delete o.size;const c=W$(s,r,i,o,t.errorbar),f=s.thickness,d=s.size,h=Object.assign(Object.assign({type:"tick",orient:a,aria:!1},f!==void 0?{thickness:f}:{}),d!==void 0?{size:d}:{}),g=[...c({partName:"ticks",mark:h,positionPrefix:"lower",extraEncoding:l}),...c({partName:"ticks",mark:h,positionPrefix:"upper",extraEncoding:l}),...c({partName:"rule",mark:Object.assign({type:"rule",ariaRoleDescription:"errorbar"},f!==void 0?{size:f}:{}),positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l})];return Object.assign(Object.assign(Object.assign({},u),{transform:n}),g.length>1?{layer:g}:Object.assign({},g[0]))}function Eye(e,t){const{encoding:n}=e;if(_ye(n))return{orient:Hj(e,t),inputType:"raw"};const i=Aye(n),r=$ye(n),o=n.x,a=n.y;if(i){if(r)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const s=n.x2,u=n.y2;if(ue(s)&&ue(u))throw new Error(`${t} cannot have both x2 and y2`);if(ue(s)){if(io(o))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}else if(ue(u)){if(io(a))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}else{const s=n.xError,u=n.xError2,l=n.yError,c=n.yError2;if(ue(u)&&!ue(s))throw new Error(`${t} cannot have xError2 without xError`);if(ue(c)&&!ue(l))throw new Error(`${t} cannot have yError2 without yError`);if(ue(s)&&ue(l))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(ue(s)){if(io(o))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(ue(l)){if(io(a))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function _ye(e){return(ue(e.x)||ue(e.y))&&!ue(e.x2)&&!ue(e.y2)&&!ue(e.xError)&&!ue(e.xError2)&&!ue(e.yError)&&!ue(e.yError2)}function Aye(e){return ue(e.x2)||ue(e.y2)}function $ye(e){return ue(e.xError)||ue(e.xError2)||ue(e.yError)||ue(e.yError2)}function Kj(e,t,n){var i;const{mark:r,encoding:o,params:a,projection:s}=e,u=Vj(e,["mark","encoding","params","projection"]),l=to(r)?r:{type:r};a&&U(N7(t));const{orient:c,inputType:f}=Eye(e,t),{continuousAxisChannelDef:d,continuousAxisChannelDef2:h,continuousAxisChannelDefError:g,continuousAxisChannelDefError2:p,continuousAxis:m}=qj(e,c,t),{errorBarSpecificAggregate:y,postAggregateCalculates:v,tooltipSummary:b,tooltipTitleWithFieldName:x}=Sye(l,d,h,g,p,f,t,n),w=o,_=m;w[_];const E=m==="x"?"x2":"y2";w[E];const $=m==="x"?"xError":"yError";w[$];const O=m==="x"?"xError2":"yError2";w[O];const C=Vj(w,[typeof _=="symbol"?_:_+"",typeof E=="symbol"?E:E+"",typeof $=="symbol"?$:$+"",typeof O=="symbol"?O:O+""]),{bins:A,timeUnits:D,aggregate:F,groupby:T,encoding:S}=Ij(C,n),M=[...F,...y],P=f!=="raw"?[]:T,B=q$(b,d,S,x);return{transform:[...(i=u.transform)!==null&&i!==void 0?i:[],...A,...D,...M.length===0?[]:[{aggregate:M,groupby:P}],...v],groupby:P,continuousAxisChannelDef:d,continuousAxis:m,encodingWithoutContinuousAxis:S,ticksOrient:c==="vertical"?"horizontal":"vertical",markDef:l,outerSpec:u,tooltipEncoding:B}}function Sye(e,t,n,i,r,o,a,s){let u=[],l=[];const c=t.field;let f,d=!1;if(o==="raw"){const h=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":s.errorbar.center,g=e.extent?e.extent:h==="mean"?"stderr":"iqr";if(h==="median"!=(g==="iqr")&&U(Tme(h,g,a)),g==="stderr"||g==="stdev")u=[{op:g,field:c,as:`extent_${c}`},{op:h,field:c,as:`center_${c}`}],l=[{calculate:`datum["center_${c}"] + datum["extent_${c}"]`,as:`upper_${c}`},{calculate:`datum["center_${c}"] - datum["extent_${c}"]`,as:`lower_${c}`}],f=[{fieldPrefix:"center_",titlePrefix:ch(h)},{fieldPrefix:"upper_",titlePrefix:Jj(h,g,"+")},{fieldPrefix:"lower_",titlePrefix:Jj(h,g,"-")}],d=!0;else{let p,m,y;g==="ci"?(p="mean",m="ci0",y="ci1"):(p="median",m="q1",y="q3"),u=[{op:m,field:c,as:`lower_${c}`},{op:y,field:c,as:`upper_${c}`},{op:p,field:c,as:`center_${c}`}],f=[{fieldPrefix:"upper_",titlePrefix:nc({field:c,aggregate:y,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:nc({field:c,aggregate:m,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:nc({field:c,aggregate:p,type:"quantitative"},s,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&U(Mme(e.center,e.extent)),o==="aggregated-upper-lower"?(f=[],l=[{calculate:`datum["${n.field}"]`,as:`upper_${c}`},{calculate:`datum["${c}"]`,as:`lower_${c}`}]):o==="aggregated-error"&&(f=[{fieldPrefix:"",titlePrefix:c}],l=[{calculate:`datum["${c}"] + datum["${i.field}"]`,as:`upper_${c}`}],r?l.push({calculate:`datum["${c}"] + datum["${r.field}"]`,as:`lower_${c}`}):l.push({calculate:`datum["${c}"] - datum["${i.field}"]`,as:`lower_${c}`}));for(const h of l)f.push({fieldPrefix:h.as.substring(0,6),titlePrefix:iu(iu(h.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:l,errorBarSpecificAggregate:u,tooltipSummary:f,tooltipTitleWithFieldName:d}}function Jj(e,t,n){return`${ch(e)} ${n} ${t}`}const Y$="errorband",Oye=["band","borders"],Cye=new F1(Y$,Zj);function Zj(e,{config:t}){e=Object.assign(Object.assign({},e),{encoding:k1(e.encoding,t)});const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:o,markDef:a,outerSpec:s,tooltipEncoding:u}=Kj(e,Y$,t),l=a,c=W$(l,r,i,o,t.errorband),f=e.encoding.x!==void 0&&e.encoding.y!==void 0;let d={type:f?"area":"rect"},h={type:f?"line":"rule"};const g=Object.assign(Object.assign({},l.interpolate?{interpolate:l.interpolate}:{}),l.tension&&l.interpolate?{tension:l.tension}:{});return f?(d=Object.assign(Object.assign(Object.assign({},d),g),{ariaRoleDescription:"errorband"}),h=Object.assign(Object.assign(Object.assign({},h),g),{aria:!1})):l.interpolate?U(q7("interpolate")):l.tension&&U(q7("tension")),Object.assign(Object.assign({},s),{transform:n,layer:[...c({partName:"band",mark:d,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"lower",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"upper",extraEncoding:u})]})}const Qj={};function V$(e,t,n){const i=new F1(e,t);Qj[e]={normalizer:i,parts:n}}function Fye(){return z(Qj)}V$(T1,Gj,yye);V$(G$,Xj,xye);V$(Y$,Zj,Oye);const kye=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],eL={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},tL={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},Dye=z(eL),Mye=z(tL),Tye={header:1,headerRow:1,headerColumn:1,headerFacet:1},nL=z(Tye),iL=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],Nye={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},Rye={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},Ah="_vgsid_",jye={point:{on:"click",fields:[Ah],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function X$(e){return!!e&&(e==="legend"||!!e.legend)}function K$(e){return X$(e)&&Ve(e)}function J$(e){return!!e.select}var Lye=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function rL(e){const t=[];for(const n of e||[]){if(J$(n))continue;const{expr:i,bind:r}=n,o=Lye(n,["expr","bind"]);if(r&&i){const a=Object.assign(Object.assign({},o),{bind:r,init:i});t.push(a)}else{const a=Object.assign(Object.assign(Object.assign({},o),i?{update:i}:{}),r?{bind:r}:{});t.push(a)}}return t}function Pye(e){return N1(e)||Q$(e)||Z$(e)}function Z$(e){return"concat"in e}function N1(e){return"vconcat"in e}function Q$(e){return"hconcat"in e}function oo(e){return Ve(e)&&e.step!==void 0}function oL(e){return e.view||e.width||e.height}const aL=20,Iye={align:1,bounds:1,center:1,columns:1,spacing:1},Bye=z(Iye);function zye(e,t,n){var i,r;const o=n[t],a={},{spacing:s,columns:u}=o;s!==void 0&&(a.spacing=s),u!==void 0&&(x1(e)&&!wh(e.facet)||Z$(e))&&(a.columns=u),N1(e)&&(a.columns=1);for(const l of Bye)if(e[l]!==void 0)if(l==="spacing"){const c=e[l];a[l]=yt(c)?c:{row:(i=c.row)!==null&&i!==void 0?i:s,column:(r=c.column)!==null&&r!==void 0?r:s}}else a[l]=e[l];return a}var Uye=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function eS(e,t){var n;return(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"continuousWidth":"continuousHeight"]}function R1(e,t){const n=$h(e,t);return oo(n)?n.step:sL}function $h(e,t){var n;const i=(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"discreteWidth":"discreteHeight"];return vt(i,{step:e.step})}const sL=20,qye={continuousWidth:200,continuousHeight:200,step:sL},Hye={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:qye,mark:R1e,arc:{},area:{},bar:P1e,circle:{},geoshape:{},image:{},line:{},point:{},rect:I1e,rule:{color:"black"},square:{},text:{color:"black"},tick:B1e,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:v1e,projection:{},legend:Nye,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:jye,style:{},title:{},facet:{spacing:aL},concat:{spacing:aL}},Ho=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],uL={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},lL={blue:Ho[0],orange:Ho[1],red:Ho[2],teal:Ho[3],green:Ho[4],yellow:Ho[5],purple:Ho[6],pink:Ho[7],brown:Ho[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function Wye(e={}){return{signals:[{name:"color",value:Ve(e)?Object.assign(Object.assign({},lL),e):lL}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function Gye(e){return{signals:[{name:"fontSize",value:Ve(e)?Object.assign(Object.assign({},uL),e):uL}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function Yye(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function cL(e){const t=z(e||{}),n={};for(const i of t){const r=e[i];n[i]=_h(r)?w7(r):mi(r)}return n}function Vye(e){const t=z(e),n={};for(const i of t)n[i]=cL(e[i]);return n}const Xye=[...lj,...Pj,...nL,"background","padding","legend","lineBreak","scale","style","title","view"];function fL(e={}){const{color:t,font:n,fontSize:i,selection:r}=e,o=Uye(e,["color","font","fontSize","selection"]),a=Q9({},de(Hye),n?Yye(n):{},t?Wye(t):{},i?Gye(i):{},o||{});r&&Mc(a,"selection",r,!0);const s=pi(a,Xye);for(const u of["background","lineBreak","padding"])a[u]&&(s[u]=mi(a[u]));for(const u of lj)a[u]&&(s[u]=Jn(a[u]));for(const u of Pj)a[u]&&(s[u]=cL(a[u]));for(const u of nL)a[u]&&(s[u]=Jn(a[u]));return a.legend&&(s.legend=Jn(a.legend)),a.scale&&(s.scale=Jn(a.scale)),a.style&&(s.style=Vye(a.style)),a.title&&(s.title=Jn(a.title)),a.view&&(s.view=Jn(a.view)),s}const Kye=["view",...sj],Jye=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],Zye=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},N1e);function Qye(e){e=de(e);for(const t of Jye)delete e[t];if(e.axis)for(const t in e.axis)_h(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of kye)delete e.legend[t];if(e.mark){for(const t of uj)delete e.mark[t];e.mark.tooltip&&Ve(e.mark.tooltip)&&delete e.mark.tooltip}e.params&&(e.signals=(e.signals||[]).concat(rL(e.params)),delete e.params);for(const t of Kye){for(const i of uj)delete e[t][i];const n=Zye[t];if(n)for(const i of n)delete e[t][i];tve(e,t)}for(const t of Fye())delete e[t];eve(e);for(const t in e)Ve(e[t])&&We(e[t])&&delete e[t];return We(e)?void 0:e}function eve(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:i}=x7(e.title);We(t)||(e.style["group-title"]=Object.assign(Object.assign({},e.style["group-title"]),t)),We(n)||(e.style["group-subtitle"]=Object.assign(Object.assign({},e.style["group-subtitle"]),n)),We(i)?delete e.title:e.title=i}function tve(e,t,n,i){const r=i?e[t][i]:e[t];t==="view"&&(n="cell");const o=Object.assign(Object.assign({},r),e.style[n!=null?n:t]);We(o)||(e.style[n!=null?n:t]=o),i||delete e[t]}function j1(e){return"layer"in e}function nve(e){return"repeat"in e}function ive(e){return!J(e.repeat)&&e.repeat.layer}var rve=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class tS{map(t,n){return x1(t)?this.mapFacet(t,n):nve(t)?this.mapRepeat(t,n):Q$(t)?this.mapHConcat(t,n):N1(t)?this.mapVConcat(t,n):Z$(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(j1(t))return this.mapLayer(t,n);if(qo(t))return this.mapUnit(t,n);throw new Error(o$(t))}mapLayer(t,n){return Object.assign(Object.assign({},t),{layer:t.layer.map(i=>this.mapLayerOrUnit(i,n))})}mapHConcat(t,n){return Object.assign(Object.assign({},t),{hconcat:t.hconcat.map(i=>this.map(i,n))})}mapVConcat(t,n){return Object.assign(Object.assign({},t),{vconcat:t.vconcat.map(i=>this.map(i,n))})}mapConcat(t,n){const{concat:i}=t,r=rve(t,["concat"]);return Object.assign(Object.assign({},r),{concat:i.map(o=>this.map(o,n))})}mapFacet(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}mapRepeat(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}}const ove={zero:1,center:1,normalize:1};function ave(e){return e in ove}const sve=new Set([ij,h1,d1,m1,p1,S$,O$,g1,rj,$$]),uve=new Set([h1,d1,ij]);function oc(e){return Y(e)&&R$(e)==="quantitative"&&!e.bin}function dL(e,t){var n,i;const r=t==="x"?"y":"radius",o=e[t],a=e[r];if(Y(o)&&Y(a))if(oc(o)&&oc(a)){if(o.stack)return t;if(a.stack)return r;const s=Y(o)&&!!o.aggregate,u=Y(a)&&!!a.aggregate;if(s!==u)return s?t:r;{const l=(n=o.scale)===null||n===void 0?void 0:n.type,c=(i=a.scale)===null||i===void 0?void 0:i.type;if(l&&l!=="linear")return r;if(c&&c!=="linear")return t}}else{if(oc(o))return t;if(oc(a))return r}else{if(oc(o))return t;if(oc(a))return r}}function lve(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function hL(e,t,n={}){var i,r;const o=to(e)?e.type:e;if(!sve.has(o))return null;const a=dL(t,"x")||dL(t,"theta");if(!a)return null;const s=t[a],u=Y(s)?G(s,{}):void 0;let l=lve(a),c=t[l],f=Y(c)?G(c,{}):void 0;f===u&&(f=void 0,c=void 0,l=void 0);const d=ppe.reduce((g,p)=>{if(p!=="tooltip"&&gu(t,p)){const m=t[p];for(const y of ft(m)){const v=ro(y);if(v.aggregate)continue;const b=G(v,{});(!b||b!==f)&&g.push({channel:p,fieldDef:v})}}return g},[]);let h;if(s.stack!==void 0?sh(s.stack)?h=s.stack?"zero":null:h=s.stack:uve.has(o)&&(h="zero"),!h||!ave(h)||z$(t)&&d.length===0)return null;if(((i=s==null?void 0:s.scale)===null||i===void 0?void 0:i.type)&&((r=s==null?void 0:s.scale)===null||r===void 0?void 0:r.type)!==St.LINEAR){if(n.disallowNonLinearStack)return null;U(Fme(s.scale.type))}return ue(t[Io(a)])?(s.stack!==void 0&&U(Cme(a)),null):(Y(s)&&s.aggregate&&!ye(Ope,s.aggregate)&&U(kme(s.aggregate)),{groupbyChannel:c?l:void 0,groupbyField:f,fieldChannel:a,impute:s.impute===null?!1:Ua(o),stackBy:d,offset:h})}var gL=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function cve(e){const t=gL(e,["point","line"]);return z(t).length>1?t:t.type}function fve(e){for(const t of["line","area","rule","trail"])e[t]&&(e=Object.assign(Object.assign({},e),{[t]:pi(e[t],["point","line"])}));return e}function nS(e,t={},n){return e.point==="transparent"?{opacity:0}:e.point?Ve(e.point)?e.point:{}:e.point!==void 0?null:t.point||n.shape?Ve(t.point)?t.point:{}:void 0}function pL(e,t={}){return e.line?e.line===!0?{}:e.line:e.line!==void 0?null:t.line?t.line===!0?{}:t.line:void 0}class dve{constructor(){this.name="path-overlay"}hasMatchingType(t,n){if(qo(t)){const{mark:i,encoding:r}=t,o=to(i)?i:{type:i};switch(o.type){case"line":case"rule":case"trail":return!!nS(o,n[o.type],r);case"area":return!!nS(o,n[o.type],r)||!!pL(o,n[o.type])}}return!1}run(t,n,i){const{config:r}=n,{params:o,projection:a,mark:s,encoding:u}=t,l=gL(t,["params","projection","mark","encoding"]),c=k1(u,r),f=to(s)?s:{type:s},d=nS(f,r[f.type],c),h=f.type==="area"&&pL(f,r[f.type]),g=[Object.assign(Object.assign({},o?{params:o}:{}),{mark:cve(Object.assign(Object.assign({},f.type==="area"&&f.opacity===void 0&&f.fillOpacity===void 0?{opacity:.7}:{}),f)),encoding:pi(c,["shape"])})],p=hL(f,c);let m=c;if(p){const{fieldChannel:y,offset:v}=p;m=Object.assign(Object.assign({},c),{[y]:Object.assign(Object.assign({},c[y]),v?{stack:v}:{})})}return h&&g.push(Object.assign(Object.assign({},a?{projection:a}:{}),{mark:Object.assign(Object.assign({type:"line"},Vl(f,["clip","interpolate","tension","tooltip"])),h),encoding:m})),d&&g.push(Object.assign(Object.assign({},a?{projection:a}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},Vl(f,["clip","tooltip"])),d),encoding:m})),i(Object.assign(Object.assign({},l),{layer:g}),Object.assign(Object.assign({},n),{config:fve(r)}))}}var hve=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function gve(e,t){return t?wh(e)?bL(e,t):mL(e,t):e}function iS(e,t){return t?bL(e,t):e}function rS(e,t,n){const i=t[e];if(X1e(i)){if(i.repeat in n)return Object.assign(Object.assign({},t),{[e]:n[i.repeat]});U(Ype(i.repeat));return}return t}function mL(e,t){if(e=rS("field",e,t),e!==void 0){if(e===null)return null;if(N$(e)&&no(e.sort)){const n=rS("field",e.sort,t);e=Object.assign(Object.assign({},e),n?{sort:n}:{})}return e}}function yL(e,t){if(Y(e))return mL(e,t);{const n=rS("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function vL(e,t){if(ue(e)){const n=yL(e,t);if(n)return n;if(w1(e))return{condition:e.condition}}else{if(_1(e)){const n=yL(e.condition,t);return n?Object.assign(Object.assign({},e),{condition:n}):hve(e,["condition"])}return e}}function bL(e,t){const n={};for(const i in e)if(Gl(e,i)){const r=e[i];if(J(r))n[i]=r.map(o=>vL(o,t)).filter(o=>o);else{const o=vL(r,t);o!==void 0&&(n[i]=o)}}return n}class pve{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(qo(t)){const{encoding:n,mark:i}=t;if(i==="line"||to(i)&&i.type==="line")for(const r of hpe){const o=au(r),a=n[o];if(n[r]&&(Y(a)&&!kn(a.bin)||qa(a)))return!0}}return!1}run(t,n,i){const{encoding:r,mark:o}=t;return U(fme(!!r.x2,!!r.y2)),i(Object.assign(Object.assign({},t),{mark:Ve(o)?Object.assign(Object.assign({},o),{type:"rule"}):"rule"}),n)}}var Ha=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class mve extends tS{constructor(){super(...arguments);this.nonFacetUnitNormalizers=[vye,wye,Cye,new dve,new pve]}map(t,n){if(qo(t)){const i=gu(t.encoding,To),r=gu(t.encoding,No),o=gu(t.encoding,t1);if(i||r||o)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){const{parentEncoding:i,parentProjection:r}=n,o=iS(t.encoding,n.repeater),a=Object.assign(Object.assign({},t),o?{encoding:o}:{});if(i||r)return this.mapUnitWithParentEncodingOrProjection(a,n);const s=this.mapLayerOrUnit.bind(this);for(const u of this.nonFacetUnitNormalizers)if(u.hasMatchingType(a,n.config))return u.run(a,n,s);return a}mapRepeat(t,n){return ive(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){const{repeat:i,spec:r}=t,o=Ha(t,["repeat","spec"]),{row:a,column:s,layer:u}=i,{repeater:l={},repeaterPrefix:c=""}=n;return a||s?this.mapRepeat(Object.assign(Object.assign({},t),{repeat:Object.assign(Object.assign({},a?{row:a}:{}),s?{column:s}:{}),spec:{repeat:{layer:u},spec:r}}),n):Object.assign(Object.assign({},o),{layer:u.map(f=>{const d=Object.assign(Object.assign({},l),{layer:f}),h=`${(r.name||"")+c}child__layer_${nt(f)}`,g=this.mapLayerOrUnit(r,Object.assign(Object.assign({},n),{repeater:d,repeaterPrefix:h}));return g.name=h,g})})}mapNonLayerRepeat(t,n){var i;const{repeat:r,spec:o,data:a}=t,s=Ha(t,["repeat","spec","data"]);!J(r)&&t.columns&&(t=pi(t,["columns"]),U(R7("repeat")));const u=[],{repeater:l={},repeaterPrefix:c=""}=n,f=!J(r)&&r.row||[l?l.row:null],d=!J(r)&&r.column||[l?l.column:null],h=J(r)&&r||[l?l.repeat:null];for(const p of h)for(const m of f)for(const y of d){const v={repeat:p,row:m,column:y,layer:l.layer},b=(o.name||"")+c+"child__"+(J(r)?`${nt(p)}`:(r.row?`row_${nt(m)}`:"")+(r.column?`column_${nt(y)}`:"")),x=this.map(o,Object.assign(Object.assign({},n),{repeater:v,repeaterPrefix:b}));x.name=b,u.push(pi(x,["data"]))}const g=J(r)?t.columns:r.column?r.column.length:1;return Object.assign(Object.assign({data:(i=o.data)!==null&&i!==void 0?i:a,align:"all"},s),{columns:g,concat:u})}mapFacet(t,n){const{facet:i}=t;return wh(i)&&t.columns&&(t=pi(t,["columns"]),U(R7("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){const{encoding:i,projection:r}=t,{parentEncoding:o,parentProjection:a,config:s}=n,u=wL({parentProjection:a,projection:r}),l=xL({parentEncoding:o,encoding:iS(i,n.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},t),u?{projection:u}:{}),l?{encoding:l}:{}),{config:s})}mapFacetedUnit(t,n){const i=t.encoding,{row:r,column:o,facet:a}=i,s=Ha(i,["row","column","facet"]),{mark:u,width:l,projection:c,height:f,view:d,params:h,encoding:g}=t,p=Ha(t,["mark","width","projection","height","view","params","encoding"]),{facetMapping:m,layout:y}=this.getFacetMappingAndLayout({row:r,column:o,facet:a},n),v=iS(s,n.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},p),y),{facet:m,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},l?{width:l}:{}),f?{height:f}:{}),d?{view:d}:{}),c?{projection:c}:{}),{mark:u,encoding:v}),h?{params:h}:{})}),n)}getFacetMappingAndLayout(t,n){var i;const{row:r,column:o,facet:a}=t;if(r||o){a&&U(lme([...r?[To]:[],...o?[No]:[]]));const s={},u={};for(const l of[To,No]){const c=t[l];if(c){const f=Ha(c,["align","center","spacing","columns"]);s[l]=f;for(const d of["align","center","spacing"])c[d]!==void 0&&((i=u[d])!==null&&i!==void 0||(u[d]={}),u[d][l]=c[d])}}return{facetMapping:s,layout:u}}else{const{align:s,center:u,spacing:l,columns:c}=a,f=Ha(a,["align","center","spacing","columns"]);return{facetMapping:gve(f,n.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},s?{align:s}:{}),u?{center:u}:{}),l?{spacing:l}:{}),c?{columns:c}:{})}}}mapLayer(t,n){var{parentEncoding:i,parentProjection:r}=n,o=Ha(n,["parentEncoding","parentProjection"]);const{encoding:a,projection:s}=t,u=Ha(t,["encoding","projection"]),l=Object.assign(Object.assign({},o),{parentEncoding:xL({parentEncoding:i,encoding:a,layer:!0}),parentProjection:wL({parentProjection:r,projection:s})});return super.mapLayer(u,l)}}function xL({parentEncoding:e,encoding:t={},layer:n}){let i={};if(e){const r=new Set([...z(e),...z(t)]);for(const o of r){const a=t[o],s=e[o];if(ue(a)){const u=Object.assign(Object.assign({},s),a);i[o]=u}else _1(a)?i[o]=Object.assign(Object.assign({},a),{condition:Object.assign(Object.assign({},s),a.condition)}):a||a===null?i[o]=a:(n||fr(s)||ie(s)||ue(s)||J(s))&&(i[o]=s)}}else i=t;return!i||We(i)?void 0:i}function wL(e){const{parentProjection:t,projection:n}=e;return t&&n&&U(Qpe({parentProjection:t,projection:n})),n!=null?n:t}function oS(e){return"filter"in e}function yve(e){return(e==null?void 0:e.stop)!==void 0}function EL(e){return"lookup"in e}function vve(e){return"data"in e}function bve(e){return"param"in e}function xve(e){return"pivot"in e}function wve(e){return"density"in e}function Eve(e){return"quantile"in e}function _ve(e){return"regression"in e}function Ave(e){return"loess"in e}function $ve(e){return"sample"in e}function Sve(e){return"window"in e}function Ove(e){return"joinaggregate"in e}function Cve(e){return"flatten"in e}function Fve(e){return"calculate"in e}function _L(e){return"bin"in e}function kve(e){return"impute"in e}function Dve(e){return"timeUnit"in e}function Mve(e){return"aggregate"in e}function Tve(e){return"stack"in e}function Nve(e){return"fold"in e}function Rve(e){return e.map(t=>oS(t)?{filter:Yl(t.filter,i1e)}:t)}var Wa=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class jve extends tS{map(t,n){var i,r;return(i=n.emptySelections)!==null&&i!==void 0||(n.emptySelections={}),(r=n.selectionPredicates)!==null&&r!==void 0||(n.selectionPredicates={}),t=AL(t,n),super.map(t,n)}mapLayerOrUnit(t,n){if(t=AL(t,n),t.encoding){const i={};for(const[r,o]of Da(t.encoding))i[r]=$L(o,n);t=Object.assign(Object.assign({},t),{encoding:i})}return super.mapLayerOrUnit(t,n)}mapUnit(t,n){const i=t,{selection:r}=i,o=Wa(i,["selection"]);return r?Object.assign(Object.assign({},o),{params:Da(r).map(([a,s])=>{var u;const l=s,{init:c,bind:f,empty:d}=l,h=Wa(l,["init","bind","empty"]);h.type==="single"?(h.type="point",h.toggle=!1):h.type==="multi"&&(h.type="point"),n.emptySelections[a]=d!=="none";for(const g of ln((u=n.selectionPredicates[a])!==null&&u!==void 0?u:{}))g.empty=d!=="none";return{name:a,value:c,select:h,bind:f}})}):t}}function AL(e,t){const{transform:n}=e,i=Wa(e,["transform"]);if(n){const r=n.map(o=>{if(oS(o))return{filter:aS(o,t)};if(_L(o)&&su(o.bin))return Object.assign(Object.assign({},o),{bin:SL(o.bin)});if(EL(o)){const a=o.from,{selection:s}=a,u=Wa(a,["selection"]);return s?Object.assign(Object.assign({},o),{from:Object.assign({param:s},u)}):o}return o});return Object.assign(Object.assign({},i),{transform:r})}return e}function $L(e,t){var n,i;const r=de(e);if(Y(r)&&su(r.bin)&&(r.bin=SL(r.bin)),hu(r)&&((i=(n=r.scale)===null||n===void 0?void 0:n.domain)===null||i===void 0?void 0:i.selection)){const o=r.scale.domain,{selection:a}=o,s=Wa(o,["selection"]);r.scale.domain=Object.assign(Object.assign({},s),a?{param:a}:{})}if(w1(r))if(Q(r.condition))r.condition=r.condition.map(o=>{const{selection:a,param:s,test:u}=o,l=Wa(o,["selection","param","test"]);return s?o:Object.assign(Object.assign({},l),{test:aS(o,t)})});else{const o=$L(r.condition,t),{selection:a,param:s,test:u}=o,l=Wa(o,["selection","param","test"]);r.condition=s?r.condition:Object.assign(Object.assign({},l),{test:aS(r.condition,t)})}return r}function SL(e){const t=e.extent;if(t==null?void 0:t.selection){const{selection:n}=t,i=Wa(t,["selection"]);return Object.assign(Object.assign({},e),{extent:Object.assign(Object.assign({},i),{param:n})})}return e}function aS(e,t){const n=i=>Yl(i,r=>{var o,a,s;const u=(o=t.emptySelections[r])!==null&&o!==void 0?o:!0,l={param:r,empty:u};return(a=(s=t.selectionPredicates)[r])!==null&&a!==void 0||(s[r]=[]),t.selectionPredicates[r].push(l),l});return e.selection?n(e.selection):Yl(e.test||e.filter,i=>i.selection?n(i.selection):i)}class sS extends tS{map(t,n){var i;const r=(i=n.selections)!==null&&i!==void 0?i:[];if(t.params&&!qo(t)){const o=[];for(const a of t.params)J$(a)?r.push(a):o.push(a);t.params=o}return n.selections=r,super.map(t,OL(t,n))}mapUnit(t,n){var i;const r=n.selections;if(!r||!r.length)return t;const o=((i=n.path)!==null&&i!==void 0?i:[]).concat(t.name),a=[];for(const s of r)if(!s.views||!s.views.length)a.push(s);else for(const u of s.views)(Fe(u)&&(u===t.name||o.indexOf(u)>=0)||Q(u)&&u.map(l=>o.indexOf(l)).every((l,c,f)=>l!==-1&&(c===0||l>f[c-1])))&&a.push(s);return a.length&&(t.params=a),t}}for(const e of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const t=sS.prototype[e];sS.prototype[e]=function(n,i){return t.call(this,n,OL(n,i))}}function OL(e,t){var n;return e.name?Object.assign(Object.assign({},t),{path:((n=t.path)!==null&&n!==void 0?n:[]).concat(e.name)}):t}function CL(e,t){t===void 0&&(t=fL(e.config));const n=Bve(e,t),{width:i,height:r}=e,o=zve(n,{width:i,height:r,autosize:e.autosize},t);return Object.assign(Object.assign({},n),o?{autosize:o}:{})}const Lve=new mve,Pve=new jve,Ive=new sS;function Bve(e,t={}){const n={config:t};return Ive.map(Lve.map(Pve.map(e,n),n),n)}function FL(e){return fe(e)?{type:e}:e!=null?e:{}}function zve(e,t,n){let{width:i,height:r}=t;const o=qo(e)||j1(e),a={};o?i=="container"&&r=="container"?(a.type="fit",a.contains="padding"):i=="container"?(a.type="fit-x",a.contains="padding"):r=="container"&&(a.type="fit-y",a.contains="padding"):(i=="container"&&(U(k7("width")),i=void 0),r=="container"&&(U(k7("height")),r=void 0));const s=Object.assign(Object.assign(Object.assign({type:"pad"},a),n?FL(n.autosize):{}),FL(e.autosize));if(s.type==="fit"&&!o&&(U(Lpe),s.type="pad"),i=="container"&&!(s.type=="fit"||s.type=="fit-x")&&U(D7("width")),r=="container"&&!(s.type=="fit"||s.type=="fit-y")&&U(D7("height")),!Hr(s,{type:"pad"}))return s}function Uve(e){return e==="fit"||e==="fit-x"||e==="fit-y"}function qve(e){return e?`fit-${a1(e)}`:"fit"}const Hve=["background","padding"];function kL(e,t){const n={};for(const i of Hve)e&&e[i]!==void 0&&(n[i]=mi(e[i]));return t&&(n.params=e.params),n}class Wo{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new Wo(de(this.explicit),de(this.implicit))}combine(){return Object.assign(Object.assign({},this.explicit),this.implicit)}get(t){return vt(this.explicit[t],this.implicit[t])}getWithExplicit(t){return this.explicit[t]!==void 0?{explicit:!0,value:this.explicit[t]}:this.implicit[t]!==void 0?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,{value:n,explicit:i}){n!==void 0&&this.set(t,n,i)}set(t,n,i){return delete this[i?"implicit":"explicit"][t],this[i?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,{explicit:n,implicit:i}){n[t]!==void 0?this.set(t,n[t],!0):i[t]!==void 0&&this.set(t,i[t],!1)}copyKeyFromObject(t,n){n[t]!==void 0&&this.set(t,n[t],!0)}copyAll(t){for(const n of z(t.combine())){const i=t.getWithExplicit(n);this.setWithExplicit(n,i)}}}function Go(e){return{explicit:!0,value:e}}function vi(e){return{explicit:!1,value:e}}function DL(e){return(t,n,i,r)=>{const o=e(t.value,n.value);return o>0?t:o<0?n:L1(t,n,i,r)}}function L1(e,t,n,i){return e.explicit&&t.explicit&&U(wme(n,i,e.value,t.value)),e}function Ga(e,t,n,i,r=L1){return e===void 0||e.value===void 0?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:Hr(e.value,t.value)?e:r(e,t,n,i)}class Wve extends Wo{constructor(t={},n={},i=!1){super(t,n);this.explicit=t,this.implicit=n,this.parseNothing=i}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function ac(e){return"url"in e}function Sh(e){return"values"in e}function ML(e){return"name"in e&&!ac(e)&&!Sh(e)&&!Ya(e)}function Ya(e){return e&&(TL(e)||NL(e)||uS(e))}function TL(e){return"sequence"in e}function NL(e){return"sphere"in e}function uS(e){return"graticule"in e}var Ze;(function(e){e[e.Raw=0]="Raw",e[e.Main=1]="Main",e[e.Row=2]="Row",e[e.Column=3]="Column",e[e.Lookup=4]="Lookup"})(Ze||(Ze={}));const Gve="view",P1="[",I1="]",RL="{",jL="}",Yve=":",LL=",",Vve="@",Xve=">",Kve=/[[\]{}]/,Jve={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let PL,IL;function sc(e,t,n){return PL=t||Gve,IL=n||Jve,BL(e.trim()).map(lS)}function Zve(e){return IL[e]}function Oh(e,t,n,i,r){const o=e.length;let a=0,s;for(;t<o;++t){if(s=e[t],!a&&s===n)return t;r&&r.indexOf(s)>=0?--a:i&&i.indexOf(s)>=0&&++a}return t}function BL(e){const t=[],n=e.length;let i=0,r=0;for(;r<n;)r=Oh(e,r,LL,P1+RL,I1+jL),t.push(e.substring(i,r).trim()),i=++r;if(t.length===0)throw"Empty event selector: "+e;return t}function lS(e){return e[0]==="["?Qve(e):ebe(e)}function Qve(e){const t=e.length;let n=1,i;if(n=Oh(e,n,I1,P1,I1),n===t)throw"Empty between selector: "+e;if(i=BL(e.substring(1,n)),i.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==Xve)throw"Expected '>' after between selector: "+e;i=i.map(lS);const r=lS(e.slice(1).trim());return r.between?{between:i,stream:r}:(r.between=i,r)}function ebe(e){const t={source:PL},n=[];let i=[0,0],r=0,o=0,a=e.length,s=0,u,l;if(e[a-1]===jL){if(s=e.lastIndexOf(RL),s>=0){try{i=tbe(e.substring(s+1,a-1))}catch(c){throw"Invalid throttle specification: "+e}e=e.slice(0,s).trim(),a=e.length}else throw"Unmatched right brace: "+e;s=0}if(!a)throw e;if(e[0]===Vve&&(r=++s),u=Oh(e,s,Yve),u<a&&(n.push(e.substring(o,u).trim()),o=s=++u),s=Oh(e,s,P1),s===a)n.push(e.substring(o,a).trim());else if(n.push(e.substring(o,s).trim()),l=[],o=++s,o===a)throw"Unmatched left bracket: "+e;for(;s<a;){if(s=Oh(e,s,I1),s===a)throw"Unmatched left bracket: "+e;if(l.push(e.substring(o,s).trim()),s<a-1&&e[++s]!==P1)throw"Expected left bracket: "+e;o=++s}if(!(a=n.length)||Kve.test(n[a-1]))throw"Invalid event selector: "+e;return a>1?(t.type=n[1],r?t.markname=n[0].slice(1):Zve(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),l!=null&&(t.filter=l),i[0]&&(t.throttle=i[0]),i[1]&&(t.debounce=i[1]),t}function tbe(e){const t=e.split(LL);if(!e.length||t.length>2)throw e;return t.map(n=>{const i=+n;if(i!==i)throw e;return i})}var nbe=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function uc(e,t=!0,n=Hge){if(J(e)){const i=e.map(r=>uc(r,t,n));return t?`[${i.join(", ")}]`:i}else if(lu(e))return n(t?yh(e):Gme(e));return t?n(Ke(e)):e}function ibe(e,t){var n;for(const i of ln((n=e.component.selection)!==null&&n!==void 0?n:{})){const r=i.name;let o=`${r}${Ka}, ${i.resolve==="global"?"true":`{unit: ${fc(e)}}`}`;for(const a of H1)!a.defined(i)||(a.signals&&(t=a.signals(e,i,t)),a.modifyExpr&&(o=a.modifyExpr(e,i,o)));t.push({name:r+jbe,on:[{events:{signal:i.name+Ka},update:`modify(${ke(i.name+pu)}, ${o})`}]})}return cS(t)}function rbe(e,t){if(e.component.selection&&z(e.component.selection).length){const n=ke(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:sc("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return cS(t)}function obe(e,t){var n;let i=!1;for(const r of ln((n=e.component.selection)!==null&&n!==void 0?n:{})){const o=r.name,a=ke(o+pu);if(t.filter(u=>u.name===o).length===0){const u=r.resolve==="global"?"union":r.resolve,l=r.type==="point"?", true, true)":")";t.push({name:r.name,update:`${lP}(${a}, ${ke(u)}${l}`})}i=!0;for(const u of H1)u.defined(r)&&u.topLevelSignals&&(t=u.topLevelSignals(e,r,t))}return i&&t.filter(o=>o.name==="unit").length===0&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]}),cS(t)}function abe(e,t){var n;const i=[...t];for(const r of ln((n=e.component.selection)!==null&&n!==void 0?n:{})){const o={name:r.name+pu};if(r.init){const s=r.project.items.map(u=>nbe(u,["signals"]));o.values=r.init.map(u=>({unit:fc(e,{escape:!1}),fields:s,values:uc(u,!1)}))}i.filter(s=>s.name===r.name+pu).length||i.push(o)}return i}function zL(e,t){var n;for(const i of ln((n=e.component.selection)!==null&&n!==void 0?n:{}))for(const r of H1)r.defined(i)&&r.marks&&(t=r.marks(e,i,t));return t}function sbe(e,t){for(const n of e.children)bt(n)&&(t=zL(n,t));return t}function ube(e,t,n,i){const r=OP(e,t.param,t);return{signal:yi(n.get("type"))&&J(i)&&i[0]>i[1]?`isValid(${r}) && reverse(${r})`:r}}function cS(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}class Ge{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){if(this._children.includes(t)){U(Kpe);return}n!==void 0?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const i of this._children)i.parent=t;this._children=[],t.removeChild(this),t.parent.removeChild(t),this.parent=n,t.parent=this}}class Tn extends Ge{constructor(t,n,i,r){super(t,n);this.type=i,this.refCounts=r,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const t=new this.constructor;return t.debugName=`clone_${this.debugName}`,t._source=this._source,t._name=`clone_${this._name}`,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${o7()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}var UL=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class ao extends Ge{constructor(t,n){super(t);this.formula=n}clone(){return new ao(null,de(this.formula))}static makeFromEncoding(t,n){const i=n.reduceFieldDef((r,o)=>{const{field:a,timeUnit:s}=o;if(s){const u=G(o,{forAs:!0});r[_e({as:u,field:a,timeUnit:s})]={as:u,field:a,timeUnit:s}}return r},{});return We(i)?null:new ao(t,i)}static makeFromTransform(t,n){const i=Object.assign({},n),{timeUnit:r}=i,o=UL(i,["timeUnit"]),a=Dn(r),s=Object.assign(Object.assign({},o),{timeUnit:a});return new ao(t,{[_e(s)]:s})}merge(t){this.formula=Object.assign({},this.formula);for(const n in t.formula)this.formula[n]||(this.formula[n]=t.formula[n]);for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}removeFormulas(t){const n={};for(const[i,r]of Da(this.formula))t.has(r.as)||(n[i]=r);this.formula=n}producedFields(){return new Set(ln(this.formula).map(t=>t.as))}dependentFields(){return new Set(ln(this.formula).map(t=>t.field))}hash(){return`TimeUnit ${_e(this.formula)}`}assemble(){const t=[];for(const n of ln(this.formula)){const{field:i,as:r,timeUnit:o}=n,a=Dn(o),{unit:s,utc:u}=a,l=UL(a,["unit","utc"]);t.push(Object.assign(Object.assign(Object.assign(Object.assign({field:Ti(i),type:"timeunit"},s?{units:d$(s)}:{}),u?{timezone:"utc"}:{}),l),{as:[r,`${r}_end`]}))}return t}}var lbe=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const Ch="_tuple_fields";class cbe{constructor(...t){this.items=t,this.hasChannel={},this.hasField={}}}const fbe={defined:()=>!0,parse:(e,t,n)=>{var i;const r=t.name,o=(i=t.project)!==null&&i!==void 0?i:t.project=new cbe,a={},s={},u=new Set,l=(p,m)=>{const y=m==="visual"?p.channel:p.field;let v=nt(`${r}_${y}`);for(let b=1;u.has(v);b++)v=nt(`${r}_${y}_${b}`);return u.add(v),{[m]:v}},c=t.type,f=e.config.selection[c],d=n.value!==void 0?ft(n.value):null;let{fields:h,encodings:g}=Ve(n.select)?n.select:{};if(!h&&!g&&d){for(const p of d)if(!!Ve(p))for(const m of z(p))dpe(m)?(g||(g=[])).push(m):c==="interval"?(U(Gpe),g=f.encodings):(h||(h=[])).push(m)}!h&&!g&&(g=f.encodings,"fields"in f&&(h=f.fields));for(const p of g!=null?g:[]){const m=e.fieldDef(p);if(m){let y=m.field;if(m.aggregate){U(Ppe(p,m.aggregate));continue}else if(!y){U(T7(p));continue}if(m.timeUnit){y=e.vgField(p);const v={timeUnit:m.timeUnit,as:y,field:m.field};s[_e(v)]=v}if(!a[y]){let v="E";if(c==="interval"){const x=e.getScaleComponent(p).get("type");yi(x)&&(v="R")}else m.bin&&(v="R-RE");const b={field:y,channel:p,type:v};b.signals=Object.assign(Object.assign({},l(b,"data")),l(b,"visual")),o.items.push(a[y]=b),o.hasField[y]=o.hasChannel[p]=a[y]}}else U(T7(p))}for(const p of h!=null?h:[]){if(o.hasField[p])continue;const m={type:"E",field:p};m.signals=Object.assign({},l(m,"data")),o.items.push(m),o.hasField[p]=m}d&&(t.init=d.map(p=>o.items.map(m=>Ve(p)?p[m.channel]!==void 0?p[m.channel]:p[m.field]:p))),We(s)||(o.timeUnit=new ao(null,s))},signals:(e,t,n)=>{const i=t.name+Ch;return n.filter(o=>o.name===i).length>0?n:n.concat({name:i,value:t.project.items.map(o=>{const a=lbe(o,["signals","hasLegend"]);return a.field=Ti(a.field),a})})}},Va={defined:e=>e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales",parse:(e,t)=>{const n=t.scales=[];for(const i of t.project.items){const r=i.channel;if(!Pa(r))continue;const o=e.getScaleComponent(r),a=o?o.get("type"):void 0;if(!o||!yi(a)){U(zpe);continue}o.set("selectionExtent",{param:t.name,field:i.field},!0),n.push(i)}},topLevelSignals:(e,t,n)=>{const i=t.scales.filter(a=>n.filter(s=>s.name===a.signals.data).length===0);if(!e.parent||dS(e)||i.length===0)return n;const r=n.filter(a=>a.name===t.name)[0];let o=r.update;if(o.indexOf(lP)>=0)r.update=`{${i.map(a=>`${ke(Ti(a.field))}: ${a.signals.data}`).join(", ")}}`;else{for(const a of i){const s=`${ke(Ti(a.field))}: ${a.signals.data}`;o.includes(s)||(o=`${o.substring(0,o.length-1)}, ${s}}`)}r.update=o}return n.concat(i.map(a=>({name:a.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!dS(e))for(const i of t.scales){const r=n.filter(o=>o.name===i.signals.data)[0];r.push="outer",delete r.value,delete r.update}return n}};function fS(e,t){return`domain(${ke(e.scaleName(t))})`}function dS(e){var t;return e.parent&&vc(e.parent)&&((t=!e.parent.parent)!==null&&t!==void 0?t:dS(e.parent.parent))}var dbe=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const lc="_brush",hS="_scale_trigger",hbe={defined:e=>e.type==="interval",signals:(e,t,n)=>{const i=t.name,r=i+Ch,o=Va.defined(t),a=t.init?t.init[0]:null,s=[],u=[];if(t.translate&&!o){const c=`!event.item || event.item.mark.name !== ${ke(i+lc)}`;qL(t,(f,d)=>{var h,g;const p=ft((h=(g=d.between[0]).filter)!==null&&h!==void 0?h:g.filter=[]);return p.includes(c)||p.push(c),f})}t.project.items.forEach((c,f)=>{const d=c.channel;if(d!==at&&d!==$t){U("Interval selections only support x and y encoding channels.");return}const h=a?a[f]:null,g=gbe(e,t,c,h),p=c.signals.data,m=c.signals.visual,y=ke(e.scaleName(d)),v=e.getScaleComponent(d).get("type"),b=yi(v)?"+":"";n.push(...g),s.push(p),u.push({scaleName:e.scaleName(d),expr:`(!isArray(${p}) || (${b}invert(${y}, ${m})[0] === ${b}${p}[0] && ${b}invert(${y}, ${m})[1] === ${b}${p}[1]))`})}),!o&&u.length&&n.push({name:i+hS,value:{},on:[{events:u.map(c=>({scale:c.scaleName})),update:`${u.map(c=>c.expr).join(" && ")} ? ${i+hS} : {}`}]});const l=`unit: ${fc(e)}, fields: ${r}, values`;return n.concat(Object.assign(Object.assign({name:i+Ka},a?{init:`{${l}: ${uc(a)}}`}:{}),s.length?{on:[{events:[{signal:s.join(" || ")}],update:`${s.join(" && ")} ? {${l}: [${s}]} : null`}]}:{}))},marks:(e,t,n)=>{const i=t.name,{x:r,y:o}=t.project.hasChannel,a=r&&r.signals.visual,s=o&&o.signals.visual,u=`data(${ke(t.name+pu)})`;if(Va.defined(t)||!r&&!o)return n;const l={x:r!==void 0?{signal:`${a}[0]`}:{value:0},y:o!==void 0?{signal:`${s}[0]`}:{value:0},x2:r!==void 0?{signal:`${a}[1]`}:{field:{group:"width"}},y2:o!==void 0?{signal:`${s}[1]`}:{field:{group:"height"}}};if(t.resolve==="global")for(const m of z(l))l[m]=[Object.assign({test:`${u}.length && ${u}[0].unit === ${fc(e)}`},l[m]),{value:0}];const c=t.mark,{fill:f,fillOpacity:d,cursor:h}=c,g=dbe(c,["fill","fillOpacity","cursor"]),p=z(g).reduce((m,y)=>(m[y]=[{test:[r!==void 0&&`${a}[0] !== ${a}[1]`,o!==void 0&&`${s}[0] !== ${s}[1]`].filter(v=>v).join(" && "),value:g[y]},{value:null}],m),{});return[{name:`${i+lc}_bg`,type:"rect",clip:!0,encode:{enter:{fill:{value:f},fillOpacity:{value:d}},update:l}},...n,{name:i+lc,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},h?{cursor:{value:h}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},l),p)}}]}};function gbe(e,t,n,i){const r=n.channel,o=n.signals.visual,a=n.signals.data,s=Va.defined(t),u=ke(e.scaleName(r)),l=e.getScaleComponent(r),c=l?l.get("type"):void 0,f=p=>`scale(${u}, ${p})`,d=e.getSizeSignalRef(r===at?"width":"height").signal,h=`${r}(unit)`,g=qL(t,(p,m)=>[...p,{events:m.between[0],update:`[${h}, ${h}]`},{events:m,update:`[${o}[0], clamp(${h}, 0, ${d})]`}]);return g.push({events:{signal:t.name+hS},update:yi(c)?`[${f(`${a}[0]`)}, ${f(`${a}[1]`)}]`:"[0, 0]"}),s?[{name:a,on:[]}]:[Object.assign(Object.assign({name:o},i?{init:uc(i,!0,f)}:{value:[]}),{on:g}),Object.assign(Object.assign({name:a},i?{init:uc(i)}:{}),{on:[{events:{signal:o},update:`${o}[0] === ${o}[1] ? null : invert(${u}, ${o})`}]})]}function qL(e,t){return e.events.reduce((n,i)=>i.between?t(n,i):(U(`${i} is not an ordered event stream for interval selections.`),n),[])}const pbe={defined:e=>e.type==="point",signals:(e,t,n)=>{var i;const r=t.name,o=r+Ch,a=t.project,s="(item().isVoronoi ? datum.datum : datum)",u=a.items.map(h=>{const g=e.fieldDef(h.channel);return(g==null?void 0:g.bin)?`[${s}[${ke(e.vgField(h.channel,{}))}], ${s}[${ke(e.vgField(h.channel,{binSuffix:"end"}))}]]`:`${s}[${ke(h.field)}]`}).join(", "),l=`unit: ${fc(e)}, fields: ${o}, values`,c=t.events,f=ln((i=e.component.selection)!==null&&i!==void 0?i:{}).reduce((h,g)=>g.type==="interval"?h.concat(g.name+lc):h,[]).map(h=>`indexof(item().mark.name, '${h}') < 0`).join(" && "),d="datum && item().mark.marktype !== 'group'"+(f?` && ${f}`:"");return n.concat([{name:r+Ka,on:c?[{events:c,update:`${d} ? {${l}: [${u}]} : null`,force:!0}]:[]}])}};function cc(e,t,n,i){const r=w1(t)&&t.condition,o=i(t);if(r){const s=ft(r).map(u=>{const l=i(u);if(V1e(u)){const{param:c,empty:f}=u,d=SP(e,{param:c,empty:f});return Object.assign({test:d},l)}else{const c=J1(e,u.test);return Object.assign({test:c},l)}});return{[n]:[...s,...o!==void 0?[o]:[]]}}else return o!==void 0?{[n]:o}:{}}function gS(e,t="text"){const n=e.encoding[t];return cc(e,n,t,i=>B1(i,e.config))}function B1(e,t,n="datum"){if(e){if(fr(e))return it(e.value);if(ue(e)){const{format:i,formatType:r}=$1(e);return k$({fieldOrDatumDef:e,format:i,formatType:r,expr:n,config:t})}}}function HL(e,t={}){const{encoding:n,markDef:i,config:r,stack:o}=e,a=n.tooltip;if(J(a))return{tooltip:GL({tooltip:a},o,r,t)};{const s=t.reactiveGeom?"datum.datum":"datum";return cc(e,a,"tooltip",u=>{const l=B1(u,r,s);if(l)return l;if(u===null)return;let c=Be("tooltip",i,r);if(c===!0&&(c={content:"encoding"}),fe(c))return{value:c};if(Ve(c))return ie(c)?c:c.content==="encoding"?GL(n,o,r,t):{signal:s}})}}function WL(e,t,n,{reactiveGeom:i}={}){const r={},o=i?"datum.datum":"datum",a=[];function s(l,c){const f=au(c),d=Li(l)?l:Object.assign(Object.assign({},l),{type:e[f].type}),h=d.title||I$(d,n),g=ft(h).join(", ");let p;if(Qr(c)){const m=c==="x"?"x2":"y2",y=ro(e[m]);if(kn(d.bin)&&y){const v=G(d,{expr:o}),b=G(y,{expr:o}),{format:x,formatType:w}=$1(d);p=v1(v,b,x,w,n),r[m]=!0}else if(t&&t.fieldChannel===c&&t.offset==="normalize"){const{format:v,formatType:b}=$1(d);p=k$({fieldOrDatumDef:d,format:v,formatType:b,expr:o,config:n,normalizeStack:!0}).signal}}p!=null||(p=B1(d,n,o).signal),a.push({channel:c,key:g,value:p})}U$(e,(l,c)=>{Y(l)?s(l,c):E1(l)&&s(l.condition,c)});const u={};for(const{channel:l,key:c,value:f}of a)!r[l]&&!u[c]&&(u[c]=f);return u}function GL(e,t,n,{reactiveGeom:i}={}){const r=WL(e,t,n,{reactiveGeom:i}),o=Da(r).map(([a,s])=>`"${a}": ${s}`);return o.length>0?{signal:`{${o.join(", ")}}`}:void 0}function mbe(e){const{markDef:t,config:n}=e,i=Be("aria",t,n);return i===!1?{}:Object.assign(Object.assign(Object.assign({},i?{aria:i}:{}),ybe(e)),vbe(e))}function ybe(e){const{mark:t,markDef:n,config:i}=e;if(i.aria===!1)return{};const r=Be("ariaRoleDescription",n,i);return r!=null?{ariaRoleDescription:{value:r}}:t in Rpe?{}:{ariaRoleDescription:{value:t}}}function vbe(e){const{encoding:t,markDef:n,config:i,stack:r}=e,o=t.description;if(o)return cc(e,o,"description",u=>B1(u,e.config));const a=Be("description",n,i);if(a!=null)return{description:it(a)};if(i.aria===!1)return{};const s=WL(t,r,i);if(!We(s))return{description:{signal:Da(s).map(([u,l],c)=>`"${c>0?"; ":""}${u}: " + (${l})`).join(" + ")}}}function Lt(e,t,n={}){const{markDef:i,encoding:r,config:o}=t,{vgChannel:a}=n;let{defaultRef:s,defaultValue:u}=n;s===void 0&&(u!=null||(u=Be(e,i,o,{vgChannel:a,ignoreVgConfig:!0})),u!==void 0&&(s=it(u)));const l=r[e];return cc(t,l,a!=null?a:e,c=>dj({channel:e,channelDef:c,markDef:i,config:o,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:s}))}function YL(e,t={filled:void 0}){var n,i,r,o;const{markDef:a,encoding:s,config:u}=e,{type:l}=a,c=(n=t.filled)!==null&&n!==void 0?n:Be("filled",a,u),f=ye(["bar","point","circle","square","geoshape"],l)?"transparent":void 0,d=(r=(i=Be(c===!0?"color":void 0,a,u,{vgChannel:"fill"}))!==null&&i!==void 0?i:u.mark[c===!0&&"color"])!==null&&r!==void 0?r:f,h=(o=Be(c===!1?"color":void 0,a,u,{vgChannel:"stroke"}))!==null&&o!==void 0?o:u.mark[c===!1&&"color"],g=c?"fill":"stroke",p=Object.assign(Object.assign({},d?{fill:it(d)}:{}),h?{stroke:it(h)}:{});return a.color&&(c?a.fill:a.stroke)&&U(I7("property",{fill:"fill"in a,stroke:"stroke"in a})),Object.assign(Object.assign(Object.assign(Object.assign({},p),Lt("color",e,{vgChannel:g,defaultValue:c?d:h})),Lt("fill",e,{defaultValue:s.fill?d:void 0})),Lt("stroke",e,{defaultValue:s.stroke?h:void 0}))}function bbe(e){const{encoding:t,mark:n}=e,i=t.order;return!Ua(n)&&fr(i)?cc(e,i,"zindex",r=>it(r.value)):{}}function Fh(e,t){const n=gpe(e),i=t[n];if(i)return i}function fn(e,t,{defaultPos:n,vgChannel:i}){const{encoding:r,markDef:o,config:a,stack:s}=t,u=r[e],l=r[Io(e)],c=t.scaleName(e),f=t.getScaleComponent(e),d=Fh(e,o),h=pS({model:t,defaultPos:n,channel:e,scaleName:c,scale:f}),g=!u&&Qr(e)&&(r.latitude||r.longitude)?{field:t.getName(e)}:xbe({channel:e,channelDef:u,channel2Def:l,markDef:o,config:a,scaleName:c,scale:f,stack:s,offset:d,defaultRef:h});return g?{[i||e]:g}:void 0}function xbe(e){const{channel:t,channelDef:n,scaleName:i,stack:r,offset:o,markDef:a}=e;if(ue(n)&&r&&t===r.fieldChannel){if(Y(n)){let s=n.bandPosition;if(s===void 0&&a.type==="text"&&(t==="radius"||t==="theta")&&(s=.5),s!==void 0)return y1({scaleName:i,fieldOrDatumDef:n,startSuffix:"start",bandPosition:s,offset:o})}return fu(n,i,{suffix:"end"},{offset:o})}return C$(e)}function pS({model:e,defaultPos:t,channel:n,scaleName:i,scale:r}){const{markDef:o,config:a}=e;return()=>{const s=au(n),u=ja(n),l=Be(n,o,a,{vgChannel:u});if(l!==void 0)return xh(n,l);switch(t){case"zeroOrMin":case"zeroOrMax":if(i){const c=r.get("type");if(!ye([St.LOG,St.TIME,St.UTC],c)){if(r.domainDefinitelyIncludesZero())return{scale:i,value:0}}}if(t==="zeroOrMin")return s==="y"?{field:{group:"height"}}:{value:0};switch(s){case"radius":return{signal:`min(${e.width.signal},${e.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":{const c=e[ji(n)];return Object.assign(Object.assign({},c),{mult:.5})}}}}const wbe={left:"x",center:"xc",right:"x2"},Ebe={top:"y",middle:"yc",bottom:"y2"};function VL(e,t,n,i="middle"){if(e==="radius"||e==="theta")return ja(e);const r=e==="x"?"align":"baseline",o=Be(r,t,n);let a;return ie(o)?(U(cme(r)),a=void 0):a=o,e==="x"?wbe[a||(i==="top"?"left":"center")]:Ebe[a||i]}function z1(e,t,{defaultPos:n,defaultPos2:i,range:r}){return r?XL(e,t,{defaultPos:n,defaultPos2:i}):fn(e,t,{defaultPos:n})}function XL(e,t,{defaultPos:n,defaultPos2:i}){const{markDef:r,config:o}=t,a=Io(e),s=ji(e),u=_be(t,i,a),l=u[s]?VL(e,r,o):ja(e);return Object.assign(Object.assign({},fn(e,t,{defaultPos:n,vgChannel:l})),u)}function _be(e,t,n){const{encoding:i,mark:r,markDef:o,stack:a,config:s}=e,u=au(n),l=ji(n),c=ja(n),f=i[u],d=e.scaleName(u),h=e.getScaleComponent(u),g=n in i||n in o?Fh(n,e.markDef):Fh(u,e.markDef);if(!f&&(n==="x2"||n==="y2")&&(i.latitude||i.longitude)){const m=ji(n),y=e.markDef[m];return y!=null?{[m]:{value:y}}:{[c]:{field:e.getName(n)}}}const p=Abe({channel:n,channelDef:f,channel2Def:i[n],markDef:o,config:s,scaleName:d,scale:h,stack:a,offset:g,defaultRef:void 0});return p!==void 0?{[c]:p}:U1(n,o)||U1(n,{[n]:l1(n,o,s.style),[l]:l1(l,o,s.style)})||U1(n,s[r])||U1(n,s.mark)||{[c]:pS({model:e,defaultPos:t,channel:n,scaleName:d,scale:h})()}}function Abe({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:o,scale:a,stack:s,offset:u,defaultRef:l}){return ue(t)&&s&&e.charAt(0)===s.fieldChannel.charAt(0)?fu(t,o,{suffix:"start"},{offset:u}):C$({channel:e,channelDef:n,scaleName:o,scale:a,stack:s,markDef:i,config:r,offset:u,defaultRef:l})}function U1(e,t){const n=ji(e),i=ja(e);if(t[i]!==void 0)return{[i]:xh(e,t[i])};if(t[e]!==void 0)return{[i]:xh(e,t[e])};if(t[n]){const r=t[n];if(tc(r))U(rme(n));else return{[n]:xh(e,r)}}}function Xa(e,t,n){var i,r,o,a;const{config:s,encoding:u,markDef:l}=e,c=Io(t),f=ji(t),d=u[t],h=u[c],g=e.getScaleComponent(t),p=g?g.get("type"):void 0,m=e.scaleName(t),y=l.orient,v=(r=(i=u[f])!==null&&i!==void 0?i:u.size)!==null&&r!==void 0?r:Be("size",l,s,{vgChannel:f}),b=n==="bar"&&(t==="x"?y==="vertical":y==="horizontal");if(Y(d)&&(Je(d.bin)||kn(d.bin)||d.timeUnit&&!h)&&!(v&&!tc(v))&&!cn(p)){const x=$j({channel:t,fieldDef:d,markDef:l,config:s,scaleType:p}),w=(o=e.component.axes[t])===null||o===void 0?void 0:o[0],_=(a=w==null?void 0:w.get("translate"))!==null&&a!==void 0?a:.5;return Obe({fieldDef:d,fieldDef2:h,channel:t,markDef:l,scaleName:m,bandSize:x,axisTranslate:_,spacing:Qr(t)?Be("binSpacing",l,s):void 0,reverse:g.get("reverse"),config:s})}else return(ue(d)&&cn(p)||b)&&!h?Sbe(d,t,e):XL(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function $be(e,t,n,i,r){if(tc(r))if(n){const a=n.get("type");if(a==="band")return{scale:t,band:r.band};r.band!==1&&(U(gme(a)),r=void 0)}else return{mult:r.band,field:{group:e}};else{if(ie(r))return r;if(r)return{value:r}}if(n){const a=n.get("range");if(za(a)&&yt(a.step))return{value:a.step-2}}return{value:R1(i.view,e)-2}}function Sbe(e,t,n){const{markDef:i,encoding:r,config:o,stack:a}=n,s=i.orient,u=n.scaleName(t),l=n.getScaleComponent(t),c=ji(t),f=Io(t),d=s==="horizontal"&&t==="y"||s==="vertical"&&t==="x";let h;(r.size||i.size)&&(d?h=Lt("size",n,{vgChannel:c,defaultRef:it(i.size)}):U(vme(i.type)));const g=$j({channel:t,fieldDef:e,markDef:i,config:o,scaleType:l==null?void 0:l.get("type"),useVlSizeChannel:d});h=h||{[c]:$be(c,u,l,o,g)};const p=(l==null?void 0:l.get("type"))!=="band"||!("band"in h[c])?"middle":"top",m=VL(t,i,o,p),y=m==="xc"||m==="yc",v=Fh(t,i),b=C$({channel:t,channelDef:e,markDef:i,config:o,scaleName:u,scale:l,stack:a,offset:v,defaultRef:pS({model:n,defaultPos:"mid",channel:t,scaleName:u,scale:l}),bandPosition:y?.5:ie(g)?{signal:`(1-${g})/2`}:tc(g)?(1-g.band)/2:0});if(c)return Object.assign({[m]:b},h);{const x=ja(f),w=h[c],_=v?Object.assign(Object.assign({},w),{offset:v}):w;return{[m]:b,[x]:J(b)?[b[0],Object.assign(Object.assign({},b[1]),{offset:_})]:Object.assign(Object.assign({},b),{offset:_})}}}function kh(e,t,n,i,r){if(l7(e))return 0;const o=e==="x"||e==="y2"?-t/2:t/2;if(ie(n)||ie(r)||ie(i)){const a=Uo(n),s=Uo(r),u=Uo(i),l=u?`${u} + `:"",c=a?`(${a} ? -1 : 1) * `:"",f=s?`(${s} + ${o})`:o;return{signal:l+c+f}}else return r=r||0,i+(n?-r-o:+r+o)}function Obe({fieldDef:e,fieldDef2:t,channel:n,bandSize:i,scaleName:r,markDef:o,spacing:a=0,axisTranslate:s,reverse:u,config:l}){const c=Io(n),f=ja(n),d=ja(c),h=Fh(n,o),g=ie(i)?{signal:`(1-${i.signal})/2`}:tc(i)?(1-i.band)/2:.5;if(Je(e.bin)||e.timeUnit)return{[d]:KL({channel:n,fieldDef:e,scaleName:r,markDef:o,bandPosition:g,offset:kh(c,a,u,s,h),config:l}),[f]:KL({channel:n,fieldDef:e,scaleName:r,markDef:o,bandPosition:ie(g)?{signal:`1-${g.signal}`}:1-g,offset:kh(n,a,u,s,h),config:l})};if(kn(e.bin)){const p=fu(e,r,{},{offset:kh(c,a,u,s,h)});if(Y(t))return{[d]:p,[f]:fu(t,r,{},{offset:kh(n,a,u,s,h)})};if(su(e.bin)&&e.bin.step)return{[d]:p,[f]:{signal:`scale("${r}", ${G(e,{expr:"datum"})} + ${e.bin.step})`,offset:kh(n,a,u,s,h)}}}U(H7(c))}function KL({channel:e,fieldDef:t,scaleName:n,markDef:i,bandPosition:r,offset:o,config:a}){const s=y1({scaleName:n,fieldOrDatumDef:t,bandPosition:r,offset:o});return fj({fieldDef:t,channel:e,markDef:i,ref:s,config:a})}const Cbe=new Set(["aria","width","height"]);function Pi(e,t){const{fill:n=void 0,stroke:i=void 0}=t.color==="include"?YL(e):{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Fbe(e.markDef,t)),JL(e,"fill",n)),JL(e,"stroke",i)),Lt("opacity",e)),Lt("fillOpacity",e)),Lt("strokeOpacity",e)),Lt("strokeWidth",e)),Lt("strokeDash",e)),bbe(e)),HL(e)),gS(e,"href")),mbe(e))}function JL(e,t,n){const{config:i,mark:r,markDef:o}=e;if(Be("invalid",o,i)==="hide"&&n&&!Ua(r)){const s=kbe(e,{invalid:!0,channels:s1});if(s)return{[t]:[{test:s,value:null},...ft(n)]}}return n?{[t]:n}:{}}function Fbe(e,t){return Npe.reduce((n,i)=>(!Cbe.has(i)&&e[i]!==void 0&&t[i]!=="ignore"&&(n[i]=it(e[i])),n),{})}function kbe(e,{invalid:t=!1,channels:n}){const i=n.reduce((o,a)=>{const s=e.getScaleComponent(a);if(s){const u=s.get("type"),l=e.vgField(a,{expr:"datum"});l&&yi(u)&&(o[l]=!0)}return o},{}),r=z(i);if(r.length>0){const o=t?"||":"&&";return r.map(a=>F$(a,t)).join(` ${o} `)}}function mS(e){const{config:t,markDef:n}=e;if(Be("invalid",n,t)){const r=Dbe(e,{channels:Zr});if(r)return{defined:{signal:r}}}return{}}function Dbe(e,{invalid:t=!1,channels:n}){const i=n.reduce((o,a)=>{const s=e.getScaleComponent(a);if(s){const u=s.get("type"),l=e.vgField(a,{expr:"datum"});l&&yi(u)&&(o[l]=!0)}return o},{}),r=z(i);if(r.length>0){const o=t?"||":"&&";return r.map(a=>F$(a,t)).join(` ${o} `)}}function ZL(e,t){if(t!==void 0)return{[e]:it(t)}}const yS="voronoi",QL={defined:e=>e.type==="point"&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(yS)},marks:(e,t,n)=>{const{x:i,y:r}=t.project.hasChannel,o=e.mark;if(Ua(o))return U(Ipe(o)),n;const a={name:e.getName(yS),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},HL(e,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:i||!r?"datum.datum.x || 0":"0"},y:{expr:r||!i?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let s=0,u=!1;return n.forEach((l,c)=>{var f;const d=(f=l.name)!==null&&f!==void 0?f:"";d===e.component.mark[0].name?s=c:d.indexOf(yS)>=0&&(u=!0)}),u||n.splice(s+1,0,a),n}},eP={defined:e=>e.type==="point"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!X$(e.bind),parse:(e,t,n)=>cP(t,n),topLevelSignals:(e,t,n)=>{const i=t.name,r=t.project,o=t.bind,a=t.init&&t.init[0],s=QL.defined(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return r.items.forEach((u,l)=>{var c,f;const d=nt(`${i}_${u.field}`);n.filter(g=>g.name===d).length||n.unshift(Object.assign(Object.assign({name:d},a?{init:uc(a[l])}:{value:null}),{on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${s}[${ke(u.field)}] : null`}]:[],bind:(f=(c=o[u.field])!==null&&c!==void 0?c:o[u.channel])!==null&&f!==void 0?f:o}))}),n},signals:(e,t,n)=>{const i=t.name,r=t.project,o=n.filter(l=>l.name===i+Ka)[0],a=i+Ch,s=r.items.map(l=>nt(`${i}_${l.field}`)),u=s.map(l=>`${l} !== null`).join(" && ");return s.length&&(o.update=`${u} ? {fields: ${a}, values: [${s.join(", ")}]} : null`),delete o.value,delete o.on,n}},q1="_toggle",tP={defined:e=>e.type==="point"&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+q1,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+Ka,i=t.name+q1;return`${i} ? null : ${n}, `+(t.resolve==="global"?`${i} ? null : true, `:`${i} ? null : {unit: ${fc(e)}}, `)+`${i} ? ${n} : null`}},Mbe={defined:e=>e.clear!==void 0&&e.clear!==!1,parse:(e,t)=>{t.clear&&(t.clear=fe(t.clear)?sc(t.clear,"view"):t.clear)},topLevelSignals:(e,t,n)=>{if(eP.defined(t))for(const i of t.project.items){const r=n.findIndex(o=>o.name===nt(`${t.name}_${i.field}`));r!==-1&&n[r].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function i(r,o){r!==-1&&n[r].on&&n[r].on.push({events:t.clear,update:o})}if(t.type==="interval")for(const r of t.project.items){const o=n.findIndex(a=>a.name===r.signals.visual);if(i(o,"[0, 0]"),o===-1){const a=n.findIndex(s=>s.name===r.signals.data);i(a,"null")}}else{let r=n.findIndex(o=>o.name===t.name+Ka);i(r,"null"),tP.defined(t)&&(r=n.findIndex(o=>o.name===t.name+q1),i(r,"false"))}return n}},nP={defined:e=>{const t=e.resolve==="global"&&e.bind&&X$(e.bind),n=e.project.items.length===1&&e.project.items[0].field!==Ah;return t&&!n&&U(Upe),t&&n},parse:(e,t,n)=>{var i;const r=de(n);if(r.select=fe(r.select)?{type:r.select,toggle:t.toggle}:Object.assign(Object.assign({},r.select),{toggle:t.toggle}),cP(t,r),se(n.select)&&(n.select.on||n.select.clear)){const s='event.item && indexof(event.item.mark.role, "legend") < 0';for(const u of t.events)u.filter=ft((i=u.filter)!==null&&i!==void 0?i:[]),u.filter.includes(s)||u.filter.push(s)}const o=K$(t.bind)?t.bind.legend:"click",a=fe(o)?sc(o,"view"):ft(o);t.bind={legend:{merge:a}}},topLevelSignals:(e,t,n)=>{const i=t.name,r=K$(t.bind)&&t.bind.legend,o=a=>s=>{const u=de(s);return u.markname=a,u};for(const a of t.project.items){if(!a.hasLegend)continue;const s=`${nt(a.field)}_legend`,u=`${i}_${s}`;if(n.filter(c=>c.name===u).length===0){const c=r.merge.map(o(`${s}_symbols`)).concat(r.merge.map(o(`${s}_labels`))).concat(r.merge.map(o(`${s}_entries`)));n.unshift(Object.assign(Object.assign({name:u},t.init?{}:{value:null}),{on:[{events:c,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:r.merge,update:`!event.item || !datum ? null : ${u}`,force:!0}]}))}}return n},signals:(e,t,n)=>{const i=t.name,r=t.project,o=n.find(d=>d.name===i+Ka),a=i+Ch,s=r.items.filter(d=>d.hasLegend).map(d=>nt(`${i}_${nt(d.field)}_legend`)),l=`${s.map(d=>`${d} !== null`).join(" && ")} ? {fields: ${a}, values: [${s.join(", ")}]} : null`;t.events&&s.length>0?o.on.push({events:s.map(d=>({signal:d})),update:l}):s.length>0&&(o.update=l,delete o.value,delete o.on);const c=n.find(d=>d.name===i+q1),f=K$(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push(Object.assign(Object.assign({},c.on[0]),{events:f})):c.on[0].events=f),n}};function Tbe(e,t,n){var i,r,o,a;const s=(i=e.fieldDef(t))===null||i===void 0?void 0:i.field;for(const u of ln((r=e.component.selection)!==null&&r!==void 0?r:{})){const l=(o=u.project.hasField[s])!==null&&o!==void 0?o:u.project.hasChannel[t];if(l&&nP.defined(u)){const c=(a=n.get("selections"))!==null&&a!==void 0?a:[];c.push(u.name),n.set("selections",c,!1),l.hasLegend=!0}}}const iP="_translate_anchor",rP="_translate_delta",Nbe={defined:e=>e.type==="interval"&&e.translate,signals:(e,t,n)=>{const i=t.name,r=Va.defined(t),o=i+iP,{x:a,y:s}=t.project.hasChannel;let u=sc(t.translate,"scope");return r||(u=u.map(l=>(l.between[0].markname=i+lc,l))),n.push({name:o,value:{},on:[{events:u.map(l=>l.between[0]),update:"{x: x(unit), y: y(unit)"+(a!==void 0?`, extent_x: ${r?fS(e,at):`slice(${a.signals.visual})`}`:"")+(s!==void 0?`, extent_y: ${r?fS(e,$t):`slice(${s.signals.visual})`}`:"")+"}"}]},{name:i+rP,value:{},on:[{events:u,update:`{x: ${o}.x - x(unit), y: ${o}.y - y(unit)}`}]}),a!==void 0&&oP(e,t,a,"width",n),s!==void 0&&oP(e,t,s,"height",n),n}};function oP(e,t,n,i,r){var o,a;const s=t.name,u=s+iP,l=s+rP,c=n.channel,f=Va.defined(t),d=r.filter(E=>E.name===n.signals[f?"data":"visual"])[0],h=e.getSizeSignalRef(i).signal,g=e.getScaleComponent(c),p=g.get("type"),m=g.get("reverse"),y=f?c===at?m?"":"-":m?"-":"":"",v=`${u}.extent_${c}`,b=`${y}${l}.${c} / ${f?`${h}`:`span(${v})`}`,x=f?p==="log"?"panLog":p==="symlog"?"panSymlog":p==="pow"?"panPow":"panLinear":"panLinear",w=f?p==="pow"?`, ${(o=g.get("exponent"))!==null&&o!==void 0?o:1}`:p==="symlog"?`, ${(a=g.get("constant"))!==null&&a!==void 0?a:1}`:"":"",_=`${x}(${v}, ${b}${w})`;d.on.push({events:{signal:l},update:f?_:`clampRange(${_}, 0, ${h})`})}const aP="_zoom_anchor",sP="_zoom_delta",Rbe={defined:e=>e.type==="interval"&&e.zoom,signals:(e,t,n)=>{const i=t.name,r=Va.defined(t),o=i+sP,{x:a,y:s}=t.project.hasChannel,u=ke(e.scaleName(at)),l=ke(e.scaleName($t));let c=sc(t.zoom,"scope");return r||(c=c.map(f=>(f.markname=i+lc,f))),n.push({name:i+aP,on:[{events:c,update:r?"{"+[u?`x: invert(${u}, x(unit))`:"",l?`y: invert(${l}, y(unit))`:""].filter(f=>!!f).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:o,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),a!==void 0&&uP(e,t,a,"width",n),s!==void 0&&uP(e,t,s,"height",n),n}};function uP(e,t,n,i,r){var o,a;const s=t.name,u=n.channel,l=Va.defined(t),c=r.filter(x=>x.name===n.signals[l?"data":"visual"])[0],f=e.getSizeSignalRef(i).signal,d=e.getScaleComponent(u),h=d.get("type"),g=l?fS(e,u):c.name,p=s+sP,m=`${s}${aP}.${u}`,y=l?h==="log"?"zoomLog":h==="symlog"?"zoomSymlog":h==="pow"?"zoomPow":"zoomLinear":"zoomLinear",v=l?h==="pow"?`, ${(o=d.get("exponent"))!==null&&o!==void 0?o:1}`:h==="symlog"?`, ${(a=d.get("constant"))!==null&&a!==void 0?a:1}`:"":"",b=`${y}(${g}, ${m}, ${p}${v})`;c.on.push({events:{signal:p},update:l?b:`clampRange(${b}, 0, ${f})`})}const pu="_store",Ka="_tuple",jbe="_modify",lP="vlSelectionResolve",H1=[pbe,hbe,fbe,tP,eP,Va,nP,Mbe,Nbe,Rbe,QL];function Lbe(e){let t=e.parent;for(;t&&!pr(t);)t=t.parent;return t}function fc(e,{escape:t}={escape:!0}){let n=t?ke(e.name):e.name;const i=Lbe(e);if(i){const{facet:r}=i;for(const o of Ri)r[o]&&(n+=` + '__facet_${o}_' + (facet[${ke(i.vgField(o))}])`)}return n}function vS(e){var t;return ln((t=e.component.selection)!==null&&t!==void 0?t:{}).reduce((n,i)=>n||i.project.items.some(r=>r.field===Ah),!1)}function cP(e,t){(Fe(t.select)||!t.select.on)&&delete e.events,(Fe(t.select)||!t.select.clear)&&delete e.clear,(Fe(t.select)||!t.select.toggle)&&delete e.toggle}const Pbe="RawCode",Ibe="Literal",Bbe="Property",zbe="Identifier",Ube="ArrayExpression",qbe="BinaryExpression",Hbe="CallExpression",Wbe="ConditionalExpression",Gbe="LogicalExpression",Ybe="MemberExpression",Vbe="ObjectExpression",Xbe="UnaryExpression";function dr(e){this.type=e}dr.prototype.visit=function(e){let t,n,i;if(e(this))return 1;for(t=Kbe(this),n=0,i=t.length;n<i;++n)if(t[n].visit(e))return 1};function Kbe(e){switch(e.type){case Ube:return e.elements;case qbe:case Gbe:return[e.left,e.right];case Hbe:return[e.callee].concat(e.arguments);case Wbe:return[e.test,e.consequent,e.alternate];case Ybe:return[e.object,e.property];case Vbe:return e.properties;case Bbe:return[e.key,e.value];case Xbe:return[e.argument];case zbe:case Ibe:case Pbe:default:return[]}}var so,Z,L,dn,qe,W1=1,Dh=2,mu=3,Ja=4,G1=5,yu=6,Zn=7,Mh=8,Jbe=9;so={};so[W1]="Boolean";so[Dh]="<end>";so[mu]="Identifier";so[Ja]="Keyword";so[G1]="Null";so[yu]="Numeric";so[Zn]="Punctuator";so[Mh]="String";so[Jbe]="RegularExpression";var Zbe="ArrayExpression",Qbe="BinaryExpression",exe="CallExpression",txe="ConditionalExpression",fP="Identifier",nxe="Literal",ixe="LogicalExpression",rxe="MemberExpression",oxe="ObjectExpression",axe="Property",sxe="UnaryExpression",Pt="Unexpected token %0",uxe="Unexpected number",lxe="Unexpected string",cxe="Unexpected identifier",fxe="Unexpected reserved word",dxe="Unexpected end of input",bS="Invalid regular expression",xS="Invalid regular expression: missing /",dP="Octal literals are not allowed in strict mode.",hxe="Duplicate data property in object literal not allowed in strict mode",Gt="ILLEGAL",Th="Disabled.",gxe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),pxe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function Y1(e,t){if(!e)throw new Error("ASSERT: "+t)}function Yo(e){return e>=48&&e<=57}function wS(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function Nh(e){return"01234567".indexOf(e)>=0}function mxe(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function Rh(e){return e===10||e===13||e===8232||e===8233}function jh(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&gxe.test(String.fromCharCode(e))}function V1(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&pxe.test(String.fromCharCode(e))}const yxe={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function hP(){for(;L<dn;){const e=Z.charCodeAt(L);if(mxe(e)||Rh(e))++L;else break}}function ES(e){var t,n,i,r=0;for(n=e==="u"?4:2,t=0;t<n;++t)L<dn&&wS(Z[L])?(i=Z[L++],r=r*16+"0123456789abcdef".indexOf(i.toLowerCase())):je({},Pt,Gt);return String.fromCharCode(r)}function vxe(){var e,t,n,i;for(e=Z[L],t=0,e==="}"&&je({},Pt,Gt);L<dn&&(e=Z[L++],!!wS(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&je({},Pt,Gt),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,i=(t-65536&1023)+56320,String.fromCharCode(n,i))}function gP(){var e,t;for(e=Z.charCodeAt(L++),t=String.fromCharCode(e),e===92&&(Z.charCodeAt(L)!==117&&je({},Pt,Gt),++L,e=ES("u"),(!e||e==="\\"||!jh(e.charCodeAt(0)))&&je({},Pt,Gt),t=e);L<dn&&(e=Z.charCodeAt(L),!!V1(e));)++L,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),Z.charCodeAt(L)!==117&&je({},Pt,Gt),++L,e=ES("u"),(!e||e==="\\"||!V1(e.charCodeAt(0)))&&je({},Pt,Gt),t+=e);return t}function bxe(){var e,t;for(e=L++;L<dn;){if(t=Z.charCodeAt(L),t===92)return L=e,gP();if(V1(t))++L;else break}return Z.slice(e,L)}function xxe(){var e,t,n;return e=L,t=Z.charCodeAt(L)===92?gP():bxe(),t.length===1?n=mu:yxe.hasOwnProperty(t)?n=Ja:t==="null"?n=G1:t==="true"||t==="false"?n=W1:n=mu,{type:n,value:t,start:e,end:L}}function _S(){var e=L,t=Z.charCodeAt(L),n,i=Z[L],r,o,a;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++L,{type:Zn,value:String.fromCharCode(t),start:e,end:L};default:if(n=Z.charCodeAt(L+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return L+=2,{type:Zn,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:L};case 33:case 61:return L+=2,Z.charCodeAt(L)===61&&++L,{type:Zn,value:Z.slice(e,L),start:e,end:L}}}if(a=Z.substr(L,4),a===">>>=")return L+=4,{type:Zn,value:a,start:e,end:L};if(o=a.substr(0,3),o===">>>"||o==="<<="||o===">>=")return L+=3,{type:Zn,value:o,start:e,end:L};if(r=o.substr(0,2),i===r[1]&&"+-<>&|".indexOf(i)>=0||r==="=>")return L+=2,{type:Zn,value:r,start:e,end:L};if(r==="//"&&je({},Pt,Gt),"<>=!+-*%&|^/".indexOf(i)>=0)return++L,{type:Zn,value:i,start:e,end:L};je({},Pt,Gt)}function wxe(e){let t="";for(;L<dn&&wS(Z[L]);)t+=Z[L++];return t.length===0&&je({},Pt,Gt),jh(Z.charCodeAt(L))&&je({},Pt,Gt),{type:yu,value:parseInt("0x"+t,16),start:e,end:L}}function Exe(e){let t="0"+Z[L++];for(;L<dn&&Nh(Z[L]);)t+=Z[L++];return(jh(Z.charCodeAt(L))||Yo(Z.charCodeAt(L)))&&je({},Pt,Gt),{type:yu,value:parseInt(t,8),octal:!0,start:e,end:L}}function pP(){var e,t,n;if(n=Z[L],Y1(Yo(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=L,e="",n!=="."){if(e=Z[L++],n=Z[L],e==="0"){if(n==="x"||n==="X")return++L,wxe(t);if(Nh(n))return Exe(t);n&&Yo(n.charCodeAt(0))&&je({},Pt,Gt)}for(;Yo(Z.charCodeAt(L));)e+=Z[L++];n=Z[L]}if(n==="."){for(e+=Z[L++];Yo(Z.charCodeAt(L));)e+=Z[L++];n=Z[L]}if(n==="e"||n==="E")if(e+=Z[L++],n=Z[L],(n==="+"||n==="-")&&(e+=Z[L++]),Yo(Z.charCodeAt(L)))for(;Yo(Z.charCodeAt(L));)e+=Z[L++];else je({},Pt,Gt);return jh(Z.charCodeAt(L))&&je({},Pt,Gt),{type:yu,value:parseFloat(e),start:t,end:L}}function _xe(){var e="",t,n,i,r,o=!1;for(t=Z[L],Y1(t==="'"||t==='"',"String literal must starts with a quote"),n=L,++L;L<dn;)if(i=Z[L++],i===t){t="";break}else if(i==="\\")if(i=Z[L++],!i||!Rh(i.charCodeAt(0)))switch(i){case"u":case"x":Z[L]==="{"?(++L,e+=vxe()):e+=ES(i);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:Nh(i)?(r="01234567".indexOf(i),r!==0&&(o=!0),L<dn&&Nh(Z[L])&&(o=!0,r=r*8+"01234567".indexOf(Z[L++]),"0123".indexOf(i)>=0&&L<dn&&Nh(Z[L])&&(r=r*8+"01234567".indexOf(Z[L++]))),e+=String.fromCharCode(r)):e+=i;break}else i==="\r"&&Z[L]===`
`&&++L;else{if(Rh(i.charCodeAt(0)))break;e+=i}return t!==""&&je({},Pt,Gt),{type:Mh,value:e,octal:o,start:n,end:L}}function Axe(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(i,r)=>{if(parseInt(r,16)<=1114111)return"x";je({},bS)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(i){je({},bS)}try{return new RegExp(e,t)}catch(i){return null}}function $xe(){var e,t,n,i,r;for(e=Z[L],Y1(e==="/","Regular expression literal must start with a slash"),t=Z[L++],n=!1,i=!1;L<dn;)if(e=Z[L++],t+=e,e==="\\")e=Z[L++],Rh(e.charCodeAt(0))&&je({},xS),t+=e;else if(Rh(e.charCodeAt(0)))je({},xS);else if(n)e==="]"&&(n=!1);else if(e==="/"){i=!0;break}else e==="["&&(n=!0);return i||je({},xS),r=t.substr(1,t.length-2),{value:r,literal:t}}function Sxe(){var e,t,n;for(t="",n="";L<dn&&(e=Z[L],!!V1(e.charCodeAt(0)));)++L,e==="\\"&&L<dn?je({},Pt,Gt):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&je({},bS,n),{value:n,literal:t}}function Oxe(){var e,t,n,i;return qe=null,hP(),e=L,t=$xe(),n=Sxe(),i=Axe(t.value,n.value),{literal:t.literal+n.literal,value:i,regex:{pattern:t.value,flags:n.value},start:e,end:L}}function Cxe(e){return e.type===mu||e.type===Ja||e.type===W1||e.type===G1}function mP(){if(hP(),L>=dn)return{type:Dh,start:L,end:L};const e=Z.charCodeAt(L);return jh(e)?xxe():e===40||e===41||e===59?_S():e===39||e===34?_xe():e===46?Yo(Z.charCodeAt(L+1))?pP():_S():Yo(e)?pP():_S()}function Qn(){const e=qe;return L=e.end,qe=mP(),L=e.end,e}function yP(){const e=L;qe=mP(),L=e}function Fxe(e){const t=new dr(Zbe);return t.elements=e,t}function vP(e,t,n){const i=new dr(e==="||"||e==="&&"?ixe:Qbe);return i.operator=e,i.left=t,i.right=n,i}function kxe(e,t){const n=new dr(exe);return n.callee=e,n.arguments=t,n}function Dxe(e,t,n){const i=new dr(txe);return i.test=e,i.consequent=t,i.alternate=n,i}function AS(e){const t=new dr(fP);return t.name=e,t}function Lh(e){const t=new dr(nxe);return t.value=e.value,t.raw=Z.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function bP(e,t,n){const i=new dr(rxe);return i.computed=e==="[",i.object=t,i.property=n,i.computed||(n.member=!0),i}function Mxe(e){const t=new dr(oxe);return t.properties=e,t}function xP(e,t,n){const i=new dr(axe);return i.key=t,i.value=n,i.kind=e,i}function Txe(e,t){const n=new dr(sxe);return n.operator=e,n.argument=t,n.prefix=!0,n}function je(e,t){var n,i=Array.prototype.slice.call(arguments,2),r=t.replace(/%(\d)/g,(o,a)=>(Y1(a<i.length,"Message reference must be in range"),i[a]));throw n=new Error(r),n.index=L,n.description=r,n}function X1(e){e.type===Dh&&je(e,dxe),e.type===yu&&je(e,uxe),e.type===Mh&&je(e,lxe),e.type===mu&&je(e,cxe),e.type===Ja&&je(e,fxe),je(e,Pt,e.value)}function hn(e){const t=Qn();(t.type!==Zn||t.value!==e)&&X1(t)}function et(e){return qe.type===Zn&&qe.value===e}function $S(e){return qe.type===Ja&&qe.value===e}function Nxe(){const e=[];for(L=qe.start,hn("[");!et("]");)et(",")?(Qn(),e.push(null)):(e.push(vu()),et("]")||hn(","));return Qn(),Fxe(e)}function wP(){L=qe.start;const e=Qn();return e.type===Mh||e.type===yu?(e.octal&&je(e,dP),Lh(e)):AS(e.value)}function Rxe(){var e,t,n,i;if(L=qe.start,e=qe,e.type===mu)return n=wP(),hn(":"),i=vu(),xP("init",n,i);if(e.type===Dh||e.type===Zn)X1(e);else return t=wP(),hn(":"),i=vu(),xP("init",t,i)}function jxe(){var e=[],t,n,i,r={},o=String;for(L=qe.start,hn("{");!et("}");)t=Rxe(),t.key.type===fP?n=t.key.name:n=o(t.key.value),i="$"+n,Object.prototype.hasOwnProperty.call(r,i)?je({},hxe):r[i]=!0,e.push(t),et("}")||hn(",");return hn("}"),Mxe(e)}function Lxe(){hn("(");const e=SS();return hn(")"),e}const Pxe={if:1};function Ixe(){var e,t,n;if(et("("))return Lxe();if(et("["))return Nxe();if(et("{"))return jxe();if(e=qe.type,L=qe.start,e===mu||Pxe[qe.value])n=AS(Qn().value);else if(e===Mh||e===yu)qe.octal&&je(qe,dP),n=Lh(Qn());else{if(e===Ja)throw new Error(Th);e===W1?(t=Qn(),t.value=t.value==="true",n=Lh(t)):e===G1?(t=Qn(),t.value=null,n=Lh(t)):et("/")||et("/=")?(n=Lh(Oxe()),yP()):X1(Qn())}return n}function Bxe(){const e=[];if(hn("("),!et(")"))for(;L<dn&&(e.push(vu()),!et(")"));)hn(",");return hn(")"),e}function zxe(){L=qe.start;const e=Qn();return Cxe(e)||X1(e),AS(e.value)}function Uxe(){return hn("."),zxe()}function qxe(){hn("[");const e=SS();return hn("]"),e}function Hxe(){var e,t,n;for(e=Ixe();;)if(et("."))n=Uxe(),e=bP(".",e,n);else if(et("("))t=Bxe(),e=kxe(e,t);else if(et("["))n=qxe(),e=bP("[",e,n);else break;return e}function EP(){const e=Hxe();if(qe.type===Zn&&(et("++")||et("--")))throw new Error(Th);return e}function K1(){var e,t;if(qe.type!==Zn&&qe.type!==Ja)t=EP();else{if(et("++")||et("--"))throw new Error(Th);if(et("+")||et("-")||et("~")||et("!"))e=Qn(),t=K1(),t=Txe(e.value,t);else{if($S("delete")||$S("void")||$S("typeof"))throw new Error(Th);t=EP()}}return t}function _P(e){let t=0;if(e.type!==Zn&&e.type!==Ja)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function Wxe(){var e,t,n,i,r,o,a,s,u,l;if(e=qe,u=K1(),i=qe,r=_P(i),r===0)return u;for(i.prec=r,Qn(),t=[e,qe],a=K1(),o=[u,i,a];(r=_P(qe))>0;){for(;o.length>2&&r<=o[o.length-2].prec;)a=o.pop(),s=o.pop().value,u=o.pop(),t.pop(),n=vP(s,u,a),o.push(n);i=Qn(),i.prec=r,o.push(i),t.push(qe),n=K1(),o.push(n)}for(l=o.length-1,n=o[l],t.pop();l>1;)t.pop(),n=vP(o[l-1].value,o[l-2],n),l-=2;return n}function vu(){var e,t,n;return e=Wxe(),et("?")&&(Qn(),t=vu(),hn(":"),n=vu(),e=Dxe(e,t,n)),e}function SS(){const e=vu();if(et(","))throw new Error(Th);return e}function Gxe(e){Z=e,L=0,dn=Z.length,qe=null,yP();const t=SS();if(qe.type!==Dh)throw new Error("Unexpect token after expression.");return t}function OS(e){const t=[];return e.type==="Identifier"?[e.name]:e.type==="Literal"?[e.value]:(e.type==="MemberExpression"&&(t.push(...OS(e.object)),t.push(...OS(e.property))),t)}function AP(e){return e.object.type==="MemberExpression"?AP(e.object):e.object.name==="datum"}function $P(e){const t=Gxe(e),n=new Set;return t.visit(i=>{i.type==="MemberExpression"&&AP(i)&&n.add(OS(i).slice(1).join("."))}),n}class dc extends Ge{constructor(t,n,i){super(t);this.model=n,this.filter=i,this.expr=J1(this.model,this.filter,this),this._dependentFields=$P(this.expr)}clone(){return new dc(null,this.model,de(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function Yxe(e,t){var n;const i={},r=e.config.selection;if(!t||!t.length)return i;for(const o of t){const a=nt(o.name),s=o.select,u=fe(s)?s:s.type,l=Ve(s)?de(s):{type:u},c=r[u];for(const d in c)d==="fields"||d==="encodings"||(d==="mark"&&(l[d]=Object.assign(Object.assign({},c[d]),l[d])),(l[d]===void 0||l[d]===!0)&&(l[d]=(n=c[d])!==null&&n!==void 0?n:l[d]));const f=i[a]=Object.assign(Object.assign({},l),{name:a,type:u,init:o.value,bind:o.bind,events:fe(l.on)?sc(l.on,"scope"):ft(de(l.on))});for(const d of H1)d.defined(f)&&d.parse&&d.parse(e,f,o)}return i}function SP(e,t,n,i="datum"){const r=fe(t)?t:t.param,o=nt(r),a=ke(o+pu);let s;try{s=e.getSelectionComponent(o,r)}catch(c){return`!!${o}`}if(s.project.timeUnit){const c=n!=null?n:e.component.data.raw,f=s.project.timeUnit.clone();c.parent?f.insertAsParentOf(c):c.parent=f}const u=`vlSelectionTest(${a}, ${i}${s.resolve==="global"?")":`, ${ke(s.resolve)})`}`,l=`length(data(${a}))`;return t.empty===!1?`${l} && ${u}`:`!${l} || ${u}`}function OP(e,t,n){const i=nt(t),r=n.encoding;let o=n.field,a;try{a=e.getSelectionComponent(i,t)}catch(s){return i}if(!r&&!o)o=a.project.items[0].field,a.project.items.length>1&&U(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${ke(o)}.`);else if(r&&!o){const s=a.project.items.filter(u=>u.channel===r);!s.length||s.length>1?(o=a.project.items[0].field,U((s.length?"Multiple ":"No ")+`matching ${ke(r)} encoding found for selection ${ke(n.param)}. Using "field": ${ke(o)}.`)):o=s[0].field}return`${a.name}[${ke(Ti(o))}]`}function Vxe(e,t){var n;for(const[i,r]of Da((n=e.component.selection)!==null&&n!==void 0?n:{})){const o=e.getName(`lookup_${i}`);e.component.data.outputNodes[o]=r.materialized=new Tn(new dc(t,e,{param:i}),o,Ze.Lookup,e.component.data.outputNodeRefCounts)}}function J1(e,t,n){return lh(t,i=>fe(i)?i:e1e(i)?SP(e,i,n):Z7(i))}var Z1=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function Xxe(e,t){if(!!e)return J(e)&&!Ba(e)?e.map(n=>I$(n,t)).join(", "):e}function CS(e,t,n,i){var r,o,a,s,u;(r=e.encode)!==null&&r!==void 0||(e.encode={}),(o=(s=e.encode)[t])!==null&&o!==void 0||(s[t]={}),(a=(u=e.encode[t]).update)!==null&&a!==void 0||(u.update={}),e.encode[t].update[n]=i}function Ph(e,t,n,i={header:!1}){var r,o;const a=e.combine(),{disable:s,orient:u,scale:l,labelExpr:c,title:f,zindex:d}=a,h=Z1(a,["disable","orient","scale","labelExpr","title","zindex"]);if(!s){for(const g in h){const p=uye[g],m=h[g];if(p&&p!==t&&p!=="both")delete h[g];else if(_h(m)){const{condition:y}=m,v=Z1(m,["condition"]),b=ft(y),x=Nj[g];if(x){const{vgProp:w,part:_}=x,E=[...b.map($=>{const{test:O}=$,C=Z1($,["test"]);return Object.assign({test:J1(null,O)},C)}),v];CS(h,_,w,E),delete h[g]}else if(x===null){const w={signal:b.map(_=>{const{test:E}=_,$=Z1(_,["test"]);return`${J1(null,E)} ? ${_7($)} : `}).join("")+_7(v)};h[g]=w}}else if(ie(m)){const y=Nj[g];if(y){const{vgProp:v,part:b}=y;CS(h,b,v,m),delete h[g]}}ye(["labelAlign","labelBaseline"],g)&&h[g]===null&&delete h[g]}if(t==="grid"){if(!h.grid)return;if(h.encode){const{grid:g}=h.encode;h.encode=Object.assign({},g?{grid:g}:{}),We(h.encode)&&delete h.encode}return Object.assign(Object.assign({scale:l,orient:u},h),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:vt(d,0)})}else{if(!i.header&&e.mainExtracted)return;if(c!==void 0){let p=c;((o=(r=h.encode)===null||r===void 0?void 0:r.labels)===null||o===void 0?void 0:o.update)&&ie(h.encode.labels.update.text)&&(p=iu(c,"datum.label",h.encode.labels.update.text.signal)),CS(h,"labels","text",{signal:p})}if(h.labelAlign===null&&delete h.labelAlign,h.encode){for(const p of Rj)e.hasAxisPart(p)||delete h.encode[p];We(h.encode)&&delete h.encode}const g=Xxe(f,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:l,orient:u,grid:!1},g?{title:g}:{}),h),n.aria===!1?{aria:!1}:{}),{zindex:vt(d,0)})}}}function CP(e){const{axes:t}=e.component,n=[];for(const i of Zr)if(t[i]){for(const r of t[i])if(!r.get("disable")&&!r.get("gridScale")){const o=i==="x"?"height":"width",a=e.getSizeSignalRef(o).signal;o!==a&&n.push({name:o,update:a})}}return n}function Kxe(e,t){const{x:n=[],y:i=[]}=e;return[...n.map(r=>Ph(r,"grid",t)),...i.map(r=>Ph(r,"grid",t)),...n.map(r=>Ph(r,"main",t)),...i.map(r=>Ph(r,"main",t))].filter(r=>r)}function FP(e,t,n,i){return Object.assign.apply(null,[{},...e.map(r=>{if(r==="axisOrient"){const o=n==="x"?"bottom":"left",a=t[n==="x"?"axisBottom":"axisLeft"]||{},s=t[n==="x"?"axisTop":"axisRight"]||{},u=new Set([...z(a),...z(s)]),l={};for(const c of u.values())l[c]={signal:`${i.signal} === "${o}" ? ${Uo(a[c])} : ${Uo(s[c])}`};return l}return t[r]})])}function Jxe(e,t,n,i){const r=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:f1e(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[],o=e==="x"?"axisX":"axisY",a=ie(n)?"axisOrient":`axis${ch(n)}`,s=[...r,...r.map(l=>o+l.substr(4))],u=["axis",a,o];return{vlOnlyAxisConfig:FP(s,i,e,n),vgAxisConfig:FP(u,i,e,n),axisConfigStyle:Zxe([...u,...s],i)}}function Zxe(e,t){var n;const i=[{}];for(const r of e){let o=(n=t[r])===null||n===void 0?void 0:n.style;if(o){o=ft(o);for(const a of o)i.push(t.style[a])}}return Object.assign.apply(null,i)}function FS(e,t,n,i={}){var r;const o=$7(e,n,t);if(o!==void 0)return{configFrom:"style",configValue:o};for(const a of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(((r=i[a])===null||r===void 0?void 0:r[e])!==void 0)return{configFrom:a,configValue:i[a][e]};return{}}const kP={scale:({model:e,channel:t})=>e.scaleName(t),format:({fieldOrDatumDef:e,config:t,axis:n})=>{const{format:i,formatType:r}=n;return pj(e,e.type,i,r,t,!0)},formatType:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:i}=e;return mj(i,t,n)},grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>{var i;return(i=t.grid)!==null&&i!==void 0?i:Qxe(n,e)},gridScale:({model:e,channel:t})=>e2e(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelAlign||MP(t,n,i),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelBaseline||DP(t,n,i),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>{var i;return(i=e.labelFlush)!==null&&i!==void 0?i:n2e(t.type,n)},labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{var i;return(i=e.labelOverlap)!==null&&i!==void 0?i:i2e(t.type,n,Y(t)&&!!t.timeUnit,Y(t)?t.sort:void 0)},orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:i,scaleType:r})=>{var o;const a=e==="x"?"width":e==="y"?"height":void 0,s=a?t.getSizeSignalRef(a):void 0;return(o=n.tickCount)!==null&&o!==void 0?o:o2e({fieldOrDatumDef:i,scaleType:r,size:s,values:n.values})},title:({axis:e,model:t,channel:n})=>{if(e.title!==void 0)return e.title;const i=TP(t,n);if(i!==void 0)return i;const r=t.typedFieldDef(n),o=n==="x"?"x2":"y2",a=t.fieldDef(o);return O7(r?[_j(r)]:[],Y(a)?[_j(a)]:[])},values:({axis:e,fieldOrDatumDef:t})=>a2e(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>{var i;return(i=e.zindex)!==null&&i!==void 0?i:s2e(n,t)}};function Qxe(e,t){return!cn(e)&&Y(t)&&!Je(t==null?void 0:t.bin)&&!kn(t==null?void 0:t.bin)}function e2e(e,t){const n=t==="x"?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function t2e(e,t,n,i,r){const o=t==null?void 0:t.labelAngle;if(o!==void 0)return ie(o)?o:fh(o);{const{configValue:a}=FS("labelAngle",i,t==null?void 0:t.style,r);return a!==void 0?fh(a):n===at&&ye([E$,w$],e.type)&&!(Y(e)&&e.timeUnit)?270:void 0}}function kS(e){return`(((${e.signal} % 360) + 360) % 360)`}function DP(e,t,n,i){if(e!==void 0)if(n==="x"){if(ie(e)){const r=kS(e),o=ie(t)?`(${t.signal} === "top")`:t==="top";return{signal:`(45 < ${r} && ${r} < 135) || (225 < ${r} && ${r} < 315) ? "middle" :(${r} <= 45 || 315 <= ${r}) === ${o} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(ie(t)){const r=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${r} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==(t==="top")?"bottom":"top"}else{if(ie(e)){const r=kS(e),o=ie(t)?`(${t.signal} === "left")`:t==="left";return{signal:`${r} <= 45 || 315 <= ${r} || (135 <= ${r} && ${r} <= 225) ? ${i?'"middle"':"null"} : (45 <= ${r} && ${r} <= 135) === ${o} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return i?"middle":null;if(ie(t)){const r=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${r} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==(t==="left")?"top":"bottom"}}function MP(e,t,n){if(e===void 0)return;const i=n==="x",r=i?0:90,o=i?"bottom":"left";if(ie(e)){const a=kS(e),s=ie(t)?`(${t.signal} === "${o}")`:t===o;return{signal:`(${r?`(${a} + 90)`:a} % 180 === 0) ? ${i?null:'"center"'} :(${r} < ${a} && ${a} < ${180+r}) === ${s} ? "left" : "right"`}}if((e+r)%180==0)return i?null:"center";if(ie(t)){const a=r<e&&e<180+r?"===":"!==";return{signal:`${`${t.signal} ${a} "${o}"`} ? "left" : "right"`}}return(r<e&&e<180+r)==(t===o)?"left":"right"}function n2e(e,t){if(t==="x"&&ye(["quantitative","temporal"],e))return!0}function i2e(e,t,n,i){if(n&&!Ve(i)||e!=="nominal"&&e!=="ordinal")return t==="log"||t==="symlog"?"greedy":!0}function r2e(e){return e==="x"?"bottom":"left"}function o2e({fieldOrDatumDef:e,scaleType:t,size:n,values:i}){var r;if(!i&&!cn(t)&&t!=="log"){if(Y(e)){if(Je(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&ye(["month","hours","day","quarter"],(r=Dn(e.timeUnit))===null||r===void 0?void 0:r.unit))return}return{signal:`ceil(${n.signal}/40)`}}}function TP(e,t){const n=t==="x"?"x2":"y2",i=e.fieldDef(t),r=e.fieldDef(n),o=i?i.title:void 0,a=r?r.title:void 0;if(o&&a)return C7(o,a);if(o)return o;if(a)return a;if(o!==void 0)return o;if(a!==void 0)return a}function a2e(e,t){const n=e.values;if(J(n))return Tj(t,n);if(ie(n))return n}function s2e(e,t){return e==="rect"&&A1(t)?1:0}class hc extends Ge{constructor(t,n){super(t);this.transform=n,this._dependentFields=$P(this.transform.calculate)}clone(){return new hc(null,de(this.transform))}static parseAllForSortIndex(t,n){return n.forEachFieldDef((i,r)=>{if(!!hu(i)&&Ej(i.sort)){const{field:o,timeUnit:a}=i,s=i.sort,u=s.map((l,c)=>`${Z7({field:o,timeUnit:a,equal:l})} ? ${c} : `).join("")+s.length;t=new hc(t,{calculate:u,as:gc(i,r,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${_e(this.transform)}`}}function gc(e,t,n){return G(e,Object.assign({prefix:t,suffix:"sort_index"},n!=null?n:{}))}function Q1(e,t){return ye(["top","bottom"],t)?"column":ye(["left","right"],t)||e==="row"?"row":"column"}function pc(e,t,n,i){const r=i==="row"?n.headerRow:i==="column"?n.headerColumn:n.headerFacet;return vt((t||{})[e],r[e],n.header[e])}function ey(e,t,n,i){const r={};for(const o of e){const a=pc(o,t||{},n,i);a!==void 0&&(r[o]=a)}return r}const DS=["row","column"],MS=["header","footer"];function u2e(e,t){const n=e.component.layoutHeaders[t].title,i=e.config?e.config:void 0,r=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:o,titleAngle:a,titleOrient:s}=ey(["titleAnchor","titleAngle","titleOrient"],r.header,i,t),u=Q1(t,s),l=fh(a);return{name:`${t}-title`,type:"group",role:`${u}-title`,title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},t==="row"?{orient:"left"}:{}),{style:"guide-title"}),RP(l,u)),NP(u,l,o)),jP(i,r,t,Dye,eL))}}function NP(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const i=MP(t,e==="row"?"left":"top",e==="row"?"y":"x");return i?{align:i}:{}}function RP(e,t){const n=DP(e,t==="row"?"left":"top",t==="row"?"y":"x",!0);return n?{baseline:n}:{}}function l2e(e,t){const n=e.component.layoutHeaders[t],i=[];for(const r of MS)if(n[r])for(const o of n[r]){const a=f2e(e,t,r,n,o);a!=null&&i.push(a)}return i}function c2e(e,t){var n;const{sort:i}=e;return no(i)?{field:G(i,{expr:"datum"}),order:(n=i.order)!==null&&n!==void 0?n:"ascending"}:J(i)?{field:gc(e,t,{expr:"datum"}),order:"ascending"}:{field:G(e,{expr:"datum"}),order:i!=null?i:"ascending"}}function TS(e,t,n){const{format:i,formatType:r,labelAngle:o,labelAnchor:a,labelOrient:s,labelExpr:u}=ey(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e.header,n,t),l=k$({fieldOrDatumDef:e,format:i,formatType:r,expr:"parent",config:n}).signal,c=Q1(t,s);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:u?iu(iu(u,"datum.label",l),"datum.value",G(e,{expr:"parent"})):l}},t==="row"?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),RP(o,c)),NP(c,o,a)),jP(n,e,t,Mye,tL))}function f2e(e,t,n,i,r){if(r){let o=null;const{facetFieldDef:a}=i,s=e.config?e.config:void 0;if(a&&r.labels){const{labelOrient:f}=ey(["labelOrient"],a.header,s,t);(t==="row"&&!ye(["top","bottom"],f)||t==="column"&&!ye(["left","right"],f))&&(o=TS(a,t,s))}const u=pr(e)&&!wh(e.facet),l=r.axes,c=(l==null?void 0:l.length)>0;if(o||c){const f=t==="row"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`},i.facetFieldDef?{from:{data:e.getName(`${t}_domain`)},sort:c2e(a,t)}:{}),c&&u?{from:{data:e.getName(`facet_domain_${t}`)}}:{}),o?{title:o}:{}),r.sizeSignal?{encode:{update:{[f]:r.sizeSignal}}}:{}),c?{axes:l}:{})}}return null}const d2e={column:{start:0,end:1},row:{start:1,end:0}};function h2e(e,t){return d2e[t][e]}function g2e(e,t){const n={};for(const i of Ri){const r=e[i];if(r==null?void 0:r.facetFieldDef){const{titleAnchor:o,titleOrient:a}=ey(["titleAnchor","titleOrient"],r.facetFieldDef.header,t,i),s=Q1(i,a),u=h2e(o,s);u!==void 0&&(n[s]=u)}}return We(n)?void 0:n}function jP(e,t,n,i,r){const o={};for(const a of i){if(!r[a])continue;const s=pc(a,t==null?void 0:t.header,e,n);s!==void 0&&(o[r[a]]=s)}return o}function NS(e){return[...ty(e,"width"),...ty(e,"height"),...ty(e,"childWidth"),...ty(e,"childHeight")]}function ty(e,t){const n=t==="width"?"x":"y",i=e.component.layoutSize.get(t);if(!i||i==="merged")return[];const r=e.getSizeSignalRef(t).signal;if(i==="step"){const o=e.getScaleComponent(n);if(o){const a=o.get("type"),s=o.get("range");if(cn(a)&&za(s)){const u=e.scaleName(n);return pr(e.parent)&&e.parent.component.resolve.scale[n]==="independent"?[LP(u,s)]:[LP(u,s),{name:r,update:PP(u,o,`domain('${u}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(i=="container"){const o=r.endsWith("width"),a=o?"containerSize()[0]":"containerSize()[1]",s=eS(e.config.view,o?"width":"height"),u=`isFinite(${a}) ? ${a} : ${s}`;return[{name:r,init:u,on:[{update:u,events:"window:resize"}]}]}else return[{name:r,value:i}]}function LP(e,t){return{name:`${e}_step`,value:t.step}}function PP(e,t,n){const i=t.get("type"),r=t.get("padding"),o=vt(t.get("paddingOuter"),r);let a=t.get("paddingInner");return a=i==="band"?a!==void 0?a:r:1,`bandspace(${n}, ${Uo(a)}, ${Uo(o)}) * ${e}_step`}function IP(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function BP(e,t){return z(e).reduce((n,i)=>{const r=e[i];return Object.assign(Object.assign({},n),cc(t,r,i,o=>it(o.value)))},{})}function zP(e,t){if(pr(t))return e==="theta"?"independent":"shared";if(vc(t))return"shared";if(KS(t))return Qr(e)||e==="theta"||e==="radius"?"independent":"shared";throw new Error("invalid model type for resolve")}function RS(e,t){const n=e.scale[t],i=Qr(t)?"axis":"legend";return n==="independent"?(e[i][t]==="shared"&&U(_me(t)),"independent"):e[i][t]||"shared"}const p2e=Object.assign(Object.assign({},Rye),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),UP=z(p2e);class m2e extends Wo{}const qP={symbols:y2e,gradient:v2e,labels:b2e,entries:x2e};function y2e(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r,legendType:o}){var a,s,u,l,c,f,d,h;if(o!=="symbol")return;const{markDef:g,encoding:p,config:m,mark:y}=n,v=g.filled&&y!=="trail";let b=Object.assign(Object.assign({},jpe({},n,M1e)),YL(n,{filled:v}));const x=(a=r.get("symbolOpacity"))!==null&&a!==void 0?a:m.legend.symbolOpacity,w=(s=r.get("symbolFillColor"))!==null&&s!==void 0?s:m.legend.symbolFillColor,_=(u=r.get("symbolStrokeColor"))!==null&&u!==void 0?u:m.legend.symbolStrokeColor,E=x===void 0?(l=HP(p.opacity))!==null&&l!==void 0?l:g.opacity:void 0;if(b.fill){if(i==="fill"||v&&i===Xn)delete b.fill;else if(b.fill.field)w?delete b.fill:(b.fill=it((c=m.legend.symbolBaseFillColor)!==null&&c!==void 0?c:"black"),b.fillOpacity=it(E!=null?E:1));else if(J(b.fill)){const $=(h=(d=jS((f=p.fill)!==null&&f!==void 0?f:p.color))!==null&&d!==void 0?d:g.fill)!==null&&h!==void 0?h:v&&g.color;$&&(b.fill=it($))}}if(b.stroke){if(i==="stroke"||!v&&i===Xn)delete b.stroke;else if(b.stroke.field||_)delete b.stroke;else if(J(b.stroke)){const $=vt(jS(p.stroke||p.color),g.stroke,v?g.color:void 0);$&&(b.stroke={value:$})}}if(i!==Po){const $=Y(t)&&GP(n,r,t);$?b.opacity=[Object.assign({test:$},it(E!=null?E:1)),it(m.legend.unselectedOpacity)]:E&&(b.opacity=it(E))}return b=Object.assign(Object.assign({},b),e),We(b)?void 0:b}function v2e(e,{model:t,legendType:n,legendCmpt:i}){var r;if(n!=="gradient")return;const{config:o,markDef:a,encoding:s}=t;let u={};const c=((r=i.get("gradientOpacity"))!==null&&r!==void 0?r:o.legend.gradientOpacity)===void 0?HP(s.opacity)||a.opacity:void 0;return c&&(u.opacity=it(c)),u=Object.assign(Object.assign({},u),e),We(u)?void 0:u}function b2e(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r}){const o=n.legend(i)||{},a=n.config,s=Y(t)?GP(n,r,t):void 0,u=s?[{test:s,value:1},{value:a.legend.unselectedOpacity}]:void 0,{format:l,formatType:c}=o,f=du(c)?D$({fieldOrDatumDef:t,field:"datum.value",format:l,formatType:c,config:a}):void 0,d=Object.assign(Object.assign(Object.assign({},u?{opacity:u}:{}),f?{text:f}:{}),e);return We(d)?void 0:d}function x2e(e,{legendCmpt:t}){const n=t.get("selections");return(n==null?void 0:n.length)?Object.assign(Object.assign({},e),{fill:{value:"transparent"}}):e}function HP(e){return WP(e,(t,n)=>Math.max(t,n.value))}function jS(e){return WP(e,(t,n)=>vt(t,n.value))}function WP(e,t){if(K1e(e))return ft(e.condition).reduce(t,e.value);if(fr(e))return e.value}function GP(e,t,n){const i=t.get("selections");if(!(i==null?void 0:i.length))return;const r=ke(n.field);return i.map(o=>`(!length(data(${ke(nt(o)+pu)})) || (${o}[${r}] && indexof(${o}[${r}], datum.value) >= 0))`).join(" || ")}const YP={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:i,formatType:r}=t;return pj(e,e.type,i,r,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:i}=e;return mj(i,t,n)},gradientLength:e=>{var t,n;const{legend:i,legendConfig:r}=e;return(n=(t=i.gradientLength)!==null&&t!==void 0?t:r.gradientLength)!==null&&n!==void 0?n:O2e(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>{var i,r;return(r=(i=e.labelOverlap)!==null&&i!==void 0?i:t.labelOverlap)!==null&&r!==void 0?r:C2e(n)},symbolType:({legend:e,markDef:t,channel:n,encoding:i})=>{var r;return(r=e.symbolType)!==null&&r!==void 0?r:E2e(t.type,n,i.shape,t.shape)},title:({fieldOrDatumDef:e,config:t})=>nc(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(Jl(n)&&cr(t)){if(e==="gradient")return}else if(e==="symbol")return;return e},values:({fieldOrDatumDef:e,legend:t})=>w2e(t,e)};function w2e(e,t){const n=e.values;if(J(n))return Tj(t,n);if(ie(n))return n}function E2e(e,t,n,i){var r;if(t!=="shape"){const o=(r=jS(n))!==null&&r!==void 0?r:i;if(o)return o}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function _2e(e){const{legend:t}=e;return vt(t.type,A2e(e))}function A2e({channel:e,timeUnit:t,scaleType:n}){if(Jl(e)){if(ye(["quarter","month","day"],t))return"symbol";if(cr(n))return"gradient"}return"symbol"}function $2e({legendConfig:e,legendType:t,orient:n,legend:i}){var r,o;return(o=(r=i.direction)!==null&&r!==void 0?r:e[t?"gradientDirection":"symbolDirection"])!==null&&o!==void 0?o:S2e(n,t)}function S2e(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return t==="gradient"?"horizontal":void 0}}function O2e({legendConfig:e,model:t,direction:n,orient:i,scaleType:r}){const{gradientHorizontalMaxLength:o,gradientHorizontalMinLength:a,gradientVerticalMaxLength:s,gradientVerticalMinLength:u}=e;if(cr(r))return n==="horizontal"?i==="top"||i==="bottom"?VP(t,"width",a,o):a:VP(t,"height",u,s)}function VP(e,t,n,i){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${i})`}}function C2e(e){if(ye(["quantile","threshold","log","symlog"],e))return"greedy"}function XP(e){const t=bt(e)?F2e(e):T2e(e);return e.component.legends=t,t}function F2e(e){const{encoding:t}=e,n={};for(const i of[Xn,...iL]){const r=Ot(t[i]);!r||!e.getScaleComponent(i)||i===Kn&&Y(r)&&r.type===ec||(n[i]=M2e(e,i))}return n}function k2e(e,t){const n=e.scaleName(t);if(e.mark==="trail"){if(t==="color")return{stroke:n};if(t==="size")return{strokeWidth:n}}return t==="color"?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}function D2e(e,t,n,i){switch(t){case"disable":return n!==void 0;case"values":return!!(n==null?void 0:n.values);case"title":if(t==="title"&&e===(i==null?void 0:i.title))return!0}return e===(n||{})[t]}function M2e(e,t){var n,i,r;let o=e.legend(t);const{markDef:a,encoding:s,config:u}=e,l=u.legend,c=new m2e({},k2e(e,t));Tbe(e,t,c);const f=o!==void 0?!o:l.disable;if(c.set("disable",f,o!==void 0),f)return c;o=o||{};const d=e.getScaleComponent(t).get("type"),h=Ot(s[t]),g=Y(h)?(n=Dn(h.timeUnit))===null||n===void 0?void 0:n.unit:void 0,p=o.orient||u.legend.orient||"right",m=_2e({legend:o,channel:t,timeUnit:g,scaleType:d}),y=$2e({legend:o,legendType:m,orient:p,legendConfig:l}),v={legend:o,channel:t,model:e,markDef:a,encoding:s,fieldOrDatumDef:h,legendConfig:l,config:u,scaleType:d,orient:p,legendType:m,direction:y};for(const E of UP){if(m==="gradient"&&E.startsWith("symbol")||m==="symbol"&&E.startsWith("gradient"))continue;const $=E in YP?YP[E](v):o[E];if($!==void 0){const O=D2e($,E,o,e.fieldDef(t));(O||u.legend[E]===void 0)&&c.set(E,$,O)}}const b=(i=o==null?void 0:o.encoding)!==null&&i!==void 0?i:{},x=c.get("selections"),w={},_={fieldOrDatumDef:h,model:e,channel:t,legendCmpt:c,legendType:m};for(const E of["labels","legend","title","symbols","gradient","entries"]){const $=BP((r=b[E])!==null&&r!==void 0?r:{},e),O=E in qP?qP[E]($,_):$;O!==void 0&&!We(O)&&(w[E]=Object.assign(Object.assign(Object.assign({},(x==null?void 0:x.length)&&Y(h)?{name:`${nt(h.field)}_legend_${E}`}:{}),(x==null?void 0:x.length)?{interactive:!!x}:{}),{update:O}))}return We(w)||c.set("encode",w,!!(o==null?void 0:o.encoding)),c}function T2e(e){const{legends:t,resolve:n}=e.component;for(const i of e.children){XP(i);for(const r of z(i.component.legends))n.legend[r]=RS(e.component.resolve,r),n.legend[r]==="shared"&&(t[r]=KP(t[r],i.component.legends[r]),t[r]||(n.legend[r]="independent",delete t[r]))}for(const i of z(t))for(const r of e.children)!r.component.legends[i]||n.legend[i]==="shared"&&delete r.component.legends[i];return t}function KP(e,t){var n,i,r,o;if(!e)return t.clone();const a=e.getWithExplicit("orient"),s=t.getWithExplicit("orient");if(a.explicit&&s.explicit&&a.value!==s.value)return;let u=!1;for(const l of UP){const c=Ga(e.getWithExplicit(l),t.getWithExplicit(l),l,"legend",(f,d)=>{switch(l){case"symbolType":return N2e(f,d);case"title":return F7(f,d);case"type":return u=!0,vi("symbol")}return L1(f,d,l,"legend")});e.setWithExplicit(l,c)}return u&&(((i=(n=e.implicit)===null||n===void 0?void 0:n.encode)===null||i===void 0?void 0:i.gradient)&&Qm(e.implicit,["encode","gradient"]),((o=(r=e.explicit)===null||r===void 0?void 0:r.encode)===null||o===void 0?void 0:o.gradient)&&Qm(e.explicit,["encode","gradient"])),e}function N2e(e,t){return t.value==="circle"?t:e}var R2e=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function j2e(e,t,n,i){var r,o,a,s,u;(r=e.encode)!==null&&r!==void 0||(e.encode={}),(o=(s=e.encode)[t])!==null&&o!==void 0||(s[t]={}),(a=(u=e.encode[t]).update)!==null&&a!==void 0||(u.update={}),e.encode[t].update[n]=i}function JP(e){const t=e.component.legends,n={};for(const r of z(t)){const o=e.getScaleComponent(r),a=Ke(o.get("domains"));if(n[a])for(const s of n[a])KP(s,t[r])||n[a].push(t[r]);else n[a]=[t[r].clone()]}return ln(n).flat().map(r=>L2e(r,e.config)).filter(r=>r!==void 0)}function L2e(e,t){var n,i,r;const o=e.combine(),{disable:a,labelExpr:s,selections:u}=o,l=R2e(o,["disable","labelExpr","selections"]);if(!a){if(t.aria===!1&&l.aria==null&&(l.aria=!1),(n=l.encode)===null||n===void 0?void 0:n.symbols){const c=l.encode.symbols.update;c.fill&&c.fill.value!=="transparent"&&!c.stroke&&!l.stroke&&(c.stroke={value:"transparent"});for(const f of iL)l[f]&&delete c[f]}if(l.title||delete l.title,s!==void 0){let c=s;((r=(i=l.encode)===null||i===void 0?void 0:i.labels)===null||r===void 0?void 0:r.update)&&ie(l.encode.labels.update.text)&&(c=iu(s,"datum.label",l.encode.labels.update.text.signal)),j2e(l,"labels","text",{signal:c})}return l}}function P2e(e){return vc(e)||KS(e)?I2e(e):ZP(e)}function I2e(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),ZP(e))}function ZP(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:i}=n;if(t.data){const r={signal:`[${t.size.map(a=>a.signal).join(", ")}]`},o=t.data.reduce((a,s)=>{const u=ie(s)?s.signal:`data('${e.lookupDataSource(s)}')`;return ye(a,u)||a.push(u),a},[]);if(o.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:i,size:r,fit:{signal:o.length>1?`[${o.join(", ")}]`:o[0]}},n)]}else return[Object.assign(Object.assign({name:i},{translate:{signal:"[width / 2, height / 2]"}}),n)]}const B2e=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class QP extends Wo{constructor(t,n,i,r){super(Object.assign({},n),{name:t});this.specifiedProjection=n,this.size=i,this.data=r,this.merged=!1}get isFit(){return!!this.data}}function eI(e){e.component.projection=bt(e)?z2e(e):H2e(e)}function z2e(e){var t;if(e.hasProjection){const n=Jn(e.specifiedProjection),i=!(n&&(n.scale!=null||n.translate!=null)),r=i?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,o=i?U2e(e):void 0,a=new QP(e.projectionName(!0),Object.assign(Object.assign({},(t=Jn(e.config.projection))!==null&&t!==void 0?t:{}),n!=null?n:{}),r,o);return a.get("type")||a.set("type","equalEarth",!1),a}}function U2e(e){const t=[],{encoding:n}=e;for(const i of[[Xr,Vr],[Ni,lr]])(Ot(n[i[0]])||Ot(n[i[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(Kn)&&e.typedFieldDef(Kn).type===ec&&t.push({signal:e.getName(`geojson_${t.length}`)}),t.length===0&&t.push(e.requestDataName(Ze.Main)),t}function q2e(e,t){const n=WA(B2e,r=>!!(!Gl(e.explicit,r)&&!Gl(t.explicit,r)||Gl(e.explicit,r)&&Gl(t.explicit,r)&&Hr(e.get(r),t.get(r))));if(Hr(e.size,t.size)){if(n)return e;if(Hr(e.explicit,{}))return t;if(Hr(t.explicit,{}))return e}return null}function H2e(e){if(e.children.length===0)return;let t;for(const i of e.children)eI(i);const n=WA(e.children,i=>{const r=i.component.projection;if(r)if(t){const o=q2e(t,r);return o&&(t=o),!!o}else return t=r,!0;else return!0});if(t&&n){const i=e.projectionName(!0),r=new QP(i,t.specifiedProjection,t.size,de(t.data));for(const o of e.children){const a=o.component.projection;a&&(a.isFit&&r.data.push(...o.component.projection.data),o.renameProjection(a.get("name"),i),a.merged=!0)}return r}}var W2e=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function G2e(e,t,n,i){var r,o;if(Eh(t,n)){const a=bt(e)?(o=(r=e.axis(n))!==null&&r!==void 0?r:e.legend(n))!==null&&o!==void 0?o:{}:{},s=G(t,{expr:"datum"}),u=G(t,{expr:"datum",binSuffix:"end"});return{formulaAs:G(t,{binSuffix:"range",forAs:!0}),formula:v1(s,u,a.format,a.formatType,i)}}return{}}function tI(e,t){return`${v7(e)}_${t}`}function Y2e(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}function LS(e,t,n){var i;const r=(i=O1(n,void 0))!==null&&i!==void 0?i:{},o=tI(r,t);return e.getName(`${o}_bins`)}function V2e(e){return"as"in e}function nI(e,t,n){let i,r;V2e(e)?i=fe(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:i=[G(e,{forAs:!0}),G(e,{binSuffix:"end",forAs:!0})];const o=Object.assign({},O1(t,void 0)),a=tI(o,e.field),{signal:s,extentSignal:u}=Y2e(n,a);if(u1(o.extent)){const c=o.extent;r=OP(n,c.param,c),delete o.extent}const l=Object.assign(Object.assign(Object.assign({bin:o,field:e.field,as:[i]},s?{signal:s}:{}),u?{extentSignal:u}:{}),r?{span:r}:{});return{key:a,binComponent:l}}class uo extends Ge{constructor(t,n){super(t);this.bins=n}clone(){return new uo(null,de(this.bins))}static makeFromEncoding(t,n){const i=n.reduceFieldDef((r,o,a)=>{if(Li(o)&&Je(o.bin)){const{key:s,binComponent:u}=nI(o,o.bin,n);r[s]=Object.assign(Object.assign(Object.assign({},u),r[s]),G2e(n,o,a,n.config))}return r},{});return We(i)?null:new uo(t,i)}static makeFromTransform(t,n,i){const{key:r,binComponent:o}=nI(n,n.bin,i);return new uo(t,{[r]:o})}merge(t,n){for(const i of z(t.bins))i in this.bins?(n(t.bins[i].signal,this.bins[i].signal),this.bins[i].as=Wr([...this.bins[i].as,...t.bins[i].as],_e)):this.bins[i]=t.bins[i];for(const i of t.children)t.removeChild(i),i.parent=this;t.remove()}producedFields(){return new Set(ln(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(ln(this.bins).map(t=>t.field))}hash(){return`Bin ${_e(this.bins)}`}assemble(){return ln(this.bins).flatMap(t=>{const n=[],[i,...r]=t.as,o=t.bin,{extent:a}=o,s=W2e(o,["extent"]),u=Object.assign(Object.assign(Object.assign({type:"bin",field:Ti(t.field),as:i,signal:t.signal},u1(a)?{extent:null}:{extent:a}),t.span?{span:{signal:`span(${t.span})`}}:{}),s);!a&&t.extentSignal&&(n.push({type:"extent",field:Ti(t.field),signal:t.extentSignal}),u.extent={signal:t.extentSignal}),n.push(u);for(const l of r)for(let c=0;c<2;c++)n.push({type:"formula",expr:G({field:i[c]},{expr:"datum"}),as:l[c]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}}function X2e(e,t,n,i){var r;const o=bt(i)?i.encoding[Io(t)]:void 0;if(Li(n)&&bt(i)&&Sj(n,o,i.markDef,i.config))e.add(G(n,{})),e.add(G(n,{suffix:"end"})),n.bin&&Eh(n,t)&&e.add(G(n,{binSuffix:"range"}));else if(spe(t)){const a=ape(t);e.add(i.getName(a))}else e.add(G(n));return hu(n)&&w1e((r=n.scale)===null||r===void 0?void 0:r.range)&&e.add(n.scale.range.field),e}function K2e(e,t){var n;for(const i of z(t)){const r=t[i];for(const o of z(r))i in e?e[i][o]=new Set([...(n=e[i][o])!==null&&n!==void 0?n:[],...r[o]]):e[i]={[o]:r[o]}}}class hr extends Ge{constructor(t,n,i){super(t);this.dimensions=n,this.measures=i}clone(){return new hr(null,new Set(this.dimensions),de(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let i=!1;n.forEachFieldDef(a=>{a.aggregate&&(i=!0)});const r={},o=new Set;return!i||(n.forEachFieldDef((a,s)=>{var u,l,c,f;const{aggregate:d,field:h}=a;if(d)if(d==="count")(u=r["*"])!==null&&u!==void 0||(r["*"]={}),r["*"].count=new Set([G(a,{forAs:!0})]);else{if(Bo(d)||Ia(d)){const g=Bo(d)?"argmin":"argmax",p=d[g];(l=r[p])!==null&&l!==void 0||(r[p]={}),r[p][g]=new Set([G({op:g,field:p},{forAs:!0})])}else(c=r[h])!==null&&c!==void 0||(r[h]={}),r[h][d]=new Set([G(a,{forAs:!0})]);Pa(s)&&n.scaleDomain(s)==="unaggregated"&&((f=r[h])!==null&&f!==void 0||(r[h]={}),r[h].min=new Set([G({field:h,aggregate:"min"},{forAs:!0})]),r[h].max=new Set([G({field:h,aggregate:"max"},{forAs:!0})]))}else X2e(o,s,a,n)}),o.size+z(r).length===0)?null:new hr(t,o,r)}static makeFromTransform(t,n){var i,r,o;const a=new Set,s={};for(const u of n.aggregate){const{op:l,field:c,as:f}=u;l&&(l==="count"?((i=s["*"])!==null&&i!==void 0||(s["*"]={}),s["*"].count=new Set([f||G(u,{forAs:!0})])):((r=s[c])!==null&&r!==void 0||(s[c]={}),s[c][l]=new Set([f||G(u,{forAs:!0})])))}for(const u of(o=n.groupby)!==null&&o!==void 0?o:[])a.add(u);return a.size+z(s).length===0?null:new hr(t,a,s)}merge(t){return n7(this.dimensions,t.dimensions)?(K2e(this.measures,t.measures),!0):(Ime("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...z(this.measures)])}producedFields(){const t=new Set;for(const n of z(this.measures))for(const i of z(this.measures[n])){const r=this.measures[n][i];r.size===0?t.add(`${i}_${n}`):r.forEach(t.add,t)}return t}hash(){return`Aggregate ${_e({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],n=[],i=[];for(const o of z(this.measures))for(const a of z(this.measures[o]))for(const s of this.measures[o][a])i.push(s),t.push(a),n.push(o==="*"?null:Ti(o));return{type:"aggregate",groupby:[...this.dimensions].map(Ti),ops:t,fields:n,as:i}}}class mc extends Ge{constructor(t,n,i,r){super(t);this.model=n,this.name=i,this.data=r;for(const o of Ri){const a=n.facet[o];if(a){const{bin:s,sort:u}=a;this[o]=Object.assign({name:n.getName(`${o}_domain`),fields:[G(a),...Je(s)?[G(a,{binSuffix:"end"})]:[]]},no(u)?{sortField:u}:J(u)?{sortIndexField:gc(a,o)}:{})}}this.childModel=n.child}hash(){let t="Facet";for(const n of Ri)this[n]&&(t+=` ${n.charAt(0)}:${_e(this[n])}`);return t}get fields(){var t;const n=[];for(const i of Ri)((t=this[i])===null||t===void 0?void 0:t.fields)&&n.push(...this[i].fields);return n}dependentFields(){const t=new Set(this.fields);for(const n of Ri)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const n of Zr){const i=this.childModel.component.scales[n];if(i&&!i.merged){const r=i.get("type"),o=i.get("range");if(cn(r)&&za(o)){const a=iy(this.childModel,n),s=YS(a);s?t[n]=s:U(a$(n))}}}return t}assembleRowColumnHeaderData(t,n,i){const r={row:"y",column:"x",facet:void 0}[t],o=[],a=[],s=[];r&&i&&i[r]&&(n?(o.push(`distinct_${i[r]}`),a.push("max")):(o.push(i[r]),a.push("distinct")),s.push(`distinct_${i[r]}`));const{sortField:u,sortIndexField:l}=this[t];if(u){const{op:c=b1,field:f}=u;o.push(f),a.push(c),s.push(G(u,{forAs:!0}))}else l&&(o.push(l),a.push("max"),s.push(l));return{name:this[t].name,source:n!=null?n:this.data,transform:[Object.assign({type:"aggregate",groupby:this[t].fields},o.length?{fields:o,ops:a,as:s}:{})]}}assembleFacetHeaderData(t){var n,i;const{columns:r}=this.model.layout,{layoutHeaders:o}=this.model.component,a=[],s={};for(const c of DS){for(const f of MS){const d=(n=o[c]&&o[c][f])!==null&&n!==void 0?n:[];for(const h of d)if(((i=h.axes)===null||i===void 0?void 0:i.length)>0){s[c]=!0;break}}if(s[c]){const f=`length(data("${this.facet.name}"))`,d=c==="row"?r?{signal:`ceil(${f} / ${r})`}:1:r?{signal:`min(${f}, ${r})`}:{signal:f};a.push({name:`${this.facet.name}_${c}`,transform:[{type:"sequence",start:0,stop:d}]})}}const{row:u,column:l}=s;return(u||l)&&a.unshift(this.assembleRowColumnHeaderData("facet",null,t)),a}assemble(){var t,n;const i=[];let r=null;const o=this.getChildIndependentFieldsWithStep(),{column:a,row:s,facet:u}=this;if(a&&s&&(o.x||o.y)){r=`cross_${this.column.name}_${this.row.name}`;const l=[].concat((t=o.x)!==null&&t!==void 0?t:[],(n=o.y)!==null&&n!==void 0?n:[]),c=l.map(()=>"distinct");i.push({name:r,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:l,ops:c}]})}for(const l of[No,To])this[l]&&i.push(this.assembleRowColumnHeaderData(l,r,o));if(u){const l=this.assembleFacetHeaderData(o);l&&i.push(...l)}return i}}function iI(e){return e[0]==="'"&&e[e.length-1]==="'"||e[0]==='"'&&e[e.length-1]==='"'?e.slice(1,-1):e}function J2e(e,t){const n=XA(e);if(t==="number")return`toNumber(${n})`;if(t==="boolean")return`toBoolean(${n})`;if(t==="string")return`toString(${n})`;if(t==="date")return`toDate(${n})`;if(t==="flatten")return n;if(t.startsWith("date:")){const i=iI(t.slice(5,t.length));return`timeParse(${n},'${i}')`}else if(t.startsWith("utc:")){const i=iI(t.slice(4,t.length));return`utcParse(${n},'${i}')`}else return U(Xpe(t)),null}function Z2e(e){const t={};return Zm(e.filter,n=>{var i;if(J7(n)){let r=null;h$(n)?r=mi(n.equal):p$(n)?r=mi(n.lte):g$(n)?r=mi(n.lt):m$(n)?r=mi(n.gt):y$(n)?r=mi(n.gte):v$(n)?r=n.range[0]:b$(n)&&(r=((i=n.oneOf)!==null&&i!==void 0?i:n.in)[0]),r&&(lu(r)?t[n.field]="date":yt(r)?t[n.field]="number":fe(r)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}function Q2e(e){const t={};function n(i){rc(i)?t[i.field]="date":i.type==="quantitative"&&Spe(i.aggregate)?t[i.field]="number":Kl(i.field)>1?i.field in t||(t[i.field]="flatten"):hu(i)&&no(i.sort)&&Kl(i.sort.field)>1&&(i.sort.field in t||(t[i.sort.field]="flatten"))}if((bt(e)||pr(e))&&e.forEachFieldDef((i,r)=>{if(Li(i))n(i);else{const o=au(r),a=e.fieldDef(o);n(Object.assign(Object.assign({},i),{type:a.type}))}}),bt(e)){const{mark:i,markDef:r,encoding:o}=e;if(Ua(i)&&!e.encoding.order){const a=r.orient==="horizontal"?"y":"x",s=o[a];Y(s)&&s.type==="quantitative"&&!(s.field in t)&&(t[s.field]="number")}}return t}function ewe(e){const t={};if(bt(e)&&e.component.selection)for(const n of z(e.component.selection)){const i=e.component.selection[n];for(const r of i.project.items)!r.channel&&Kl(r.field)>1&&(t[r.field]="flatten")}return t}class gn extends Ge{constructor(t,n){super(t);this._parse=n}clone(){return new gn(null,de(this._parse))}hash(){return`Parse ${_e(this._parse)}`}static makeExplicit(t,n,i){var r;let o={};const a=n.data;return!Ya(a)&&((r=a==null?void 0:a.format)===null||r===void 0?void 0:r.parse)&&(o=a.format.parse),this.makeWithAncestors(t,o,{},i)}static makeWithAncestors(t,n,i,r){for(const s of z(i)){const u=r.getWithExplicit(s);u.value!==void 0&&(u.explicit||u.value===i[s]||u.value==="derived"||i[s]==="flatten"?delete i[s]:U(j7(s,i[s],u.value)))}for(const s of z(n)){const u=r.get(s);u!==void 0&&(u===n[s]?delete n[s]:U(j7(s,n[s],u)))}const o=new Wo(n,i);r.copyAll(o);const a={};for(const s of z(o.combine())){const u=o.get(s);u!==null&&(a[s]=u)}return z(a).length===0||r.parseNothing?null:new gn(t,a)}get parse(){return this._parse}merge(t){this._parse=Object.assign(Object.assign({},this._parse),t.parse),t.remove()}assembleFormatParse(){const t={};for(const n of z(this._parse)){const i=this._parse[n];Kl(n)===1&&(t[n]=i)}return t}producedFields(){return new Set(z(this._parse))}dependentFields(){return new Set(z(this._parse))}assembleTransforms(t=!1){return z(this._parse).filter(n=>t?Kl(n)>1:!0).map(n=>{const i=J2e(n,this._parse[n]);return i?{type:"formula",expr:i,as:KA(n)}:null}).filter(n=>n!==null)}}class Za extends Ge{clone(){return new Za(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([Ah])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:Ah}}}class Ih extends Ge{constructor(t,n){super(t);this.params=n}clone(){return new Ih(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${_e(this.params)}`}assemble(){return Object.assign({type:"graticule"},this.params===!0?{}:this.params)}}class Bh extends Ge{constructor(t,n){super(t);this.params=n}clone(){return new Bh(null,this.params)}dependentFields(){return new Set}producedFields(){var t;return new Set([(t=this.params.as)!==null&&t!==void 0?t:"data"])}hash(){return`Hash ${_e(this.params)}`}assemble(){return Object.assign({type:"sequence"},this.params)}}class bu extends Ge{constructor(t){super(null);t!=null||(t={name:"source"});let n;if(Ya(t)||(n=t.format?Object.assign({},pi(t.format,["parse"])):{}),Sh(t))this._data={values:t.values};else if(ac(t)){if(this._data={url:t.url},!n.type){let i=/(?:\.([^.]+))?$/.exec(t.url)[1];ye(["json","csv","tsv","dsv","topojson"],i)||(i="json"),n.type=i}}else NL(t)?this._data={values:[{type:"Sphere"}]}:(ML(t)||Ya(t))&&(this._data={});this._generator=Ya(t),t.name&&(this._name=t.name),n&&!We(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}var rI=function(e,t,n,i,r){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?r.call(e,n):r?r.value=n:t.set(e,n),n},twe=function(e,t,n,i){if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?i:n==="a"?i.call(e):i?i.value:t.get(e)},zh;function PS(e){return e instanceof bu||e instanceof Ih||e instanceof Bh}class IS{constructor(){zh.set(this,void 0),rI(this,zh,!1,"f")}setModified(){rI(this,zh,!0,"f")}get modifiedFlag(){return twe(this,zh,"f")}}zh=new WeakMap;class xu extends IS{getNodeDepths(t,n,i){i.set(t,n);for(const r of t.children)this.getNodeDepths(r,n+1,i);return i}optimize(t){const i=[...this.getNodeDepths(t,0,new Map).entries()].sort((r,o)=>o[1]-r[1]);for(const r of i)this.run(r[0]);return this.modifiedFlag}}class BS extends IS{optimize(t){this.run(t);for(const n of t.children)this.optimize(n);return this.modifiedFlag}}class nwe extends BS{mergeNodes(t,n){const i=n.shift();for(const r of n)t.removeChild(r),r.parent=i,r.remove()}run(t){const n=t.children.map(r=>r.hash()),i={};for(let r=0;r<n.length;r++)i[n[r]]===void 0?i[n[r]]=[t.children[r]]:i[n[r]].push(t.children[r]);for(const r of z(i))i[r].length>1&&(this.setModified(),this.mergeNodes(t,i[r]))}}class iwe extends BS{constructor(t){super();this.requiresSelectionId=t&&vS(t)}run(t){t instanceof Za&&(this.requiresSelectionId&&(PS(t.parent)||t.parent instanceof hr||t.parent instanceof gn)||(this.setModified(),t.remove()))}}class rwe extends IS{optimize(t){return this.run(t,new Set),this.modifiedFlag}run(t,n){let i=new Set;t instanceof ao&&(i=t.producedFields(),GA(i,n)&&(this.setModified(),t.removeFormulas(n),t.producedFields.length===0&&t.remove()));for(const r of t.children)this.run(r,new Set([...n,...i]))}}class owe extends BS{constructor(){super()}run(t){t instanceof Tn&&!t.isRequired()&&(this.setModified(),t.remove())}}class awe extends xu{run(t){if(!PS(t)&&!(t.numChildren()>1)){for(const n of t.children)if(n instanceof gn)if(t instanceof gn)this.setModified(),t.merge(n);else{if(VA(t.producedFields(),n.dependentFields()))continue;this.setModified(),n.swapWithParent()}}}}class swe extends xu{run(t){const n=[...t.children],i=t.children.filter(r=>r instanceof gn);if(t.numChildren()>1&&i.length>=1){const r={},o=new Set;for(const a of i){const s=a.parse;for(const u of z(s))u in r?r[u]!==s[u]&&o.add(u):r[u]=s[u]}for(const a of o)delete r[a];if(!We(r)){this.setModified();const a=new gn(t,r);for(const s of n){if(s instanceof gn)for(const u of z(r))delete s.parse[u];t.removeChild(s),s.parent=a,s instanceof gn&&z(s.parse).length===0&&s.remove()}}}}}class uwe extends xu{run(t){t instanceof Tn||t.numChildren()>0||t instanceof mc||t instanceof bu||(this.setModified(),t.remove())}}class lwe extends xu{run(t){const n=t.children.filter(r=>r instanceof ao),i=n.pop();for(const r of n)this.setModified(),i.merge(r)}}class cwe extends xu{run(t){const n=t.children.filter(r=>r instanceof hr),i={};for(const r of n){const o=_e(r.groupBy);o in i||(i[o]=[]),i[o].push(r)}for(const r of z(i)){const o=i[r];if(o.length>1){const a=o.pop();for(const s of o)a.merge(s)&&(t.removeChild(s),s.parent=a,s.remove(),this.setModified())}}}}class fwe extends xu{constructor(t){super();this.model=t}run(t){const n=!(PS(t)||t instanceof dc||t instanceof gn||t instanceof Za),i=[],r=[];for(const o of t.children)o instanceof uo&&(n&&!VA(t.producedFields(),o.dependentFields())?i.push(o):r.push(o));if(i.length>0){const o=i.pop();for(const a of i)o.merge(a,this.model.renameSignal.bind(this.model));this.setModified(),t instanceof uo?t.merge(o,this.model.renameSignal.bind(this.model)):o.swapWithParent()}if(r.length>1){const o=r.pop();for(const a of r)o.merge(a,this.model.renameSignal.bind(this.model));this.setModified()}}}class dwe extends xu{run(t){const n=[...t.children];if(!Xl(n,a=>a instanceof Tn)||t.numChildren()<=1)return;const r=[];let o;for(const a of n)if(a instanceof Tn){let s=a;for(;s.numChildren()===1;){const[u]=s.children;if(u instanceof Tn)s=u;else break}r.push(...s.children),o?(t.removeChild(a),a.parent=o.parent,o.parent.removeChild(o),o.parent=s,this.setModified()):o=s}else r.push(a);if(r.length){this.setModified();for(const a of r)a.parent.removeChild(a),a.parent=o}}}class wu extends Ge{constructor(t,n){super(t);this.transform=n}clone(){return new wu(null,de(this.transform))}addDimensions(t){this.transform.groupby=Wr(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:G(t)}hash(){return`JoinAggregateTransform ${_e(this.transform)}`}assemble(){const t=[],n=[],i=[];for(const o of this.transform.joinaggregate)n.push(o.op),i.push(this.getDefaultName(o)),t.push(o.field===void 0?null:o.field);const r=this.transform.groupby;return Object.assign({type:"joinaggregate",as:i,ops:n,fields:t},r!==void 0?{groupby:r}:{})}}function hwe(e){return e.stack.stackBy.reduce((t,n)=>{const i=n.fieldDef,r=G(i);return r&&t.push(r),t},[])}function gwe(e){return J(e)&&e.every(t=>fe(t))&&e.length>1}class Vo extends Ge{constructor(t,n){super(t);this._stack=n}clone(){return new Vo(null,de(this._stack))}static makeFromTransform(t,n){const{stack:i,groupby:r,as:o,offset:a="zero"}=n,s=[],u=[];if(n.sort!==void 0)for(const f of n.sort)s.push(f.field),u.push(vt(f.order,"ascending"));const l={field:s,order:u};let c;return gwe(o)?c=o:fe(o)?c=[o,`${o}_end`]:c=[`${n.stack}_start`,`${n.stack}_end`],new Vo(t,{stackField:i,groupby:r,offset:a,sort:l,facetby:[],as:c})}static makeFromEncoding(t,n){const i=n.stack,{encoding:r}=n;if(!i)return null;const{groupbyChannel:o,fieldChannel:a,offset:s,impute:u}=i;let l;if(o){const h=r[o];l=ro(h)}const c=hwe(n),f=n.encoding.order;let d;return J(f)||Y(f)?d=S7(f):d=c.reduce((h,g)=>(h.field.push(g),h.order.push(a==="y"?"descending":"ascending"),h),{field:[],order:[]}),new Vo(t,{dimensionFieldDef:l,stackField:n.vgField(a),facetby:[],stackby:c,sort:d,offset:s,impute:u,as:[n.vgField(a,{suffix:"start",forAs:!0}),n.vgField(a,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${_e(this._stack)}`}getGroupbyFields(){const{dimensionFieldDef:t,impute:n,groupby:i}=this._stack;return t?t.bin?n?[G(t,{binSuffix:"mid"})]:[G(t,{}),G(t,{binSuffix:"end"})]:[G(t)]:i!=null?i:[]}assemble(){const t=[],{facetby:n,dimensionFieldDef:i,stackField:r,stackby:o,sort:a,offset:s,impute:u,as:l}=this._stack;if(u&&i){const{bandPosition:c=.5,bin:f}=i;f&&t.push({type:"formula",expr:`${c}*`+G(i,{expr:"datum"})+`+${1-c}*`+G(i,{expr:"datum",binSuffix:"end"}),as:G(i,{binSuffix:"mid",forAs:!0})}),t.push({type:"impute",field:r,groupby:[...o,...n],key:G(i,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:r,sort:a,as:l,offset:s}),t}}class yc extends Ge{constructor(t,n){super(t);this.transform=n}clone(){return new yc(null,de(this.transform))}addDimensions(t){this.transform.groupby=Wr(this.transform.groupby.concat(t),n=>n)}dependentFields(){var t,n;const i=new Set;return((t=this.transform.groupby)!==null&&t!==void 0?t:[]).forEach(i.add,i),((n=this.transform.sort)!==null&&n!==void 0?n:[]).forEach(r=>i.add(r.field)),this.transform.window.map(r=>r.field).filter(r=>r!==void 0).forEach(i.add,i),i}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:G(t)}hash(){return`WindowTransform ${_e(this.transform)}`}assemble(){var t;const n=[],i=[],r=[],o=[];for(const d of this.transform.window)i.push(d.op),r.push(this.getDefaultName(d)),o.push(d.param===void 0?null:d.param),n.push(d.field===void 0?null:d.field);const a=this.transform.frame,s=this.transform.groupby;if(a&&a[0]===null&&a[1]===null&&i.every(d=>n$(d)))return Object.assign({type:"joinaggregate",as:r,ops:i,fields:n},s!==void 0?{groupby:s}:{});const u=[],l=[];if(this.transform.sort!==void 0)for(const d of this.transform.sort)u.push(d.field),l.push((t=d.order)!==null&&t!==void 0?t:"ascending");const c={field:u,order:l},f=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:o,as:r,ops:i,fields:n,sort:c},f!==void 0?{ignorePeers:f}:{}),s!==void 0?{groupby:s}:{}),a!==void 0?{frame:a}:{})}}function pwe(e){function t(n){if(!(n instanceof mc)){const i=n.clone();if(i instanceof Tn){const r=US+i.getSource();i.setSource(r),e.model.component.data.outputNodes[r]=i}else(i instanceof hr||i instanceof Vo||i instanceof yc||i instanceof wu)&&i.addDimensions(e.fields);for(const r of n.children.flatMap(t))r.parent=i;return[i]}return n.children.flatMap(t)}return t}function zS(e){if(e instanceof mc)if(e.numChildren()===1&&!(e.children[0]instanceof Tn)){const t=e.children[0];(t instanceof hr||t instanceof Vo||t instanceof yc||t instanceof wu)&&t.addDimensions(e.fields),t.swapWithParent(),zS(e)}else{const t=e.model.component.data.main;oI(t);const n=pwe(e),i=e.children.map(n).flat();for(const r of i)r.parent=t}else e.children.map(zS)}function oI(e){if(e instanceof Tn&&e.type===Ze.Main&&e.numChildren()===1){const t=e.children[0];t instanceof mc||(t.swapWithParent(),oI(e))}}const US="scale_",ny=5;function qS(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return!1;if(!qS(t.children))return!1}return!0}function gr(e,t){let n=!1;for(const i of t)n=e.optimize(i)||n;return n}function aI(e,t,n){let i=e.sources,r=!1;return r=gr(new owe,i)||r,r=gr(new iwe(t),i)||r,i=i.filter(o=>o.numChildren()>0),r=gr(new uwe,i)||r,i=i.filter(o=>o.numChildren()>0),n||(r=gr(new awe,i)||r,r=gr(new fwe(t),i)||r,r=gr(new rwe,i)||r,r=gr(new swe,i)||r,r=gr(new cwe,i)||r,r=gr(new lwe,i)||r,r=gr(new nwe,i)||r,r=gr(new dwe,i)||r),e.sources=i,r}function mwe(e,t){qS(e.sources);let n=0,i=0;for(let r=0;r<ny&&aI(e,t,!0);r++)n++;e.sources.map(zS);for(let r=0;r<ny&&aI(e,t,!1);r++)i++;qS(e.sources),Math.max(n,i)===ny&&U(`Maximum optimization runs(${ny}) reached.`)}class ei{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new ei(()=>t(n))}}var ywe=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function sI(e){bt(e)?vwe(e):bwe(e)}function vwe(e){const t=e.component.scales;for(const n of z(t)){const i=wwe(e,n);if(t[n].setWithExplicit("domains",i),_we(e,n),e.component.data.isFaceted){let o=e;for(;!pr(o)&&o.parent;)o=o.parent;if(o.component.resolve.scale[n]==="shared")for(const s of i.value)zo(s)&&(s.data=US+s.data.replace(US,""))}}}function bwe(e){for(const n of e.children)sI(n);const t=e.component.scales;for(const n of z(t)){let i,r=null;for(const o of e.children){const a=o.component.scales[n];if(a){i===void 0?i=a.getWithExplicit("domains"):i=Ga(i,a.getWithExplicit("domains"),"domains","scale",GS);const s=a.get("selectionExtent");r&&s&&r.param!==s.param&&U(Wpe),r=s}}t[n].setWithExplicit("domains",i),r&&t[n].set("selectionExtent",r,!0)}}function xwe(e,t,n,i){if(e==="unaggregated"){const{valid:r,reason:o}=uI(t,n);if(!r){U(o);return}}else if(e===void 0&&i.useUnaggregatedDomain){const{valid:r}=uI(t,n);if(r)return"unaggregated"}return e}function wwe(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:i}=e,r=xwe(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return r!==e.scaleDomain(t)&&(e.specifiedScales[t]=Object.assign(Object.assign({},e.specifiedScales[t]),{domain:r})),t==="x"&&Ot(i.x2)?Ot(i.x)?Ga(Qa(n,r,e,"x"),Qa(n,r,e,"x2"),"domain","scale",GS):Qa(n,r,e,"x2"):t==="y"&&Ot(i.y2)?Ot(i.y)?Ga(Qa(n,r,e,"y"),Qa(n,r,e,"y2"),"domain","scale",GS):Qa(n,r,e,"y2"):Qa(n,r,e,t)}function Ewe(e,t,n){return e.map(i=>({signal:`{data: ${C1(i,{timeUnit:n,type:t})}}`}))}function HS(e,t,n){var i;const r=(i=Dn(n))===null||i===void 0?void 0:i.unit;return t==="temporal"||r?Ewe(e,t,r):[e]}function Qa(e,t,n,i){const{encoding:r}=n,o=Ot(r[i]),{type:a}=o,s=o.timeUnit;if(x1e(t)){const f=Qa(e,void 0,n,i),d=HS(t.unionWith,a,s);return Go([...f.value,...d])}else{if(ie(t))return Go([t]);if(t&&t!=="unaggregated"&&!tj(t))return Go(HS(t,a,s))}const u=n.stack;if(u&&i===u.fieldChannel){if(u.offset==="normalize")return vi([[0,1]]);const f=n.requestDataName(Ze.Main);return vi([{data:f,field:n.vgField(i,{suffix:"start"})},{data:f,field:n.vgField(i,{suffix:"end"})}])}const l=Pa(i)&&Y(o)?Awe(n,i,e):void 0;if(qa(o)){const f=HS([o.datum],a,s);return vi(f)}const c=o;if(t==="unaggregated"){const f=n.requestDataName(Ze.Main),{field:d}=o;return vi([{data:f,field:G({field:d,aggregate:"min"})},{data:f,field:G({field:d,aggregate:"max"})}])}else if(Je(c.bin)){if(cn(e))return vi(e==="bin-ordinal"?[]:[{data:uh(l)?n.requestDataName(Ze.Main):n.requestDataName(Ze.Raw),field:n.vgField(i,Eh(c,i)?{binSuffix:"range"}:{}),sort:l===!0||!Ve(l)?{field:n.vgField(i,{}),op:"min"}:l}]);{const{bin:f}=c;if(Je(f)){const d=LS(n,c.field,f);return vi([new ei(()=>{const h=n.getSignalName(d);return`[${h}.start, ${h}.stop]`})])}else return vi([{data:n.requestDataName(Ze.Main),field:n.vgField(i,{})}])}}else if(c.timeUnit&&ye(["time","utc"],e)&&Sj(c,bt(n)?n.encoding[Io(i)]:void 0,n.markDef,n.config)){const f=n.requestDataName(Ze.Main);return vi([{data:f,field:n.vgField(i)},{data:f,field:n.vgField(i,{suffix:"end"})}])}else return vi(l?[{data:uh(l)?n.requestDataName(Ze.Main):n.requestDataName(Ze.Raw),field:n.vgField(i),sort:l}]:[{data:n.requestDataName(Ze.Main),field:n.vgField(i)}])}function WS(e,t){const{op:n,field:i,order:r}=e;return Object.assign(Object.assign({op:n!=null?n:t?"sum":b1},i?{field:Ti(i)}:{}),r?{order:r}:{})}function _we(e,t){var n;const i=e.component.scales[t],r=e.specifiedScales[t].domain,o=(n=e.fieldDef(t))===null||n===void 0?void 0:n.bin,a=tj(r)&&r,s=su(o)&&u1(o.extent)&&o.extent;(a||s)&&i.set("selectionExtent",a!=null?a:s,!0)}function Awe(e,t,n){if(!cn(n))return;const i=e.fieldDef(t),r=i.sort;if(Ej(r))return{op:"min",field:gc(i,t),order:"ascending"};const{stack:o}=e,a=o?[...o.groupbyField?[o.groupbyField]:[],...o.stackBy.map(s=>s.fieldDef.field)]:void 0;if(no(r)){const s=o&&!ye(a,r.field);return WS(r,s)}else if(wj(r)){const{encoding:s,order:u}=r,l=e.fieldDef(s),{aggregate:c,field:f}=l,d=o&&!ye(a,f);if(Bo(c)||Ia(c))return WS({field:G(l),order:u},d);if(n$(c)||!c)return WS({op:c,field:f,order:u},d)}else{if(r==="descending")return{op:"min",field:e.vgField(t),order:"descending"};if(ye(["ascending",void 0],r))return!0}}function uI(e,t){const{aggregate:n,type:i}=e;return n?fe(n)&&!Fpe[n]?{valid:!1,reason:mme(n)}:i==="quantitative"&&t==="log"?{valid:!1,reason:yme(e)}:{valid:!0}:{valid:!1,reason:pme(e)}}function GS(e,t,n,i){return e.explicit&&t.explicit&&U(Eme(n,i,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function $we(e){const t=Wr(e.map(a=>zo(a)?ywe(a,["sort"]):a),_e),n=Wr(e.map(a=>{if(zo(a)){const s=a.sort;return s!==void 0&&!uh(s)&&("op"in s&&s.op==="count"&&delete s.field,s.order==="ascending"&&delete s.order),s}}).filter(a=>a!==void 0),_e);if(t.length===0)return;if(t.length===1){const a=e[0];if(zo(a)&&n.length>0){let s=n[0];if(n.length>1)U(U7),s=!0;else if(Ve(s)&&"field"in s){const u=s.field;a.field===u&&(s=s.order?{order:s.order}:!0)}return Object.assign(Object.assign({},a),{sort:s})}return a}const i=Wr(n.map(a=>uh(a)||!("op"in a)||fe(a.op)&&a.op in Ape?a:(U(Ame(a)),!0)),_e);let r;i.length===1?r=i[0]:i.length>1&&(U(U7),r=!0);const o=Wr(e.map(a=>zo(a)?a.data:null),a=>a);return o.length===1&&o[0]!==null?Object.assign({data:o[0],fields:t.map(s=>s.field)},r?{sort:r}:{}):Object.assign({fields:t},r?{sort:r}:{})}function YS(e){if(zo(e)&&fe(e.field))return e.field;if(Dpe(e)){let t;for(const n of e.fields)if(zo(n)&&fe(n.field)){if(!t)t=n.field;else if(t!==n.field)return U($me),t}return U(Sme),t}else if(Mpe(e)){U(Ome);const t=e.fields[0];return fe(t)?t:void 0}}function iy(e,t){const i=e.component.scales[t].get("domains").map(r=>(zo(r)&&(r.data=e.lookupDataSource(r.data)),r));return $we(i)}var Swe=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function lI(e){return vc(e)||KS(e)?e.children.reduce((t,n)=>t.concat(lI(n)),cI(e)):cI(e)}function cI(e){return z(e.component.scales).reduce((t,n)=>{const i=e.component.scales[n];if(i.merged)return t;const r=i.combine(),{name:o,type:a,selectionExtent:s,domains:u,range:l,reverse:c}=r,f=Swe(r,["name","type","selectionExtent","domains","range","reverse"]),d=Owe(r.range,o,n,e),h=iy(e,n),g=s?ube(e,s,i,h):null;return t.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:o,type:a},h?{domain:h}:{}),g?{domainRaw:g}:{}),{range:d}),c!==void 0?{reverse:c}:{}),f)),t},[])}function Owe(e,t,n,i){if(Qr(n)){if(za(e))return{step:{signal:`${t}_step`}}}else if(Ve(e)&&zo(e))return Object.assign(Object.assign({},e),{data:i.lookupDataSource(e.data)});return e}class fI extends Wo{constructor(t,n){super({},{name:t});this.merged=!1,this.setWithExplicit("type",n)}domainDefinitelyIncludesZero(){return this.get("zero")!==!1?!0:Xl(this.get("domains"),t=>J(t)&&t.length===2&&t[0]<=0&&t[1]>=0)}}const Cwe=["range","scheme"];function dI(e){return e==="x"?"width":e==="y"?"height":void 0}function Fwe(e){const t=e.component.scales;for(const n of s1){const i=t[n];if(!i)continue;const r=kwe(n,e);i.setWithExplicit("range",r)}}function hI(e,t){const n=e.fieldDef(t);if(n==null?void 0:n.bin){const{bin:i,field:r}=n,o=dI(t),a=e.getName(o);if(Ve(i)&&i.binned&&i.step!==void 0)return new ei(()=>{const s=e.scaleName(t),u=`(domain("${s}")[1] - domain("${s}")[0]) / ${i.step}`;return`${e.getSignalName(a)} / (${u})`});if(Je(i)){const s=LS(e,r,i);return new ei(()=>{const u=e.getSignalName(s),l=`(${u}.stop - ${u}.start) / ${u}.step`;return`${e.getSignalName(a)} / (${l})`})}}}function kwe(e,t){const n=t.specifiedScales[e],{size:i}=t,o=t.getScaleComponent(e).get("type");for(const l of Cwe)if(n[l]!==void 0){const c=A$(o,l),f=nj(e,l);if(!c)U(B7(o,l,e));else if(f)U(f);else switch(l){case"range":{const d=n.range;if(J(d)){if(Qr(e))return Go(d.map(h=>{if(h==="width"||h==="height"){const g=t.getName(h),p=t.getSignalName.bind(t);return ei.fromName(p,g)}return h}))}else if(Ve(d))return Go({data:t.requestDataName(Ze.Main),field:d.field,sort:{op:"min",field:t.vgField(e)}});return Go(d)}case"scheme":return Go(Dwe(n[l]))}}if(e===at||e===$t){const l=e===at?"width":"height",c=i[l];if(oo(c)){if(cn(o))return Go({step:c.step});U(z7(l))}}const{rangeMin:a,rangeMax:s}=n,u=Mwe(e,t);return(a!==void 0||s!==void 0)&&A$(o,"rangeMin")&&J(u)&&u.length===2?Go([a!=null?a:u[0],s!=null?s:u[1]]):vi(u)}function Dwe(e){return b1e(e)?Object.assign({scheme:e.name},pi(e,["name"])):{scheme:e}}function Mwe(e,t){const{size:n,config:i,mark:r,encoding:o}=t,a=t.getSignalName.bind(t),{type:s}=Ot(o[e]),l=t.getScaleComponent(e).get("type"),{domain:c,domainMid:f}=t.specifiedScales[e];switch(e){case at:case $t:{if(ye(["point","band"],l)){if(e===at&&!n.width){const g=$h(i.view,"width");if(oo(g))return g}else if(e===$t&&!n.height){const g=$h(i.view,"height");if(oo(g))return g}}const d=dI(e),h=t.getName(d);return e===$t&&yi(l)?[ei.fromName(a,h),0]:[0,ei.fromName(a,h)]}case Lo:{const d=t.component.scales[e].get("zero"),h=gI(r,d,i),g=Rwe(r,n,t,i);return bh(l)?Nwe(h,g,Twe(l,i,c,e)):[h,g]}case ur:return[0,Math.PI*2];case ru:return[0,360];case Yr:return[0,new ei(()=>{const d=t.getSignalName("width"),h=t.getSignalName("height");return`min(${d},${h})/2`})];case Na:return[i.scale.minStrokeWidth,i.scale.maxStrokeWidth];case Ra:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case Kn:return"symbol";case Xn:case Kr:case Jr:return l==="ordinal"?s==="nominal"?"category":"ordinal":f!==void 0?"diverging":r==="rect"||r==="geoshape"?"heatmap":"ramp";case Po:case Ma:case Ta:return[i.scale.minOpacity,i.scale.maxOpacity]}throw new Error(`Scale range undefined for channel ${e}`)}function Twe(e,t,n,i){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return n!==void 0&&J(n)?n.length+1:(U(jme(i)),3)}}function Nwe(e,t,n){const i=()=>{const r=Uo(t),o=Uo(e),a=`(${r} - ${o}) / (${n} - 1)`;return`sequence(${o}, ${r} + ${a}, ${a})`};return ie(t)?new ei(i):{signal:i()}}function gI(e,t,n){if(t)return ie(t)?{signal:`${t.signal} ? 0 : ${gI(e,!1,n)}`}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(c1("size",e))}const pI=.95;function Rwe(e,t,n,i){const r={x:hI(n,"x"),y:hI(n,"y")};switch(e){case"bar":case"tick":{if(i.scale.maxBandSize!==void 0)return i.scale.maxBandSize;const o=mI(t,r,i.view);return yt(o)?o-1:new ei(()=>`${o.signal} - 1`)}case"line":case"trail":case"rule":return i.scale.maxStrokeWidth;case"text":return i.scale.maxFontSize;case"point":case"square":case"circle":{if(i.scale.maxSize)return i.scale.maxSize;const o=mI(t,r,i.view);return yt(o)?Math.pow(pI*o,2):new ei(()=>`pow(${pI} * ${o.signal}, 2)`)}}throw new Error(c1("size",e))}function mI(e,t,n){const i=oo(e.width)?e.width.step:R1(n,"width"),r=oo(e.height)?e.height.step:R1(n,"height");return t.x||t.y?new ei(()=>`min(${[t.x?t.x.signal:i,t.y?t.y.signal:r].join(", ")})`):Math.min(i,r)}function yI(e,t){bt(e)?jwe(e,t):xI(e,t)}function jwe(e,t){const n=e.component.scales,{config:i,encoding:r,markDef:o,specifiedScales:a}=e;for(const s of z(n)){const u=a[s],l=n[s],c=e.getScaleComponent(s),f=Ot(r[s]),d=u[t],h=c.get("type"),g=c.get("padding"),p=c.get("paddingInner"),m=A$(h,t),y=nj(s,t);if(d!==void 0&&(m?y&&U(y):U(B7(h,t,s))),m&&y===void 0)if(d!==void 0){const v=f.timeUnit,b=f.type;switch(t){case"domainMax":case"domainMin":lu(u[t])||b==="temporal"||v?l.set(t,{signal:C1(u[t],{type:b,timeUnit:v})},!0):l.set(t,u[t],!0);break;default:l.copyKeyFromObject(t,u)}}else{const v=t in vI?vI[t]({model:e,channel:s,fieldOrDatumDef:f,scaleType:h,scalePadding:g,scalePaddingInner:p,domain:u.domain,markDef:o,config:i}):i.scale[t];v!==void 0&&l.set(t,v,!1)}}}const vI={bins:({model:e,fieldOrDatumDef:t})=>Y(t)?Lwe(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>Pwe(e,t.type),nice:({scaleType:e,channel:t,domain:n,fieldOrDatumDef:i})=>Iwe(e,t,n,i),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:i,config:r})=>Bwe(e,t,r.scale,n,i,r.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,config:i})=>zwe(e,t,n.type,i.scale),paddingOuter:({scalePadding:e,channel:t,scaleType:n,markDef:i,scalePaddingInner:r,config:o})=>Uwe(e,t,n,i.type,r,o.scale),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:i})=>{const r=Y(e)?e.sort:void 0;return qwe(t,r,n,i.scale)},zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:i,scaleType:r})=>Hwe(e,t,n,i,r)};function bI(e){bt(e)?Fwe(e):xI(e,"range")}function xI(e,t){const n=e.component.scales;for(const i of e.children)t==="range"?bI(i):yI(i,t);for(const i of z(n)){let r;for(const o of e.children){const a=o.component.scales[i];if(a){const s=a.getWithExplicit(t);r=Ga(r,s,t,"scale",DL((u,l)=>{switch(t){case"range":return u.step&&l.step?u.step-l.step:0}return 0}))}}n[i].setWithExplicit(t,r)}}function Lwe(e,t){const n=t.bin;if(Je(n)){const i=LS(e,t.field,n);return new ei(()=>e.getSignalName(i))}else if(kn(n)&&su(n)&&n.step!==void 0)return{step:n.step}}function Pwe(e,t){if(ye([Xn,Kr,Jr],e)&&t!=="nominal")return"hcl"}function Iwe(e,t,n,i){var r;if(!(((r=ro(i))===null||r===void 0?void 0:r.bin)||J(n)||ye([St.TIME,St.UTC],e)))return t in La?!0:void 0}function Bwe(e,t,n,i,r,o){if(e in La){if(cr(t)){if(n.continuousPadding!==void 0)return n.continuousPadding;const{type:a,orient:s}=r;if(a==="bar"&&!(Y(i)&&(i.bin||i.timeUnit))&&(s==="vertical"&&e==="x"||s==="horizontal"&&e==="y"))return o.continuousBandSize}if(t===St.POINT)return n.pointPadding}}function zwe(e,t,n,i){if(e===void 0&&t in La){const{bandPaddingInner:r,barBandPaddingInner:o,rectBandPaddingInner:a}=i;return vt(r,n==="bar"?o:a)}}function Uwe(e,t,n,i,r,o){if(e===void 0&&t in La&&n===St.BAND){const{bandPaddingOuter:a}=o;return vt(a,ie(r)?{signal:`${r.signal}/2`}:r/2)}}function qwe(e,t,n,i){if(n==="x"&&i.xReverse!==void 0)return yi(e)&&t==="descending"?ie(i.xReverse)?{signal:`!${i.xReverse.signal}`}:!i.xReverse:i.xReverse;if(yi(e)&&t==="descending")return!0}function Hwe(e,t,n,i,r){if(!!n&&n!=="unaggregated"&&yi(r)){if(J(n)){const a=n[0],s=n[n.length-1];if(a<=0&&s>=0)return!0}return!1}if(e==="size"&&t.type==="quantitative"&&!bh(r))return!0;if(!(Y(t)&&t.bin)&&ye([...Zr,...mpe],e)){const{orient:a,type:s}=i;return!(ye(["bar","area","line","trail"],s)&&(a==="horizontal"&&e==="y"||a==="vertical"&&e==="x"))}return!1}function Wwe(e,t,n,i){const r=Gwe(t,n,i),{type:o}=e;return Pa(t)?o!==void 0?S1e(t,o)?Y(n)&&!$1e(o,n.type)?(U(xme(o,r)),r):o:(U(bme(t,o,r)),r):r:null}function Gwe(e,t,n){var i;switch(t.type){case"nominal":case"ordinal":{if(Jl(e)||t$(e)==="discrete")return e==="shape"&&t.type==="ordinal"&&U(u$(e,"ordinal")),"ordinal";if(e in La){if(ye(["rect","bar","image","rule"],n.type))return"band"}else if(n.type==="arc"&&e in e$)return"band";const r=n[ji(e)];return tc(r)||L$(t)&&((i=t.axis)===null||i===void 0?void 0:i.tickBand)?"band":"point"}case"temporal":return Jl(e)?"time":t$(e)==="discrete"?(U(u$(e,"temporal")),"ordinal"):Y(t)&&t.timeUnit&&Dn(t.timeUnit).utc?"utc":"time";case"quantitative":return Jl(e)?Y(t)&&Je(t.bin)?"bin-ordinal":"linear":t$(e)==="discrete"?(U(u$(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(P7(t.type))}function Ywe(e,{ignoreRange:t}={}){wI(e),sI(e);for(const n of A1e)yI(e,n);t||bI(e)}function wI(e){bt(e)?e.component.scales=Vwe(e):e.component.scales=Kwe(e)}function Vwe(e){const{encoding:t,mark:n,markDef:i}=e;return s1.reduce((r,o)=>{const a=Ot(t[o]);if(a&&n===oj&&o===Kn&&a.type===ec)return r;let s=a&&a.scale;if(a&&s!==null&&s!==!1){s!=null||(s={});const u=Wwe(s,o,a,i);r[o]=new fI(e.scaleName(`${o}`,!0),{value:u,explicit:s.type===u})}return r},{})}const Xwe=DL((e,t)=>Q7(e)-Q7(t));function Kwe(e){var t,n;const i=e.component.scales={},r={},o=e.component.resolve;for(const a of e.children){wI(a);for(const s of z(a.component.scales))if((t=(n=o.scale)[s])!==null&&t!==void 0||(n[s]=zP(s,e)),o.scale[s]==="shared"){const u=r[s],l=a.component.scales[s].getWithExplicit("type");u?a1e(u.value,l.value)?r[s]=Ga(u,l,"type","scale",Xwe):(o.scale[s]="independent",delete r[s]):r[s]=l}}for(const a of z(r)){const s=e.scaleName(a,!0),u=r[a];i[a]=new fI(s,u);for(const l of e.children){const c=l.component.scales[a];c&&(l.renameScale(c.get("name"),s),c.merged=!0)}}return i}var VS=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class XS{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return this.nameMap[t]!==void 0}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function bt(e){return(e==null?void 0:e.type)==="unit"}function pr(e){return(e==null?void 0:e.type)==="facet"}function KS(e){return(e==null?void 0:e.type)==="concat"}function vc(e){return(e==null?void 0:e.type)==="layer"}class JS{constructor(t,n,i,r,o,a,s){var u,l;this.type=n,this.parent=i,this.config=o,this.correctDataNames=c=>{var f,d,h;return((f=c.from)===null||f===void 0?void 0:f.data)&&(c.from.data=this.lookupDataSource(c.from.data)),((h=(d=c.from)===null||d===void 0?void 0:d.facet)===null||h===void 0?void 0:h.data)&&(c.from.facet.data=this.lookupDataSource(c.from.facet.data)),c},this.parent=i,this.config=o,this.view=Jn(s),this.name=(u=t.name)!==null&&u!==void 0?u:r,this.title=Ba(t.title)?{text:t.title}:t.title?Jn(t.title):void 0,this.scaleNameMap=i?i.scaleNameMap:new XS,this.projectionNameMap=i?i.projectionNameMap:new XS,this.signalNameMap=i?i.signalNameMap:new XS,this.data=t.data,this.description=t.description,this.transforms=Rve((l=t.transform)!==null&&l!==void 0?l:[]),this.layout=n==="layer"||n==="unit"?{}:zye(t,n,o),this.component={data:{sources:i?i.component.data.sources:[],outputNodes:i?i.component.data.outputNodes:{},outputNodeRefCounts:i?i.component.data.outputNodeRefCounts:{},isFaceted:x1(t)||i&&i.component.data.isFaceted&&t.data===void 0},layoutSize:new Wo,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},a?de(a):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){Ywe(this)}parseProjection(){eI(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){XP(this)}assembleEncodeFromView(t){const n=VS(t,["style"]),i={};for(const r of z(n)){const o=n[r];o!==void 0&&(i[r]=it(o))}return i}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),!t&&(this.description&&(n.description=it(this.description)),this.type==="unit"||this.type==="layer")?Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},n!=null?n:{}):We(n)?void 0:n}assembleLayout(){if(!this.layout)return;const t=this.layout,{spacing:n}=t,i=VS(t,["spacing"]),{component:r,config:o}=this,a=g2e(r.layoutHeaders,o);return Object.assign(Object.assign(Object.assign({padding:n},this.assembleDefaultLayout()),i),a?{titleBand:a}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const i of Ri)t[i].title&&n.push(u2e(this,i));for(const i of DS)n=n.concat(l2e(this,i));return n}assembleAxes(){return Kxe(this.component.axes,this.config)}assembleLegends(){return JP(this)}assembleProjections(){return P2e(this)}assembleTitle(){var t,n,i;const r=(t=this.title)!==null&&t!==void 0?t:{},{encoding:o}=r,a=VS(r,["encoding"]),s=Object.assign(Object.assign(Object.assign({},x7(this.config.title).nonMarkTitleProperties),a),o?{encode:{update:o}}:{});if(s.text)return ye(["unit","layer"],this.type)?ye(["middle",void 0],s.anchor)&&((n=s.frame)!==null&&n!==void 0||(s.frame="group")):(i=s.anchor)!==null&&i!==void 0||(s.anchor="start"),We(s)?void 0:s}assembleGroup(t=[]){const n={};t=t.concat(this.assembleSignals()),t.length>0&&(n.signals=t);const i=this.assembleLayout();i&&(n.layout=i),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const r=!this.parent||pr(this.parent)?lI(this):[];r.length>0&&(n.scales=r);const o=this.assembleAxes();o.length>0&&(n.axes=o);const a=this.assembleLegends();return a.length>0&&(n.legends=a),n}getName(t){return nt((this.name?`${this.name}_`:"")+t)}getDataName(t){return this.getName(Ze[t].toLowerCase())}requestDataName(t){const n=this.getDataName(t),i=this.component.data.outputNodeRefCounts;return i[n]=(i[n]||0)+1,n}getSizeSignalRef(t){if(pr(this.parent)){const n=IP(t),i=a1(n),r=this.component.scales[i];if(r&&!r.merged){const o=r.get("type"),a=r.get("range");if(cn(o)&&za(a)){const s=r.get("name"),u=iy(this,i),l=YS(u);if(l){const c=G({aggregate:"distinct",field:l},{expr:"datum"});return{signal:PP(s,r,c)}}else return U(a$(i)),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){if(n)return this.getName(t);if(d7(t)&&Pa(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t)))return this.scaleNameMap.get(this.getName(t))}projectionName(t){if(t)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,n){let i=this.component.selection[t];if(!i&&this.parent&&(i=this.parent.getSelectionComponent(t,n)),!i)throw new Error(Bpe(n));return i}hasAxisOrientSignalRef(){var t,n;return((t=this.component.axes.x)===null||t===void 0?void 0:t.some(i=>i.hasOrientSignalRef()))||((n=this.component.axes.y)===null||n===void 0?void 0:n.some(i=>i.hasOrientSignalRef()))}}class EI extends JS{vgField(t,n={}){const i=this.fieldDef(t);if(!!i)return G(i,n)}reduceFieldDef(t,n){return pye(this.getMapping(),(i,r,o)=>{const a=ro(r);return a?t(i,a,o):i},n)}forEachFieldDef(t,n){U$(this.getMapping(),(i,r)=>{const o=ro(i);o&&t(o,r)},n)}}var Jwe=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class ry extends Ge{constructor(t,n){var i,r,o;super(t);this.transform=n,this.transform=de(n);const a=(i=this.transform.as)!==null&&i!==void 0?i:[void 0,void 0];this.transform.as=[(r=a[0])!==null&&r!==void 0?r:"value",(o=a[1])!==null&&o!==void 0?o:"density"]}clone(){return new ry(null,de(this.transform))}dependentFields(){var t;return new Set([this.transform.density,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${_e(this.transform)}`}assemble(){const t=this.transform,{density:n}=t,i=Jwe(t,["density"]);return Object.assign({type:"kde",field:n},i)}}class Uh extends Ge{constructor(t,n){super(t);this.filter=n}clone(){return new Uh(null,Object.assign({},this.filter))}static make(t,n){const{config:i,mark:r,markDef:o}=n;if(Be("invalid",o,i)!=="filter")return null;const s=n.reduceFieldDef((u,l,c)=>{const f=Pa(c)&&n.getScaleComponent(c);if(f){const d=f.get("type");yi(d)&&l.aggregate!=="count"&&!Ua(r)&&(u[l.field]=l)}return u},{});return z(s).length?new Uh(t,s):null}dependentFields(){return new Set(z(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${_e(this.filter)}`}assemble(){const t=z(this.filter).reduce((n,i)=>{const r=this.filter[i],o=G(r,{expr:"datum"});return r!==null&&(r.type==="temporal"?n.push(`(isDate(${o}) || (isValid(${o}) && isFinite(+${o})))`):r.type==="quantitative"&&(n.push(`isValid(${o})`),n.push(`isFinite(+${o})`))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}class oy extends Ge{constructor(t,n){super(t);this.transform=n,this.transform=de(n);const{flatten:i,as:r=[]}=this.transform;this.transform.as=i.map((o,a)=>{var s;return(s=r[a])!==null&&s!==void 0?s:o})}clone(){return new oy(this.parent,de(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${_e(this.transform)}`}assemble(){const{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}class ay extends Ge{constructor(t,n){var i,r,o;super(t);this.transform=n,this.transform=de(n);const a=(i=this.transform.as)!==null&&i!==void 0?i:[void 0,void 0];this.transform.as=[(r=a[0])!==null&&r!==void 0?r:"key",(o=a[1])!==null&&o!==void 0?o:"value"]}clone(){return new ay(null,de(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${_e(this.transform)}`}assemble(){const{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}class bc extends Ge{constructor(t,n,i,r){super(t);this.fields=n,this.geojson=i,this.signal=r}clone(){return new bc(null,de(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let i=0;for(const r of[[Xr,Vr],[Ni,lr]]){const o=r.map(a=>{const s=Ot(n.encoding[a]);return Y(s)?s.field:qa(s)?{expr:`${s.datum}`}:fr(s)?{expr:`${s.value}`}:void 0});(o[0]||o[1])&&(t=new bc(t,o,null,n.getName(`geojson_${i++}`)))}if(n.channelHasField(Kn)){const r=n.typedFieldDef(Kn);r.type===ec&&(t=new bc(t,null,r.field,n.getName(`geojson_${i++}`)))}return t}dependentFields(){var t;const n=((t=this.fields)!==null&&t!==void 0?t:[]).filter(fe);return new Set([...this.geojson?[this.geojson]:[],...n])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${_e(this.fields)}`}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})]}}class qh extends Ge{constructor(t,n,i,r){super(t);this.projection=n,this.fields=i,this.as=r}clone(){return new qh(null,this.projection,de(this.fields),de(this.as))}static parseAll(t,n){if(!n.projectionName())return t;for(const i of[[Xr,Vr],[Ni,lr]]){const r=i.map(a=>{const s=Ot(n.encoding[a]);return Y(s)?s.field:qa(s)?{expr:`${s.datum}`}:fr(s)?{expr:`${s.value}`}:void 0}),o=i[0]===Ni?"2":"";(r[0]||r[1])&&(t=new qh(t,n.projectionName(),r,[n.getName(`x${o}`),n.getName(`y${o}`)]))}return t}dependentFields(){return new Set(this.fields.filter(fe))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${_e(this.fields)} ${_e(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class Eu extends Ge{constructor(t,n){super(t);this.transform=n}clone(){return new Eu(null,de(this.transform))}dependentFields(){var t;return new Set([this.transform.impute,this.transform.key,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:n=0,stop:i,step:r}=t;return{signal:`sequence(${[n,i,...r?[r]:[]].join(",")})`}}static makeFromTransform(t,n){return new Eu(t,n)}static makeFromEncoding(t,n){const i=n.encoding,r=i.x,o=i.y;if(Y(r)&&Y(o)){const a=r.impute?r:o.impute?o:void 0;if(a===void 0)return;const s=r.impute?o:o.impute?r:void 0,{method:u,value:l,frame:c,keyvals:f}=a.impute,d=Bj(n.mark,i);return new Eu(t,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:a.field,key:s.field},u?{method:u}:{}),l!==void 0?{value:l}:{}),c?{frame:c}:{}),f!==void 0?{keyvals:f}:{}),d.length?{groupby:d}:{}))}return null}hash(){return`Impute ${_e(this.transform)}`}assemble(){const{impute:t,key:n,keyvals:i,method:r,groupby:o,value:a,frame:s=[null,null]}=this.transform,u=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:t,key:n},i?{keyvals:yve(i)?this.processSequence(i):i}:{}),{method:"value"}),o?{groupby:o}:{}),{value:!r||r==="value"?a:null});if(r&&r!=="value"){const l=Object.assign({type:"window",as:[`imputed_${t}_value`],ops:[r],fields:[t],frame:s,ignorePeers:!1},o?{groupby:o}:{}),c={type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t};return[u,l,c]}else return[u]}}var Zwe=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class sy extends Ge{constructor(t,n){var i,r,o;super(t);this.transform=n,this.transform=de(n);const a=(i=this.transform.as)!==null&&i!==void 0?i:[void 0,void 0];this.transform.as=[(r=a[0])!==null&&r!==void 0?r:n.on,(o=a[1])!==null&&o!==void 0?o:n.loess]}clone(){return new sy(null,de(this.transform))}dependentFields(){var t;return new Set([this.transform.loess,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${_e(this.transform)}`}assemble(){const t=this.transform,{loess:n,on:i}=t,r=Zwe(t,["loess","on"]);return Object.assign({type:"loess",x:i,y:n},r)}}class Hh extends Ge{constructor(t,n,i){super(t);this.transform=n,this.secondary=i}clone(){return new Hh(null,de(this.transform),this.secondary)}static make(t,n,i,r){const o=n.component.data.sources,{from:a}=i;let s=null;if(vve(a)){let u=SI(a.data,o);u||(u=new bu(a.data),o.push(u));const l=n.getName(`lookup_${r}`);s=new Tn(u,l,Ze.Lookup,n.component.data.outputNodeRefCounts),n.component.data.outputNodes[l]=s}else if(bve(a)){const u=a.param;i=Object.assign({as:u},i);let l;try{l=n.getSelectionComponent(nt(u),u)}catch(c){throw new Error(qpe(u))}if(s=l.materialized,!s)throw new Error(Hpe(u))}return new Hh(t,i,s.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?ft(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${_e({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t=Object.assign({values:this.transform.from.fields},this.transform.as?{as:ft(this.transform.as)}:{});else{let n=this.transform.as;fe(n)||(U(Zpe),n="_lookup"),t={as:[n]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},t),this.transform.default?{default:this.transform.default}:{})}}var Qwe=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class uy extends Ge{constructor(t,n){var i,r,o;super(t);this.transform=n,this.transform=de(n);const a=(i=this.transform.as)!==null&&i!==void 0?i:[void 0,void 0];this.transform.as=[(r=a[0])!==null&&r!==void 0?r:"prob",(o=a[1])!==null&&o!==void 0?o:"value"]}clone(){return new uy(null,de(this.transform))}dependentFields(){var t;return new Set([this.transform.quantile,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${_e(this.transform)}`}assemble(){const t=this.transform,{quantile:n}=t,i=Qwe(t,["quantile"]);return Object.assign({type:"quantile",field:n},i)}}var eEe=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class ly extends Ge{constructor(t,n){var i,r,o;super(t);this.transform=n,this.transform=de(n);const a=(i=this.transform.as)!==null&&i!==void 0?i:[void 0,void 0];this.transform.as=[(r=a[0])!==null&&r!==void 0?r:n.on,(o=a[1])!==null&&o!==void 0?o:n.regression]}clone(){return new ly(null,de(this.transform))}dependentFields(){var t;return new Set([this.transform.regression,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${_e(this.transform)}`}assemble(){const t=this.transform,{regression:n,on:i}=t,r=eEe(t,["regression","on"]);return Object.assign({type:"regression",x:i,y:n},r)}}class cy extends Ge{constructor(t,n){super(t);this.transform=n}clone(){return new cy(null,de(this.transform))}addDimensions(t){var n;this.transform.groupby=Wr(((n=this.transform.groupby)!==null&&n!==void 0?n:[]).concat(t),i=>i)}producedFields(){}dependentFields(){var t;return new Set([this.transform.pivot,this.transform.value,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}hash(){return`PivotTransform ${_e(this.transform)}`}assemble(){const{pivot:t,value:n,groupby:i,limit:r,op:o}=this.transform;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:n},r!==void 0?{limit:r}:{}),o!==void 0?{op:o}:{}),i!==void 0?{groupby:i}:{})}}class fy extends Ge{constructor(t,n){super(t);this.transform=n}clone(){return new fy(null,de(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${_e(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function _I(e){let t=0;function n(i,r){var o;if(i instanceof bu&&!i.isGenerator&&!ac(i.data)&&(e.push(r),r={name:null,source:r.name,transform:[]}),i instanceof gn&&(i.parent instanceof bu&&!r.source?(r.format=Object.assign(Object.assign({},(o=r.format)!==null&&o!==void 0?o:{}),{parse:i.assembleFormatParse()}),r.transform.push(...i.assembleTransforms(!0))):r.transform.push(...i.assembleTransforms())),i instanceof mc){r.name||(r.name=`data_${t++}`),!r.source||r.transform.length>0?(e.push(r),i.data=r.name):i.data=r.source,e.push(...i.assemble());return}switch((i instanceof Ih||i instanceof Bh||i instanceof Uh||i instanceof dc||i instanceof hc||i instanceof qh||i instanceof hr||i instanceof Hh||i instanceof yc||i instanceof wu||i instanceof ay||i instanceof oy||i instanceof ry||i instanceof sy||i instanceof uy||i instanceof ly||i instanceof Za||i instanceof fy||i instanceof cy)&&r.transform.push(i.assemble()),(i instanceof uo||i instanceof ao||i instanceof Eu||i instanceof Vo||i instanceof bc)&&r.transform.push(...i.assemble()),i instanceof Tn&&(r.source&&r.transform.length===0?i.setSource(r.source):i.parent instanceof Tn?i.setSource(r.name):(r.name||(r.name=`data_${t++}`),i.setSource(r.name),i.numChildren()===1&&(e.push(r),r={name:null,source:r.name,transform:[]}))),i.numChildren()){case 0:i instanceof Tn&&(!r.source||r.transform.length>0)&&e.push(r);break;case 1:n(i.children[0],r);break;default:{r.name||(r.name=`data_${t++}`);let a=r.name;!r.source||r.transform.length>0?e.push(r):a=r.source;for(const s of i.children)n(s,{name:null,source:a,transform:[]});break}}}return n}function tEe(e){const t=[],n=_I(t);for(const i of e.children)n(i,{source:e.name,name:null,transform:[]});return t}function nEe(e,t){var n,i;const r=[],o=_I(r);let a=0;for(const u of e.sources){u.hasName()||(u.dataName=`source_${a++}`);const l=u.assemble();o(u,l)}for(const u of r)u.transform.length===0&&delete u.transform;let s=0;for(const[u,l]of r.entries())((n=l.transform)!==null&&n!==void 0?n:[]).length===0&&!l.source&&r.splice(s++,0,r.splice(u,1)[0]);for(const u of r)for(const l of(i=u.transform)!==null&&i!==void 0?i:[])l.type==="lookup"&&(l.from=e.outputNodes[l.from].getSource());for(const u of r)u.name in t&&(u.values=t[u.name]);return r}function iEe(e){return e==="top"||e==="left"||ie(e)?"header":"footer"}function rEe(e){for(const t of Ri)oEe(e,t);$I(e,"x"),$I(e,"y")}function oEe(e,t){var n;const{facet:i,config:r,child:o,component:a}=e;if(e.channelHasField(t)){const s=i[t],u=pc("title",null,r,t);let l=nc(s,r,{allowDisabling:!0,includeDefault:u===void 0||!!u});o.component.layoutHeaders[t].title&&(l=J(l)?l.join(", "):l,l+=` / ${o.component.layoutHeaders[t].title}`,o.component.layoutHeaders[t].title=null);const c=pc("labelOrient",s.header,r,t),f=s.header!==null?vt((n=s.header)===null||n===void 0?void 0:n.labels,r.header.labels,!0):!1,d=ye(["bottom","right"],c)?"footer":"header";a.layoutHeaders[t]={title:s.header!==null?l:null,facetFieldDef:s,[d]:t==="facet"?[]:[AI(e,t,f)]}}}function AI(e,t,n){const i=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(i)?e.child.getSizeSignalRef(i):void 0,axes:[]}}function $I(e,t){var n;const{child:i}=e;if(i.component.axes[t]){const{layoutHeaders:r,resolve:o}=e.component;if(o.axis[t]=RS(o,t),o.axis[t]==="shared"){const a=t==="x"?"column":"row",s=r[a];for(const u of i.component.axes[t]){const l=iEe(u.get("orient"));(n=s[l])!==null&&n!==void 0||(s[l]=[AI(e,a,!1)]);const c=Ph(u,"main",e.config,{header:!0});c&&s[l][0].axes.push(c),u.mainExtracted=!0}}}}function aEe(e){ZS(e),dy(e,"width"),dy(e,"height")}function sEe(e){ZS(e);const t=e.layout.columns===1?"width":"childWidth",n=e.layout.columns===void 0?"height":"childHeight";dy(e,t),dy(e,n)}function ZS(e){for(const t of e.children)t.parseLayoutSize()}function dy(e,t){var n;const i=IP(t),r=a1(i),o=e.component.resolve,a=e.component.layoutSize;let s;for(const u of e.children){const l=u.component.layoutSize.getWithExplicit(i),c=(n=o.scale[r])!==null&&n!==void 0?n:zP(r,e);if(c==="independent"&&l.value==="step"){s=void 0;break}if(s){if(c==="independent"&&s.value!==l.value){s=void 0;break}s=Ga(s,l,i,"")}else s=l}if(s){for(const u of e.children)e.renameSignal(u.getName(i),e.getName(t)),u.component.layoutSize.set(i,"merged",!1);a.setWithExplicit(t,s)}else a.setWithExplicit(t,{explicit:!1,value:void 0})}function uEe(e){const{size:t,component:n}=e;for(const i of Zr){const r=ji(i);if(t[r]){const o=t[r];n.layoutSize.set(r,oo(o)?"step":o,!0)}else{const o=lEe(e,r);n.layoutSize.set(r,o,!1)}}}function lEe(e,t){const n=t==="width"?"x":"y",i=e.config,r=e.getScaleComponent(n);if(r){const o=r.get("type"),a=r.get("range");if(cn(o)){const s=$h(i.view,t);return za(a)||oo(s)?"step":s}else return eS(i.view,t)}else{if(e.hasProjection||e.mark==="arc")return eS(i.view,t);{const o=$h(i.view,t);return oo(o)?o.step:o}}}function QS(e,t,n){return G(t,Object.assign({suffix:`by_${G(e)}`},n!=null?n:{}))}class Wh extends EI{constructor(t,n,i,r){super(t,"facet",n,i,r,t.resolve);this.child=rO(t.spec,this,this.getName("child"),void 0,r),this.children=[this.child],this.facet=this.initFacet(t.facet)}initFacet(t){if(!wh(t))return{facet:this.initFacetFieldDef(t,"facet")};const n=z(t),i={};for(const r of n){if(![To,No].includes(r)){U(c1(r,"facet"));break}const o=t[r];if(o.field===void 0){U(s$(o,r));break}i[r]=this.initFacetFieldDef(o,r)}return i}initFacetFieldDef(t,n){const i=B$(t,n);return i.header?i.header=Jn(i.header):i.header===null&&(i.header=null),i}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=hy(this),this.child.parseData()}parseLayoutSize(){ZS(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),rEe(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){var t,n,i;const r={};for(const o of Ri)for(const a of MS){const s=this.component.layoutHeaders[o],u=s[a],{facetFieldDef:l}=s;if(l){const c=pc("titleOrient",l.header,this.config,o);if(["right","bottom"].includes(c)){const f=Q1(o,c);(t=r.titleAnchor)!==null&&t!==void 0||(r.titleAnchor={}),r.titleAnchor[f]="end"}}if(u==null?void 0:u[0]){const c=o==="row"?"height":"width",f=a==="header"?"headerBand":"footerBand";o!=="facet"&&!this.child.component.layoutSize.get(c)&&((n=r[f])!==null&&n!==void 0||(r[f]={}),r[f][o]=.5),s.title&&((i=r.offset)!==null&&i!==void 0||(r.offset={}),r.offset[o==="row"?"rowTitle":"columnTitle"]=10)}}return r}assembleDefaultLayout(){const{column:t,row:n}=this.facet,i=t?this.columnDistinctSignal():n?1:void 0;let r="all";return(!n&&this.component.resolve.scale.x==="independent"||!t&&this.component.resolve.scale.y==="independent")&&(r="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),i?{columns:i}:{}),{bounds:"full",align:r})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof Wh))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroupStyle(){}assembleGroup(t){return this.parent&&this.parent instanceof Wh?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:G(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(t)):super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],n=[],i=[];if(this.child instanceof Wh){if(this.child.channelHasField("column")){const r=G(this.child.facet.column);t.push(r),n.push("distinct"),i.push(`distinct_${r}`)}}else for(const r of Zr){const o=this.child.component.scales[r];if(o&&!o.merged){const a=o.get("type"),s=o.get("range");if(cn(a)&&za(s)){const u=iy(this.child,r),l=YS(u);l?(t.push(l),n.push("distinct"),i.push(`distinct_${l}`)):U(a$(r))}}}return{fields:t,ops:n,as:i}}assembleFacet(){const{name:t,data:n}=this.component.data.facetRoot,{row:i,column:r}=this.facet,{fields:o,ops:a,as:s}=this.getCardinalityAggregateForChild(),u=[];for(const c of Ri){const f=this.facet[c];if(f){u.push(G(f));const{bin:d,sort:h}=f;if(Je(d)&&u.push(G(f,{binSuffix:"end"})),no(h)){const{field:g,op:p=b1}=h,m=QS(f,h);i&&r?(o.push(m),a.push("max"),s.push(m)):(o.push(g),a.push(p),s.push(m))}else if(J(h)){const g=gc(f,c);o.push(g),a.push("max"),s.push(g)}}}const l=!!i&&!!r;return Object.assign({name:t,data:n,groupby:u},l||o.length>0?{aggregate:Object.assign(Object.assign({},l?{cross:l}:{}),o.length?{fields:o,ops:a,as:s}:{})}:{})}facetSortFields(t){const{facet:n}=this,i=n[t];return i?no(i.sort)?[QS(i,i.sort,{expr:"datum"})]:J(i.sort)?[gc(i,t,{expr:"datum"})]:[G(i,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:n}=this,i=n[t];if(i){const{sort:r}=i;return[(no(r)?r.order:!J(r)&&r)||"ascending"]}return[]}assembleLabelTitle(){var t;const{facet:n,config:i}=this;if(n.facet)return TS(n.facet,"facet",i);const r={row:["top","bottom"],column:["left","right"]};for(const o of DS)if(n[o]){const a=pc("labelOrient",(t=n[o])===null||t===void 0?void 0:t.header,i,o);if(r[o].includes(a))return TS(n[o],o,i)}}assembleMarks(){const{child:t}=this,n=this.component.data.facetRoot,i=tEe(n),r=t.assembleGroupEncodeEntry(!1),o=this.assembleLabelTitle()||t.assembleTitle(),a=t.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},o?{title:o}:{}),a?{style:a}:{}),{from:{facet:this.assembleFacet()},sort:{field:Ri.map(u=>this.facetSortFields(u)).flat(),order:Ri.map(u=>this.facetSortOrder(u)).flat()}}),i.length>0?{data:i}:{}),r?{encode:{update:r}}:{}),t.assembleGroup(rbe(this,[])))]}getMapping(){return this.facet}}function cEe(e,t){const{row:n,column:i}=t;if(n&&i){let r=null;for(const o of[n,i])if(no(o.sort)){const{field:a,op:s=b1}=o.sort;e=r=new wu(e,{joinaggregate:[{op:s,field:a,as:QS(o,o.sort,{forAs:!0})}],groupby:[G(o)]})}return r}return null}function SI(e,t){var n,i,r,o;for(const a of t){const s=a.data;if(e.name&&a.hasName()&&e.name!==a.dataName)continue;const u=(n=e.format)===null||n===void 0?void 0:n.mesh,l=(i=s.format)===null||i===void 0?void 0:i.feature;if(u&&l)continue;const c=(r=e.format)===null||r===void 0?void 0:r.feature;if((c||l)&&c!==l)continue;const f=(o=s.format)===null||o===void 0?void 0:o.mesh;if(!((u||f)&&u!==f)){if(Sh(e)&&Sh(s)){if(Hr(e.values,s.values))return a}else if(ac(e)&&ac(s)){if(e.url===s.url)return a}else if(ML(e)&&e.name===a.dataName)return a}}return null}function fEe(e,t){if(e.data||!e.parent){if(e.data===null){const i=new bu({values:[]});return t.push(i),i}const n=SI(e.data,t);if(n)return Ya(e.data)||(n.data.format=t7({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const i=new bu(e.data);return t.push(i),i}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function dEe(e,t,n){var i,r;let o=0;for(const a of t.transforms){let s,u;if(Fve(a))u=e=new hc(e,a),s="derived";else if(oS(a)){const l=Z2e(a);u=e=(i=gn.makeWithAncestors(e,{},l,n))!==null&&i!==void 0?i:e,e=new dc(e,t,a.filter)}else if(_L(a))u=e=uo.makeFromTransform(e,a,t),s="number";else if(Dve(a))s="date",n.getWithExplicit(a.field).value===void 0&&(e=new gn(e,{[a.field]:s}),n.set(a.field,s,!1)),u=e=ao.makeFromTransform(e,a);else if(Mve(a))u=e=hr.makeFromTransform(e,a),s="number",vS(t)&&(e=new Za(e));else if(EL(a))u=e=Hh.make(e,t,a,o++),s="derived";else if(Sve(a))u=e=new yc(e,a),s="number";else if(Ove(a))u=e=new wu(e,a),s="number";else if(Tve(a))u=e=Vo.makeFromTransform(e,a),s="derived";else if(Nve(a))u=e=new ay(e,a),s="derived";else if(Cve(a))u=e=new oy(e,a),s="derived";else if(xve(a))u=e=new cy(e,a),s="derived";else if($ve(a))e=new fy(e,a);else if(kve(a))u=e=Eu.makeFromTransform(e,a),s="derived";else if(wve(a))u=e=new ry(e,a),s="derived";else if(Eve(a))u=e=new uy(e,a),s="derived";else if(_ve(a))u=e=new ly(e,a),s="derived";else if(Ave(a))u=e=new sy(e,a),s="derived";else{U(Jpe(a));continue}if(u&&s!==void 0)for(const l of(r=u.producedFields())!==null&&r!==void 0?r:[])n.set(l,s,!1)}return e}function hy(e){var t,n,i,r,o,a,s,u,l,c;let f=fEe(e,e.component.data.sources);const{outputNodes:d,outputNodeRefCounts:h}=e.component.data,g=e.data,m=!(g&&(Ya(g)||ac(g)||Sh(g)))&&e.parent?e.parent.component.data.ancestorParse.clone():new Wve;Ya(g)?(TL(g)?f=new Bh(f,g.sequence):uS(g)&&(f=new Ih(f,g.graticule)),m.parseNothing=!0):((t=g==null?void 0:g.format)===null||t===void 0?void 0:t.parse)===null&&(m.parseNothing=!0),f=(n=gn.makeExplicit(f,e,m))!==null&&n!==void 0?n:f,f=new Za(f);const y=e.parent&&vc(e.parent);(bt(e)||pr(e))&&y&&(f=(i=uo.makeFromEncoding(f,e))!==null&&i!==void 0?i:f),e.transforms.length>0&&(f=dEe(f,e,m));const v=ewe(e),b=Q2e(e);f=(r=gn.makeWithAncestors(f,{},Object.assign(Object.assign({},v),b),m))!==null&&r!==void 0?r:f,bt(e)&&(f=bc.parseAll(f,e),f=qh.parseAll(f,e)),(bt(e)||pr(e))&&(y||(f=(o=uo.makeFromEncoding(f,e))!==null&&o!==void 0?o:f),f=(a=ao.makeFromEncoding(f,e))!==null&&a!==void 0?a:f,f=hc.parseAllForSortIndex(f,e));const x=e.getDataName(Ze.Raw),w=new Tn(f,x,Ze.Raw,h);if(d[x]=w,f=w,bt(e)){const O=hr.makeFromEncoding(f,e);O&&(f=O,vS(e)&&(f=new Za(f))),f=(s=Eu.makeFromEncoding(f,e))!==null&&s!==void 0?s:f,f=(u=Vo.makeFromEncoding(f,e))!==null&&u!==void 0?u:f}bt(e)&&(f=(l=Uh.make(f,e))!==null&&l!==void 0?l:f);const _=e.getDataName(Ze.Main),E=new Tn(f,_,Ze.Main,h);d[_]=E,f=E,bt(e)&&Vxe(e,E);let $=null;if(pr(e)){const O=e.getName("facet");f=(c=cEe(f,e.facet))!==null&&c!==void 0?c:f,$=new mc(f,e,O,E.getSource()),d[O]=$}return Object.assign(Object.assign({},e.component.data),{outputNodes:d,outputNodeRefCounts:h,raw:w,main:E,facetRoot:$,ancestorParse:m})}class hEe extends JS{constructor(t,n,i,r){var o,a,s,u;super(t,"concat",n,i,r,t.resolve);(((a=(o=t.resolve)===null||o===void 0?void 0:o.axis)===null||a===void 0?void 0:a.x)==="shared"||((u=(s=t.resolve)===null||s===void 0?void 0:s.axis)===null||u===void 0?void 0:u.y)==="shared")&&U(Vpe),this.children=this.getChildren(t).map((l,c)=>rO(l,this,this.getName(`concat_${c}`),void 0,r))}parseData(){this.component.data=hy(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of z(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return N1(t)?t.vconcat:Q$(t)?t.hconcat:t.concat}parseLayoutSize(){sEe(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,i)=>i.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=NS(this);for(const n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,i)=>i.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{const n=t.assembleTitle(),i=t.assembleGroupStyle(),r=t.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:t.getName("group")},n?{title:n}:{}),i?{style:i}:{}),r?{encode:{update:r}}:{}),t.assembleGroup())})}assembleGroupStyle(){}assembleDefaultLayout(){const t=this.layout.columns;return Object.assign(Object.assign({},t!=null?{columns:t}:{}),{bounds:"full",align:"each"})}}function gEe(e){return e===!1||e===null}const pEe=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},jj),{labelExpr:1,encode:1}),OI=z(pEe);class eO extends Wo{constructor(t={},n={},i=!1){super();this.explicit=t,this.implicit=n,this.mainExtracted=i}clone(){return new eO(de(this.explicit),de(this.implicit),this.mainExtracted)}hasAxisPart(t){return t==="axis"?!0:t==="grid"||t==="title"?!!this.get(t):!gEe(this.get(t))}hasOrientSignalRef(){return ie(this.explicit.orient)}}function mEe(e,t,n){var i;const{encoding:r,config:o}=e,a=(i=Ot(r[t]))!==null&&i!==void 0?i:Ot(r[Io(t)]),s=e.axis(t)||{},{format:u,formatType:l}=s;return du(l)?Object.assign({text:D$({fieldOrDatumDef:a,field:"datum.value",format:u,formatType:l,config:o})},n):n}function yEe(e){return Zr.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[AEe(n,e)]),t),{})}const vEe={bottom:"top",top:"bottom",left:"right",right:"left"};function bEe(e){var t;const{axes:n,resolve:i}=e.component,r={top:0,bottom:0,right:0,left:0};for(const o of e.children){o.parseAxesAndHeaders();for(const a of z(o.component.axes))i.axis[a]=RS(e.component.resolve,a),i.axis[a]==="shared"&&(n[a]=xEe(n[a],o.component.axes[a]),n[a]||(i.axis[a]="independent",delete n[a]))}for(const o of Zr){for(const a of e.children)if(!!a.component.axes[o]){if(i.axis[o]==="independent"){n[o]=((t=n[o])!==null&&t!==void 0?t:[]).concat(a.component.axes[o]);for(const s of a.component.axes[o]){const{value:u,explicit:l}=s.getWithExplicit("orient");if(!ie(u)){if(r[u]>0&&!l){const c=vEe[u];r[u]>r[c]&&s.set("orient",c,!1)}r[u]++}}}delete a.component.axes[o]}if(i.axis[o]==="independent"&&n[o]&&n[o].length>1)for(const a of n[o])!!a.get("grid")&&!a.explicit.grid&&(a.implicit.grid=!1)}}function xEe(e,t){if(e){if(e.length!==t.length)return;const n=e.length;for(let i=0;i<n;i++){const r=e[i],o=t[i];if(!!r!=!!o)return;if(r&&o){const a=r.getWithExplicit("orient"),s=o.getWithExplicit("orient");if(a.explicit&&s.explicit&&a.value!==s.value)return;e[i]=wEe(r,o)}}}else return t.map(n=>n.clone());return e}function wEe(e,t){for(const n of OI){const i=Ga(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(r,o)=>{switch(n){case"title":return F7(r,o);case"gridScale":return{explicit:r.explicit,value:vt(r.value,o.value)}}return L1(r,o,n,"axis")});e.setWithExplicit(n,i)}return e}function EEe(e,t,n,i,r){if(t==="disable")return n!==void 0;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(ie(n.labelAngle)?n.labelAngle:fh(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===TP(i,r))return!0}return e===n[t]}const _Ee=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function AEe(e,t){var n,i,r;let o=t.axis(e);const a=new eO,s=Ot(t.encoding[e]),{mark:u,config:l}=t,c=(o==null?void 0:o.orient)||((n=l[e==="x"?"axisX":"axisY"])===null||n===void 0?void 0:n.orient)||((i=l.axis)===null||i===void 0?void 0:i.orient)||r2e(e),f=t.getScaleComponent(e).get("type"),d=Jxe(e,f,c,t.config),h=o!==void 0?!o:FS("disable",l.style,o==null?void 0:o.style,d).configValue;if(a.set("disable",h,o!==void 0),h)return a;o=o||{};const g=t2e(s,o,e,l.style,d),p={fieldOrDatumDef:s,axis:o,channel:e,model:t,scaleType:f,orient:c,labelAngle:g,mark:u,config:l};for(const v of OI){const b=v in kP?kP[v](p):Lj(v)?o[v]:void 0,x=b!==void 0,w=EEe(b,v,o,t,e);if(x&&w)a.set(v,b,w);else{const{configValue:_=void 0,configFrom:E=void 0}=Lj(v)&&v!=="values"?FS(v,l.style,o.style,d):{},$=_!==void 0;x&&!$?a.set(v,b,w):(E!=="vgAxisConfig"||_Ee.has(v)&&$||_h(_)||ie(_))&&a.set(v,_,!1)}}const m=(r=o.encoding)!==null&&r!==void 0?r:{},y=Rj.reduce((v,b)=>{var x;if(!a.hasAxisPart(b))return v;const w=BP((x=m[b])!==null&&x!==void 0?x:{},t),_=b==="labels"?mEe(t,e,w):w;return _!==void 0&&!We(_)&&(v[b]={update:_}),v},{});return We(y)||a.set("encode",y,!!o.encoding||o.labelAngle!==void 0),a}function $Ee({encoding:e,size:t}){for(const n of Zr){const i=ji(n);oo(t[i])&&io(e[n])&&(delete t[i],U(z7(i)))}return t}function SEe(e,t,n){const i=Jn(e),r=Be("orient",i,n);if(i.orient=kEe(i.type,t,r),r!==void 0&&r!==i.orient&&U(dme(i.orient,r)),i.type==="bar"&&i.orient){const s=Be("cornerRadiusEnd",i,n);if(s!==void 0){const u=i.orient==="horizontal"&&t.x2||i.orient==="vertical"&&t.y2?["cornerRadius"]:L1e[i.orient];for(const l of u)i[l]=s;i.cornerRadiusEnd!==void 0&&delete i.cornerRadiusEnd}}return Be("opacity",i,n)===void 0&&(i.opacity=CEe(i.type,t)),Be("cursor",i,n)===void 0&&(i.cursor=OEe(i,t,n)),i}function OEe(e,t,n){return t.href||e.href||Be("href",e,n)?"pointer":e.cursor}function CEe(e,t){if(ye([p1,$$,S$,O$],e)&&!z$(t))return .7}function FEe(e,t,{graticule:n}){if(n)return!1;const i=uu("filled",e,t),r=e.type;return vt(i,r!==p1&&r!==g1&&r!==m1)}function kEe(e,t,n){switch(e){case p1:case S$:case O$:case rj:case C1e:case O1e:return}const{x:i,y:r,x2:o,y2:a}=t;switch(e){case h1:if(Y(i)&&(kn(i.bin)||Y(r)&&r.aggregate&&!i.aggregate))return"vertical";if(Y(r)&&(kn(r.bin)||Y(i)&&i.aggregate&&!r.aggregate))return"horizontal";if(a||o){if(n)return n;if(!o&&(Y(i)&&i.type===cu&&!Je(i.bin)||j$(i)))return"horizontal";if(!a&&(Y(r)&&r.type===cu&&!Je(r.bin)||j$(r)))return"vertical"}case m1:if(o&&!(Y(i)&&kn(i.bin))&&a&&!(Y(r)&&kn(r.bin)))return;case d1:if(a)return Y(r)&&kn(r.bin)?"horizontal":"vertical";if(o)return Y(i)&&kn(i.bin)?"vertical":"horizontal";if(e===m1){if(i&&!r)return"vertical";if(r&&!i)return"horizontal"}case g1:case $$:{const s=io(i),u=io(r);if(n)return n;if(s&&!u)return e!=="tick"?"horizontal":"vertical";if(!s&&u)return e!=="tick"?"vertical":"horizontal";if(s&&u){const l=i,c=r,f=l.type===Ql,d=c.type===Ql;return f&&!d?e!=="tick"?"vertical":"horizontal":!f&&d?e!=="tick"?"horizontal":"vertical":!l.aggregate&&c.aggregate?e!=="tick"?"vertical":"horizontal":l.aggregate&&!c.aggregate&&e!=="tick"?"horizontal":"vertical"}else return}}return"vertical"}const DEe={vgMark:"arc",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Pi(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),fn("x",e,{defaultPos:"mid"})),fn("y",e,{defaultPos:"mid"})),Xa(e,"radius","arc")),Xa(e,"theta","arc"))},MEe={vgMark:"area",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Pi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),z1("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"})),z1("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"})),mS(e))},TEe={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Pi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Xa(e,"x","bar")),Xa(e,"y","bar"))},NEe={vgMark:"shape",encodeEntry:e=>Object.assign({},Pi(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[Object.assign({type:"geoshape",projection:e.projectionName()},n&&Y(n)&&n.type===ec?{field:G(n,{expr:"datum"})}:{})]}},REe={vgMark:"image",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Pi(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),Xa(e,"x","image")),Xa(e,"y","image")),gS(e,"url"))},jEe={vgMark:"line",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Pi(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),fn("x",e,{defaultPos:"mid"})),fn("y",e,{defaultPos:"mid"})),Lt("size",e,{vgChannel:"strokeWidth"})),mS(e))},LEe={vgMark:"trail",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Pi(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),fn("x",e,{defaultPos:"mid"})),fn("y",e,{defaultPos:"mid"})),Lt("size",e)),mS(e))};function tO(e,t){const{config:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Pi(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),fn("x",e,{defaultPos:"mid"})),fn("y",e,{defaultPos:"mid"})),Lt("size",e)),Lt("angle",e)),PEe(e,n,t))}function PEe(e,t,n){return n?{shape:{value:n}}:Lt("shape",e)}const IEe={vgMark:"symbol",encodeEntry:e=>tO(e)},BEe={vgMark:"symbol",encodeEntry:e=>tO(e,"circle")},zEe={vgMark:"symbol",encodeEntry:e=>tO(e,"square")},UEe={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Pi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Xa(e,"x","rect")),Xa(e,"y","rect"))},qEe={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude?{}:Object.assign(Object.assign(Object.assign(Object.assign({},Pi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),z1("x",e,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"})),z1("y",e,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"})),Lt("size",e,{vgChannel:"strokeWidth"}))}},HEe={vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Pi(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),fn("x",e,{defaultPos:"mid"})),fn("y",e,{defaultPos:"mid"})),gS(e)),Lt("size",e,{vgChannel:"fontSize"})),Lt("angle",e)),ZL("align",WEe(e.markDef,n,t))),ZL("baseline",GEe(e.markDef,n,t))),fn("radius",e,{defaultPos:null})),fn("theta",e,{defaultPos:null}))}};function WEe(e,t,n){if(Be("align",e,n)===void 0)return"center"}function GEe(e,t,n){if(Be("baseline",e,n)===void 0)return"middle"}const YEe={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,i=n.orient,r=i==="horizontal"?"width":"height",o=i==="horizontal"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Pi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),fn("x",e,{defaultPos:"mid",vgChannel:"xc"})),fn("y",e,{defaultPos:"mid",vgChannel:"yc"})),Lt("size",e,{defaultValue:VEe(e),vgChannel:r})),{[o]:it(Be("thickness",n,t))})}};function VEe(e){var t;const{config:n,markDef:i}=e,{orient:r}=i,o=r==="horizontal"?"width":"height",a=e.getScaleComponent(r==="horizontal"?"x":"y"),s=(t=Be("size",i,n,{vgChannel:o}))!==null&&t!==void 0?t:n.tick.bandSize;if(s!==void 0)return s;{const u=a?a.get("range"):void 0;return u&&za(u)&&yt(u.step)?u.step*3/4:R1(n.view,o)*3/4}}const gy={arc:DEe,area:MEe,bar:TEe,circle:BEe,geoshape:NEe,image:REe,line:jEe,point:IEe,rect:UEe,rule:qEe,square:zEe,text:HEe,tick:YEe,trail:LEe};function XEe(e){if(ye([g1,d1,F1e],e.mark)){const t=Bj(e.mark,e.encoding);if(t.length>0)return KEe(e,t)}else if(e.mark===h1){const t=i$.some(n=>Be(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t)return JEe(e)}return nO(e)}const CI="faceted_path_";function KEe(e,t){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:CI+e.requestDataName(Ze.Main),data:e.requestDataName(Ze.Main),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:nO(e,{fromPrefix:CI})}]}const FI="stack_group_";function JEe(e){const[t]=nO(e,{fromPrefix:FI}),n=e.scaleName(e.stack.fieldChannel),i=(l={})=>e.vgField(e.stack.fieldChannel,l),r=(l,c)=>{const f=[i({prefix:"min",suffix:"start",expr:c}),i({prefix:"max",suffix:"start",expr:c}),i({prefix:"min",suffix:"end",expr:c}),i({prefix:"max",suffix:"end",expr:c})];return`${l}(${f.map(d=>`scale('${n}',${d})`).join(",")})`};let o,a;e.stack.fieldChannel==="x"?(o=Object.assign(Object.assign({},Vl(t.encode.update,["y","yc","y2","height",...i$])),{x:{signal:r("min","datum")},x2:{signal:r("max","datum")},clip:{value:!0}}),a={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},t.encode.update=Object.assign(Object.assign({},pi(t.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(o=Object.assign(Object.assign({},Vl(t.encode.update,["x","xc","x2","width"])),{y:{signal:r("min","datum")},y2:{signal:r("max","datum")},clip:{value:!0}}),a={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},t.encode.update=Object.assign(Object.assign({},pi(t.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(const l of i$){const c=uu(l,e.markDef,e.config);t.encode.update[l]?(o[l]=t.encode.update[l],delete t.encode.update[l]):c&&(o[l]=it(c)),c&&(t.encode.update[l]={value:0})}const s=[];if(e.stack.groupbyChannel){const l=e.fieldDef(e.stack.groupbyChannel),c=G(l);c&&s.push(c),((l==null?void 0:l.bin)||(l==null?void 0:l.timeUnit))&&s.push(G(l,{binSuffix:"end"}))}return o=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((l,c)=>{if(t.encode.update[c])return Object.assign(Object.assign({},l),{[c]:t.encode.update[c]});{const f=uu(c,e.markDef,e.config);return f!==void 0?Object.assign(Object.assign({},l),{[c]:it(f)}):l}},o),o.stroke&&(o.strokeForeground={value:!0},o.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(Ze.Main),name:FI+e.requestDataName(Ze.Main),groupby:s,aggregate:{fields:[i({suffix:"start"}),i({suffix:"start"}),i({suffix:"end"}),i({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:o},marks:[{type:"group",encode:{update:a},marks:[t]}]}]}function ZEe(e){var t;const{encoding:n,stack:i,mark:r,markDef:o,config:a}=e,s=n.order;if(!(!J(s)&&fr(s)&&HA(s.value)||!s&&HA(Be("order",o,a)))){if((J(s)||Y(s))&&!i)return S7(s,{expr:"datum"});if(Ua(r)){const u=o.orient==="horizontal"?"y":"x",l=n[u];if(Y(l)){const c=l.sort;if(J(c))return{field:G(l,{prefix:u,suffix:"sort_index",expr:"datum"})};if(no(c))return{field:G({aggregate:z$(e.encoding)?c.op:void 0,field:c.field},{expr:"datum"})};if(wj(c)){const f=e.fieldDef(c.encoding);return{field:G(f,{expr:"datum"}),order:c.order}}else return c===null?void 0:{field:G(l,{binSuffix:((t=e.stack)===null||t===void 0?void 0:t.impute)?"mid":void 0,expr:"datum"})}}return}}}function nO(e,t={fromPrefix:""}){const{mark:n,markDef:i,encoding:r,config:o}=e,a=vt(i.clip,QEe(e),e_e(e)),s=A7(i),u=r.key,l=ZEe(e),c=t_e(e),f=Be("aria",i,o),d=gy[n].postEncodingTransform?gy[n].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:gy[n].vgMark},a?{clip:!0}:{}),s?{style:s}:{}),u?{key:u.field}:{}),l?{sort:l}:{}),c||{}),f===!1?{aria:f}:{}),{from:{data:t.fromPrefix+e.requestDataName(Ze.Main)},encode:{update:gy[n].encodeEntry(e)}}),d?{transform:d}:{})]}function QEe(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return t&&t.get("selectionExtent")||n&&n.get("selectionExtent")?!0:void 0}function e_e(e){const t=e.component.projection;return t&&!t.isFit?!0:void 0}function t_e(e){if(!e.component.selection)return null;const t=z(e.component.selection).length;let n=t,i=e.parent;for(;i&&n===0;)n=z(i.component.selection).length,i=i.parent;return n?{interactive:t>0||!!e.encoding.tooltip}:null}class kI extends EI{constructor(t,n,i,r={},o){var a;super(t,"unit",n,i,o,void 0,oL(t)?t.view:void 0);this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[];const s=to(t.mark)?Object.assign({},t.mark):{type:t.mark},u=s.type;s.filled===void 0&&(s.filled=FEe(s,o,{graticule:t.data&&uS(t.data)}));const l=this.encoding=hye(t.encoding||{},u,s.filled,o);this.markDef=SEe(s,l,o),this.size=$Ee({encoding:l,size:oL(t)?Object.assign(Object.assign(Object.assign({},r),t.width?{width:t.width}:{}),t.height?{height:t.height}:{}):r}),this.stack=hL(u,l),this.specifiedScales=this.initScales(u,l),this.specifiedAxes=this.initAxes(l),this.specifiedLegends=this.initLegends(l),this.specifiedProjection=t.projection,this.selection=((a=t.params)!==null&&a!==void 0?a:[]).filter(c=>J$(c))}get hasProjection(){const{encoding:t}=this,n=this.mark===oj,i=t&&upe.some(r=>ue(t[r]));return n||i}scaleDomain(t){const n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return s1.reduce((i,r)=>{var o;const a=Ot(n[r]);return a&&(i[r]=this.initScale((o=a.scale)!==null&&o!==void 0?o:{})),i},{})}initScale(t){const{domain:n,range:i}=t,r=Jn(t);return J(n)&&(r.domain=n.map(mi)),J(i)&&(r.range=i.map(mi)),r}initAxes(t){return Zr.reduce((n,i)=>{const r=t[i];if(ue(r)||i===at&&ue(t.x2)||i===$t&&ue(t.y2)){const o=ue(r)?r.axis:void 0;n[i]=o&&this.initAxis(Object.assign({},o))}return n},{})}initAxis(t){const n=z(t),i={};for(const r of n){const o=t[r];i[r]=_h(o)?w7(o):mi(o)}return i}initLegends(t){return ype.reduce((n,i)=>{const r=Ot(t[i]);if(r&&bpe(i)){const o=r.legend;n[i]=o&&Jn(o)}return n},{})}parseData(){this.component.data=hy(this)}parseLayoutSize(){uEe(this)}parseSelections(){this.component.selection=Yxe(this,this.selection)}parseMarkGroup(){this.component.mark=XEe(this)}parseAxesAndHeaders(){this.component.axes=yEe(this)}assembleSelectionTopLevelSignals(t){return obe(this,t)}assembleSignals(){return[...CP(this),...ibe(this,[])]}assembleSelectionData(t){return abe(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return NS(this)}assembleMarks(){var t;let n=(t=this.component.mark)!==null&&t!==void 0?t:[];return(!this.parent||!vc(this.parent))&&(n=zL(this,n)),n.map(this.correctDataNames)}assembleGroupStyle(){const{style:t}=this.view||{};if(t!==void 0)return t;if(this.encoding.x||this.encoding.y)return"cell"}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return gu(this.encoding,t)}fieldDef(t){const n=this.encoding[t];return ro(n)}typedFieldDef(t){const n=this.fieldDef(t);return Li(n)?n:null}}class iO extends JS{constructor(t,n,i,r,o){super(t,"layer",n,i,o,t.resolve,t.view);const a=Object.assign(Object.assign(Object.assign({},r),t.width?{width:t.width}:{}),t.height?{height:t.height}:{});this.children=t.layer.map((s,u)=>{if(j1(s))return new iO(s,this,this.getName(`layer_${u}`),a,o);if(qo(s))return new kI(s,this,this.getName(`layer_${u}`),a,o);throw new Error(o$(s))})}parseData(){this.component.data=hy(this);for(const t of this.children)t.parseData()}parseLayoutSize(){aEe(this)}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of z(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){bEe(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,i)=>i.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),CP(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),NS(this))}assembleSelectionData(t){return this.children.reduce((n,i)=>i.assembleSelectionData(n),t)}assembleGroupStyle(){const t=new Set;for(const i of this.children)for(const r of ft(i.assembleGroupStyle()))t.add(r);const n=Array.from(t);return n.length>1?n:n.length===1?n[0]:void 0}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return sbe(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),JP(this))}}function rO(e,t,n,i,r){if(x1(e))return new Wh(e,t,n,r);if(j1(e))return new iO(e,t,n,i,r);if(qo(e))return new kI(e,t,n,i,r);if(Pye(e))return new hEe(e,t,n,r);throw new Error(o$(e))}var n_e=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function i_e(e,t={}){t.logger&&Lme(t.logger),t.fieldTitle&&Dj(t.fieldTitle);try{const n=fL(Q9(t.config,e.config)),i=CL(e,n),r=rO(i,null,"",void 0,n);return r.parse(),mwe(r.component.data,r),{spec:o_e(r,r_e(e,i.autosize,n,r),e.datasets,e.usermeta),normalized:i}}finally{t.logger&&Pme(),t.fieldTitle&&iye()}}function r_e(e,t,n,i){const r=i.component.layoutSize.get("width"),o=i.component.layoutSize.get("height");if(t===void 0?(t={type:"pad"},i.hasAxisOrientSignalRef()&&(t.resize=!0)):fe(t)&&(t={type:t}),r&&o&&Uve(t.type)){if(r==="step"&&o==="step")U(M7()),t.type="pad";else if(r==="step"||o==="step"){const a=r==="step"?"width":"height";U(M7(a1(a)));const s=a==="width"?"height":"width";t.type=qve(s)}}return Object.assign(Object.assign(Object.assign({},z(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t}),kL(n,!1)),kL(e,!0))}function o_e(e,t,n={},i){const r=e.config?Qye(e.config):void 0,o=[].concat(e.assembleSelectionData([]),nEe(e.component.data,n)),a=e.assembleProjections(),s=e.assembleTitle(),u=e.assembleGroupStyle(),l=e.assembleGroupEncodeEntry(!0);let c=e.assembleLayoutSignals();c=c.filter(h=>(h.name==="width"||h.name==="height")&&h.value!==void 0?(t[h.name]=+h.value,!1):!0);const{params:f}=t,d=n_e(t,["params"]);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),d),s?{title:s}:{}),u?{style:u}:{}),l?{encode:{update:l}}:{}),{data:o}),a.length>0?{projections:a}:{}),e.assembleGroup([...c,...e.assembleSelectionTopLevelSignals([]),...rL(f)])),r?{config:r}:{}),i?{usermeta:i}:{})}const a_e=Ige.version;var s_e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",version:a_e,compile:i_e,normalize:CL,deepEqual:Hr,duplicate:de,pick:Vl,omit:pi,stringify:Ke,hash:_e,isNullOrFalse:HA,contains:ye,some:Xl,every:WA,mergeDeep:t7,unique:Wr,isEqual:npe,setEqual:n7,hasIntersection:GA,prefixGenerator:YA,fieldIntersection:VA,isEmpty:We,keys:z,vals:ln,entries:Da,isBoolean:uh,varName:nt,logicalExpr:lh,deleteNestedProperty:Qm,titleCase:ch,accessPathWithDatum:XA,flatAccessWithDatum:i7,replacePathInField:Ti,replaceAll:iu,removePathFromField:KA,accessPathDepth:Kl,getFirstDefined:vt,uniqueId:o7,resetIdCounter:rpe,internalField:a7,isInternalField:s7,normalizeAngle:fh,isNumeric:e1});function DI(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}}var u_e="vega-themes",l_e="2.10.0",c_e="Themes for stylized Vega and Vega-Lite visualizations.",f_e=["vega","vega-lite","themes","style"],d_e="BSD-3-Clause",h_e={name:"UW Interactive Data Lab",url:"https://idl.cs.washington.edu"},g_e=[{name:"Emily Gu",url:"https://github.com/emilygu"},{name:"Arvind Satyanarayan",url:"http://arvindsatya.com"},{name:"Jeffrey Heer",url:"https://idl.cs.washington.edu"},{name:"Dominik Moritz",url:"https://www.domoritz.de"}],p_e="build/vega-themes.js",m_e="build/vega-themes.module.js",y_e="build/vega-themes.min.js",v_e="build/vega-themes.min.js",b_e="build/vega-themes.module.d.ts",x_e={type:"git",url:"https://github.com/vega/vega-themes.git"},w_e=["src","build"],E_e={prebuild:"yarn clean",build:"rollup -c",clean:"rimraf build && rimraf examples/build","copy:data":"rsync -r node_modules/vega-datasets/data/* examples/data","copy:build":"rsync -r build/* examples/build","deploy:gh":"yarn build && mkdir -p examples/build && rsync -r build/* examples/build && gh-pages -d examples",prepublishOnly:"yarn clean && yarn build",preversion:"yarn lint",serve:"browser-sync start -s -f build examples --serveStatic examples",start:"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'",prepare:"beemo create-config",eslintbase:"beemo eslint .",format:"yarn eslintbase --fix",lint:"yarn eslintbase"},__e={"@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^11.2.0","@wessberg/rollup-plugin-ts":"^1.3.8","browser-sync":"^2.26.14",concurrently:"^6.0.0","gh-pages":"^3.1.0",rollup:"^2.39.1","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-terser":"^7.0.2",typescript:"^4.2.2",vega:"^5.19.1","vega-lite":"^5.0.0","vega-lite-dev-config":"^0.16.1"},A_e={vega:"*","vega-lite":"*"},$_e={name:u_e,version:l_e,description:c_e,keywords:f_e,license:d_e,author:h_e,contributors:g_e,main:p_e,module:m_e,unpkg:y_e,jsdelivr:v_e,types:b_e,repository:x_e,files:w_e,scripts:E_e,devDependencies:__e,peerDependencies:A_e};const xc="#fff",S_e="#888",O_e={background:"#333",title:{color:xc,subtitleColor:xc},style:{"guide-label":{fill:xc},"guide-title":{fill:xc}},axis:{domainColor:xc,gridColor:S_e,tickColor:xc}},_u="#4572a7",C_e={background:"#fff",arc:{fill:_u},area:{fill:_u},line:{stroke:_u,strokeWidth:2},path:{stroke:_u},rect:{fill:_u},shape:{stroke:_u},symbol:{fill:_u,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},Au="#30a2da",oO="#cbcbcb",F_e="#999",k_e="#333",MI="#f0f0f0",TI="#333",D_e={arc:{fill:Au},area:{fill:Au},axis:{domainColor:oO,grid:!0,gridColor:oO,gridWidth:1,labelColor:F_e,labelFontSize:10,titleColor:k_e,tickColor:oO,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:MI,group:{fill:MI},legend:{labelColor:TI,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:TI,titleFontSize:14,titlePadding:10},line:{stroke:Au,strokeWidth:2},path:{stroke:Au,strokeWidth:.5},rect:{fill:Au},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:Au},bar:{binSpacing:2,fill:Au,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},$u="#000",M_e={group:{fill:"#e5e5e5"},arc:{fill:$u},area:{fill:$u},line:{stroke:$u},path:{stroke:$u},rect:{fill:$u},shape:{stroke:$u},symbol:{fill:$u,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},T_e=22,N_e="normal",NI="Benton Gothic, sans-serif",RI=11.5,R_e="normal",Su="#82c6df",aO="Benton Gothic Bold, sans-serif",jI="normal",LI=13,Gh={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},j_e={background:"#ffffff",title:{anchor:"start",color:"#000000",font:aO,fontSize:T_e,fontWeight:N_e},arc:{fill:Su},area:{fill:Su},line:{stroke:Su,strokeWidth:2},path:{stroke:Su},rect:{fill:Su},shape:{stroke:Su},symbol:{fill:Su,size:30},axis:{labelFont:NI,labelFontSize:RI,labelFontWeight:R_e,titleFont:aO,titleFontSize:LI,titleFontWeight:jI},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:NI,labelFontSize:RI,symbolType:"square",titleFont:aO,titleFontSize:LI,titleFontWeight:jI},range:{category:Gh["category-6"],diverging:Gh["fireandice-6"],heatmap:Gh["fire-7"],ordinal:Gh["fire-7"],ramp:Gh["fire-7"]}},Ou="#ab5787",py="#979797",L_e={background:"#f9f9f9",arc:{fill:Ou},area:{fill:Ou},line:{stroke:Ou},path:{stroke:Ou},rect:{fill:Ou},shape:{stroke:Ou},symbol:{fill:Ou,size:30},axis:{domainColor:py,domainWidth:.5,gridWidth:.2,labelColor:py,tickColor:py,tickWidth:.2,titleColor:py},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},Cu="#3e5c69",P_e={background:"#fff",arc:{fill:Cu},area:{fill:Cu},line:{stroke:Cu},path:{stroke:Cu},rect:{fill:Cu},shape:{stroke:Cu},symbol:{fill:Cu},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},Ii="#1696d2",PI="#000000",I_e="#FFFFFF",my="Lato",sO="Lato",B_e="Lato",z_e="#DEDDDD",U_e=18,Yh={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},q_e={background:I_e,title:{anchor:"start",fontSize:U_e,font:my},axisX:{domain:!0,domainColor:PI,domainWidth:1,grid:!1,labelFontSize:12,labelFont:sO,labelAngle:0,tickColor:PI,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:my},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:z_e,gridWidth:1,labelFontSize:12,labelFont:sO,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:my,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:sO,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:my,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:Yh["six-groups-cat-1"],diverging:Yh["diverging-colors"],heatmap:Yh["diverging-colors"],ordinal:Yh["six-groups-seq"],ramp:Yh["shades-blue"]},area:{fill:Ii},rect:{fill:Ii},line:{color:Ii,stroke:Ii,strokeWidth:5},trail:{color:Ii,stroke:Ii,strokeWidth:0,size:1},path:{stroke:Ii,strokeWidth:.5},point:{filled:!0},text:{font:B_e,color:Ii,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:Ii,stroke:null}},arc:{fill:Ii},shape:{stroke:Ii},symbol:{fill:Ii,size:30}},Fu="#3366CC",II="#ccc",yy="Arial, sans-serif",H_e={arc:{fill:Fu},area:{fill:Fu},path:{stroke:Fu},rect:{fill:Fu},shape:{stroke:Fu},symbol:{stroke:Fu},circle:{fill:Fu},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:yy,fontSize:12},"guide-title":{font:yy,fontSize:12},"group-title":{font:yy,fontSize:12}},title:{font:yy,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:II,tickColor:II,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},W_e=$_e.version;var G_e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",dark:O_e,excel:C_e,fivethirtyeight:D_e,ggplot2:M_e,googlecharts:H_e,latimes:j_e,quartz:L_e,urbaninstitute:q_e,version:W_e,vox:P_e});/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Y_e(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n}function V_e(e,t,n){if(Q(e))return`[${e.map(i=>t(Fe(i)?i:BI(i,n))).join(", ")}]`;if(se(e)){let i="";const r=e,{title:o,image:a}=r,s=Y_e(r,["title","image"]);o&&(i+=`<h2>${t(o)}</h2>`),a&&(i+=`<img src="${t(a)}">`);const u=Object.keys(s);if(u.length>0){i+="<table>";for(const l of u){let c=s[l];c!==void 0&&(se(c)&&(c=BI(c,n)),i+=`<tr><td class="key">${t(l)}:</td><td class="value">${t(c)}</td></tr>`)}i+="</table>"}return i||"{}"}return t(e)}function X_e(e){const t=[];return function(n,i){if(typeof i!="object"||i===null)return i;const r=t.indexOf(this)+1;return t.length=r,t.length>e?"[Object]":t.indexOf(i)>=0?"[Circular]":(t.push(i),i)}}function BI(e,t){return JSON.stringify(e,X_e(t))}var K_e=`#vg-tooltip-element {
  visibility: hidden;
  padding: 8px;
  position: fixed;
  z-index: 1000;
  font-family: sans-serif;
  font-size: 11px;
  border-radius: 3px;
  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  /* The default theme is the light theme. */
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid #d9d9d9;
  color: black; }
  #vg-tooltip-element.visible {
    visibility: visible; }
  #vg-tooltip-element h2 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 13px; }
  #vg-tooltip-element img {
    max-width: 200px;
    max-height: 200px; }
  #vg-tooltip-element table {
    border-spacing: 0; }
    #vg-tooltip-element table tr {
      border: none; }
      #vg-tooltip-element table tr td {
        overflow: hidden;
        text-overflow: ellipsis;
        padding-top: 2px;
        padding-bottom: 2px; }
        #vg-tooltip-element table tr td.key {
          color: #808080;
          max-width: 150px;
          text-align: right;
          padding-right: 4px; }
        #vg-tooltip-element table tr td.value {
          display: block;
          max-width: 300px;
          max-height: 7em;
          text-align: left; }
  #vg-tooltip-element.dark-theme {
    background-color: rgba(32, 32, 32, 0.9);
    border: 1px solid #f5f5f5;
    color: white; }
    #vg-tooltip-element.dark-theme td.key {
      color: #bfbfbf; }
`;const zI="vg-tooltip-element",J_e={offsetX:10,offsetY:10,id:zI,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:Z_e,maxDepth:2,formatTooltip:V_e};function Z_e(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function Q_e(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return K_e.toString().replace(zI,e)}function eAe(e,t,n,i){let r=e.clientX+n;r+t.width>window.innerWidth&&(r=+e.clientX-n-t.width);let o=e.clientY+i;return o+t.height>window.innerHeight&&(o=+e.clientY-i-t.height),{x:r,y:o}}class tAe{constructor(t){this.options=Object.assign(Object.assign({},J_e),t);const n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const i=document.createElement("style");i.setAttribute("id",this.options.styleId),i.innerHTML=Q_e(n);const r=document.head;r.childNodes.length>0?r.insertBefore(i,r.childNodes[0]):r.appendChild(i)}}tooltipHandler(t,n,i,r){var o;if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el)),((o=document.fullscreenElement)!==null&&o!==void 0?o:document.body).appendChild(this.el),r==null||r===""){this.el.classList.remove("visible",`${this.options.theme}-theme`);return}this.el.innerHTML=this.options.formatTooltip(r,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:s,y:u}=eAe(n,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${u}px; left: ${s}px`)}}function nAe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function UI(e,t,n,i,r,o,a){try{var s=e[o](a),u=s.value}catch(l){n(l);return}s.done?t(u):Promise.resolve(u).then(i,r)}function vy(e){return function(){var t=this,n=arguments;return new Promise(function(i,r){var o=e.apply(t,n);function a(u){UI(o,i,r,a,s,"next",u)}function s(u){UI(o,i,r,a,s,"throw",u)}a(void 0)})}}var qI=Object.prototype,ku=qI.hasOwnProperty,lo,uO=typeof Symbol=="function"?Symbol:{},by=uO.iterator||"@@iterator",iAe=uO.asyncIterator||"@@asyncIterator",xy=uO.toStringTag||"@@toStringTag";function HI(e,t,n,i){var r=t&&t.prototype instanceof cO?t:cO,o=Object.create(r.prototype),a=new gO(i||[]);return o._invoke=uAe(e,n,a),o}function lO(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(i){return{type:"throw",arg:i}}}var WI="suspendedStart",rAe="suspendedYield",GI="executing",wy="completed",mr={};function cO(){}function Ey(){}function wc(){}var fO={};fO[by]=function(){return this};var dO=Object.getPrototypeOf,_y=dO&&dO(dO(pO([])));_y&&_y!==qI&&ku.call(_y,by)&&(fO=_y);var Ec=wc.prototype=cO.prototype=Object.create(fO);Ey.prototype=Ec.constructor=wc;wc.constructor=Ey;wc[xy]=Ey.displayName="GeneratorFunction";function YI(e){["next","throw","return"].forEach(function(t){e[t]=function(n){return this._invoke(t,n)}})}function VI(e){var t=typeof e=="function"&&e.constructor;return t?t===Ey||(t.displayName||t.name)==="GeneratorFunction":!1}function oAe(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,wc):(e.__proto__=wc,xy in e||(e[xy]="GeneratorFunction")),e.prototype=Object.create(Ec),e}function aAe(e){return{__await:e}}function Ay(e,t){function n(o,a,s,u){var l=lO(e[o],e,a);if(l.type==="throw")u(l.arg);else{var c=l.arg,f=c.value;return f&&typeof f=="object"&&ku.call(f,"__await")?t.resolve(f.__await).then(function(d){n("next",d,s,u)},function(d){n("throw",d,s,u)}):t.resolve(f).then(function(d){c.value=d,s(c)},function(d){return n("throw",d,s,u)})}}var i;function r(o,a){function s(){return new t(function(u,l){n(o,a,u,l)})}return i=i?i.then(s,s):s()}this._invoke=r}YI(Ay.prototype);Ay.prototype[iAe]=function(){return this};function sAe(e,t,n,i,r){r===void 0&&(r=Promise);var o=new Ay(HI(e,t,n,i),r);return VI(t)?o:o.next().then(function(a){return a.done?a.value:o.next()})}function uAe(e,t,n){var i=WI;return function(o,a){if(i===GI)throw new Error("Generator is already running");if(i===wy){if(o==="throw")throw a;return KI()}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=XI(s,n);if(u){if(u===mr)continue;return u}}if(n.method==="next")n.sent=n._sent=n.arg;else if(n.method==="throw"){if(i===WI)throw i=wy,n.arg;n.dispatchException(n.arg)}else n.method==="return"&&n.abrupt("return",n.arg);i=GI;var l=lO(e,t,n);if(l.type==="normal"){if(i=n.done?wy:rAe,l.arg===mr)continue;return{value:l.arg,done:n.done}}else l.type==="throw"&&(i=wy,n.method="throw",n.arg=l.arg)}}}function XI(e,t){var n=e.iterator[t.method];if(n===lo){if(t.delegate=null,t.method==="throw"){if(e.iterator.return&&(t.method="return",t.arg=lo,XI(e,t),t.method==="throw"))return mr;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return mr}var i=lO(n,e.iterator,t.arg);if(i.type==="throw")return t.method="throw",t.arg=i.arg,t.delegate=null,mr;var r=i.arg;if(!r)return t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,mr;if(r.done)t[e.resultName]=r.value,t.next=e.nextLoc,t.method!=="return"&&(t.method="next",t.arg=lo);else return r;return t.delegate=null,mr}YI(Ec);Ec[xy]="Generator";Ec[by]=function(){return this};Ec.toString=function(){return"[object Generator]"};function lAe(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function hO(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function gO(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(lAe,this),this.reset(!0)}function cAe(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function i(){for(;t.length;){var r=t.pop();if(r in e)return i.value=r,i.done=!1,i}return i.done=!0,i}}function pO(e){if(e){var t=e[by];if(t)return t.call(e);if(typeof e.next=="function")return e;if(!isNaN(e.length)){var n=-1,i=function r(){for(;++n<e.length;)if(ku.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=lo,r.done=!0,r};return i.next=i}}return{next:KI}}function KI(){return{value:lo,done:!0}}gO.prototype={constructor:gO,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=lo,this.done=!1,this.delegate=null,this.method="next",this.arg=lo,this.tryEntries.forEach(hO),!t)for(var n in this)n.charAt(0)==="t"&&ku.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=lo)},stop:function(){this.done=!0;var t=this.tryEntries[0],n=t.completion;if(n.type==="throw")throw n.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(l,c){return a.type="throw",a.arg=t,n.next=l,c&&(n.method="next",n.arg=lo),!!c}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],a=o.completion;if(o.tryLoc==="root")return i("end");if(o.tryLoc<=this.prev){var s=ku.call(o,"catchLoc"),u=ku.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else if(u){if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(t,n){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&ku.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&(t==="break"||t==="continue")&&o.tryLoc<=n&&n<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=n,o?(this.method="next",this.next=o.finallyLoc,mr):this.complete(a)},complete:function(t,n){if(t.type==="throw")throw t.arg;return t.type==="break"||t.type==="continue"?this.next=t.arg:t.type==="return"?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):t.type==="normal"&&n&&(this.next=n),mr},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),hO(i),mr}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc===t){var r=i.completion;if(r.type==="throw"){var o=r.arg;hO(i)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:pO(t),resultName:n,nextLoc:i},this.method==="next"&&(this.arg=lo),mr}};var es={wrap:HI,isGeneratorFunction:VI,AsyncIterator:Ay,mark:oAe,awrap:aAe,async:sAe,keys:cAe,values:pO};function fAe(e,t,n){var i=e.open(t),r=1e4,o=250,a=new URL(t),s=a.origin,u=~~(r/o);function l(f){f.source===i&&(u=0,e.removeEventListener("message",l,!1))}e.addEventListener("message",l,!1);function c(){u<=0||(i.postMessage(n,s),setTimeout(c,o),u-=1)}setTimeout(c,o)}var dAe=`.vega-embed {
  position: relative;
  display: inline-block;
  box-sizing: border-box; }
  .vega-embed.has-actions {
    padding-right: 38px; }
  .vega-embed details:not([open]) > :not(summary) {
    display: none !important; }
  .vega-embed summary {
    list-style: none;
    position: absolute;
    top: 0;
    right: 0;
    padding: 6px;
    z-index: 1000;
    background: white;
    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
    color: #1b1e23;
    border: 1px solid #aaa;
    border-radius: 999px;
    opacity: 0.2;
    transition: opacity 0.4s ease-in;
    outline: none;
    cursor: pointer;
    line-height: 0px; }
    .vega-embed summary::-webkit-details-marker {
      display: none; }
    .vega-embed summary:active {
      box-shadow: #aaa 0px 0px 0px 1px inset; }
    .vega-embed summary svg {
      width: 14px;
      height: 14px; }
  .vega-embed details[open] summary {
    opacity: 0.7; }
  .vega-embed:hover summary,
  .vega-embed:focus summary {
    opacity: 1 !important;
    transition: opacity 0.2s ease; }
  .vega-embed .vega-actions {
    position: absolute;
    z-index: 1001;
    top: 35px;
    right: -9px;
    display: flex;
    flex-direction: column;
    padding-bottom: 8px;
    padding-top: 8px;
    border-radius: 4px;
    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
    border: 1px solid #d9d9d9;
    background: white;
    animation-duration: 0.15s;
    animation-name: scale-in;
    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
    text-align: left; }
    .vega-embed .vega-actions a {
      padding: 8px 16px;
      font-family: sans-serif;
      font-size: 14px;
      font-weight: 600;
      white-space: nowrap;
      color: #434a56;
      text-decoration: none; }
      .vega-embed .vega-actions a:hover {
        background-color: #f7f7f9;
        color: black; }
    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
      content: "";
      display: inline-block;
      position: absolute; }
    .vega-embed .vega-actions::before {
      left: auto;
      right: 14px;
      top: -16px;
      border: 8px solid #0000;
      border-bottom-color: #d9d9d9; }
    .vega-embed .vega-actions::after {
      left: auto;
      right: 15px;
      top: -14px;
      border: 7px solid #0000;
      border-bottom-color: #fff; }
  .vega-embed .chart-wrapper.fit-x {
    width: 100%; }
  .vega-embed .chart-wrapper.fit-y {
    height: 100%; }

.vega-embed-wrapper {
  max-width: 100%;
  overflow: auto;
  padding-right: 14px; }

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6); }
  to {
    opacity: 1;
    transform: scale(1); } }
`;String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e});function JI(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(var r=0,o=n;r<o.length;r++){var a=o[r];hAe(e,a)}return e}function hAe(e,t){for(var n=0,i=Object.keys(t);n<i.length;n++){var r=i[n];Mc(e,r,t[r],!0)}}var mO;function ZI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function ts(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ZI(Object(n),!0).forEach(function(i){nAe(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ZI(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}var ns=age,Vh=s_e,$y=typeof window!="undefined"?window:void 0;Vh===void 0&&$y!==null&&$y!==void 0&&(mO=$y.vl)!==null&&mO!==void 0&&mO.compile&&(Vh=$y.vl);var gAe={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},pAe={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},Xh={vega:"Vega","vega-lite":"Vega-Lite"},Sy={vega:ns.version,"vega-lite":Vh?Vh.version:"not available"},mAe={vega:e=>e,"vega-lite":(e,t)=>Vh.compile(e,{config:t}).spec},yAe=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,vAe="chart-wrapper";function bAe(e){return typeof e=="function"}function QI(e,t,n,i){var r="<html><head>".concat(t,'</head><body><pre><code class="json">'),o="</code></pre>".concat(n,"</body></html>"),a=window.open("");a.document.write(r+e+o),a.document.title="".concat(Xh[i]," JSON Source")}function xAe(e,t){if(e.$schema){var n=DI(e.$schema);if(t&&t!==n.library){var i;console.warn("The given visualization spec is written in ".concat(Xh[n.library],", but mode argument sets ").concat((i=Xh[t])!==null&&i!==void 0?i:t,"."))}var r=n.library;return iC.satisfies(Sy[r],"^".concat(n.version.slice(1)))||console.warn("The input spec uses ".concat(Xh[r]," ").concat(n.version,", but the current version of ").concat(Xh[r]," is v").concat(Sy[r],".")),r}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":t!=null?t:"vega"}function wAe(e){return!!(e&&"load"in e)}function eB(e){return wAe(e)?e:ns.loader(e)}function tB(e){var t;return(t=e.usermeta&&e.usermeta.embedOptions)!==null&&t!==void 0?t:{}}function $Ae(e,t){return yO.apply(this,arguments)}function yO(){return yO=vy(es.mark(function e(t,n){var i,r,o,a,s,u,l,c,f,d,h=arguments;return es.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(o=h.length>2&&h[2]!==void 0?h[2]:{},!Fe(n)){p.next=10;break}return s=eB(o.loader),p.t0=JSON,p.next=6,s.load(n);case 6:p.t1=p.sent,a=p.t0.parse.call(p.t0,p.t1),p.next=11;break;case 10:a=n;case 11:return u=tB(a).loader,(!s||u)&&(s=eB((l=o.loader)!==null&&l!==void 0?l:u)),p.next=15,nB(tB(a),s);case 15:return c=p.sent,p.next=18,nB(o,s);case 18:return f=p.sent,d=ts(ts({},JI(f,c)),{},{config:h0((i=f.config)!==null&&i!==void 0?i:{},(r=c.config)!==null&&r!==void 0?r:{})}),p.next=22,_Ae(t,a,d,s);case 22:return p.abrupt("return",p.sent);case 23:case"end":return p.stop()}},e)})),yO.apply(this,arguments)}function nB(e,t){return vO.apply(this,arguments)}function vO(){return vO=vy(es.mark(function e(t,n){var i,r,o;return es.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!Fe(t.config)){s.next=8;break}return s.t1=JSON,s.next=4,n.load(t.config);case 4:s.t2=s.sent,s.t0=s.t1.parse.call(s.t1,s.t2),s.next=9;break;case 8:s.t0=(i=t.config)!==null&&i!==void 0?i:{};case 9:if(r=s.t0,!Fe(t.patch)){s.next=18;break}return s.t4=JSON,s.next=14,n.load(t.patch);case 14:s.t5=s.sent,s.t3=s.t4.parse.call(s.t4,s.t5),s.next=19;break;case 18:s.t3=t.patch;case 19:return o=s.t3,s.abrupt("return",ts(ts(ts({},t),o?{patch:o}:{}),r?{config:r}:{}));case 21:case"end":return s.stop()}},e)})),vO.apply(this,arguments)}function EAe(e){var t=e.getRootNode?e.getRootNode():document;if(t instanceof ShadowRoot)return{root:t,rootContainer:t};var n;return{root:document,rootContainer:(n=document.head)!==null&&n!==void 0?n:document.body}}function _Ae(e,t){return bO.apply(this,arguments)}function bO(){return bO=vy(es.mark(function e(t,n){var i,r,o,a,s,u,l,c,f,d,h,g,p,m,y,v,b,x,w,_,E,$,O,C,A,D,F,T,S,M,P,B,H,re,le,he,Ae,$e,Pe,It,ti,Nn,R,W,V,k,xe,X,Ce,we=arguments;return es.wrap(function(bi){for(;;)switch(bi.prev=bi.next){case 0:if(Ce=function(){he&&document.removeEventListener("click",he),M.finalize()},c=we.length>2&&we[2]!==void 0?we[2]:{},f=we.length>3?we[3]:void 0,d=c.theme?h0(G_e[c.theme],(i=c.config)!==null&&i!==void 0?i:{}):c.config,h=iv(c.actions)?c.actions:JI({},gAe,(r=c.actions)!==null&&r!==void 0?r:{}),g=ts(ts({},pAe),c.i18n),p=(o=c.renderer)!==null&&o!==void 0?o:"canvas",m=(a=c.logLevel)!==null&&a!==void 0?a:ns.Warn,y=(s=c.downloadFileName)!==null&&s!==void 0?s:"visualization",v=typeof t=="string"?document.querySelector(t):t,v){bi.next=12;break}throw new Error("".concat(t," does not exist"));case 12:return c.defaultStyle!==!1&&(b="vega-embed-style",x=EAe(v),w=x.root,_=x.rootContainer,w.getElementById(b)||(E=document.createElement("style"),E.id=b,E.innerText=c.defaultStyle===void 0||c.defaultStyle===!0?dAe.toString():c.defaultStyle,_.appendChild(E))),$=xAe(n,c.mode),O=mAe[$](n,d),$==="vega-lite"&&O.$schema&&(C=DI(O.$schema),iC.satisfies(Sy.vega,"^".concat(C.version.slice(1)))||console.warn("The compiled spec uses Vega ".concat(C.version,", but current version is v").concat(Sy.vega,"."))),v.classList.add("vega-embed"),h&&v.classList.add("has-actions"),v.innerHTML="",A=v,h&&(D=document.createElement("div"),D.classList.add(vAe),v.appendChild(D),A=D),F=c.patch,F&&(F instanceof Function?O=F(O):O=Jh(O,F,!0,!1).newDocument),c.formatLocale&&ns.formatLocale(c.formatLocale),c.timeFormatLocale&&ns.timeFormatLocale(c.timeFormatLocale),T=c.ast,S=ns.parse(O,$==="vega-lite"?{}:d,{ast:T}),M=new(c.viewClass||ns.View)(S,ts({loader:f,logLevel:m,renderer:p},T?{expr:(u=(l=ns.expressionInterpreter)!==null&&l!==void 0?l:c.expr)!==null&&u!==void 0?u:mge}:{})),M.addSignalListener("autosize",(yr,Rn)=>{var ni=Rn.type;ni=="fit-x"?(A.classList.add("fit-x"),A.classList.remove("fit-y")):ni=="fit-y"?(A.classList.remove("fit-x"),A.classList.add("fit-y")):ni=="fit"?A.classList.add("fit-x","fit-y"):A.classList.remove("fit-x","fit-y")}),c.tooltip!==!1&&(bAe(c.tooltip)?P=c.tooltip:P=new tAe(c.tooltip===!0?{}:c.tooltip).call,M.tooltip(P)),B=c.hover,B===void 0&&(B=$==="vega"),B&&(H=typeof B=="boolean"?{}:B,re=H.hoverSet,le=H.updateSet,M.hover(re,le)),c&&(c.width!=null&&M.width(c.width),c.height!=null&&M.height(c.height),c.padding!=null&&M.padding(c.padding)),bi.next=36,M.initialize(A,c.bind).runAsync();case 36:if(h!==!1){if(Ae=v,c.defaultStyle!==!1&&($e=document.createElement("details"),$e.title=g.CLICK_TO_VIEW_ACTIONS,v.append($e),Ae=$e,Pe=document.createElement("summary"),Pe.innerHTML=yAe,$e.append(Pe),he=yr=>{$e.contains(yr.target)||$e.removeAttribute("open")},document.addEventListener("click",he)),It=document.createElement("div"),Ae.append(It),It.classList.add("vega-actions"),h===!0||h.export!==!1)for(ti=function(){var Rn=R[Nn];if(h===!0||h.export===!0||h.export[Rn]){var ni=g["".concat(Rn.toUpperCase(),"_ACTION")],Du=document.createElement("a");Du.text=ni,Du.href="#",Du.target="_blank",Du.download="".concat(y,".").concat(Rn),Du.addEventListener("mousedown",function(){var iB=vy(es.mark(function xO(rB){var wO;return es.wrap(function(_c){for(;;)switch(_c.prev=_c.next){case 0:return rB.preventDefault(),_c.next=3,M.toImageURL(Rn,c.scaleFactor);case 3:wO=_c.sent,this.href=wO;case 5:case"end":return _c.stop()}},xO,this)}));return function(xO){return iB.apply(this,arguments)}}()),It.append(Du)}},Nn=0,R=["svg","png"];Nn<R.length;Nn++)ti();(h===!0||h.source!==!1)&&(W=document.createElement("a"),W.text=g.SOURCE_ACTION,W.href="#",W.addEventListener("click",function(yr){var Rn,ni;QI(Ny(n),(Rn=c.sourceHeader)!==null&&Rn!==void 0?Rn:"",(ni=c.sourceFooter)!==null&&ni!==void 0?ni:"",$),yr.preventDefault()}),It.append(W)),$==="vega-lite"&&(h===!0||h.compiled!==!1)&&(V=document.createElement("a"),V.text=g.COMPILED_ACTION,V.href="#",V.addEventListener("click",function(yr){var Rn,ni;QI(Ny(O),(Rn=c.sourceHeader)!==null&&Rn!==void 0?Rn:"",(ni=c.sourceFooter)!==null&&ni!==void 0?ni:"","vega"),yr.preventDefault()}),It.append(V)),(h===!0||h.editor!==!1)&&(xe=(k=c.editorUrl)!==null&&k!==void 0?k:"https://vega.github.io/editor/",X=document.createElement("a"),X.text=g.EDITOR_ACTION,X.href="#",X.addEventListener("click",function(yr){fAe(window,xe,{config:d,mode:$,renderer:p,spec:Ny(n)}),yr.preventDefault()}),It.append(X))}return bi.abrupt("return",{view:M,spec:n,vgSpec:O,finalize:Ce});case 38:case"end":return bi.stop()}},e)})),bO.apply(this,arguments)}export{$Ae as e};
